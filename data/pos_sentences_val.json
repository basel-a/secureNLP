{"0": "They added obfuscation in order to hide sensitive strings ; The communication protocol was modified in order to include the flag \" < CHCMD > \" we assume that \" CH \" has the same meaning than \" Ch \" before the version number and \" CMD \" is the abbreviation for command ; From now on , the malware supports \" runas \" in order to execute commands as administrator .", "1": "This exported function is used by the dropper to add persistence in the registry and to drop a second file ( as explained in our previous article ) .", "2": "In all first cases the attackers used the program RDPdoor for remote access to the bank network and the program \" MBR Eraser \" to remove traces and to crack Windows computers and servers .", "3": "In addition to banking and payment systems , hackers got access to e - mail servers to control all internal communications .", "4": "There is the ability to download arbitrary exe- cutable files from the management server and run them .", "5": "As a result , the attacker gets remote access to the user computer with the running program \" AmmyAdmin \" bypassing firewalls .", "6": "When the attackers gain access to servers running operating systems of the Linux family they use SSH backdoor that transmits to the malicious server the login / password data used to access the servers and provides attackers remote access to the servers .", "7": "To provide access to the server of interest the at- tackers may appropriately modify rules for firewalls Microsoft TMG , CISCO , etc .", "8": "Having access , the attackers downloaded mali- cious scripts and changed denominations of issued banknotes in the ATM operating system registry .", "9": "Contents of the file \" 1.bat \" REG ADD \" HKEY_LOCAL_MACHINE\\SOFTWARE\\ Wincor Nixdorf\\ProTopas\\CurrentVersion\\LYNX- PAR\\CASH_DISPENSER \" /v VALUE_1 /t REG_SZ /d \" 5000 \" /f REG ADD \" HKEY_LOCAL_MACHINE\\SOFTWARE\\ Wincor Nixdorf\\ProTopas\\CurrentVersion\\LYNX- PAR\\CASH_DISPENSER \" /v VALUE_2 /t REG_SZ /d \" 1000 \" /f REG ADD \" HKEY_LOCAL_MACHINE\\SOFTWARE\\ Wincor Nixdorf\\ProTopas\\CurrentVersion\\LYNX- PAR\\CASH_DISPENSER \" /v VALUE_3 /t REG_SZ /d \" 500 \" /f REG ADD \" HKEY_LOCAL_MACHINE\\SOFTWARE\\ Wincor Nixdorf\\ProTopas\\CurrentVersion\\LYNX- PAR\\CASH_DISPENSER \" /v VALUE_4 /t REG_SZ /d \" 100 \" /f REG ADD \" HKEY_LOCAL_MACHINE\\SOFTWARE\\ Wincor Nixdorf\\ProTopas\\CurrentVersion\\LYNX- PAR\\CASH_DISPENSER \" /v VALUE_1 /t REG_SZ /d \" 100 \" /f REG ADD \" HKEY_LOCAL_MACHINE\\SOFTWARE\\ Wincor Nixdorf\\ProTopas\\CurrentVersion\\LYNX- PAR\\CASH_DISPENSER \" /v VALUE_4 /t REG_SZ /d \" 5000 \" /f shutdown -r -t 0 \u2013f Execution of this file changed registry keys in the registry branch \" \" HKEY_LOCAL_MACHINE\\ SOFTWARE\\Wincor Nixdorf\\ProTopas\\Current- Version\\LYNXPAR\\CASH_DISPENSER \" \" that are responsible for cassette denominations in an ATM .", "10": "The Gozi / ISFB based malware was used to drop additional components on interesting systems , which included Metasploit / Meterpreter payloads and Anunak variants .", "11": "Carbanak is a remote backdoor ( initially based on Carberp ) , designed for espionage , data exfiltration and to provide remote access to infected machines .", "12": "They then install additional software such as the Ammyy Remote Administration Tool , or even compromise SSH servers .", "13": "As part of the attack s reconnaissance phase , video recordings of the activities of bank employees , particularly system administrators , were made .", "14": "The videos were sent to the C2 server .", "15": "Carbanak copies itself into \" % system32%\\com \" with the name \" svchost.exe \" with the file attributes : system , hidden and read - only .", "16": "To ensure that Carbanak has autorun privileges the malware creates a new service .", "17": "Before creating the malicious service , Carbanak determines if either the avp.exe or avpui.exe processes ( components of Kaspersky Internet Security ) is running .", "18": "Carbanak creates a file with a random name and a .bin extension in % COMMON_APPDATA%\\Mozilla where it stores commands to be executed .", "19": "Then the malware gets the proxy configuration from the registry entry : [ HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings ] and the Mozilla Firefox configuration file in : % AppData%\\Mozilla\\Firefox\\<ProfileName>\\prefs.js How to detect Carbanak One of the best methods for detecting Carbanak is to look for .bin files in the folder : .. \\All users\\%AppData%\\Mozilla\\ The malware saves files in this location that will later be sent to the C2 server when an internet connection is detected .", "20": "Additionally , Carbanak can obtain proxy configuration information from headers sent through an application via SOCKS or HTTP .", "21": "Carbanak injects its code into svchost.exe .", "22": "Carbanak downloads the file kldconfig.plug from its C2 server .", "23": "Once the system is infected , Carbanak logs keystrokes and takes screenshots every 20 seconds .", "24": "To enable connections to the infected computer using the Remote Desktop Protocol ( RDP ) , Carbanak sets Termservice service execution mode to Auto .", "25": "If Carbanak detects the banking application BLIZKO ( funds transfer software ) in the infected computer , it sends a special notification to its C2 server .", "26": "Carbanak sends its collected monitoring data to its C2 server .", "27": "It also receives commands .", "28": "In another instance , a Secure Shell ( SSH ) backdoor was used to communicate with the C2 server in 190.97.165.126 ( operatemesscont.net ) .", "29": "In this case , the victim used the Telnet / SSH client PuTTY to connect to the server , and the attackers recompiled the machine 's SSH daemon with a backdoor so they could gain direct access .", "30": "A newer approach used by the attackers involves compromising the update site for several industrial control system ( ICS ) software producers .", "31": "They then bundle Backdoor . Oldrea with a legitimate update of the affected software .", "32": "The Dragonfly attackers used hacked websites to host command - and - control ( C&C ) software .", "33": "Both are Remote Access Tool ( RAT ) type malware which provide the attackers with access and control of compromised computers .", "34": "Oldrea acts as a back door for the attackers on to the victim 's computer , allowing them to extract data and install further malware .", "35": "The earliest method was an email spear phishing campaign , which saw selected executives and senior employees in target companies receive emails containing a malicious PDF attachment .", "36": "This in turn exploited either Java or Internet Explorer in order to drop Oldrea or Karagany on the victim 's computer .", "37": "At the core of Backdoor . Oldrea is a persistent component that interacts with C&C servers to download and execute payloads .", "38": "The components are downloaded by reaching out to the C&C server and performing a GET request which returns an HTML page containing a base64 encoded string between two comments marked with the ' havex ' string .", "39": "Post infection , Backdoor . Oldrea will attempt to collect system information such as OS , user name , computer name , country , language , nation , Internet adapter configuration information , available drives , default browser , running processes , desktop file list , My Documents , Internet history , program files , and root of available drives .", "40": "This data is collected and written to a temporary file in an encrypted form before it is POST'ed to a remote C&C server .", "41": "It is designed to download and install additional files and exfiltrate data .", "42": "Trojan . Karagany copies itself with hidden and system attributes where it was first executed as err.log[DIGITS ] .", "43": "Trojan . Karagany first checks for a live Internet connection by visiting Microsoft or Adobe websites .", "44": "It will only reach out to its C&C server once this check is successful .", "45": "These campaigns relied primarily on spear phishing with malicious documents that dropped malware ( mostly PlugX ) along with Vietnamese- language decoy documents .", "46": "Dyreza takes a more simplistic approach to banking fraud , acting to intercept logins and perform malicious actions by acquiring the HTTP POST data from under banking SSL sessions .", "47": "These macros , if allowed to execute , will reach out and download first - stage loaders that will then install the Dridex payload onto the victim machine .", "48": "This copy of Kaptoxa continuously scanned volatile memory of infected systems for patterns that looked like credit card numbers and logged them to a file that was transferred to an internal network share at regular intervals .", "49": "Another utility was deployed onto these network shares to perform the final exfiltration step in which the data was transferred to external FTP servers .", "50": "The malware scans memory for both Track 1 and Track 2 credit card data and exfiltrates its findings back to control servers over HTTP requests .", "51": "This campaign leveraged fake websites to trick users into entering credentials , and to concurrently serve malware that poses as software updates for legitimate applications .", "52": "This tool is used to log keystrokes , screenshots , and other user activity on infected systems and exfiltrates this data to an attacker - controlled server .", "53": "When executed , it extracts and deploys a backdoor Trojan , a configuration file , and optionally a decoy ( an image or a legitimate executable ) .", "54": "This malware possesses Notable Activity an extensive command set capable of conducting reconnaissance of victim machines , deleting files , downloading files , and exfiltrating data .", "55": "It provides an attacker with a range of functionality including the ability to log keystrokes ; modify and copy files ; capture screenshots or video of user activity ; and perform administrative tasks such Notable Activity as terminating processes , logging off users , and rebooting victim machines .", "56": "A full command shell is also provided through access to a cmd.exe process , which sends output to the PlugX instance over named pipes for onward relay to the attacker 's Command - and - Control ( C2 ) servers .", "57": "PlugX is most frequently delivered to targets via a spear phishing attack containing a malicious RTF or Word document leveraging exploit code for the popular CVE-2012 - 0158 vulnerability .", "58": "However PlugX is installed on a victim machine , typically three files are dropped on the file system after exploitation to enable initial start - up of the malware : a legitimate , digitally signed application ; an encrypted file containing the PlugX payload ; and a malicious , dynamically - linked library that is used to load the malware using the Dynamic Link Library ( DLL ) side - loading technique when the legitimate application is executed .", "59": "This incident delivered a fairly common , publicly available RAT called ZxShell , which connected to a C2 at newss.effers.com .", "60": "This occurred in October 2014 when the Chinese adversary tracked by CrowdStrike as HURRICANE PANDA deployed a tool called Win64.exe on a compromised system that was used to invoke other programs with elevated privileges .", "61": "Analysis of the Win64.exe binary revealed that it exploits a previously unknown vulnerability to elevate its privileges to those of the SYSTEM user and then create a new process with these access rights to run the command that was passed as an argument .", "62": "From this elevation , any command passed to the executable was executed with elevated privileges .", "63": "The exploit tool was only deployed when absolutely necessary during the intrusion operations , and it was deleted immediately after use .", "64": "This allows for a decoy document and malicious executable to be combined with a malicious CVE-2014 - 1761 document .", "65": "The TEMPER PANDA adversary was particularly prolific in its use of MH370-related emails to deliver malicious documents that Notable Activity dropped malware connecting to a known TEMPER PANDA C2 address , www . verizon.proxydns.com .", "66": "Once inside a victim 's network , this adversary seeks to gain legitimate credentials to move laterally and establish RDP sessions to achieve their objectives .", "67": "This actor also made extensive use of Chopper webshell ; this provides the equivalent functionality of a RAT for adversary control of webservers .", "68": "This simple one - line script gives an attacker access to a webserver from which they can deploy privilege - escalation tools , move laterally , or deploy more complex scripts to interact with databases on the webserver .", "69": "When the above strings are decoded , the following IP addresses are used as PlugX C2 servers .", "70": "Post - Exploitation and Exfiltration After HURRICANE PANDA has established a foothold on a victim 's network , they then seek legitimate credentials via tools such as Windows Credential Viewer , Windows Credential Editor , or Mimikatz .", "71": "If credentials can not be obtained , HURRICANE PANDA will often rely on RDP .", "72": "Then they will access the victim computer over RDP , and , when presented with a login screen , IT will invoke the sticky keys mechanism and be presented with an administrative command shell .", "73": "First , files of interest are compressed and password protected using RAR .", "74": "Next , they stage the files at a convenient location .", "75": "Finally , they exfiltrate the files from the network via FTP .", "76": "Pirpi provides the adversary with a traditional set of RAT features that allow the adversary to exfiltrate and deploy files , along with remote shell access to a compromised system .", "77": "VENOMOUS BEAR , also known as Snake , Turla , and Oroborous , uses a set of implants that culminates in a sophisticated Windows - based rootkit that can leverage an encrypted Virtual File System ( VFS ) as a staging area for tools to deploy and data prepared for exfiltration .", "78": "Their main implant , called X - Agent , is a sophisticated RAT that exhibits a modular architecture and a multi - year development history ."}