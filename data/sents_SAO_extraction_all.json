{"AdversaryIntelligenceReport_DeepPanda_0 (1).tokens": {"0": [{"drop": {"A": "drop", "S": "This sample", "O": ["a kernel driver"]}, "provide": {"A": "provide", "S": "This sample", "O": ["to the C2", "an interactive command line shell"]}}, {"be registered": {"A": "be registered", "O": ["a DLL", "as a service"]}}], "1": [{"are forwarded": {"A": "are forwarded", "O": ["The incoming connection contents", "to the C2"]}}], "2": [{"is deleted": {"A": "is deleted", "O": ["the user"]}}, {"is then started": {"A": "is then started", "O": ["The backdoor", "under that account"]}}], "3": [{"has": {"A": "has", "S": "This sample", "O": ["multiple communication capabilities available"]}}], "4": [{"is passed": {"A": "is passed", "O": ["on to connections", "data from the C2"]}}], "5": [{"starts": {"A": "starts", "S": "the sample", "O": ["the new service"]}}], "6": [{"copies": {"A": "copies", "S": "it", "O": ["itself"]}}, {"modify": {"A": "modify", "S": "it", "O": ["the creation time, last access time and last modification    time", "to he current system time when the copy was made but with the year changed to 2005"]}}], "7": [{"provided": {"A": "provided", "S": "All three samples", "O": ["remote access", "via two Command and Control (C2) servers", "to the attacker"]}}], "8": [{"hooking": {"A": "hooking", "S": "The final step of the entry point", "O": ["the system"]}}, {"hook": {"A": "hook", "S": "one", "O": ["the system call table"]}}], "9": [{"is made": {"A": "is made", "O": ["a call", "In the registry hooking code of the driver", "to ObReferenceObjectByHandle()"]}}], "10": [{"cleaning up": {"A": "cleaning up", "O": ["the components dropped by the malware"]}}, {"remains": {"A": "remains", "S": "the system", "O": ["vulnerable to local attacks"]}}], "11": [{"schedules": {"A": "schedules", "O": ["to be deleted on reboot", "using the well documented MoveFileExA API", "the copy"]}}, {"creates": {"A": "creates", "O": ["a copy of regsvr32.exe named Update.exe"]}}], "12": [{"recovering": {"A": "recovering", "O": ["from various system and client storage such as Mozilla Firefox, Internet Explorer, and Remote Access Service (RAS)", "authentication credentials"]}}], "13": [{"used": {"A": "used", "S": "PRC based actors", "O": ["functionality that is typical of a Remote Access Tool(RAT)", "in data exfiltration attacks"]}, "contains": {"A": "contains", "S": "The dropped DLL (MD5: 47619fca20895abc83807321cbb80a3d) itself", "O": ["functionality that is typical of a Remote Access Tool(RAT)"]}}], "14": [{"reads": {"A": "reads", "S": "The main backdoor thread", "O": ["from the chosen C2 protocol", "commands"]}}], "15": [{"hooks": {"A": "hooks", "S": "the other", "O": ["the network stack"]}}, {"queries": {"A": "queries", "S": "The network stack hooking", "O": ["the OS version", "using RtlGetVersion() or PsGetVersion()"]}}], "16": [{"is sent": {"A": "is sent", "O": ["to the client", "an 8 byte key"]}}], "17": [{"implements": {"A": "implements", "S": "It", "O": ["relatively well thought out protocols including HTTP and DNS"]}}], "18": [{"initialize and install": {"A": "initialize and install", "S": "The executable 14c04f88dc97aef3e9b516ef208a2bf5", "O": ["into a targeted system", "it"]}, "extracting": {"A": "extracting", "S": "The executable 14c04f88dc97aef3e9b516ef208a2bf5", "O": ["from itself", "a malicious payload"]}}], "19": [{"opening": {"A": "opening", "S": "The driver", "O": ["a named event", "with the name {8CB2ff21-0166-4cf1-BD8F-E190BC7902DC}", "in the BaseNamedObjects object directory", "using the Windows API ZwOpenEvent()"]}}], "20": [{"performs": {"A": "performs", "S": "The second component of the entry point", "O": ["an anti-debugging technique"]}, "calling": {"A": "calling", "S": "The second component of the entry point", "O": ["the function KdDisableDebugger()"]}}, {"disable": {"A": "disable", "S": "the driver", "O": ["usage of the built-in Windows kernel debugging facility that is used by popular kernel debuggers KD and WinDbg"]}}], "21": [{"dropped": {"A": "dropped", "S": "the Backdoor DLL", "O": ["The kernel driver component"]}}], "22": [{"hooking": {"A": "hooking", "S": "The TCP hook", "O": ["IOCTL 0x120003 (IOCTL_ TCP_QUERY_INFORMATION_EX)"]}}], "23": [{"sets": {"A": "sets", "S": "The dropper", "O": ["to the date 2007-03-07 00:00:00", "the creation and last written timestamp of the newly created file"]}}, {"blend in": {"A": "blend in", "O": ["the newly created malicious  DLL", "with other system files"]}}], "24": [{"applying": {"A": "applying", "S": "the driver", "O": ["directly in the code", "a Detours-style hook"]}}], "25": [{"implements": {"A": "implements", "S": "This handler class", "O": ["a generic TCP proxy"]}}], "26": [{"identifying": {"A": "identifying", "S": "This class", "O": ["Internet Explorer"]}, "gathering": {"A": "gathering", "S": "This class", "O": ["intelligence on the infected system"]}}], "27": [{"hooks": {"A": "hooks", "S": "The unpacked kernel driver sample", "O": ["these functions", "by reading the second DWORD at each of these exported functions"]}}], "28": [{"socially engineer": {"A": "socially engineer", "S": "The use of the Chrome icon", "O": ["into thinking the dropper was a legitimate file associated with Google", "the intended victim"]}}], "29": [{"performing": {"A": "performing", "S": "a cached rootkit", "O": ["similar hooks", "on the same 3 registry related APIs"]}}], "30": [{"writes": {"A": "writes", "S": "the sample", "O": ["directly to the Windows Registry", "settings"]}}], "31": [{"set": {"A": "set", "O": ["to grant all access to the file", "permissions"]}}], "32": [{"initiates": {"A": "initiates", "S": "the routine", "O": ["calling out to the Command and Control (C2)"]}}], "33": [{"writing": {"A": "writing", "S": "This handler class for command ID 8", "O": ["arbitrary files", "via reading arbitrary files"]}, "reading": {"A": "reading", "S": "This handler class for command ID 8"}, "implements": {"A": "implements", "S": "This handler class for command ID 8", "O": ["generic directory and file browsing", "using FindFirstFileW() and FindNextFileW() APIs"]}, "upload": {"A": "upload", "S": "This handler class for command ID 8"}, "download": {"A": "download", "S": "This handler class for command ID 8", "O": ["arbitrary files"]}}], "34": [{"control": {"A": "control", "S": "the adversary", "O": ["the keyboard"]}, "view": {"A": "view", "S": "the adversary", "O": ["graphically", "the main desktop"]}}], "35": [{"remove": {"A": "remove", "O": ["0x20000000", "the backdoor", "from the system"]}}], "36": [{"filter": {"A": "filter", "S": "the backdoor", "O": ["the contents of specified files"]}, "remove": {"A": "remove", "S": "the backdoor", "O": ["using a regular expression (regex)", "content"]}}], "37": [{"receiving": {"A": "receiving", "S": "the malware"}, "sending": {"A": "sending", "S": "the malware"}}], "38": [{"proxy": {"A": "proxy", "S": "The sample", "O": ["for other infected machines", "C2 traffic", "in order to minimize the number of systems communicating to the C2"]}, "act": {"A": "act", "S": "The sample", "O": ["as a generic proxy"]}}], "39": [{"modifies": {"A": "modifies", "S": "This command", "O": ["the creation, modification, and last access timestamps of the modified file", "to conceal the content modifications"]}}], "40": [{"prevents": {"A": "prevents", "S": "the first byte of the file is 'Z'", "O": ["from being detected as an executable by many defensive tools", "the file"]}}, {"writes": {"A": "writes", "S": "the dropper", "O": ["the file", "to disk"]}}], "41": [{"is performed": {"A": "is performed", "O": ["The hooking", "by creating a new completion routine associated with any IRP_MJ_DEVICE_CONTROL IRP that matches the IOCTL, attaching to the target process, performing several memory copies to hide the entry, and detaching"]}}], "42": [{"invokes": {"A": "invokes", "S": "The dropper", "O": ["the SHGetSpecialFolderPath() API"]}}], "43": [{"use": {"A": "use", "S": "a custom DNS client implementation", "O": ["the system's configured DNS server"]}, "tunnel": {"A": "tunnel", "S": "a custom DNS client implementation", "O": ["C2 traffic", "over legitimate DNS"]}}, {"contains": {"A": "contains", "S": "the malware", "O": ["a custom DNS client implementation"]}}], "44": [{"bypass": {"A": "bypass", "S": "It", "O": ["to install itself by using the \u2018sysprep.exe\u2019 Microsoft Windows executable provided by the targeted system", "User Account Control (UAC)"]}}], "45": [{"dropped": {"A": "dropped", "S": "the dropper sample file", "O": ["the DLL"]}}, {"is": {"A": "is", "S": "This sample", "O": ["a 'backdoor'"]}}], "46": [{"write": {"A": "write", "S": "The dropper", "O": ["to one of the following names", "using the first available name in this set", "the malicious payload"]}}], "47": [{"Adds": {"A": "Adds", "O": ["using the service name \u2018helpsvc\u2019", "itself", "to list of services started by \u2018netsvc\u2019"]}}], "48": [{"used": {"A": "used", "O": ["the various network hooking techniques", "in the kernel driver"]}}], "49": [{"launching": {"A": "launching", "S": "this class", "O": ["specified executable files", "via the CreateProcess() API"]}}], "50": [{"implements": {"A": "implements", "S": "This export", "O": ["the actual install logic", "to maintain persistence"]}}], "51": [{"opens": {"A": "opens", "S": "The dropper", "O": ["the dropped file"]}, "corrects": {"A": "corrects", "S": "The dropper", "O": ["by writing the 'M' over the first byte", "the header"]}}], "52": [{"is then performed": {"A": "is then performed", "O": ["by first allocating a Memory Descriptor List (MDL) using the Windows API IoAllocateMdl(), and associating the MDL to a non-paged buffer using MmBuildMdlForNonPagedPool()", "The system call hook"]}}], "53": [{"connect": {"A": "connect", "S": "the sample", "O": ["to the C2 located at 1.9.5.38:443"]}}], "54": [{"is encrypted": {"A": "is encrypted", "O": ["with a simple four byte XOR key value of 0x2E885Df3", "The driv- er"]}}], "55": [{"is": {"A": "is", "S": "The primary aim of this backdoor", "O": ["remote desktop control functionality comparable to VNC or Remote Desktop over a custom protocol"]}}], "56": [{"contains": {"A": "contains", "S": "The con- figuration", "O": ["the C2 protocol to be used"]}}, {"attempts": {"A": "attempts", "S": "the malware", "O": ["the different C2 protocols", "in a pre-defined order"]}}], "57": [{"enables": {"A": "enables", "S": "the malicious payload", "O": ["to have full control of the system", "an attacker"]}}], "58": [{"sent": {"A": "sent", "O": ["An example authentication packet", "to the C2"]}}], "59": [{"hide": {"A": "hide", "S": "this driver", "O": ["the service"]}}], "60": [{"be dropped": {"A": "be dropped", "S": "a client-side exploit"}, "executed": {"A": "executed", "S": "a client-side exploit"}}, {"launch": {"A": "launch", "S": "the adversary", "O": ["using a variety of command line options", "it"]}}], "61": [{"install": {"A": "install", "S": "the malware", "O": ["as a service with that same name", "itself"]}}], "62": [{"obfuscate": {"A": "obfuscate", "S": "this technique", "O": ["by masking the process creator\u2019s user name to appear to be a generic domain user", "the activities of the malicious sample"]}}], "63": [{"gathering": {"A": "gathering", "S": "The malware", "O": ["various pieces of information", "from the system"]}}], "64": [{"perform": {"A": "perform", "O": ["through MDLs", "system call hooking"]}}], "65": [{"is encrypted": {"A": "is encrypted", "O": ["The beacon", "using an XOR/ADD loop using the statically defined key 0x1C"]}, "sent": {"A": "sent", "O": ["to the C2", "The beacon"]}}], "66": [{"is accomplished": {"A": "is accomplished", "O": ["using a 32 byte packet", "Authentication"]}}], "67": [{"downloading": {"A": "downloading", "O": ["a list of C2 servers", "from an HTTP URL"]}}, {"specifies": {"A": "specifies", "S": "the default configuration present", "O": ["to use", "as a C2", "202.86.190.3:80"]}}], "68": [{"enumerate": {"A": "enumerate", "S": "This handler class"}, "manage": {"A": "manage", "S": "This handler class", "O": ["system components"]}, "delete": {"A": "delete", "S": "This handler class"}, "alter": {"A": "alter", "S": "This handler class"}, "start": {"A": "start", "S": "This handler class"}, "stop": {"A": "stop", "S": "This handler class"}}], "69": [{"load": {"A": "load", "S": "the dropper", "O": ["the dropped DLL", "into its own process space"]}}], "70": [{"write": {"A": "write", "S": "One sample", "O": ["to disk", "a malicious component"]}}], "71": [{"applies": {"A": "applies", "S": "it", "O": ["an XOR", "with the value 127", "on the data"]}}], "72": [{"shares": {"A": "shares", "S": "the C2 client which would communicate with this sample", "O": ["the same communications library which was compiled into this sample"]}}], "73": [{"terminating": {"A": "terminating", "S": "the DLL", "O": ["the backdoor process"]}, "deleting": {"A": "deleting", "S": "the DLL", "O": ["itself"]}}], "74": [{"implements": {"A": "implements", "S": "This kernel mode rootkit", "O": ["several hooking techniques"]}, "preventing": {"A": "preventing", "S": "This kernel mode rootkit", "O": ["from detecting the backdoor DLL", "a system administrator"]}}], "75": [{"resolves": {"A": "resolves", "S": "The sample", "O": ["several library functions provided by Microsoft", "using the LoadLibrary() and GetProcAddress() Application Programming Interfaces (APIs)"]}}], "76": [{"utilizes": {"A": "utilizes", "S": "The sample", "O": ["to protect its C2 communications", "the AES cryptographic algorithm"]}}], "77": [{"implements": {"A": "implements", "S": "This sample", "O": ["several communications protocols"]}, "is": {"A": "is", "S": "This sample", "O": ["a sophisticated backdoor"]}}, {"executing": {"A": "executing", "O": ["processes"]}}], "78": [{"hide": {"A": "hide", "S": "This driver", "O": ["for an unknown reason", "a wide swath of TCP ports (40000-45000)"]}}, {"hide": {"A": "hide", "S": "This driver", "O": ["a wide swath of TCP ports (40000-45000)", "for an unknown reason"]}}], "79": [{"having": {"A": "having", "S": "The third sample", "O": ["multiple communication capabilities"]}, "act": {"A": "act", "S": "The third sample", "O": ["as a relay for other infected hosts"]}, "utilized": {"A": "utilized", "S": "The third sample", "O": ["a kernel mode driver"]}, "hide": {"A": "hide", "S": "The third sample", "O": ["from user-mode tools", "aspects of the tool"]}}], "80": [{"avoid": {"A": "avoid", "S": "The tool", "O": ["detection from solutions like DNS blacklisting and RFC protocol enforcement"]}, "select": {"A": "select", "S": "The tool", "O": ["once it has been instantiated", "the most effective communication channel"]}}], "81": [{"sends": {"A": "sends", "S": "The malware"}, "receives": {"A": "receives", "S": "The malware"}}], "82": [{"establishing": {"A": "establishing", "S": "It", "O": ["to other hosts", "TCP connections"]}, "listening": {"A": "listening", "S": "It", "O": ["for incoming connections"]}}], "83": [{"dropped": {"A": "dropped", "S": "the Backdoor DLL", "O": ["The kernel driver component"]}}], "84": [{"use": {"A": "use", "S": "the sample", "O": ["to initialize itself as a persistent Windows service", "documented APIs such as OpenSCManager() and CreateService()"]}}], "85": [{"prevent": {"A": "prevent", "S": "This", "O": ["identification", "during disk forensics"]}}], "86": [{"set": {"A": "set", "O": ["to \u2018msupdate\u2019", "the \u2018msupdate\u2019 key"]}}, {"be changed": {"A": "be changed", "O": ["The next key"]}}], "87": [{"serves": {"A": "serves", "S": "the POST request", "O": ["as a upstream channel"]}}], "88": [{"take": {"A": "take", "S": "This class", "O": ["a screen shot of the users desktop"]}}], "89": [{"support": {"A": "support", "S": "The command line options", "O": ["forensic mitigation"]}}], "90": [{"avoids": {"A": "avoids", "S": "the backdoor DLL sample with an MD5 of de7500fc1065a081180841f32f06a537", "O": ["installing the kernel driver on a system running this tool"]}}], "91": [{"installing": {"A": "installing", "O": ["new .NET assemblies"]}}, {"download": {"A": "download", "O": ["files"]}, "upload": {"A": "upload", "O": ["files"]}}, {"connecting": {"A": "connecting", "O": ["to new C2 servers"]}}, {"calling": {"A": "calling", "O": ["methods", "on those assemblies"]}}], "92": [{"filters": {"A": "filters", "S": "This hook", "O": ["any connections listening on TCP ports in the range between 40000 and 45000"]}}], "93": [{"avoid": {"A": "avoid", "S": "the driver", "O": ["multiple instances of itself"]}}], "94": [{"creates": {"A": "creates", "S": "the driver", "O": ["using the Windows API ZwCreateEvent()", "it"]}}], "95": [{"writing": {"A": "writing", "O": ["the driver", "to disk"]}}, {"is loaded": {"A": "is loaded", "O": ["it", "using the ZwLoadDriver() API"]}}], "96": [{"sending": {"A": "sending", "S": "the sample", "O": ["the initial authentication packet"]}, "verifies": {"A": "verifies", "S": "the sample", "O": ["that the first four bytes of the response is equal to a statically defined value"]}}], "97": [{"allows": {"A": "allows", "S": "This", "O": ["any user", "to have complete control over the machine"]}}], "98": [{"set": {"A": "set", "S": "the subroutine", "O": ["to the module handle of the DLL", "the value of the \u2018ServiceDLL\u2019"]}}, {"creates": {"A": "creates", "S": "The registry change", "O": ["the following key"]}}], "99": [{"added": {"A": "added", "O": ["a temporary new user \u201c_DomainUser_\u201d with password \u201cDom4!nU- serP4ss\u201d", "to the local Administrators group"]}, "is created": {"A": "is created", "O": ["a temporary new user \u201c_DomainUser_\u201d with password \u201cDom4!nU- serP4ss\u201d"]}}], "100": [{"sends": {"A": "sends", "S": "The malicious sample", "O": ["an initial beacon", "to the C2"]}}], "101": [{"is implemented": {"A": "is implemented", "O": ["This remote control functionality", "as separate messages for mouse clicks, pressed keys, etc.", "using command identifiers 0x20000002 to 0x20000019"]}}], "102": [{"spawns": {"A": "spawns", "S": "the sample", "O": ["using rundll32.exe", "a new process"]}}], "103": [{"has": {"A": "has", "S": "The malware", "O": ["three distinct C2 protocols"]}}], "104": [{"is initiated": {"A": "is initiated", "O": ["a connection to the C2", "to the stati- cally defined IP address"]}}, {"issued": {"A": "issued", "O": ["via the C2", "commands", "over a network based protocol"]}}], "105": [{"receiving": {"A": "receiving", "S": "the routine", "O": ["incoming commands"]}, "sending": {"A": "sending", "S": "the routine", "O": ["the initial beacon"]}, "executes": {"A": "executes", "S": "the routine", "O": ["them"]}}], "106": [{"installed": {"A": "installed", "O": ["a Dynamic Link Library (DLL)", "as a service"]}}], "107": [{"Adds": {"A": "Adds", "O": ["under HKEY_LOCAL_ MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\<service>\u201d", "itself", "from the backdoor's configuration", "as a service name"]}}], "108": [{"hooks": {"A": "hooks", "S": "the driver", "O": ["Major Function 14 the IRP_MJ_DEVICE_CONTROL"]}}], "109": [{"is provided": {"A": "is provided", "O": ["back to the C2", "The standard output channel of that command"]}}], "110": [{"scan": {"A": "scan", "S": "the hook", "O": ["the list of active connections returned to the user"]}, "hide": {"A": "hide", "S": "the hook", "O": ["any such connection currently bound to a local TCP port in the range between 40000 and 45000"]}}], "111": [{"is received": {"A": "is received", "O": ["This inbound payload"]}}], "112": [{"checks": {"A": "checks", "S": "It", "O": ["for the values of the \u201cServiceDll\u201d and \u201cSecurity\u201d keys"]}}], "113": [{"access": {"A": "access", "S": "the sample", "O": ["the real user\u2019s desktop", "if started as service"]}}], "114": [{"is likely used": {"A": "is likely used", "O": ["for intelligence gathering", "This third component"]}}], "115": [{"is mapped": {"A": "is mapped", "O": ["into the process space of its dropped file", "it"]}}], "116": [{"loads": {"A": "loads", "S": "the backdoor", "O": ["the original service\u2019s DLL", "with LoadLibrary", "into the address space"]}}], "117": [{"is generally associated": {"A": "is generally associated", "S": "This activity", "O": ["with log cleaning to com- plicate a forensic investigation"]}}], "118": [{"invoke": {"A": "invoke", "S": "the malware", "O": ["in the background", "cmd.exe"]}, "launching": {"A": "launching", "S": "the malware", "O": ["a command or command line utility already present on the system"]}}], "119": [{"is registered": {"A": "is registered", "O": ["The export \u2018CollectW3PerfData\u2019", "as the main function of the DLL"]}}], "120": [{"searching": {"A": "searching", "S": "RATs", "O": ["specific files"]}, "exfiltrate": {"A": "exfiltrate", "S": "RATs", "O": ["specific files"]}}], "121": [{"is hidden": {"A": "is hidden", "O": ["in a resource of the dropper binary", "The malicious DLL file that is dropped"]}}], "122": [{"be used": {"A": "be used", "O": ["as a backdoor", "itself"]}}, {"remove": {"A": "remove", "S": "a post exploitation tool", "O": ["log data"]}, "download": {"A": "download", "S": "a post exploitation tool"}, "infect": {"A": "infect", "S": "a post exploitation tool", "O": ["other systems"]}}], "123": [{"fool": {"A": "fool", "O": ["some automated dynamic analysis or anti-malware software", "into believing this is the legitimate ESET AV software"]}}], "124": [{"process and execute": {"A": "process and execute", "S": "Command handling loop", "O": ["commands sent by the C2"]}}], "125": [{"'dropping'": {"A": "'dropping'", "S": "The sample", "O": ["an embedded/encrypted kernel driver"]}}], "126": [{"serves": {"A": "serves", "S": "The GET request", "O": ["as a down-stream channel"]}}], "127": [{"receiving": {"A": "receiving", "O": ["chunks of the response"]}}, {"sending": {"A": "sending", "O": ["chunks of POST payload"]}}], "128": [{"replaces": {"A": "replaces", "S": "the malware", "O": ["its previous instances or versions of this backdoor"]}}], "129": [{"is handled": {"A": "is handled", "O": ["The communication to the C2", "by a while() loop"]}}], "130": [{"are created": {"A": "are created", "O": ["The screen captures", "using a series of Microsoft Windows Graphic Device Interface (GDI) API calls culminating in a call to GetDIBits()"]}}], "131": [{"encrypt and decrypt": {"A": "encrypt and decrypt", "S": "AES encryption", "O": ["any further communications"]}}], "132": [{"is": {"A": "is", "S": "This DLL", "O": ["a moderately sophisticated backdoor"]}}], "133": [{"initiates": {"A": "initiates", "S": "The command 0x22000001", "O": ["continuous transmission of screen captures to the C2"]}}], "134": [{"implements": {"A": "implements", "S": "This handler class", "O": ["an interactive command line shell accessible from the C2 server"]}}], "135": [{"being sent": {"A": "being sent", "O": ["to the C2", "64 random bytes"]}}]}, "Aided_Frame_Aided_Direction.tokens": {"0": [{"sent": {"A": "sent", "O": ["over port 443", "SOGU (aka Kaba) callback traffic", "to assign.ddnsking.com"]}}], "1": [{"resolved": {"A": "resolved", "S": "The C2 domain quakegoogle.servequake[.]com", "O": ["to 115.126.62.100", "at the time of the SWCs"]}}], "2": [{"obfuscated": {"A": "obfuscated", "S": "The threat group", "O": ["the iframe", "on two of the compromised websites"]}}], "3": [{"downloaded": {"A": "downloaded", "S": "these exploits", "O": ["a payload hosted at: hxxp://103.27.108.45/img/js.php"]}}], "4": [{"dropped": {"A": "dropped", "S": "a threat actor-controlled IP address", "O": ["a Poison Ivy remote access tool (RAT)", "onto victims\u2019 systems"]}}, {"direct": {"A": "direct", "S": "an iframe", "O": ["to a threat actor-controlled IP address", "site visitors"]}}], "5": [{"compromise": {"A": "compromise", "S": "The group", "O": ["these websites"]}, "insert": {"A": "insert", "S": "The group", "O": ["malicious iframes"]}}], "6": [{"masquerade": {"A": "masquerade", "S": "This versioning info", "O": ["as a Google Chrome file"]}}], "7": [{"directed": {"A": "directed", "S": "The iframes on these websites", "O": ["visitors", "to Java exploits hosted at 103.27.108.45"]}}]}, "Alienvault_Scanbox.tokens": {"0": [{"collects": {"A": "collects", "S": "The Scanbox framework", "O": ["about the victim that is visiting the compromised website", "a small amount of information"]}, "configures": {"A": "configures", "S": "The Scanbox framework", "O": ["the remote C&C server that it will use"]}}, {"encodes": {"A": "encodes", "S": "Scanbox"}, "encrypts": {"A": "encrypts", "S": "Scanbox"}, "sending": {"A": "sending", "S": "Scanbox", "O": ["to the C&C server", "the information"]}}, {"is": {"A": "is", "S": "This Javascript file", "O": ["a framework for reconnaissance"]}}, {"extract": {"A": "extract", "S": "the framework", "O": ["from the victim", "different information"]}, "Implements": {"A": "Implements", "S": "the framework", "O": ["a \u201ckeylogger\u201d functionality", "trough Javascript"]}, "logs": {"A": "logs", "S": "the framework", "O": ["all the keystrokes the victim is typing inside the compromised website"]}}], "1": [{"sent": {"A": "sent", "S": "It", "O": ["to the C&C", "periodically"]}, "being recorded": {"A": "being recorded", "S": "It"}, "send": {"A": "send", "S": "It", "O": ["keystrokes", "when the user submits web forms that can potentially include passwords and other sensitive data"]}}], "2": [{"loaded": {"A": "loaded", "S": "code", "O": ["from a remote server", "a malicious Javascript file"]}}, {"compromise": {"A": "compromise", "S": "The attackers", "O": ["the website"]}}]}, "ANALYSIS-ON-APT-TO-BE-ATTACK-THAT-FOCUSING-ON-CHINAS-GOVERNMENT-AGENCY-.tokens": {"0": [{"executing": {"A": "executing", "S": "attack", "O": ["via PowerShell", "commands"]}, "execute": {"A": "execute", "S": "attack", "O": ["various operations"]}, "accessing": {"A": "accessing", "S": "attack", "O": ["system passwords"]}, "importing": {"A": "importing", "S": "attack", "O": ["PowerShell script"]}, "downloading": {"A": "downloading", "S": "attack", "O": ["files"]}, "uploading": {"A": "uploading", "S": "attack", "O": ["files"]}, "injecting": {"A": "injecting", "S": "attack", "O": ["keyboard recorder"]}}], "1": [{"encrypted": {"A": "encrypted", "S": "both of them", "O": ["information"]}, "use": {"A": "use", "S": "both of them", "O": ["Cookie", "to transmit information"]}, "send": {"A": "send", "S": "both of them", "O": ["requests"]}}], "2": [{"evade": {"A": "evade", "S": "all these features of this attack pattern", "O": ["the detection of security software"]}}, {"disguising": {"A": "disguising", "S": "This kind of attack pattern", "O": ["as non-malicious real file"]}}, {"sending": {"A": "sending", "S": "it", "O": ["a network heartbeat package"]}}, {"send": {"A": "send", "S": "it", "O": ["via the Cookie field", "data information"]}}], "3": [{"penetrate": {"A": "penetrate", "S": "the attack penetration", "O": ["firewall"]}}], "4": [{"realize": {"A": "realize", "S": "APT-TOCS", "O": ["on targeted system", "remote control"]}}], "5": [{"send": {"A": "send", "S": "backdoor program", "O": ["heartbeat packages", "by Cookie fields", "to designated addresses", "GET request"]}}], "6": [{"conceal": {"A": "conceal", "S": "it", "O": ["itself"]}, "has": {"A": "has", "S": "it", "O": ["anti-detection functions"]}}], "7": [{}], "8": [{"is downloading": {"A": "is downloading", "S": "APT-TOCS", "O": ["the script functionalities of Shellcode"]}}, {"downloads": {"A": "downloads", "S": "the script functionalities of Shellcode", "O": ["into memory", "a field of data"]}}], "9": [{"writing": {"A": "writing", "S": "this part", "O": ["to process powershell.exe"]}}]}, "Anthem_hack_all_roads_lead_to_China.tokens": {"0": [{"connected": {"A": "connected", "S": "This implant", "O": ["to a C2 node that overlapped with prennera[.]com"]}}]}, "apt28.tokens": {"0": [{"receives": {"A": "receives", "S": "The SOURFACE downloader", "O": ["another dropper", "from its C2 server"]}}, {"installs": {"A": "installs", "S": "this second dropper", "O": ["a second stage backdoor"]}}], "1": [{"send": {"A": "send", "S": "They", "O": ["from a specific IP address or email address", "spear phishing emails"]}}], "2": [{"steal": {"A": "steal", "S": "They", "O": ["data"]}}, {"send": {"A": "send", "S": "their implants", "O": ["data", "out of the network", "using a victim network\u2019s mail server"]}}], "3": [{"obtains": {"A": "obtains", "S": "This downloader", "O": ["from a C2 server", "a second-stage backdoor"]}}], "4": [{"gain": {"A": "gain", "S": "They", "O": ["access to their targets"]}, "steal": {"A": "steal", "S": "They", "O": ["data"]}}], "5": [{"using": {"A": "using", "S": "Communications with a C2 server", "O": ["HTTP"]}}], "6": [{"communicate": {"A": "communicate", "S": "The backdoor", "O": ["via MIA email addresses ending with \u201c@mia.ge.gov\u201d"]}, "establish": {"A": "establish", "S": "The backdoor", "O": ["a connection to a Georgian MIA mail server"]}}], "7": [{"is captured": {"A": "is captured", "O": ["User activity", "every 500 milliseconds", "once"]}, "logged": {"A": "logged", "O": ["User activity", "in an HTML-like format"]}}], "8": [{"purports": {"A": "purports", "S": "The text of the document", "O": ["to provide domain and user group setup information for internal Windows XP and Windows 7 systems"]}}], "9": [{"are sent": {"A": "are sent", "O": ["Messages", "using HTTP POST requests"]}}, {"contain": {"A": "contain", "S": "HTTP POST requests", "O": ["encrypted and Base64 encoded data"]}}], "10": [{"are sent": {"A": "are sent", "O": ["in HTTP responses to the POST requests", "to the CORESHELL backdoor", "Commands", "from the C2 server"]}}], "11": [{"registered": {"A": "registered", "S": "APT28", "O": ["domains similar to those of legitimate Eastern European news sites and governments"]}}], "12": [{"executed": {"A": "executed", "O": ["a DLL or EXE"]}, "be written": {"A": "be written", "O": ["a DLL or EXE", "to disk"]}}], "13": [{"uses": {"A": "uses", "S": "CHOPSTICK", "O": ["a URL-safe Base64 encoding", "using an alphabet that substitutes \u201c+\u201d and \u201c/\u201d for \u201c-\u201d and \u201c_\u201d, respectively"]}}], "14": [{"are": {"A": "are", "S": "Some of APT28\u2019s more commonly used tools", "O": ["the SOURFACE downloader"]}}], "15": [{"been delivered": {"A": "been delivered", "O": ["through the SOURFACE downloader", "This backdoor"]}}, {"gain": {"A": "gain", "S": "This backdoor", "O": ["for reconnaissance"]}}], "16": [{"encode": {"A": "encode", "S": "These families", "O": ["using a custom stream cipher", "their strings", "at compile time"]}}], "17": [{"obtains": {"A": "obtains", "S": "SOURFACE", "O": ["from a C2 server", "a second stage backdoor"]}, "is": {"A": "is", "S": "SOURFACE", "O": ["a downloader"]}}], "18": [{"employed": {"A": "employed", "O": ["A SOURFACE sample", "in the same Malaysia Airlines lure"]}}], "19": [{"used": {"A": "used", "S": "the SOURFACE downloader", "O": ["hard-coded IP addresses", "for C2 communications"]}}, {"use": {"A": "use", "S": "the future CORESHELL samples", "O": ["domains"]}}], "20": [{"attaches": {"A": "attaches", "S": "The backdoor", "O": ["to a preformatted email", "this file"]}}, {"sends": {"A": "sends", "O": ["out it", "through a victim\u2019s mail server"]}}], "21": [{"installed": {"A": "installed", "S": "the decoy document", "O": ["a SOURFACE backdoor", "on the victim\u2019s system"]}}], "22": [{"obtain": {"A": "obtain", "S": "APT28", "O": ["from the MIA\u2019s network", "data", "through a less-monitored route"]}, "limiting": {"A": "limiting", "S": "APT28", "O": ["the MIA network security department\u2019s abilities to detect the traffic"]}}], "23": [{"imitated": {"A": "imitated", "S": "Several of the domains APT28 registered", "O": ["NATO domain names"]}}], "24": [{"capturing": {"A": "capturing", "S": "a thread", "O": ["in JPEG format", "desktop screenshots"]}, "collects": {"A": "collects", "S": "a thread", "O": ["keystrokes"]}, "tracks": {"A": "tracks", "S": "a thread", "O": ["current window focus"]}, "records": {"A": "records", "S": "a thread", "O": ["user activity on the host"]}, "scrapes": {"A": "scrapes", "S": "a thread", "O": ["window contents (text, context menus, etc.)"]}}, {"creates": {"A": "creates", "S": "It", "O": ["a thread"]}}], "25": [{"crafted": {"A": "crafted", "S": "APT28", "O": ["this document", "to appear legitimate to all MIA system users"]}}], "26": [{"used": {"A": "used", "S": "APT28", "O": ["a lure (Figure 3) about hostilities surrounding a Malaysia Airlines flight downed in Ukraine", "in a probable attempt to compromise the Polish government"]}}], "27": [{"sending": {"A": "sending", "S": "it", "O": ["an initial HTTP GET request"]}, "uploads": {"A": "uploads", "S": "it", "O": ["the file contents of edg6EF885E2. tmp", "using HTTP POST requests", "to the C2 server"]}}], "28": [{"target": {"A": "target", "S": "the other", "O": ["members of the Armenian military", "by hosting a fake login page"]}}, {"imitated": {"A": "imitated", "S": "One APT28 domain", "O": ["a key Chechen-focused news website"]}}], "29": [{"stores": {"A": "stores", "S": "CHOPSTICK", "O": ["the encrypted message", "in an edg6EF885E2.tmp temporary file"]}, "encrypts": {"A": "encrypts", "S": "CHOPSTICK", "O": ["using RC4", "them"]}, "reads": {"A": "reads", "S": "CHOPSTICK", "O": ["messages", "from the mailslot"]}}], "30": [{"register": {"A": "register", "S": "APT28", "O": ["at least two domains mimicking the domains of legitimate organizations in the Caucasus"]}}], "31": [{"collecting": {"A": "collecting", "S": "CHOPSTICK", "O": ["host information"]}, "creates": {"A": "creates", "S": "CHOPSTICK", "O": ["a Windows mailslot", "with the name \u201ccheck_mes_v5555\u201d"]}}, {"write": {"A": "write", "S": "external binaries", "O": ["data", "to the \u201ccheck_mes_v5555\u201d mailslot"]}}, {"encrypt": {"A": "encrypt", "S": "CHOPSTICK", "O": ["output from other malware"]}}], "32": [{"use": {"A": "use", "S": "Two of the malware families (SOURFACE/CORESHELL and EVILTOSS)", "O": ["the same decryption sequence and similar algorithms", "for string encoding and decoding"]}}], "33": [{"encrypt and store": {"A": "encrypt and store", "S": "it", "O": ["configuration data", "in the Registry key HKU\\S-1-5-19_Classes\\Software\\Microsoft\\MediaPlayer\\{E6696105-E63E-4EF1-939E- 15DDD83B669A}\\chnnl"]}}], "34": [{"received": {"A": "received", "S": "The backdoor", "O": ["from nato_pop@mail[.]ru", "via POP", "its tasking"]}, "sent": {"A": "sent", "S": "The backdoor", "O": ["via SMTP", "to nato_smtp@mail[.]ru", "data"]}}], "35": [{"imitated": {"A": "imitated", "S": "Some of the APT28- registered domains", "O": ["hose of defense events held in Europe"]}}], "36": [{"hinder": {"A": "hinder", "S": "This", "O": ["static analysis of CORESHELL behavior", "by creating a large amount of unnecessary noise in the disassembly"]}}], "37": [{"be reported": {"A": "be reported", "O": ["The modules that are included in an instance of CHOPSTICK", "as part of POST messages", "to the C2 server"]}}], "38": [{"was installed": {"A": "was installed", "O": ["The backdoor", "alongside the NATO-themed decoy document depicted in Figure 8"]}}], "39": [{"tests": {"A": "tests", "S": "It", "O": ["for the installation of specific security products (Table 9) and applications (Table 10)"]}}], "40": [{"communicating": {"A": "communicating", "S": "CHOPSTICK", "O": ["over HTTP", "with one of its C2 servers"]}}], "41": [{"routing": {"A": "routing", "S": "One variant of CHOPSTICK", "O": ["between local directories, the registry and USB drives", "messages"]}}], "42": [{"uses": {"A": "uses", "S": "CORESHELL", "O": ["two threads", "to communicate with its C2 server"]}}], "43": [{"is": {"A": "is", "S": "OLDBAIT", "O": ["a credential harvester"]}, "installs": {"A": "installs", "S": "OLDBAIT", "O": ["in %ALLUSERPROFILE%\\\\Application Data\\ Microsoft\\MediaPlayer\\updatewindws.exe", "itself"]}}], "44": [{"sends": {"A": "sends", "S": "The first thread", "O": ["beacons that contain the process listing of the compromised host"]}}], "45": [{"used": {"A": "used", "S": "APT28", "O": ["lures written in Georgian"]}}], "46": [{"collecting": {"A": "collecting", "S": "One CHOPSTICK v1 variant", "O": ["Microsoft Office documents"]}}], "47": [{"is encrypted": {"A": "is encrypted", "O": ["The configuration block", "using RC4 encryption"]}}], "48": [{"used": {"A": "used", "S": "APT28", "O": ["a lure document"]}}, {"contained": {"A": "contained", "S": "a lure document", "O": ["a listing of birthdays for members of a working group between the Georgian MOD and the U.S. defense contractor"]}, "installed": {"A": "installed", "S": "a lure document", "O": ["a SOURFACE downloader"]}}], "49": [{"used": {"A": "used", "S": "It", "O": ["one of four embedded sender email addresses (@mia.gov.ge)", "to send files via email to another email address on the same mail server"]}}], "50": [{"encrypts": {"A": "encrypts", "S": "The backdoor", "O": ["data", "with an RSA public key"]}, "uploads": {"A": "uploads", "S": "it", "O": ["data"]}}], "51": [{"includes": {"A": "includes", "S": "One of the latest samples of CORESHELL", "O": ["counter-reverse engineering tactics", "via unused machine instructions"]}}, {"obfuscate": {"A": "obfuscate", "S": "APT28", "O": ["their code"]}, "implement": {"A": "implement", "S": "APT28", "O": ["counter-analysis techniques"]}}], "52": [{"crafts": {"A": "crafts", "S": "the threat group", "O": ["to mention specific topics (lures) relevant to recipients", "its emails"]}}, {"uses": {"A": "uses", "S": "APT28", "O": ["to target its victims", "spearphishing emails"]}}], "53": [{"contains": {"A": "contains", "S": "The decoy document", "O": ["metadata listing \u201cMIA\u201d as the company name and \u201cBeka Nozadze\u201d as an author"]}}], "54": [{"is performed": {"A": "is performed", "S": "a \u201cDirectory Observer\u201d module", "O": ["The monitoring for new files of interest"]}}], "55": [{"downloading": {"A": "downloading", "S": "The second thread"}, "executing": {"A": "executing", "S": "The second thread"}}], "56": [{"uploading": {"A": "uploading", "S": "CHOPSTICK", "O": ["edg6EF885E2.tmp"]}, "query": {"A": "query", "S": "CHOPSTICK", "O": ["its C2 servers", "for commands", "using HTTP GET requests"]}}], "57": [{"refer": {"A": "refer", "S": "the name SOURFACE", "O": ["to a specific downloader"]}}], "58": [{"used": {"A": "used", "S": "APT28", "O": ["a lure that contained a letter addressing a journalist by his first name and claiming to originate from a \u201cChief Coordinator\u201d in Reason Magazine\u2019s \u201cCaucasian Issues Department\u201d - a division that does not appear to exist"]}}], "59": [{"employed": {"A": "employed", "S": "APT28", "O": ["to protect files and stolen information moved from the victim\u2019s network to the controller", "RSA encryption"]}}], "60": [{"installs": {"A": "installs", "S": "a dropper", "O": ["SOURFACE"]}}], "61": [{"uses": {"A": "uses", "S": "APT28", "O": ["a backdoor developed using a modular framework"]}}], "62": [{"enumerate": {"A": "enumerate", "S": "it", "O": ["network resources"]}, "provide": {"A": "provide", "S": "it", "O": ["access to the file system and registry"]}, "log": {"A": "log", "S": "it", "O": ["keystrokes"]}, "execute": {"A": "execute", "S": "it", "O": ["shellcode"]}, "create": {"A": "create", "S": "it", "O": ["processes"]}, "access": {"A": "access", "S": "it", "O": ["stored credentials"]}}], "63": [{"writes": {"A": "writes", "S": "The thread", "O": ["to the \u201ccheck_mes_v5555\u201d mailslot", "in plain text", "user activity log messages"]}}], "64": [{"identify": {"A": "identify", "S": "runtime checks", "O": ["an analysis environment"]}}, {"contain": {"A": "contain", "S": "Several of APT28\u2019s malware samples", "O": ["counter- analysis capabilities"]}}, {"unpacked": {"A": "unpacked", "O": ["obfuscated strings", "at runtime"]}}, {"slow": {"A": "slow", "S": "inclusion of unused machine instructions", "O": ["analysis"]}}], "65": [{"obfuscate": {"A": "obfuscate", "S": "Many samples across the SOURFACE/ CORESHELL, CHOPSTICK, and EVILTOSS malware families", "O": ["strings that are decoded at runtime"]}}], "66": [{"determine": {"A": "determine", "S": "A number of CORESHELL droppers", "O": ["if they are executing in an analysis environment"]}, "conduct": {"A": "conduct", "S": "A number of CORESHELL droppers", "O": ["runtime checks"]}}], "67": [{"collects": {"A": "collects", "S": "CHOPSTICK", "O": ["the Windows version"]}}], "68": [{"is": {"A": "is", "S": "CHOPSTICK", "O": ["a backdoor"]}}], "69": [{"validate": {"A": "validate", "S": "The first two words (\u201c72 11\u201d and \u201cfd 22\u201d)", "O": ["the message"]}}], "70": [{"use": {"A": "use", "S": "EVILTOSS variants", "O": ["to send stolen data in an attachment named \u201cdetaluri. dat\u201d", "he Simple Mail Transfer Protocol (SMTP)"]}}], "71": [{"presented": {"A": "presented", "S": "a weaponized Excel file", "O": ["a decoy document containing a list of Georgian driver\u2019s license numbers"]}}], "72": [{"used": {"A": "used", "S": "an APT28 lure", "O": ["an information technology-themed decoy document that included references to the Windows domain \u201cMIA Users\\Ortachala\u2026\u201d (Figure 1)"]}}], "73": [{"be used": {"A": "be used", "O": ["to send out the collected credentials", "HTTP"]}}, {"are collected": {"A": "are collected", "O": ["Credentials for the following applications"]}}], "74": [{"load": {"A": "load", "S": "it"}, "memory-map": {"A": "memory-map", "S": "it"}}], "75": [{"registered": {"A": "registered", "S": "APT28", "O": ["a domain (smigroup- online.co[.]uk) that appeared to mimic that for the SMi Group"]}}], "76": [{"used": {"A": "used", "S": "APT28", "O": ["a lure that contained an apparent non-public listing of contact information for defense attach\u00e9s in the \u201cAnkara Military Attach\u00e9 Corps (AMAC),\u201d"]}}], "77": [{"identify": {"A": "identify", "O": ["to the C2 server", "the particular instance of the backdoor"]}}], "78": [{"communicate": {"A": "communicate", "S": "CHOPSTICK", "O": ["using SMTP or HTTP", "with external servers"]}}], "79": [{"target": {"A": "target", "S": "Another one of APT28\u2019s lures", "O": ["a specific journalist covering issues in the Caucasus region"]}}], "80": [{"use": {"A": "use", "S": "them", "O": ["local network resources such as email servers"]}}], "81": [{"drops and installs": {"A": "drops and installs", "S": "one", "O": ["the other"]}}], "82": [{"sent": {"A": "sent", "O": ["Email", "through a specified mail server"]}}], "83": [{"deletes": {"A": "deletes", "S": "CHOPSTICK", "O": ["the file"]}, "are uploaded": {"A": "are uploaded", "S": "CHOPSTICK", "O": ["the contents of edg6EF885E2.tmp"]}}], "84": [{"attached": {"A": "attached", "S": "APT28\u2019s backdoor", "O": ["a file containing system reconnaissance information"]}, "sent": {"A": "sent", "S": "APT28\u2019s backdoor", "O": ["an email message using a subject line related to driver\u2019s licenses (in Georgian)"]}}], "85": [{"be sent": {"A": "be sent", "O": ["this information", "via SMTP", "using a Georgian MIA mail server"]}}], "86": [{"disguise": {"A": "disguise", "S": "malware", "O": ["as legitimate MIA email traffic", "its activity"]}}], "87": [{"are encrypted": {"A": "are encrypted", "O": ["using another stream cipher but this time using an eight-byte key", "Commands from the controller to the CORESHELL implant"]}}], "88": [{"are obfuscated": {"A": "are obfuscated", "O": ["Both the internal strings and logic"]}}], "89": [{"encrypts": {"A": "encrypts", "S": "CHOPSTICK", "O": ["in the \u201cai=\u201d parameter", "an 11-byte sequence"]}}], "90": [{"containing": {"A": "containing", "S": "an APT28 lure", "O": ["a decoy document with a list of British officers and U.S. and Canadian military attach\u00e9s in London"]}}], "91": [{"retrieve": {"A": "retrieve", "S": "SOURFACE", "O": ["from a C2 server", "a second stage payload"]}}], "92": [{"uploading": {"A": "uploading", "S": "an HTTP POST request", "O": ["a segment from edg6EF885E2.tmp"]}}], "93": [{"is also Base64 encoded": {"A": "is also Base64 encoded", "O": ["The message body of the POST request"]}}], "94": [{"used": {"A": "used", "S": "APT28", "O": ["one domain for command and control sessions (baltichost[.]org) that was themed after the Baltic Host exercises"]}}]}, "apt29-hammertoss-stealthy-tactics-define-a.tokens": {"0": [{"avoid": {"A": "avoid", "S": "APT29", "O": ["detection"]}}], "1": [{"upload": {"A": "upload", "S": "HAMMERTOSS", "O": ["to accounts on cloud storage services", "information", "from victim networks", "using login credentials received in Stage 4"]}}], "2": [{"reconnaissance": {"A": "reconnaissance", "S": "the backdoor", "O": ["on the victim network"]}, "upload": {"A": "upload", "S": "the backdoor", "O": ["using the login credentials", "to a specific account on a cloud storage service", "it"]}, "obtain": {"A": "obtain", "S": "the backdoor", "O": ["a list of running tasks"]}}], "3": [{"execute": {"A": "execute", "O": ["it"]}}, {"save": {"A": "save", "O": ["to disk", "an executable"]}}, {"execute": {"A": "execute", "O": ["a direct command"]}}, {"execute": {"A": "execute", "O": ["file"]}}, {"execute": {"A": "execute", "O": ["via PowerShell", "commands"]}}], "4": [{"using": {"A": "using", "S": "MiniDuke", "O": ["Twitter", "for CnC"]}}], "5": [{"uses": {"A": "uses", "S": "the group", "O": ["compromised servers", "for CnC"]}}], "6": [{"adding": {"A": "adding", "S": "APT29", "O": ["layers of obfuscation"]}}], "7": [{"upload": {"A": "upload", "O": ["to a cloud storage service", "a victim\u2019s data"]}}], "8": [{"acquire": {"A": "acquire", "S": "Each variant", "O": ["CnC instructions"]}}], "9": [{"deliver": {"A": "deliver", "O": ["to HAMERTOSS", "the second-stage CnC"]}}]}, "ASERT-Threat-Intelligence-Brief-2014-07-Illuminating-Etumbot-APT.tokens": {"0": [{"is received": {"A": "is received", "O": ["a READFILE command", "from the C&C"]}}, {"makes": {"A": "makes", "S": "the bot", "O": ["to /manage/asp/item.asp?id=<encrypted computer name>&&mux=<encrypted total file size>", "an initial call"]}}], "1": [{"send": {"A": "send", "O": ["to the C&C", "an error message"]}}, {"expects": {"A": "expects", "S": "The bot", "O": ["from the C&C", "after each response is sent", "a message of \u201cOK\u201d"]}}], "2": [{"calls": {"A": "calls", "S": "dropper", "O": ["regedit with kb71271.log as a parameter to modify the registry"]}}, {"contains": {"A": "contains", "S": "C:\\DOCUME~1\\User\\LOCALS~1\\Temp\\ kb71271.log", "O": ["the following registry file"]}}, {"is created": {"A": "is created", "O": ["C:\\DOCUME~1\\User\\LOCALS~1\\Temp\\ kb71271.log"]}}], "3": [{"is created": {"A": "is created", "O": ["C:\\DOCUME~1\\User\\LOCALS~1\\Temp\\ka4281x3.log"]}, "copied": {"A": "copied", "O": ["C:\\DOCUME~1\\User\\LOCALS~1\\Temp\\ka4281x3.log", "to C:\\DOCUME~1\\User\\LOCALS~1\\Temp\\~t3fcj1.doc"]}, "filled": {"A": "filled", "O": ["with contents of the bait/distraction file", "C:\\DOCUME~1\\User\\LOCALS~1\\Temp\\ka4281x3.log"]}}], "4": [{"calling back": {"A": "calling back", "S": "both families", "O": ["to the same Command & Control servers"]}}], "5": [{"is delivered": {"A": "is delivered", "O": ["to the bot", "the RC4 key"]}}], "6": [{"creates": {"A": "creates", "S": "dropper", "O": ["the directory C:\\Documents and Settings\\User\\Application Data\\JAVA"]}, "loads up": {"A": "loads up", "S": "dropper", "O": ["a resource named \"BINARY\" from the resource section"]}}], "7": [{"is sent": {"A": "is sent", "O": ["an initial HTTP beacon", "to the Command & Control server that requests an RC4 encryption key"]}}, {"installs": {"A": "installs", "S": "the dropper", "O": ["the Etumbot backdoor"]}}], "8": [{"sends": {"A": "sends", "S": "the bot", "O": ["a registration callback to the C&C /image/<encrypted data>.jpg containing the encrypted values of system information to include the NetBIOS name of the system, user name, IP address, if the system is using a proxy (Yes/No), and a numeric value which may be some type of campaign code"]}}], "9": [{"is used": {"A": "is used", "O": ["to encrypt subsequent communication", "the RC4 key"]}}], "10": [{"used": {"A": "used", "S": "the group", "O": ["to compromise East Asian governments, Taiwanese electronics manufacturers, and a telecommunications company", "targeted emails with malicious PDF attachments"]}}], "11": [{"deleted": {"A": "deleted", "O": ["The ka4281x3.log file"]}}], "12": [{"is sent back": {"A": "is sent back", "O": ["The data", "via the URI /article/30441/Review.asp?id=<encoded computer name>&&date=<file chunk data>", "to the C&C"]}}], "13": [{"been used": {"A": "been used", "O": ["for multiple IXESHE samples", "The IP address 98.188.111.244", "as a C&C"]}}], "14": [{"registered": {"A": "registered", "S": "the bot", "O": ["with the C&C"]}, "send": {"A": "send", "S": "the bot", "O": ["periodic pings"]}}], "15": [{"contains": {"A": "contains", "S": "a dropper", "O": ["the backdoor binary (the second component) and the distraction file"]}}], "16": [{"discovers": {"A": "discovers", "S": "Etumbot", "O": ["the proxy settings of the local machine"]}}], "17": [{"load": {"A": "load", "S": "Etumbot", "O": ["strings into memory that has been called \u201cbyte strings\u201d and also \u201cstring stacking\u201d"]}}], "18": [{"drop": {"A": "drop", "S": "Most Etumbot samples observed by ASERT", "O": ["decoy documents (PDFs, Word Documents, and Excel Spreadsheets) written in Traditional Chinese and usually pertaining to Cross-Strait or Taiwanese Government interests"]}}], "19": [{"is then deleted": {"A": "is then deleted", "O": ["kb71271.log"]}}]}, "Attacks against Israeli & Palestinian interests - Cyber security updates.tokens": {"0": [{"begins": {"A": "begins", "S": "the\u00a0malware", "O": ["calling\u00a0home"]}, "keeping": {"A": "keeping", "S": "the\u00a0malware", "O": ["a\u00a0log\u00a0of\u00a0its\u00a0actions", "in a\u00a0plaintext\u00a0file that\u00a0is\u00a0created\u00a0in\u00a0the\u00a0same\u00a0folder\u00a0as\u00a0where\u00a0the\u00a0binary\u00a0was\u00a0executed\u00a0from"]}}], "1": [{"makes": {"A": "makes", "S": "the\u00a0malware", "O": ["a\u00a0couple\u00a0of\u00a0checks", "to avoid\u00a0analysis"]}}], "2": [{"also\u00a0checks": {"A": "also\u00a0checks", "S": "The\u00a0malware", "O": ["as\u00a0well\u00a0for any\u00a0processes including\u00a0the\u00a0word\u00a0\u2018security\u2019", "for the\u00a0presence\u00a0of\u00a0several\u00a0anti\u00advirus\u00a0solutions"]}}], "3": [{"reported\u00a0back": {"A": "reported\u00a0back", "S": "the\u00a0malware", "O": ["The\u00a0basic\u00a0information"]}}], "4": [{"executes": {"A": "executes", "S": "it"}, "downloads": {"A": "downloads", "S": "it"}}]}, "bcs_wp_InceptionReport_EN_v12914.tokens": {"0": [{"initiated": {"A": "initiated", "S": "Accessing the link from an Android User-Agent", "O": ["a download of an Android installer package named WhatsAppUpdate.apk"]}}], "1": [{"serves": {"A": "serves", "S": "tail-", "O": ["as a SOCKS proxy", "for the attackers"]}}], "2": [{"uploaded": {"A": "uploaded", "O": ["to the WebDAV shares", "The encrypted files"]}}], "3": [{"is then uploaded": {"A": "is then uploaded", "O": ["with the generated name", "The survey", "in a specified folder", "to the server"]}}], "4": [{"uploaded": {"A": "uploaded", "O": ["periodically", "to the attackers", "Recordings"]}, "are stored": {"A": "are stored", "O": ["as *.mp4 files", "Recordings"]}}], "5": [{"use": {"A": "use", "S": "The framework", "O": ["the WebDAV protocol", "to send instructions"]}}], "6": [{"checks": {"A": "checks", "S": "The binary", "O": ["a separate folder on the cloud service designated to contain new configuration information"]}}], "7": [{"uploaded": {"A": "uploaded", "O": ["to an FTP account", "These data"]}, "are encrypted": {"A": "are encrypted", "O": ["These data"]}}], "8": [{"downloaded": {"A": "downloaded", "S": "the malware", "O": ["something unexpected and wholly different from what we have discussed until now"]}}], "9": [{"connect": {"A": "connect", "S": "this IP", "O": ["to the opened port"]}, "tunnel": {"A": "tunnel", "S": "this IP", "O": ["through the router", "its email traffic"]}}], "10": [{"have": {"A": "have", "S": "We", "O": ["a set of phishing mails"]}}, {"have": {"A": "have", "S": "we", "O": ["the decoy documents"]}}], "11": [{"utilize": {"A": "utilize", "S": "The attackers", "O": ["compromised embedded devices \u2013 typically routers- on the Internet as well as multiple dedicated hosting providers and VPN services", "to mask their identity from the cloud storage provider and others"]}}], "12": [{"drops": {"A": "drops", "S": "it", "O": ["to disk", "two files"]}}], "13": [{"is": {"A": "is", "S": "It", "O": ["remote shell program"]}, "connect": {"A": "connect", "S": "It", "O": ["to interact with the attacker", "to a C&C server"]}, "download": {"A": "download", "S": "It", "O": ["more malware"]}}], "14": [{"load": {"A": "load", "S": "This configuration information", "O": ["the encrypted file", "into memory"]}}], "15": [{"is encrypted": {"A": "is encrypted", "O": ["All of this"]}, "sent": {"A": "sent", "O": ["to cloud storage", "via WebDAV", "All of this"]}}], "16": [{"be encrypted": {"A": "be encrypted", "O": ["using AES-256", "This data file"]}}], "17": [{"are compressed": {"A": "are compressed", "O": ["Files", "using a modified LZMA-compression"]}, "encrypted": {"A": "encrypted", "O": ["Files", "using AES cipher-block-chaining (CBC)"]}, "being uploaded": {"A": "being uploaded", "O": ["to the cloud server", "Files"]}}], "18": [{"checks": {"A": "checks", "S": "The malware", "O": ["configured subfolders", "for updates"]}}, {"be downloaded": {"A": "be downloaded", "O": ["they"]}}], "19": [{"is exfiltrated": {"A": "is exfiltrated", "O": ["All of this information", "back via the same WebDAV connection"]}}], "20": [{"free": {"A": "free", "S": "a call", "O": ["the PE image allocation", "from memory"]}}, {"loads": {"A": "loads", "S": "a call to a subfunction", "O": ["the PE image", "into memory"]}}], "21": [{"connect": {"A": "connect", "S": "Victims of this attack", "O": ["using the Windows WebDAV redirector"]}}], "22": [{"use": {"A": "use", "S": "This host", "O": ["the router proxy", "to connect to webdav.cloudme.com"]}}, {"connected": {"A": "connected", "S": "four IP addresses", "O": ["to the proxy malware"]}}], "23": [{"unlocked": {"A": "unlocked", "S": "It", "O": ["in connection with the sending of phishing emails", "for proxying", "routers"]}}], "24": [{"is launched": {"A": "is launched", "O": ["using regsrv32.exe", "with the /s (silent) option", "the DLL"]}}], "25": [{"is stored": {"A": "is stored", "O": ["in encoded form", "The malicious content", "inside the document"]}}, {"writes": {"A": "writes", "S": "the shellcode", "O": ["to disk", "this"]}}], "26": [{"is designed": {"A": "is designed", "O": ["as a survey tool", "It"]}}], "27": [{"randomized": {"A": "randomized", "S": "the names of the dropped files", "O": ["in order to avoid detection by name"]}}], "28": [{"triggered": {"A": "triggered", "S": "Using an IOS User-Agent", "O": ["the download of a Debian installer package, WhatsAppUpdate.deb"]}}], "29": [{"is used": {"A": "is used", "O": ["as a spreading and management platform for attacks on mobile devices", "The same router botnet"]}}], "30": [{"load": {"A": "load", "O": ["it", "from memory"]}}], "31": [{"uploads": {"A": "uploads", "S": "This host", "O": ["new malware components"]}}], "32": [{"pull": {"A": "pull", "S": "They", "O": ["from their target", "specific survey information"]}}], "33": [{"retrieves": {"A": "retrieves", "S": "921.bin", "O": ["Domain info"]}}], "34": [{"be connected": {"A": "be connected", "S": "another IP", "O": ["to the newly opened port"]}}, {"send": {"A": "send", "S": "the newly opened port", "O": ["phishing emails with malicious attachments"]}}], "35": [{"issue": {"A": "issue", "S": "the attackers", "O": ["Through the encrypted C&C protocol", "commands and binary updates", "to the malware"]}}, {"collect": {"A": "collect", "S": "The malware", "O": ["a lot of other information"]}}], "36": [{"gathers": {"A": "gathers", "S": "The PE file", "O": ["the process it is running in"]}}], "37": [{"were uploaded": {"A": "were uploaded", "O": ["the files themselves", "to the WebDAV share"]}}], "38": [{"connect": {"A": "connect", "S": "this IP", "O": ["to our router", "on the malware management port"]}}], "39": [{"connecting": {"A": "connecting", "S": "sccm.exe", "O": ["to this server"]}}, {"is used": {"A": "is used", "S": "many other malwares related to sccm.exe", "O": ["This C&C domain"]}}], "40": [{"obfuscate": {"A": "obfuscate", "S": "The polymorphing mechanism", "O": ["the actual decoding process"]}}], "41": [{"is executed": {"A": "is executed", "O": ["the script", "in the background"]}}], "42": [{"coming": {"A": "coming", "S": "One of the spearphishing mails", "O": ["through the router network"]}}, {"sent": {"A": "sent", "O": ["to an address under the gov.py (Government of Paraguay) domain", "One of the spearphishing mails"]}}], "43": [{"had": {"A": "had", "S": "we", "O": ["the actual phishing email"]}}], "44": [{"is": {"A": "is", "S": "The C&C server", "O": ["ict32.msname.org"]}}], "45": [{"send": {"A": "send", "S": "each of these", "O": ["out phishing attacks"]}}], "46": [{"be installed": {"A": "be installed", "O": ["in several locations", "The files"]}}], "47": [{"drops": {"A": "drops", "S": "this code", "O": ["a Word document and a Visual Basic script"]}}], "48": [{"identify": {"A": "identify", "S": "the attackers", "O": ["every targeted attack"]}}], "49": [{"polymorphed": {"A": "polymorphed", "O": ["using some backend tool", "the initial DLL"]}}], "50": [{"sent": {"A": "sent", "O": ["to targets in the oil industry", "a number of messages"]}}], "51": [{"tunneling": {"A": "tunneling", "S": "the malware", "O": ["to the destination", "all traffic received from the SOCKSS port"]}, "connect": {"A": "connect", "S": "the malware", "O": ["to the domain name", "on the specified port"]}}], "52": [{"is freed": {"A": "is freed", "O": ["once they have completed", "the memory"]}}, {"are executed": {"A": "are executed", "O": ["in memory", "They"]}}], "53": [{"are passed": {"A": "are passed", "O": ["a pointer to a function", "to use for sending data back home", "they"]}}], "54": [{"utilized": {"A": "utilized", "S": "a highly advanced and professional targeted attack framework", "O": ["to survey potential targets", "a complex series of techniques"]}}], "55": [{"relay": {"A": "relay", "S": "The mail proxy", "O": ["as seen below", "the spearphishing mail"]}}], "56": [{"collects": {"A": "collects", "S": "This"}}, {"be uploaded": {"A": "be uploaded", "O": ["to a DynDNS domain currently hosted on a US webhosting service", "Collected data"]}}], "57": [{"deletes": {"A": "deletes", "S": "the malware", "O": ["it", "from the server"]}, "downloads": {"A": "downloads", "S": "the malware", "O": ["the new configuration file"]}}], "58": [{"were downloaded": {"A": "were downloaded", "O": ["from the accounts carter0648 and frogs6352", "as encrypted *.bin files", "These files"]}}], "59": [{"transfer": {"A": "transfer", "S": "the malware"}}], "60": [{"execute": {"A": "execute", "S": "a startup key", "O": ["the DLLs", "at boot time"]}}, {"sets": {"A": "sets", "S": "The VBScript", "O": ["a startup key", "in the \u201cHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\u201d registry path"]}}], "61": [{"are injected": {"A": "are injected", "O": ["to ensure persistence on victim computers", "they", "daily"]}}], "62": [{"collect": {"A": "collect", "S": "it"}}], "63": [{"is encoded": {"A": "is encoded", "O": ["The communication between the attacker and the SOCKSS", "using the RC4 key"]}}], "64": [{"deleted": {"A": "deleted", "O": ["these", "from are downloaded these", "in are downloaded these"]}, "are downloaded": {"A": "are downloaded", "O": ["these", "from deleted these", "in deleted these"]}}], "65": [{"compiles": {"A": "compiles", "S": "922.bin", "O": ["a dirwalk \u2013 a complete listing of every file path \u2013 of each fixed drive"]}}], "66": [{"is leveraged": {"A": "is leveraged", "O": ["to gain remote access to victim\u2019s computers", "Exploitation of vulnerabilities in this file format"]}}], "67": [{"record": {"A": "record", "S": "this malware", "O": ["phone call audio"]}}], "68": [{"retrieve": {"A": "retrieve", "S": "the binary", "O": ["the listening port", "to use for incoming connections"]}}], "69": [{"containing": {"A": "containing", "S": "dropper packages", "O": ["one dropper executable clearly created for the Inception framework, and one other, very different executable"]}}], "70": [{"downloaded": {"A": "downloaded", "S": "the malware", "O": ["another encrypted configuration file"]}}], "71": [{"was presumably obtained": {"A": "was presumably obtained", "S": "the attackers"}, "repurposed": {"A": "repurposed", "S": "the attackers", "O": ["for the attack"]}}], "72": [{"is performed": {"A": "is performed", "O": ["via a convoluted network of router proxies and rented hosts", "Most interaction between attackers and their infrastructure"]}}], "73": [{"used": {"A": "used", "S": "the probable attackers", "O": ["a HTTP user-agent of \u201cdavfs2/1.4.6 neon/0.29.6\u201d"]}}], "74": [{"used": {"A": "used", "O": ["the C&C domain"]}}], "75": [{"scouting": {"A": "scouting", "S": "Inception"}, "exfiltrating": {"A": "exfiltrating", "S": "Inception"}}], "76": [{"using": {"A": "using", "S": "the attackers", "O": ["a known malicious C&C domain name"]}}], "77": [{"compromise": {"A": "compromise", "S": "the attackers", "O": ["these devices", "based on poor configurations or default credentials"]}}], "78": [{"appear": {"A": "appear", "S": "the organization from which the phishing email originates", "O": ["to be a known associate to the target"]}}], "79": [{"be mistaken": {"A": "be mistaken", "O": ["the attack", "to come from legitimate businesses and trusted organizations"]}}], "80": [{"impersonates": {"A": "impersonates", "S": "The application", "O": ["a settings utility"]}}], "81": [{"used": {"A": "used", "S": "the attackers", "O": ["two mail proxies"]}}], "82": [{"been using": {"A": "been using", "S": "The framework", "O": ["the services of a cloud service provider based in Sweden, CloudMe.com", "for its main command-and-control infrastructure"]}}], "83": [{"impersonates": {"A": "impersonates", "S": "This application", "O": ["a Cydia installer"]}}], "84": [{"is": {"A": "is", "S": "this malware", "O": ["a more typical datastealer"]}}, {"increase": {"A": "increase", "S": "encrypted data uploads from compromised users"}}], "85": [{"pointing": {"A": "pointing", "S": "different configuration blocks", "O": ["to C&C servers apparently located in Poland, Germany and Russia, respectively"]}}], "86": [{"drops": {"A": "drops", "S": "The one above", "O": ["ctfmonrc.dll"]}}], "87": [{"maintain": {"A": "maintain", "S": "the attackers", "O": ["a list of where each of these implants are installed, as well as what port and key each is configured to use"]}}], "88": [{"be performed": {"A": "be performed", "O": ["via the cloud service", "all post-infection communication (i.e. target surveying, configuration updates, malware updates, and data exfiltration)"]}}]}, "BlackEnergy2_Plugins_Router.tokens": {"0": [{"is downloaded": {"A": "is downloaded", "S": "main.dll", "O": ["from the server", "on an infected system", "a configuration file"]}}], "1": [{"were hacked": {"A": "were hacked", "O": ["their Cisco routers with different IOS versions"]}}], "2": [{"uses": {"A": "uses", "S": "BE2", "O": ["start menu locations", "for persistence"]}}], "3": [{"spearphished": {"A": "spearphished", "S": "The BE2 attackers", "O": ["an organization"]}}], "4": [{"spread and launch": {"A": "spread and launch", "S": "The 'vsnet' plugin", "O": ["a payload (BlackEnergy2 dropper itself at the moment) in the local network", "using PsExec"]}, "gaining": {"A": "gaining", "S": "The 'vsnet' plugin", "O": ["primary information on the user's computer and network"]}}], "5": [{"stores": {"A": "stores", "S": "BE2", "O": ["the downloaded plugins"]}}], "6": [{"downloading": {"A": "downloading", "S": "BlackEnergy2", "O": ["more crimeware plugins - a custom spam plugin and a banking information stealer custom plugin"]}}], "7": [{"launching": {"A": "launching", "S": "BlackEnergy custom plugins", "O": ["DDoS attacks"]}}], "8": [{"installs": {"A": "installs", "S": "BE dropper", "O": ["its driver"]}}], "9": [{"pushed": {"A": "pushed", "S": "the attackers", "O": ["the 'dstr' module"]}}], "10": [{"launch": {"A": "launch", "S": "another crimeware group", "O": ["DDoS attacks"]}}], "11": [{"delivered": {"A": "delivered", "S": "the same server", "O": ["the ARM module"]}}], "12": [{"download": {"A": "download", "S": "The script", "O": ["from a certain FTP server", "ciscoapi.tcl"]}}], "13": [{"upload": {"A": "upload", "S": "the attackers", "O": ["specific plugins"]}}], "14": [{"downloaded": {"A": "downloaded", "S": "Siemens \"ccprojectmgr.exe\"", "O": ["a handful of different payloads"]}}], "15": [{"delivered": {"A": "delivered", "S": "The server", "O": ["config files"]}}], "16": [{"controlled": {"A": "controlled", "S": "the attackers", "O": ["infected MIPS/ARM devices"]}}], "17": [{"communicated": {"A": "communicated", "S": "Linux Hook main module", "O": ["with the same CnC server"]}}]}, "China_Peace_Palace.tokens": {"0": [{"connects back": {"A": "connects back", "S": "The malware", "O": ["to the exploit domain pic.nicklockluckydog[.]org", "to the subdomain ssl.nicklockluckydog[.]org"]}}], "1": [{"loads": {"A": "loads", "S": "The malicious DLL", "O": ["a backdoor binary blob MD5"]}}], "2": [{"load": {"A": "load", "S": "LMS.exe", "O": ["any DLL file name dbghelp.dll that is found in the same path"]}}]}, "Chinese_MITM_Google.tokens": {"0": [{"reconfiguring": {"A": "reconfiguring", "O": ["a router", "to forward the HTTPS traffic to a transparent SSL proxy"]}}, {"performing": {"A": "performing", "O": ["IP hijacking"]}}], "1": [{"is carried out": {"A": "is carried out", "O": ["on the 2001:252::/32 network", "the MITM"]}}], "2": [{"running": {"A": "running", "S": "The Chinese", "O": ["a MITM attack"]}}], "3": [{"taking place": {"A": "taking place", "S": "IP MITM"}}], "4": [{"is being conducted": {"A": "is being conducted", "O": ["a MITM attack", "against traffic between China\u2019s nationwide education and research network CERNET and www.google.com"]}}]}, "CloudAtlas_RedOctober_APT.tokens": {"0": [{"connected": {"A": "connected", "S": "only one other group", "O": ["to accounts on the cloud provider mydrive.ch"]}}], "1": [{"uploads": {"A": "uploads", "S": "the malware", "O": ["the replies", "via the same mechanism", "back to the server"]}}], "2": [{"utilize": {"A": "utilize", "S": "The Cloud Atlas implants", "O": ["a rather unusual C&C mechanism"]}}], "3": [{"exploit": {"A": "exploit", "S": "some of the spear-phishing documents between Cloud Atlas and RedOctober", "O": ["the same theme"]}, "target": {"A": "target", "S": "some of the spear-phishing documents between Cloud Atlas and RedOctober", "O": ["at different times", "the same entity"]}}], "4": [{"is always encrypted": {"A": "is always encrypted", "O": ["with a unique key", "The payload"]}}], "5": [{"used": {"A": "used", "S": "RedOctober", "O": ["a very similarly named spearphish: \"Diplomatic Car for Sale.doc\""]}}], "6": [{"contain": {"A": "contain", "S": "The files stored in the randomly named folder", "O": ["various things, such as system information, running processes and current username"]}}, {"were uploaded": {"A": "were uploaded", "S": "the malware", "O": ["The files stored in the randomly named folder"]}}], "7": [{"communicate": {"A": "communicate", "S": "All the malware samples we've seen", "O": ["via HTTPS and WebDav", "with the same server \"cloudme.com\", a cloud services provider"]}}], "8": [{"is compressed": {"A": "is compressed", "O": ["with LZMA", "The data"]}, "encrypted": {"A": "encrypted", "O": ["with AES", "The data"]}}], "9": [{"writes": {"A": "writes", "S": "it", "O": ["an encrypted Visual Basic Script"]}, "runs": {"A": "runs", "S": "it", "O": ["it"]}}], "10": [{"adds": {"A": "adds", "S": "The VBS", "O": ["a registry key: HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\"]}, "setting": {"A": "setting", "S": "The VBS", "O": ["the key \"bookstore\"", "to the value \"regsvr32 %path%\\ctfmonrn.dll /s\""]}, "ensures": {"A": "ensures", "S": "The VBS"}}, {"drops": {"A": "drops", "S": "E211C2BAD9A83A6A4247EC3959E2A730", "O": ["the following files"]}}], "11": [{"relocate": {"A": "relocate", "S": "Most Chinese-speaking attackers", "O": ["to a different place", "C&C servers"]}}], "12": [{"is used": {"A": "is used", "O": ["a WebDAV URL", "for connections"]}}, {"contains": {"A": "contains", "S": "an encrypted configuration block", "O": ["information about the C&C sever"]}}, {"be uploaded": {"A": "be uploaded", "O": ["data from the victim"]}}], "13": [{"communicates": {"A": "communicates", "S": "Each malware set we have observed so far", "O": ["with a different CloudMe account"]}}], "14": [{"is downloaded": {"A": "is downloaded", "S": "the implant", "O": ["data"]}}], "15": [{"drop": {"A": "drop", "S": "several different spear-phishing documents", "O": ["uniquely named payloads"]}}], "16": [{"being targeted": {"A": "being targeted", "S": "CloudAtlas", "O": ["some of the victims of RedOctober"]}}], "17": [{"drops": {"A": "drops", "S": "This VBScript", "O": ["a pair of files", "on disk"]}}]}, "CmstarDownloader_Lurid_Enfal_Cousin.tokens": {"0": [{"used": {"A": "used", "S": "The Cmstar tool", "O": ["a hashing algorithm", "on an infected system", "to find antivirus processes"]}, "manually creating": {"A": "manually creating", "S": "The Cmstar tool", "O": ["using an API function name character", "to offset mapping techniques", "its import address table"]}}], "1": [{"gathers": {"A": "gathers", "S": "the Cmstar downloader", "O": ["to send to the C2 server", "system-specific information"]}}], "2": [{"writes": {"A": "writes", "S": "the malware author", "O": ["log messages", "to the \u2018DF64159.TMP\u2019 file"]}}, {"gathers": {"A": "gathers", "S": "the Trojan", "O": ["from the infected machine", "data"]}}], "3": [{"create": {"A": "create", "S": "Cmstar", "O": ["to communicate with its C2 server", "HTTP requests"]}}], "4": [{"enumerates": {"A": "enumerates", "S": "this malware", "O": ["libraries\u2019 export address table (EAT)"]}}], "5": [{"drop": {"A": "drop", "S": "spear-phishing attacks", "O": ["a custom downloader"]}}], "6": [{"carries out": {"A": "carries out", "S": "a 752-byte piece of shellcode", "O": ["with the C2 server", "communications"]}, "sending": {"A": "sending", "S": "a 752-byte piece of shellcode", "O": ["to the following URL", "HTTP POST requests"]}}], "7": [{"uses": {"A": "uses", "S": "that Cmstar", "O": ["a URL", "as its command and control (C2) location"]}}], "8": [{"looks for": {"A": "looks for", "S": "the Cmstar sample", "O": ["Kaspersky\u2019s Anti-virus product (avp.exe) running on the compromised system"]}}], "9": [{"creates": {"A": "creates", "S": "The Cmstar sample associated with the MNKIT delivery document", "O": ["the following registry key", "to automatically execute at system startup"]}}]}, "Compromise_Greece_Beijing.tokens": {"0": [{"creates": {"A": "creates", "S": "it", "O": ["an instance of the Internet Explorer"]}, "contacting": {"A": "contacting", "S": "it", "O": ["the C&C server"]}}], "1": [{"downloads": {"A": "downloads", "S": "it", "O": ["some kind of data"]}}], "2": [{"retrieve": {"A": "retrieve", "S": "It", "O": ["possible AntiVirus information", "by using the COM interface"]}}], "3": [{"adding": {"A": "adding", "S": "this malware", "O": ["several registry keys", "to Internet Explorer"]}}], "4": [{"launch": {"A": "launch", "S": "it", "O": ["an instance of Internet Explorer"]}, "contact": {"A": "contact", "S": "it", "O": ["its C&C server"]}}], "5": [{"contacted": {"A": "contacted", "S": "the malware sample", "O": ["the C&C server"]}}], "6": [{"encode": {"A": "encode", "S": "the sample", "O": ["from Base64", "data"]}}]}, "CozyDuke.tokens": {"0": [{"use": {"A": "use", "S": "the dropper", "O": ["to load and execute the CozyDuke main component", "the copy of rundll32.exe"]}}], "1": [{"checking": {"A": "checking", "S": "The main CozyDuke dropper", "O": ["whether the victim has an anti-virus product installed"]}}], "2": [{"executed": {"A": "executed", "S": "CozyDuke"}, "downloaded": {"A": "downloaded", "S": "CozyDuke"}}], "3": [{"executed": {"A": "executed", "S": "the CozyDuke dropper", "O": ["The main component", "using a copy of rundll32.exe"]}}], "4": [{"executing": {"A": "executing", "S": "multiple kinds of droppers", "O": ["additional tools", "from the CozyDuke toolset"]}, "infecting": {"A": "infecting", "S": "multiple kinds of droppers", "O": ["hosts", "with CozyDuke"]}}], "5": [{"involve": {"A": "involve", "S": "These tasks", "O": ["the execution of modules or executables providing additional functionality"]}}], "6": [{"establishing and maintaining": {"A": "establishing and maintaining", "S": "The CozyDuke toolset", "O": ["to the hosts", "backdoor access"]}, "infecting": {"A": "infecting", "S": "The CozyDuke toolset", "O": ["targeted hosts"]}, "gathering": {"A": "gathering", "S": "The CozyDuke toolset", "O": ["information", "from them"]}, "gaining": {"A": "gaining", "S": "The CozyDuke toolset", "O": ["further access", "to other hosts inside the victim organization"]}}], "7": [{"copy": {"A": "copy", "S": "The dropper", "O": ["to the install location for CozyDuke", "the system file rundll32.exe"]}}], "8": [{"write": {"A": "write", "S": "CozyDuke", "O": ["to disk"]}, "execute": {"A": "execute", "S": "CozyDuke", "O": ["on the infected host"]}}], "9": [{"ensure": {"A": "ensure", "S": "Newer versions of the dropper", "O": ["inside a known malware analysis sandbox", "the dropper is not being executed"]}}], "10": [{"register": {"A": "register", "S": "CozyDuke", "O": ["as scheduled task"]}}], "11": [{"write": {"A": "write", "S": "it", "O": ["two files", "to disk"]}}], "12": [{"implements": {"A": "implements", "S": "the main component of CozyDuke", "O": ["6 commands that the C&C server can specify"]}}], "13": [{"communicating": {"A": "communicating", "S": "CozyDuke", "O": ["with its command and control server", "using either HTTP or HTTPS"]}}], "14": [{"modify": {"A": "modify", "S": "CozyDuke", "O": ["the registry entries", "that will ensure CozyDuke stays active on the victim host"]}}], "15": [{"infecting": {"A": "infecting", "S": "the CozyDuke toolset", "O": ["additional hosts in the same target organization"]}, "gathering": {"A": "gathering", "S": "the CozyDuke toolset", "O": ["further information", "from infected hosts"]}}], "16": [{"spread": {"A": "spread", "S": "CozyDuke", "O": ["via email"]}}], "17": [{"are": {"A": "are", "S": "The most important functionalities", "O": ["establishment of persistence"]}}], "18": [{"execute": {"A": "execute", "S": "an executable", "O": ["CozyDuke"]}, "write": {"A": "write", "S": "an executable", "O": ["to disk"]}}], "19": [{"write": {"A": "write", "S": "The dropper", "O": ["the CozyDuke components", "to the specified location"]}}], "20": [{"adding": {"A": "adding", "S": "CozyDuke", "O": ["to be executed at system startup", "a registry value"]}}], "21": [{"drop": {"A": "drop", "S": "the executables", "O": ["other executables, scripts or DLLs"]}}], "22": [{"\u201chijack\u201d": {"A": "\u201chijack\u201d", "S": "CozyDuke", "O": ["the registry entries for the COM object \u201cSharedTaskScheduler\u201d"]}}], "23": [{"is": {"A": "is", "S": "CozyDuke\u2019s primary purpose", "O": ["the execution of tasks"]}}], "24": [{"extending": {"A": "extending", "S": "CozyDuke modules", "O": ["CozyDuke\u2019s functionality"]}}], "25": [{"write": {"A": "write", "S": "This dropper", "O": ["the main CozyDuke components", "to disk", "encrypted configuration file used by CozyDuke"]}}], "26": [{"included": {"A": "included", "S": "the configuration data for any single CozyDuke instance", "O": ["the details of either one or two C&C servers"]}}]}, "cto-tib-20150223-01a.tokens": {"0": [{"tracking": {"A": "tracking", "O": ["files and drives present on the victim machine"]}}], "1": [{"contain": {"A": "contain", "S": "the e-mails", "O": ["links to websites hosting ScanBox"]}}], "2": [{"perform": {"A": "perform", "S": "an attacker", "O": ["reconnaissance and key logging of visitors to compromised websites"]}}], "3": [{"being": {"A": "being", "S": "it", "O": ["a command and control destination for malware"]}}], "4": [{"performs": {"A": "performs", "S": "ScanBox", "O": ["keylogging of users", "when they visit a compromised website"]}}]}, "Cylance SPEAR Team_ A Threat Actor Resurfaces.tokens": {"0": [{"make": {"A": "make", "S": "The backdoor", "O": ["over HTTP", "to the C2", "using the following parameters in the URI string", "requests"]}}, {"look for": {"A": "look for", "S": "the backdoor", "O": ["encrypted commands", "within HTML comments returned from the C2"]}}], "1": [{"spawning": {"A": "spawning", "S": "it", "O": ["malicious threads"]}}, {}], "2": [{"load": {"A": "load", "S": "the backdoor", "O": ["the legitimate system32\\msacm32.drv\u00a0file"]}}, {"contains": {"A": "contains", "S": "The backdoor", "O": ["identical exports", "additional dummy function from the legitimate msacm32.drvcalled \"StartWork\""]}}], "3": [{"communicate": {"A": "communicate", "S": "The binary", "O": ["on port 80", "using standard HTTP POST and GET requests", "to \"www.microsoftservices.proxydns.com\""]}}], "4": [{"load": {"A": "load", "S": "explorer.exe", "O": ["the backdoor", "On reboot"]}}], "5": [{"execute": {"A": "execute", "S": "the attacker"}, "upload": {"A": "upload", "S": "the attacker"}, "delete": {"A": "delete", "S": "the attacker"}, "list": {"A": "list", "S": "the attacker", "O": ["on the system", "drivers"]}, "download": {"A": "download", "S": "the attacker"}, "enumerate": {"A": "enumerate", "S": "the attacker"}, "search": {"A": "search", "S": "the attacker"}}, {"creates": {"A": "creates", "S": "The malware", "O": ["a Run key", "in the current user's hive"]}}], "6": [{"execute": {"A": "execute", "S": "the backdoor", "O": ["whenever the victim user logs into the system"]}}]}, "Cylance_Operation_Cleaver_Report.tokens": {"0": [{"is made": {"A": "is made", "O": ["A bug fix", "to the keystroke logging method"]}}, {"is enabled": {"A": "is enabled", "O": ["clipboard monitoring"]}}], "1": [{"is": {"A": "is", "S": "Privilege escalation", "O": ["a category of techniques that describe the process of going from a less privileged user on a compromised computer to a more privileged user"]}}], "2": [{"was implemented": {"A": "was implemented", "O": ["the SOAP-based command and control protocol"]}}], "3": [{"request": {"A": "request", "S": "the TinyZBot", "O": ["the file"]}, "download": {"A": "download", "S": "the TinyZBot", "O": ["the file"]}}], "4": [{"allows": {"A": "allows", "S": "Double encoding SQL injection payloads", "O": ["for bypassing of various anti-exploitation filters, such as those supplied by Web Application Firewalls (WAFs)"]}}], "5": [{"is performed": {"A": "is performed", "S": "internally developed malware samples such as TinyZBot and Csext", "O": ["The sending", "in order to exfiltrate information about the infected computer, as well as requested files and keystroke logging information"]}}], "6": [{"utilized": {"A": "utilized", "S": "Cleaver Operations", "O": ["in order to pilfer large quantities of information", "FTP servers", "with anonymous access enabled"]}}], "7": [{"allowed": {"A": "allowed", "S": "scripts or applications", "O": ["for command or code execution outside of the victim network"]}}], "8": [{"sent": {"A": "sent", "O": ["TCP data", "from the command and control server"]}}, {"sent": {"A": "sent", "O": ["from the TinyZBot infection", "TCP data"]}}], "9": [{"making": {"A": "making", "O": ["it", "a reverse connecting shell"]}}, {"is running": {"A": "is running", "S": "This zhCat instance", "O": ["cmd.exe"]}}], "10": [{"was established": {"A": "was established", "O": ["A command and control protocol"]}}, {"using": {"A": "using", "S": "A command and control protocol", "O": ["for the protocol", "HTTP and SOAP"]}}], "11": [{"see": {"A": "see", "S": "we", "O": ["the following HTTP POST request"]}}], "12": [{"being utilized": {"A": "being utilized", "O": ["a staging server", "for multiple attacks as well as a tool for sharing data between members of the organization\u2019s team"]}}], "13": [{"are transferred": {"A": "are transferred", "O": ["in the Content- Disposition HTTP header", "The commands as well as infected computer information"]}}, {"pass over": {"A": "pass over", "S": "the traffic", "O": ["as benign"]}}], "14": [{"enumerating": {"A": "enumerating", "S": "supplemental tools", "O": ["every process"]}}], "15": [{"leverages": {"A": "leverages", "S": "PrivEsc", "O": ["the vulnerability commonly referred to as KiTrap0D (CVE-2010-0232)"]}}], "16": [{"established": {"A": "established", "S": "Iranian actors", "O": ["persistence"]}, "extracted": {"A": "extracted", "S": "Iranian actors", "O": ["highly sensitive materials"]}}], "17": [{"execute": {"A": "execute", "S": "tools like the PVZ tool chain and Csext", "O": ["with logged results"]}}, {"extracted": {"A": "extracted", "S": "an attacker", "O": ["credentials", "from the cache"]}}, {"run": {"A": "run", "S": "PsExec", "O": ["on any other computer which accepts those domain credentials", "commands"]}}], "18": [{"is": {"A": "is", "S": "This keystroke logger source", "O": ["publicly available and referred to as DeadkeyLogger"]}}], "19": [{"repeats": {"A": "repeats", "S": "This copy", "O": ["but with already discovered credentials as well as newly discovered ones on the newly infected host", "the behavior of the original"]}}], "20": [{"were obfuscated": {"A": "were obfuscated", "O": ["Many versions", "with a legitimate tool for developers named SmartAssembly"]}}], "21": [{"are often used": {"A": "are often used", "S": "botnets", "O": ["HTTP communications"]}}], "22": [{"opened": {"A": "opened", "S": "they", "O": ["an image stored in the resource section of the executable"]}, "copied": {"A": "copied", "S": "they", "O": ["to the %AppData% directory", "the malicious TinyZBot executable"]}}], "23": [{"is limited": {"A": "is limited", "O": ["to executing supplied commands", "Command functionality"]}}], "24": [{"has": {"A": "has", "S": "It", "O": ["a remotely installable trojan named Abel"]}}, {"enables": {"A": "enables", "S": "a remotely installable trojan named Abel", "O": ["some of its functionality", "on a remote target"]}}], "25": [{"is commonly installed": {"A": "is commonly installed", "O": ["TinyZBot", "using some form of deception"]}}], "26": [{"breaks down": {"A": "breaks down", "S": "Its functionality", "O": ["into uploading files"]}}], "27": [{"is also impersonating": {"A": "is also impersonating", "S": "TinyZBot", "O": ["when distributed", "potential employers"]}}, {"being installed": {"A": "being installed", "O": ["while impersonating a r\u00e9sum\u00e9 creation suite", "TinyZBot"]}}], "28": [{"regain": {"A": "regain", "S": "the attackers", "O": ["if they ever lose access", "access to a compromised network"]}}], "29": [{"executed": {"A": "executed", "O": ["the malware (TinyZbot)"]}, "is dropped": {"A": "is dropped", "O": ["the malware (TinyZbot)"]}}, {"is ensured": {"A": "is ensured", "O": ["an Internet connection"]}}], "30": [{"leveraged": {"A": "leveraged", "S": "Pivoting and exploitation techniques", "O": ["existing public exploits for MS08-067 and Windows privilege escalations"]}}, {"were coupled": {"A": "were coupled", "O": ["Pivoting and exploitation techniques", "with automated, worm-like propagation mechanisms"]}}], "31": [{"be transferred": {"A": "be transferred", "S": "zhCat", "O": ["this information", "with inline obfuscation and/ or encryption"]}}], "32": [{"communicates": {"A": "communicates", "S": "this command and control channel", "O": ["with the Content-Disposition HTTP header"]}}, {"is supplied": {"A": "is supplied", "O": ["for file data", "POST data"]}}], "33": [{"communicate": {"A": "communicate", "S": "Csext", "O": ["with the following servers"]}}], "34": [{"logs": {"A": "logs", "S": "MimikatzWrapper", "O": ["to res.txt", "in the executing directory", "these results"]}}], "35": [{"set up": {"A": "set up", "S": "An attacker", "O": ["with the following command", "in order to enable both HTTP and XOR obfuscation", "a server instance of zhCat"]}}], "36": [{"was also changed": {"A": "was also changed", "O": ["The exfiltration email address", "to TerafficAnalyzer(at)yahoo.com"]}}], "37": [{"be executed": {"A": "be executed", "O": ["from a browser or client able to communicate with them", "commands"]}}, {"were": {"A": "were", "S": "Many of their backdoors", "O": ["web applications"]}}], "38": [{"using": {"A": "using", "S": "WndTest", "O": ["for its command and control server", "PHP servers"]}}], "39": [{"use": {"A": "use", "S": "The Operation Cleaver team", "O": ["it", "as a reverse connecting shell"]}}], "40": [{"limit": {"A": "limit", "S": "This", "O": ["antivirus detection of each individual file"]}}], "41": [{"is combined": {"A": "is combined", "O": ["this technique", "with cached credential dumping"]}}, {"jump": {"A": "jump", "S": "it", "O": ["from computer", "to computer", "on a compromised network"]}}], "42": [{"uses": {"A": "uses", "S": "Operation Cleaver", "O": ["to forward local RDP ports to remote SSH servers", "PLink"]}}], "43": [{"compromise": {"A": "compromise", "S": "the Operation Cleaver team", "O": ["the entirety of their organization"]}, "were captured": {"A": "were captured", "S": "the Operation Cleaver team", "O": ["Private signing certificates of one victim"]}}], "44": [{"extracting": {"A": "extracting", "S": "It", "O": ["cached credentials", "from the infected computer\u2019s cache"]}}], "45": [{"maintain": {"A": "maintain", "S": "TinyZBot"}, "gather": {"A": "gather", "S": "TinyZBot", "O": ["from an infected computer", "information"]}, "further": {"A": "further", "S": "TinyZBot"}}], "46": [{"be started": {"A": "be started", "O": ["If no mutex and process pair was located", "another TinyZBot instance"]}}], "47": [{"utilizes": {"A": "utilizes", "S": "Net Crawler", "O": ["along with PsExec", "a cached credential dumping technique"]}, "worm": {"A": "worm", "S": "Net Crawler", "O": ["throughout a network"]}, "collecting": {"A": "collecting", "S": "Net Crawler", "O": ["any and all credentials that it can extract from credential caches"]}}], "48": [{"logging": {"A": "logging", "S": "It", "O": ["keystroke data"]}, "creating": {"A": "creating", "S": "It", "O": ["a link", "in the user\u2019s startup folder", "for persistence"]}, "sending": {"A": "sending", "S": "It", "O": ["emails"]}}], "49": [{"allowing": {"A": "allowing", "S": "complete access to airport gates and their security control systems", "O": ["to spoof gate credentials", "them"]}}, {"achieved": {"A": "achieved", "S": "They", "O": ["complete access to airport gates and their security control systems"]}}], "50": [{"been observed": {"A": "been observed", "O": ["The following command and control servers for Logger Module"]}}], "51": [{"dump": {"A": "dump", "S": "It", "O": ["stored and cached credentials"]}, "conduct": {"A": "conduct", "S": "It", "O": ["attacks like ARP cache poisoning"]}, "capture": {"A": "capture", "S": "It", "O": ["credentials being transmitted on the network"]}}], "52": [{"makes": {"A": "makes", "S": "This", "O": ["the traffic between zhCat instances", "look like benign HTTP traffic"]}}], "53": [{"conducting": {"A": "conducting", "S": "They", "O": ["SQL injections"]}, "exfiltrating": {"A": "exfiltrating", "S": "They", "O": ["using this address", "information"]}, "controlling": {"A": "controlling", "S": "They", "O": ["backdoors"]}}], "54": [{"exhibits": {"A": "exhibits", "S": "Net Crawler", "O": ["worm-like behavior"]}, "gather": {"A": "gather", "S": "Net Crawler", "O": ["from any and all accessible computers on an infected network", "cached credentials"]}}], "55": [{"exfiltrates": {"A": "exfiltrates", "S": "PVZ bot", "O": ["a location"]}, "capture": {"A": "capture", "S": "it", "O": ["the user\u2019s keystrokes"]}, "save": {"A": "save", "S": "it", "O": ["to a location", "them"]}}], "56": [{"be exfiltrated": {"A": "be exfiltrated", "O": ["over SOAP", "files", "to the command and control server"]}}], "57": [{"supplementing": {"A": "supplementing", "S": "These tools", "O": ["the function of other tools gathering information during the infiltration process"]}, "monitoring": {"A": "monitoring", "S": "These tools", "O": ["the activity of other tools"]}}], "58": [{"are written": {"A": "are written", "O": ["to a temporary directory", "both applications"]}, "executed": {"A": "executed", "O": ["both applications"]}}], "59": [{"connect": {"A": "connect", "S": "zhCat", "O": ["on TCP port 443", "using the HTTP protocol", "back to srv01.microsoftwindowsupdate(dot)net (a deceptive domain owned by this group with falsified Whois data attributing to Microsoft Investor Relations)", "with XORed communication"]}}, {"executes": {"A": "executes", "S": "This configuration", "O": ["zhCat"]}}], "60": [{"exfiltrate": {"A": "exfiltrate", "S": "These RDP connections", "O": ["information"]}, "remotely control": {"A": "remotely control", "S": "These RDP connections", "O": ["the computers hosting the RDP servers"]}}], "61": [{"download": {"A": "download", "S": "infected computers", "O": ["additional files", "from these FTP servers"]}}, {"were also observed": {"A": "were also observed", "O": ["during the infection process", "These FTP servers"]}}], "62": [{"was also executed": {"A": "was also executed", "O": ["the malware"]}}], "63": [{"is killed": {"A": "is killed", "S": "taskkill", "O": ["This command", "a 00:35"]}}], "64": [{"exfiltrate": {"A": "exfiltrate", "S": "PVZ-Out", "O": ["it", "to its command and control server"]}}, {"is written out": {"A": "is written out", "O": ["The resulting log"]}}], "65": [{"exfiltrate": {"A": "exfiltrate", "S": "Cleaver", "O": ["from many critical infrastructure companies", "extremely sensitive data"]}}], "66": [{"decide": {"A": "decide", "S": "they", "O": ["whether the infection has hit the correct target"]}}, {"are often run": {"A": "are often run", "O": ["on newly infected systems", "Commands such as GETINFO"]}}, {"responds": {"A": "responds", "S": "TinyZBot", "O": ["to a list of supported commands"]}}], "67": [{"include": {"A": "include", "S": "Customized private tools with functions", "O": ["encryption"]}}], "68": [{"gained": {"A": "gained", "S": "They", "O": ["access to PayPal and Go Daddy credentials"]}}, {"allowed": {"A": "allowed", "S": "access to PayPal and Go Daddy credentials", "O": ["unfettered access to the victim\u2019s domains"]}, "allowing": {"A": "allowing", "S": "access to PayPal and Go Daddy credentials", "O": ["to make fraudulent purchases", "them"]}}], "69": [{"was added": {"A": "was added", "O": ["Clipboard monitoring code"]}}], "70": [{"downloading": {"A": "downloading", "S": "he command and control"}, "executing": {"A": "executing", "S": "he command and control", "O": ["batch scripts"]}, "upgrading": {"A": "upgrading", "S": "he command and control"}}], "71": [{"automate": {"A": "automate", "S": "Two similar applications", "O": ["the execution of Mimikatz"]}}], "72": [{"is": {"A": "is", "S": "Jasus", "O": ["an ARP cache poisoner developed by the Operation Cleaver team"]}}], "73": [{"is received": {"A": "is received", "O": ["a command", "from the server"]}}, {"are stored": {"A": "are stored", "O": ["in a central location on disk that the PVZ tools utilize", "the results"]}}], "74": [{"allowing": {"A": "allowing", "S": "Fully compromised VPN credentials", "O": ["under compromised credentials", "permanent persistence"]}, "meant": {"A": "meant", "S": "Fully compromised VPN credentials", "O": ["their entire remote access infrastructure and supply chain was under the control of the Cleaver team"]}}], "75": [{"targeted": {"A": "targeted", "S": "The attackers", "O": ["research efforts, student information, student housing, and financial aid systems"]}}], "76": [{"detect": {"A": "detect", "S": "A method", "O": ["what security related software is installed"]}}], "77": [{"underwent": {"A": "underwent", "S": "The email data exfiltration method", "O": ["modification", "to be activated at a scheduled interval"]}}], "78": [{"uses": {"A": "uses", "S": "the command and control protocol", "O": ["HTTP"]}}], "79": [{"target and potentially sabotage": {"A": "target and potentially sabotage", "S": "them, or affiliated organizations", "O": ["ICS and SCADA environments", "with ease"]}}], "80": [{"is downloaded": {"A": "is downloaded", "O": ["inside of the SOAP response", "Base64-encoded", "The file"]}}], "81": [{"includes": {"A": "includes", "S": "The PVZ tool chain", "O": ["HTTP command and control communications with an ASPX server-side component"]}}], "82": [{"is minimized down": {"A": "is minimized down", "O": ["to a command and control communications", "The tool chain"]}}], "83": [{"use": {"A": "use", "S": "the attackers", "O": ["infrastructure that was not theirs", "to exfiltrate information"]}}], "84": [{"installs": {"A": "installs", "S": "WndTest", "O": ["as a service"]}, "impersonate": {"A": "impersonate", "S": "WndTest", "O": ["Adobe Report Service"]}}], "85": [{"were sent": {"A": "were sent", "O": ["using an open SMTP relay at BeyondSys.com", "Messages", "with the sender email address dyanachear(at)beyondsys.com"]}}], "86": [{"use": {"A": "use", "S": "Recent versions", "O": ["the resume- based methods reported in the Initial Compromise sections"]}}], "87": [{"be considered": {"A": "be considered", "O": ["SOAP traffic", "benign traffic"]}}], "88": [{"display": {"A": "display", "S": "it", "O": ["to input proxy information", "a window"]}}], "89": [{"parses": {"A": "parses", "S": "zhMimikatz", "O": ["for any cached credentials", "the results"]}, "executes": {"A": "executes", "S": "zhMimikatz", "O": ["the correct version of Mimikatz for the current system"]}}], "90": [{"create": {"A": "create", "S": "it", "O": ["with a modified configuration stored as a PE resource", "a copy of itself"]}, "send": {"A": "send", "S": "it"}, "execute": {"A": "execute", "S": "it"}}], "91": [{"launching": {"A": "launching", "O": ["from the compromised computer", "attacks"]}}, {"abusing": {"A": "abusing", "O": ["once it has been gained", "access"]}}], "92": [{"connect": {"A": "connect", "S": "them", "O": ["inside the networks of their victims", "to RDP servers"]}}], "93": [{"were commonly used": {"A": "were commonly used", "O": ["during the initial stages of an attack", "a small set of IP addresses"]}}], "94": [{"replaced": {"A": "replaced", "S": "The backdoor", "O": ["with an appropriately named image file", "the original malicious executable"]}, "padded": {"A": "padded", "S": "The backdoor", "O": ["in order to mirror the original file size", "with null bytes", "the image file"]}}], "95": [{"create": {"A": "create", "S": "Its main purpose", "O": ["a channel that is capable of transporting information over the network"]}}], "96": [{"points": {"A": "points", "S": "This FTP upload functionality", "O": ["to the command and control server"]}}, {"is invoked": {"A": "is invoked", "O": ["by a command in the SOAP command and control channel", "This FTP upload functionality"]}}], "97": [{"is": {"A": "is", "S": "The primary positive attribute of Jasus", "O": ["its poor detection ratio by the antivirus industry"]}}], "98": [{"be deleted": {"A": "be deleted", "O": ["from the infected system", "the file"]}}], "99": [{"has": {"A": "has", "S": "Csext", "O": ["email functionality similar to TinyZBot"]}}], "100": [{"were registered": {"A": "were registered", "O": ["in order to make the download sites seem more realistic", "Multiple domains"]}}], "101": [{"utilizes": {"A": "utilizes", "S": "The command and control mechanism for TinyZBot", "O": ["SOAP communicating over HTTP"]}}], "102": [{"were fully compromised": {"A": "were fully compromised", "O": ["along with entire Cisco Edge switches, routers, and internal networking infrastructure", "Active Directory domains"]}}], "103": [{"evaded": {"A": "evaded", "S": "it", "O": ["detection by existing security technologies"]}}], "104": [{"scan": {"A": "scan", "S": "it", "O": ["on the local subnet", "to determine which IP addresses have SMB related ports open", "a set of configured IP addresses"]}}], "105": [{"hosted": {"A": "hosted", "S": "The following IP addresses", "O": ["FTP servers"]}, "were used": {"A": "were used", "O": ["in the infection of targets", "FTP servers"]}}], "106": [{"enable": {"A": "enable", "S": "This feature", "O": ["a reverse connecting shell"]}}, {"remotely control": {"A": "remotely control", "S": "a reverse connecting shell", "O": ["a target"]}}], "107": [{"stealing": {"A": "stealing", "S": "Operation Cleaver", "O": ["confidential/privileged information"]}}], "108": [{"does": {"A": "does", "S": "the r\u00e9sum\u00e9 submitter", "O": ["in order to make it seem like it is submitting something", "a GET request", "to microsoft.com", "When the victim hits submit"]}}], "109": [{"is": {"A": "is", "S": "Persistence", "O": ["the means of maintaining access to a compromised network"]}}], "110": [{"execute": {"A": "execute", "S": "they", "O": ["any shell code returned by the remote server"]}, "call out": {"A": "call out", "S": "they", "O": ["to a remote server"]}}], "111": [{"use": {"A": "use", "S": "the victim", "O": ["the fake r\u00e9sum\u00e9 submission application supplied by the malicious recruiter", "In order to take advantage of this job opportunity"]}}], "112": [{"is": {"A": "is", "S": "TinyZBot", "O": ["a backdoor developed in C#"]}}], "113": [{"were compromised": {"A": "were compromised", "O": ["at major airline operators, airports, and transportation companies", "Assets (both cyber and physical) and logistics information"]}}], "114": [{"is used": {"A": "is used", "O": ["as the command and control protocol for TinyZBot", "it"]}}], "115": [{"executes": {"A": "executes", "S": "a publicly available project", "O": ["an executable", "as a service"]}}], "116": [{"is": {"A": "is", "S": "SYN Flooder", "O": ["a simple network based denial of service tool"]}}], "117": [{"upload": {"A": "upload", "S": "them", "O": ["information"]}, "use": {"A": "use", "S": "them", "O": ["existing command line utilities available on their targets"]}}], "118": [{"is launched": {"A": "is launched", "O": ["the main application"]}}], "119": [{"be sent": {"A": "be sent", "O": ["with the keystroke logging data as attachments, as well as system information", "The message"]}}], "120": [{"served": {"A": "served", "S": "The IP address 78.109.194.114", "O": ["as a source for one of the primary attackers"]}}], "121": [{"including": {"A": "including", "S": "Cleaver\u2019s level of access into each organization", "O": ["compromised data repositories"]}}], "122": [{"be installed": {"A": "be installed", "O": ["via xp_cmdshell, or any other method which would grant the attacker write access", "The web shell"]}}], "123": [{"combined": {"A": "combined", "S": "they", "O": ["with malware", "by using a binder they developed internally named Binder_1", "the original Easy Resume Creator Pro product"]}}], "124": [{"is": {"A": "is", "S": "PVZ-Out", "O": ["the other half of the command and control channel"]}, "uploading": {"A": "uploading", "S": "PVZ-Out", "O": ["results of commands and keystroke logging data", "to a remote server"]}}], "125": [{"allows": {"A": "allows", "S": "Its main functionality", "O": ["for a client and server communication channel"]}, "allowing": {"A": "allowing", "S": "Its main functionality", "O": ["for information to be transported over the network simply"]}}], "126": [{"includes": {"A": "includes", "S": "This group", "O": ["the results of the Shell Creator mentioned in the Attribution section, as well as ASPX backdoors used by Nesha"]}}], "127": [{"impacted": {"A": "impacted", "S": "These attacks", "O": ["the availability of online banking services"]}}], "128": [{"stores": {"A": "stores", "S": "This form", "O": ["the submitted information", "while the application is running"]}}], "129": [{"allows": {"A": "allows", "S": "The exploit"}}], "130": [{"allows": {"A": "allows", "S": "This increase in privileges", "O": ["the attacker"]}}, {"infect": {"A": "infect", "S": "the attacker", "O": ["other computers on the target network"]}, "gain": {"A": "gain", "S": "the attacker", "O": ["access to privleged areas of the operating system"]}}], "131": [{"know": {"A": "know", "S": "they", "O": ["which target was infected"]}, "run": {"A": "run", "S": "they", "O": ["using the same command and control server", "multiple campaigns"]}}, {"differentiate": {"A": "differentiate", "S": "The AppUsageId (at this point named AppType)", "O": ["between targets infected with TinyZBot"]}}], "132": [{"using": {"A": "using", "S": "the Operation Cleaver team", "O": ["for extracting credentials from caches and the network", "Cain & Abel"]}}], "133": [{"communicate": {"A": "communicate", "S": "wndTest", "O": ["with the following servers"]}}, {"is": {"A": "is", "S": "Csext", "O": ["a backdoor application developed in C#"]}, "runs": {"A": "runs", "S": "Csext", "O": ["as a service"]}}], "134": [{"are cached": {"A": "are cached", "O": ["the results", "in a location the dropped malware can access"]}}], "135": [{"relied": {"A": "relied", "S": "Its method of exfiltrating the logged keystrokes", "O": ["upon a hardcoded email address stored in the binary"]}}], "136": [{"allowed": {"A": "allowed", "S": "The version compiled on June 23, 2014", "O": ["screenshots of the desktop", "to be taken"]}}], "137": [{"is": {"A": "is", "S": "Exfiltration", "O": ["the process of moving information to an external site"]}}], "138": [{"brute forcing": {"A": "brute forcing", "S": "an iterative methodology", "O": ["each SMB enabled target", "with each credential that was extracted from the cache"]}}], "139": [{"are added": {"A": "are added", "O": ["to the email", "The files being exfiltrated", "as attachments"]}}], "140": [{"was obfuscated": {"A": "was obfuscated", "O": ["with SmartAssembly", "The initial version"]}}], "141": [{"conducting": {"A": "conducting", "S": "They", "O": ["SQL injection attacks"]}}], "142": [{"included": {"A": "included", "S": "Compromised network infrastructure", "O": ["Cisco VPNs as well as Cisco switches and routers"]}}], "143": [{"be sent": {"A": "be sent", "O": ["to all bots for a campaign", "commands"]}}], "144": [{"masqueraded": {"A": "masqueraded", "S": "backdoors", "O": ["as varying versions of Notepad"]}}, {"utilized": {"A": "utilized", "S": "This organization", "O": ["backdoors"]}}], "145": [{"is located": {"A": "is located", "O": ["at http://www.gesunddurchsjahr(dot)de/tor/default.aspx", "The known command and control server for PVZ-Out"]}}], "146": [{"been double encoded": {"A": "been double encoded", "O": ["SQL injection payloads"]}, "used": {"A": "used", "S": "this organization", "O": ["SQL injection payloads"]}}], "147": [{"was": {"A": "was", "S": "The IP address 159.253.144.209", "O": ["a source for a secondary attacker in various compromises"]}}], "148": [{"is then uploaded": {"A": "is then uploaded", "O": ["over SOAP", "this file", "to the command and control server"]}}], "149": [{"determine": {"A": "determine", "S": "they", "O": ["which version of Mimikatz to use", "based on whether the computer\u2019s version of Windows is 32-bit or 64-bit"]}}], "150": [{"installs": {"A": "installs", "S": "downloading and executing software", "O": ["malware", "alongside of the desired program"]}}, {"connect": {"A": "connect", "O": ["outbound", "via anonymous FTP"]}}, {"social engineer": {"A": "social engineer", "S": "attackers", "O": ["users", "into downloading and executing software", "Using messaging methods such as email"]}}], "151": [{"allowed": {"A": "allowed", "S": "a new version", "O": ["for self-deletion"]}}], "152": [{"being invoked": {"A": "being invoked", "S": "PVZ-In", "O": ["a command line utility"]}}], "153": [{"conducted": {"A": "conducted", "S": "Operation Cleaver", "O": ["a significant global surveillance and infiltration campaign"]}}], "154": [{"communicate": {"A": "communicate", "S": "PVZ-In", "O": ["with a command and control server"]}}], "155": [{"were used": {"A": "were used", "S": "this organization", "O": ["Multiple backdoors"]}}], "156": [{"is located": {"A": "is located", "O": ["The known command and control server", "at http://kundenpflege. menrad(dot)de/js/jquery/default.aspx"]}}], "157": [{"used": {"A": "used", "S": "Cleaver", "O": ["the following are techniques and tools for persistence"]}}], "158": [{"generates": {"A": "generates", "S": "The creator", "O": ["an ASPX web shell", "using user input as well as a collection of templates"]}}], "159": [{"was located": {"A": "was located", "O": ["on ive servers", "An ASPX backdoor named Zh0uSh311"]}, "recovered": {"A": "recovered", "O": ["fro a staging server", "An ASPX backdoor named Zh0uSh311"]}}], "160": [{"records": {"A": "records", "S": "Logger Module", "O": ["them", "to a file"]}, "observes": {"A": "observes", "S": "Logger Module", "O": ["the user\u2019s actions"]}}], "161": [{"include": {"A": "include", "S": "The recorded actions", "O": ["mouse clicks"]}}], "162": [{"exfiltrate": {"A": "exfiltrate", "S": "This email functionality", "O": ["the results of commands from the command file which can also include requests like gathering user information"]}}], "163": [{"mentioned": {"A": "mentioned", "S": "The operators of the blog IranRedLine.org, which comments on Iran\u2019s nuclear weapons efforts", "O": ["having been the target of debilitating brute-force authentication attacks from IP addresses registered to the same Tarh Andishan team found in Cleaver", "in multiple posts"]}}], "164": [{"use": {"A": "use", "S": "the attackers", "O": ["zhCat", "to also XOR encrypt the traffic with a shared key"]}}], "165": [{"queries": {"A": "queries", "S": "The TinyZBot", "O": ["the server", "in order to enumerate all files currently available to it"]}}], "166": [{"was reused": {"A": "was reused", "O": ["SmartAssembly"]}}], "167": [{"make": {"A": "make", "O": ["the binder", "indistinguishable from the desired application"]}}], "168": [{"include": {"A": "include", "S": "Initial compromise techniques", "O": ["SQL injection, web attacks, and creative deception- based attacks"]}}], "169": [{"exposing": {"A": "exposing", "S": "Stuxnet", "O": ["to the world of physical destruction via electronic means", "them"]}}], "170": [{"has": {"A": "has", "S": "zhCat", "O": ["a variety of other features such as port mirroring as well as traffic redirecting"]}}], "171": [{"leveraged": {"A": "leveraged", "S": "a highly targeted waterhole attack", "O": ["social media"]}}], "172": [{"are stored": {"A": "are stored", "O": ["Commands, updates and files to drop and execute", "as files on the SOAP server"]}}], "173": [{"were harvested": {"A": "were harvested", "O": ["from major educational institutions around the world", "Confidential critical infrastructure documents"]}}], "174": [{"be supplied": {"A": "be supplied", "O": ["to different targets", "separate commands"]}}], "175": [{"include": {"A": "include", "S": "These versions", "O": ["a new method of installing as a service"]}}], "176": [{"is": {"A": "is", "S": "Pivoting", "O": ["the process of leveraging access from one compromised computer in order to gain access to additional systems on the target network"]}}], "177": [{"communicates": {"A": "communicates", "S": "the shell client", "O": ["in order to get the external IP address of the current user"]}}], "178": [{"was specifically targeted and disabled": {"A": "was specifically targeted and disabled", "O": ["Avira antivirus"]}}, {"added": {"A": "added", "O": ["in this version", "the new keystroke logger module"]}}], "179": [{"brute-forces": {"A": "brute-forces", "S": "the nbrute utility", "O": ["network credentials"]}}], "180": [{"include": {"A": "include", "S": "Compromised systems", "O": ["Microsoft Windows web servers running IIS and ColdFusion, Apache with PHP, many variants of Microsoft Windows desktops and servers, and Linux servers"]}}], "181": [{"checks": {"A": "checks", "S": "the r\u00e9sum\u00e9 submission application", "O": ["the Internet connection"]}}], "182": [{"make": {"A": "make", "O": ["more difficult to detect the exfiltration of sensitive information", "it"]}}, {"is often compressed": {"A": "is often compressed", "O": ["Data uploaded"]}}], "183": [{"is": {"A": "is", "S": "SQL injection", "O": ["a very common and simple attack method"]}}], "184": [{"see": {"A": "see", "S": "we", "O": ["the following HTTP POST request"]}}], "185": [{"is": {"A": "is", "S": "SOAP", "O": ["a sub-protocol communicated via HTTP"]}}], "186": [{"include": {"A": "include", "S": "Famous examples of these efforts", "O": ["espionage", "with Duqu (2009 - 2011) as well as Flame (2012)"]}}], "187": [{"blending in": {"A": "blending in", "S": "SOAP", "O": ["with other benign HTTP traffic"]}}], "188": [{"abused": {"A": "abused", "S": "Early Cleaver operations", "O": ["in order to exfiltrate information", "SMTP"]}}], "189": [{"connect": {"A": "connect", "S": "the malware", "O": ["to the command and control server"]}}], "190": [{"execute": {"A": "execute", "S": "NetCat", "O": ["a command", "after the connection is established"]}}], "191": [{"is infected": {"A": "is infected", "O": ["their machine", "While the user enters this information", "with TinyZBot"]}}], "192": [{"was added": {"A": "was added", "O": ["with hardcoded credentials of ano:1", "FTP upload support"]}}], "193": [{"used": {"A": "used", "O": ["the key", "for XOR encryption"]}}], "194": [{"masquerades": {"A": "masquerades", "S": "The resulting executable", "O": ["as the desired software"]}}], "195": [{"install": {"A": "install", "S": "These versions", "O": ["as a service"]}}], "196": [{"avoid": {"A": "avoid", "S": "This", "O": ["detonation-based detection engines"]}}], "197": [{"was seen": {"A": "was seen", "O": ["in breaches involving SQL injection as well as other techniques", "Nesha"]}}], "198": [{"is": {"A": "is", "S": "it", "O": ["the process of stealing information without being detected"]}}], "199": [{"requests": {"A": "requests", "S": "The first r\u00e9sum\u00e9 submission form", "O": ["contact information"]}}], "200": [{"impersonated": {"A": "impersonated", "S": "This dropper", "O": ["a tool to submit a r\u00e9sum\u00e9 to Teledyne"]}}], "201": [{"being exfiltrated": {"A": "being exfiltrated", "O": ["privileged information"]}}], "202": [{"extract": {"A": "extract", "O": ["domain credentials which have been used on the compromised computer from a credential cache"]}}], "203": [{"were automatically performed": {"A": "were automatically performed", "O": ["unassisted periodic update checks"]}}], "204": [{"given": {"A": "given", "O": ["a few well-known tools", "sufficient privileges on the infected host"]}}], "205": [{"was also observed": {"A": "was also observed", "O": ["A PHP shell"]}}], "206": [{"done": {"A": "done", "S": "a running TinyZBot instance", "O": ["the first query"]}}], "207": [{"was added": {"A": "was added", "O": ["The ability to extract Internet Explorer passwords"]}}], "208": [{"retrieving": {"A": "retrieving", "S": "the malware", "O": ["their stored passwords"]}, "logging": {"A": "logging", "S": "the malware", "O": ["their keystrokes"]}}], "209": [{"was located": {"A": "was located", "O": ["The command and control server for this version", "at 173.192.144.68/ DefaultWS(dot)asmx"]}}], "210": [{"is": {"A": "is", "S": "MS08-067", "O": ["a vulnerability in Microsoft Windows made popular by the Conficker worm which can be exploited by a specially crafted packet to the operating system\u2019s RPC network interface"]}}], "211": [{"be executed": {"A": "be executed", "O": ["cmd.exe"]}}], "212": [{"utilized": {"A": "utilized", "S": "Nesha", "O": ["web-based backdoors developed in ASPX, PHP as well as ColdFusion"]}}]}, "darkhotelappendixindicators_kl.tokens": {"0": [{"makes sure": {"A": "makes sure", "S": "the module", "O": ["only one instance of current code is running", "by checking if system mutex object named \u00ab920111215\u00bb exists"]}}], "1": [{"starts": {"A": "starts", "S": "WinRar SFX file", "O": ["from %APPDATA%\\Microsoft\\Display\\DmaUp3. exe"]}, "drops": {"A": "drops", "S": "WinRar SFX file"}}], "2": [{"send": {"A": "send", "S": "the module", "O": ["using a different HTTP path", "again", "identical request"]}}, {"issues": {"A": "issues", "S": "the module", "O": ["another HTTP request"]}}], "3": [{"steal": {"A": "steal", "S": "the attackers", "O": ["logins and pass- words"]}}], "4": [{"are": {"A": "are", "S": "Host package files detected as \u201cVirus.Win32.Pioneer.dx\u201d", "O": ["infected legitimate files"]}}], "5": [{"maintains, drops and installs": {"A": "maintains, drops and installs", "S": "The dropper above", "O": ["this kernel mode keylogger"]}}], "6": [{"hooks": {"A": "hooks", "S": "the NDISKPRO.SYS driver", "O": ["both INT 0x01 and INT 0xff"]}, "retrieves": {"A": "retrieves", "S": "the NDISKPRO.SYS driver", "O": ["directly from port 0x60, the motherboard keyboard con- troller itself", "keystroke data"]}}, {"loaded": {"A": "loaded", "O": ["the NDISKPRO.SYS driver"]}}], "7": [{"detect": {"A": "detect", "S": "Another method", "O": ["VM en- vironment"]}}, {"check": {"A": "check", "O": ["local network adapter\u2019s IP address"]}}], "8": [{"delete": {"A": "delete", "S": "the module", "O": ["some other, prob- ably older, components which might be present on the system"]}}], "9": [{"overwrites": {"A": "overwrites", "S": "The running process", "O": ["the igfxext.exe image", "with this smaller chunk of code", "in the suspended process"]}}], "10": [{"checks": {"A": "checks", "S": "it", "O": ["if cur- rent process is running in WOW64 environment"]}}], "11": [{"iterates": {"A": "iterates", "S": "The trojan", "O": ["through running processes"]}, "looks": {"A": "looks", "S": "The trojan", "O": ["for security software basing on executable filenames from the list below"]}}], "12": [{"drops": {"A": "drops", "S": "the downloaded file", "O": ["SMAGENT.EXE (md5 0306f9ae- 7786570139f78e78bc940597)", "to %APPDATA%\\MICROSOFT\\DISPLAY"]}, "ex- ecutes": {"A": "ex- ecutes", "S": "the downloaded file", "O": ["it"]}}], "13": [{"ensure": {"A": "ensure", "S": "the module", "O": ["only single instance of the module is running"]}}], "14": [{"submits": {"A": "submits", "S": "the malware", "O": ["collected information", "using HTTP GET request and the following URL format: http://<C2DOMAIN>/bin/read_i.php ?a1=%STEPID%&a2=%HOSTID%&a3=%SYSINFO%&a4=% AVSOFTID%, where %C2DOMAIN% is one of the following C&C domains", "to the C&C server"]}}], "15": [{"been infected": {"A": "been infected", "S": "another Darkhotel component", "O": ["These files"]}}], "16": [{"checks": {"A": "checks", "S": "this module", "O": ["if \u00abbdagent.exe\u00bb process is running on current system"]}}], "17": [{"drops": {"A": "drops", "S": "It", "O": ["a keylogger"]}}], "18": [{"maintains": {"A": "maintains", "S": "the original dropper", "O": ["with a simple addition to the HKCU run key", "persistence", "across reboots"]}}], "19": [{"is logging": {"A": "is logging", "S": "It", "O": ["all actions", "to inform the operator what exactly was executed by this variant of the malware"]}}], "20": [{"collects": {"A": "collects", "S": "the mod- ule", "O": ["information about current system which includes the following"]}}], "21": [{"download": {"A": "download", "S": "Igfxext.exe", "O": ["a file"]}, "drop": {"A": "drop", "S": "Igfxext.exe", "O": ["it", "to %APPDATA%\\microsoft\\dis- play\\ctfmon.exe (md5= e8bfb82b0dd5cef46116d61f62c25060)"]}}], "22": [{"run": {"A": "run", "O": ["The igfxext.exe component"]}, "is dropped": {"A": "is dropped", "O": ["The igfxext.exe component", "to disk"]}}], "23": [{"infiltrate": {"A": "infiltrate", "S": "This component", "O": ["via network shares"]}}], "24": [{"saved": {"A": "saved", "O": ["it", "in a file named \u00abctfmon.exe\u00bb", "to a disk"]}, "is XORed": {"A": "is XORed", "O": ["it", "with byte value 0x55"]}}], "25": [{"is uploaded": {"A": "is uploaded", "O": ["as a POST request binary", "The data", "in the following format"]}}], "26": [{"is terminated": {"A": "is terminated", "O": ["keystroke generation thread"]}}], "27": [{"gets": {"A": "gets", "S": "It", "O": ["from the registry at HKLM\\HARDWARE\\DESCRIPTION\\ System\\CentralProcessor\\0", "CPU name and identifier"]}, "collects": {"A": "collects", "S": "It", "O": ["IP and MAC addresses of local network adapters"]}}], "28": [{"executes": {"A": "executes", "S": "the malware", "O": ["some kind of embedded script"]}, "stealing": {"A": "stealing", "S": "the malware", "O": ["secrets", "from local system"]}}], "29": [{"uploads": {"A": "uploads", "S": "The module", "O": ["all collected information", "to one of the following URLs", "via POST request"]}}], "30": [{"stores": {"A": "stores", "S": "This keylogger module"}, "encrypts": {"A": "encrypts", "S": "This keylogger module"}}], "31": [{"issues": {"A": "issues", "S": "The module", "O": ["with hardcoded User\u00adAgent string", "a HTTP GET request"]}, "connects": {"A": "connects", "S": "The module", "O": ["to autolace.twilightparadox.com (or automachine. servequake.com)"]}}, {"is used": {"A": "is used", "O": ["to rec- ognize valid response", "\u00abDEXT87\u00bb string"]}}], "32": [{"is started": {"A": "is started", "S": "code running within svchost.exe on WinXP SP3", "O": ["This sample"]}}], "33": [{"evade": {"A": "evade", "S": "The malware", "O": ["running on a VMware"]}}], "34": [{"uses": {"A": "uses", "S": "The module", "O": ["several simple XOR\u00adbased algorithms", "to encrypt embedded string data"]}}], "35": [{"stealing": {"A": "stealing", "S": "it", "O": ["from Firefox and Chrome", "secrets"]}}], "36": [{"is installed": {"A": "is installed", "O": ["It", "as a system kernel driver \u201cNdiskpro\u201d service"]}}], "37": [{"uses": {"A": "uses", "S": "it", "O": ["simple AV heuristics evasion technique"]}}], "38": [{"uploaded": {"A": "uploaded", "O": ["to the C&C server", "The result of this execution"]}}], "39": [{"sending": {"A": "sending", "S": "it", "O": ["additional in- formation"]}}], "40": [{"encrypts": {"A": "encrypts", "S": "This component"}, "writes": {"A": "writes", "S": "This component", "O": ["to a ran- domly named .tmp, file like ffffz07131101.tmp"]}}], "41": [{"spawns": {"A": "spawns", "S": "It", "O": ["an- other suspended process", "with its own igfxext.exe image"]}}], "42": [{"terminates": {"A": "terminates", "S": "the process", "O": ["If VM is detected"]}}], "43": [{"check": {"A": "check", "O": ["if current directory has a file named \u00abU\u00bb"]}}], "44": [{"is stolen": {"A": "is stolen", "O": ["IntelliForms information"]}}], "45": [{"drop": {"A": "drop", "S": "All of these infected files", "O": ["a 63kb self injecting compo- nent"]}}], "46": [{"collect": {"A": "collect", "S": "the module", "O": ["various secrets stored on a local system"]}}], "47": [{"makes": {"A": "makes", "S": "a special variable", "O": ["dormant", "module"]}}], "48": [{"implements": {"A": "implements", "S": "The module", "O": ["to resist running in virtual environment", "a method"]}}], "49": [{"starts": {"A": "starts", "S": "The code", "O": ["a thread that simulates keystrokes of ESC keyboard key and then shows a system modal message box"]}}], "50": [{"wipes": {"A": "wipes", "S": "the module", "O": ["the file"]}}]}, "darkhotel_kl_07.11.tokens": {"0": [{"has": {"A": "has", "S": "Every infected file", "O": ["functionality described in Trojan\u00adDropper & Injector section"]}}, {"download": {"A": "download", "S": "it", "O": ["other Darkhotel components"]}, "send": {"A": "send", "S": "it", "O": ["it", "to the C2"]}, "collect": {"A": "collect", "S": "it", "O": ["information about the comput- er"]}}], "1": [{"adds": {"A": "adds", "S": "The module", "O": ["autorun registry settings", "to enable an automatic start during system boot"]}}], "2": [{"use": {"A": "use", "S": "an attacker", "O": ["to perform man\u00adin\u00adthe\u00admiddle attacks against all Web browser users including users of Internet Explorer"]}}], "3": [{"spear-phish": {"A": "spear-phish", "S": "they", "O": ["targets"]}}], "4": [{"is built": {"A": "is built", "O": ["to resemble a legitimate low-level Microsoft system device", "This driver package"]}}, {"is dropped": {"A": "is dropped", "O": ["This keylogger", "by code running within svchost.exe on WinXP SP3"]}}], "5": [{"maintain": {"A": "maintain", "S": "The attackers", "O": ["to vet these new victim systems", "a\u00a0web interface"]}}], "6": [{"drops": {"A": "drops", "S": "It", "O": ["the igfxext.exe \u201cselective infector\u201d component", "to disk"]}, "runs": {"A": "runs", "S": "It", "O": ["it"]}}], "7": [{"delete": {"A": "delete", "S": "The attackers", "O": ["all traces of their tools", "as soon as an attack was carried out successfully"]}}], "8": [{"seeds": {"A": "seeds", "S": "it", "O": ["Japanese p2p sharing sites"]}}, {"is delivered": {"A": "is delivered", "O": ["as a part of a large (approximately 900mb) rar archive", "the malware"]}}], "9": [{"include": {"A": "include", "S": "Related Darkhotel command and control server domains"}}, {"involving": {"A": "involving", "S": "Darkhotel campaigns", "O": ["typical spear-phished Tapaoux implants"]}}], "10": [{"deployed": {"A": "deployed", "S": "they", "O": ["0-day spear-phishing attacks"]}}, {"targeting": {"A": "targeting", "S": "0-day spear-phishing attacks", "O": ["Adobe products and Microsoft Internet Explorer, including cve\u00ad2010\u00ad0188"]}}], "11": [{"was": {"A": "was", "S": "One of the most interesting components that we discovered as a part of this cam- paign", "O": ["the use of a digitally\u00adsigned advanced keylogger"]}}], "12": [{"retrieves": {"A": "retrieves", "S": "the NDISKPRO.SYS driver", "O": ["keystroke data", "directly from port 0x60, the motherboard keyboard con- troller itself"]}, "hooks": {"A": "hooks", "S": "the NDISKPRO.SYS driver", "O": ["both INT 0x01 and INT 0xff"]}}], "13": [{"executed": {"A": "executed", "S": "word docs"}, "dropped": {"A": "dropped", "S": "word docs", "O": ["these backdoors"]}, "downloaded": {"A": "downloaded", "S": "word docs", "O": ["from remote web servers"]}}, {"embed- ded": {"A": "embed- ded", "O": ["word docs", "with 0-day flash swf files"]}}], "14": [{"was hosted": {"A": "was hosted", "O": ["The associated Darkhotel backdoor", "on bittorrent, emule, etc,", "under a variety of comic names"]}}], "15": [{"starts": {"A": "starts", "S": "WinRar SFX file", "O": ["from %APPDATA%\\Microsoft\\Crypto\\DES64v7\\msieckc.exe"]}, "drops": {"A": "drops", "S": "WinRar SFX file"}}], "16": [{"terminate": {"A": "terminate", "S": "This module", "O": ["itself", "on Windows with the system de- fault codepage set to Korean"]}}, {"collect": {"A": "collect", "S": "the module", "O": ["various secrets stored on a lo- cal system"]}, "upload": {"A": "upload", "S": "the module", "O": ["them", "to Darkhotel command and control servers"]}}], "17": [{"mim- ics": {"A": "mim- ics", "S": "It", "O": ["a GUI desktop application"]}}], "18": [{"is installed and run": {"A": "is installed and run", "O": ["the trojan", "on the victim system"]}}], "19": [{"de- leted": {"A": "de- leted", "S": "The attackers", "O": ["from earlier attacks in another hotel", "traces of their work"]}}], "20": [{"continues": {"A": "continues", "S": "This spear-phishing activity", "O": ["into 2014"]}}], "21": [{"maintain": {"A": "maintain", "S": "the attackers", "O": ["over the victim\u2019s visit", "truly precise targeting information"]}}], "22": [{"encrypts": {"A": "encrypts", "S": "The group", "O": ["with single user/passkey combi- nations across multiple victims", "on their servers", "victim data"]}}], "23": [{"bound": {"A": "bound", "O": ["this Darkhotel backdoor", "within a shared torrent"]}}, {"detected": {"A": "detected", "O": ["Catch.exe", "as Backdoor.Win32.Agent.dgrn"]}}, {"communicates": {"A": "communicates", "S": "Catch.exe", "O": ["with the fol- lowing Darkhotel command and control servers"]}}], "24": [{"complicated": {"A": "complicated", "S": "a lot of extra calls", "O": ["the analysis of the sample"]}}], "25": [{"is bound": {"A": "is bound", "O": ["to the dropper for the Darkhotel Catch.exe Karba Trojan", "the AxDecrypt.exe decryptor"]}}], "26": [{"maintains": {"A": "maintains", "S": "the original dropper", "O": ["persistence", "across reboots", "with a simple addition to the HKCU run key"]}}], "27": [{"upgrading": {"A": "upgrading", "S": "botnet style operations", "O": ["to more sophisticated espionage tools", "victims"]}, "launching": {"A": "launching", "S": "botnet style operations", "O": ["on hostile parties", "DDoS attacks"]}}, {"are used": {"A": "are used", "O": ["for massive surveillance", "botnet style operations"]}}, {"compromise": {"A": "compromise", "S": "targeted attacks", "O": ["high profile victims"]}}], "28": [{"deleted": {"A": "deleted", "S": "he attackers", "O": ["from the hotel network", "their iframe placement and backdoored executables"]}}], "29": [{"uploads": {"A": "uploads", "S": "The Trojan", "O": ["that data", "to Darkhotel command and control servers"]}, "collects": {"A": "collects", "S": "The Trojan", "O": ["about anti\u00ad malware software installed on it"]}}], "30": [{"build up": {"A": "build up", "S": "the operators", "O": ["new command and control serv- ers"]}}], "31": [{"retrieved": {"A": "retrieved", "S": "exploited systems", "O": ["from web servers", "downloader executables"]}}, {"redirect": {"A": "redirect", "S": "links", "O": ["to Internet Explorer 0-day exploits", "targets\u2019 brows- ers"]}}, {"emailed": {"A": "emailed", "S": "the group", "O": ["links"]}}, {"follow": {"A": "follow", "S": "The attacks", "O": ["the typical spear-phishing process"]}}], "32": [{"bound": {"A": "bound", "O": ["hotel installers", "within torrent bundles"]}, "dropped": {"A": "dropped", "S": "exploits", "O": ["hotel installers"]}, "hypertext linked": {"A": "hypertext linked", "O": ["hotel installers", "from spear-phishing emails"]}}, {"are dropped": {"A": "are dropped", "S": "hotel installers", "O": ["These tools"]}, "spoofing": {"A": "spoofing", "S": "hotel installers", "O": ["legiti- mate software installers"]}}], "33": [{"posing": {"A": "posing", "S": "a rare APT Trojan", "O": ["as any one of several major software releases"]}}, {"are infected": {"A": "are infected", "O": ["they", "with a rare APT Trojan"]}}], "34": [{"changes": {"A": "changes", "S": "the infector", "O": ["the entrypoint of executable files"]}, "puts": {"A": "puts", "S": "the infector", "O": ["its main payload", "in the overlay"]}, "creates": {"A": "creates", "S": "the infector", "O": ["an .rdat section"]}, "inserts": {"A": "inserts", "S": "the infector", "O": ["in the section", "a small loader"]}}], "35": [{"were installed": {"A": "were installed", "O": ["alongside the legitimate packages", "Digitally signed Darkhotel backdoors"]}}], "36": [{"infiltrate": {"A": "infiltrate", "S": "This component", "O": ["via USB"]}}], "37": [{"is also spread": {"A": "is also spread", "O": ["The archive", "over bittorrent"]}}], "38": [{"were embedded": {"A": "were embedded", "O": ["in Korean documents titled \u201cList of the latest Japanese AV wind and how to use torrents.docx\u201d (loose English translation)", "the Flash objects"]}}], "39": [{"drops": {"A": "drops", "S": "a WinRar SFX file"}, "starts": {"A": "starts", "S": "a WinRar SFX file", "O": ["from %APPDATA%\\Microsoft\\Display\\DmaUp3. exe"]}}], "40": [{"stores": {"A": "stores", "S": "This keylogger module", "O": ["in a log file"]}, "encrypts": {"A": "encrypts", "S": "This keylogger module"}}], "41": [{"were": {"A": "were", "S": "these packages", "O": ["really installers for Darkhotel APT\u2019s backdoors"]}}], "42": [{"present": {"A": "present", "S": "the attackers", "O": ["precisely to that individual target", "the malicious iframe"]}}], "43": [{"retrieves": {"A": "retrieves", "S": "the virus", "O": ["all available disks"]}, "finds": {"A": "finds", "S": "the virus", "O": ["executable files"]}, "infects": {"A": "infects", "S": "the virus", "O": ["them"]}}], "44": [{"maintains": {"A": "maintains", "S": "Almost every backdoor in this set", "O": ["an internal campaign code or id, used in initial c2 communications as described above"]}}], "45": [{"list and sort": {"A": "list and sort", "S": "The attackers", "O": ["victim systems", "according to their latest c2 check\u00adin"]}}], "46": [{"includes": {"A": "includes", "S": "the attachment itself", "O": ["an Adobe 0-day exploit"]}}], "47": [{"spear-phished": {"A": "spear-phished", "S": "The crew", "O": ["a set of target systems connected to the Internet through Chinese ISPs"]}}], "48": [{"was downloaded": {"A": "was downloaded", "O": ["This Darkhotel package", "over 30,000 times", "in less than six months"]}}], "49": [{"uses": {"A": "uses", "S": "Darkhotel", "O": ["this method", "to distribute their Karba Trojan"]}}], "50": [{"is bound": {"A": "is bound", "O": ["to a variety of other software packages that vary in name", "It"]}}], "51": [{"pull down": {"A": "pull down", "S": "These tools", "O": ["the keylog- ger"]}, "steal": {"A": "steal", "S": "These tools", "O": ["information", "from the system"]}, "download": {"A": "download", "S": "These tools", "O": ["other tools"]}}], "52": [{"removing": {"A": "removing", "S": "It", "O": ["some older components"]}}], "53": [{"be systematically vetted": {"A": "be systematically vetted", "O": ["New victim systems"]}}], "54": [{"gathers": {"A": "gathers", "S": "The component", "O": ["system information"]}, "sends": {"A": "sends", "S": "The component", "O": ["to the Darkhotel com- mand and control servers", "it"]}}], "55": [{"identify": {"A": "identify", "S": "the attackers", "O": ["more significant victims"]}}, {"download": {"A": "download", "O": ["more advanced stealing tools"]}}], "56": [{"maintain": {"A": "maintain", "S": "The Darkhotel c2", "O": ["these directory structures", "to store and serve ddrlog content"]}}], "57": [{"are later downloaded": {"A": "are later downloaded", "S": "one of these implants", "O": ["More advanced tools, like the keylogger decribed above", "to the victim system"]}}], "58": [{"is": {"A": "is", "S": "One of the most interesting functions of this executable", "O": ["its unusual delay and persistence"]}}], "59": [{"maintain": {"A": "maintain", "S": "Many of these c2s", "O": ["a common directory path that serves a ddrlog"]}}], "60": [{"hit": {"A": "hit", "S": "The attackers", "O": ["their individual targets", "with precision"]}}], "61": [{"writes": {"A": "writes", "S": "This component", "O": ["to a randomly named .tmp, file like ffffz07131101.tmp"]}, "encrypts": {"A": "encrypts", "S": "This component"}}], "62": [{"received": {"A": "received", "S": "only a few guests", "O": ["the Darkhotel package"]}}], "63": [{"were prompted": {"A": "were prompted", "O": ["to install software updates to popular software packages", "visitors connecting to the hotel\u2019s Wi-Fi"]}}], "64": [{"update": {"A": "update", "S": "This module", "O": ["malicious components", "through recurring checks at the C&C server"]}}], "65": [{"delivered": {"A": "delivered", "S": "The dropped downloader (d8137ded710d83e2339a97ee78494c34)", "O": ["malcode similar to the \u201cInformation Stealer\u201d component functionality summarized below, and detailed in Appendix D"]}}], "66": [{"backs up and restores": {"A": "backs up and restores", "S": "current module", "O": ["access to the system within 6 months"]}}], "67": [{"are selectively distributed": {"A": "are selectively distributed", "O": ["these installs", "to targeted individuals"]}}], "68": [{"redirected": {"A": "redirected", "S": "embedded iframes within hotel networks", "O": ["individuals\u2019 web browsers", "to phony install- ers"]}}], "69": [{"is installed": {"A": "is installed", "O": ["as a system kernel driver \u201cNdiskpro\u201d service", "It"]}}], "70": [{"seeding": {"A": "seeding", "O": ["p2p networks", "with widely spread malware and 0-day spear-phishing attacks"]}}], "71": [{"brute forces": {"A": "brute forces", "S": "The code", "O": ["the list of mapped removable drives"]}}]}, "Darwin_fav_APT_Group.tokens": {"0": [{"communicates": {"A": "communicates", "S": "backdoor", "O": ["to a hard-coded command and control (C2) server", "via HTTP"]}}], "1": [{"contained": {"A": "contained", "S": "This spear phish", "O": ["a malicious Word document that exploited CVE-2012-0158"]}}], "2": [{"were dropped": {"A": "were dropped", "O": ["Both backdoors", "from malicious documents built utilizing the \u201cTran Duy Linh\u201d exploit kit"]}}], "3": [{"sent": {"A": "sent", "S": "a different spear phish email", "O": ["to a technology company located in Taiwan", "from lilywang823@gmail.com"]}}], "4": [{"deliver": {"A": "deliver", "S": "APT12", "O": ["via phishing emails", "these exploit documents"]}}], "5": [{"dropped": {"A": "dropped", "S": "this malicious document", "O": ["a backdoor"]}}], "6": [{"decrease": {"A": "decrease", "S": "this change", "O": ["detection"]}}], "7": [{"dropped": {"A": "dropped", "S": "This malicious Word document", "O": ["a backdoor"]}}], "8": [{"communicates": {"A": "communicates", "S": "an HTTP-based backdoor", "O": ["with its C2 server"]}}], "9": [{"Attached": {"A": "Attached", "O": ["to this email", "another malicious document"]}}], "10": [{"utilize": {"A": "utilize", "S": "the threat group", "O": ["phishing"]}}], "11": [{"sent": {"A": "sent", "O": ["to a Taiwanese government ministry", "a spear phish email"]}}], "12": [{"dropped": {"A": "dropped", "S": "The exploit document", "O": ["the HIGHTIDE backdoor"]}}], "13": [{"targeting": {"A": "targeting", "S": "spear phishing emails", "O": ["a high-technology company in Japan"]}}], "14": [{"drops": {"A": "drops", "S": "The RIPTIDE exploit document", "O": ["its executable file"]}}, {"drops": {"A": "drops", "S": "the HIGHTIDE exploit document", "O": ["its executable file"]}}], "15": [{"drops": {"A": "drops", "S": "it", "O": ["HIGHTIDE"]}}]}, "Democracy_HongKong_Under_Attack.tokens": {"0": [{"serving up": {"A": "serving up", "S": "the People Power website", "O": ["malicious code"]}}], "1": [{"install": {"A": "install", "S": "Java exploits", "O": ["malware", "on the target system"]}}, {"conduct profiling": {"A": "conduct profiling", "S": "scripts", "O": ["of the system for various software, plugins, and other related information"]}}, {"load": {"A": "load", "S": "These pages", "O": ["scripts"]}}], "2": [{"was being leveraged": {"A": "was being leveraged", "O": ["the website", "to target users with Flash Exploits"]}}], "3": [{"upload": {"A": "upload", "S": "Attackers", "O": ["new webshells or add simple China Chopper style modifications"]}}], "4": [{"install": {"A": "install", "S": "the exploits", "O": ["either a 32-bit or 64-bit version of the malware"]}}], "5": [{"install": {"A": "install", "S": "malicious Java Applets", "O": ["malware"]}}], "6": [{"added": {"A": "added", "O": ["malicious JavaScript", "to legitimate code"]}}], "7": [{"placing": {"A": "placing", "O": ["on Pro-Democratic websites in Hong Kong", "malicious code"]}}], "8": [{"served up": {"A": "served up", "S": "malicious code", "O": ["from the website of the Alliance for True Democracy (ATD) in Hong Kong"]}}], "9": [{"placed": {"A": "placed", "O": ["a password protected backdoor webshell", "on it"]}}], "10": [{"connects": {"A": "connects", "S": "The PlugX sample", "O": ["to the blog"]}}], "11": [{"serving up": {"A": "serving up", "S": "the DPHK websites", "O": ["malicious code"]}}], "12": [{"been used": {"A": "been used", "O": ["the DPHK website"]}}], "13": [{"loads": {"A": "loads", "S": "a JavaScript file", "O": ["a malicious Java Applet"]}}], "14": [{"been compromised": {"A": "been compromised", "O": ["the website of the political coalition and pan-democratic organization People Power in Hong Kong (www.peoplepower.hk)"]}}]}, "Derusbi_Server_Analysis-Final.tokens": {"0": [{"routes": {"A": "routes", "S": "CommLoop", "O": ["packets", "to the appropriate command handler object"]}}], "1": [{"inspects": {"A": "inspects", "S": "The device driver", "O": ["incoming network traffic from any client connecting to the victim machine"]}}, {"reroute": {"A": "reroute", "O": ["the network traffic"]}}], "2": [{"selects": {"A": "selects", "S": "DerusbiThread::DerusbiThread", "O": ["to use as a listening port", "a port between 40,000 and 45,000"]}}], "3": [{"get": {"A": "get", "S": "The mainLoop", "O": ["the privileges"]}}], "4": [{"opens": {"A": "opens", "S": "DerusbiThread::DerusbiThread", "O": ["as a listener", "the port"]}}], "5": [{"loaded": {"A": "loaded", "O": ["into memory", "the server variant", "via a LoadLibrary or equivalent function call"]}}], "6": [{"installs": {"A": "installs", "S": "the variant", "O": ["the device driver"]}}], "7": [{"listen": {"A": "listen", "S": "The Derusbi server variant", "O": ["an available, random port"]}}], "8": [{"waits": {"A": "waits", "S": "Derusbi", "O": ["for commands from a controlling client"]}}], "9": [{"hook": {"A": "hook", "S": "The server variant", "O": ["into the Windows firewall"]}}], "10": [{"determine": {"A": "determine", "S": "The server variant", "O": ["if it has suitable access rights"]}}], "11": [{"hooking": {"A": "hooking", "S": "The driver", "O": ["the firewall"]}}], "12": [{"hide": {"A": "hide", "S": "an attacker", "O": ["their communication"]}}], "13": [{"spawns": {"A": "spawns", "S": "The binary", "O": ["a new thread"]}}], "14": [{"install": {"A": "install", "S": "The DllRegisterServer function", "O": ["the server variant"]}}], "15": [{"sending": {"A": "sending", "S": "the server", "O": ["the server information"]}}], "16": [{"loading": {"A": "loading", "S": "The mainLoop function", "O": ["the unique infection ID"]}}], "17": [{"redirect": {"A": "redirect", "S": "the driver", "O": ["appropriate TCP sessions"]}}], "18": [{"checks": {"A": "checks", "S": "The check for access rights", "O": ["if the server variant process is running under the NT Authority"]}}]}, "Dino,the latest spying malware from an allegedly French espionage group analyzed.tokens": {"0": [{"executed": {"A": "executed", "O": ["in the\u00a0context\u00a0of\u00a0ramFS", "Several\u00a0commands"]}}], "1": [{"offering": {"A": "offering", "S": "ramFS", "O": ["a\u00a0disposable execution\u00a0environment\u00a0to\u00a0the\u00a0operators"]}, "serves": {"A": "serves", "S": "ramFS", "O": ["as a\u00a0protected\u00a0container\u00a0for\u00a0files\u00a0to\u00a0be\u00a0executed\u00a0on\u00a0the\u00a0machine"]}, "leaving": {"A": "leaving", "S": "ramFS", "O": ["very\u00a0few\u00a0traces\u00a0on\u00a0the\u00a0system"]}}], "2": [{"uninstall": {"A": "uninstall", "S": "The\u00a0cleaner\u00a0file", "O": ["the\u00a0malware", "from the\u00a0machine"]}}], "3": [{"remove": {"A": "remove", "S": "Dino", "O": ["from the\u00a0machine", "the\u00a0malware"]}}], "4": [{"save": {"A": "save", "S": "PSM\u00a0module", "O": ["in an\u00a0encrypted\u00a0file", "the\u00a0content\u00a0of\u00a0Dino\u00a0modules"]}}], "5": [{"be": {"A": "be", "S": "Dino\u2019s\u00a0main\u00a0goal", "O": ["the\u00a0exfiltration\u00a0of\u00a0files", "from its\u00a0targets"]}}], "6": [{"checked": {"A": "checked", "S": "Dino", "O": ["against process\u00a0names\u00a0used by\u00a0some\u00a0sandboxes", "the\u00a0current\u00a0process\u00a0name"]}}], "7": [{"contain": {"A": "contain", "S": "These\u00a0keys", "O": ["the\u00a0command\u00a0and\u00a0control\u00a0(C&C)\u00a0servers\u2019\u00a0URLs"]}}], "8": [{"reported": {"A": "reported", "O": ["The\u00a0result", "to the\u00a0C&C\u00a0server"]}}], "9": [{"execute": {"A": "execute", "S": "its", "O": ["in a\u00a0stealthy\u00a0fashion", "commands"]}}], "10": [{"look\u00a0for": {"A": "look\u00a0for", "S": "the\u00a0operators", "O": ["files"]}}], "11": [{}], "12": [{"store": {"A": "store", "S": "a\u00a0custom\u00a0file\u00a0system", "O": ["files", "in memory"]}}], "13": [{"encrypt": {"A": "encrypt", "O": ["the\u00a0network\u00a0communications", "with C&C servers"]}}], "14": [{"add": {"A": "add", "O": ["scheduled\u00a0tasks"]}}]}, "Duke_cloud_Linux.tokens": {"0": [{"copy": {"A": "copy", "S": "OneDriveSolution", "O": ["from the victim's computer", "data", "to the OneDrive account"]}}, {"copy": {"A": "copy", "S": "OneDriveSolution", "O": ["from the victim's computer", "to the OneDrive account", "data"]}}], "1": [{"download": {"A": "download", "S": "the downloader", "O": ["additional malware", "on execute additional malware"]}, "execute": {"A": "execute", "S": "the downloader", "O": ["additional malware", "on download additional malware"]}}], "2": [{"relies on": {"A": "relies on", "S": "it", "O": ["Microsoft's cloud storage service OneDrive", "as its command and control channel"]}}], "3": [{"written": {"A": "written", "O": ["two additional files", "to the victim's hard disk"]}}, {"written": {"A": "written", "O": ["to the victim's hard disk", "two additional files"]}}], "4": [{"execute": {"A": "execute", "S": "the same loader", "O": ["it"]}, "load": {"A": "load", "S": "the same loader", "O": ["in memory", "it"]}}], "5": [{"execute": {"A": "execute", "S": "the downloader", "O": ["an encrypted malicious payload"]}, "download": {"A": "download", "S": "the downloader", "O": ["an encrypted malicious payload"]}, "connect": {"A": "connect", "S": "the downloader", "O": ["to a compromised website"]}}], "6": [{"search": {"A": "search", "S": "It", "O": ["the OneDrive account", "for files containing commands for the malware to execute"]}}]}, "duqu2_crysys.tokens": {"0": [{"transmit": {"A": "transmit", "S": "The malware", "O": ["information", "through HTTP traffic"]}}], "1": [{"are obfuscated": {"A": "are obfuscated", "O": ["Some of the strings in Duqu 2.0", "by XOR-based encryption"]}}], "2": [{"reads": {"A": "reads", "S": "The analyzed main module of Duqu 2.0 and also the old Duqu sample", "O": ["configuration information", "from a special file"]}}], "3": [{"act": {"A": "act", "S": "These proxies", "O": ["HTTP or HTTPS servers"]}}], "4": [{"is used": {"A": "is used", "O": ["in the networking (mainly HTTP handling) part of the code", "a characteristic logging function"]}}], "5": [{"be": {"A": "be", "S": "one or more infected computers", "O": ["towards the attacker", "proxy points"]}}]}, "Elephantosis.tokens": {"0": [{"create": {"A": "create", "S": "The startup routine of the Babar implant", "O": ["under '[HKU]\\..\\CurrentVersion\\Run'", "a registry key", "to assure persistence"]}}], "1": [{"applies": {"A": "applies", "S": "a userland rootkit component", "O": ["global Windows hooks", "to invade all processes on its desktop"]}}], "2": [{"invades": {"A": "invades", "S": "Babar's implant", "O": ["desktop applications", "by applying a global Windows hooks"]}, "injects": {"A": "injects", "S": "Babar's implant", "O": ["to running processes", "itself"]}}], "3": [{"uninstall": {"A": "uninstall", "S": "Babar", "O": ["from the affected system", "itself"]}}], "4": [{"steal": {"A": "steal", "S": "The respective trampolines", "O": ["data going in or out of the hooked APIs", "on the fly"]}}], "5": [{"hides": {"A": "hides", "S": "it", "O": ["it", "in the file system"]}, "fetches": {"A": "fetches", "S": "it", "O": ["the encrypted DLL", "from its own binary from outside its resource section"]}}], "6": [{"installed": {"A": "installed", "O": ["A global Windows hook", "into the Windows event chain"]}}], "7": [{"applies": {"A": "applies", "S": "The Babar implant", "O": ["global Windows hooks"]}, "load": {"A": "load", "S": "The Babar implant", "O": ["its DLL", "into the process space of other processes"]}}], "8": [{"steal": {"A": "steal", "S": "an implant", "O": ["from instant messengers, softphones, browsers and office applications", "data"]}}], "9": [{"includes": {"A": "includes", "S": "Babar", "O": ["For grabbing audio streams", "code from the OpenCORE AMR library"]}}], "10": [{"steal": {"A": "steal", "S": "Babar", "O": ["data", "from arbitrary processes"]}, "install": {"A": "install", "S": "Babar", "O": ["API hooks for various APIs", "via Windows Detours technique"]}}], "11": [{"performed": {"A": "performed", "O": ["through the Babar instance", "The spying activities", "via a global Windows hook invading all processes running in the same desktop"]}}], "12": [{"logging": {"A": "logging", "S": "The implant", "O": ["keystrokes"]}, "capture": {"A": "capture", "S": "The implant", "O": ["screen shots"]}}], "13": [{"push": {"A": "push", "O": ["spied information", "onto the remote site"]}}, {"has": {"A": "has", "S": "Babar", "O": ["two hard coded C&C server addresses"]}}], "14": [{"performs": {"A": "performs", "S": "a thread", "O": ["encryption"]}}], "15": [{"implements": {"A": "implements", "S": "Babar", "O": ["an obfuscation technique", "to hide certain API names"]}}], "16": [{"steal": {"A": "steal", "S": "The implant", "O": ["on the fly", "data"]}}], "17": [{"creates": {"A": "creates", "S": "the main instance", "O": ["using the very same GUID", "six named pipes"]}}], "18": [{"steal": {"A": "steal", "S": "the global hooks", "O": ["information", "from Windows API calls"]}}, {"spying": {"A": "spying", "O": ["on window names"]}}], "19": [{"load": {"A": "load", "S": "it", "O": ["using Windows regsvr32.exe", "the DLL"]}}], "20": [{"reduces": {"A": "reduces", "S": "the malware", "O": ["forensic artefacts"]}}], "21": [{"load": {"A": "load", "S": "the regsvr32.exe process", "O": ["At system boot time", "the Babar DLL"]}}], "22": [{"load": {"A": "load", "S": "The function stub", "O": ["through LoadLibraryA", "the Babar DLL"]}, "execute": {"A": "execute", "S": "The function stub", "O": ["one of its exports"]}}], "23": [{"deleting": {"A": "deleting", "S": "a cmd.exe process", "O": ["the dropper binary on disk"]}}, {"spawning": {"A": "spawning", "S": "the dropper", "O": ["a cmd.exe process"]}}], "24": [{"receive": {"A": "receive", "S": "an invisible window", "O": ["window messages"]}}], "25": [{"uses": {"A": "uses", "S": "Babar", "O": ["named pipes", "For inter process communication"]}}], "26": [{"hook": {"A": "hook", "S": "the malware", "O": ["specific APIs of interest"]}}], "27": [{"sniff": {"A": "sniff", "S": "Babar", "O": ["all keystrokes happening on the same desktop as its invisible window"]}}], "28": [{"injecting": {"A": "injecting", "S": "Babar", "O": ["its DLL", "to a maximum of three desktop processes"]}}], "29": [{"spawns": {"A": "spawns", "S": "it", "O": ["a dedicated process", "with the command line '\"regsvr32.exe\" /s /n /i \"%APPDATA%\\%DLLNAME%\"'"]}}], "30": [{"compresses": {"A": "compresses", "S": "a separate thread"}, "encrypts": {"A": "encrypts", "S": "a separate thread"}}]}, "El_Machete.tokens": {"0": [{"installing": {"A": "installing", "S": "many other the files", "O": ["this cyber-espionage tool", "in what appears to be a dedicated a spear phishing campaign"]}}], "1": [{"is distributed": {"A": "is distributed", "O": ["via social engineering techniques", "The malware"]}}], "2": [{"is": {"A": "is", "S": "The malware", "O": ["capable of the following cyber-espionage operations"]}}]}, "fireeye-operation-saffron-rose.tokens": {"0": [{"deliver": {"A": "deliver", "S": "They", "O": ["this malware", "as a malicious executable (dropper)"]}}], "1": [{"spoofed": {"A": "spoofed", "S": "The attackers", "O": ["a variety of services such as Outlook Web Access and VPN login pages"]}, "tailored": {"A": "tailored", "S": "The attackers", "O": ["for specific targets in the DIB", "these login pages"]}}], "2": [{"registered": {"A": "registered", "S": "The attackers", "O": ["the domain \u201caeroconf2014[.]org\u201d", "in order to impersonate the IEEE Aerospace conference"]}, "sent": {"A": "sent", "S": "The attackers", "O": ["out an email with the following information"]}}], "3": [{"drops": {"A": "drops", "S": "This implant", "O": ["various other components", "into C:\\ Documents and Settings\\{USER}\\Application Data\\IntelRapidStart\\"]}}], "4": [{"used": {"A": "used", "O": ["in phishing attacks", "the domains"]}}, {"capture": {"A": "capture", "S": "the domains", "O": ["user credentials"]}}], "5": [{"connected": {"A": "connected", "S": "a sample", "O": ["to both intel- update[.]com and ultrasms[.]ir"]}}], "6": [{"were disguised": {"A": "were disguised", "O": ["as anti-censorship tools", "malware samples"]}}], "7": [{"written": {"A": "written", "O": ["on the local host", "Harvested data", "to disk"]}, "is encrypted": {"A": "is encrypted", "O": ["Harvested data"]}}], "8": [{"leverage": {"A": "leverage", "S": "his group", "O": ["varied social engineering tactics"]}, "lure": {"A": "lure", "S": "his group", "O": ["their targets", "into infecting themselves with malware"]}}], "9": [{"exfiltrate": {"A": "exfiltrate", "S": "This sample (MD5 1823b77b9ee6296a8b997ffb64d32d21)", "O": ["to ultrasms[.]ir", "data"]}}], "10": [{"uses": {"A": "uses", "S": "The Stealer component", "O": ["to acquire credential data", "common techniques"]}}], "11": [{"was bundled": {"A": "was bundled", "O": ["with an installer for Proxifier software", "288c91d6c0197e99b92c06496921bf2f"]}}], "12": [{"committed": {"A": "committed", "S": "Iranian actors", "O": ["DDoS attacks"]}}, {"destroyed": {"A": "destroyed", "S": "suspected Iranian actors", "O": ["on thousands of computers", "data", "with the Shamoon virus"]}}], "13": [{"was bundled": {"A": "was bundled", "O": ["6dc7cc33a3cdcfee6c4edb6c085b869d", "with an installer for Ultrasurf Proxy software"]}}], "14": [{"set up": {"A": "set up", "S": "they", "O": ["to emulate various services that require security credentials", "Web pages"]}}, {"used": {"A": "used", "S": "The attackers", "O": ["phishing attacks"]}}], "15": [{"connect": {"A": "connect", "S": "the new backdoor", "O": ["to a specific CnC server", "with a personalized username and password"]}}], "16": [{"was bundled": {"A": "was bundled", "O": ["an anti-censorship tool that is primarily used by Internet users in Iran", "with malware"]}}, {"were distributed": {"A": "were distributed", "O": ["to users Iran and Persian speaking people around the world", "malware-laden versions of legitimate anti-censorship software, such as Psiphon and Ultrasurf"]}}], "17": [{"was used": {"A": "was used", "O": ["in spear phishing attacks against companies in the U.S.", "the domain aerospace2014[.]org"]}}], "18": [{"exfiltrate": {"A": "exfiltrate", "S": "code", "O": ["over HTTP POST", "data"]}}], "19": [{"drops": {"A": "drops", "S": "The executable", "O": ["the implant IntelRS.exe"]}}], "20": [{"was bundled": {"A": "was bundled", "O": ["with an installer for the Psiphon proxy", "3efd971db6fbae08e96535478888cff9"]}}], "21": [{"uses": {"A": "uses", "S": "it", "O": ["to acquire RDP accounts from the Windows vault", "various APIs shown below"]}, "loads": {"A": "loads", "S": "it", "O": ["vaultcli.DLL"]}}], "22": [{"bind": {"A": "bind", "S": "The attacker", "O": ["to a legitimate application of his or her choosing", "the backdoor"]}}, {"cloak": {"A": "cloak", "S": "they", "O": ["with an icon designed to make the backdoor appear as though it is a legitimate file", "it"]}}], "23": [{"exfiltrated": {"A": "exfiltrated", "O": ["to a command-and-control (CnC) server under the groups\u2019 control", "logs"]}}], "24": [{"implements": {"A": "implements", "S": "a Delphi component called DelphiNative.DLL", "O": ["some additional data theft functionality", "for the following"]}}, {"loads": {"A": "loads", "S": "IntelRS.exe", "O": ["a Delphi component called DelphiNative.DLL"]}}], "25": [{"disguised": {"A": "disguised", "S": "attackers", "O": ["malware", "in order to target the users of such tools inside Iran as well as Iranian dissidents outside the country", "as anti-censorship tools"]}}], "26": [{"is conducted": {"A": "is conducted", "S": "AppTransferWiz.dll", "O": ["Data exfiltration", "over FTP"]}}], "27": [{"collect": {"A": "collect", "S": "IntelRS.exe", "O": ["data", "from various areas in the system as described below"]}}], "28": [{"be using": {"A": "be using", "S": "the Ajax Security Team", "O": ["anti-censorship tools", "as a lure"]}}], "29": [{"collect": {"A": "collect", "S": "the attackers", "O": ["their login credentials"]}}], "30": [{"contained": {"A": "contained", "S": "These droppers", "O": ["icons used in the legitimate installers for these programs"]}}], "31": [{"lure": {"A": "lure", "S": "the Ajax Security Team", "O": ["targets", "into installing malicious software and/or revealing login credentials"]}}], "32": [{"connect": {"A": "connect", "S": "The majority of the samples we analyzed", "O": ["to intel-update[.]com and update-mirror[.]com"]}}], "33": [{"include": {"A": "include", "S": "These attack vectors", "O": ["sending email, private messages via social media, fake login pages, and the propagation of anti-censorship software that has been infected with malware"]}}], "34": [{"targeted": {"A": "targeted", "S": "the attackers", "O": ["companies in the DIB", "using a fake conference page as a lure to trick targets into installing malicious software"]}}], "35": [{"are written": {"A": "are written", "O": ["The following files", "to disk", "in this location"]}}, {"has": {"A": "has", "S": "it", "O": ["various data collection modules"]}}], "36": [{"sent": {"A": "sent", "S": "these attackers", "O": ["targeted emails, as well as private messages", "through social media"]}}], "37": [{"was bundled": {"A": "was bundled", "O": ["with an installer for Gerdoovpn virtual private network software", "3d26442f06b34df3d5921f89bf680ee9"]}}], "38": [{"perform": {"A": "perform", "S": "incomplete code", "O": ["SFTP and SMTP exfiltration"]}}], "39": [{"drops": {"A": "drops", "S": "It"}, "launches": {"A": "launches", "S": "It"}}], "40": [{"is encrypted": {"A": "is encrypted", "O": ["the data", "via a Rijndael cipher implementation"]}}], "41": [{"engaged": {"A": "engaged", "S": "the Chinese hacking community", "O": ["in denial of service attacks"]}}], "42": [{"connects": {"A": "connects", "S": "This sample", "O": ["to the aforementioned intel-update[.]com as well as plugin-adobe[.]com"]}}], "43": [{"connecting": {"A": "connecting", "S": "the sample", "O": ["to plugin- adobe[.]com"]}}], "44": [{"wiped": {"A": "wiped", "S": "the \u201cShamoon\u201d attacks", "O": ["computers in Saudi Arabia and Qatar"]}}], "45": [{"configure": {"A": "configure", "S": "an attacker", "O": ["a new Stealer backdoor"]}}], "46": [{"were bundled": {"A": "were bundled", "O": ["with legitimate installers for VPN or proxy software", "Many of the malicious executables (droppers) that we collected"]}}], "47": [{"spoof": {"A": "spoof", "S": "These droppers", "O": ["the appearance of the above applications"]}}]}, "fireeye-sidewinder-targeted-attack.tokens": {"0": [{"locate": {"A": "locate", "S": "an attacker", "O": ["the victim"]}, "acquire": {"A": "acquire", "S": "an attacker", "O": ["the device\u2019s specifications"]}}], "1": [{"attempt": {"A": "attempt", "S": "they", "O": ["to control the host app", "ptrace"]}}], "2": [{"leak": {"A": "leak", "S": "Aggressive ad libraries", "O": ["the user\u2019s private information"]}}], "3": [{"load": {"A": "load", "S": "an attacker", "O": ["executables compiled from JNI code"]}}], "4": [{"target": {"A": "target", "S": "Sidewinder Targeted Attacks", "O": ["using info leakage and other vulnerabilities of ad libraries", "victims", "to get valuable, sensitive information"]}}], "5": [{"launch": {"A": "launch", "S": "an attacker", "O": ["different attacks", "through vulnerable ad libraries", "remotely", "on target devices"]}}], "6": [{"stolen": {"A": "stolen", "O": ["from the victim\u2019s device", "all information"]}}], "7": [{"taking": {"A": "taking", "S": "a remote attacker", "O": ["photos"]}, "recording": {"A": "recording", "S": "a remote attacker", "O": ["video"]}}], "8": [{"modify": {"A": "modify", "S": "the attacker", "O": ["files that the host app can write to"]}, "getting": {"A": "getting", "S": "the attacker", "O": ["local access"]}, "upload": {"A": "upload", "S": "the attacker", "O": ["from the victim\u2019s device", "private and sensitive files"]}}], "9": [{"invoke": {"A": "invoke", "S": "we", "O": ["to dial numbers directly via binder", "the telephony service"]}, "make": {"A": "make", "S": "we", "O": ["calls", "from the Javascript bridge", "without user consent"]}}], "10": [{"monitor or tamper": {"A": "monitor or tamper", "S": "an attacker", "O": ["with the clipboard"]}}], "11": [{"redirect": {"A": "redirect", "S": "the attackers", "O": ["other app icons (e.g., bank or email app icons)", "to the phishing app"]}, "steal": {"A": "steal", "S": "the attackers", "O": ["the user\u2019s login credentials"]}}], "12": [{"get": {"A": "get", "S": "Android pro- cesses", "O": ["from the AccountManager", "With both the GET ACCOUNTS and the USE CREDENTIALS permissions", "secret tokens of services (e.g., Google services)"]}, "use": {"A": "use", "S": "Android pro- cesses", "O": ["to authenticate to these services", "them"]}}], "13": [{"use": {"A": "use", "S": "Attackers", "O": ["fake ARP packets", "to direct all the traffic to go through the hijacking servers first for monitoring and hijacking"]}}, {"is": {"A": "is", "S": "ARP hijacking", "O": ["a well-known approach used in network attacks"]}}], "14": [{"executing": {"A": "executing", "S": "an attacker", "O": ["with the permissions of the host application", "Java code"]}, "manipulate": {"A": "manipulate", "S": "an attacker", "O": ["the host application", "in unintended ways"]}}, {"hijack": {"A": "hijack", "S": "an attacker over the network", "O": ["to control the host application", "to inject malicious content into the WebView", "the HTTP traffic", "through WiFi or DNS hijacking"]}}], "15": [{"sending": {"A": "sending", "S": "the attacker", "O": ["SMS"]}, "implanting": {"A": "implanting", "S": "the attacker", "O": ["bootkit"]}, "dialing": {"A": "dialing", "S": "the attacker", "O": ["numbers"]}, "taking": {"A": "taking", "S": "the attacker", "O": ["pictures"]}, "uploading": {"A": "uploading", "S": "the attacker", "O": ["local files"]}, "installing": {"A": "installing", "S": "the attacker", "O": ["the attacker\u2019s apps uploaded to Google Play"]}, "recording": {"A": "recording", "S": "the attacker", "O": ["audio/video"]}, "manipulating": {"A": "manipulating", "S": "the attacker", "O": ["the clipboard"]}}], "16": [{"inject": {"A": "inject", "S": "an attacker over the network", "O": ["into the WebView", "malicious content", "to misuse the interfaces exposed through the JS binding annotation"]}}], "17": [{"monitor": {"A": "monitor", "S": "the attackers", "O": ["changes to a clipboard"]}, "transfer": {"A": "transfer", "S": "the attackers", "O": ["the clipboard contents", "to some remote server"]}}], "18": [{"enables": {"A": "enables", "S": "The left panel", "O": ["to command the victim's device", "the attacker"]}}], "19": [{"keep": {"A": "keep", "S": "Attackers", "O": ["by allowing all other irrelevant network traffic to pass without being modified", "a low profile"]}}], "20": [{"inject": {"A": "inject", "S": "the attackers", "O": ["malicious DEX files"]}, "hijack": {"A": "hijack", "S": "the attackers", "O": ["the communication channels"]}}, {"control": {"A": "control", "S": "they", "O": ["the behaviors of the victim apps"]}}], "21": [{"manipulate": {"A": "manipulate", "S": "the attackers", "O": ["using two normal permissions: launcher READ SETTINGS and WRITE SETTINGS permissions", "Android home screen icons"]}}], "22": [{"steal": {"A": "steal", "S": "Malicious apps", "O": ["the passwords", "if they can read the contents on clipboard"]}}], "23": [{"iden- tify": {"A": "iden- tify", "S": "attackers", "O": ["based on information leakage such as GPS location described in Sec- tion 4.2", "potential victims", "Using the large-scale traffic intercepted from the above methods"]}}], "24": [{"conduct": {"A": "conduct", "S": "an attacker", "O": ["more targeted attacks"]}}, {"intercept and use": {"A": "intercept and use", "S": "an attacker", "O": ["to precisely locate targeted areas such as a CEO\u2019s office or specific conference rooms", "private information uploaded from ad libraries"]}}], "25": [{"hijack": {"A": "hijack", "S": "The attacker", "O": ["the network where the targeted victim resides"]}}], "26": [{"execute": {"A": "execute", "S": "a sample Javascript snippet", "O": ["shell command"]}}], "27": [{"intercepted": {"A": "intercepted", "O": ["the GPS location", "from the ad library"]}}, {"been uploaded": {"A": "been uploaded", "O": ["the victim\u2019s installed app list, clipboard, a photo taken from the back camera, an audio clip, and a video clip"]}}], "28": [{"obtain": {"A": "obtain", "S": "they", "O": ["on most Android phone models", "root"]}}], "29": [{"corrupting": {"A": "corrupting", "S": "BGP hijacking", "O": ["by breaking BGP sessions or injecting fake BGP information", "Internet routing tables"]}, "takes over": {"A": "takes over", "S": "BGP hijacking", "O": ["groups of IP addresses"]}}], "30": [{"alter": {"A": "alter", "S": "They", "O": ["to achieve phishing goals", "the clipboard content"]}}], "31": [{"exploit": {"A": "exploit", "S": "the attackers", "O": ["to get valuable private information"]}}], "32": [{"inject": {"A": "inject", "S": "they", "O": ["only into the targeted traffic", "to launch further attacks", "exploits"]}}], "33": [{"use": {"A": "use", "O": ["the JBOH shell", "to download exe- cutables"]}}, {"use": {"A": "use", "O": ["to root the device", "them"]}}], "34": [{"intercepted": {"A": "intercepted", "S": "We", "O": ["the data uploaded to the remote server"]}, "launched": {"A": "launched", "S": "We", "O": ["Man-in-the- Middle (MITM) attacks"]}}], "35": [{"change": {"A": "change", "S": "the background malicious service", "O": ["to a phishing site", "that link"]}}], "36": [{"authenticate": {"A": "authenticate", "S": "Android apps with these two permissions", "O": ["themselves", "with the user\u2019s Google account"]}}], "37": [{"taking": {"A": "taking", "S": "the attackers", "O": ["pictures"]}, "sending": {"A": "sending", "S": "the attackers", "O": ["SMS"]}}], "38": [{"access": {"A": "access", "S": "attackers", "O": ["By DNS hijacking", "all the traffic to ad servers"]}}], "39": [{"compromised": {"A": "compromised", "S": "Attackers", "O": ["many DNS servers, including the ones from Google and Godaddy"]}}], "40": [{"install": {"A": "install", "S": "attackers", "O": ["to any devices registered in user\u2019s account in the background", "apps of choice (e.g., an attacker\u2019s phishing app)", "without user consent"]}}], "41": [{"query/insert/ alter": {"A": "query/insert/ alter", "S": "a malicious app with these two permissions", "O": ["the system icon settings"]}, "modify": {"A": "modify", "S": "a malicious app with these two permissions", "O": ["to a phishing website", "egitimate icons of some security- sensitive apps, such as banking apps"]}}], "42": [{"invoke": {"A": "invoke", "S": "attackers", "O": ["for calling phone numbers"]}}], "43": [{"being tracked and targeted": {"A": "being tracked and targeted", "O": ["through ad traffic", "victims\u2019 devices"]}}], "44": [{"hijack": {"A": "hijack", "S": "ARP hijacking (or spoofing) in IDC", "O": ["the traffic to the ad server in the IDC where the ad server locates through fake ARP packets"]}}], "45": [{"launch": {"A": "launch", "S": "a combination of these components", "O": ["powerful and precise attacks", "on target devices"]}}], "46": [{"utilizing": {"A": "utilizing", "S": "attackers over the network", "O": ["the makeCall interface", "to dial phone numbers without the user\u2019s consent"]}}], "47": [{"pins": {"A": "pins", "S": "The panel", "O": ["down the GPS location of the victim\u2019s device", "onto a Google Map widget"]}}], "48": [{"eavesdropping or hijacking": {"A": "eavesdropping or hijacking", "S": "the attackers", "O": ["the HTTP traffic"]}}], "49": [{"subvert": {"A": "subvert", "S": "DNS hijacking", "O": ["through modifying the behavior of DNS servers so that they serve fake DNS information", "the resolution of Domain Name System (DNS) queries"]}}], "50": [{"choose": {"A": "choose", "S": "the attacker", "O": ["to take action on important targets only"]}}], "51": [{"hijacking": {"A": "hijacking", "S": "malicious ads or attackers", "O": ["the communication channels"]}}], "52": [{"achieve": {"A": "achieve", "S": "several well-known attacks", "O": ["large-scale monitoring"]}}], "53": [{"monitor": {"A": "monitor", "S": "attackers", "O": ["all traffic to specific IPs"]}}], "54": [{"call": {"A": "call", "S": "the code", "O": ["DexClassLoaderload", "to inject new classes from the attackers\u2019 DEX files to register callbacks to take pictures/ record videos"]}}]}, "Grabit.tokens": {"0": [{"delivered": {"A": "delivered", "O": ["the malware"]}}, {}], "1": [{"control": {"A": "control", "S": "the malware", "O": ["its victims"]}, "uses": {"A": "uses", "S": "the malware", "O": ["a number of RATs"]}, "track": {"A": "track", "S": "the malware", "O": ["their activity"]}}], "2": [{"packed": {"A": "packed", "O": ["Stolen data"]}, "sent": {"A": "sent", "O": ["over HTTP random ports", "Stolen data"]}}], "3": [{"modifying": {"A": "modifying", "S": "The malware", "O": ["commonplace registry entries"]}}]}, "Hikit_Analysis-Final.tokens": {"0": [{"listen": {"A": "listen", "S": "individual instances of Gen 2 DLL", "O": ["on local ports", "for incoming connections"]}, "accept": {"A": "accept", "S": "individual instances of Gen 2 DLL", "O": ["from the inbound connection", "commands"]}}], "1": [{"ensure": {"A": "ensure", "S": "the second Driver version check", "O": ["the correct Driver is installed"]}}], "2": [{"provides": {"A": "provides", "S": "at least two generations of malware", "O": ["basic RAT functionality"]}}], "3": [{"uses": {"A": "uses", "S": "Gen 2", "O": ["In order for the DLL to load", "a loader application"]}}], "4": [{"employs": {"A": "employs", "S": "The Gen 2 sub-family, beginning with Gen 2.0 Beta", "O": ["a Windows device driver (\u201cthe Driver\u201d)", "to hide aspects of the DLL\u2019s functionality from normal system processes"]}}], "5": [{"hiding": {"A": "hiding", "S": "The Driver", "O": ["services"]}}], "6": [{"listing": {"A": "listing", "S": "The file command", "O": ["directories"]}, "uploading": {"A": "uploading", "S": "The file command"}, "downloading": {"A": "downloading", "S": "The file command"}}], "7": [{"uninstall": {"A": "uninstall", "S": "the main thread", "O": ["from a victim\u2019s computer", "the Gen 1 system"]}}], "8": [{"allows": {"A": "allows", "S": "The dwHikitVersion field", "O": ["prior to executing commands", "to ensure that they have a compatible communication scheme in place", "the client and the DLL"]}}], "9": [{"load": {"A": "load", "S": "both variants of the Loader", "O": ["the embedded DLL", "in the exact same way"]}}], "10": [{"use": {"A": "use", "S": "The standalone Loaders", "O": ["the MatrixMain function"]}}, {"call": {"A": "call", "S": "the DLL Loaders", "O": ["the StartServer function"]}}], "11": [{"install": {"A": "install", "S": "the DLL", "O": ["itself", "on the victim\u2019s machine", "as a service"]}}], "12": [{"deletes": {"A": "deletes", "S": "the RAT functionality code", "O": ["in order to reduce the visible footprint of the new driver", "the service"]}}], "13": [{"hide": {"A": "hide", "S": "the RAT functionality code", "O": ["the DLL\u2019s PID"]}}], "14": [{"creates": {"A": "creates", "S": "The Driver", "O": ["to the device", "using the same name but under the \\DosDevices\\ tree", "a symbolic link"]}}], "15": [{"utilize": {"A": "utilize", "S": "an attacker", "O": ["a Hikit-infected machine", "as a proxy"]}}], "16": [{"hooks": {"A": "hooks", "S": "the Driver", "O": ["various Windows Kernel API calls", "In order to hide these items"]}}], "17": [{"activates": {"A": "activates", "S": "The shell command", "O": ["a remote shell", "on the victim\u2019s computer"]}}], "18": [{"supported": {"A": "supported", "S": "The Hikit family", "O": ["since the first known samples of Gen 1.0", "roughly the same set of commands"]}}], "19": [{"calls": {"A": "calls", "S": "LoadEmbeddedImage", "O": ["to decrypt the embedded DLL", "the function decodeBuffer (using the EncodingKey value)"]}, "copies": {"A": "copies", "S": "LoadEmbeddedImage", "O": ["the compressed embedded DLL", "into a newly allocated heap buffer"]}}], "20": [{"loading": {"A": "loading", "S": "the Loader", "O": ["into memory", "the embedded DLL image"]}, "call": {"A": "call", "S": "the Loader", "O": ["the DLL\u2019s StartServer or MatrixMain function"]}}], "21": [{"has": {"A": "has", "S": "the operator", "O": ["the basic Hikit functionalities available to them", "via commands such as file and shell"]}}], "22": [{"is install": {"A": "is install", "S": "an attacker", "O": ["the DLL", "as a service", "at some point prior to activation"]}}], "23": [{"load": {"A": "load", "S": "ImageLoaderData::LoadDll", "O": ["the DLL", "into memory"]}}, {"calls": {"A": "calls", "S": "LoadEmbeddedImage", "O": ["ImageLoaderData::LoadDll"]}}], "24": [{"loading": {"A": "loading", "S": "Both versions of the Loader", "O": ["using a custom loading routine", "into memory", "the DLL"]}}], "25": [{"calling": {"A": "calling", "S": "the Driver", "O": ["with the name \\Device\\agony (for Gen 2.0 Beta samples), \\Device\\HTTPS (for Gen 2.1 samples), \\Device\\advcachemgr (for Gen 2.2 samples) or \\Device\\diskdump (for Gen 2.3 samples)", "IoCreateDevice"]}}], "26": [{"hide": {"A": "hide", "S": "the code", "O": ["a service named \u201cHitx\u201d"]}}], "27": [{"connect and authenticate": {"A": "connect and authenticate", "S": "The console", "O": ["with the infected server"]}}], "28": [{"access": {"A": "access", "S": "an attacker", "O": ["the victim machine"]}}, {"operates": {"A": "operates", "S": "The first generation of Hikit (referred to as \u201cGen 1\u201d)", "O": ["as a server"]}}], "29": [{"send": {"A": "send", "S": "The DLL", "O": ["a legitimate SSL certificate", "as a means to disrupt heuristic IDS sensors that look for encrypted traffic"]}}], "30": [{"remove": {"A": "remove", "S": "mainThread", "O": ["the Driver", "from the victim\u2019s machine"]}}], "31": [{"supports": {"A": "supports", "S": "The RAT", "O": ["the following commands"]}}], "32": [{"install": {"A": "install", "S": "the DLL", "O": ["prior to terminating", "the correct version of the Driver"]}}], "33": [{"install": {"A": "install", "S": "the RAT", "O": ["on 32-bit versions of Windows", "a rootkit"]}}], "34": [{"is encrypted": {"A": "is encrypted", "O": ["using an XOR mask", "the communication between the infected machine and the attacker"]}}], "35": [{"hide": {"A": "hide", "S": "the Driver", "O": ["he items"]}}, {"remove": {"A": "remove", "S": "the Driver", "O": ["the service entry that the Driver wishes to hide"]}, "hide": {"A": "hide", "S": "the Driver", "O": ["services"]}, "access": {"A": "access", "S": "the Driver", "O": ["the memory of the services.exe process"]}}, {"hooks": {"A": "hooks", "S": "the Driver", "O": ["the API function"]}}], "36": [{"produce": {"A": "produce", "S": "Gen 2 samples", "O": ["up to three named events"]}}], "37": [{"uses": {"A": "uses", "S": "The Gen 2 sub-family", "O": ["for the core of its RAT functionality", "a DLL"]}}], "38": [{"calling": {"A": "calling", "O": ["DllRegisterServer", "without the u parameter"]}}], "39": [{"call": {"A": "call", "S": "The Loaders", "O": ["the StopServer function", "upon unloading", "in order to shut down the embedded DLL"]}}], "40": [{"provides": {"A": "provides", "S": "The DLL\u2019s RAT functionality", "O": ["remote command shell"]}}], "41": [{"is encrypted": {"A": "is encrypted", "S": "The communication between the Gen 2 malware and the C2", "O": ["using a simple DWORD XOR scheme"]}}], "42": [{"support": {"A": "support", "S": "Each Gen 2 infection", "O": ["up to 10 listening ports"]}}], "43": [{"calls": {"A": "calls", "S": "ImageLoaderData::LoadDll", "O": ["the DllMain (DLL\u2019s entry point) function"]}, "loads": {"A": "loads", "S": "ImageLoaderData::LoadDll", "O": ["the image", "into the appropriate memory configuration"]}}], "44": [{"beacons": {"A": "beacons", "S": "The second generation of Hikit (referred to as \u201cGen 2\u201d)", "O": ["out to an attacker\u2019s C2 server"]}}], "45": [{"generate": {"A": "generate", "S": "both exports", "O": ["a new thread of the same function (\u201cmainThread\u201d)"]}}], "46": [{"installs": {"A": "installs", "S": "the DLL", "O": ["the version of the Driver found within the DLL\u2019s resource section (under the BIN resource tree)"]}}, {"installing": {"A": "installing", "O": ["the appropriate Driver"]}}], "47": [{"activates": {"A": "activates", "S": "The RAT functionality code", "O": ["the service"]}}], "48": [{"interact": {"A": "interact", "S": "the DLL", "O": ["with the network", "without utilizes the WinSock API which could potentially reveal the presence of Hikit"]}}], "49": [{"rely": {"A": "rely", "S": "Gen 2 samples", "O": ["in order to know where the C2 server exists", "on a configuration"]}}], "50": [{"generating": {"A": "generating", "S": "the DLL", "O": ["a new thread (\u201cHikitThreadFunc\u201d) which will service any request coming from the new channel"]}}], "51": [{"hide": {"A": "hide", "S": "The Gen 2 Driver", "O": ["processes, registry keys and network connections associated with Gen 2 activity on the victim\u2019s system"]}}], "52": [{"create": {"A": "create", "S": "The DLL", "O": ["a new service"]}}], "53": [{"retain": {"A": "retain", "S": "both generations of Hikit", "O": ["the same basic RAT function consisting of remote command shell, file management, network proxy and port forwarding"]}}], "54": [{"hooks": {"A": "hooks", "S": "it", "O": ["in order to hide different pieces of information", "a minimum number of kernel API functions"]}}], "55": [{"contains": {"A": "contains", "S": "a main DLL (referred to as \u201cthe DLL\u201d)", "O": ["the RAT functionality"]}}], "56": [{"creates": {"A": "creates", "S": "the RAT functionality code", "O": ["with the driver in the %TEMP% directory as the executable for the service", "a service"]}}], "57": [{"generate": {"A": "generate", "S": "MatrixMain and StartServer", "O": ["using the POSIX API function beginthreadex", "a new thread", "instead of the more common CreateThread"]}}], "58": [{"intercepts": {"A": "intercepts", "S": "The Driver", "O": ["any and all network communication that traverses the Windows network stack"]}}], "59": [{"obfuscate": {"A": "obfuscate", "O": ["a process"]}}], "60": [{"providing": {"A": "providing", "O": ["to the malware", "a high level of persistence"]}}], "61": [{"listens": {"A": "listens", "S": "The Gen 1 Driver", "O": ["to network traffic arriving at the local network interface"]}}]}, "HPSR SecurityBriefing_Episode16_NorthKorea.tokens": {"0": [{"destroying": {"A": "destroying", "S": "It", "O": ["the MBR (master boot record) of the affected drive"]}, "overwrites": {"A": "overwrites", "S": "It", "O": ["with the string: \u201cprincpes\u201d", "the first 512 bytes"]}, "enumerates": {"A": "enumerates", "S": "It", "O": ["all physical drives"]}}], "1": [{"run": {"A": "run", "S": "the dropper"}, "upload": {"A": "upload", "S": "the dropper"}, "connect": {"A": "connect", "S": "the dropper", "O": ["remote servers"]}}], "2": [{"searches": {"A": "searches", "S": "the malware", "O": ["for configuration files and directories that may be associated with the connection manager clients mRemote and SecureCRT", "these directories"]}}], "3": [{"locates": {"A": "locates", "S": "It", "O": ["the root directory on these drives"]}, "delete": {"A": "delete", "S": "It", "O": ["all files and folders in this directory"]}, "look": {"A": "look", "S": "It", "O": ["for removable and fixed drives"]}, "is shut down and rebooted": {"A": "is shut down and rebooted", "S": "It", "O": ["the affected computer"]}}], "4": [{"is executed": {"A": "is executed", "O": ["the AgentBase.exe component"]}}], "5": [{"overwrite": {"A": "overwrite", "S": "The malware", "O": ["the master boot record (MBR)"]}, "disable": {"A": "disable", "S": "The malware", "O": ["AhnLab and Hauri AV antivirus products"]}}], "6": [{"was dropped": {"A": "was dropped", "O": ["as AgentBase.exe", "on the systems", "the wiper malware"]}}, {"target": {"A": "target", "S": "the wiper", "O": ["a large number of systems", "with full permissions on all of the targeted systems", "on a set time and date"]}}], "7": [{"exfiltrated": {"A": "exfiltrated", "S": "The malware used in these attacks", "O": ["data"]}, "sought out": {"A": "sought out", "S": "The malware used in these attacks"}}], "8": [{"is detected": {"A": "is detected", "S": "Symantec", "O": ["as Backdoor.Prioxer", "This RAT"]}}], "9": [{"used": {"A": "used", "S": "these actors", "O": ["the same collection keywords and encryption keys"]}}, {"scanning": {"A": "scanning", "S": "the North Korean IP address 175.45.178.xx", "O": ["South Korean routes"]}}], "10": [{"reads": {"A": "reads", "S": "the dropper", "O": ["the configuration file"]}}], "11": [{"downloaded": {"A": "downloaded", "S": "a third malware component", "O": ["an IRC RAT", "from various compromised websites"]}}], "12": [{"extracts": {"A": "extracts", "S": "it", "O": ["the information"]}}], "13": [{}], "14": [{"search": {"A": "search", "S": "the malware"}, "exfiltrate": {"A": "exfiltrate", "S": "the malware"}}], "15": [{"wiping": {"A": "wiping", "S": "The attack", "O": ["both Linux and Windows machines"]}}], "16": [{"spread": {"A": "spread", "S": "the Chinese exploit kit GonDad", "O": ["the malware"]}}], "17": [{"stop": {"A": "stop", "S": "it", "O": ["the following processes"]}, "evade": {"A": "evade", "S": "it", "O": ["detection"]}}], "18": [{"checks": {"A": "checks", "S": "The bash script", "O": ["UNIX"]}, "wipe": {"A": "wipe", "S": "The bash script", "O": ["the /kernel, /usr /etc and /home directories"]}, "rendering": {"A": "rendering", "S": "The bash script", "O": ["the machine inoperative"]}}], "19": [{}], "20": [{"performed": {"A": "performed", "S": "The wiper", "O": ["system reconnaissance"]}, "gathering": {"A": "gathering", "S": "The wiper", "O": ["drive information and operating system version"]}}, {"kill": {"A": "kill", "S": "The wiper", "O": ["the processes pasvc.exe and clisvc.exe"]}}], "21": [{"deleted": {"A": "deleted", "S": "the wiper", "O": ["files on the file system"]}, "deleting": {"A": "deleting", "S": "the wiper", "O": ["the Windows folder"]}}], "22": [{"were launched": {"A": "were launched", "O": ["against the South Korean government\u2019s DNS server", "DarkSeoul DDoS attacks"]}}], "23": [{"overwrote": {"A": "overwrote", "S": "It", "O": ["with the strings \"HASTATI\", \"PRINCPES\", \"PRINCIPES\", or \"PR!NCPES\u201d", "the MBR"]}}], "24": [{"extracts": {"A": "extracts", "S": "the dropper", "O": ["from sessions that have Username=root, Protocol=SSH and a saved password", "information"]}}], "25": [{"included": {"A": "included", "S": "the March 20 attacks", "O": ["disruption of service at financial institutions"]}}], "26": [{"were used": {"A": "were used", "O": ["to gain initial entry", "targeted email attacks"]}}, {"were then compromised": {"A": "were then compromised", "O": ["policy servers"]}}], "27": [{"were": {"A": "were", "S": "The malware used in the March 20, 2013 attacks", "O": ["wiper malware"]}}], "28": [{}], "29": [{}]}, "Inception_APT_Analysis_Bluecoat.tokens": {"0": [{"exfiltrate": {"A": "exfiltrate", "S": "Malware", "O": ["user information"]}, "communicate": {"A": "communicate", "S": "Malware", "O": ["with the user account created at the WebDAV C&C"]}}], "1": [{"obfuscated": {"A": "obfuscated", "O": ["to evade static analysis", "it"]}}], "2": [{"builds": {"A": "builds", "S": "it", "O": ["its own runtime import table", "to hinder the analysis"]}}], "3": [{"connecting": {"A": "connecting", "S": "it", "O": ["to webdav.cloudme.com"]}}]}, "KL_Epic_Turla_Technical_Appendix_20140806.tokens": {"0": [{"transmits": {"A": "transmits", "S": "The module", "O": ["in the body of the POST request", "the collected information"]}, "gets": {"A": "gets", "S": "The module", "O": ["from the server\u2019s response", "new commands"]}}], "1": [{"read": {"A": "read", "O": ["from disk", "it"]}, "uploaded": {"A": "uploaded", "O": ["it", "to the server"]}}], "2": [{"transmits": {"A": "transmits", "S": "It", "O": ["it", "to the C&C server"]}, "collects": {"A": "collects", "S": "It", "O": ["most of the available information about the system"]}, "executes": {"A": "executes", "S": "It", "O": ["the commands it receives back"]}}], "3": [{"issuing": {"A": "issuing", "S": "The module", "O": ["to the server", "HTTP POST requests"]}}], "4": [{"registers": {"A": "registers", "S": "It", "O": ["its only export _LowLevelKeyboardProc@12", "as a hook procedure for low-level keyboard input events (WH_KEYBOARD_LL hook)"]}}], "5": [{"controls": {"A": "controls", "S": "The configuration", "O": ["the further behavior of the module"]}}], "6": [{"Creates": {"A": "Creates", "O": ["the log file: %TEMP%\\~DFD3O8.tmp"]}}], "7": [{"writes": {"A": "writes", "S": "The low-level keyboard hook procedure", "O": ["to the log file", "information about each keystroke"]}}], "8": [{"transmitted": {"A": "transmitted", "O": ["The retrieved information", "to the C&C server"]}, "compressed": {"A": "compressed", "O": ["using bzip2", "The retrieved information"]}, "encrypted": {"A": "encrypted", "O": ["with AES", "The retrieved information"]}}]}, "Korplug_Afghanistan_Tajikistan.tokens": {"0": [{"gather": {"A": "gather", "S": "the malware", "O": ["account information"]}, "collecting": {"A": "collecting", "S": "the malware", "O": ["files"]}}], "1": [{"monitors": {"A": "monitors", "S": "it", "O": ["attached removable media"]}, "doing": {"A": "doing", "S": "it", "O": ["a recursive sweep of all logical fixed and remote drives"]}}], "2": [{"transfer": {"A": "transfer", "S": "The malware", "O": ["to the C&C server", "files transfer from the C&C server"]}, "manage": {"A": "manage", "S": "The malware", "O": ["processes and services on the infected machine"]}, "run": {"A": "run", "S": "The malware", "O": ["shell commands"]}}], "3": [{"being loading": {"A": "being loading", "O": ["into memory", "the Korplug trojan"]}}, {"contained": {"A": "contained", "S": "Some of the above-mentioned files", "O": ["decoy documents"]}}, {"were dropped": {"A": "were dropped", "O": ["three binary files"]}}], "4": [{"used": {"A": "used", "O": ["since 2012", "in a large number of targeted attacks", "the Korplug RAT (a.k.a .PlugX)"]}}], "5": [{"were connecting": {"A": "were connecting", "S": "the employed Korplug samples", "O": ["to the same C&C domain"]}}], "6": [{"harvesting": {"A": "harvesting", "S": "This malware", "O": ["files", "according to criteria set in the configuration file", "off the victim\u2019s hard drive"]}}], "7": [{"detected": {"A": "detected", "O": ["in these campaigns", "Some samples of this file stealer"]}}], "8": [{"connects": {"A": "connects", "S": "It", "O": ["to www.dicemention.com"]}}], "9": [{"were connecting": {"A": "were connecting", "S": "Other Korplug samples", "O": ["to a different domain name resolving to the same IPs as notebookhk.net"]}}], "10": [{"stay": {"A": "stay", "S": "The Korplug RAT", "O": ["under the radar"]}, "use": {"A": "use", "S": "The Korplug RAT", "O": ["this side-loading trick"]}}], "11": [{"exploit": {"A": "exploit", "S": "The maliciously crafted documents", "O": ["the CVE-2012-0158 vulnerability in Microsoft Word"]}}], "12": [{"was connecting": {"A": "was connecting", "S": "One of these \u2018alternative RATs\u2019", "O": ["to a domain also used by the Korplug samples"]}}], "13": [{"employing": {"A": "employing", "S": "two larger scale campaigns", "O": ["this well-known Remote Access Trojan"]}}]}, "Micro-Targeted-Malvertising-WP-10-27-14-1.tokens": {"0": [{"is": {"A": "is", "S": "this malware", "O": ["a Trojan backdoor"]}, "download": {"A": "download", "S": "this malware", "O": ["additional malware"]}, "provide": {"A": "provide", "S": "this malware", "O": ["remote persistent access", "to the attacker"]}}], "1": [{"delivered": {"A": "delivered", "S": "a malicious ad", "O": ["via a Java-based exploit", "a backdoor Trojan"]}}], "2": [{"target": {"A": "target", "S": "advanced threat actors", "O": ["directly", "based solely on their corporate network IP range", "an organization", "via micro-targeted malvertising"]}}], "3": [{"micro-target": {"A": "micro-target", "S": "Operation DeathClick", "O": ["via malvertising", "companies", "in order to compromise their networks"]}}], "4": [{"deliver": {"A": "deliver", "S": "attackers", "O": ["to you", "through your web browser", "because of your IP address space and your industry vertical", "malware"]}}], "5": [{"was almost converted": {"A": "was almost converted", "O": ["the host", "to a click-fraud bot"]}}], "6": [{"switch": {"A": "switch", "S": "Threat actors", "O": ["out the landing pages for their ads", "to pages that host exploit kits"]}, "create": {"A": "create", "S": "Threat actors", "O": ["a temporary redirection from their usual content to the malicious landing page"]}}], "7": [{"place": {"A": "place", "O": ["malvertising of Cryptowall", "on sports.yahoo.com"]}}], "8": [{"does": {"A": "does", "S": "a background web browser", "O": ["click fraud"]}}], "9": [{"copied": {"A": "copied", "S": "This exploit", "O": ["a fully functional version of Chrome", "into the Java cache directory"]}}, {"click": {"A": "click", "S": "that version of Chrome", "O": ["on specific ad banners"]}}], "10": [{"encrypts": {"A": "encrypts", "S": "Ransomware", "O": ["the victim\u2019s disk and data files, including remote storage"]}}], "11": [{"originate": {"A": "originate", "S": "Most targeted attacks against organizations", "O": ["as spear-phish campaigns or watering hole style web driveby attacks"]}}], "12": [{"dropped": {"A": "dropped", "S": "a Web server in Poland", "O": ["the malware"]}}], "13": [{"delivering": {"A": "delivering", "S": "malvertising", "O": ["via Real Time Ad Bidding", "CryptoWall ransomware attacks"]}}], "14": [{"were carried out": {"A": "were carried out", "O": ["the attacks", "by targeting these Defense contractors directly via real-time ad bidding"]}}], "15": [{"result": {"A": "result", "S": "visiting any ad-supported site", "O": ["in a CryptoWall ransomware infection"]}}], "16": [{"delivered": {"A": "delivered", "O": ["by visiting Fleaflicker.com", "the exploit and malware", "from an ad"]}}], "17": [{"linking": {"A": "linking", "S": "malicious content", "O": ["to landing pages that infect users"]}}], "18": [{"were targeted": {"A": "were targeted", "S": "a malvertising campaign", "O": ["multiple US Defense/Aerospace contractors"]}}], "19": [{"delivering": {"A": "delivering", "S": "Real Time Ad bidding platforms, including OpenX, GoogleAds, Yahoo, AOL, and first-impression.com", "O": ["the CryptoWall 2.0 ransomware ads"]}}], "20": [{"delivered": {"A": "delivered", "S": "a malvertiser", "O": ["a Java exploit"]}}], "21": [{"encrypts": {"A": "encrypts", "S": "it", "O": ["all local files on the disk"]}}, {"utilizes": {"A": "utilizes", "S": "Cryptowall 2.0", "O": ["the TOR network", "to hide its communications"]}}], "22": [{"exploit": {"A": "exploit", "S": "the malicious ads", "O": ["unsuspecting visitors", "with rive-by web exploits"]}}, {"used": {"A": "used", "O": ["to distribute malware", "3rd party ad networks"]}}], "23": [{"using": {"A": "using", "S": "malvertisers", "O": ["these same tools and techniques", "in addition to traditional click fraud, phishing, and identity theft", "to target companies with malware for persistent remote access"]}}], "24": [{"being written": {"A": "being written", "O": ["to disk", "the ransom note", "on an infected machine"]}}], "25": [{"perpetrate": {"A": "perpetrate", "S": "cyber crime gangs", "O": ["ad fraud"]}}], "26": [{"being used": {"A": "being used", "S": "criminal enterprise", "O": ["to target companies with malicious content", "real-time ad bidding networks"]}, "gain": {"A": "gain", "S": "criminal enterprise", "O": ["persistent remote access"]}}], "27": [{"replace": {"A": "replace", "O": ["the redirection code", "to switch from a legitimate ad banner to a drop site that hosts an exploit kit, typically based on Java, Flash, Silverlight, or all three"]}}], "28": [{"been intended": {"A": "been intended", "O": ["for data exfiltration", "the malware delivery"]}}], "29": [{"been armed": {"A": "been armed", "O": ["with a micro-targeting system using IP address ranges, geographically narrowed down to zip codes, and interests of the user (recorded in cookies)", "to target specific companies, company types, and user interests/preferences", "traditional malvertising"]}}], "30": [{"serves": {"A": "serves", "S": "the highest bidder for the placement", "O": ["malware"]}}], "31": [{"weaponized": {"A": "weaponized", "S": "these threat actors", "O": ["to target victims", "ad delivery networks"]}}], "32": [{"redirected": {"A": "redirected", "S": "delivery.first-impression.com", "O": ["to an IP address, not a domain name", "to deliver its malicious payload"]}}], "33": [{"dropping": {"A": "dropping", "S": "the ads on the Earthlink page", "O": ["the exploit code", "via Java"]}}], "34": [{"being used": {"A": "being used", "O": ["if the bidding price is right", "Those ad windows", "to deliver malware"]}}], "35": [{"were hit": {"A": "were hit", "O": ["these organizations", "with dozens of micro-targeted malvertising attacks"]}}], "36": [{"is delivering": {"A": "is delivering", "S": "the attacker", "O": ["the malicious ads"]}}], "37": [{"was": {"A": "was", "S": "this", "O": ["a spear-phish attack"]}}], "38": [{"exploit": {"A": "exploit", "S": "a new ad", "O": ["Java"]}}], "39": [{"were not detected": {"A": "were not detected", "S": "standard Anti-Virus", "O": ["Most of the attacks featured here", "because the malware hashes constantly change"]}}], "40": [{"installed": {"A": "installed", "S": "The malware", "O": ["a generic backdoor Trojan"]}}], "41": [{"provide": {"A": "provide", "S": "methods", "O": ["backdoor access and command and control over compromised networks"]}}], "42": [{"evades": {"A": "evades", "S": "the micro-targeting malvertising technique", "O": ["almost all network controls and traditional endpoint anti-virus solutions"]}}], "43": [{"dropped": {"A": "dropped", "S": "the exploited Java process", "O": ["a file called fvJcrgR0.exe"]}}], "44": [{"are preconfigured": {"A": "are preconfigured", "O": ["the landing pages", "with the exploit kit"]}}], "45": [{"delivered": {"A": "delivered", "O": ["via RTB ad bidding", "malvertising"]}}]}, "MiniDionis_CozyCar_Seaduke.tokens": {"0": [{"serve": {"A": "serve", "S": "the secondary dll file", "O": ["as a cleanup mechanism for the dropped binary"]}}], "1": [{"utilizes": {"A": "utilizes", "O": ["compromised, legitimate websites", "for spear phishing"]}}], "2": [{"cleans up": {"A": "cleans up", "S": "The secondary dropper", "O": ["after itself", "with a simple vbs script"]}}], "3": [{"responding": {"A": "responding", "S": "the C2 server", "O": ["with JSON blobs", "to beacons from the Trojan"]}}], "4": [{"issue": {"A": "issue", "S": "the Trojan", "O": ["an HTTPS request", "to the C2 server"]}}], "5": [{"allows": {"A": "allows", "O": ["to carry out a full range of activities on the system", "the threat actors"]}}], "6": [{"includes": {"A": "includes", "S": "The current CozyCar campaign", "O": ["spear phishing emails that deliver the payload from either by a link to a .zip file on a compromised website or by direct delivery as an attachment to the phish"]}}]}, "Miniduke_twitter.tokens": {"0": [{"gathers": {"A": "gathers", "S": "MiniDuke", "O": ["from the infected systems", "the following information"]}}, {"is then sent": {"A": "is then sent", "O": ["to the C&C server", "This information"]}}, {"request": {"A": "request", "O": ["to download a payload"]}}], "1": [{"is created": {"A": "is created", "O": ["The .LNKfile", "with the IShellLinkA interface", "using a COM object"]}}], "2": [{"is created": {"A": "is created", "O": ["the encrypted version of the malware"]}}, {"is written": {"A": "is written", "O": ["into a file in the %ALLUSERSPROFILE%\\Application Data directory", "it"]}}], "3": [{"is executed": {"A": "is executed", "O": ["by triggering the vulnerability", "the shellcode"]}}], "4": [{"retrieve": {"A": "retrieve", "S": "this script", "O": ["JScript code to execute"]}, "use": {"A": "use", "S": "this script", "O": ["to find a C&C", "Twitter"]}}], "5": [{"applies": {"A": "applies", "S": "MiniDuke", "O": ["to the script", "a light encoding"]}}], "6": [{"deliver": {"A": "deliver", "S": "this exploit", "O": ["malware"]}}], "7": [{"retrieves": {"A": "retrieves", "S": "MiniDuke", "O": ["the Twitter page of @FloydLSchwartz", "in search of URLs by which to reach C&C server"]}}], "8": [{"creates": {"A": "creates", "S": "the malware", "O": ["in the \u201cStartup\u201d directory", "a hidden .LNK file"]}, "persist": {"A": "persist", "S": "the malware", "O": ["on the infected system", "after reboots"]}}], "9": [{"gathering": {"A": "gathering", "S": "the malware", "O": ["the same system information as described in the \u201cInstallation\u201d section", "to decrypt configuration information"]}}, {"is loaded": {"A": "is loaded", "S": "rundll32.exe", "O": ["the malware"]}}], "10": [{"creating": {"A": "creating", "O": ["a copy of the Windows DLL cryptdll.dll"]}}], "11": [{"install": {"A": "install", "S": "MiniDuke", "O": ["TwitterJS module", "onto the system"]}}], "12": [{"use": {"A": "use", "S": "MiniDuke", "O": ["for distribution", "zero-day exploits"]}}], "13": [{"executes": {"A": "executes", "S": "it", "O": ["it"]}, "verifies": {"A": "verifies", "S": "it", "O": ["using RSA-2048", "the integrity of the file"]}}], "14": [{"starting": {"A": "starting", "O": ["every time the user opens a disk drive", "the bot"]}}, {"is registered": {"A": "is registered", "O": ["as the Open command when a drive is open", "this DLL"]}}], "15": [{"impossible to retrieve": {"A": "impossible to retrieve", "O": ["if analyzing it on a different computer", "the configuration of an encrypted payload"]}}], "16": [{"detect": {"A": "detect", "S": "it", "O": ["hooks and debugger breakpoints which may be set by security software and monitoring tools"]}}], "17": [{"proceeds": {"A": "proceeds", "S": "it", "O": ["with its installation onto the system"]}}], "18": [{"used": {"A": "used", "O": ["to communicate with the C&C server", "The final URL"]}}, {"is downloaded": {"A": "is downloaded", "O": ["in the file named \u201cfdbywu\u201d", "using the urlmon!URLDownloadToFileA API", "The payload"]}}], "19": [{"gathers": {"A": "gathers", "S": "MiniDuke", "O": ["information about the system"]}, "encrypts": {"A": "encrypts", "S": "MiniDuke", "O": ["its configuration", "based on that information"]}}], "20": [{"is then stored": {"A": "is then stored", "S": "This file", "O": ["in an Alternate Data Stream (ADS) in NTUSER.DAT in the %USERPROFILE% folder"]}}], "21": [{"thwart": {"A": "thwart", "S": "This", "O": ["security systems that scan at the entry points of the JScript engine"]}}], "22": [{"decrypts and drops": {"A": "decrypts and drops", "S": "it", "O": ["the payload", "in the %TEMP% directory in a file named \u201ca.l\u201d"]}, "is subsequently loaded": {"A": "is subsequently loaded", "O": ["the payload", "by calling kernel32!LoadLibraryA"]}}], "23": [{"verify": {"A": "verify", "S": "The RSA-2048 public key", "O": ["integrity of the executable inside the GIF file"]}}], "24": [{"contact": {"A": "contact", "S": "a secondary component written in JScript", "O": ["a C&C server", "via Twitter"]}}]}, "NetTraveler_Makeover_10th_Birthday.tokens": {"0": [{"hide": {"A": "hide", "S": "the developers behind NetTraveler", "O": ["the malware's configuration"]}}, {"is written": {"A": "is written", "O": ["The malware configuration file", "to the \"SYSTEM\" folder (as opposed to SYSTEM32)"]}}], "1": [{"installs": {"A": "installs", "S": "the main module", "O": ["a number of other files"]}}, {"drops": {"A": "drops", "S": "it", "O": ["as \"net.exe\"", "the main module"]}}], "2": [{"is": {"A": "is", "S": "the command-and-control (C&C) server", "O": ["\"uyghurinfo[.]com\""]}}], "3": [{"directed": {"A": "directed", "O": ["at Uyghur activists", "in March 2014", "a targeted spear-phishing e-mail"]}}], "4": [{"has": {"A": "has", "S": "The e-mail", "O": ["two attachments, a non-malicious JPG file and a 373 KB Microsoft Word .DOC file"]}}], "5": [{"is registered": {"A": "is registered", "O": ["as a service (named \"Windowsupdata\")", "It", "through a Windows Batch file named \"DOT.BAT\""]}}, {"make": {"A": "make", "O": ["the malware isn't running multiple times", "sure"]}}], "6": [{"is dumped": {"A": "is dumped", "O": ["into \"%SystemRoot%\\system32\\Windowsupdataney.dll\"", "The main C&C module"]}}]}, "NYTimes_Attackers_Evolve_Quickly.tokens": {"0": [{"contains": {"A": "contains", "S": "The Base64-encoded data", "O": ["information including the victim\u2019s hostname and IP address"]}}], "1": [{"evade": {"A": "evade", "S": "This sample (aa873ed803ca800ce92a39d9a683c644)", "O": ["existing network traffic signatures designed to detect Ixeshe related infections"]}}], "2": [{"sent": {"A": "sent", "O": ["Data", "via this POST request"]}}, {"generated": {"A": "generated", "S": "Older variants of this malware family", "O": ["the following POST request"]}}], "3": [{"uses": {"A": "uses", "S": "a new version of Ixeshe", "O": ["to evade traditional network security systems", "new network traffic patterns"]}}], "4": [{"encodes": {"A": "encodes", "S": "Aumlib", "O": ["certain HTTP communications"]}}], "5": [{"connected": {"A": "connected", "S": "The sample cb3dcde34fd9ff0e19381d99b02f9692", "O": ["to documents[.]myPicture[.]info and www[.]documents[.]myPicture[.]info"]}, "generated": {"A": "generated", "S": "The sample cb3dcde34fd9ff0e19381d99b02f9692", "O": ["a POST request", "to /bbs/info.asp"]}}], "6": [{"deployed": {"A": "deployed", "S": "the attackers behind the intrusion", "O": ["updated versions of their Backdoor.APT.Aumlib and Backdoor.APT.Ixeshe malware families"]}}], "7": [{"is now encoded": {"A": "is now encoded", "O": ["The POST body"]}}], "8": [{"is encoded": {"A": "is encoded", "O": ["the network traffic", "with a custom Base64 alphabet"]}}]}, "OnionDuke_Tor.tokens": {"0": [{"been infecting": {"A": "been infecting", "S": "the OnionDuke operators", "O": ["since the end of October 2013", "downloaded executables"]}}], "1": [{"communicate": {"A": "communicate", "S": "Most of these components", "O": ["with their controllers", "through the original backdoor process"]}}], "2": [{"been identified": {"A": "been identified", "O": ["as C&C domains used by MiniDuke", "the domains leveldelta.com and grouptumbler.com"]}}], "3": [{"being downloaded and executed": {"A": "being downloaded and executed", "S": "the original backdoor process", "O": ["Some of these components"]}}], "4": [{"gathering": {"A": "gathering", "S": "components", "O": ["further information on the compromised system like the presence of antivirus software or a firewall"]}}, {"stealing": {"A": "stealing", "S": "components", "O": ["login credentials", "from the victim machine"]}}], "5": [{"been spread": {"A": "been spread", "O": ["by infecting executables in .torrent files containing pirated software", "by modifying downloaded executables", "OnionDuke"]}}], "6": [{"proceed": {"A": "proceed", "S": "The dropper", "O": ["to decrypt this DLL, write it to disk and execute it"]}}], "7": [{"bypass": {"A": "bypass", "S": "the malicious actors", "O": ["any integrity checks the original binary might contain", "By using a separate wrapper"]}}], "8": [{"was consistently and maliciously modifying": {"A": "was consistently and maliciously modifying", "S": "a Tor exit node", "O": ["any uncompressed Windows executables downloaded through it"]}}], "9": [{"abuse": {"A": "abuse", "S": "this component", "O": ["as an additional C&C channel", "Twitter"]}}, {"contains": {"A": "contains", "S": "This DLL file", "O": ["among its configuration data", "a different hardcoded C&C domain, overpict.com"]}}], "10": [{"download and execute": {"A": "download and execute", "S": "the malware", "O": ["additional malicious components"]}, "receive": {"A": "receive", "S": "the malware", "O": ["instructions"]}}], "11": [{"is": {"A": "is", "S": "This executable", "O": ["a dropper"]}}, {"pretends": {"A": "pretends", "S": "a PE resource", "O": ["to be an embedded GIF image file"]}}], "12": [{"connect": {"A": "connect", "S": "the DLL file", "O": ["to hardcoded C&C URLs specified in the configuration data"]}}]}, "operation-poisoned-helmand.tokens": {"0": [{"distribute": {"A": "distribute", "S": "Chinese intelligence services", "O": ["using Afghanistan\u2019s government websites as a topical and trusted distribution platform", "to a variety of global targets", "malicious payloads"]}}], "1": [{"being": {"A": "being", "S": "This", "O": ["a variant of a typical \u201cwatering-hole\u201d attack"]}}], "2": [{"downloaded": {"A": "downloaded", "O": ["from [http:]//mfa.gov[.]af/content/images/icon35.png", "The XOR 0xC8 encoded payload"]}}], "3": [{"leveraged": {"A": "leveraged", "S": "a targeted cross-site scripting (XSS) \u201cdrive-by\u201d attack", "O": ["to distribute a malicious Java applet via nearly all of the major official Government of Afghanistan websites", "a single content delivery network resource"]}}], "4": [{"downloads and decodes": {"A": "downloads and decodes", "S": "This class file", "O": ["an XOR 0xC8 encoded Windows PE executable payload", "from [http:]//mfa.gov[.]af/content/images/icon35.png"]}}], "5": [{"connects": {"A": "connects", "S": "This backdoor", "O": ["to the faux Oracle Java themed command and control (C2) domain oracle0876634.javaplug-in[.]com"]}}], "6": [{"downloads": {"A": "downloads", "S": "This applet", "O": ["an XOR 0xFF encoded payload executable", "from the URL [https:]//amco- triton.co[.]jp/js/dl/in.jpg"]}}], "7": [{"loads": {"A": "loads", "S": "Malicious DLL", "O": ["into the above dllhost.exe"]}, "using": {"A": "using", "S": "Malicious DLL", "O": ["a similar DLL sideloading technique to that most commonly associated with the PlugX backdoor"]}}, {"drops": {"A": "drops", "S": "This executable", "O": ["the following files"]}}]}, "OperationDoubleTap.tokens": {"0": [{"connected": {"A": "connected", "S": "The deflated exe", "O": ["over port 1913", "to 198.55.115.71", "via SOCKS5 proxy"]}, "was": {"A": "was", "S": "The deflated exe", "O": ["a variant of the same downloader described above"]}}], "1": [{"verifies": {"A": "verifies", "S": "The malware", "O": ["that the first two bytes from the server are \"05 00\""]}, "requests": {"A": "requests", "S": "The malware", "O": ["using the command \"05 01 00 01 c0 b8 3c e5 00 51\"", "a connection to 192.184.60.229 on TCP port 81"]}}], "2": [{"establishes": {"A": "establishes", "S": "the malware", "O": ["to 192.157.198.103", "a SOCKS5 connection", "using TCP port 1913"]}}, {"uses": {"A": "uses", "S": "The malware component, test.exe", "O": ["the Windows command \"cmd.exe\" /C whoami\u201d", "to verify it is running with the elevated privileges of \u201cSystem\u201d"]}, "creates": {"A": "creates", "S": "The malware component, test.exe", "O": ["by creating the following scheduled task", "persistence"]}}], "3": [{"connected": {"A": "connected", "S": "The secondary payload", "O": ["to the known APT3 domains"]}, "was detected": {"A": "was detected", "S": "The secondary payload", "O": ["as Backdoor.APT.CookieCutter (aka Pirpi)"]}}], "4": [{"downloads": {"A": "downloads", "S": "the system", "O": ["install.exe"]}}, {"write": {"A": "write", "S": "The file install.exe", "O": ["two files (doc.exe and test.exe)", "to the hard-coded path \u201cC:\\Users\\Public\u201d"]}}], "5": [{"send": {"A": "send", "S": "the actors responsible for Operation Clandestine Fox", "O": ["waves of spearphishing messages", "over the past few months"]}}], "6": [{"sending": {"A": "sending", "S": "APT3", "O": ["out spearphishing messages containing a compressed executable attachment"]}}], "7": [{"verifies": {"A": "verifies", "S": "The malware", "O": ["the server response starts with \"05 00\""]}, "sends": {"A": "sends", "S": "The malware", "O": ["the SOCKS5 connection request \"05 01 00\""]}}], "8": [{"is": {"A": "is", "S": "CVE-2014- 4113", "O": ["a privilege escalation vulnerability"]}}], "9": [{"expects": {"A": "expects", "S": "the malware", "O": ["a message containing at least three bytes from the server", "Once the connection to the server is established"]}}], "10": [{"contains": {"A": "contains", "S": "The first dropped file, doc.exe", "O": ["the CVE-2014-4113 exploit"]}, "execute": {"A": "execute", "S": "The first dropped file, doc.exe", "O": ["with the elevated privileges", "test.exe"]}}], "11": [{"give": {"A": "give", "S": "This CVE", "O": ["any user", "SYSTEM access on the machine"]}}], "12": [{"served": {"A": "served", "S": "the walterclean[.]com", "O": ["as a Plugx/Kaba command and control server"]}}], "13": [{"attack": {"A": "attack", "S": "they", "O": ["with known exploits or social engineering", "targets"]}}], "14": [{"is": {"A": "is", "S": "CVE-2014-6332", "O": ["a Windows OLE Automation Array Remote Code Execution vulnerability"]}}], "15": [{"download": {"A": "download", "S": "a VBScript", "O": ["the below payload"]}}]}, "Operation_CloudyOmega_Ichitaro.tokens": {"0": [{"based": {"A": "based", "S": "Type S", "O": ["on and shared C&C infrastructure as Type T"]}}], "1": [{"executing": {"A": "executing", "S": "the remote attacker", "O": ["the commands"]}, "send": {"A": "send", "S": "the remote attacker", "O": ["through HTTP", "the results", "back to the command-and-control (C&C) server"]}}], "2": [{"trick": {"A": "trick", "S": "This", "O": ["into believing the email is from a legitimate and trustworthy source", "the recipient"]}}], "3": [{"uses": {"A": "uses", "S": "it", "O": ["as an encryption key", "a hash"]}, "generates": {"A": "generates", "S": "The malware", "O": ["a hash"]}}], "4": [{"drop": {"A": "drop", "S": "Opening the malicious attachment with Ichitaro", "O": ["the payload"]}}], "5": [{"is sent": {"A": "is sent", "O": ["The exploit", "through emails with a malicious Ichitaro document file attached", "to the targeted organizations"]}}], "6": [{"detects": {"A": "detects", "S": "Type T", "O": ["the presence of automatic analysis systems"]}}], "7": [{"opens": {"A": "opens", "S": "a threat", "O": ["on the compromised computer", "a back door"]}}, {"is": {"A": "is", "S": "The malicious payload", "O": ["Backdoor.Emdivi"]}}], "8": [{"employs": {"A": "employs", "S": "Type T", "O": ["to protect itself from security vendors or network administrators", "techniques"]}}], "9": [{"requests": {"A": "requests", "S": "The email", "O": ["that the recipient open the attachment on a Windows computer"]}}], "10": [{"steal": {"A": "steal", "S": "all payloads", "O": ["confidential information", "from the compromised computer"]}}, {"include": {"A": "include", "S": "Payloads from the exploit", "O": ["Backdoor.Emdivi, Backdoor.Korplug, and Backdoor.ZXshell"]}}], "11": [{"installed": {"A": "installed", "S": "the file", "O": ["Backdoor.Emdivi"]}}], "12": [{"are": {"A": "are", "S": "the attachments", "O": ["with a fake icon", "in a simple executable format"]}}], "13": [{"connects": {"A": "connects", "S": "Emdivi", "O": ["using the HTTP protocol", "to hardcoded C&C servers"]}}], "14": [{"turned": {"A": "turned", "S": "the attacker", "O": ["the websites", "into C&C servers for Backdoor.Emdivi"]}}], "15": [{"steal": {"A": "steal", "S": "This group", "O": ["from targeted organizations", "confidential information"]}}], "16": [{"are persistently used": {"A": "are persistently used", "O": ["variants of Backdoor.Emdivi", "as a payload"]}}], "17": [{"sent": {"A": "sent", "S": "The attackers", "O": ["a Microsoft Word file containing a maliciously crafted SWF file that exploited the vulnerability"]}}], "18": [{"install": {"A": "install", "S": "an Adobe Flash zero-day exploit", "O": ["a back door"]}}], "19": [{"arrive": {"A": "arrive", "S": "All attacks", "O": ["on the target computers", "as an attachment to email messages"]}}], "20": [{"include": {"A": "include", "S": "The emails", "O": ["password-protected .zip files containing the malware"]}}], "21": [{"are encrypted": {"A": "are encrypted", "O": ["Important parts of Type T, such as the C&C server address it contacts and its protection mechanisms"]}}]}, "Operation_GreedyWonk.tokens": {"0": [{"was configured": {"A": "was configured", "O": ["This PlugX payload", "with the following command-and-control (CnC) domains"]}}], "1": [{"downloads": {"A": "downloads", "S": "it", "O": ["via the InternetOpenURLA and InternetReadFile functions", "an executable"]}}], "2": [{"use": {"A": "use", "S": "the attackers", "O": ["a hard-coded ROP chain for HXDS.dll (Help Data Services Module)", "if the user has Microsoft Office 2007 or 2010", "On Windows 7", "a hard-coded ROP chain for MSVCR71.dll (Visual C++ runtime)", "if the user has Java 1.6"]}}], "3": [{"connecting": {"A": "connecting", "S": "a number of older malware samples", "O": ["to the same domain wmi.ns01[.]us"]}}], "4": [{"were redirected": {"A": "were redirected", "O": ["Visitors to the Peter G. Peterson Institute for International Economics (www.piie[.]com)", "to an exploit server hosting this Flash zero-day", "through a hidden iframe"]}}], "5": [{"redirecting": {"A": "redirecting", "S": "www.arce[.]org", "O": ["to the current Flash exploit"]}, "redirect": {"A": "redirect", "S": "www.arce[.]org", "O": ["visitors", "to the Java exploit on shop.fujifilm[.]be", "in 2013"]}}], "6": [{"were redirected": {"A": "were redirected", "O": ["visitors to at least three nonprofit institutions", "to an exploit server hosting the zero-day exploit"]}}], "7": [{"is installed": {"A": "is installed", "O": ["a PlugX/Kaba remote access tool (RAT) payload with the MD5 hash 507aed81e3106da8c50efb3a045c5e2b", "on the compromised endpoint"]}}], "8": [{"is downloaded": {"A": "is downloaded", "O": ["in ActionScript", "as a GIF image", "The shellcode"]}}], "9": [{"writes": {"A": "writes", "S": "it", "O": ["with CreateFileA and WriteFile functions", "to disk", "the file"]}}], "10": [{"dropped": {"A": "dropped", "S": "This jar file", "O": ["a Poison Ivy payload with the hash (MD5 52aa791a524b61b129344f10b4712f52)"]}}], "11": [{"deploys": {"A": "deploys", "S": "This actor", "O": ["a variety of malware families", "on compromised systems"]}}], "12": [{"were redirected": {"A": "were redirected", "O": ["from www.ceps[.]be", "to a Java exploit hosted on shop.fujifilm[.]be", "visitors"]}}], "13": [{"infect": {"A": "infect", "S": "The group behind this campaign", "O": ["visitors to foreign and public policy websites"]}}], "14": [{"were redirected": {"A": "were redirected", "O": ["to a Java exploit test.jar (MD5 7d810e3564c4eb95bcb3d11ce191208e)", "visitors"]}}], "15": [{"build": {"A": "build", "S": "the attackers", "O": ["a return-oriented programming (ROP) chain of MSVCRT (Visual C runtime) gadgets", "For Windows XP", "with hard-coded base addresses for English (\u201cen\u201d) and Chinese (\u201czh-cn\u201d and \u201czh-tw\u201d)"]}}], "16": [{"uses": {"A": "uses", "S": "The attack", "O": ["only known ASLR bypasses"]}}], "17": [{"was delivered": {"A": "was delivered", "O": ["via an exploit chain that began with a redirect from the Center for European Policy Studies (www.ceps[.]be)", "The Poison Ivy sample referenced above (MD5 fd69793bd63c44bbb22f9c4d46873252)"]}}], "18": [{"overwrite": {"A": "overwrite", "S": "an attacker", "O": ["to redirect code execution", "the vftable pointer of a Flash object"]}}], "19": [{"was dropped": {"A": "was dropped", "S": "an Adobe Flash exploit (CVE-2012-0779)", "O": ["a related Poison Ivy sample (MD5 8936c87a08ffa56d19fdb87588e35952) with the same \u201cjava7\u201d password"]}}, {"connected": {"A": "connected", "S": "The Poison Ivy variants", "O": ["to the domain wmi.ns01[.]us"]}}], "20": [{"were redirected": {"A": "were redirected", "O": ["to an exploit server at 159.54.62.92", "visitors to the Center for Defense Information website"]}}], "21": [{"connected": {"A": "connected", "S": "This Poison Ivy variant", "O": ["to a CnC server at ids.ns01[.]us"]}}], "22": [{"connected": {"A": "connected", "S": "this variant", "O": ["to a CnC server at windows.ddns[.]us"]}}], "23": [{"infect": {"A": "infect", "S": "The threat actors", "O": ["for follow-on data theft", "users to these sites"]}}], "24": [{"dropped": {"A": "dropped", "S": "This exploit", "O": ["the Poison Ivy variant"]}}], "25": [{"redirected": {"A": "redirected", "S": "We subsequently found that the American Research Center in Egypt (www.arce[.]org) and the Smith Richardson Foundation (www.srf[.]org)", "O": ["the exploit server", "visitors"]}}], "26": [{"targets": {"A": "targets", "S": "this exploit", "O": ["computers with any of the following configurations"]}, "bypass": {"A": "bypass", "S": "this exploit", "O": ["Windows\u2019 Address Space Layout Randomization (ASLR) protections"]}}], "27": [{"runs": {"A": "runs", "S": "it", "O": ["the file", "using the WinExec function"]}}]}, "Operation_Poisoned_Handover.tokens": {"0": [{"decoded": {"A": "decoded", "S": "it", "O": ["a command that configured its C2 server"]}}, {"connected": {"A": "connected", "S": "This PlugX variant", "O": ["to a Google Code project at code.google[.]com/p/udom/"]}}], "1": [{"flood": {"A": "flood", "S": "bots under their control", "O": ["124.217.214.149", "with UDP traffic"]}}, {"instructed": {"A": "instructed", "S": "a configuration update", "O": ["bots under their control"]}}, {"pushed": {"A": "pushed", "S": "the attackers", "O": ["a configuration update", "to four controls servers"]}}], "2": [{"encode": {"A": "encode", "S": "two different single-byte XOR keys", "O": ["configuration files issued by the DDOS C2 servers in this campaign"]}}], "3": [{"connected": {"A": "connected", "S": "This sample", "O": ["for C2", "to luxscena[.]com"]}}, {"is detected": {"A": "is detected", "O": ["as Backdoor.APT.Preshin", "This sample"]}}], "4": [{"receive": {"A": "receive", "S": "a number of binaries", "O": ["instructions", "from a set of command and control (C2) servers"]}}, {"instructing": {"A": "instructing", "S": "a set of command and control (C2) servers", "O": ["participating bots", "to attack Next Media-owned websites and the HKGolden forum"]}}], "5": [{"launched": {"A": "launched", "S": "attackers", "O": ["a series of Distributed Denial of Service attacks (DDoS)", "against websites promoting democracy in Hong Kong"]}}], "6": [{"instructing": {"A": "instructing", "S": "two of the active controls", "O": ["to cease attacks", "participating bots"]}}], "7": [{"target": {"A": "target", "S": "These ongoing DDoS attacks", "O": ["the hkgolden[.]com website"]}}], "8": [{"issued": {"A": "issued", "S": "These configurations", "O": ["commands to attack the following domains and IPs"]}}], "9": [{"suffered": {"A": "suffered", "S": "websites belonging to Next Media\u2019s Apple Daily publication", "O": ["from an ongoing DDoS attack that \u201cbrought down its email system for hours\u201d"]}}], "10": [{"detect": {"A": "detect", "S": "We", "O": ["as Backdoor.APT.PISCES", "this payload"]}}, {"connect": {"A": "connect", "S": "it", "O": ["to u.java-se[.]com"]}}], "11": [{"issued": {"A": "issued", "S": "the attackers", "O": ["new instructions", "to their botnet"]}}], "12": [{"drop": {"A": "drop", "S": "they", "O": ["three files"]}}], "13": [{"issued": {"A": "issued", "S": "the C2 servers listed above", "O": ["more than 30 different unique configuration files"]}}], "14": [{"been targeted": {"A": "been targeted", "S": "a KernelBot network", "O": ["with a DDoS attack", "this site"]}}], "15": [{"receive": {"A": "receive", "S": "The KernelBot implants", "O": ["from C2 servers hard-coded directly into the sample", "targeting instructions"]}}], "16": [{"connects": {"A": "connects", "S": "a KernelBot variant", "O": ["to both www.sapporo-digital-photoclub[.]com and wakayamasatei[.]com"]}}, {"drops": {"A": "drops", "S": "c3d6450075d618b1edba17ee723eb3ca", "O": ["a KernelBot variant"]}}], "17": [{"detect": {"A": "detect", "S": "We", "O": ["this payload", "as Backdoor.APT.PISCES"]}}, {"used": {"A": "used", "S": "it", "O": ["hk.java-se[.]com", "for C2"]}}], "18": [{"were issuing": {"A": "were issuing", "S": "all five of the known active control servers", "O": ["to cease the attacks", "commands"]}}], "19": [{"drop": {"A": "drop", "S": "These binaries", "O": ["a variant of an older DDoS tool known as KernelBot"]}}], "20": [{"suffered": {"A": "suffered", "S": "Next Media\u2019s network", "O": ["as a result of these attacks", "a \u201ctotal failure\u201d"]}}]}, "Operation_SnowMan.tokens": {"0": [{"called": {"A": "called", "S": "This particular variant", "O": ["back to a command and control server located at newss[.]effers[.]com"]}}], "1": [{"creates": {"A": "creates", "S": "the malware", "O": ["when the shellcode is executed", "files \u201csqlrenew.txt\u201d and \u201cstream.exe\u201d"]}}], "2": [{"begin": {"A": "begin", "S": "The attacker", "O": ["ROP"]}, "overwrites": {"A": "overwrites", "S": "The attacker", "O": ["in memory", "to point to the pivot", "the vftable pointer of a flash.Media.Sound() object"]}}], "3": [{"connecting": {"A": "connecting", "S": "another \u201cHTTPS\u201d Gh0st variant", "O": ["to a related command and control server at me[.]scieron[.]com"]}}], "4": [{"modify": {"A": "modify", "S": "the attacker", "O": ["at an arbitrary address", "one byte of memory"]}}], "5": [{"being served up": {"A": "being served up", "O": ["a zero-day exploit (CVE-2014-0322)", "from the U.S. Veterans of Foreign Wars\u2019 website (vfw[.]org)"]}}], "6": [{"dropped": {"A": "dropped", "S": "this exploit", "O": ["an XOR (0\u00d795) payload"]}}, {"executed": {"A": "executed", "S": "an XOR (0\u00d795) payload", "O": ["a ZxShell backdoor (MD5: 8455bbb9a210ce603a1b646b0d951bce)"]}}], "7": [{"calling": {"A": "calling", "S": "Gh0stRat samples with the custom packet flag \u201cHTTPS\u201d", "O": ["back to book[.]flnet[.]org and icybin[.]flnet[.]org"]}}], "8": [{"used": {"A": "used", "S": "multiple threat actors linked to cyber espionage operations", "O": ["The ZxShell backdoor"]}}], "9": [{"were silently redirected": {"A": "were silently redirected", "O": ["through an iframe", "visitors to the VFW website", "to the exploit at www.[REDACTED].com/Data/img/img.html"]}}], "10": [{"searches": {"A": "searches", "S": "the code", "O": ["by machine code", "through loaded libraries gadgets", "Once the attacker\u2019s code has full memory access through the corrupted Flash Vector object"]}}], "11": [{"is then executed": {"A": "is then executed", "O": ["with the LoadLibraryA Windows API call", "\u201csqlrenew.txt\u201d"]}}], "12": [{"use": {"A": "use", "S": "the attacker", "O": ["to bypass ASLR", "it"]}}, {"modify": {"A": "modify", "S": "attackers", "O": ["memory", "to an arbitrary address"]}}], "13": [{"uses": {"A": "uses", "S": "The attacker", "O": ["to load a one-line XML string containing a file path to the EMET DLL", "the Microsoft.XMLDOM ActiveX control"]}}], "14": [{"were all linked": {"A": "were all linked", "O": ["to both Operation DeputyDog and Operation Ephemeral Hydra", "dll[.]freshdns[.]org, ali[.]blankchair[.]com and cht[.]blankchair[.]com"]}}], "15": [{"deploy": {"A": "deploy", "S": "this actor(s)", "O": ["against high-profile targets", "using zero-day exploits", "a number of different private and public RATs"]}}], "16": [{"build": {"A": "build", "S": "They", "O": ["ROP chains"]}}], "17": [{"is decoded, and written": {"A": "is decoded, and written", "O": ["to these files", "The tail of the image file"]}}], "18": [{"aborts": {"A": "aborts", "S": "It", "O": ["exploitation", "if the user is browsing with a different version of IE or has installed Microsoft\u2019s Experience Mitigation Toolkit (EMET)"]}}], "19": [{"downloads": {"A": "downloads", "S": "the malicious Flash code", "O": ["a file containing the dropped malware payload"]}}]}, "OrcaRAT.tokens": {"0": [{"designed": {"A": "designed", "S": "this malware", "O": ["as a first stage implant"]}}], "1": [{"executed": {"A": "executed", "O": ["a binary executable file"]}, "written": {"A": "written", "O": ["to the disk", "a binary executable file"]}}], "2": [{"sends out": {"A": "sends out", "S": "it", "O": ["the initial communications", "to its command and control server"]}}], "3": [{"force": {"A": "force", "S": "The first set of commands", "O": ["to behave as a simple downloader", "the malware"]}}], "4": [{"executing": {"A": "executing", "O": ["arbitrary commands"]}}, {"provides": {"A": "provides", "S": "The command and control structure", "O": ["with access to the victim machine\u2019s filesystem and command line", "the operator"]}}, {"downloading": {"A": "downloading", "O": ["files", "from uploading files"]}, "uploading": {"A": "uploading", "O": ["files", "from downloading files"]}}], "5": [{"sends": {"A": "sends", "S": "OrcaRAT", "O": ["an HTTP POST message", "to the command and control server"]}}], "6": [{"encrypt": {"A": "encrypt", "O": ["several pieces of information that are extracted from the system"]}}]}, "PAN_Nitro.tokens": {"0": [{"re-using": {"A": "re-using", "S": "Nitro", "O": ["old C2 infrastructure", "with their new malware"]}}], "1": [{"avoid": {"A": "avoid", "O": ["detection"]}}], "2": [{"use": {"A": "use", "S": "The malware", "O": ["good.myftp[.]org", "as the C2 URL"]}}]}, "Pitty_Tiger_Final_Report.tokens": {"0": [{"been targeted": {"A": "been targeted", "O": ["Someone from the same company", "with this document"]}}], "1": [{"communicates": {"A": "communicates", "S": "our sample", "O": ["with \u201csop.avstore.com.tw\u201d"]}}], "2": [{"were coming": {"A": "were coming", "S": "Most of the connections to the c&c server", "O": ["from a computer named 50PZ80C- 1DFDCB8 with several IP addresses"]}}], "3": [{"been transferred": {"A": "been transferred", "O": ["to the c&c server", "this data"]}}, {"sending": {"A": "sending", "S": "it", "O": ["additional malware to execute on the machine"]}}], "4": [{"collected": {"A": "collected", "S": "the Pitty Tiger group", "O": ["information on some of their targets", "by exploiting the HeartBleed bug"]}}], "5": [{"is also copied": {"A": "is also copied", "O": ["to the user\u2019s \u201cApplication Data\u201d directory", "The binary"]}}, {"is dropped": {"A": "is dropped", "O": ["on the system", "The \u201crelease.tmp\u201d file"]}}, {"injects": {"A": "injects", "S": "The binary", "O": ["in \u201cexplorer.exe\u201d", "the \u201crelease.tmp\u201d file"]}}], "6": [{"establish": {"A": "establish", "S": "The attackers", "O": ["one or several permanent backdoors", "into the environment"]}}], "7": [{"launched": {"A": "launched", "S": "the attackers", "O": ["vulnerability scanners", "at different targets"]}}], "8": [{"collect": {"A": "collect", "O": ["information"]}}, {"Running": {"A": "Running", "O": ["on whole ranges of IP addresses used by the targets", "on several domains", "automated vulnerability scanners"]}}, {"find": {"A": "find", "O": ["server vulnerabilities"]}}], "9": [{"retrieve": {"A": "retrieve", "S": "The bot", "O": ["remote commands"]}, "sends": {"A": "sends", "S": "The bot", "O": ["on \u201c/httpdocs/mm/<bot_id>/ComMand.sec\u201d", "GET requests"]}}, {"is then sent": {"A": "is then sent", "O": ["A Hello packet"]}}], "10": [{"launch": {"A": "launch", "S": "they", "O": ["directly from a c&c server", "vulnerability scanners"]}}], "11": [{"inject": {"A": "inject", "S": "The \u201cieupdate.exe\u201d", "O": ["the DLL", "into \u201cexplorer.exe\u201d"]}}, {"drops": {"A": "drops", "S": "The binary", "O": ["in \u201cC:\\Program Files\\Internet Explorer\u201d", "two files"]}}], "12": [{"gained": {"A": "gained", "S": "Attackers", "O": ["access to one or several machines inside the target\u2019s corporate network"]}}], "13": [{"connected": {"A": "connected", "S": "A computer named CHMXY-PC", "O": ["with IP address 58.61.40.5", "via RDP", "to the c&c"]}}], "14": [{"communicating": {"A": "communicating", "S": "4 malware families"}}], "15": [{"spoofed": {"A": "spoofed", "S": "This e-mail", "O": ["the identity of an employee of a targeted company"]}}], "16": [{"launched": {"A": "launched", "O": ["from one c&c server", "vulnerability scanning", "straight to the targets"]}}], "17": [{"get": {"A": "get", "S": "the Pitty Tiger group", "O": ["from at least one target", "admin credentials"]}}], "18": [{"use": {"A": "use", "S": "the Pitty Tiger group", "O": ["to infect users", "a Microsoft Office Word document which exploits a specific vulnerability"]}}], "19": [{"is": {"A": "is", "S": "The persistence mechanism", "O": ["the creation of a registry key named \u201cShell\u201d containing the path to the malware on the infected system"]}}, {"used": {"A": "used", "S": "the malware", "O": ["The persistence mechanism"]}}, {"send": {"A": "send", "S": "The payload of this malware", "O": ["it", "back to the c&c server"]}}, {"is used": {"A": "is used", "O": ["to collect information on the newly infected host", "The payload of this malware"]}}], "20": [{"crafted": {"A": "crafted", "S": "the attackers", "O": ["a spear phishing e-mail"]}}], "21": [{"write": {"A": "write", "S": "he", "O": ["content", "in the system32 folder of a Windows XP system"]}}, {"has": {"A": "has", "S": "the attacker", "O": ["at least the privileges of a local administrator"]}}], "22": [{"is encrypted": {"A": "is encrypted", "O": ["The data following the header", "with the previous key", "using RC4"]}}], "23": [{"sent": {"A": "sent", "O": ["All the requests", "to the c&c"]}}, {"sending": {"A": "sending", "S": "it", "O": ["its Hello packet", "to its c&c server"]}}], "24": [{"connect": {"A": "connect", "S": "the built malware we found in the same folder", "O": ["to a local IP address"]}}], "25": [{"is simply encoded": {"A": "is simply encoded", "O": ["The data sent", "using base64"]}}], "26": [{"collect": {"A": "collect", "S": "This one", "O": ["system information"]}, "install": {"A": "install", "S": "This one", "O": ["on the infected computer", "more malware"]}, "infect": {"A": "infect", "S": "This one", "O": ["workstations"]}}], "27": [{"looking": {"A": "looking", "S": "they", "O": ["for a means of privilege escalation to facilitate lateral movement within the compromised environment"]}}], "28": [{"be configured": {"A": "be configured", "O": ["Up to 5 c&c servers"]}}], "29": [{"triggering": {"A": "triggering", "S": "a Microsoft Office Word document", "O": ["CVE-2014-1761", "to infect the computer it is sent to"]}}, {"conducted": {"A": "conducted", "S": "the group", "O": ["more advanced spear phishing campaigns"]}}, {"stolen": {"A": "stolen", "O": ["content", "from victims of the group"]}}], "30": [{"was extracted": {"A": "was extracted", "S": "the attackers", "O": ["it", "to \u201cshow\u201d someone what kind of data they could get from the compromise of that particular target"]}}], "31": [{"is": {"A": "is", "S": "Data exfiltration", "O": ["the last step"]}}], "32": [{"resolving": {"A": "resolving", "S": "It", "O": ["after injection", "its domains"]}, "sends": {"A": "sends", "S": "It", "O": ["requests"]}}], "33": [{"use": {"A": "use", "S": "Pitty Tiger", "O": ["extensively", "in order to gain an initial foothold within the targeted environment", "spear phishing e-mails"]}}], "34": [{"acts": {"A": "acts", "S": "It", "O": ["as a first stage downloader"]}, "embedded": {"A": "embedded", "S": "It", "O": ["in Microsoft Office documents"]}}], "35": [{"spreading": {"A": "spreading", "S": "several different documents", "O": ["by triggering CVE-2012-0158 vulnerability", "this malware"]}}], "36": [{"represents": {"A": "represents", "S": "the CGI name", "O": ["the command", "In POST commands"]}}], "37": [{"come": {"A": "come", "S": "Most RDP connections to the c&c infrastructure", "O": ["from Chinese IP ranges in Fuqing (Fujian province, PRC)"]}}, {"used": {"A": "used", "O": ["for the hosting of the c&c domains", "The IP addresses"]}}], "38": [{"send": {"A": "send", "O": ["to the c&c", "commands"]}}], "39": [{"are implemented": {"A": "are implemented", "O": ["in both RATs", "the same commands"]}}], "40": [{"is achieved": {"A": "is achieved", "O": ["by adding the path to the binary to the Winlogon Shell key", "Persistence"]}}, {"embeds": {"A": "embeds", "S": "The RAT", "O": ["its own DNS server IP addresses", "to make the c&c domain names resolutions"]}}], "41": [{"were infecting": {"A": "were infecting", "S": "These documents", "O": ["with Troj/ReRol.A malware", "the system"]}}], "42": [{"initiates": {"A": "initiates", "S": "The malware", "O": ["to time.windows.com", "a communication"]}, "communicates": {"A": "communicates", "S": "The malware", "O": ["with the c&c server", "at mac.avstore.com.tw"]}, "check": {"A": "check", "S": "The malware", "O": ["for connectivity"]}}, {"drops": {"A": "drops", "S": "The binary", "O": ["a copy of itself", "in the Application Data folder of the currently logged-in user"]}}], "43": [{"controlling": {"A": "controlling", "S": "this server", "O": ["infected machines from different targets"]}}], "44": [{"infecting": {"A": "infecting", "S": "The payload", "O": ["the system"]}}], "45": [{"are implemented": {"A": "are implemented", "O": ["The following commands"]}}, {"configured": {"A": "configured", "S": "Our sample", "O": ["3 c&c servers"]}}], "46": [{"is ciphered": {"A": "is ciphered", "O": ["using the MD5 hash of \u201crEdstArs\u201d as the key", "using RC4", "The file"]}}], "47": [{"is often used": {"A": "is often used", "S": "the Pitty Tiger group", "O": ["This remote administration tool"]}}], "48": [{"used": {"A": "used", "S": "this group of attackers", "O": ["three c&c servers"]}}], "49": [{"rely": {"A": "rely", "S": "The attackers", "O": ["on spear phishing and drive-by downloads"]}}], "50": [{"dump": {"A": "dump", "S": "the attackers", "O": ["all the Active Directory content"]}, "gain": {"A": "gain", "S": "the attackers", "O": ["domain administrator privileges"]}}], "51": [{"receive": {"A": "receive", "S": "The RAT", "O": ["commands", "from its c&c"]}}], "52": [{"use": {"A": "use", "S": "Some groups of attackers", "O": ["\u201cwatering hole\u201d techniques", "to successfully compromise their targets"]}}], "53": [{"used": {"A": "used", "S": "the attackers", "O": ["The c&c servers"]}}], "54": [{"sends": {"A": "sends", "S": "the RAT", "O": ["to its c&c", "a first login packet"]}}, {"is performed": {"A": "is performed", "O": ["through HTTP requests", "The RAT communication"]}}, {"is achieved": {"A": "is achieved", "O": ["via the following registry key", "Persistence"]}}], "55": [{"is using": {"A": "is using", "S": "the Pitty Tiger group", "O": ["stolen material", "as spear phishing content"]}}], "56": [{"stealing": {"A": "stealing", "S": "The attackers", "O": ["more information"]}, "stay": {"A": "stay", "S": "The attackers", "O": ["inside the network", "for more data gathering"]}}], "57": [{"uses": {"A": "uses", "S": "this malware", "O": ["to communicate", "the same patterns"]}}], "58": [{"been scanned": {"A": "been scanned", "O": ["some other targets", "for very specific vulnerabilities, like a ZyWALL vulnerability or a FORTINET product"]}}, {"been scanned": {"A": "been scanned", "O": ["with \u201cgeneric\u201d vulnerability scanning tools like HScan or Fluxay and port scanners like Nmap", "some targets"]}}], "59": [{"drops": {"A": "drops", "S": "This one", "O": ["in turn the following file"]}}, {"is then copied": {"A": "is then copied", "O": ["This tmp file", "to \u201cC:\\Windows\\system32\\Nwsapagentex.dll\u201d"]}, "registered": {"A": "registered", "O": ["This tmp file", "as a service called \u201cNwsapagent\u201d"]}}, {"drops": {"A": "drops", "S": "The shellcode contained in the Word file", "O": ["the following file"]}, "executes": {"A": "executes", "S": "The shellcode contained in the Word file", "O": ["it"]}}], "60": [{"contains": {"A": "contains", "S": "It", "O": ["the internal IP address"]}}], "61": [{"injects": {"A": "injects", "S": "It", "O": ["it", "in \u201cexplorer.exe\u201d"]}, "drops": {"A": "drops", "S": "It", "O": ["the \u201cpacket64.dll\u201d"]}}], "62": [{"infects": {"A": "infects", "S": "the exploit", "O": ["the host"]}, "executing": {"A": "executing", "S": "the exploit"}, "dropping": {"A": "dropping", "S": "the exploit"}}], "63": [{"provide": {"A": "provide", "O": ["with the right content", "it"]}}, {"target": {"A": "target", "O": ["the right victim"]}}, {"open": {"A": "open", "S": "they", "O": ["an attached file which will infect their computer"]}, "click": {"A": "click", "S": "they", "O": ["on a link leading to drive-by download of a malware"]}}], "64": [{"create": {"A": "create", "S": "They", "O": ["archive files containing the content they want to exfiltrate"]}, "are then sent": {"A": "are then sent", "O": ["archive files containing the content they want to exfiltrate"]}}], "65": [{"is sent": {"A": "is sent", "O": ["encrypted with RC4, and base64-encoded", "The data"]}}], "66": [{"compromise": {"A": "compromise", "O": ["visitors coming from the target IP ranges"]}}], "67": [{"be described": {"A": "be described", "O": ["Spear phishing", "as targeted e-mail phishing"]}}], "68": [{"use": {"A": "use", "S": "Pitty Tiger", "O": ["fake Microsoft Office Excel content"]}}], "69": [{"used": {"A": "used", "S": "The two computers FLY-THINK and 50PZ80C-1DFDCB8", "O": ["to connect to the c&c", "distinct IP addresses"]}}], "70": [{"dropping": {"A": "dropping", "S": "a payload", "O": ["a malware"]}}], "71": [{"send": {"A": "send", "S": "POST requests", "O": ["data"]}}, {"are used": {"A": "are used", "O": ["GET requests", "to receive data from the c&c"]}}], "72": [{"been using": {"A": "been using", "S": "The attackers", "O": ["different vulnerability scanners aimed at their targets"]}}], "73": [{"be remotely requested": {"A": "be remotely requested", "O": ["to manage the bots", "the c&c part of this RAT"]}}], "74": [{"shows": {"A": "shows", "S": "it", "O": ["running services"]}}, {"collected": {"A": "collected", "S": "the malware", "O": ["information"]}}], "75": [{"were done": {"A": "were done", "S": "a computer named TIEWEISHIPC with IP address 27.16.139.143", "O": ["A few connections to the c&c"]}}], "76": [{"collect": {"A": "collect", "S": "attackers", "O": ["from chunks of memory from the targeted machine", "data"]}}], "77": [{"are used": {"A": "are used", "O": ["requests", "to check for updates (GET request on /httpdocs/update/update.ini)"]}}], "78": [{"uses": {"A": "uses", "S": "Our sample", "O": ["\u201cmca.avstore.com.tw\u201d, \u201cstar.yamn.net\u201d and \u201cbz.kimoo.com.tw\u201d", "as c&c servers"]}}], "79": [{"is achieved": {"A": "is achieved", "O": ["by adding the path to the binary to the WinlogonUserInit key", "Persistence"]}}], "80": [{"send": {"A": "send", "S": "attackers", "O": ["to targeted people", "In a spear phishing scheme", "very few e-mails"]}}], "81": [{"been targeted": {"A": "been targeted", "O": ["with this document", "Someone from another company"]}}], "82": [{"gain": {"A": "gain", "S": "He", "O": ["the credentials to a sensitive e-mail account"]}}], "83": [{"used": {"A": "used", "S": "the Pitty Tiger crew", "O": ["another remote administration tool"]}}], "84": [{"install": {"A": "install", "S": "They", "O": ["several different backdoors", "in order to be able to always access the network"]}}], "85": [{"exploiting": {"A": "exploiting", "S": "one such document used by that group of attacker", "O": ["CVE- 2012-0158, an old critical vulnerability impacting Microsoft Office and corrected by Microsoft\u2019s MS12-027 fix in April 2012"]}}], "86": [{"is": {"A": "is", "S": "The \u201cqmgrxp.exe\u201d binary", "O": ["a simple copy of the original binary"]}}, {"drops": {"A": "drops", "S": "The binary", "O": ["two files", "in \u201cC:\\Windows\\System32\u201d"]}}], "87": [{"infect": {"A": "infect", "S": "Pitty Tiger", "O": ["with their malware", "computers"]}}], "88": [{"is then infected": {"A": "is then infected", "O": ["Every visitor of the compromised third party"]}}], "89": [{"communicating": {"A": "communicating", "S": "Six malware families", "O": ["with subdomains of skypetm.com.tw"]}}], "90": [{"compromise": {"A": "compromise", "S": "attackers", "O": ["To build a watering hole attack", "the website of a third party, generally a supplier of the target, which is typically visited by a specific group of professionals and very likely by the target"]}}], "91": [{"executing": {"A": "executing", "S": "a user \u201cToot\u201d", "O": ["some commands"]}}], "92": [{"leading": {"A": "leading", "S": "this malware sample", "O": ["to a command & control (c&c) server still in activity"]}}], "93": [{"using": {"A": "using", "S": "some real connections to a victim", "O": ["this RAT"]}}], "94": [{"spear phish": {"A": "spear phish", "S": "Pitty Tiger", "O": ["other companies which are in commercial relation with this web development company"]}}], "95": [{"brute-force": {"A": "brute-force", "S": "a file named user.txt", "O": ["a shared folder access"]}}], "96": [{"was dropped": {"A": "was dropped", "S": "a malicious Word document", "O": ["The binary we found"]}}], "97": [{"originated": {"A": "originated", "S": "Some connections to the c&c", "O": ["from a computer named FLY-THINK with several IP addresses, all located in Fuqing (Fujian province)"]}}], "98": [{"sent": {"A": "sent", "O": ["in the POST request", "The data"]}}], "99": [{"execute": {"A": "execute", "S": "It"}, "download": {"A": "download", "S": "It"}}], "100": [{"is created": {"A": "is created", "O": ["a mutex called \u201cPittyTiger\u201d"]}}], "101": [{"embedding": {"A": "embedding", "S": "one RTF document", "O": ["CVE-2014-1761"]}}], "102": [{"be requested": {"A": "be requested", "S": "the bot", "O": ["The following CGI files"]}}], "103": [{"used": {"A": "used", "S": "the Pitty Tiger group", "O": ["another remote administration tool"]}}]}, "putter-panda.tokens": {"0": [{"receiving": {"A": "receiving", "O": ["from the server", "data"]}}, {"processing": {"A": "processing", "O": ["commands"]}}, {"decrypting": {"A": "decrypting", "O": ["data"]}}], "1": [{"uses": {"A": "uses", "S": "The initial beacon", "O": ["to register the implant with the C2 server", "a request with four parameters (h1, h2, h3, and h4)"]}}], "2": [{"occurs": {"A": "occurs", "S": "C2", "O": ["over HTTP", "after connectivity has been verified by making a distinctive request (to the URI / search?qu= at www.google.com)"]}}], "3": [{"disguise": {"A": "disguise", "S": "The dropped executable (MD5 hash 38a2a6782e1af29ca8cb691cf0d29a0d)", "O": ["the malicious activity"]}, "inject": {"A": "inject", "S": "The dropped executable (MD5 hash 38a2a6782e1af29ca8cb691cf0d29a0d)", "O": ["the specified DLL (McUpdate.dll, MD5 hash 08c7b5501df060ccfc3aa5c8c41b452f)", "into a process that would normally be accessing the network"]}}], "4": [{"execute": {"A": "execute", "S": "The malware", "O": ["via the WinExec API", "this file"]}, "download": {"A": "download", "S": "The malware", "O": ["to the filename within the user\u2019s temporary directory", "from the specified URL", "content"]}}], "5": [{"be made": {"A": "be made", "O": ["to a URL using the same path as the initial request (and a similarly random parameter)", "a final C2 request"]}}], "6": [{"uses": {"A": "uses", "S": "the httpclient malware", "O": ["HTTP", "for its C2 channel"]}}], "7": [{"is started": {"A": "is started", "O": ["a shell process", "with input/output redirected over the C2 channel"]}}], "8": [{"installing": {"A": "installing", "S": "Another dropper", "O": ["the pngdowner malware (example MD5 hash 4c50457c35e2033b3a03fcbb4adac7b7)"]}}], "9": [{"are written": {"A": "are written", "O": ["to disk", "Both the document and executable"]}, "executed": {"A": "executed", "O": ["via the ShellExecute             API (using the verb \u201copen\u201d)", "Both the document and executable"]}}], "10": [{"deploy": {"A": "deploy", "S": "This toolset", "O": ["additional tools", "at will"]}, "provides": {"A": "provides", "S": "This toolset", "O": ["a wide degree of control over a victim system"]}}], "11": [{"is then made": {"A": "is then made", "O": ["An initial request", "to the hard-coded C2 server and initial URI"]}}], "12": [{"obfuscated": {"A": "obfuscated", "O": ["with a 16-byte XOR key (consisting of the bytes 0xA0 \u2013 0xAF)", "The executable and DLL"]}}], "13": [{"retrieve": {"A": "retrieve", "S": "the RAT", "O": ["using a further distinctive HTTP request shown in Figure 13", "from the controller", "tasking"]}}], "14": [{"use": {"A": "use", "S": "the actors", "O": ["including several Remote Access Tools (RATs)", "a wide set of tools"]}}], "15": [{"use": {"A": "use", "S": "The RAT", "O": ["a byte-wise subtraction- based algorithm (using a hard-coded modulo value)", "to decode C2 server details consisting of a server hostname and port number, in this example nsc.adomhn. com, port 80"]}}], "16": [{"perform": {"A": "perform", "S": "the malware", "O": ["to a hard-coded URL (http://www.microsoft.com)", "using a constant user agent Mozilla/4.0 (Compatible; MSIE 6.0;)", "a connectivity check"]}}], "17": [{"create": {"A": "create", "S": "the RAT", "O": ["a file mapping named &*SDKJfhksdf89*DIUKJDSF&*sdfsdf78sdfsdf"]}}], "18": [{"connect": {"A": "connect", "S": "The malware", "O": ["to its configured C2 infrastructure (file.anyoffice.info)"]}, "perform": {"A": "perform", "S": "The malware", "O": ["a HTTP request of the form shown in Figure 14 below"]}}], "19": [{"is made": {"A": "is made", "O": ["An initial request", "to the C2 server"]}}, {"serves": {"A": "serves", "S": "this request", "O": ["as a connectivity check"]}}], "20": [{"download": {"A": "download", "O": ["file"]}}, {"upload": {"A": "upload", "O": ["file"]}}, {"are supported": {"A": "are supported", "O": ["two other commands"]}}], "21": [{"is also installed": {"A": "is also installed", "O": ["with a value named McUpdate", "into the ASEP registry key HKCU\\Software\\Microsoft\\Windows\\ CurrentVersion\\Run", "The executable"]}}], "22": [{"extract": {"A": "extract", "S": "the malware", "O": ["from the IE Credentials Store", "from Windows Protected Storage", "using publicly known methods15", "proxy details and credentials"]}}], "23": [{"is encrypted": {"A": "is encrypted", "O": ["in the same manner as it was decrypted", "Output data produced by tasking instructions"]}, "sent": {"A": "sent", "O": ["via HTTP POST request to a URI of the form /microsoft/errorpost/ default.aspx?ID=", "Output data produced by tasking instructions", "back to the C2 server"]}}], "24": [{"is generated": {"A": "is generated", "O": ["A victim identifier", "from the infected machine\u2019s hard disk serial number"]}}], "25": [{"register": {"A": "register", "S": "this request", "O": ["a new victim machine", "with the controller"]}}], "26": [{"performs": {"A": "performs", "S": "This malware", "O": ["a connectivity check", "using the hard-coded user agent Mozilla/4.0 (Compatible; MSIE 6.0;)", "to www.microsoft.com"]}}], "27": [{"executing": {"A": "executing", "S": "This dropper", "O": ["it"]}, "writing": {"A": "writing", "S": "This dropper", "O": ["the payload", "to disk"]}}], "28": [{"sleeping": {"A": "sleeping", "S": "the RAT", "O": ["until a certain date/time"]}, "supported": {"A": "supported", "S": "the RAT", "O": ["The set of commands"]}}], "29": [{"conduct": {"A": "conduct", "S": "the PUTTER PANDA actors", "O": ["intelligence-gathering operations"]}, "are used": {"A": "are used", "S": "the PUTTER PANDA actors", "O": ["The RATs"]}}], "30": [{"using": {"A": "using", "S": "the C2 protocol", "O": ["GET"]}, "is": {"A": "is", "S": "the C2 protocol", "O": ["HTTP based"]}}, {"used": {"A": "used", "S": "the 3PARA RAT", "O": ["the C2 protocol"]}}], "31": [{"transmit": {"A": "transmit", "S": "the RAT", "O": ["some basic victim information to the C2 server", "along with a 256-byte hash of the hard-coded string HYF54&%9&jkMCXuiS"]}}], "32": [{"is repeated": {"A": "is repeated", "O": ["every 0.5 seconds", "the C2 request"]}}], "33": [{"supported": {"A": "supported", "S": "the RAT", "O": ["The commands"]}}], "34": [{"used": {"A": "used", "O": ["some of the domains", "for command and control of the tools described later in this report"]}}], "35": [{"be used": {"A": "be used", "O": ["These", "for command and control of PUTTER PANDA tools"]}}], "36": [{"install": {"A": "install", "S": "a dropper", "O": ["the 4H RAT"]}}, {"used": {"A": "used", "S": "PUTTER PANDA", "O": ["a dropper"]}}], "37": [{"terminate": {"A": "terminate", "S": "the malware", "O": ["processes corresponding to two components of Sophos Anti-Virus (SAVAdminService.exe and SavService.exe)"]}}], "38": [{"are used": {"A": "are used", "S": "PUTTER PANDA", "O": ["Several RATs"]}}], "39": [{"load": {"A": "load", "S": "the RAT", "O": ["from a file C:\\RECYCLER\\restore.dat", "a binary representation of a date/time value"]}}, {"sleep": {"A": "sleep", "S": "it", "O": ["until after this date/time has passed"]}}], "40": [{"remain": {"A": "remain", "S": "the RAT", "O": ["until a fixed time", "dormant"]}}], "41": [{"delete": {"A": "delete", "S": "the malware", "O": ["the content saved from the first request"]}}], "42": [{"provides": {"A": "provides", "S": "their toolset", "O": ["a wide degree of control over a victim system"]}, "deploy": {"A": "deploy", "S": "their toolset", "O": ["additional tools", "at will"]}}], "43": [{"been associated": {"A": "been associated", "O": ["with the PUTTER PANDA toolset", "Two droppers"]}}], "44": [{"using": {"A": "using", "S": "these droppers", "O": ["a mixture of decoy PDF and Microsoft Word documents"]}}], "45": [{"is obfuscated": {"A": "is obfuscated", "O": ["Communication to and from the C2 server", "using a 1-byte XOR with the key 0xBE"]}}], "46": [{"is used": {"A": "is used", "O": ["as a simple download- and-execute utility", "it"]}}], "47": [{"deploy": {"A": "deploy", "S": "\u0007They", "O": ["through targeted email attacks", "custom malware"]}}], "48": [{"is used": {"A": "is used", "O": ["This", "to prevent multiple instances of the RAT being executed simultaneously"]}}], "49": [{"deletes": {"A": "deletes", "S": "the dropper", "O": ["via a batch file", "itself"]}}], "50": [{"deploy": {"A": "deploy", "S": "They", "O": ["custom malware", "through targeted email attacks"]}}], "51": [{"characterizes": {"A": "characterizes", "S": "A series of HTTP requests", "O": ["the RAT\u2019s C2"]}}]}, "regin-analysis.tokens": {"0": [{"be installed": {"A": "be installed", "O": ["through a web browser", "the threat", "by exploiting an application"]}}], "1": [{"monitor": {"A": "monitor", "S": "one module", "O": ["network traffic to Microsoft Internet Information Services (IIS) web servers"]}}, {"parsing": {"A": "parsing", "S": "another", "O": ["mail from Exchange databases"]}}, {"collect": {"A": "collect", "S": "another", "O": ["administration traffic for mobile telephony base station controllers"]}}], "2": [{"capturing": {"A": "capturing", "O": ["screenshots"]}}, {"include": {"A": "include", "S": "The threat\u2019s standard capabilities", "O": ["several remote access Trojan (RAT) features"]}}, {"taking": {"A": "taking", "O": ["control of the mouse\u2019s point-and-click functions"]}}], "3": [{"originated": {"A": "originated", "S": "Regin", "O": ["from Yahoo! Instant Messenger", "through an unconfirmed exploit"]}}], "4": [{"happen": {"A": "happen", "S": "All communications", "O": ["in a two-stage fashion"]}}, {"instruct": {"A": "instruct", "S": "the attacker", "O": ["it"]}, "contact": {"A": "contact", "S": "the attacker", "O": ["using one channel", "a compromised computer"]}}, {"begin": {"A": "begin", "S": "it", "O": ["communications", "on a different channel"]}}, {"are strongly encrypted": {"A": "are strongly encrypted", "O": ["All communications"]}}], "5": [{"be encoded and embedded": {"A": "be encoded and embedded", "O": ["Payload information", "within cookie data"]}}], "6": [{"stealing": {"A": "stealing", "S": "module", "O": ["The IIS web server log"]}}, {"was installed": {"A": "was installed", "O": ["a payload module"]}}, {}], "7": [{"looks": {"A": "looks", "S": "Stage 1", "O": ["for the last partition (in terms of physical location) on disk"]}, "searches": {"A": "searches", "S": "Stage 1", "O": ["for the payload", "in the raw sectors in this area of the disk"]}}], "8": [{"loaded": {"A": "loaded", "S": "Stage 1", "O": ["as a Winsock helper", "when the computer is starting up"]}}], "9": [{"is encrypted": {"A": "is encrypted", "O": ["within an extended attribute or registry key blob", "this file"]}}], "10": [{"implicated": {"A": "implicated", "S": "it", "O": ["in data collection operations against government organizations, infrastructure operators, businesses, academics, and private individuals"]}}, {"is": {"A": "is", "S": "The main purpose of Regin", "O": ["intelligence gathering"]}}], "11": [{"serve": {"A": "serve", "S": "compromised computers", "O": ["as a proxy for other infections"]}}, {"happen": {"A": "happen", "S": "command and control", "O": ["in a peer-to-peer fashion"]}}], "12": [{"drops": {"A": "drops", "S": "This stage", "O": ["the file msrdc64.dat"]}}], "13": [{"hide": {"A": "hide", "S": "This stage", "O": ["running instances of Stage 1"]}}, {"be found encrypted": {"A": "be found encrypted", "O": ["Stage 2"]}}], "14": [{"stores": {"A": "stores", "S": "Regin", "O": ["data files and payloads", "in encrypted virtual file system files", "on disk"]}}], "15": [{"remaining": {"A": "remaining", "S": "It", "O": ["under the radar"]}, "sustain": {"A": "sustain", "S": "It", "O": ["long-term intelligence-gathering operations"]}}], "16": [{"are injected": {"A": "are injected", "S": "Stage 4", "O": ["into services.exe", "The files for Stage 5"]}}], "17": [{"retrieve": {"A": "retrieve", "S": "It", "O": ["them"]}}, {"scan": {"A": "scan", "O": ["for deleted files on an infected computer"]}}], "18": [{"initiate": {"A": "initiate", "S": "the attackers", "O": ["on the border network", "communications", "with compromised computers"]}}, {"initiate": {"A": "initiate", "S": "the compromised computers", "O": ["communications", "with the attacker"]}}, {"are": {"A": "are", "S": "backchannel operations", "O": ["bidirectional"]}}], "19": [{"is stealing": {"A": "is stealing", "S": "it", "O": ["the data"]}, "hide": {"A": "hide", "S": "Regin", "O": ["the data"]}}], "20": [{"is encrypted and compressed": {"A": "is encrypted and compressed", "O": ["it"]}}], "21": [{"load": {"A": "load", "S": "kernel drivers", "O": ["the driver"]}}], "22": [{"gather": {"A": "gather", "S": "Regin", "O": ["information on processes and memory utilization"]}, "monitor": {"A": "monitor", "S": "Regin", "O": ["network traffic"]}, "steal": {"A": "steal", "S": "Regin", "O": ["passwords"]}}], "23": [{"finds and loads": {"A": "finds and loads", "S": "Stage 2", "O": ["an encrypted version of Stage 3", "from either NTFS extended attributes or a registry key blob"]}}], "24": [{"been used": {"A": "been used", "O": ["for large-scale data collection or intelligence gathering campaigns", "Regin"]}}], "25": [{"are encrypted": {"A": "are encrypted", "O": ["the files"]}}], "26": [{"is encrypted": {"A": "is encrypted", "O": ["within an extended attribute or a registry key blob", "Stage 2"]}}], "27": [{"logs": {"A": "logs", "S": "Regin", "O": ["data", "to the ApplicationLog.dat file"]}}], "28": [{"is often not written": {"A": "is often not written", "O": ["to disk", "Valuable target data"]}}], "29": [{"receive": {"A": "receive", "S": "Regin", "O": ["after infection", "payload modules"]}}, {"be distributed": {"A": "be distributed", "O": ["Regin", "with various payload modules"]}}], "30": [{"is": {"A": "is", "S": "Stage 1", "O": ["the initial load point for the threat"]}}], "31": [{"load and execute": {"A": "load and execute", "S": "kernel drivers", "O": ["Stage 2"]}}], "32": [{"is executed": {"A": "is executed", "O": ["from a set of registry keys", "Stage 2"]}}], "33": [{"is": {"A": "is", "S": "The encryption mode", "O": ["reverse cipher feedback (CFB)"]}}], "34": [{"monitoring": {"A": "monitoring", "S": "It", "O": ["of targeted organizations or individuals"]}, "is used": {"A": "is used", "S": "It", "O": ["for the collection of data"]}}], "35": [{"stealing": {"A": "stealing", "S": "Regin", "O": ["data"]}, "monitoring": {"A": "monitoring", "S": "Regin", "O": ["targets"]}}], "36": [{"monitor": {"A": "monitor", "S": "Stage 2", "O": ["the state of the threat"]}}], "37": [{"retrieve": {"A": "retrieve", "S": "a file", "O": ["binary data", "over pipes"]}, "execute": {"A": "execute", "S": "a file", "O": ["the data"]}}, {}], "38": [{"execute": {"A": "execute", "S": "it", "O": ["Stage 1"]}, "install": {"A": "install", "S": "it", "O": ["Stage 1"]}}, {}], "39": [{"are stored": {"A": "are stored", "O": ["as encrypted data blobs", "All other stages"]}}], "40": [{"installing": {"A": "installing", "S": "Regin", "O": ["a large number of additional payloads"]}}], "41": [{"reads and executes": {"A": "reads and executes", "S": "Stage 1", "O": ["Stage 2", "from a set of NTFS extended attributes"]}}], "42": [{"conceal": {"A": "conceal", "S": "It", "O": ["itself and its activities on compromised computers"]}}], "43": [{"loading and executing": {"A": "loading and executing", "S": "Stage 3", "O": ["Stage 4"]}}], "44": [{"are encrypted": {"A": "are encrypted", "O": ["Files stored inside EVFS containers", "using 64-bit blocks and 20 rounds", "with a variant of RC5"]}}], "45": [{"makes": {"A": "makes", "S": "The modular design", "O": ["analysis of the threat difficult"]}}], "46": [{"involve": {"A": "involve", "S": "The initial stages", "O": ["the installation and configuration of the threat\u2019s internal services"]}}], "47": [{"setting up": {"A": "setting up", "S": "Stage 0", "O": ["various extended attributes and/or registry keys and values that hold encoded versions of stages 2, 3, and potentially stages 4 and onwards"]}}], "48": [{"extracts, installs and runs": {"A": "extracts, installs and runs", "S": "Stage 2", "O": ["Stage 3"]}}, {}], "49": [{"seek": {"A": "seek", "S": "APTs", "O": ["specific information, usually intellectual property"]}}], "50": [{"are undertaken": {"A": "are undertaken", "S": "various modules", "O": ["The C&C operations"]}}], "51": [{"cleaned up": {"A": "cleaned up", "S": "the attackers who operated Regin", "O": ["compromised computers"]}}], "52": [{"be encoded and embedded": {"A": "be encoded and embedded", "O": ["in lieu of legitimate ICMP/ping data", "Payload information"]}}], "53": [{"are loaded": {"A": "are loaded", "S": "Stage 3", "O": ["The files for Stage 4"]}}], "54": [{"are": {"A": "are", "S": "Regin\u2019s C&C operations", "O": ["extensive"]}}], "55": [{}]}, "Regis_The_Intercept.tokens": {"0": [{"include": {"A": "include", "S": "These modules"}, "encrypted": {"A": "encrypted", "S": "These modules", "O": ["communications"]}}, {"detects": {"A": "detects", "S": "a self-defense engine", "O": ["attempts to detect the toolkit"]}}], "1": [{"disinfect": {"A": "disinfect", "S": "Stage 2", "O": ["On failure", "the compromised device"]}}], "2": [{"disguise": {"A": "disguise", "S": "the loaders", "O": ["their presence on the system"]}, "appear": {"A": "appear", "S": "the loaders", "O": ["less suspicious", "to host intrusion detection systems"]}, "Mimicking": {"A": "Mimicking", "S": "the loaders", "O": ["Microsoft drivers"]}}, {"are disguised as": {"A": "are disguised as", "S": "The Regin loaders", "O": ["Microsoft drivers"]}}], "3": [{"loaded": {"A": "loaded", "S": "a Regin driver", "O": ["a sample"]}}, {"provide": {"A": "provide", "S": "it", "O": ["for the tool kit", "stealth functionality"]}}], "4": [{"steal": {"A": "steal", "S": "GCHQ", "O": ["data"]}}, {"giving": {"A": "giving", "S": "a malware attack", "O": ["total control of their systems"]}, "infecting": {"A": "infecting", "S": "a malware attack", "O": ["the employees\u2019 computers"]}}], "5": [{"disguises": {"A": "disguises", "S": "The malware", "O": ["itself", "as legitimate Microsoft software"]}, "steals": {"A": "steals", "S": "The malware", "O": ["from infected systems", "data"]}}], "6": [{"loads": {"A": "loads", "S": "It", "O": ["the next parts of the malware"]}, "initializes": {"A": "initializes", "S": "It", "O": ["the core components of the architecture"]}}], "7": [{"checks": {"A": "checks", "S": "This Regin driver", "O": ["the current IRQL (Interrupt Request Level)"]}}], "8": [{"cleans": {"A": "cleans", "S": "it", "O": ["traces of the initial loader"]}, "monitors": {"A": "monitors", "S": "it", "O": ["its execution"]}, "loads": {"A": "loads", "S": "it", "O": ["the next part of the toolkit"]}}], "9": [{"check for": {"A": "check for", "S": "The driver", "O": ["specific builds of the Windows kernel in use"]}, "adapts": {"A": "adapts", "S": "The driver", "O": ["its behavior"]}}], "10": [{"zeroes out": {"A": "zeroes out", "S": "The malware", "O": ["its PE (Portable Executable, the Windows executable format) headers in memory"]}, "replacing": {"A": "replacing", "S": "The malware", "O": ["\u201cMZ\u201d", "with its own magic marker 0xfedcbafe"]}}], "11": [{"frustrate": {"A": "frustrate", "S": "malware", "O": ["analysis"]}, "avoid": {"A": "avoid", "S": "malware", "O": ["detection"]}}], "12": [{"act as": {"A": "act as", "S": "The first stage", "O": ["loaders for a second stage"]}}], "13": [{"was dumped": {"A": "was dumped", "O": ["the file", "from memory"]}}], "14": [{"loads and executes": {"A": "loads and executes", "S": "this stage", "O": ["Stage 2"]}}], "15": [{"zeroes": {"A": "zeroes", "S": "the driver", "O": ["the content"]}, "avoid": {"A": "avoid", "S": "the driver", "O": ["leaving traces in pool memory"]}}], "16": [{"remove": {"A": "remove", "S": "the driver", "O": ["remaining traces and artifacts"]}}], "17": [{"access": {"A": "access", "S": "programs", "O": ["information stored in the computer\u2019s memory"]}}], "18": [{"conduct": {"A": "conduct", "S": "The implants", "O": ["surveillance of internal Belgacom company communications"]}, "gather": {"A": "gather", "S": "The implants", "O": ["data"]}}], "19": [{"gained": {"A": "gained", "S": "GCHQ", "O": ["access to Belgacom\u2019s internal systems"]}}], "20": [{}]}, "sec14-paper-marczak.tokens": {"0": [{"talked": {"A": "talked", "S": "Xtreme RAT", "O": ["to the same C&C server"]}}, {"received": {"A": "received", "S": "Ahmed", "O": ["an e-mail containing an attachment", "with Xtreme RAT"]}}], "1": [{"include": {"A": "include", "S": "The attacks", "O": ["the use of \u201cIP spy\u201d links to deanonymize those who voice dissent"]}}], "2": [{"involved": {"A": "involved", "S": "The first attacks", "O": ["a government-grade \u201clawful interception\u201d trojan known as Re- mote Control System (RCS), sold by the Italian company Hack- ing Team"]}}], "3": [{"records": {"A": "records", "S": "ReadNotify.com", "O": ["the user\u2019s IP address", "upon their mail client downloading the remote image"]}}, {"sent": {"A": "sent", "S": "The attacker", "O": ["the e-mails", "using ReadNotify.com"]}}], "4": [{"received": {"A": "received", "S": "they", "O": ["suspi- cious e-mails", "that contained a Word docu- ment corresponding to the first stage of 3-Stage Exploit Kit"]}}, {"used": {"A": "used", "S": "spyware subse- quently sent to others", "O": ["bait content about Ahmed"]}}], "5": [{"obtain": {"A": "obtain", "S": "The attacks we have documented", "O": ["from a device", "information"]}, "involve": {"A": "involve", "S": "The attacks we have documented", "O": ["the use of malicious links or e-mail attachments"]}}], "6": [{"including": {"A": "including", "S": "the same ba- sic functionality", "O": ["file exfiltration"]}}], "7": [{"loads": {"A": "loads", "S": "a compiled Visual Basic project", "O": ["via the RunPE method", "an executable packed with UPX"]}}], "8": [{"talked": {"A": "talked", "S": "an Arabic-language bait document about Omani poetry", "O": ["to a C&C in the UK"]}}, {"contained": {"A": "contained", "S": "an FS- BSpy sample", "O": ["an Arabic-language bait document about Omani poetry"]}}], "9": [{"propa- gate": {"A": "propa- gate", "S": "The RCS samples we examined", "O": ["by modifying the disk image", "onto USB flash drives", "to other devices", "into inactive VMWare virtual machines", "onto Windows Mobile phones"]}}], "10": [{"used": {"A": "used", "S": "The executables", "O": ["virtualized obfusca- tion"]}}], "11": [{"exfiltrate": {"A": "exfiltrate", "O": ["back to the C&C server", "data"]}}, {"writes": {"A": "writes", "S": "a module", "O": ["it", "to disk in a special folder"]}, "encrypts": {"A": "encrypts", "S": "a module"}}], "12": [{"communicated": {"A": "communicated", "S": "FSBSpy samples on Virus- Total uploaded from these countries", "O": ["with servers in these groups"]}}, {"talked": {"A": "talked", "S": "A sample of FSBSpy", "O": ["to one of the servers in this group"]}}], "13": [{"uses": {"A": "uses", "S": "FinSpy\u2019s wire protocol for C&C commu- nication", "O": ["the same type of encryption"]}}], "14": [{"sent": {"A": "sent", "S": "An account linked to al9mood", "O": ["an IP spy link", "in a public message", "on 10/2/12", "Je- had Abdulla"]}}], "15": [{"include": {"A": "include", "S": "the attacks", "O": ["fake or ma- liciously packaged security tools; intriguing, or ideological, or movement-relevant content (e.g. lists of wanted persons)"]}}], "16": [{"seeds": {"A": "seeds", "S": "the attacker", "O": ["mal- ware", "via private chat messages, posts in opposition-controlled social media groups, or e-mail"]}}], "17": [{"forwarded": {"A": "forwarded", "S": "each group", "O": ["to only a sin- gle server"]}}, {"forwarded": {"A": "forwarded", "S": "a group", "O": ["to two different IPs"]}}], "18": [{"entices": {"A": "entices", "S": "The third attack", "O": ["tar- gets", "with e-mails purporting to contain or link to videos about the current conflict"]}, "infecting": {"A": "infecting", "S": "The third attack", "O": ["with Xtreme RAT", "victims"]}, "using": {"A": "using", "S": "The third attack", "O": ["the C&C tn1.linkpc.net"]}}], "19": [{"are generated": {"A": "are generated", "O": ["by repeatedly reading the low-order-4-bytes of the Windows clock", "The 32 byte AES key and 16 byte IV"]}}], "20": [{"was sent": {"A": "was sent", "O": ["NGO Worker D", "a shortened link (url[.] no/Uu5) to a download from a directory of Mrconstrucciones[.] net"]}}, {"received": {"A": "received", "S": "Opp. Member C", "O": ["as an e-mail attachment", "a malicious file"]}}], "21": [{"were obfuscated": {"A": "were obfuscated", "O": ["some Windows samples", "to look like the PuTTY SSH client"]}}], "22": [{"report": {"A": "report", "S": "a piece of malware", "O": ["system information"]}, "upload": {"A": "upload", "S": "a piece of malware", "O": ["screenshots"]}, "drop and execute": {"A": "drop and execute", "S": "a piece of malware", "O": ["more malware"]}}], "23": [{"adds": {"A": "adds", "S": "the RCS sample sent to Ahmed", "O": ["a Run registry key"]}}, {"injects": {"A": "injects", "S": "the spyware", "O": ["into OS processes", "itself", "as they start"]}}, {"modify": {"A": "modify", "S": "the FinSpy samples used in Bahrain", "O": ["the boot process"]}, "overwrite": {"A": "overwrite", "S": "the FinSpy samples used in Bahrain", "O": ["the hard disk\u2019s boot sector"]}}, {"is loaded": {"A": "is loaded", "O": ["be- fore the OS", "the spyware"]}}], "24": [{"over- writes": {"A": "over- writes", "S": "It", "O": ["the files"]}, "renames": {"A": "renames", "S": "It", "O": ["them", "several times"]}, "frustrate": {"A": "frustrate", "S": "It", "O": ["forensic analysis"]}, "deletes": {"A": "deletes", "S": "It", "O": ["them"]}}], "25": [{"download": {"A": "download", "S": "the spyware", "O": ["additional modules", "from a command & control (C&C) server"]}}, {"including": {"A": "including", "O": ["input from", "the computer\u2019s micro- phone"]}}, {"including": {"A": "including", "O": ["Skype chat"]}}, {"including": {"A": "including", "O": ["password cap- ture (from over 20 applications)"]}}, {"including": {"A": "including", "O": ["recording of screenshots"]}}, {"including": {"A": "including", "O": ["file transfers"]}}], "26": [{"communicated": {"A": "communicated", "S": "The samples", "O": ["with 77.69.140.194"]}}], "27": [{"downloaded": {"A": "downloaded", "S": "a second stage", "O": ["from maile-s.com", "a sam- ple of SpyNet"]}}, {"downloaded": {"A": "downloaded", "S": "The exploit", "O": ["a second stage"]}}], "28": [{"communicated": {"A": "communicated", "S": "The RCS samples", "O": ["with domains with lapsed registra- tions"]}}], "29": [{"are encrypted": {"A": "are encrypted", "O": ["using an em- bedded RSA-2048 public key", "The key and IV"]}}], "30": [{"thwarted": {"A": "thwarted", "S": "it", "O": ["our attempts to attach debuggers"]}}, {"employed": {"A": "employed", "S": "the malware", "O": ["myriad known anti-debugging and anti-analysis techniques"]}}], "31": [{"include": {"A": "include", "S": "The messages", "O": ["text, often in Arabic, that attempts to persuade the target to execute the file or click the link"]}}], "32": [{"using": {"A": "using", "S": "An unidentified dropper", "O": ["this C&C"]}}, {"used": {"A": "used", "S": "a SpyNet attack on Relative of political detainee D", "O": ["this C&C"]}}], "33": [{"downloaded": {"A": "downloaded", "S": "The exploits", "O": ["instances of SpyNet", "from upload.bz"]}}, {"communicated": {"A": "communicated", "S": "instances of SpyNet", "O": ["with C&C at sn.all-google.com"]}}], "34": [{"download": {"A": "download", "S": "shell code", "O": ["a second stage", "from faddeha.com"]}}, {"loading": {"A": "loading", "S": "an embedded Flash file that exploited a vulnerability fixed in Adobe Flash 11.4", "O": ["shell code"]}}], "35": [{"sends": {"A": "sends", "S": "The at- tacker", "O": ["using one of many freely-available services", "the pseudonymous account a link to a webpage or an e-mail containing an embedded remote image"]}}, {"is revealed": {"A": "is revealed", "O": ["their IP address", "to the at- tacker"]}}], "36": [{"causing": {"A": "causing", "S": "Their filenames", "O": ["Windows to render a filename such as gpj.1bajaR.exe instead as exe.Rajab1.jpg"]}, "contained": {"A": "contained", "S": "Their filenames", "O": ["a Uni- code right-to-left override (RLO) character"]}}], "37": [{"arrived": {"A": "arrived", "S": "the sample", "O": ["via e-mail", "in a .rar attachment"]}}, {"disguised": {"A": "disguised", "S": "an .scr file", "O": ["as a Word document"]}}], "38": [{"encrypts": {"A": "encrypts", "S": "FinSpy", "O": ["data", "using a custom imple- mentation of AES-256-CBC"]}}], "39": [{"using": {"A": "using", "S": "attacks", "O": ["a wide range of off-the-shelf spyware, as well as publicly available third-party services, like iplogger.org"]}}], "40": [{"used": {"A": "used", "S": "The instance of Xtreme RAT sent to Author", "O": ["for its C&C", "owner.no-ip.biz"]}}], "41": [{"reveal": {"A": "reveal", "S": "specially crafted IP spy links and e-mails", "O": ["the IP addresses of operators of pseudonymous accounts"]}}, {"involved": {"A": "involved", "S": "The second", "O": ["specially crafted IP spy links and e-mails"]}}], "42": [{"ac- cesses": {"A": "ac- cesses", "O": ["to his GMail account", "using IMAP"]}}], "43": [{"forwarded": {"A": "forwarded", "S": "two groups", "O": ["to the same address"]}}], "44": [{"received": {"A": "received", "S": "several targets", "O": ["spoofed e-mails containing embedded remote images"]}}], "45": [{"obscure": {"A": "obscure", "S": "an operator of FinSpy", "O": ["the location of the C&C server (called the mas- ter)", "by setting up a proxy known as a relay"]}}], "46": [{"received": {"A": "received", "S": "one of us", "O": ["a targeted e-mail with a link to a file hosted on Google Docs containing a commercial off-the- shelf RAT, Xtreme RAT"]}}], "47": [{"download": {"A": "download", "S": "The document", "O": ["from rcs-demo.hackingteam.it", "a second stage"]}}], "48": [{"share": {"A": "share", "S": "These attacks", "O": ["the same C&C, 216.6.0.28, a Syrian IP address belonging to the Syr- ian Telecommunications Establishment, and publicly reported as a C&C of Syrian malware since February 2012"]}}], "49": [{"involved": {"A": "involved", "S": "The first", "O": ["malicious e-mails containing FinSpy, a \u201clawful intercept\u201d trojan sold exclusively to governments"]}}], "50": [{"continued": {"A": "continued", "S": "the accesses", "O": ["Even after he changed his password"]}}], "51": [{"automatically run": {"A": "automatically run", "S": "a custom macro set", "O": ["upon document startup"]}}, {"contained": {"A": "contained", "S": "The other .rar files", "O": ["a Word document with an embedded ASCII-encoded PE file"]}}], "52": [{"incorporating": {"A": "incorporating", "S": "The attacks", "O": ["effective so- cial engineering"]}}], "53": [{"loaded": {"A": "loaded", "S": "The page", "O": ["a Java exploit"]}}], "54": [{"targeted": {"A": "targeted", "S": "Red Sky", "O": ["other users", "with IP spy links shortened using the al9mood bit.ly account"]}}], "55": [{"uses": {"A": "uses", "S": "a version of FinSpy", "O": ["a protocol based on HTTP POST requests", "for communication with the C&C server"]}}], "56": [{"used": {"A": "used", "S": "an instance of SpyNet", "O": ["the C&C storge.myftp.org"]}}, {"downloaded": {"A": "downloaded", "S": "The attack", "O": ["from isteeler.com", "an instance of SpyNet"]}}], "57": [{"received": {"A": "received", "S": "@YLUBH", "O": ["in late 2012", "at least three IP spy links"]}}], "58": [{"probes": {"A": "probes", "S": "The spyware", "O": ["this folder", "for files that match a certain naming convention"]}, "sends": {"A": "sends", "S": "The spyware", "O": ["them", "to the C&C server"]}}], "59": [{"ran": {"A": "ran", "S": "The .scr file", "O": ["both the bait document and the payload"]}}], "60": [{"is infected": {"A": "is infected", "O": ["the victim\u2019s machine", "with DarkComet 3.3", "While dis- tracted by this meaningless interaction"]}}], "61": [{"presents": {"A": "presents", "S": "The first bait file", "O": ["to the victim", "as a PDF containing infor- mation about a planned uprising in Aleppo"]}}], "62": [{"use": {"A": "use", "S": "the attackers", "O": ["compromised ac- counts (including those of arrested individuals) or fake iden- tities masquerading as pro-opposition", "For seeding"]}}], "63": [{"used": {"A": "used", "S": "Attackers", "O": ["(1) accounts of promi- nent or trusted but jailed individuals like \u201cRed Sky,\u201d (2) fake personas (e.g., attractive women or fake job seekers when tar- geting a labor union), or (3) impersonations of legitimate ac- counts"]}}], "64": [{"communicated": {"A": "communicated", "S": "This sample of SpyNet", "O": ["with the same C&C hamas.sytes.net"]}}], "65": [{"downloaded": {"A": "downloaded", "S": "some documents that differed in their hash", "O": ["the same pay- load"]}}], "66": [{"downloaded": {"A": "downloaded", "S": "a second stage", "O": ["spyware", "from ar-24.com"]}}, {"loaded": {"A": "loaded", "S": "The exploit", "O": ["shellcode"]}}, {"downloaded": {"A": "downloaded", "S": "shellcode", "O": ["a second stage", "from ar-24.com"]}}], "67": [{"ran": {"A": "ran", "S": "The C&C server", "O": ["on ar-24.com"]}}], "68": [{"masquerades": {"A": "masquerades", "S": "the file", "O": ["as a PDF", "using Unicode RLO"]}}, {"masquerading": {"A": "masquerading", "S": "The second bait file", "O": ["as a Skype call encryption program"]}}], "69": [{"careful social engineering": {"A": "careful social engineering", "S": "the attacks"}}], "70": [{"communicated": {"A": "communicated", "S": "The SpyNet sample", "O": ["with the C&C hamas.sytes.net"]}}], "71": [{"slowing": {"A": "slowing", "S": "These techniques", "O": ["their detection by common AV products"]}}], "72": [{"installed": {"A": "installed", "S": "these", "O": ["RCS"]}}], "73": [{"communicated": {"A": "communicated", "S": "Two RCS and 5 FSBSpy samples from VirusTo- tal", "O": ["with various servers in the group"]}}], "74": [{"are not well- detected": {"A": "are not well- detected", "O": ["the attacks", "by anti-virus programs"]}}], "75": [{"resulted": {"A": "resulted", "S": "Both attacks", "O": ["in an Xtreme RAT infection"]}}], "76": [{"connect": {"A": "connect", "S": "it", "O": ["to the Bahrain C&C server"]}}], "77": [{"posting": {"A": "posting", "S": "Two of the other CVE-2012-0158 exploits", "O": ["system infor- mation", "to random123.site11.com"]}, "down- loaded": {"A": "down- loaded", "S": "Two of the other CVE-2012-0158 exploits", "O": ["DarkComet", "from www.getmedia.us and www.technopenta.com"]}}], "78": [{"use": {"A": "use", "S": "some at- tacks", "O": ["so-called \u201clawful intercept\u201d trojans"]}}], "79": [{"connect": {"A": "connect", "S": "This executable", "O": ["to tiger.gamma-international.de, a domain registered to Gamma International GmbH"]}}], "80": [{"used": {"A": "used", "S": "they", "O": ["to access his account", "even after he changed his main password", "a secondary password"]}}], "81": [{"used": {"A": "used", "S": "attackers", "O": ["cheap and readily available RATs"]}}, {"employed": {"A": "employed", "S": "the attackers", "O": ["expensive and \u201cgovernment exclusive\u201d malware"]}}], "82": [{"received": {"A": "received", "S": "These individuals", "O": ["e-mails containing a link to a web page hosted on cedarkeyrv.com impersonat- ing YouTube"]}}], "83": [{"installs": {"A": "installs", "S": "a .jar file", "O": ["an OS-appropriate version of RCS"]}}], "84": [{"use": {"A": "use", "S": "The first attacks", "O": ["bait files with a DarkComet RAT payload"]}}], "85": [{"discover": {"A": "discover", "S": "the attacker", "O": ["the IP address of a victim who is typically the opera- tor of a pseudonymous social media or e-mail account"]}}], "86": [{"targeting": {"A": "targeting", "O": ["by e-mail from domains apparently belonging to opposition groups, in- dicating a potential compromise"]}}], "87": [{"contained": {"A": "contained", "S": "some of the attachments", "O": ["a PE (.exe) file designed to appear as an image"]}}], "88": [{"plays": {"A": "plays", "S": "clever social engineering", "O": ["a central role"]}}], "89": [{"install": {"A": "install", "S": "the vectors", "O": ["the spyware"]}}], "90": [{"receive": {"A": "receive", "S": "targets", "O": ["either (1) a PE in a .zip or .rar, (2) a file download link, or (3) a link that will trigger a drive-by download"]}}], "91": [{"was also used": {"A": "was also used", "O": ["This domain", "for C&C in other attacks"]}}]}, "snake_whitepaper.tokens": {"0": [{"stay": {"A": "stay", "O": ["unnoticed", "by behaviour analysis engines of the antivirus products"]}}, {"overcome": {"A": "overcome", "O": ["account restrictions of the browser processes"]}}, {"write": {"A": "write", "S": "the injected module", "O": ["into files", "into the sensitive registry hives"]}}], "1": [{"provide": {"A": "provide", "S": "these commands", "O": ["complete backdoor functionality"]}, "allowing": {"A": "allowing", "S": "these commands", "O": ["full control over the compromised system", "remote attacker"]}}, {"performed": {"A": "performed", "S": "the malware", "O": ["the commands"]}}], "2": [{"inspects": {"A": "inspects", "S": "The driver", "O": ["bidirectional network data", "on a per stream basis"]}}], "3": [{"start": {"A": "start", "S": "the DLL", "O": ["communicating with C&C directly"]}}, {"inject": {"A": "inject", "S": "it", "O": ["malicious DLL module", "into it"]}}], "4": [{"installs": {"A": "installs", "S": "it", "O": ["a 32-bit driver", "on a 32-bit version of Windows XP"]}}, {"ensure": {"A": "ensure", "S": "the dropper", "O": ["the driver is loaded automatically at startup"]}, "install": {"A": "install", "S": "the dropper", "O": ["the 64-bit driver", "on 64-bit Windows XP"]}}], "5": [{"log": {"A": "log", "S": "the driver", "O": ["its activity"]}, "writes": {"A": "writes", "S": "the driver", "O": ["log data", "into the pipe \\Device\\NamedPipe\\isapi_log"]}}, {"log": {"A": "log", "S": "the DLL", "O": ["into the log files", "the data"]}}], "6": [{"store": {"A": "store", "S": "the Snake driver", "O": ["on it", "its data and additional files"]}, "uses": {"A": "uses", "S": "the Snake driver", "O": ["virtual volumes"]}}], "7": [{"insert": {"A": "insert", "S": "Snake", "O": ["traffic destined to its C&C servers"]}, "manipulate": {"A": "manipulate", "S": "Snake", "O": ["data streams"]}}, {"hooks": {"A": "hooks", "S": "Snake", "O": ["by setting itself up as a TDI filter driver", "the Transport Driver Interface (TDI) network routines"]}}], "8": [{"fetches": {"A": "fetches", "S": "it", "O": ["a file /D/pub.txt"]}, "expects": {"A": "expects", "S": "it", "O": ["the server to respond with a string \u201c1\u201d, acknowledging it\u2019s active"]}}], "9": [{"is installed": {"A": "is installed", "O": ["such a driver", "via an update"]}}, {"copying": {"A": "copying", "O": ["into the shared virtual partition", "all the necessary logs"]}}, {"be instructed": {"A": "be instructed", "O": ["the usermode component"]}}], "10": [{"maintain": {"A": "maintain", "S": "They", "O": ["persistent access to their targets"]}}], "11": [{"register": {"A": "register", "S": "the hook handlers", "O": ["Snake\u2019s own MiniportXxx functions", "with the NDIS library"]}}, {"hooks": {"A": "hooks", "S": "the drivers", "O": ["the following exports", "within ndis.sys (for NDIS 6.0)"]}}, {"hook": {"A": "hook", "S": "it", "O": ["Another set of exports", "in ndis.sys (for NDIS 6.0)"]}}, {"installed": {"A": "installed", "O": ["the hooks"]}}], "12": [{"is registered": {"A": "is registered", "O": ["with NdisFRegisterFilterDriver() API", "The driver"]}}, {"installs": {"A": "installs", "S": "code", "O": ["NDIS filter driver for NDIS 6.0 and above"]}}, {"hooks": {"A": "hooks", "S": "the drivers", "O": ["within ndis.sys", "the following exports"]}}, {"is stored": {"A": "is stored", "O": ["in the registry entry", "NDIS filter driver configuration"]}}], "13": [{"is encrypted": {"A": "is encrypted", "O": ["The command"]}, "receives": {"A": "receives", "S": "it", "O": ["from C&C", "The command"]}}], "14": [{"starts": {"A": "starts", "S": "Infection", "O": ["from a dropper penetrating into the compromised system where it is allowed to run"]}}], "15": [{"registered": {"A": "registered", "S": "Snake", "O": ["as a TDI driver", "on the device stack"]}, "hooks": {"A": "hooks", "S": "Snake", "O": ["TCP calls"]}}], "16": [{"be used": {"A": "be used", "O": ["the vulnerable driver", "as a weapon to patch kernel memory"]}}], "17": [{"making sure": {"A": "making sure", "O": ["it starts with the markers 0xDEADBEAF and 0xC001BA5E (which appear to derive from \u2018DEAD BEEF\u2019 and \u2018COOL BASE\u2019)"]}}, {"is implemented": {"A": "is implemented", "O": ["The authentication"]}}, {"decrypting": {"A": "decrypting", "O": ["the data"]}}], "18": [{"hide": {"A": "hide", "S": "The ObOpenObjectByName() hook", "O": ["the presence of its virtual partitions"]}}], "19": [{"write": {"A": "write", "O": ["into registry"]}}, {"write": {"A": "write", "O": ["into files"]}}, {"overcome": {"A": "overcome", "O": ["account restrictions imposed on a browser process"]}}], "20": [{"send": {"A": "send", "S": "it", "O": ["traffic data", "into a memory pipe \\Device\\NamedPipe\\isapi_http"]}}], "21": [{"load": {"A": "load", "S": "the Snake driver", "O": ["the DLL module", "into the usermode processes"]}, "use": {"A": "use", "S": "the Snake driver", "O": ["for the communications", "that module"]}}], "22": [{"is based": {"A": "is based", "O": ["on CAST-128", "The encryption algorithm"]}}, {}], "23": [{"associated": {"A": "associated", "O": ["a list of interface identifiers", "with the named pipes"]}}], "24": [{"unloads": {"A": "unloads", "S": "it", "O": ["its usermode DLL"]}, "deactivates": {"A": "deactivates", "S": "it", "O": ["its own network drivers"]}}], "25": [{"be set up": {"A": "be set up", "O": ["Both volumes", "as FAT volumes"]}}], "26": [{"are mounted": {"A": "are mounted", "O": ["The volumes", "from the virtual file systems RawDisk1 and RawDisk2"]}}, {"creates": {"A": "creates", "S": "The driver", "O": ["virtual file volumes", "for encrypted storage of its files and configuration data"]}}], "27": [{"defines": {"A": "defines", "S": "the protocol driver", "O": ["the data", "in a list of NET_BUFFER_LIST structures"]}, "calling": {"A": "calling", "S": "the protocol driver", "O": ["NdisSendNetBufferLists()"]}}, {"send": {"A": "send", "O": ["the data"]}}], "28": [{"stores": {"A": "stores", "S": "it", "O": ["its message queue", "in a file called"]}}], "29": [{"is dropped": {"A": "is dropped", "O": ["the DLL", "under a random name or a hard-coded name"]}}], "30": [{"parse": {"A": "parse", "S": "Snake", "O": ["all incoming traffic"]}, "reach out": {"A": "reach out", "S": "Snake", "O": ["to external components"]}, "detect": {"A": "detect", "S": "Snake", "O": ["traffic addressed to itself"]}, "manipulate": {"A": "manipulate", "S": "Snake", "O": ["at 3 different levels (NDIS protocol driver, TDI Driver, and WPF callout driver)", "traffic"]}, "\u2018inject\u2019": {"A": "\u2018inject\u2019", "S": "Snake", "O": ["into existing communications", "the traffic"]}}, {"intercepts": {"A": "intercepts", "S": "the driver", "O": ["all connections"]}}], "31": [{"install": {"A": "install", "S": "Snake dropper", "O": ["the vulnerable VBox driver"]}, "start": {"A": "start", "S": "Snake dropper", "O": ["each time Windows starts"]}, "disable": {"A": "disable", "S": "Snake dropper", "O": ["with a DeviceIoControl() API call", "Code Integrity control"]}, "registers": {"A": "registers", "S": "Snake dropper", "O": ["as a service", "itself"]}, "load": {"A": "load", "S": "Snake dropper", "O": ["the driver"]}}], "32": [{"running": {"A": "running", "S": "It", "O": ["on the target system", "MS09-025 and MS10-015 exploits"]}}], "33": [{"suggests": {"A": "suggests", "S": "The presence of the reconnaissance tool in the Snake operators\u2019 framework", "O": ["the existence of an arsenal of infiltration tools"]}}, {"spread": {"A": "spread", "O": ["the infection", "even further"]}}, {"compromise": {"A": "compromise", "S": "the existence of an arsenal of infiltration tools", "O": ["a system"]}}, {"replicate": {"A": "replicate", "O": ["into other hosts"]}}, {"infect": {"A": "infect", "O": ["them"]}}], "34": [{"keep": {"A": "keep", "O": ["its network communications", "as quiet as possible"]}}], "35": [{"is intercepted": {"A": "is intercepted", "O": ["it", "When the data arrives", "with the FwpsCopyStreamDataToBuffer0() API"]}, "scanned": {"A": "scanned", "O": ["for the presence of the hidden commands from C&C", "it"]}}], "36": [{"distinguish": {"A": "distinguish", "S": "it", "O": ["commands addressed to itself"]}, "looking for and then parsing": {"A": "looking for and then parsing", "S": "it", "O": ["GET/POST HTTP requests and also SMTP communications"]}, "inspect": {"A": "inspect", "S": "it", "O": ["the traffic"]}}], "37": [{"calls": {"A": "calls", "S": "NDIS", "O": ["the miniport driver\u2019s MiniportSendNetBufferLists() function"]}}], "38": [{"makes": {"A": "makes", "O": ["its detection during that time", "very difficult"]}}, {"staying": {"A": "staying", "O": ["fully inactive", "for a number of days"]}}], "39": [{"stays": {"A": "stays", "S": "Snake", "O": ["As long as the user is not using the Internet", "dormant"]}}], "40": [{"be injected": {"A": "be injected", "O": ["into usermode processes", "libraries"]}}], "41": [{"parses": {"A": "parses", "S": "it", "O": ["all incoming HTTP and SMTP traffic"]}, "be authenticated": {"A": "be authenticated", "S": "it", "O": ["it", "as Snake traffic"]}}], "42": [{"adjusting": {"A": "adjusting", "S": "the attacker", "O": ["to the hosts present within the network", "them"]}}], "43": [{"is saved": {"A": "is saved", "O": ["the data", "into the volume Hd1"]}}, {"be scrambled": {"A": "be scrambled", "O": ["on-the-fly", "it"]}, "reflected": {"A": "reflected", "O": ["in the persistent storage file hotfix.dat", "it"]}}], "44": [{"Hiding": {"A": "Hiding", "S": "Snake rootkit", "O": ["a few DNS/HTTP requests", "among busy network traffic"]}, "stay": {"A": "stay", "S": "Snake rootkit", "O": ["unnoticed"]}}], "45": [{"be injected": {"A": "be injected", "O": ["into the user-mode processes", "this DLL"]}}], "46": [{"asks": {"A": "asks", "S": "it", "O": ["for a command", "the server"]}}, {"returns": {"A": "returns", "S": "the server", "O": ["a new command to execute"]}}], "47": [{"decrypt": {"A": "decrypt", "S": "the malware", "O": ["it"]}, "applies": {"A": "applies", "S": "the malware", "O": ["to the bytes that start from offset 0x40", "the XOR mask"]}}], "48": [{"encrypt": {"A": "encrypt", "S": "the driver", "O": ["data stored on its virtual partitions"]}, "sets": {"A": "sets", "S": "the driver", "O": ["a hook for another API"]}}, {"hooks": {"A": "hooks", "S": "the rootkit", "O": ["these APIs"]}, "re-infect": {"A": "re-infect", "S": "the rootkit", "O": ["the usermode process svchost.exe"]}, "re-enable": {"A": "re-enable", "S": "the rootkit", "O": ["its network drivers"]}}], "49": [{"relies on": {"A": "relies on", "S": "it", "O": ["Windows Internet (WinINet) APIs, such as HttpOpenRequest(), HttpSendRequest(), InternetReadFile(), etc"]}}], "50": [{"loads": {"A": "loads", "S": "the Snake dropper", "O": ["a copy of the NT core image (ntoskrnl.exe)"]}, "locates": {"A": "locates", "S": "the Snake dropper", "O": ["SepInitializeCodeIntegrity() within it", "the import of CI.dll\u2019s function CiInitialize()"]}}], "51": [{"watches": {"A": "watches", "S": "The driver", "O": ["for all userland processes", "to see if they load any web pages"]}}, {"hide": {"A": "hide", "S": "Another set of hooks", "O": ["the presence of the Snake components on the system"]}}, {"sets": {"A": "sets", "S": "it", "O": ["Another set of hooks"]}}], "52": [{"function": {"A": "function", "S": "the DLL", "O": ["in the \u2018pipe server\u2019 mode"]}}, {"injects": {"A": "injects", "S": "the malicious driver with the embedded DLL module", "O": ["into a system process, such as services.exe", "that DLL"]}}], "53": [{"ask": {"A": "ask", "S": "the pipe clients (infected usermode processes)", "O": ["the pipe server"]}}, {"copy": {"A": "copy", "S": "the pipe server", "O": ["files"]}, "perform": {"A": "perform", "S": "the pipe server", "O": ["GET"]}, "saving": {"A": "saving", "S": "the pipe server", "O": ["data", "into a temporary file"]}, "save": {"A": "save", "S": "the pipe server", "O": ["under the aforementioned ShellCore value", "into the registry", "configuration data"]}, "delete": {"A": "delete", "S": "the pipe server", "O": ["files"]}}], "54": [{"checks": {"A": "checks", "S": "The hook handler for ZwTerminateProcess()", "O": ["if the process being shut down is svchost.exe"]}}], "55": [{"load": {"A": "load", "S": "it", "O": ["its unsigned 64-bit driver", "on a 64-bit version of Windows XP"]}}], "56": [{"used": {"A": "used", "O": ["the named pipes", "for communications"]}}, {"submitted": {"A": "submitted", "O": ["into the pipes", "Messages"]}}], "57": [{"be notified": {"A": "be notified", "O": ["it", "whenever a new process is started"]}}, {"calls": {"A": "calls", "S": "it", "O": ["PsSetCreateProcessNotifyRoutine()"]}}, {"sets up": {"A": "sets up", "S": "the driver", "O": ["for the following kernel-mode APIs", "the hooks"]}}], "58": [{"invoking": {"A": "invoking", "S": "it", "O": ["a data receive indication function NdisMIndicateReceiveNetBufferLists()"]}}, {"receives": {"A": "receives", "S": "the underlying miniport driver", "O": ["data", "from the network"]}}], "59": [{"creates": {"A": "creates", "S": "the driver", "O": ["with a symbolic link \\DosDevices\\vstor32", "device named \\Device\\vstor32"]}}], "60": [{"inject": {"A": "inject", "S": "The ZwClose() hook handler", "O": ["into the userland processes", "the DLL module"]}}], "61": [{"making": {"A": "making", "S": "it", "O": ["invisible to scanners", "its open ports"]}, "send": {"A": "send", "S": "it"}, "bypassing": {"A": "bypassing", "S": "it"}, "receive": {"A": "receive", "S": "it"}}], "62": [{"rely on": {"A": "rely on", "O": ["its communication capabilities"]}}, {"update": {"A": "update", "O": ["the driver"]}}], "63": [{"intercepts": {"A": "intercepts", "S": "the driver", "O": ["that event", "as soon as the user goes online"]}, "injects": {"A": "injects", "S": "the driver", "O": ["into the process that initiated connection", "the malicious DLL module"]}}], "64": [{"enumerates": {"A": "enumerates", "S": "this tool", "O": ["other network hosts"]}, "detects": {"A": "detects", "S": "this tool", "O": ["what Windows RPC services are enabled at the endpoints"]}}], "65": [{"drops": {"A": "drops", "S": "it", "O": ["a DLL", "into the %windows% directory"]}}, {"applied": {"A": "applied", "O": ["XOR 0xAA", "on top of it"]}}], "66": [{"are still injected": {"A": "are still injected", "O": ["to perform high-level tasks", "into the system processes", "The usermode DLLs"]}}], "67": [{"registers": {"A": "registers", "S": "The Snake rootkit", "O": ["as Network Driver Interface Specification (NDIS) protocol driver", "itself"]}}], "68": [{"is notified": {"A": "is notified", "O": ["whenever a TCP connection is established by a browser", "its callout driver"]}}], "69": [{"read": {"A": "read", "S": "It", "O": ["a message"]}, "write": {"A": "write", "S": "It", "O": ["a message"]}}], "70": [{"identify": {"A": "identify", "S": "the remote attacker", "O": ["any potentially exploitable hosts located in the same network as the victim"]}}], "71": [{"stay": {"A": "stay", "S": "Snake", "O": ["persistent on a system"]}, "restore": {"A": "restore", "S": "Snake", "O": ["its driver file", "in case it gets deleted"]}, "infect": {"A": "infect", "S": "Snake", "O": ["any newly created processes"]}}], "72": [{"is encrypted": {"A": "is encrypted", "O": ["The data"]}, "saved": {"A": "saved", "O": ["The data", "into a configuration file %system%\\vtmon.bin"]}}, {"reveal": {"A": "reveal", "S": "it", "O": ["for each host found in the network", "the following characteristics"]}}], "73": [{"makes sure": {"A": "makes sure", "S": "it", "O": ["the command is destined to the current host", "by matching the ID field in it"]}, "calculates and confirms": {"A": "calculates and confirms", "S": "it", "O": ["within the command", "a CRC32 checksum"]}, "decrypts": {"A": "decrypts", "S": "it", "O": ["the data", "by using the Number Theory Library (NTL)"]}}], "74": [{"install": {"A": "install", "S": "it", "O": ["On a 64-bit OS", "a 64-bit driver"]}}], "75": [{"behaves": {"A": "behaves", "S": "it", "O": ["differently", "On 64-bit versions of Windows Vista and above"]}}], "76": [{"uses": {"A": "uses", "S": "it"}}, {"be": {"A": "be", "S": "Request type", "O": ["POST"]}}, {"is": {"A": "is", "S": "C&C server resource name", "O": ["/default.asp"]}}, {}, {"rely on": {"A": "rely on", "S": "It", "O": ["the following Internet Media types (MIME types)", "for data exfiltration"]}}], "77": [{"are used": {"A": "are used", "S": "rootkit", "O": ["The files within that directory"]}, "store": {"A": "store", "S": "rootkit", "O": ["configuration and log data"]}}], "78": [{"been downloaded": {"A": "been downloaded", "O": ["One of the Snake components", "from a remote C&C server"]}, "was identified": {"A": "was identified", "O": ["as a network reconnaissance tool", "One of the Snake components"]}}], "79": [{"install": {"A": "install", "S": "it", "O": ["a TDI filter driver"]}}], "80": [{"uses": {"A": "uses", "S": "The rkctl_Win32.dll/rkctl_x64.dll module", "O": ["the following hard-coded named pipe", "for communications"]}}, {"receives": {"A": "receives", "S": "it", "O": ["The remote commands"]}}, {"control": {"A": "control", "S": "The remote commands", "O": ["other components of Snake"]}}], "81": [{"keep": {"A": "keep", "S": "This delegation of tasks", "O": ["under the radar of the behavioural analysis tools", "infected processes", "for as long as possible"]}}], "82": [{"is acting": {"A": "is acting", "S": "the driver", "O": ["like a proxy", "in this mode"]}, "routing": {"A": "routing", "S": "the driver", "O": ["to a remote C&C server", "requests from other infected hosts"]}}], "83": [{"contain": {"A": "contain", "S": "other log files", "O": ["executed command outputs"]}}, {"intercepted": {"A": "intercepted", "O": ["keystrokes"]}}], "84": [{"post": {"A": "post", "S": "the DLL", "O": ["the data"]}}, {"received": {"A": "received", "S": "this Snake DLL module", "O": ["The remote commands"]}}], "85": [{"initiates": {"A": "initiates", "S": "the module", "O": ["polling", "from one of the hard-coded C&C servers"]}}], "86": [{"read": {"A": "read", "O": ["that data", "from the volume to is written that data"]}, "is written": {"A": "is written", "O": ["that data", "to the volume from read that data"]}}, {"provides": {"A": "provides", "S": "The hook", "O": ["on-the-fly data encryption/decryption"]}}, {"is created": {"A": "is created", "O": ["The first partition", "with the following steps"]}}, {"installed": {"A": "installed", "S": "the rootkit", "O": ["on IofCallDriver() API", "The hook"]}}], "87": [{"uploads": {"A": "uploads", "S": "it", "O": ["all the collected logs", "to the server"]}, "cleans out": {"A": "cleans out", "S": "it", "O": ["those logs"]}}, {"receives": {"A": "receives", "S": "it", "O": ["The command"]}}], "88": [{"using": {"A": "using", "S": "It", "O": ["complex techniques", "for evading host defences"]}, "providing": {"A": "providing", "S": "It", "O": ["covert communication channels", "the attackers"]}}], "89": [{"is ensured": {"A": "is ensured", "O": ["The registration", "with creation of the following registry entries"]}}, {"flags": {"A": "flags", "S": "The driver", "O": ["the following events", "with the notification purposes"]}}, {"places": {"A": "places", "S": "The rootkit", "O": ["a number of the hooks"]}}], "90": [{"use": {"A": "use", "S": "the DLL", "O": ["the pipe name(s)", "for its communications"]}}], "91": [{"\u2018pulse\u2019": {"A": "\u2018pulse\u2019", "S": "the TDI driver", "O": ["the \\BaseNamedObjects\\wininet_activate event", "Whenever the client establishes connections"]}}], "92": [{"fingerprint": {"A": "fingerprint", "S": "it", "O": ["by mimicking the Metasploit\u2019s logic of OS fingerprinting via SMB", "all network hosts"]}}], "93": [{"is uploaded": {"A": "is uploaded", "O": ["This file", "to the C&C server", "along with other configuration files, such as mtmon.sdb, mtmon32.sdb, gstatsnd.bin, gstat.bin, gstat32.bin, and other log files found in the %windows%\\$NtUninstallQ[random]$ directory", "by the usermode-centric Snake rootkit"]}, "is then further encrypted": {"A": "is then further encrypted", "O": ["This file", "with an NTL-based (Number Theory Library) algorithm"]}}], "94": [{"be used": {"A": "be used", "S": "These tools", "O": ["in a number of different modes", "for covert communications"]}}, {"present": {"A": "present", "S": "some of which", "O": ["significant challenges for traditional security technologies to detect"]}}], "95": [{"is set up": {"A": "is set up", "S": "This driver", "O": ["below a protocol driver", "above a miniport driver"]}}], "96": [{"identify": {"A": "identify", "S": "the pipe server", "O": ["the messages"]}}], "97": [{"is authenticated and decrypted": {"A": "is authenticated and decrypted", "O": ["the incoming data"]}}], "98": [{"are hard-coded": {"A": "are hard-coded", "O": ["within the body of the DLL", "the initial set of domain names"]}}], "99": [{"parses": {"A": "parses", "S": "it", "O": ["the function\u2019s code", "to locate the offset of the variable"]}}], "100": [{"delegate": {"A": "delegate", "O": ["to usermode code", "the network communication engine"]}}], "101": [{"is loaded": {"A": "is loaded", "O": ["the 64-bit unsigned driver"]}}], "102": [{"are handled": {"A": "are handled", "S": "a kernel mode driver", "O": ["the network communications"]}}], "103": [{"craft": {"A": "craft", "S": "an attacker", "O": ["such input parameters that will define address within kernel memory to patch and the data to patch it"]}}], "104": [{"created": {"A": "created", "S": "the latest samples of Snake", "O": ["Log files"]}}, {"used": {"A": "used", "S": "Agent.BTZ", "O": ["the same XOR key", "for its logs"]}}], "105": [{"calls": {"A": "calls", "S": "it", "O": ["with IOCTL code of 0x222038", "DeviceIoControl() API", "on its handle"]}, "write": {"A": "write", "S": "it", "O": ["data"]}, "opens": {"A": "opens", "S": "it", "O": ["the device", "with CreateFile(\u201c\\\\.\\vstor32\u201d)"]}}], "106": [{"received": {"A": "received", "O": ["the data", "from the pipes"]}}], "107": [{"blend": {"A": "blend", "S": "this behaviour", "O": ["with the browser traffic", "Snake\u2019s traffic"]}}, {"keeping": {"A": "keeping", "O": ["a low profile"]}}, {"bypassing": {"A": "bypassing", "O": ["the firewalls"]}}], "108": [{"be installed": {"A": "be installed", "O": ["as a service", "DLL modules"]}, "be run": {"A": "be run", "O": ["DLL modules", "within taskhost.exe or services.exe processes"]}}], "109": [{"is used": {"A": "is used", "O": ["for userland/kernel communications", "This device"]}}], "110": [{"relies on": {"A": "relies on", "S": "it", "O": ["The domain names of the C&C servers"]}}], "111": [{"block": {"A": "block", "S": "The ZwReadFile() hook handler", "O": ["access to the home directory where the rootkit keeps its file"]}}], "112": [{"intercepts": {"A": "intercepts", "S": "the driver", "O": ["The data"]}}], "113": [{"is spawned": {"A": "is spawned", "O": ["a dedicated thread"]}}, {"listen": {"A": "listen", "O": ["for IPC messages received through the pipes"]}}], "114": [{"asking": {"A": "asking", "S": "the malware", "O": ["for another command"]}, "connects": {"A": "connects", "S": "the malware", "O": ["to the new C&C"]}}, {}], "115": [{"are carried out": {"A": "are carried out", "O": ["from the userland", "the network communications"]}}], "116": [{"communicates": {"A": "communicates", "S": "The usermode component of Snake", "O": ["via a device called \\\\.\\vstor32 (created under kernel as \\Device\\vstor32)", "with its kernel-mode driver"]}}, {"send": {"A": "send", "S": "the clients", "O": ["messages", "using the following task identification headers", "to the pipe server"]}}], "117": [{"is": {"A": "is", "S": "the kernel-mode driver", "O": ["responsible for the communications"]}}], "118": [{"copies": {"A": "copies", "S": "the dropper", "O": ["itself"]}}, {"registers": {"A": "registers", "S": "The dropper", "O": ["as a service", "itself"]}, "ensure": {"A": "ensure", "S": "The dropper", "O": ["it starts every time Windows is booted"]}}], "119": [{"installs": {"A": "installs", "S": "the dropper", "O": ["in a pre-defined location", "the kernel mode driver"]}}, {"executed": {"A": "executed", "O": ["the dropper"]}}], "120": [{"provide": {"A": "provide", "S": "Snake", "O": ["remote attackers", "with full remote access to the compromised system"]}}, {"allow": {"A": "allow", "S": "the backdoor commands", "O": ["Snake"]}}], "121": [{"keep": {"A": "keep", "S": "Snake", "O": ["on TrueCrypt-like volumes", "its data"]}}], "122": [{"intercepts": {"A": "intercepts", "S": "it", "O": ["via IRP (IO request package) hooks", "all requests along with their parameters"]}}], "123": [{"is registered": {"A": "is registered", "O": ["The driver", "with NdisIMRegisterLayeredMiniport() API"]}}], "124": [{"injected": {"A": "injected", "S": "the driver", "O": ["in it", "a malicious DLL module"]}}, {"started": {"A": "started", "S": "that module", "O": ["producing the following traffic"]}}], "125": [{"blocks": {"A": "blocks", "S": "the rootkit", "O": ["access to registry entries that contain the strings \u201cUltra3\u201d and \u201c~ROOT\u201d"]}}], "126": [{"detects": {"A": "detects", "S": "the rootkit", "O": ["that the OS version is pre-Vista (e.g. Windows XP) or Windows Server 2008 (e.g. Windows Server 2003)"]}}], "127": [{"works": {"A": "works", "S": "it", "O": ["in the \u2018pipe server\u2019 mode"]}}, {"passes": {"A": "passes", "S": "it", "O": ["the web requests it is interested in (as a client)", "to the pipe server that runs within Windows Explorer (explorer.exe) and/or Internet Explorer (iexplore.exe) processes"]}}], "128": [{"be distributed": {"A": "be distributed", "O": ["via a phishing email attachment", "it"]}, "be delivered": {"A": "be delivered", "O": ["it", "via an exploit across the network"]}}], "129": [{"\u2018legitimise\u2019": {"A": "\u2018legitimise\u2019", "S": "the pipes usage", "O": ["the outbound web requests"]}}], "130": [{"hooks": {"A": "hooks", "S": "it", "O": ["IoCreateDevice()"]}}], "131": [{"start": {"A": "start", "S": "it", "O": ["communicating with the C&C"]}}, {"bypassing": {"A": "bypassing", "O": ["the host-based firewalls that keep an infected system process in a white-list"]}}, {"is delegated": {"A": "is delegated", "O": ["the task of communication with C&C", "to the pipe server"]}}], "132": [{"obtain": {"A": "obtain", "S": "the dropper", "O": ["Administrator privileges"]}}], "133": [{"creates": {"A": "creates", "S": "it", "O": ["on the hidden virtual volumes", "The logs and dumps"]}}], "134": [{"uses": {"A": "uses", "S": "it", "O": ["Windows Sockets 2 (Winsock) APIs, such as WSAStartup(), socket(), connect(), send(), etc"]}}], "135": [{"establishing and maintaining": {"A": "establishing and maintaining", "S": "two distinct variants", "O": ["a presence", "on the target system"]}}], "136": [{"carry out": {"A": "carry out", "S": "a kernel-mode driver", "O": ["the network communications"]}}], "137": [{"invokes": {"A": "invokes", "S": "NDIS", "O": ["Snake\u2019s hook function"]}}], "138": [{"install": {"A": "install", "S": "it", "O": ["On a 32-bit OS", "a 32-bit driver"]}}], "139": [{"uploads": {"A": "uploads", "S": "it", "O": ["The files"]}}], "140": [{"creates": {"A": "creates", "S": "the driver", "O": ["the configuration queue", "on a virtual volume"]}, "reads": {"A": "reads", "S": "it", "O": ["configuration parameters", "from the configuration queue"]}}, {"activates": {"A": "activates", "S": "the DLL"}}], "141": [{"start": {"A": "start", "S": "the injected DLL", "O": ["communicating with the pipe server"]}, "sending": {"A": "sending", "S": "the injected DLL", "O": ["messages", "into the established inter-process communication pipes"]}}], "142": [{"is written": {"A": "is written", "O": ["the initial message queue file", "into the virtual volume"]}}, {"creating": {"A": "creating", "S": "a tool", "O": ["NTFS file systems"]}}], "143": [{"carry out": {"A": "carry out", "O": ["all of the communications", "from the kernel-mode driver"]}}], "144": [{"triggers": {"A": "triggers", "S": "the rootkit", "O": ["an event named \\BaseNamedObjects\\wininet_activate"]}}], "145": [{"checks": {"A": "checks", "S": "The installed hook handler", "O": ["if the name of the device is netbt or afd"]}, "calls": {"A": "calls", "S": "The installed hook handler", "O": ["the original API"]}}], "146": [{"\u2018blend in\u2019": {"A": "\u2018blend in\u2019", "S": "it", "O": ["with the legitimate communications"]}, "generate": {"A": "generate", "S": "it", "O": ["malicious traffic", "whenever the user goes online and start loading the web pages"]}}], "147": [{"supports": {"A": "supports", "S": "it", "O": ["3 modes of fetching C&C commands"]}}], "148": [{"registers": {"A": "registers", "S": "it", "O": ["a callout driver for Windows Filtering Platform (WFP)"]}}], "149": [{"injected": {"A": "injected", "S": "the driver", "O": ["a usermode DLL", "into the system processes"]}}, {"installed": {"A": "installed", "O": ["a kernel mode driver"]}}], "150": [{"invoke": {"A": "invoke", "S": "it", "O": ["FwpsStreamInjectAsync0() API"]}, "generate": {"A": "generate", "S": "it", "O": ["outbound requests"]}}], "151": [{"provide": {"A": "provide", "S": "It", "O": ["a communication mechanism with its C&C servers"]}, "covertly install": {"A": "covertly install", "S": "It", "O": ["a backdoor", "on a compromised system"]}, "enable": {"A": "enable", "S": "It", "O": ["an effective data exfiltration mechanism"]}, "hide": {"A": "hide", "S": "It", "O": ["the presence of its components"]}}], "152": [{"only needs": {"A": "only needs", "S": "it", "O": ["one host to be connected online", "When most of the infected hosts are cut off from the outside world"]}}], "153": [{"blocked": {"A": "blocked", "S": "it", "O": ["file read access from that directory"]}}], "154": [{"replicate": {"A": "replicate", "S": "it", "O": ["the infection", "across the network"]}, "taking control": {"A": "taking control", "S": "it", "O": ["over new hosts"]}, "repeating": {"A": "repeating", "S": "it", "O": ["the infection cycle", "all over again"]}, "spreading": {"A": "spreading", "S": "it", "O": ["the infection", "further"]}}, {"delivers": {"A": "delivers", "S": "the tool", "O": ["the payload"]}, "exploits": {"A": "exploits", "S": "the tool", "O": ["the remote host(s)"]}}], "155": [{"creates": {"A": "creates", "S": "The analysed 32-bit dropper", "O": ["a driver", "in the following location"]}}], "156": [{"make": {"A": "make", "O": ["data exfiltration", "still possible"]}}, {"is then routed": {"A": "is then routed", "O": ["The traffic", "through that host"]}}], "157": [{"injected": {"A": "injected", "S": "the kernel-mode driver", "O": ["into the userland system process", "The usermode DLLs"]}}], "158": [{"be delivered": {"A": "be delivered", "S": "the driver", "O": ["back to C&C"]}}, {"execute": {"A": "execute", "S": "the DLL module", "O": ["them", "If the data contains commands from C&C"]}}], "159": [{"be loaded": {"A": "be loaded", "O": ["the unsigned 64-bit driver"]}}, {"is disabled": {"A": "is disabled", "O": ["Code Integrity verification"]}}], "160": [{"installs": {"A": "installs", "S": "code", "O": ["NDIS filter intermediate driver"]}}], "161": [{"detects": {"A": "detects", "S": "the driver", "O": ["a usermode process that goes online (e.g. a browser)"]}}], "162": [{"\u2019s": {"A": "\u2019s", "S": "it", "O": ["a fully encrypted file with flat entropy"]}}], "163": [{"is encrypted": {"A": "is encrypted", "O": ["The data stored in \\\\.\\Hd2", "the same way the first volume\u2019s data"]}}], "164": [{"deliver": {"A": "deliver", "S": "The attacker", "O": ["to be applied against the identified hosts by running the tool with the \u2018exp_os\u2019 switch", "the generated shellcode", "back to the reconnaissance tool"]}}], "165": [{"is registered": {"A": "is registered", "O": ["the dropper itself"]}}], "166": [{"block": {"A": "block", "S": "the hook handlers of the registry-related APIs", "O": ["access to the registry entries that contain the name of the driver"]}}, {"hooks": {"A": "hooks", "S": "the driver", "O": ["the following APIs"]}, "hide": {"A": "hide", "S": "the driver", "O": ["its components"]}}], "167": [{"interprets": {"A": "interprets", "S": "the malware", "O": ["the received command"]}}], "168": [{"resolves": {"A": "resolves", "S": "the malware", "O": ["the domain name of its C&C"]}}], "169": [{"depend on": {"A": "depend on", "S": "The choice of what architecture should be used", "O": ["a specific target\u2019s environment"]}}], "170": [{"respond": {"A": "respond", "S": "the driver", "O": ["with messages like \u201cHTTP/1.1 200 OK\u201d or \u201cHTTP/1.1 500 Server Error\u201d"]}}], "171": [{"hide": {"A": "hide", "S": "its hooks", "O": ["the presence of Snake on a system"]}}]}, "TA14-353A_wiper.tokens": {"0": [{"started": {"A": "started", "S": "it", "O": ["with \u201c-i\u201d as an argument", "a second instance of itself"]}, "terminated": {"A": "terminated", "S": "it"}}, {"was executed": {"A": "was executed", "O": ["the dropper file"]}}], "1": [{"results in": {"A": "results in", "S": "This", "O": ["the victim machine being non-operational with irrecoverable data"]}}], "2": [{"is equipped": {"A": "is equipped", "O": ["This SMB Worm Tool", "with Lightweight Backdoor"]}}], "3": [{"contain": {"A": "contain", "S": "an executable and a dll", "O": ["the destructive components"]}}, {"is dropped and installed": {"A": "is dropped and installed", "S": "another executable", "O": ["The tool"]}}, {"contains": {"A": "contains", "S": "an encoded command file", "O": ["the actual destruction commands to be executed"]}}], "4": [{"starts": {"A": "starts", "S": "it", "O": ["with the \u201c\u2013i\u201d argument"]}, "creates": {"A": "creates", "S": "it"}}], "5": [{"calls": {"A": "calls", "S": "the first thread", "O": ["home"]}, "sends": {"A": "sends", "S": "the first thread", "O": ["back logs (a list of successful SMB exploitations)"]}}, {"guess": {"A": "guess", "S": "the second thread", "O": ["for SMB connections", "passwords"]}}], "6": [{"sends": {"A": "sends", "S": "the victim", "O": ["the string, \"HTTP/1.1 GET /dns? \\x00.\""]}}, {"responds": {"A": "responds", "S": "The controller", "O": ["with the string \"200 www.yahoo.com!\\x00\" (for \"sensvc.exe\" and \"msensvc.exe\")", "with the string \"RESPONSE 200 OK!!\" (for \"netcfg.dll\")"]}}], "7": [{"discover": {"A": "discover", "S": "This tool", "O": ["routers and gateway devices"]}, "allowing": {"A": "allowing", "S": "This tool", "O": ["on Network Address Translated (NAT) private networks", "inbound connections", "to victim hosts"]}, "add": {"A": "add", "S": "This tool", "O": ["port mappings"]}, "open": {"A": "open", "S": "This tool", "O": ["in a victim host's firewall", "ports"]}}], "8": [{"perform": {"A": "perform", "S": "This proxy tool", "O": ["directory listings"]}, "fingerprint": {"A": "fingerprint", "S": "This proxy tool", "O": ["the victim machine"]}, "transfer": {"A": "transfer", "S": "This proxy tool", "O": ["files"]}, "has": {"A": "has", "S": "This proxy tool", "O": ["basic backdoor functionality"]}, "run": {"A": "run", "S": "This proxy tool", "O": ["remote commands"]}}], "9": [{"overwriting": {"A": "overwriting", "S": "This tool", "O": ["the Master Boot Record"]}, "renders": {"A": "renders", "S": "This tool", "O": ["inoperable", "victim machines"]}}], "10": [{"propagate": {"A": "propagate", "S": "The malware", "O": ["throughout the target network", "via built-in Windows shares"]}}], "11": [{"reports": {"A": "reports", "S": "the malware", "O": ["its status", "back to one of the four C2 IP addresses"]}, "been uploaded": {"A": "been uploaded", "S": "the malware", "O": ["the wiper"]}}], "12": [{"connects": {"A": "connects", "S": "The SMB worm", "O": ["to a C2 infrastructure"]}, "propagates": {"A": "propagates", "S": "The SMB worm", "O": ["via brute-force authentication attacks", "throughout an infected network"]}}], "13": [{"generating": {"A": "generating", "S": "The \u201c-s\u201d instance", "O": ["network traffic", "to victim IP addresses", "over TCP ports 445 and 139"]}, "executed": {"A": "executed", "S": "The \u201c-s\u201d instance", "O": ["\u201cigfxtrayex.exe\u201d"]}, "created": {"A": "created", "S": "The \u201c-s\u201d instance", "O": ["\u201cnet_ver.dat\u201d"]}, "dropped": {"A": "dropped", "S": "The \u201c-s\u201d instance", "O": ["\u201cigfxtrayex.exe\u201d"]}}], "14": [{"is dropped": {"A": "is dropped", "O": ["It", "from resource ID 0x83 of \u201cigfxtrayex.exe\u201d"]}}], "15": [{"includes": {"A": "includes", "S": "It", "O": ["system survey"]}}], "16": [{"is established": {"A": "is established", "O": ["a file share"]}}, {"is copied": {"A": "is copied", "O": ["file", "on run file"]}, "run": {"A": "run", "O": ["file", "on is copied file"]}}], "17": [{"installed": {"A": "installed", "O": ["as a service", "a dropper"]}, "are typically loaded": {"A": "are typically loaded", "O": ["via a dropper", "Implants in this malware family"]}}, {"listen": {"A": "listen", "S": "Implants in this malware family", "O": ["on TCP port 443"]}}], "18": [{"sent": {"A": "sent", "O": ["Each message", "to this implant from sent Each message"]}, "XOR encoded": {"A": "XOR encoded", "O": ["Each message", "with the byte 0x1F"]}}], "19": [{"perform": {"A": "perform", "S": "The listener", "O": ["arbitrary code execution"]}, "execute": {"A": "execute", "S": "The listener", "O": ["on the command line", "commands"]}}], "20": [{"wiping": {"A": "wiping", "S": "The malware", "O": ["files"]}, "access": {"A": "access", "S": "The malware", "O": ["on the remote systems", "shares"]}}], "21": [{"xor\u2019d": {"A": "xor\u2019d", "O": ["with 0x63", "all"]}}], "22": [{"changes": {"A": "changes", "O": ["the file-time", "to match that of the built-in file \u201ccalc.exe\u201d"]}}, {"uploads": {"A": "uploads", "S": "the malware", "O": ["a copy of the wiper file \u201ctaskhostXX.exe\u201d"]}}, {"starts": {"A": "starts", "O": ["the remote process"]}}], "23": [{"begin": {"A": "begin", "S": "the malware", "O": ["the wiping process", "on these remote systems"]}, "access": {"A": "access", "S": "the malware", "O": ["remote network shares"]}, "upload": {"A": "upload", "S": "the malware", "O": ["a copy of the wiper"]}}], "24": [{"starts": {"A": "starts", "S": "This file", "O": ["on localhost port 80", "a listener"]}}], "25": [{"listens": {"A": "listens", "S": "this implant", "O": ["for connections", "on TCP port 195 (for \"sensvc.exe\" and \"msensvc.exe\") and TCP port 444 (for \"netcfg.dll\")"]}}], "26": [{"is dropped": {"A": "is dropped", "O": ["from resource ID 0x81 of \u201cigfxtrayex.exe\u201d", "It"]}}], "27": [{"spread": {"A": "spread", "S": "it", "O": ["via SMB port 445", "to other Windows hosts"]}}, {"send": {"A": "send", "S": "It", "O": ["log data", "back to command and control (C2) infrastructure"]}, "connects": {"A": "connects", "S": "It", "O": ["home", "every five minutes"]}}], "28": [{"are made": {"A": "are made", "O": ["in a random order", "to one of three hard-coded IP addresses", "Network connection attempts", "to port 8080 or 8000"]}}], "29": [{"is": {"A": "is", "S": "This tool", "O": ["a tailored hard-drive wiping tool"]}, "destroy": {"A": "destroy", "S": "This tool", "O": ["data", "past the point of recovery"]}, "complicate": {"A": "complicate", "S": "This tool", "O": ["he victim machine\u2019s recovery"]}}], "30": [{"being deleted": {"A": "being deleted", "O": ["specific files"]}}, {"wipes": {"A": "wipes", "S": "the infected MBR", "O": ["the drive"]}}, {"destroyed": {"A": "destroyed", "O": ["the targeted files"]}}], "31": [{"is issued": {"A": "is issued", "O": ["A 120-minute (2 hour) sleep command"]}}, {"is shut down and rebooted": {"A": "is shut down and rebooted", "O": ["the computer"]}}], "32": [{"started": {"A": "started", "S": "The \u201cWinsSchMgmt\u201d service", "O": ["using \u201c-s\u201d as an argument", "another instance of the file"]}, "executed": {"A": "executed", "S": "The \u201cWinsSchMgmt\u201d service", "O": ["with \u201c-k\u201d as an argument", "the file"]}}], "33": [{"create": {"A": "create", "O": ["a new share \u201ccmd.exe /q /c net share shared$=%SystemRoot% /GRANT:everyone, FULL\u201d"]}}, {"Checking": {"A": "Checking", "O": ["via \u201c\\\\hostname\\admin$\\system32\u201d and \u201c\\\\hostname\\shared$\\system32\u201d", "for existing shares"]}}], "34": [{"is": {"A": "is", "S": "This file", "O": ["destructive malware"]}}], "35": [{"over-write": {"A": "over-write", "S": "the program", "O": ["with a program designed to cause further damage if the hard drive is re-booted", "the master boot record (MBR)"]}}], "36": [{"sends": {"A": "sends", "S": "The controller", "O": ["the byte \"!\" (0x21)", "to end the network connection"]}}], "37": [{"created": {"A": "created", "S": "the dropper", "O": ["a log file"]}}], "38": [{"contains": {"A": "contains", "S": "This tool", "O": ["proxy tool"]}}], "39": [{"installed": {"A": "installed", "S": "The second instance of the dropper file", "O": ["itself", "with \u201c-k\u201d as a command line argument", "as the \u201cWinsSchMgmt\u201d service"]}, "started": {"A": "started", "S": "The second instance of the dropper file", "O": ["the service"]}, "terminated": {"A": "terminated", "S": "The second instance of the dropper file"}}], "40": [{"is removed": {"A": "is removed", "O": ["the remote network share", "via \u201ccmd.exe /q /c net share shared$ /delete\u201d"]}}], "41": [{"is started": {"A": "is started", "O": ["The remote process", "via the command \u201ccmd.exe /c wmic.exe /node:hostname /user:username /password:pass PROCESS CALL CREATE\u201d"]}}], "42": [{"accepts": {"A": "accepts", "S": "The tool", "O": ["when it connects to C2", "new scan tasking"]}}], "43": [{"serves": {"A": "serves", "S": "This file", "O": ["as a dropper"]}}], "44": [{"drops": {"A": "drops", "S": "It", "O": ["destructive malware: \u201cigfxtrayex.exe\u201d"]}}], "45": [{"connect": {"A": "connect", "S": "it", "O": ["until connections to all three IP addresses have been attempted", "to another of the three IP addresses"]}}], "46": [{"is": {"A": "is", "S": "This", "O": ["a backdoor listener"]}}], "47": [{"makes": {"A": "makes", "S": "the \u201cigfxtrayex.exe\u201d", "O": ["three copies of itself"]}}], "48": [{"propagate": {"A": "propagate", "S": "This worm", "O": ["via Windows SMB shares"]}, "uses": {"A": "uses", "S": "This worm", "O": ["a brute force authentication attack"]}}], "49": [{"are then executed": {"A": "are then executed", "O": ["These copies"]}}]}, "targeted_attacks_against_the_energy_sector.tokens": {"0": [{"is delivered": {"A": "is delivered", "O": ["a link to a malicious website or a malicious attachment", "using social engineering techniques"]}}, {"send": {"A": "send", "O": ["spear phishing emails"]}}], "1": [{"were sent": {"A": "were sent", "O": ["from two Freemailer accounts", "to 291 individuals at the targeted company", "A wave of spear phishing emails"]}}], "2": [{"were used": {"A": "were used", "O": ["spear phishing messages", "to compromise additional computers"]}}], "3": [{"infects": {"A": "infects", "S": "the attacker", "O": ["a website that has a high likelihood of being visited by the intended victim"]}}, {"is": {"A": "is", "S": "The second method", "O": ["watering hole attacks"]}}], "4": [{"locks": {"A": "locks", "S": "ransomware", "O": ["PCs"]}}, {"steal": {"A": "steal", "S": "financial Trojans", "O": ["passwords and credit card details"]}}], "5": [{"creating": {"A": "creating", "S": "The dropper component", "O": ["all the required files on the system"]}, "registering": {"A": "registering", "S": "The dropper component", "O": ["a service called \u201cTrkSvr\u201d"]}, "start": {"A": "start", "S": "The dropper component", "O": ["with Windows", "itself"]}}], "6": [{"is first analyzed": {"A": "is first analyzed", "O": ["the infected system", "to ensure that it is of interest to them"]}}], "7": [{"send": {"A": "send", "S": "some malware samples", "O": ["so as not to swamp the network or generate network spikes that might attract attention", "in smaller bursts", "the data"]}}], "8": [{"provides": {"A": "provides", "S": "The back door", "O": ["full remote access", "to the compromised computers"]}, "allowing": {"A": "allowing", "S": "The back door", "O": ["for extraction of any data"]}}], "9": [{"preventing": {"A": "preventing", "S": "This", "O": ["for eight hour", "from loading", "till the unaffected backup code was reinstalled on the PLCs", "oil tankers"]}, "halted": {"A": "halted", "S": "This", "O": ["machinery"]}}], "10": [{"Spreading": {"A": "Spreading", "S": "it", "O": ["through infected portable media drives"]}, "infect": {"A": "infect", "S": "it", "O": ["networks isolated by air gaps that are unreachable from the Internet"]}}], "11": [{"rendering": {"A": "rendering", "S": "The malware", "O": ["unusable", "the computer"]}, "deletes": {"A": "deletes", "S": "The malware", "O": ["the master boot record"]}}], "12": [{"disrupted and partially destroyed": {"A": "disrupted and partially destroyed", "S": "The sabotage payload", "O": ["the cascaded high frequency gas centrifuges"]}}], "13": [{"finding": {"A": "finding", "S": "The attacks", "O": ["project details and financial information about oil and gas field exploration and bids"]}}], "14": [{"communicated": {"A": "communicated", "S": "a common Backdoor.Trojan", "O": ["back to the C&C server"]}, "allowing": {"A": "allowing", "S": "a common Backdoor.Trojan", "O": ["remote access to the computer"]}}, {"was installed": {"A": "was installed", "O": ["a common Backdoor.Trojan", "On compromised computers"]}}], "15": [{"copy": {"A": "copy", "S": "It", "O": ["to accessible network shares", "itself"]}, "execute": {"A": "execute", "S": "It", "O": ["remotely", "itself", "if successfully copied"]}}], "16": [{"send": {"A": "send", "S": "the malware", "O": ["the data", "once it\u2019s directly connected to the Internet, such as from a Wi-Fi hotspot at an airport"]}, "use": {"A": "use", "S": "the malware", "O": ["location awareness", "to detect if the compromised computer is outside of the corporate network"]}}], "17": [{"render": {"A": "render", "S": "Disttrack", "O": ["the computers unusable"]}, "wiping": {"A": "wiping", "S": "Disttrack", "O": ["the operating system and master boot record"]}, "steal": {"A": "steal", "S": "Disttrack", "O": ["valuable information", "from infected computers"]}}], "18": [{"make": {"A": "make", "S": "Tricks like these", "O": ["the detection of the malware", "more difficult"]}}], "19": [{"gathers": {"A": "gathers", "S": "the attacker", "O": ["passwords"]}, "maps": {"A": "maps", "S": "the attacker", "O": ["the internal network"]}}], "20": [{"were made": {"A": "were made", "O": ["to appear to be linked to the company in relation to the subject and attachment chosen", "They"]}}], "21": [{"obfuscate": {"A": "obfuscate", "S": "More sophisticated attackers", "O": ["the data", "by XOR-ing it, encrypting it with proper asymmetric encryption or embedding it into media files using steganography", "to hide the data from traffic inspection"]}}], "22": [{"download": {"A": "download", "S": "Trojan droppers", "O": ["additional malware"]}}, {"was": {"A": "was", "S": "The malware chosen", "O": ["a variant of the Poison Ivy Trojan Backdoor.Darkmoon"]}}], "23": [{"spread": {"A": "spread", "O": ["through a known password in the WinCC database"]}}, {"spread": {"A": "spread", "O": ["through an old Windows RPC (remote procedure calls) vulnerability"]}}, {"spread": {"A": "spread", "S": "it", "O": ["through network shares"]}}, {"spread": {"A": "spread", "O": ["through a printer spooler vulnerability"]}}], "24": [{"began": {"A": "began", "S": "the Stuxnet operation", "O": ["with the registration of the command and control (C&C) servers used in the attacks", "in November 2005"]}}], "25": [{"upload": {"A": "upload", "S": "The simple attacks", "O": ["through a HTTP POST request to a remote drop server", "them"]}, "compress": {"A": "compress", "S": "The simple attacks", "O": ["the files"]}}], "26": [{"targeted": {"A": "targeted", "S": "The early version of Stuxnet", "O": ["the S7- 417 PLCs"]}, "modified": {"A": "modified", "S": "The early version of Stuxnet", "O": ["its valve settings"]}}], "27": [{"uses": {"A": "uses", "S": "Stuxnet", "O": ["to spread and infect its targets", "seven vulnerabilities"]}}], "28": [{"swap": {"A": "swap", "S": "the attacker", "O": ["an update of legitimate software", "for a maliciously crafted version"]}}], "29": [{"act": {"A": "act", "S": "a previously compromised computer in the DMZ", "O": ["as a proxy"]}, "forwarding": {"A": "forwarding", "S": "a previously compromised computer in the DMZ", "O": ["all the collected data"]}}], "30": [{"delete": {"A": "delete", "S": "the malware", "O": ["after three successful propagations", "from it", "itself"]}, "hide": {"A": "hide", "S": "the malware", "O": ["its own files"]}}], "31": [{"executed": {"A": "executed", "S": "Stuxnet", "O": ["slightly different infection routines depending on the security software installed on the target", "To hide its activity even further"]}}], "32": [{"contained": {"A": "contained", "S": "The emails all", "O": ["malicious attachments"]}}], "33": [{"overwriting": {"A": "overwriting", "S": "The malware", "O": ["them", "with a JPEG image or 192KB blocks of random data"]}, "collects": {"A": "collects", "S": "The malware", "O": ["file names"]}}], "34": [{"install": {"A": "install", "S": "attackers", "O": ["key loggers"]}, "dump": {"A": "dump", "S": "attackers", "O": ["local credentials"]}, "search": {"A": "search", "S": "attackers", "O": ["for saved accounts", "local storage"]}, "sniff": {"A": "sniff", "S": "attackers", "O": ["the network", "for passwords"]}}], "35": [{"push": {"A": "push", "S": "the attackers", "O": ["on to many systems", "before they triggered the destructive payload", "the malware"]}, "acquiring": {"A": "acquiring", "S": "the attackers", "O": ["user credentials"]}}], "36": [{"autonomously infect": {"A": "autonomously infect", "S": "the malware", "O": ["removable drives, like USB sticks, or project files for PLCs"]}}], "37": [{"used": {"A": "used", "S": "The attackers", "O": ["a Trojan", "to gain access to the control for the gas pipelines"]}}], "38": [{"restart": {"A": "restart", "S": "the back door", "O": ["with Windows"]}, "create": {"A": "create", "S": "the back door", "O": ["a registry run key"]}, "connect": {"A": "connect", "S": "the back door", "O": ["to one of three C&C servers located in Greece"]}}, {"installed": {"A": "installed", "O": ["the back door"]}}], "39": [{"plan": {"A": "plan", "S": "Some groups", "O": ["watering hole attacks"]}}], "40": [{"become": {"A": "become", "S": "The payload", "O": ["active", "if the fingerprint in the found PLC setup matched a given configuration setup"]}}], "41": [{"contained": {"A": "contained", "S": "All of the emails", "O": ["the same Trojan.Dropper"]}}, {"disguised": {"A": "disguised", "S": "the same Trojan.Dropper", "O": ["as an attachment with the filename AVP.dll"]}}], "42": [{"sending": {"A": "sending", "S": "The reporter component", "O": ["back a HTTP GET request", "to the C&C server"]}}], "43": [{"use": {"A": "use", "S": "they", "O": ["to spread further into the network", "zero-day vulnerabilities"]}}], "44": [{"spread": {"A": "spread", "S": "malware", "O": ["into such isolated networks", "as demonstrated many times by threats such as Stuxnet"]}}], "45": [{"target and sabotage": {"A": "target and sabotage", "S": "Stuxnet", "O": ["industrial control systems"]}}], "46": [{"compromises": {"A": "compromises", "S": "The attacker", "O": ["the network"]}, "delivering": {"A": "delivering", "S": "The attacker", "O": ["targeted malware", "to vulnerable systems or employees"]}}], "47": [{"get": {"A": "get", "S": "an attacking group", "O": ["access to the SCADA network of the oil tanker loading machinery"]}, "overwrote": {"A": "overwrote", "S": "an attacking group", "O": ["programmable logic controllers (PLCs)", "with an empty program module"]}}], "48": [{"bypass": {"A": "bypass", "S": "the traffic", "O": ["perimeter security"]}, "receive": {"A": "receive", "S": "the traffic", "O": ["less scrutiny"]}}], "49": [{"compromising": {"A": "compromising", "S": "The attackers", "O": ["through SQL injection and installing Web shells on them", "public facing Web servers"]}}], "50": [{"recorded": {"A": "recorded", "S": "the threat", "O": ["measurement readings during normal operation"]}, "played": {"A": "played", "S": "the threat", "O": ["those back in a loop"]}}], "51": [{"infect": {"A": "infect", "S": "the worm", "O": ["whenever the engineer exchanged the project files", "computers"]}}], "52": [{"jumping": {"A": "jumping", "S": "the malware", "O": ["into isolated networks", "air gaps"]}, "introduced": {"A": "introduced", "S": "the malware", "O": ["to the destination network"]}}], "53": [{"move": {"A": "move", "S": "them", "O": ["using the gathered passwords", "on to other internal computers"]}}], "54": [{"used": {"A": "used", "S": "The attack", "O": ["in every instance", "the same infected Microsoft Word document"]}}], "55": [{"provided": {"A": "provided", "S": "The back door", "O": ["full access to the compromised computers"]}}], "56": [{"went": {"A": "went", "S": "the safety monitoring system of the Ohio nuclear power plant", "O": ["offline", "for several hours", "due to a Slammer worm infection"]}}], "57": [{"sent": {"A": "sent", "O": ["to targets in nine different sectors", "from 26 different email addresses", "944 emails"]}, "was used": {"A": "was used", "O": ["\u201cWage Data 2012\u201d", "in 944 emails"]}}], "58": [{"using": {"A": "using", "S": "the attacker", "O": ["before infecting any visitor of such sites", "IP address filters"]}}], "59": [{"been used": {"A": "been used", "O": ["since 2010", "The last C&C server", "in similar attacks against other companies"]}}], "60": [{"find": {"A": "find", "S": "the attacker"}, "extract": {"A": "extract", "S": "the attacker"}}], "61": [{"sniff": {"A": "sniff", "S": "they", "O": ["authentication messages"]}, "dump": {"A": "dump", "S": "they", "O": ["password hashes"]}, "harvest": {"A": "harvest", "S": "they", "O": ["local passwords"]}}], "62": [{"hijacking": {"A": "hijacking", "O": ["for further distribution", "local software distribution systems"]}}], "63": [{"wiping": {"A": "wiping", "S": "Disttrack", "O": ["the master boot record", "with the same data"]}}], "64": [{"make": {"A": "make", "S": "wiping", "O": ["forensics"]}, "destroy": {"A": "destroy", "S": "wiping", "O": ["evidence of the attack"]}}], "65": [{"gains": {"A": "gains", "S": "the attacker", "O": ["control over the computer", "Once the victim installs the genuine looking update"]}}], "66": [{"posing": {"A": "posing", "S": "a malicious Downloader \u201cclbcatq.dll\u201d", "O": ["as Windows update"]}, "load": {"A": "load", "S": "a malicious Downloader \u201cclbcatq.dll\u201d", "O": ["the malicious code", "in Windows"]}}, {"drops": {"A": "drops", "S": "The malware itself", "O": ["a malicious Downloader \u201cclbcatq.dll\u201d", "into a newly created \u201cwuauclt\u201d directory"]}}], "67": [{"infect": {"A": "infect", "S": "they", "O": ["all connected systems", "at once"]}}], "68": [{"reports": {"A": "reports", "S": "It", "O": ["the domain name, IP address and number of files overwritten"]}}], "69": [{"resumed": {"A": "resumed", "S": "the group", "O": ["using a different exploit", "the watering hole attack"]}}], "70": [{"infect": {"A": "infect", "S": "it", "O": ["Step7 project files, which are used to control Programmable Logic Controllers (PLCs)"]}}], "71": [{"came": {"A": "came", "S": "The spear phishing emails", "O": ["from 234 spoofed addresses"]}}], "72": [{"was targeted": {"A": "was targeted", "S": "a sabotage attack", "O": ["a marine terminal in Venezuela"]}}], "73": [{"sent back": {"A": "sent back", "O": ["the valuable information", "to the attacker"]}, "is copied": {"A": "is copied", "O": ["the valuable information"]}}], "74": [{"posing": {"A": "posing", "O": ["as a genuine Wi-Fi hotspot"]}}], "75": [{"focused": {"A": "focused", "S": "The later version of the threat", "O": ["on the S7-315 PLCs"]}, "manipulating": {"A": "manipulating", "S": "The later version of the threat", "O": ["the spinning frequency of the rotating motors"]}}], "76": [{"learn": {"A": "learn", "S": "the attacker", "O": ["about installed security tools, saved links to internal platforms and local address books"]}}], "77": [{"sent back": {"A": "sent back", "O": ["to the attackers", "the interesting data"]}, "is gathered": {"A": "is gathered", "O": ["the interesting data"]}}], "78": [{"imitates": {"A": "imitates", "S": "The chosen names of the C&C server domains", "O": ["in a bid to be overlooked by the system administrators when checking their logs", "legitimate services"]}}], "79": [{"damage": {"A": "damage", "S": "sabotage attacks", "O": ["equipment"]}}], "80": [{"be manipulated": {"A": "be manipulated", "O": ["smart meters", "to send back false information or report incorrect billing IDs, leading to power theft"]}}], "81": [{"know": {"A": "know", "S": "the attackers", "O": ["the internals of the infected networks"]}, "identified": {"A": "identified", "S": "the attackers", "O": ["systems with interesting data or with connected industrial control systems"]}}], "82": [{"drops": {"A": "drops", "S": "The module", "O": ["a legitimate and digitally signed device driver that provides low level disk access from user space"]}}], "83": [{"used": {"A": "used", "S": "Spear phishing", "O": ["to attack companies"]}}], "84": [{"are used": {"A": "are used", "O": ["to comb through local files and create network mappings", "Often small scripts or even manual commands"]}}], "85": [{"is used": {"A": "is used", "O": ["a regular off-the-shelf back door Trojan"]}}], "86": [{"making": {"A": "making", "S": "Part of the malware code was signed with stolen digital certificates", "O": ["it", "harder to detect by security tools"]}}], "87": [{"taken out": {"A": "taken out", "S": "cyberattacks", "O": ["power equipment in multiple cities outside the United States"]}}], "88": [{"installed": {"A": "installed", "S": "they", "O": ["other back door Trojans"]}}], "89": [{"stolen": {"A": "stolen", "O": ["employee or customer records"]}}], "90": [{"breaking in and compromising": {"A": "breaking in and compromising", "O": ["computers"]}}]}, "Targeting_Syrian_ISIS_Critics.tokens": {"0": [{"using": {"A": "using", "S": "programs", "O": ["them"]}}, {"adds": {"A": "adds", "S": "the program nvidrv", "O": ["to autorun", "itself"]}}, {"creates": {"A": "creates", "S": "It", "O": ["a series of registry keys that the individual programs use to communicate"]}}, {}], "1": [{"perform": {"A": "perform", "S": "a series of executable files", "O": ["communication"]}}, {"left": {"A": "left", "O": ["in the registry", "markers"]}}, {"writes": {"A": "writes", "S": "The AdobeR1 file", "O": ["a series of executable files"]}}, {"is": {"A": "is", "S": "The program sequence of data collection and sending", "O": ["somewhat unusual"]}}], "2": [{"sends": {"A": "sends", "S": "the malware", "O": ["data captured by the malware", "to an e-mail address"]}}], "3": [{"cleans up": {"A": "cleans up", "S": "GooglUpd", "O": ["the program files", "if they exist"]}}, {"runs": {"A": "runs", "S": "It", "O": ["GooglUpd"]}}], "4": [{"developed": {"A": "developed", "S": "This attack", "O": ["in the seeding materials and bait document", "social engineering"]}}], "5": [{"Use": {"A": "Use", "O": ["widely available RATs"]}}], "6": [{"resend": {"A": "resend", "S": "the malware", "O": ["to the attacker", "with each reboot", "them"]}, "identify and unmask": {"A": "identify and unmask", "S": "the malware", "O": ["the IP address of target(s)"]}}], "7": [{"exfiltrating": {"A": "exfiltrating", "S": "it", "O": ["credentials from Facebook and hooking programs like Skype"]}, "drop": {"A": "drop", "S": "it", "O": ["a second stage", "from a compromised site"]}}], "8": [{"was exceptionally targeted": {"A": "was exceptionally targeted", "O": ["This attack"]}}], "9": [{"sends": {"A": "sends", "S": "The malware", "O": ["an e-mail", "to the same inbox"]}}], "10": [{"was sent": {"A": "was sent", "O": ["from a Gmail email address", "at the end of November 2014", "The unsolicited message below", "to RSS"]}}], "11": [{"transmitting": {"A": "transmitting", "O": ["via encrypted e-mail communications", "data"]}}, {"reduce": {"A": "reduce", "O": ["the visibility of malware on a network"]}}], "12": [{"is transmitted": {"A": "is transmitted", "O": ["by e-mail", "to an account presumably controlled by the attacker", "Data"]}}, {"zips": {"A": "zips", "S": "Program \u201cAdobeIns.exe\u201d", "O": ["them", "in an encrypted, password- protected file"]}}], "13": [{"zips": {"A": "zips", "S": "AdobeIns", "O": ["the contents of the win32.tmp folder"]}}, {"performs": {"A": "performs", "S": "\u201crundl132.exe\u201d", "O": ["an HTTP GET request", "to myexternalip.com"]}, "collects": {"A": "collects", "S": "\u201crundl132.exe\u201d", "O": ["the external IP of the infected machine"]}}, {"writes": {"A": "writes", "S": "rundl132", "O": ["the external IP"]}}, {"runs": {"A": "runs", "S": "rundl132", "O": ["AdobeIns"]}}], "14": [{"resends": {"A": "resends", "S": "The malware", "O": ["the information", "each time the computer is restarted"]}}], "15": [{"sent": {"A": "sent", "O": ["a highly targeted attack", "to an e-mail address belonging to RSS"]}}], "16": [{"connects": {"A": "connects", "S": "AdobeIns", "O": ["using hardcoded credentials", "via smtp", "to an account", "at the online e-mail provider inbox.com"]}}], "17": [{"registered": {"A": "registered", "S": "It", "O": ["only 6/55 detections by anti virus scanners, or a 10% detection rate"]}}], "18": [{"is sent": {"A": "is sent", "O": ["to an Internet e-mail address", "data"]}}], "19": [{"checking": {"A": "checking", "S": "It", "O": ["whether registry key name \u201c6\u201d is present"]}, "runs": {"A": "runs", "S": "It", "O": ["if it has not before", "rundl132"]}}], "20": [{"executes": {"A": "executes", "S": "the \u201cslideshow.zip\u201d file", "O": ["several files", "When writes several files"]}, "writes": {"A": "writes", "S": "the \u201cslideshow.zip\u201d file", "O": ["When opened", "several files executes When opened"]}}], "21": [{"sends": {"A": "sends", "S": "The malware", "O": ["an e-mail containing the victim\u2019s IP address and miscellaneous system information"]}}], "22": [{"transmits": {"A": "transmits", "S": "The malware"}, "leaving": {"A": "leaving", "S": "The malware", "O": ["for the attacker to collect at a later time", "the material", "in an inbox"]}}], "23": [{"triggered": {"A": "triggered", "S": "the attacker", "O": ["the execution of a file on the victim\u2019s system"]}}], "24": [{"attract": {"A": "attract", "S": "the program", "O": ["less attention"]}, "looks": {"A": "looks", "S": "the program", "O": ["less like malware"]}}], "25": [{"profiled": {"A": "profiled", "S": "custom malware", "O": ["the victim\u2019s computer"]}, "beaconed": {"A": "beaconed", "S": "custom malware", "O": ["to an e-mail account under the attacker\u2019s control", "its IP address"]}}], "26": [{"used": {"A": "used", "O": ["hardcoded e-mail", "to exfiltrate"]}}], "27": [{"beacons": {"A": "beacons", "S": "The custom malware used in this attack", "O": ["each time the computer restarts", "home", "with details about his or her system"]}, "infects": {"A": "infects", "S": "The custom malware used in this attack", "O": ["a user who views the decoy \u201cslideshow,\u201d"]}}], "28": [{"aims": {"A": "aims", "S": "the malware seeding", "O": ["at classes of people"]}}], "29": [{"sets": {"A": "sets", "S": "It", "O": ["to \u201c0\u201d", "the key"]}, "runs": {"A": "runs", "S": "It", "O": ["it"]}}], "30": [{"beacons": {"A": "beacons", "S": "The malware", "O": ["location"]}}], "31": [{"exfiltrates": {"A": "exfiltrates", "S": "The malware", "O": ["to an online e-mail account"]}}], "32": [{"runs": {"A": "runs", "S": "nvidrv", "O": ["svhosts"]}}, {"doing": {"A": "doing", "S": "svhosts", "O": ["a DNS query for windowsupdate.microsoft.com"]}, "tests": {"A": "tests", "S": "svhosts", "O": ["Internet connectivity"]}}], "33": [{"located": {"A": "located", "S": "At least one command-and-control server", "O": ["within Syrian IP space"]}}], "34": [{"dropped": {"A": "dropped", "O": ["markers", "in the Registry"]}}], "35": [{"uses": {"A": "uses", "S": "the malware", "O": ["the old PKWARE implementation of zip encryption"]}}], "36": [{"are deleted": {"A": "are deleted", "O": ["When the slideshow is closed", "both AdobeR1.exe and pictures.exe"]}}], "37": [{"identifying and locating": {"A": "identifying and locating", "S": "it", "O": ["a target"]}}], "38": [{"writes": {"A": "writes", "S": "AdbrRader", "O": ["the file vgadmysadm.tmp with the name of another registry key \u201c2\u201d", "with startup info"]}}], "39": [{"Transmitting": {"A": "Transmitting", "O": ["the malware", "via e-mail"]}}], "40": [{"is": {"A": "is", "S": "it", "O": ["exceptionally targeted"]}}], "41": [{"Use": {"A": "Use", "O": ["to obscure the binary", "\u201ccrypters\u201d"]}}], "42": [{"obtain": {"A": "obtain", "S": "The seeding", "O": ["a \u2018private\u2019 Facebook identity"]}}], "43": [{"social engineer": {"A": "social engineer", "S": "the attacker", "O": ["the identity of individuals working with RSS"]}}], "44": [{"took": {"A": "took", "S": "The attack", "O": ["the form of an unsolicited e-mail containing a download link to a decoy file"]}}], "45": [{"was used": {"A": "was used", "O": ["e-mail", "to transmit data"]}}], "46": [{"serve": {"A": "serve", "S": "this malware", "O": ["as a beacon"]}}]}, "The_Epic_Turla_Operation.tokens": {"0": [{"uploaded": {"A": "uploaded", "S": "the attackers", "O": ["to the victim's machine", "another tool"]}}, {}], "1": [{"achieve": {"A": "achieve", "S": "the backdoor", "O": ["administrator privileges on the system"]}, "run": {"A": "run", "S": "the backdoor", "O": ["unrestricted"]}}], "2": [{"used": {"A": "used", "O": ["in the Epic attacks", "The primary backdoor"]}}], "3": [{"are sent": {"A": "are sent", "O": ["The replies", "back to the C&C", "through the same channel"]}}], "4": [{"attempt": {"A": "attempt", "S": "several versions of this script", "O": ["various exploitation mechanisms"]}}], "5": [{"has": {"A": "has", "S": "The backdoor extracted from the Java exploits", "O": ["the following C&C"]}}], "6": [{"commanded": {"A": "commanded", "S": "the Epic Turla attackers", "O": ["The huge network"]}}], "7": [{"used": {"A": "used", "S": "the exploitation servers", "O": ["in the watering hole attacks"]}}, {"delivering": {"A": "delivering", "S": "The mothership", "O": ["Java, IE or fake applications", "to the victim"]}, "work": {"A": "work", "S": "The mothership", "O": ["as the exploitation servers"]}}], "8": [{"takes": {"A": "takes", "O": ["social engineering", "advantage"]}}, {"was distributed": {"A": "was distributed", "O": ["at \"hxxp://mfa[.]tj/upload/security.php\"", "from the Ministry of Foreign Affairs of Tajikistan's website", "This file"]}}, {"trick": {"A": "trick", "O": ["into running a fake Flash Player", "the user"]}}, {"trick": {"A": "trick", "S": "they", "O": ["into downloading and running a fake Microsoft Security Essentials app", "the user"]}}], "9": [{"decrypts and processes": {"A": "decrypts and processes", "S": "the malware", "O": ["the C&C replies"]}, "uses": {"A": "uses", "S": "The communication protocol", "O": ["in the C&C replies", "requests"]}}], "10": [{"be updated": {"A": "be updated", "S": "the attackers", "O": ["The configuration", "via the C&C"]}}], "11": [{"send": {"A": "send", "S": "the attackers", "O": ["a template of commands"]}}, {"move": {"A": "move", "S": "the attackers", "O": ["using pre-defined or collected passwords", "through the victim's network"]}}, {"\"checks in\"": {"A": "\"checks in\"", "S": "a victim", "O": ["with the server"]}}, {"is infected": {"A": "is infected", "O": ["a victim"]}}], "12": [{"are commanded": {"A": "are commanded", "S": "a huge network of hacked servers", "O": ["The Epic backdoors"]}, "deliver": {"A": "deliver", "S": "a huge network of hacked servers", "O": ["command and control functionality"]}}], "13": [{"upload": {"A": "upload", "S": "the attackers", "O": ["several tools that are used for lateral movement"]}}, {"is compromised": {"A": "is compromised", "O": ["a victim"]}}], "14": [{"were saved": {"A": "were saved", "S": "the attackers", "O": ["detailed victim statistics", "for debugging purposes"]}}], "15": [{"upgraded": {"A": "upgraded", "O": ["to the Turla Carbon system", "they"]}}], "16": [{"exploit": {"A": "exploit", "S": "The Java files", "O": ["a popular vulnerability", "in various configurations"]}}, {"exploit": {"A": "exploit", "S": "Another more recent version", "O": ["Oracle Sun Java and Adobe Flash Player"]}}, {}], "17": [{"function": {"A": "function", "O": ["as exploitation sites", "the motherships"]}}], "18": [{"use": {"A": "use", "S": "The Java exploit", "O": ["a special loader"]}}, {"dropped": {"A": "dropped", "S": "Java exploits", "O": ["The payload"]}}, {"inject": {"A": "inject", "S": "a special loader", "O": ["into explorer.exe", "the final Epic backdoor payload"]}}], "19": [{"connects": {"A": "connects", "S": "an Epic backdoor", "O": ["to the following C&Cs", "with a generic internal ID of 1156fd22- 3443-4344-c4ffff"]}}, {"is": {"A": "is", "S": "This", "O": ["an Epic backdoor"]}}], "20": [{"validate": {"A": "validate", "S": "This", "O": ["the high profile victim"]}}], "21": [{"contains": {"A": "contains", "S": "The file", "O": ["an encrypted resource"]}}], "22": [{"identify": {"A": "identify", "S": "an internal unique ID", "O": ["the victim", "to the C&C"]}}, {"terminate": {"A": "terminate", "S": "it", "O": ["itself"]}}, {"identify": {"A": "identify", "S": "The backdoor", "O": ["the following processes"]}}], "23": [{"sent": {"A": "sent", "S": "the attackers", "O": ["a large amount of commands", "to the victims"]}}], "24": [{"talk": {"A": "talk", "S": "a second level of proxies", "O": ["to the \"mothership\" server"]}}, {"talk": {"A": "talk", "S": "The first level of command and control proxies", "O": ["to a second level of proxies"]}}], "25": [{"called": {"A": "called", "S": "the Turla attackers", "O": ["This backdoor"]}}, {}], "26": [{"sends": {"A": "sends", "S": "the backdoor", "O": ["During the first C&C call", "a pack with the victim's system information"]}}], "27": [{"is upgraded": {"A": "is upgraded", "O": ["to more sophisticated backdoors", "this"]}}], "28": [{"target": {"A": "target", "S": "a vast network of watering holes", "O": ["visitors", "with surgical precision"]}}, {"run": {"A": "run", "S": "the Epic attackers", "O": ["a vast network of watering holes"]}}], "29": [{"implemented": {"A": "implemented", "S": "the attackers", "O": ["for the C&C logs", "RSA encryption"]}}], "30": [{"interact": {"A": "interact", "S": "the Control panel software", "O": ["with the victims"]}}, {"runs": {"A": "runs", "S": "The mothership server", "O": ["the Control panel software"]}}], "31": [{"targeted": {"A": "targeted", "S": "they", "O": ["two ranges"]}}], "32": [{"was delivered": {"A": "was delivered", "O": ["The sample e9580b6b13822090db018c320e80865f", "to several Epic victims", "as an upgraded backdoor"]}}], "33": [{"upload": {"A": "upload", "S": "the attackers", "O": ["another Epic backdoor"]}, "is confirmed": {"A": "is confirmed", "S": "the attackers", "O": ["a victim", "as \"interesting\""]}}, {"control": {"A": "control", "S": "another Epic backdoor", "O": ["this specific victim"]}}], "34": [{"using": {"A": "using", "S": "the attackers", "O": ["\"JPG\" files", "to run PHP scripts"]}}], "35": [{"define": {"A": "define", "S": "the attackers", "O": ["the IP ranges they are interested in"]}}], "36": [{"using": {"A": "using", "S": "them", "O": ["yet another technique coupled with watering hole attacks"]}}], "37": [{"implements": {"A": "implements", "S": "The main backdoor", "O": ["on top of normal HTTP requests", "a C&C protocol"]}}], "38": [{"acts": {"A": "acts", "S": "This", "O": ["as a dropper for the following modules"]}}], "39": [{"contains": {"A": "contains", "S": "The payload", "O": ["a loader/injector"]}}], "40": [{"is encrypted": {"A": "is encrypted", "O": ["All further information", "with a public key framework"]}, "sent": {"A": "sent", "O": ["All further information", "to the C&C"]}}], "41": [{"are run": {"A": "are run", "O": ["in tandem", "both backdoors"]}}], "42": [{"are encrypted": {"A": "are encrypted", "O": ["The commands from the C&C"]}}], "43": [{"decide": {"A": "decide", "S": "they", "O": ["whether to infect the visitors or not"]}}], "44": [{"use": {"A": "use", "S": "The attackers", "O": ["to infect their victims", "both direct spearphishing and watering hole attacks"]}}], "45": [{"load": {"A": "load", "S": "Injected websites", "O": ["a remote JavaScript", "into the victim's browser"]}}], "46": [{"uses": {"A": "uses", "S": "the threat actor", "O": ["a custom backdoor"]}}], "47": [{"is": {"A": "is", "S": "This", "O": ["a keylogger tool"]}}], "48": [{"exploit": {"A": "exploit", "S": "One version of this script", "O": ["Internet Explorer versions 6, 7 and 8"]}}], "49": [{"deploy": {"A": "deploy", "S": "These top level packages", "O": ["both updated Epic backdoors and Turla Carbon system backdoors", "to confirmed victims"]}}], "50": [{"obtain": {"A": "obtain", "S": "the attackers", "O": ["the necessary credentials", "without the victim noticing"]}}, {"deploy": {"A": "deploy", "S": "they", "O": ["the rootkit and other extreme persistence mechanisms"]}}], "51": [{"using": {"A": "using", "S": "the Miniduke threat actor", "O": ["the same backdoor", "on their hacked servers"]}}], "52": [{"find": {"A": "find", "S": "the attackers", "O": ["e-mails related to \"NATO\", \"Energy Dialogue within European Unition\" and so on"]}}], "53": [{"drops": {"A": "drops", "S": "This", "O": ["the malicious file with the MD5 7731d42b043865559258464fe1c98513"]}}], "54": [{"are infected": {"A": "are infected", "O": ["victims", "via a sophisticated multi-stage attack"]}}], "55": [{"obfuscated": {"A": "obfuscated", "O": ["the backdoor"]}}]}, "The_Monju_Incident.tokens": {"0": [{"denote": {"A": "denote", "S": "a term used in the PRC hacking community", "O": ["the act of Antivirus avoidance through the loading of malicious \u2018black\u2019 code via non-malicious or trusted \u2018white\u2018 code"]}}, {}], "1": [{"ensuring": {"A": "ensuring", "S": "The installer", "O": ["the malware is launched on system start-up"]}, "determine": {"A": "determine", "S": "The installer", "O": ["the system architecture (32- or 64-bit)"]}, "deobfuscate": {"A": "deobfuscate", "S": "The installer", "O": ["the relevant loader DLL to the path \u2018C:\\Windows\\temp\\install.ocx\u2019"]}}, {"is": {"A": "is", "S": "The installer", "O": ["responsible for the malware persistence mechanism"]}, "adding": {"A": "adding", "S": "The installer", "O": ["to the registry", "entries", "in the following locations"]}}], "2": [{"mean": {"A": "mean", "S": "a phrase commonly used by People\u2019s Republic of China (PRC) hackers", "O": ["\u2018anti Antivirus detection\u2019 or \u2018Antivirus avoidance\u2019"]}}, {"similarly means": {"A": "similarly means", "S": "Mi\u01cench\u00e1 (\u514d\u67e5, likely shorthand for \u514d\u6740\u67e5)", "O": ["\u2018Antivirus avoidance\u2019"]}}, {}], "3": [{"was spread": {"A": "was spread", "S": "Gh0st RAT", "O": ["via watering hole attacks utilising vulnerable websites belonging to financial services and technology companies"]}}], "4": [{"gained": {"A": "gained", "S": "attackers", "O": ["entry", "via a PHP-based webshell"]}, "compromise": {"A": "compromise", "S": "attackers", "O": ["the GOM Player update server (app.gomlab.com)"]}}], "5": [{"harvested": {"A": "harvested", "S": "the attacker", "O": ["Among other items, staff training documents and more than 40,000 emails"]}}], "6": [{"communicates": {"A": "communicates", "S": "the main implant code", "O": ["on TCP port 443", "with the attacker-controlled server at testqweasd.tk (211.43.220.89)"]}}, {"reads": {"A": "reads", "S": "The loader"}, "deobfuscates": {"A": "deobfuscates", "S": "The loader"}}], "7": [{"hijacking": {"A": "hijacking", "S": "DLL load order", "O": ["alongside a signed (trusted) executable"]}}], "8": [{"compromised": {"A": "compromised", "S": "the attackers", "O": ["the \u2018GOM Player\u2019 update server"]}}, {"act as": {"A": "act as", "S": "it", "O": ["a \u2018watering hole\u2019"]}}, {"are delivered": {"A": "are delivered", "O": ["machines which access the site", "malware"]}}], "9": [{"obfuscated": {"A": "obfuscated", "O": ["with a one-byte XOR with 0x14", "DLLs"]}}], "10": [{"was deliver": {"A": "was deliver", "O": ["to the victim", "a file containing both the legitimate update and the malware"]}}], "11": [{"Deployed": {"A": "Deployed", "O": ["the malware", "to the system", "via a compressed bundle containing the official GOM Player setup binary and a self-extracting RAR archive containing the malicious files"]}}], "12": [{"delivering": {"A": "delivering", "S": "Gh0st RAT", "O": ["system-specific details", "back to the attacker"]}, "deploy": {"A": "deploy", "S": "Gh0st RAT", "O": ["additional malware"]}}, {"harvesting": {"A": "harvesting", "S": "additional malware", "O": ["sensitive data"]}, "enabling": {"A": "enabling", "S": "additional malware", "O": ["the further propagation throughout the infected network"]}}], "13": [{"is automatically launched": {"A": "is automatically launched", "O": ["the installer component (0ae82fd94836815a1e8d284ccb75109d)", "alongside the GOM Player update"]}}], "14": [{"manifested": {"A": "manifested", "S": "these alterations", "O": ["themselves", "for visitors on certain IP ranges"]}}], "15": [{"be": {"A": "be", "S": "it", "O": ["a variant of a Trojan"]}}]}, "The_Uroburos_case.tokens": {"0": [{"is": {"A": "is", "S": "Agent.BTZ", "O": ["a common RAT"]}}], "1": [{"is performed": {"A": "is performed", "S": "named pipe", "O": ["The communication between the processes"]}}], "2": [{"is loaded": {"A": "is loaded", "O": ["into all processes", "the shdocvw.tlp library"]}}], "3": [{"is only executed": {"A": "is only executed", "O": ["in explorer.exe", "the main part (payload) of the malware"]}}, {"is loaded": {"A": "is loaded", "O": ["into each and every process of the infected machine", "The malware"]}}], "4": [{"install": {"A": "install", "S": "The dropper", "O": ["a second file"]}}], "5": [{"shared": {"A": "shared", "S": "the attackers", "O": ["a C&C domain"]}}], "6": [{"is performed": {"A": "is performed", "S": "the browser process", "O": ["ComRAT\u2019s communication to the command and control server"]}}, {"avoid": {"A": "avoid", "O": ["being blocked by a firewall on the system or any additional security products"]}}], "7": [{"is stored": {"A": "is stored", "O": ["in the registry", "The command and control server information"]}}], "8": [{"load": {"A": "load", "O": ["the library", "into each and every process executed on the infected system"]}}], "9": [{"are shared": {"A": "are shared", "O": ["between Uroburos and ComRAT", "Command and control server domains"]}}], "10": [{"use": {"A": "use", "S": "the attackers", "O": ["the same persistence mechanism"]}}], "11": [{"is xored": {"A": "is xored", "O": ["with the following obfuscation key", "The file"]}}, {"checks": {"A": "checks", "S": "the malware", "O": ["if an older version is installed on the system"]}}, {"removes": {"A": "removes", "S": "the dropper", "O": ["the older version"]}}], "12": [{"was found": {"A": "was found", "S": "Uroburos", "O": ["a version of Agent.BTZ", "on a system"]}, "does not install": {"A": "does not install", "S": "Uroburos", "O": ["itself"]}}], "13": [{"blends": {"A": "blends", "S": "the C&C communication", "O": ["into the usual browser traffic"]}}, {"communicates": {"A": "communicates", "S": "the malware", "O": ["to the browser", "by named pipe"]}}], "14": [{"complicate": {"A": "complicate", "S": "ComRAT", "O": ["the analysis"]}}], "15": [{"will load": {"A": "will load", "S": "this library", "O": ["the other library called credprov.tlb"]}}], "16": [{"creates": {"A": "creates", "S": "the malware", "O": ["the following registry key"]}, "started": {"A": "started", "S": "the malware", "O": ["during the boot process of the infected machine"]}}], "17": [{"are created": {"A": "are created", "O": ["Two log files", "during the malware execution"]}}, {}], "18": [{"contains": {"A": "contains", "S": "the XML log file", "O": ["the command and control server information"]}}], "19": [{"is spoofed": {"A": "is spoofed", "O": ["this date"]}}], "20": [{"creates": {"A": "creates", "S": "the dropper", "O": ["an additional file called winview.ocx"]}}], "21": [{"install": {"A": "install", "S": "the malware", "O": ["in %APPDATA%\\Microsoft\\", "the file credprov.tlb"]}}]}, "ThreatConnect_Operation_Arachnophobia_Report.tokens": {"0": [{"observed": {"A": "observed", "S": "we", "O": ["more limited use of a No-IP domain"]}}, {"use": {"A": "use", "S": "many of the samples that we have observed", "O": ["for HTTP communications", "direct IPs"]}}], "1": [{"was": {"A": "was", "S": "this SFXRAR's filename", "O": ["the only lure element related to the MH370 event"]}}], "2": [{"using": {"A": "using", "S": "One of these samples", "O": ["a \"leaked report\" lure which contained a decoy document related to Pakistan's alleged inability to locate Osama Bin Laden"]}}], "3": [{"obfuscate": {"A": "obfuscate", "S": "a Pakistan-based cyber exploitation effort", "O": ["its malware characteristics"]}}], "4": [{"perform": {"A": "perform", "S": "BITTERBUG", "O": ["an HTTP GET request for the following URI"]}}, {"is deleted": {"A": "is deleted", "O": ["from %APPDATA%\\Microsoft<FILE_NAME_FROM_ C2>", "the filename received"]}}], "5": [{"communicating": {"A": "communicating", "S": "this customized malware"}, "hosted": {"A": "hosted", "S": "this customized malware"}}], "6": [{"were originally used": {"A": "were originally used", "O": ["two benign decoy documents", "within July 2013 BITTERBUG operations"]}}], "7": [{"beacon": {"A": "beacon", "S": "BITTERBUG", "O": ["to the C2 server", "by sending the computer name and username of the compromised system"]}}], "8": [{"open": {"A": "open", "S": "BITTERBUG", "O": ["recovery.txt"]}, "check": {"A": "check", "S": "BITTERBUG", "O": ["for the presence of strings VBox or VMware"]}}, {"execute": {"A": "execute", "S": "BITTERBUG", "O": ["to detect the presence of a virtual machine (VM)", "the following Windows Management Instrumentation (WMI) command"]}}, {"install": {"A": "install", "S": "the self-extracting RAR", "O": ["<BITTERBUG>.exe and the following DLLs"]}}, {"install": {"A": "install", "S": "The self-extracting RAR", "O": ["the following benign configuration files"]}}], "9": [{"search": {"A": "search", "S": "BITTERBUG", "O": ["for files with the following file extensions"]}, "scan": {"A": "scan", "S": "BITTERBUG", "O": ["through each drive letter"]}}, {"uploads": {"A": "uploads", "S": "BITTERBUG", "O": ["the running process list, document file list, and all documents", "to the following URI"]}}, {"communicates": {"A": "communicates", "S": "The malware", "O": ["on TCP port 80"]}}, {"creates": {"A": "creates", "S": "BITTERBUG", "O": ["a file list containing all documents (excluding those whose filename contains MediaUtils)", "to the following locations"]}}, {"write": {"A": "write", "S": "BITTERBUG", "O": ["a list of all running processes"]}}, {"perform": {"A": "perform", "S": "The malware", "O": ["for the following URIs", "HTTP requests"]}}, {"create": {"A": "create", "S": "The malware", "O": ["the following files"]}}], "10": [{"utilized": {"A": "utilized", "S": "The threat actors", "O": ["a hosting provider that is a Pakistani-based company with subleased VPS space within the U.S."]}}], "11": [{"are downloaded": {"A": "are downloaded", "O": ["The final two files", "to the user\u2019s Startup directory"]}, "executed": {"A": "executed", "O": ["at startup", "The final two files", "in order to maintain persistence"]}}], "12": [{"used": {"A": "used", "S": "Connections to its C2 nodes", "O": ["communications that included \u201c.php?compname=\u201d and \u201c.php?srs=\u201d, as well as direct file/component retrieval from the C2s"]}, "relied": {"A": "relied", "S": "Connections to its C2 nodes", "O": ["on PHP"]}}], "13": [{"installed": {"A": "installed", "S": "a self-extracting RAR archive", "O": ["BITTERBUG"]}, "disguised": {"A": "disguised", "S": "a self-extracting RAR archive", "O": ["as a screensaver"]}}], "14": [{"used": {"A": "used", "O": ["several new lures", "in BITTERBUG self-extracting RAR (SFXRAR) files"]}}], "15": [{"used": {"A": "used", "S": "The threat actor", "O": ["VPSNOC, a probable Pakistan-based VPS service provider who leased U.S. hosting services", "for both the delivery and C2 phases of attack"]}}], "16": [{"enter": {"A": "enter", "S": "The backdoor", "O": ["an infinite sleep loop", "if recovery.txt contains either one of the aforementioned strings (Example in Figure 13)"]}}], "17": [{"communicating": {"A": "communicating", "S": "The customized malware (BITTERBUG) used by these threat actors"}, "hosted": {"A": "hosted", "S": "The customized malware (BITTERBUG) used by these threat actors"}}], "18": [{"appears": {"A": "appears", "S": "BITTERBUG", "O": ["to be virtual machine aware"]}, "not execute": {"A": "not execute", "S": "BITTERBUG", "O": ["on a VMWare or VirtualBox VM"]}}], "19": [{"determined": {"A": "determined", "S": "FireEye", "O": ["it", "to be a custom backdoor"]}}], "20": [{"conceal": {"A": "conceal", "S": "a compilation tactic", "O": ["the C2 address from static analysis"]}}], "21": [{"downloading": {"A": "downloading", "S": "BITTERBUG"}, "uploading": {"A": "uploading", "S": "BITTERBUG"}, "is": {"A": "is", "S": "BITTERBUG", "O": ["a backdoor executable"]}, "generating": {"A": "generating", "S": "BITTERBUG", "O": ["file listings"]}, "listing": {"A": "listing", "S": "BITTERBUG", "O": ["running processes"]}, "transferring": {"A": "transferring", "S": "BITTERBUG", "O": ["selected files", "to its command and control (C2) server"]}}], "22": [{"relies": {"A": "relies", "S": "The backdoor", "O": ["for installation, launch, and communications", "on various support components, including the non-malicious, publically available Libcurl"]}}], "23": [{"extract": {"A": "extract", "S": "the self-extracting RAR archive", "O": ["configuration files, dependency DLLs, and the BITTERBUG executable"]}}], "24": [{"used": {"A": "used", "S": "One from December", "O": ["a decoy PDF document (Figure 12) related to the December arrest of Devyani Khobragade, an Indian diplomat in the United States"]}}], "25": [{"observed": {"A": "observed", "S": "we", "O": ["a SFXRAR file with a filename lure related to the March 2014 disappearance of Malaysis Airlines Flight 370 (cast as a Pakistan-related hijacking)"]}}], "26": [{"was used": {"A": "was used", "O": ["for attackers using variants of the BITTERBUG malware that contained build strings that referenced \u201cTranchulas\u201d and a Tranchulas employee", "as command and control nodes", "VPNSOC IP space"]}}], "27": [{"rely": {"A": "rely", "S": "BITTERBUG", "O": ["to communicate with its C2s", "on the same network behaviors"]}}], "28": [{"target and exfiltrate": {"A": "target and exfiltrate", "S": "BITTERBUG", "O": ["files with extensions such as .doc, .xls, .pdf, .ppt, .egm, and .xml"]}}], "29": [{"were used": {"A": "were used", "O": ["decoy documents"]}}], "30": [{"download": {"A": "download", "S": "BITTERBUG", "O": ["the files listed in Table 1"]}}], "31": [{"delete": {"A": "delete", "S": "this command", "O": ["older versions of BITTERBUG"]}}]}}